{"version":3,"file":"index.esm.js","sources":["../src/components/MapLibreMap/lib/MapLibreGlWrapper.js","../src/components/MapLibreMap/MapLibreMap.js","../src/hooks/useMapState.js","../src/hooks/useMap.js","../src/components/MlComponentTemplate/MlComponentTemplate.js","../src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js","../src/components/MlGeoJsonLayer/util/getDefaultPaintPropsByType.js","../src/components/MlGeoJsonLayer/util/getDefaultLayerTypeByGeometry.js","../src/components/MlGeoJsonLayer/MlGeoJsonLayer.js","../src/components/MlFollowGps/MlFollowGps.js","../src/components/MlCreatePdfButton/lib/nominatimMap.js","../src/components/MlCreatePdfButton/lib/createPdf.js","../src/components/MlCreatePdfButton/MlCreatePdfButton.js","../src/components/MlImageMarkerLayer/MlImageMarkerLayer.js","../src/components/MlNavigationCompass/MlNavigationCompass.js","../src/components/MlNavigationTools/MlNavigationTools.js","../src/components/MlLayer/MlLayer.js","../src/components/MlOsmLayer/MlOsmLayer.js","../src/components/MlVectorTileLayer/MlVectorTileLayer.js","../src/components/MlWmsLayer/MlWmsLayer.js","../src/components/MlFeatureEditor/lib/constants.js","../src/components/MlFeatureEditor/lib/common_selectors.js","../src/components/MlFeatureEditor/lib/double_click_zoom.js","../src/components/MlFeatureEditor/lib/is_event_at_coordinates.js","../src/components/MlFeatureEditor/lib/create_vertex.js","../src/components/MlFeatureEditor/custom-polygon-mode.js","../src/components/MlFeatureEditor/lib/mouse_event_point.js","../src/components/MlFeatureEditor/lib/create_midpoint.js","../src/components/MlFeatureEditor/lib/create_supplementary_points.js","../src/components/MlFeatureEditor/lib/string_set.js","../src/components/MlFeatureEditor/lib/constrain_feature_movement.js","../src/components/MlFeatureEditor/lib/move_features.js","../src/components/MlFeatureEditor/custom-select-mode.js","../src/components/MlFeatureEditor/lib/utils.js","../src/components/MlFeatureEditor/custom-direct-select-mode.js","../src/components/MlFeatureEditor/MlFeatureEditor.js","../src/components/MlBasicComponent.js","../src/components/MlLayerMagnify/MlLayerMagnify.js","../src/components/MlLayerSwipe/MlLayerSwipe.js","../src/components/MlGPXViewer/util/GeoJsonContext.js","../src/components/MlGPXViewer/gpxConverter.js","../src/components/MlGPXViewer/MlGPXViewer.js","../src/components/MlGPXViewer/util/GeoJsonProvider.js","../src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js","../src/components/MlTransitionGeoJsonLayer/util/transitionFunctions.js","../src/components/MlTransitionGeoJsonLayer/MlTransitionGeoJsonLayer.js","../src/components/MlMarker/MlMarker.js","../src/hooks/useWms.js"],"sourcesContent":["/* eslint:disable-next-line */\nimport maplibregl from \"!maplibre-gl\";\n\n/**\n * Creates a MapLibre-gl-js instance and offers all of the native MapLibre functions and properties as well as additional functionality such as element registration & cleanup and more events.\n *\n * @param {object} props\n *\n * @class\n */\nconst MapLibreGlWrapper = function (props) {\n  // closure variable to safely point to the object context of the current MapLibreGlWrapper instance\n  let self = this;\n\n  // element registration and cleanup on a component level is experimental\n  this.registeredElements = {};\n\n  // array of base layer ids, all layers that have been added by the style passed to the MapLibreGl coonstructor\n  this.baseLayers = [];\n\n  // layer id of the first symbol layer\n  this.firstSymbolLayer = undefined;\n\n  // event handlers registered in MapLibreGlWrapper\n  this.eventHandlers = {\n    layerchange: [],\n    viewportchange: [],\n  };\n\n  // functions and properties provided by the wrapper\n  // Add new functions and properties introduced by the wrapper to this object to prevent collisions due to future MapLibre API changes\n  this.wrapper = {\n    /**\n     * Subscribe the given event handler to an event\n     *\n     * @param {string} eventName\n     * @param {function} handler\n     * @param {object} options\n     * @param {string} componentId\n     * @returns {undefined}\n     */\n    on: (eventName, handler, options, componentId) => {\n      if (!self.eventHandlers[eventName]) return;\n\n      if (typeof options === \"string\") {\n        componentId = options;\n        options = {};\n      }\n\n      self.eventHandlers[eventName].push({ handler, options });\n\n      let _arguments = [eventName, handler];\n      if (componentId && typeof componentId === \"string\") {\n        self.initRegisteredElements(componentId);\n        self.registeredElements[componentId].wrapperEvents.push(_arguments);\n      }\n    },\n    /**\n     * Unsubscribes the given event handler from an event\n     *\n     * @param {string} eventName\n     * @param {function} handler\n     * @returns {undefined}\n     */\n    off: (eventName, handler) => {\n      if (!self.eventHandlers[eventName]) return;\n\n      self.eventHandlers[eventName] = self.eventHandlers[eventName].filter((item) => {\n        if (!Object.is(item.handler, handler)) {\n          return item;\n        }\n        return false;\n      });\n    },\n    /**\n     * Calls all event handlers that have been subscribed to the given eventName\n     *\n     * @param {string} eventName\n     * @param {object} context\n     * @returns {undefined}\n     */\n    fire: (eventName, context) => {\n      if (!self.eventHandlers[eventName]) return;\n\n      var scope = context || window;\n      let event = new Event(eventName);\n      event.data = self;\n\n      self.eventHandlers[eventName].forEach(function (item) {\n        item.handler.call(scope, event);\n      });\n    },\n    /**\n     * Array containing an object for each layer in the MapLibre instance providing information on visibility, loading state, order, paint & layout properties\n     */\n    layerState: [],\n    /**\n     * Maps layerIds to layerState in JSON string form for quick deep comparisons\n     */\n    layerStateString: \"\",\n    /**\n     * Previous Version of layerStateString\n     */\n    oldLayerStateStrings: {},\n    /**\n     * Builds the layer info object for a given layer id\n     *\n     * @param {string} layer\n     * @returns object\n     */\n    buildLayerObject: (layer) => {\n      //if (self.baseLayers.indexOf(layer.id) === -1) {\n      //let paint = {};\n      //let values = layer.paint?._values;\n      //Object.keys(values || {}).map((propName) => {\n      //  paint[propName] =\n      //    typeof values[propName].value !== \"undefined\"\n      //      ? values[propName].value.value\n      //      : values[propName];\n      //});\n      //let layout = {};\n      //values = layer.layout?._values;\n      //Object.keys(values || {}).map((propName) => {\n      //  layout[propName] =\n      //    typeof values[propName].value !== \"undefined\"\n      //      ? values[propName].value.value\n      //      : values[propName];\n      //});\n      return {\n        id: layer.id,\n        type: layer.type,\n        visible: layer.visibility === \"none\" ? false : true,\n        baseLayer: self.baseLayers.indexOf(layer.id) !== -1,\n        //paint,\n        //layout,\n        //filter: layers[layerId].filter,\n        //layout: layers[layerId].layout,\n        //maxzoom: layers[layerId].maxzoom,\n        //metadata: layers[layerId].metadata,\n        //minzoom: layers[layerId].minzoom,\n        //paint: layers[layerId].paint.get(),\n        //source: layers[layerId].source,\n        //sourceLayer: layers[layerId].sourceLayer,\n      };\n      //}\n    },\n    /**\n     * Returns an array of layer state info objects for all layers in the MapLibre instance\n     *\n     * @returns array\n     */\n    buildLayerObjects: () => {\n      return self.style._order\n        .map((layerId) => {\n          return self.wrapper.buildLayerObject(self.map.style._layers[layerId]);\n        })\n        .filter((n) => n);\n    },\n    /**\n     * Updates layer state info objects\n     */\n    refreshLayerState: () => {\n      self.wrapper.layerState = self.wrapper.buildLayerObjects();\n      if (JSON.stringify(self.wrapper.layerState) !== self.wrapper.layerStateString) {\n        self.wrapper.fire(\"layerchange\");\n        self.wrapper.layerStateString = JSON.stringify(self.wrapper.layerState);\n      }\n    },\n    /**\n     * Object containing information on the current viewport state\n     */\n    viewportState: {},\n    /**\n     * The same data as viewportState in JSON string form for quick deep comparisons\n     */\n    viewportStateString: \"{}\",\n    /**\n     * Previous version of viewportStateString\n     */\n    oldViewportStateString: \"{}\",\n    getViewport: () =>\n      typeof self.map.getCenter === \"function\"\n        ? {\n            center: (({ lng, lat, ...rest }) => ({ lng, lat }))(self.map.getCenter()),\n            zoom: self.map.getZoom(),\n            bearing: self.map.getBearing(),\n            pitch: self.map.getPitch(),\n          }\n        : {},\n    refreshViewport: () => {\n      self.wrapper.viewportState = self.wrapper.getViewport();\n    },\n  };\n\n  /**\n   * Initializes an empty registered elements object for the given componentId\n   *\n   * @param {string} componentId\n   * @param {boolean} force\n   */\n  this.initRegisteredElements = (componentId, force) => {\n    if (\n      typeof self.registeredElements[componentId] === \"undefined\" ||\n      (force !== \"undefined\" && force)\n    ) {\n      self.registeredElements[componentId] = {\n        layers: [],\n        sources: [],\n        images: [],\n        events: [],\n        controls: [],\n        wrapperEvents: [],\n      };\n    }\n  };\n\n  /**\n   * Overrides MapLibre-gl-js addLayer function providing an additional componentId parameter for the wrapper element registration.\n   *\n   * @param {object} layer\n   * @param {string} beforeId\n   * @param {string} componentId\n   * @returns {undefined}\n   */\n  this.addLayer = (layer, beforeId, componentId) => {\n    if (!self.map.style) {\n      return;\n    }\n    if (componentId && typeof componentId === \"string\" && typeof layer.id !== \"undefined\") {\n      self.initRegisteredElements(componentId);\n      self.registeredElements[componentId].layers.push(layer.id);\n\n      if (typeof layer.source === \"object\") {\n        self.registeredElements[componentId].sources.push(layer.id);\n      }\n    }\n\n    self.map.addLayer(layer, beforeId);\n  };\n\n  /**\n   * Overrides MapLibre-gl-js addSource function providing an additional componentId parameter for the wrapper element registration.\n   *\n   * @param {string} sourceId\n   * @param {object} source\n   * @param {object} options\n   * @param {string} componentId\n   * @returns {undefined}\n   */\n  this.addSource = (sourceId, source, options, componentId) => {\n    if (!self.map.style) {\n      return;\n    }\n    if (typeof options === \"string\" && typeof componentId === \"undefined\") {\n      return self.addSource.call(self, sourceId, source, undefined, options);\n    }\n    if (componentId && typeof componentId === \"string\" && typeof sourceId !== \"undefined\") {\n      self.initRegisteredElements(componentId);\n      self.registeredElements[componentId].sources.push(sourceId);\n    }\n\n    self.map.addSource(sourceId, source, options);\n  };\n\n  /**\n   * Overrides MapLibre-gl-js addImage function providing an additional componentId parameter for the wrapper element registration.\n   *\n   * @param {string} id\n   * @param {*} image\n   * @param {*} ref\n   * @param {string} componentId\n   * @returns {undefined}\n   */\n  this.addImage = (id, image, ref, componentId) => {\n    if (!self.map.style) {\n      return;\n    }\n    if (typeof ref === \"string\" && typeof componentId === \"undefined\") {\n      return self.addImage.call(self, id, image, undefined, ref);\n    }\n    if (componentId && typeof componentId === \"string\" && typeof id !== \"undefined\") {\n      self.initRegisteredElements(componentId);\n      self.registeredElements[componentId].images.push(id);\n    }\n\n    self.map.addImage(id, image, ref);\n  };\n\n  /**\n   * Overrides MapLibre-gl-js on function providing an additional componentId parameter for the wrapper element registration.\n   *\n   * @param {string} type\n   * @param {string} layerId\n   * @param {function} listener\n   * @param {string} componentId\n   * @returns {undefined}\n   */\n  this.on = (type, layerId, listener, componentId) => {\n    if (typeof listener === \"string\" && typeof layerId === \"function\") {\n      return self.on.call(self, type, undefined, layerId, listener);\n    }\n\n    let _arguments = [type, layerId, listener];\n    if (!layerId) {\n      _arguments = [type, listener];\n    }\n\n    if (componentId && typeof componentId === \"string\") {\n      self.initRegisteredElements(componentId);\n      self.registeredElements[componentId].events.push(_arguments);\n    }\n\n    self.map.on(..._arguments);\n  };\n\n  /**\n   * Overrides MapLibre-gl-js addControl function providing an additional componentId parameter for the wrapper element registration.\n   *\n   * @param {object} control\n   * @param {string} position\n   * @param {string} componentId\n   */\n  this.addControl = (control, position, componentId) => {\n    if (componentId && typeof componentId === \"string\") {\n      self.initRegisteredElements(componentId);\n      self.registeredElements[componentId].controls.push(control);\n    }\n\n    self.map.addControl(control, position);\n  };\n\n  /**\n   * Removes anything that has been added to the maplibre instance referenced with componentId\n   *\n   * @param {string} componentId\n   */\n  this.cleanup = (componentId) => {\n    if (self.map.style && typeof self.registeredElements[componentId] !== \"undefined\") {\n      // cleanup layers\n      self.registeredElements[componentId].layers.forEach((item) => {\n        if (self.map.style.getLayer(item)) {\n          self.map.style.removeLayer(item);\n        }\n      });\n\n      // cleanup sources\n      self.registeredElements[componentId].sources.forEach((item) => {\n        if (self.map.style.getSource(item)) {\n          self.map.style.removeSource(item);\n        }\n      });\n\n      // cleanup images\n      self.registeredElements[componentId].images.forEach((item) => {\n        if (self.map.hasImage(item)) {\n          self.map.style.removeImage(item);\n        }\n      });\n\n      // cleanup events\n      self.registeredElements[componentId].events.forEach((item) => {\n        self.map.off(...item);\n      });\n\n      // cleanup controls\n      self.registeredElements[componentId].controls.forEach((item) => {\n        self.map.removeControl(item);\n      });\n\n      // cleanup wrapper events\n      self.registeredElements[componentId].wrapperEvents.forEach((item) => {\n        self.wrapper.off(...item);\n      });\n\n      self.initRegisteredElements(componentId, true);\n    }\n  };\n\n  // add style prop functions that require map._update to be called afterwards\n  let updatingStyleFunctions = [\n    \"moveLayer\",\n    \"removeLayer\",\n    \"removeSource\",\n    \"setPaintProperty\",\n    \"setLayoutProperty\",\n  ];\n  updatingStyleFunctions.forEach((item) => {\n    this[item] = (...props) => {\n      if (self.map && this.map.style && typeof self.map.style[item] === \"function\") {\n        self.map.style[item](...props);\n      }\n      return self.map._update ? self.map._update(true) : undefined;\n    };\n  });\n\n  // add style prop functions\n  let styleFunctions = [\n    \"getLayer\",\n    \"getSource\",\n    \"listImages\",\n    \"getPaintProperty\",\n    \"getLayoutProperty\",\n    \"removeImage\",\n  ];\n  styleFunctions.forEach((item) => {\n    this[item] = (...props) => {\n      if (self.map && self.map.style) {\n        return self.map.style[item](...props);\n      }\n      return false;\n    };\n  });\n\n  this.addNativeMaplibreFunctionsAndProps = () => {\n    //  add MapLibre-gl functions\n    Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach((item) => {\n      if (typeof this[item] === \"undefined\") {\n        this[item] = (...props) => self.map[item](...props);\n      }\n    });\n\n    //  add MapLibre-gl properties\n    Object.keys(this.map).forEach((item) => {\n      if (typeof this[item] === \"undefined\") {\n        this[item] = self.map[item];\n      }\n    });\n  };\n\n  // add functions that are missing on the MapLibre instances prototype\n  let missingFunctions = [\n    \"getZoom\",\n    \"setZoom\",\n    \"getCenter\",\n    \"setCenter\",\n    \"getBearing\",\n    \"setBearing\",\n    \"getPitch\",\n    \"setPitch\",\n    \"jumpTo\",\n    \"flyTo\",\n    \"panTo\",\n    \"panBy\",\n    \"panBy\",\n    \"zoomTo\",\n    \"zoomIn\",\n    \"zoomOut\",\n    \"getPadding\",\n    \"setPadding\",\n    \"rotateTo\",\n    \"resetNorth\",\n    \"resetNorthPitch\",\n    \"snapToNorth\",\n    \"cameraForBounds\",\n    \"fitBounds\",\n    \"fitScreenCoordinates\",\n    \"getFreeCameraOptions\",\n    \"setFreeCameraOptions\",\n    \"easeTo\",\n    \"stop\",\n  ];\n  missingFunctions.forEach((item) => {\n    this[item] = (...props) => {\n      if (typeof self.map[item] === \"function\") {\n        return self.map[item].call(self.map, ...props);\n      }\n      return undefined;\n    };\n  });\n\n  // initialize the MapLibre-gl instance\n  let initializeMapLibre = async () => {\n    // if mapOptions style URL is given and if it is not a mapbox URL fetch the json and initialize the mapbox object\n    if (\n      typeof props.mapOptions.style === \"string\" &&\n      props.mapOptions.style.indexOf(\"mapbox://\") === -1\n    ) {\n      await fetch(props.mapOptions.style)\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          } else {\n            throw new Error(\"error loading map style.json\");\n          }\n        })\n        .then((styleJson) => {\n          styleJson.layers.forEach((item) => {\n            self.baseLayers.push(item.id);\n            if (!self.firstSymbolLayer && item.type === \"symbol\") {\n              self.firstSymbolLayer = item.id;\n            }\n          });\n          self.styleJson = styleJson;\n          props.mapOptions.style = styleJson;\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n\n    self.map = new maplibregl.Map(props.mapOptions);\n\n    self.addNativeMaplibreFunctionsAndProps();\n    self.wrapper.refreshViewport();\n    self.wrapper.fire(\"viewportchange\");\n\n    self.map.on(\"load\", () => {\n      self.addNativeMaplibreFunctionsAndProps();\n    });\n\n    self.map.on(\"move\", () => {\n      self.wrapper.viewportState = self.wrapper.getViewport();\n      self.wrapper.fire(\"viewportchange\");\n    });\n    self.map.on(\"idle\", () => {\n      self.wrapper.refreshLayerState();\n    });\n    self.map.on(\"data\", () => {\n      self.wrapper.refreshLayerState();\n    });\n    if (typeof props.onReady === \"function\") {\n      props.onReady(self.map, self);\n    }\n  };\n  initializeMapLibre();\n};\n\nexport default MapLibreGlWrapper;\n","import React, { useRef, useEffect, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport MapLibreGlWrapper from \"./lib/MapLibreGlWrapper\";\n\nimport \"maplibre-gl/dist/maplibre-gl.css\";\n\n/**\n * Creates a MapLibreGlWrapper instance and registers it in MapContext\n * after the MapLibre-gl load event has fired.\n *\n * MapLibreMap returns the html node that will be used by MapLibre-gl to render the map.\n * This Component must be kept unaware of any related components that interact with the MapLibre-gl\n * instance.\n *\n * @component\n */\nconst MapLibreMap = (props) => {\n  const map = useRef(null);\n  const mapContainer = useRef(null);\n\n  const mapContext = useContext(MapContext);\n  const mapContextRef = useRef(mapContext);\n\n  const mapIdRef = useRef(props.mapId);\n  const mapOptions = props.options;\n\n  useEffect(() => {\n    let mapId = mapIdRef.current;\n    let _mapContext = mapContextRef.current;\n\n    return () => {\n      _mapContext.removeMap(mapId);\n      map.current?.remove?.();\n      map.current = null;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (mapContainer.current) {\n      map.current = new MapLibreGlWrapper({\n        mapOptions: {\n          container: mapContainer.current,\n          ...mapOptions,\n        },\n        onReady: (map, wrapper) => {\n          map.once(\"load\", () => {\n            if (props.mapId) {\n              mapContext.registerMap(props.mapId, wrapper);\n            } else {\n              mapContext.setMap(wrapper);\n            }\n          });\n\n          // TODO: remove this line\n          window.map = wrapper;\n        },\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mapContainer]);\n\n  return <div ref={mapContainer} className=\"mapContainer\" />;\n};\n\nMapLibreMap.defaultProps = {\n  mapId: undefined,\n  options: {\n    lng: 8.607,\n    lat: 53.1409349,\n    zoom: 10,\n    accessToken:\n      \"pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA\",\n  },\n};\n\nMapLibreMap.propTypes = {\n  /**\n   * Id of the MapLibreGl(Wrapper) instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Config object that is passed to the MapLibreGl constructor as first parameter.\n   * See https://maplibre.org/maplibre-gl-js-docs/api/map/ for a formal documentation of al\n   * available properties.\n   */\n  options: PropTypes.object,\n};\n\nexport default MapLibreMap;\n","import { useContext, useCallback, useState, useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { MapContext } from \"@mapcomponents/react-core\";\n\n/**\n * React hook that allows subscribing to map state changes\n *\n * @component\n */\nfunction useMapState(props) {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n\n  const initializedRef = useRef(false);\n  const mapRef = useRef(undefined);\n\n  const [viewport, setViewport] = useState(undefined);\n  const viewportRef = useRef(undefined);\n\n  const [layers, setLayers] = useState(undefined);\n  const layersRef = useRef(undefined);\n  //const mapRef = useRef(props.map);\n  const componentId = useRef(uuidv4());\n\n  /**\n   * returns the element if it matches the defined filter criteria\n   * to be used as filter function on the layers array\n   *\n   * @param {object} layer\n   */\n  const layerIdFilter = useCallback(\n    (layer) => {\n      if (!props?.filter?.includeBaseLayers && layer.baseLayer) {\n        return false;\n      }\n\n      if (typeof props.filter?.matchLayerIds !== \"undefined\") {\n        if (props.filter.matchLayerIds instanceof RegExp) {\n          return props.filter.matchLayerIds.test(layer.id);\n        } else {\n          return layer.id.includes(props.filter.matchLayerIds);\n        }\n      }\n\n      return true;\n    },\n    [props.filter]\n  );\n\n  const refreshLayerState = useCallback(() => {\n    let _layerState = mapRef.current.wrapper.layerState.filter(layerIdFilter);\n    let _layerStateString = JSON.stringify(_layerState);\n    if (layersRef.current !== _layerStateString) {\n      layersRef.current = _layerStateString;\n      setLayers(_layerState);\n    }\n  }, [layerIdFilter]);\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n\n    return () => {\n      // cleanup all event listeners\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        mapRef.current = undefined;\n      }\n      initializedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n    // the MapLibre-gl instance (mapContext.getMap(props.mapId)) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n\n    if (props?.watch?.viewport) {\n      setViewport(mapRef.current.wrapper.viewportState);\n\n      // register viewportchange event handler\n      mapRef.current.wrapper.on(\n        \"viewportchange\",\n        () => {\n          if (viewportRef.current !== mapRef.current?.wrapper.viewportStateString) {\n            setViewport(mapRef.current?.wrapper.viewportState);\n          }\n        },\n        componentId.current\n      );\n    }\n\n    // register layerchange event handler\n    if (props?.watch?.layers) {\n      refreshLayerState();\n\n      mapRef.current.wrapper.on(\n        \"layerchange\",\n        refreshLayerState,\n        {\n          includeBaseLayers: props?.filter?.includeBaseLayers,\n          matchLayerIds: props?.filter?.matchLayerIds,\n        },\n        componentId.current\n      );\n    }\n  }, [mapContext.mapIds, mapContext, props.mapId, refreshLayerState, props]);\n\n  return {\n    layers,\n    viewport,\n  };\n}\n\nuseMapState.defaultProps = {\n  mapId: undefined,\n  watch: {\n    layers: true,\n    sources: false,\n    viewport: false,\n  },\n  filter: {\n    includeBaseLayers: false,\n  },\n};\n\nuseMapState.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Defines map Resources to watch\n   */\n  watch: PropTypes.shape({\n    layers: PropTypes.bool,\n    sources: PropTypes.bool,\n    viewport: PropTypes.bool,\n  }),\n  /**\n   * Filter string or RegExp to more explicitly define the elements watched and increase performance\n   * strings will be matched using layerId.includes(matchString)\n   * RegExps will be matched using matchRegExp.test(layerId)\n   */\n  filter: PropTypes.shape({\n    includeBaseLayers: PropTypes.bool,\n    matchLayerIds: PropTypes.oneOfType([PropTypes.string, PropTypes.instanceOf(RegExp)]),\n    matchSourceIds: PropTypes.oneOfType([PropTypes.string, PropTypes.instanceOf(RegExp)]),\n  }),\n};\n\nexport default useMapState;\n","import React, { useContext, useState, useEffect, useRef } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport useMapState from \"./useMapState\";\n\nfunction useMap(props) {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n\n  const mapState = useMapState({\n    mapId: props.mapId,\n    watch: {\n      viewport: false,\n      layers: props.waitForLayer ? true : false,\n      sources: false,\n    },\n    filter: {\n      includeBaseLayers: true,\n    },\n  });\n\n  const initializedRef = useRef(false);\n  const mapRef = useRef(undefined);\n\n  const componentId = useRef(uuidv4());\n\n  const [mapIsReady, setMapIsReady] = useState(false);\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        mapRef.current = undefined;\n      }\n      initializedRef.current = false;\n      setMapIsReady(false);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n\n    // check if waitForLayer (string, layer id of the layer this hook is supposed to wait for)\n    // exists as layer in the MapLibre instance\n    if (props.waitForLayer) {\n      let layerFound = false;\n\n      mapState?.layers?.forEach((layer) => {\n        if (layer.id === props.waitForLayer) {\n          layerFound = true;\n        }\n      });\n      if (!layerFound) {\n        return;\n      }\n    }\n    // the MapLibre-gl instance (mapContext.getMap(props.mapId)) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n    setMapIsReady(true);\n  }, [mapContext.mapIds, mapState.layers, mapContext, props.waitForLayer, props.mapId]);\n\n  return {\n    map: mapRef.current,\n    mapIsReady,\n    componentId: componentId.current,\n    layers: mapState.layers,\n  };\n}\n\nexport default useMap;\n","import React, { useRef, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport useMap from \"../../hooks/useMap\";\n\n/**\n * TODO: Add short & useful description\n *\n * @param {object} props\n * @param {string} props.mapId Id of the target MapLibre instance in mapContext\n *\n * @component\n */\nconst MlComponentTemplate = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (!mapHook.mapIsReady || initializedRef.current) return;\n    // the MapLibre-gl instance (mapHook.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    initializedRef.current = true;\n\n    mapHook.map.setCenter([7.132122000552613, 50.716405378037706]);\n  }, [mapHook.map, mapHook.mapIsReady, props.mapId]);\n\n  return <></>;\n};\n\nMlComponentTemplate.defaultProps = {\n  mapId: undefined,\n};\n\nMlComponentTemplate.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n};\nexport default MlComponentTemplate;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MapContext } from \"@mapcomponents/react-core\";\n\nimport { v4 as uuidv4 } from \"uuid\";\nimport Button from \"@mui/material/Button\";\n\n/**\n * Adds a fill extrusion layer to the MapLibre instance reference by props.mapId\n *\n * @Component\n */\nconst MlFillExtrusionLayer = (props) => {\n  const mapContext = useContext(MapContext);\n  const mapRef = useRef(null);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const componentId = useRef(\n    (props.idPrefix ? props.idPrefix : \"MlFillExtrusionLayer-\") + uuidv4()\n  );\n  const initializedRef = useRef(false);\n  const layerId = useRef(props.layerId || \"MlFillExtrusionLayer-\" + uuidv4());\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        mapRef.current = undefined;\n      }\n      initializedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n    // the MapLibre-gl instance (mapContext.getMap(props.mapId)) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n\n    let lastLabelLayerId = undefined;\n    if (mapContext.map.getLayer(\"waterway-name\")) {\n      lastLabelLayerId = \"waterway-name\";\n    }\n\n    if (mapContext.map.getLayer(\"poi_label\")) {\n      lastLabelLayerId = \"poi_label\";\n    }\n\n    mapContext.map.addLayer(\n      {\n        id: layerId.current,\n        type: \"fill-extrusion\",\n        source: props.sourceId || \"openmaptiles\",\n        \"source-layer\": props.sourceLayer || \"building\",\n        minzoom: props.minZoom || 14,\n        paint: {\n          ...props.paint,\n        },\n      },\n      props.insertBeforeLayer || lastLabelLayerId,\n      componentId.current\n    );\n  }, [\n    mapContext,\n    props.insertBeforeLayer,\n    props.mapId,\n    props.minZoom,\n    props.paint,\n    props.sourceId,\n    props.sourceLayer,\n  ]);\n\n  useEffect(() => {\n    if (!initializedRef.current) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    mapRef.current.setLayoutProperty(layerId.current, \"visibility\", showLayer ? \"visible\" : \"none\");\n  }, [showLayer, mapContext]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      Composite\n    </Button>\n  );\n};\n\nMlFillExtrusionLayer.defaultProps = {\n  mapId: undefined,\n  paint: {\n    \"fill-extrusion-color\": \"hsl(196, 61%, 83%)\",\n    \"fill-extrusion-height\": {\n      property: \"render_height\",\n      type: \"identity\",\n    },\n    \"fill-extrusion-base\": {\n      property: \"render_min_height\",\n      type: \"identity\",\n    },\n    \"fill-extrusion-opacity\": 1,\n  },\n};\n\nMlFillExtrusionLayer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Id of the layer that will be added by this component\n   */\n  layerId: PropTypes.string,\n  /**\n   * Prefix of the component id this component uses when adding elements to the MapLibreGl-instance\n   */\n  idPrefix: PropTypes.string,\n  /**\n   * Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All\n   * available properties are documented in the MapLibreGl documentation\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion\n   */\n  paint: PropTypes.object,\n  /**\n   * Source id of a vector tile source containing the geometries to use for this fill-extrusion\n   * layer.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer\n   */\n  sourceId: PropTypes.string,\n  /**\n   * Layer id from a vector tile source containing the geometries to use for this fill-extrusion\n   * layer.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer\n   */\n  sourceLayer: PropTypes.string,\n  /**\n   * This layer will be hidde for zoom levels lower than defined on this property\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom\n   */\n  minZoom: PropTypes.number,\n  /**\n   * The layerId of an existing layer this layer should be rendered visually beneath\n   * https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see \"beforeId\" property\n   */\n  insertBeforeLayer: PropTypes.string,\n};\n\nexport default MlFillExtrusionLayer;\n","const getDefaultPaintPropsByType = (type, defaultPaintOverrides) => {\n  switch (type) {\n    case \"fill\":\n      if (defaultPaintOverrides?.fill) {\n        return defaultPaintOverrides.fill;\n      }\n      return {\n        \"fill-color\": \"rgba(10,240,256,0.6)\",\n      };\n    case \"line\":\n      if (defaultPaintOverrides?.line) {\n        return defaultPaintOverrides.line;\n      }\n      return {\n        \"line-color\": \"rgb(203,211,2)\",\n        \"line-width\": 5,\n      };\n    case \"circle\":\n    default:\n      if (defaultPaintOverrides?.circle) {\n        return defaultPaintOverrides.circle;\n      }\n      return {\n        \"circle-color\": \"rgba(10,240,256)\",\n        \"circle-stroke-color\": \"#fff\",\n        \"circle-stroke-width\": 2,\n      };\n  }\n};\n\nexport default getDefaultPaintPropsByType;\n","const mapGeometryTypesToLayerTypes = {\n  Position: \"circle\",\n  Point: \"circle\",\n  MultiPoint: \"circle\",\n  LineString: \"line\",\n  MultiLineString: \"line\",\n  Polygon: \"fill\",\n  MultiPolygon: \"fill\",\n  GeometryCollection: \"circle\",\n};\n\nconst getDefaulLayerTypeByGeometry = (geojson) => {\n  if (geojson?.type === \"Feature\") {\n    return mapGeometryTypesToLayerTypes?.[geojson?.geometry?.type]\n      ? mapGeometryTypesToLayerTypes[geojson.geometry.type]\n      : \"circle\";\n  }\n  if (geojson?.type === \"FeatureCollection\") {\n    if (geojson.features.length) {\n      return getDefaulLayerTypeByGeometry(geojson.features[0]);\n    }\n    return \"circle\";\n  }\n};\nexport default getDefaulLayerTypeByGeometry;\n","import React, { useRef, useEffect, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport useMap from \"../../hooks/useMap\";\n\nimport getDefaultPaintPropsByType from \"./util/getDefaultPaintPropsByType\";\nimport getDefaulLayerTypeByGeometry from \"./util/getDefaultLayerTypeByGeometry\";\n\nconst legalLayerTypes = [\"circle\", \"fill\", \"line\"];\n\n/**\n * Adds source and layer of types \"line\", \"fill\" or \"circle\" to display GeoJSON data on the map.\n *\n * @component\n */\nconst MlGeoJsonLayer = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n  const initializedRef = useRef(false);\n  const layerId = useRef(props.layerId || \"MlGeoJsonLayer-\" + mapHook.componentId);\n  const layerTypeRef = useRef(undefined);\n\n  useEffect(() => {\n    if (!mapHook.map || !initializedRef.current) return;\n\n    for (var key in props.layout) {\n      mapHook.map.setLayoutProperty(layerId.current, key, props.layout[key]);\n    }\n  }, [props.layout, mapHook.map, props.mapId]);\n\n  useEffect(() => {\n    if (!mapHook.map || !initializedRef.current) return;\n\n    let _paint =\n      props.paint || getDefaultPaintPropsByType(layerTypeRef.current, props.defaultPaintOverrides);\n\n    for (var key in _paint) {\n      mapHook.map.setPaintProperty(layerId.current, key, _paint[key]);\n    }\n  }, [props.paint, mapHook.map, props.mapId, props.defaultPaintOverrides]);\n\n  useEffect(() => {\n    if (!mapHook?.map?.getSource(layerId.current) || !initializedRef.current) return;\n\n    mapHook.map.getSource(layerId.current).setData(props.geojson);\n  }, [props.geojson, mapHook.map, props.type]);\n\n  const createLayer = useCallback(() => {\n    let geojson = props.geojson;\n\n    layerTypeRef.current = props.type || getDefaulLayerTypeByGeometry(props.geojson);\n\n    mapHook.map.addLayer(\n      {\n        id: layerId.current,\n        source: {\n          type: \"geojson\",\n          data: geojson,\n        },\n        type: layerTypeRef.current,\n        paint:\n          props.paint ||\n          getDefaultPaintPropsByType(layerTypeRef.current, props.defaultPaintOverrides),\n        layout: props.layout || {},\n        ...props.options,\n      },\n      props.insertBeforeLayer,\n      mapHook.componentId\n    );\n\n    if (typeof props.onHover !== \"undefined\") {\n      mapHook.map.on(\"mousemove\", layerId.current, props.onHover, mapHook.componentId);\n    }\n\n    if (typeof props.onClick !== \"undefined\") {\n      mapHook.map.on(\"click\", layerId.current, props.onClick, mapHook.componentId);\n    }\n\n    if (typeof props.onLeave !== \"undefined\") {\n      mapHook.map.on(\"mouseleave\", layerId.current, props.onLeave, mapHook.componentId);\n    }\n  }, [mapHook, props]);\n\n  useEffect(() => {\n    if (!mapHook.map || !props.geojson) return;\n\n    if (\n      initializedRef.current &&\n      legalLayerTypes.indexOf(props.type) !== -1 &&\n      layerTypeRef.current &&\n      props.type !== layerTypeRef.current\n    ) {\n      // remove (cleanup) & reinitialize the layer if type has changed\n      mapHook.map.cleanup(mapHook.componentId);\n    } else if (\n      initializedRef.current &&\n      (legalLayerTypes.indexOf(props.type) === -1 ||\n        (legalLayerTypes.indexOf(props.type) !== -1 && props.type === layerTypeRef.current))\n    ) {\n      return;\n    }\n\n    initializedRef.current = true;\n\n    createLayer();\n  }, [mapHook, createLayer, props]);\n\n  return <></>;\n};\n\nMlGeoJsonLayer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Type of the layer that will be added to the MapLibre instance.\n   * Possible values: \"line\", \"circle\", \"fill\"\n   */\n  type: PropTypes.string,\n  /**\n   * Layout property object, that is passed to the addLayer call.\n   * Possible props depend on the layer type.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  layout: PropTypes.object,\n  /**\n   * Paint property object, that is passed to the addLayer call.\n   * Possible props depend on the layer type.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  paint: PropTypes.object,\n  /**\n   * Javascript object with optional properties \"fill\", \"line\", \"circle\" to override implicit layer type default paint properties.\n   */\n  defaultPaintOverrides: PropTypes.object,\n  /**\n   * Javascript object that is spread into the addLayer commands first parameter.\n   */\n  options: PropTypes.object,\n  /**\n   * GeoJSON data that is supposed to be rendered by this component.\n   */\n  geojson: PropTypes.object,\n  /**\n   * Id of an existing layer in the mapLibre instance to help specify the layer order\n   * This layer will be visually beneath the layer with the \"insertBeforeLayer\" id.\n   */\n  insertBeforeLayer: PropTypes.string,\n  /**\n   * Id of the new layer and source that are added to the MapLibre instance\n   */\n  layerId: PropTypes.string,\n  /**\n   * Click event handler that is executed whenever a geometry rendered by this component is clicked.\n   */\n  onClick: PropTypes.func,\n  /**\n   * Hover event handler that is executed whenever a geometry rendered by this component is hovered.\n   */\n  onHover: PropTypes.func,\n  /**\n   * Leave event handler that is executed whenever a geometry rendered by this component is\n   * left/unhovered.\n   */\n  onLeave: PropTypes.func,\n};\n\nexport default MlGeoJsonLayer;\n","import React, { useEffect, useState, useCallback, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport useMap from \"../../hooks/useMap\";\n\nimport Button from \"@mui/material/Button\";\nimport GpsFixedIcon from \"@mui/icons-material/GpsFixed\";\nimport { point, circle, lineArc } from \"@turf/turf\";\nimport MlGeoJsonLayer from \"../MlGeoJsonLayer/MlGeoJsonLayer\";\n\n/**\n * Adds a button that makes the map follow the users GPS position using\n * navigator.geolocation.watchPosition if activated\n *\n * @param {object} props\n * @param {string} props.mapId Id of the target MapLibre instance in mapContext\n *\n * @component\n */\nconst MlFollowGps = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const [isFollowed, setIsFollowed] = useState(false);\n  const [userLocationGeoJson, setUserLocationGeoJson] = useState(undefined);\n  const [locationAccessDenied, setLocationAccessDenied] = useState(false);\n  const [accuracyGeoJson, setAccuracyGeoJson] = useState();\n  const [deviceOrientation, setDeviceOrientation] = useState(0);\n\n  const getLocationSuccess = useCallback(\n    (pos) => {\n      if (!mapHook.map) return;\n\n      mapHook.map.flyTo({\n        center: [pos.coords.longitude, pos.coords.latitude],\n        zoom: 18,\n        speed: 1,\n        curve: 1,\n      });\n      if (!props.showUserLocation) return;\n      const geoJsonPoint = point([pos.coords.longitude, pos.coords.latitude]);\n      setUserLocationGeoJson(geoJsonPoint);\n      setAccuracyGeoJson(circle(geoJsonPoint, pos.coords.accuracy / 1000));\n    },\n    [mapHook.map, props]\n  );\n\n  const getLocationError = (err) => {\n    console.log(\"Access of user location denied\");\n    setLocationAccessDenied(true);\n  };\n\n  const orientationCone = useMemo(\n    () => {\n      if (!userLocationGeoJson) {\n        return undefined;\n      }\n      let radius = 0.02;\n      let bearing1 = deviceOrientation - 15;\n      let bearing2 = deviceOrientation + 15;\n      const options = {steps: 65};\n      let arc = lineArc(userLocationGeoJson, radius, bearing1, bearing2, options);\n      let copy = arc;\n      copy.geometry.coordinates.push(userLocationGeoJson.geometry.coordinates);\n      copy.geometry.coordinates.slice(0, 0, userLocationGeoJson.geometry.coordinates);\n      return copy;\n    }, [deviceOrientation, userLocationGeoJson]\n  )\n\n  const handleOrientation = (event) => {\n    setDeviceOrientation(-event.alpha)\n  } \n\n  useEffect(() => {\n    if (isFollowed) {\n      let _handleOrientation = handleOrientation;\n      window.addEventListener('deviceorientation', _handleOrientation)\n      return () => {\n        window.removeEventListener('deviceorientation', _handleOrientation)\n      }\n    }\n  }, [isFollowed]);\n\n  useEffect(() => {\n    if (!mapHook.map) return;\n\n    if (isFollowed) {\n      let _watchId = navigator.geolocation.watchPosition(getLocationSuccess, getLocationError);\n\n      return () => {\n        navigator.geolocation.clearWatch(_watchId);\n      };\n    }\n  }, [mapHook.map, isFollowed, getLocationSuccess]);\n\n  return (\n    <>\n      {isFollowed && userLocationGeoJson && (\n        <MlGeoJsonLayer\n          geojson={accuracyGeoJson}\n          type={\"fill\"}\n          paint={{\n            \"fill-color\": \"#cbd300\",\n            \"fill-opacity\": 0.3,\n            ...props.accuracyPaint,\n          }}\n          insertBeforeLayer={props.insertBeforeLayer}\n        />\n      )}\n\n      {isFollowed && orientationCone && (\n        <MlGeoJsonLayer\n          geojson={orientationCone}\n          type={\"fill\"}\n          paint={{\n            \"fill-color\": \"#0000ff\",\n            \"fill-antialias\": false,\n            \"fill-opacity\": 0.3,\n          }}\n          insertBeforeLayer={props.insertBeforeLayer}\n        />\n      )}\n\n      {isFollowed && userLocationGeoJson && (\n        <MlGeoJsonLayer\n          geojson={userLocationGeoJson}\n          type={\"circle\"}\n          paint={{\n            \"circle-color\": \"#009ee0\",\n            \"circle-radius\": 5,\n            \"circle-stroke-color\": \"#fafaff\",\n            \"circle-stroke-width\": 1,\n            ...props.circlePaint,\n          }}\n          insertBeforeLayer={props.insertBeforeLayer}\n        />\n      )}\n\n      <Button\n        sx={{ zIndex: 1002, color: isFollowed ? props.onColor : props.offColor, ...props.style }}\n        disabled={locationAccessDenied}\n        onClick={() => {\n          setIsFollowed(!isFollowed);\n        }}\n      >\n        {\" \"}\n        <GpsFixedIcon sx={{ fontSize: props.style.fontSize }} />{\" \"}\n      </Button>\n    </>\n  );\n};\n\nMlFollowGps.defaultProps = {\n  mapId: undefined,\n  style: {\n    minWidth: \"30px\",\n    minHeight: \"30px\",\n    width: \"30px\",\n    height: \"30px\",\n    backgroundColor: \"#414141\",\n    borderRadius: \"23%\",\n    margin: 0.15,\n    fontSize: \"1.3em\",\n    \":hover\": {\n      backgroundColor: \"#515151\",\n      color: \"#ececec\",\n    },\n  },\n  onColor: \"#ececec\",\n  offColor: \"#666\",\n  showAccuracyCircle: true,\n  showUserLocation: true,\n  showOrientation: true\n};\n\nMlFollowGps.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * CSS style object that is applied to the button component\n   */\n  style: PropTypes.object,\n  /**\n   * Active button font color\n   */\n  onColor: PropTypes.string,\n  /**\n   * Inactive button font color\n   */\n  offColor: PropTypes.string,\n  /**\n   * Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy circle.\n   * Use any available paint prop from layer type \"fill\".\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  accuracyPaint: PropTypes.object,\n  /**\n   * position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy circle.\n   * Use any available paint prop from layer type \"fill\".\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  circlePaint: PropTypes.object,\n  /**\n   * By default, if showUserLocation is true, a transparent circle will be drawn around the user location \n   * indicating the accuracy (95% confidence level) of the user's location. Set to false to disable. \n   */\n  showAccuracyCircle: PropTypes.bool,\n  /**\n   * By default a dot will be shown on the map at the user's location. Set to false to disable.\n   */\n  showUserLocation: PropTypes.bool,\n  /**\n   * By default a cone will be shown on the map at the user's location to indicate the device's orientation.\n   * Set to false to disable.\n   */\n  showOrientation: PropTypes.bool,\n};\nexport default MlFollowGps;\n","const nmMap = {\n  street: [\n    \"footway\",\n    \"street\",\n    \"road\",\n    \"street_name\",\n    \"residential\",\n    \"path\",\n    \"pedestrian\",\n    \"road_reference\",\n    \"road_reference_intl\",\n    \"square\",\n    \"place\",\n  ],\n  number: [\"house_number\", \"street_number\"],\n  place: [\n    \"city\",\n    \"village\",\n    \"hamlet\",\n    \"locality\",\n    \"croft\",\n    \"neighbourhood\",\n    \"suburb\",\n    \"city_district\",\n    \"district\",\n    \"quarter\",\n    \"borough\",\n    \"city_block\",\n    \"residential\",\n    \"commercial\",\n    \"industrial\",\n    \"houses\",\n    \"subdivision\",\n    \"allotments\",\n    \"postal_city\",\n    \"town\",\n    \"municipality\",\n    \"local_administrative_area\",\n  ],\n  zip: [\"postcode\", \"partial_postcode\"],\n  state: [\"state\", \"province\", \"state_code\"],\n};\n\nconst nmConverter = (nmAddress) => {\n  const addressArr = [];\n  for (let key in nmMap) {\n    nmMap[key].some((element) => {\n      if (nmAddress.hasOwnProperty(element)) {\n        addressArr.push(nmAddress[element]);\n        return true;\n      }\n      return false;\n    });\n  }\n  return addressArr.join(\", \");\n};\nexport default nmConverter;\n","import maplibregl from \"maplibre-gl\";\nimport jsPDF from \"jspdf\";\nimport nmConverter from \"./nominatimMap.js\";\n\nconst toPixels = (length) => {\n  let conversionFactor = 96;\n\n  conversionFactor /= 25.4;\n\n  return conversionFactor * length + \"px\";\n};\n\nconst createPdf = (map, locationValue, setLoading) => {\n  setLoading(true);\n\n  const width = 210;\n  const height = 297;\n  // Calculate pixel ratio\n  const actualPixelRatio = window.devicePixelRatio;\n\n  // Create map container\n  const hidden = document.createElement(\"div\");\n  hidden.className = \"hidden-map\";\n  document.body.appendChild(hidden);\n  const container = document.createElement(\"div\");\n  container.style.width = toPixels(width);\n  container.style.height = toPixels(height);\n  hidden.appendChild(container);\n\n  //Render map\n  var renderMap = new maplibregl.Map({\n    container: container,\n    center: map.getCenter(),\n    zoom: map.getZoom(),\n    bearing: map.getBearing(),\n    pitch: map.getPitch(),\n    interactive: false,\n    preserveDrawingBuffer: true,\n    fadeDuration: 0,\n    attributionControl: false,\n  });\n  let style = map.getStyle();\n  for (let name in style.sources) {\n    let src = style.sources[name];\n\n    Object.keys(src).forEach((key) => {\n      //delete properties if value is undefined.\n      // for instance, raster-dem might has undefined value in \"url\" and \"bounds\"\n      if (!src[key]) {\n        delete src[key];\n      }\n    });\n  }\n  renderMap.setStyle(style);\n\n  renderMap.once(\"idle\", function () {\n    // TO DO: It is still under development\n    const pdf = new jsPDF({\n      orientation: \"p\",\n      unit: \"mm\",\n      compress: true,\n    });\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function () {\n        return 300 / 96;\n      },\n    });\n    const offsetX = 2.5;\n    const offsetY = 2.5;\n    const marginTop = 3;\n    const marginBottom = 3;\n    const innerMargin = 2;\n    const logo =\n      \"data:image/png;base64,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\";\n    const textBuffer = 1;\n    const lineHeight = 3.25;\n    const text = locationValue ? nmConverter(locationValue.address) : \"\";\n    const textChunksSeperator = text.split(\",\");\n    const textChunks = [];\n\n    if (textChunks.length) {\n      textChunksSeperator.forEach((chunk) => {\n        const limitChunks = chunk.match(/.{1,34}/g);\n        textChunks.push(...limitChunks);\n      });\n    }\n\n    //Render map image\n    pdf.addImage(\n      renderMap.getCanvas().toDataURL(\"image/png\"),\n      \"png\",\n      0,\n      0,\n      210,\n      297,\n      null,\n      \"FAST\"\n    );\n\n    //Render lower left Copyright box\n    pdf.setFillColor(\"white\");\n    pdf.rect(138, 287, 297, 10, \"F\");\n    pdf.setFontSize(10); // optional\n    pdf.text(\n      \"Datenquelle: © OpenStreetMap-Mitwirkende\",\n      140,\n      pdf.internal.pageSize.height - 3\n    );\n\n    //Render infobox\n    pdf.setFillColor(\"white\");\n    const infoBoxSize =\n      textChunks.length * lineHeight +\n      marginTop +\n      marginBottom +\n      lineHeight * 2 +\n      innerMargin * 2 +\n      textBuffer;\n\n    pdf.rect(offsetX, 2, 66.5, infoBoxSize, \"F\");\n\n    pdf.setFontSize(10);\n    pdf.text(\"Karten PDF:\", 6, offsetY + marginTop);\n\n    //Render inner infobox\n    pdf.rect(\n      6,\n      7,\n      60,\n      textChunks.length * lineHeight + innerMargin * 2 + textBuffer\n    );\n    pdf.setFontSize(10);\n\n    //Write out address\n    textChunks.forEach((text, i) => {\n      pdf.text(text.trim(), 8, 10 + i * 3.5 + innerMargin);\n    });\n\n    //Add WG Logo\n    pdf.addImage(\n      logo,\n      \"png\",\n      5,\n      offsetY + marginTop + lineHeight * 2 + textChunks.length * 3 + innerMargin * 2,\n      3,\n      3,\n      null,\n      \"FAST\"\n    );\n\n    //Add WG Url\n    pdf.setFontSize(10);\n    pdf.text(\n      \"wheregroup.com\",\n      40,\n      offsetY +\n        marginTop +\n        lineHeight * 2 +\n        textChunks.length * lineHeight +\n        innerMargin * 2 +\n        textBuffer\n    );\n\n    //Set pdfs props\n    pdf.setProperties({\n      title: \"Map export\",\n      subject: \"Map export\",\n      creator: \"WhereGroup GmbH\",\n      author: \"(c)WhereGroup GmbH, (c)OpenStreetMap\",\n    });\n\n    pdf.save(\"Map.pdf\");\n\n    renderMap.remove();\n    hidden.parentNode?.removeChild(hidden);\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function () {\n        return actualPixelRatio;\n      },\n    });\n\n    setLoading(false);\n  });\n};\n\nexport default createPdf;\n","import React, { useRef, useEffect, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MapContext } from \"@mapcomponents/react-core\";\n\nimport createPdf from \"./lib/createPdf.js\";\n\nimport PrinterIcon from \"@mui/icons-material/Print\";\nimport Button from \"@mui/material/Button\";\n\n/**\n * Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).\n *\n * @component\n */\nconst MlCreatePdfButton = (props) => {\n  const mapContext = useContext(MapContext);\n  const initializedRef = useRef(false);\n  const mapRef = useRef(undefined);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n  }, [mapContext.mapIds, mapContext, props.mapId]);\n\n  return (\n    <>\n      <Button\n        color=\"primary\"\n        variant=\"contained\"\n        onClick={() => {\n          createPdf(mapRef.current, null, () => {});\n        }}\n      >\n        <PrinterIcon />\n      </Button>\n    </>\n  );\n};\n\nMlCreatePdfButton.defaultProps = {\n  mapId: undefined,\n};\n\nMlCreatePdfButton.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n};\n\nexport default MlCreatePdfButton;\n","import React, { useRef, useCallback, useEffect } from \"react\";\n\nimport useMap from \"../../hooks/useMap\";\n\nconst MlImageMarkerLayer = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const layerInitializedRef = useRef(false);\n  const imageIdRef = useRef(props.imageId || \"img_\" + new Date().getTime());\n  const layerId = useRef(props.layerId || \"MlImageMarkerLayer-\" + mapHook.componentId);\n\n  useEffect(() => {\n    if (\n      !mapHook.mapIsReady ||\n      (mapHook.map && !mapHook.map.getLayer(layerId.current)) ||\n      !props.options\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    var key;\n\n    if (props.options.layout) {\n      for (key in props.options.layout) {\n        mapHook.map.setLayoutProperty(layerId.current, key, props.options.layout[key]);\n      }\n    }\n    if (props.options.paint) {\n      for (key in props.options.paint) {\n        mapHook.map.setPaintProperty(layerId.current, key, props.options.paint[key]);\n      }\n    }\n  }, [props.options, layerId.current, props.mapId]);\n\n  const addLayer = useCallback(() => {\n    let tmpOptions = {\n      id: layerId.current,\n      layout: {},\n      ...props.options,\n    };\n    tmpOptions.layout[\"icon-image\"] = imageIdRef.current;\n    mapHook.map.addLayer(tmpOptions, props.insertBeforeLayer, mapHook.componentId);\n  }, [props, mapHook.mapIsReady, mapHook.map]);\n\n  useEffect(() => {\n    if (!props.options || !mapHook.mapIsReady || layerInitializedRef.current) return;\n\n    layerInitializedRef.current = true;\n\n    if (props.imgSrc) {\n      mapHook.map.loadImage(props.imgSrc, function (error, image) {\n        if (error) throw error;\n        mapHook.map.addImage(imageIdRef.current, image, mapHook.componentId);\n      });\n    }\n\n    addLayer();\n  }, [mapHook.mapIsReady, mapHook.map, addLayer, props]);\n\n  useEffect(() => {\n    if (\n      !mapHook.mapIsReady ||\n      (mapHook.map && !mapHook.map.getLayer(layerId.current)) ||\n      !props.options\n    ) {\n      return;\n    }\n\n    mapHook.map.getSource(layerId.current).setData(props.options.source.data);\n  }, [props.options.source.data, props]);\n\n  return <></>;\n};\n\nexport default MlImageMarkerLayer;\n","import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { ReactComponent as RotateRightIcon } from \"./assets/rotate_right.svg\";\nimport { ReactComponent as RotateLeftIcon } from \"./assets/rotate_left.svg\";\nimport { ReactComponent as NeedleIcon } from \"./assets/needle.svg\";\n\nimport styled from \"@emotion/styled\";\nimport { css } from \"@emotion/css\";\nimport useMap from \"../../hooks/useMap\";\n\nconst NeedleButton = styled.div`\n  width: 40%;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n  path {\n    filter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n  }\n  &:hover path {\n    filter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n  }\n  path:nth-of-type(2) {\n    fill: #343434;\n  }\n  &:hover path:nth-of-type(2) {\n    fill: #434343;\n  }\n  path:nth-of-type(1) {\n    fill: #e90318;\n  }\n  &:hover path:nth-of-type(1) {\n    fill: #fb4052;\n  }\n`;\nconst NeedleContainer = styled.div`\n  pointer-events: none;\n  display: flex;\n  z-index: 1002;\n  position: absolute;\n  align-items: center;\n\n  margin-left: -30%;\n  path:nth-of-type(2) {\n  }\n  svg g {\n    transform: translate(-76.7053, -29.7727) scale(2, 1);\n  }\n  svg {\n    z-index: 9990;\n    height: 150px;\n    width: 200px;\n  }\n`;\nconst RotateButton = styled.div`\n  width: 30%;\n  margin-top: 14px;\n  z-index: 999;\n  display: flex;\n\n  svg:hover {\n    cursor: pointer;\n  }\n  svg:hover path {\n    fill: #ececec;\n    filter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n  }\n  path {\n    fill: #bbb;\n  }\n  svg {\n    transform: scale(0.6);\n    z-index: 9990;\n    height: 172px;\n  }\n`;\n\n/**\n * Navigation component that displays a compass component which indicates the current oriantation of the map it is registered for and offers controls to turn the bearing 90° left/right or reset north to point up.\n *\n * All style props are applied using @emotion/css to allow more complex css selectors.\n *\n * @component\n */\nconst MlNavigationCompass = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n  const [bearing, setBearing] = useState(0);\n\n  useEffect(() => {\n    if (!mapHook.map) return;\n\n    let _updateBearing = () => {\n      setBearing(Math.round(mapHook.map.getBearing()));\n    };\n\n    mapHook.map.on(\"rotate\", _updateBearing, mapHook.componentId);\n    _updateBearing();\n\n    return () => {\n      mapHook.map.off(\"rotate\", _updateBearing);\n    };\n  }, [mapHook.map, props.mapId]);\n\n  return (\n    <>\n      <div\n        className={css({\n          zIndex: 1000,\n          top: 0,\n          position: \"absolute\",\n          ...props.style,\n        })}\n      >\n        <div\n          className={css({\n            position: \"absolute\",\n            border: \"10px solid #bcbcbc\",\n            backgroundColor: \"#717171\",\n            background: \"radial-gradient(#717171, #414141)\",\n            height: \"200px\",\n            width: \"200px\",\n            borderRadius: \"50%\",\n            display: \"flex\",\n            justifyContent: \"center\",\n            transform: \"scale(0.2) translateX(-448px) translateY(-448px)\",\n            ...props.backgroundStyle,\n          })}\n        >\n          <RotateButton className={css({ ...props.rotateRightStyle })}>\n            <RotateRightIcon\n              onClick={() => {\n                let bearing = Math.round(mapHook.map?.getBearing());\n                let rest = Math.round(bearing % 90);\n                if (bearing > 0) {\n                  rest = 90 - rest;\n                }\n                if (rest === 0) {\n                  rest = 90;\n                }\n                mapHook.map?.setBearing(Math.round(bearing + Math.abs(rest)));\n              }}\n            ></RotateRightIcon>\n          </RotateButton>\n          <NeedleButton\n            className={css({ ...props.needleStyle })}\n            onClick={() => {\n              mapHook.map?.setBearing(0);\n            }}\n          >\n            <NeedleContainer\n              style={{\n                transform: \"rotate(\" + bearing + \"deg)\",\n              }}\n            >\n              <NeedleIcon />\n            </NeedleContainer>\n          </NeedleButton>\n          <RotateButton className={css({ ...props.rotateLeftStyle })}>\n            <RotateLeftIcon\n              onClick={() => {\n                let bearing = Math.round(mapHook.map?.getBearing());\n                let rest = Math.round(bearing % 90);\n                if (bearing < 0) {\n                  rest = 90 + rest;\n                }\n                if (rest === 0) {\n                  rest = 90;\n                }\n                mapHook.map?.setBearing(Math.round(bearing - Math.abs(rest)));\n              }}\n            ></RotateLeftIcon>\n          </RotateButton>\n        </div>\n      </div>\n    </>\n  );\n};\n\nMlNavigationCompass.propTypes = {\n  /**\n   * Component id prefix\n   */\n  idPrefix: PropTypes.string,\n  /**\n   * Style object to adjust css definitions of the component.\n   */\n  style: PropTypes.object,\n  /**\n   * Style object to adjust css definitions of the background.\n   */\n  backgroundStyle: PropTypes.object,\n  /**\n   * Style object to adjust css definitions of the compass needle.\n   */\n  needleStyle: PropTypes.object,\n  /**\n   * Style object to adjust css definitions of the rotate right button.\n   */\n  rotateRightStyle: PropTypes.object,\n  /**\n   * Style object to adjust css definitions of the rotate left button.\n   */\n  rotateLeftStyle: PropTypes.object,\n};\n\nexport default MlNavigationCompass;\n","import React, { useEffect, useState } from \"react\";\nimport Button from \"@mui/material/Button\";\nimport ButtonGroup from \"@mui/material/ButtonGroup\";\nimport ControlPointIcon from \"@mui/icons-material/ControlPoint\";\nimport RemoveCircleOutlineIcon from \"@mui/icons-material/RemoveCircleOutline\";\nimport GpsFixedIcon from \"@mui/icons-material/GpsFixed\";\n\nimport MlNavigationCompass from \"../MlNavigationCompass/MlNavigationCompass\";\nimport MlFollowGps from \"../MlFollowGps/MlFollowGps\";\nimport useMediaQuery from \"@mui/material/useMediaQuery\";\nimport useMap from \"../../hooks/useMap\";\n\nconst MlNavigationTools = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const [pitch, setPitch] = useState(0);\n  const [locationAccessDenied, setLocationAccessDenied] = useState(false);\n  const mediaIsMobile = useMediaQuery(\"(max-width:900px)\");\n  const buttonStyle = {\n    minWidth: \"20px\",\n    minHeight: \"20px\",\n    width: mediaIsMobile ? \"50px\" : \"30px\",\n    height: mediaIsMobile ? \"50px\" : \"30px\",\n    backgroundColor: \"#414141\",\n    borderRadius: \"23%\",\n    //border: \"1px solid #bbb\",\n    //boxShadow: \"0px 0px 4px rgba(0,0,0,.5)\",\n    margin: 0.15,\n    fontSize: mediaIsMobile ? \"1.5em\" : \"1.2em\",\n    \":hover\": {\n      backgroundColor: \"#515151\",\n    },\n    color: \"#ececec\",\n  };\n\n  useEffect(() => {\n    if (!mapHook.map) return;\n\n    mapHook.map.on(\"pitchend\", () => {\n      setPitch(mapHook.map.getPitch());\n    });\n    setPitch(mapHook.map.getPitch());\n  }, [mapHook.map, props.mapId]);\n\n  const zoomIn = () => {\n    if (!mapHook.map) return;\n\n    if (mapHook.map.transform._zoom + 0.5 <= mapHook.map.transform._maxZoom) {\n      mapHook.map.easeTo({ zoom: mapHook.map.transform._zoom + 0.5 });\n    }\n  };\n\n  const zoomOut = () => {\n    if (!mapHook.map) return;\n\n    if (mapHook.map.transform._zoom - 0.5 >= mapHook.map.transform._minZoom) {\n      mapHook.map.easeTo({ zoom: mapHook.map.transform._zoom - 0.5 });\n    }\n  };\n\n  const adjustPitch = () => {\n    if (!mapHook.map) return;\n\n    let targetPitch = 60;\n    if (mapHook.map.getPitch() !== 0) {\n      targetPitch = 0;\n    }\n    mapHook.map.easeTo({ pitch: targetPitch });\n  };\n\n  const moveToCurrentLocation = () => {\n    navigator.geolocation.getCurrentPosition(getLocationSuccess, getLocationError);\n  };\n\n  const getLocationSuccess = (location) => {\n    mapHook.map.setCenter([location.coords.longitude, location.coords.latitude]);\n  };\n\n  const getLocationError = () => {\n    console.log(\"Access of user location denied\");\n    setLocationAccessDenied(true);\n  };\n\n  return (\n    <div\n      style={{\n        zIndex: 501,\n        position: \"absolute\",\n        right: mediaIsMobile ? \"15px\" : \"5px\",\n        bottom: mediaIsMobile ? \"40px\" : \"20px\",\n        display: \"flex\",\n        flexDirection: \"column\",\n      }}\n    >\n      <MlNavigationCompass\n        style={{\n          width: \"31px\",\n          position: \"relative\",\n          height: mediaIsMobile ? \"55px\" : \"45px\",\n          marginLeft: mediaIsMobile ? \"3px\" : \"-5px\",\n          transform: mediaIsMobile ? \"scale(1.6)\" : \"scale(1)\",\n        }}\n        backgroundStyle={{\n          boxShadow: \"0px 0px 18px rgba(0,0,0,.5)\",\n        }}\n      />\n      <Button sx={{ ...buttonStyle, fontWeight: 600 }} onClick={adjustPitch}>\n        {pitch ? \"2D\" : \"3D\"}\n      </Button>\n      <Button sx={buttonStyle} onClick={moveToCurrentLocation} disabled={locationAccessDenied}>\n        <GpsFixedIcon sx={{ fontSize: mediaIsMobile ? \"1.5em\" : \"1.2em\" }} />\n      </Button>\n      <MlFollowGps style={{ ...(({ color, ...rest }) => rest)(buttonStyle) }} />\n      <ButtonGroup\n        orientation=\"vertical\"\n        sx={{\n          width: \"50px\",\n          border: \"none\",\n          Button: { minWidth: \"20px !important\", border: \"none\", padding: 0 },\n          \"Button:hover\": { border: \"none\" },\n        }}\n      >\n        <Button sx={{ ...buttonStyle, color: \"#ececec\" }} onClick={zoomIn}>\n          <ControlPointIcon sx={{ fontSize: mediaIsMobile ? \"1.5em\" : \"1.2em\" }} />\n        </Button>\n        <Button sx={{ ...buttonStyle, color: \"#ececec\" }} onClick={zoomOut}>\n          <RemoveCircleOutlineIcon sx={{ fontSize: mediaIsMobile ? \"1.5em\" : \"1.2em\" }} />\n        </Button>\n      </ButtonGroup>\n    </div>\n  );\n};\n\nexport default MlNavigationTools;\n","import React, { useRef, useEffect, useContext } from \"react\";\n\nimport { v4 as uuidv4 } from \"uuid\";\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport useMapState from \"../../hooks/useMapState\";\n\nconst MlLayer = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n\n  const mapState = useMapState({\n    mapId: props.mapId,\n    watch: {\n      viewport: false,\n      layers: true,\n      sources: false,\n    },\n  });\n  const layerInitializedRef = useRef(false);\n  const mapRef = useRef(null);\n  const componentId = useRef((props.layerId ? props.layerId : \"MlLayer-\") + uuidv4());\n  const layerId = useRef(props.layerId || componentId.current);\n  const layerPaintConfRef = useRef(undefined);\n  const layerLayoutConfRef = useRef(undefined);\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        mapRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId)?.getLayer?.(layerId) ||\n      !layerInitializedRef.current ||\n      !props.options\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    var key;\n\n    let layoutString = JSON.stringify(props.options.layout);\n    if (props.options.layout && layoutString !== layerLayoutConfRef.current) {\n      for (key in props.options.layout) {\n        mapRef.current.setLayoutProperty(layerId, key, props.options.layout[key]);\n      }\n      layerLayoutConfRef.current = layoutString;\n    }\n\n    let paintString = JSON.stringify(props.options.paint);\n    if (props.options.paint && paintString === layerPaintConfRef.current) {\n      for (key in props.options.paint) {\n        mapRef.current.setPaintProperty(layerId, key, props.options.paint[key]);\n      }\n    }\n  }, [props.options, layerId, mapContext, props]);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || layerInitializedRef.current) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    //check if insertBeforeLayer exists\n    if (props.insertBeforeLayer) {\n      let layerFound = false;\n\n      mapState?.layers?.forEach((layer) => {\n        if (layer.id === props.insertBeforeLayer) {\n          layerFound = true;\n        }\n      });\n      if (!layerFound) {\n        return;\n      }\n    }\n\n    mapRef.current = mapContext.getMap(props.mapId);\n    if (mapRef.current) {\n      layerInitializedRef.current = true;\n      mapRef.current.addLayer(\n        {\n          id: layerId.current,\n          type: \"background\",\n          paint: {\n            \"background-color\": \"rgba(0,0,0,0)\",\n          },\n          ...props.options,\n        },\n        props.insertBeforeLayer,\n        componentId.current\n      );\n      layerPaintConfRef.current = JSON.stringify(props.options?.paint);\n      layerLayoutConfRef.current = JSON.stringify(props.options?.layout);\n    }\n  }, [mapContext.mapIds, mapContext, props, mapState.layers]);\n\n  return <></>;\n};\n\nexport default MlLayer;\n","import React, { useRef, useEffect, useState } from \"react\";\n\nimport PropTypes from \"prop-types\";\nimport useMap from \"../../hooks/useMap\";\n\n/**\n * Adds a standard OSM tile layer to the maplibre-gl instancereference by\n * props.mapId\n *\n * @component\n */\nconst MlOsmLayer = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const layerId = useRef(props.layerId || \"MlOsmLayer-\" + mapHook.componentId);\n\n  useEffect(() => {\n    if (!mapHook.map) return;\n\n    mapHook.map.addSource(\n      layerId.current,\n      {\n        type: \"raster\",\n        tileSize: 256,\n        ...props.sourceOptions,\n      },\n      mapHook.componentId\n    );\n    mapHook.map.addLayer(\n      {\n        id: layerId.current,\n        type: \"raster\",\n        source: layerId.current,\n        minzoom: 0,\n        maxzoom: 22,\n        ...props.layerOptions,\n      },\n      props.insertBeforeLayer,\n      mapHook.componentId\n    );\n  }, [props, mapHook.map]);\n\n  return <></>;\n};\n\nMlOsmLayer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapHook\n   */\n  mapId: PropTypes.string,\n  /**\n   * Prefix of the component id this component uses when adding elements to the MapLibreGl-instance\n   */\n  idPrefix: PropTypes.string,\n  /**\n   * Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation.\n   */\n  sourceOptions: PropTypes.object,\n  /**\n   * Options object that will be used as first parameter on the MapLibreGl.addLayer call see MapLibre layer options documentation.\n   *\n   */\n  layerOptions: PropTypes.object,\n  /**\n   * The layerId of an existing layer this layer should be rendered visually beneath\n   * https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see \"beforeId\" property\n   */\n  insertBeforeLayer: PropTypes.string,\n};\n\nexport default MlOsmLayer;\n","import React, { useRef, useEffect } from \"react\";\nimport useMap from \"../../hooks/useMap\";\nimport PropTypes from \"prop-types\";\n\n/**\n * Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by\n * props.mapId\n *\n * @component\n */\nconst MlVectorTileLayer = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const layerIdsRef = useRef({});\n  const layerId = useRef(props.layerId || \"MlVectorTileLayer-\" + mapHook.componentId);\n  const layerPaintConfsRef = useRef({});\n  const layerLayoutConfsRef = useRef({});\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (!mapHook.map || initializedRef.current) return;\n\n    initializedRef.current = true;\n\n    // Add the new layer to the openlayers instance once it is available\n    mapHook.map.addSource(\n      layerId.current,\n      {\n        type: \"vector\",\n        tiles: [props.url],\n        tileSize: 512,\n        attribution: \"\",\n        ...props.sourceOptions,\n      },\n      mapHook.componentId\n    );\n\n    for (let key in props.layers) {\n      let _layerId = layerId.current + \"_\" + key;\n      layerIdsRef.current[key] = _layerId;\n\n      mapHook.map.addLayer(\n        {\n          id: _layerId,\n          source: layerId.current,\n          type: \"line\",\n          minzoom: 0,\n          maxzoom: 22,\n          layout: {},\n          paint: {\n            \"line-opacity\": 0.5,\n            \"line-color\": \"rgb(80, 80, 80)\",\n            \"line-width\": 2,\n          },\n          ...props.layers[key],\n        },\n        props.insertBeforeLayer,\n        mapHook.componentId\n      );\n      layerPaintConfsRef.current[key] = JSON.stringify(props.layers[key].paint);\n      layerLayoutConfsRef.current[key] = JSON.stringify(props.layers[key].layout);\n    }\n  }, [mapHook.map, props]);\n\n  useEffect(() => {\n    if (!mapHook.map || !initializedRef.current) return;\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    for (var key in props.layers) {\n      if (mapHook.map.getLayer(layerIdsRef.current[key])) {\n        // update changed paint property\n        let layerPaintConfString = JSON.stringify(props.layers[key].paint);\n\n        if (layerPaintConfString !== layerPaintConfsRef.current[key]) {\n          for (let paintKey in props.layers[key].paint) {\n            mapHook.map.setPaintProperty(\n              layerIdsRef.current[key],\n              paintKey,\n              props.layers[key].paint[paintKey]\n            );\n          }\n        }\n        layerPaintConfsRef.current[key] = layerPaintConfString;\n\n        // update changed layout property\n        let layerLayoutConfString = JSON.stringify(props.layers[key].layout);\n\n        if (layerLayoutConfString !== layerLayoutConfsRef.current[key]) {\n          for (let layoutKey in props.layers[key].layout) {\n            mapHook.map.setLayoutProperty(\n              layerIdsRef.current[key],\n              layoutKey,\n              props.layers[key].layout[layoutKey]\n            );\n          }\n        }\n        layerLayoutConfsRef.current[key] = layerLayoutConfString;\n      }\n    }\n  }, [props.layers, mapHook.map]);\n\n  return <></>;\n};\n\nMlVectorTileLayer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation.\n   */\n  sourceOptions: PropTypes.object,\n  /**\n   * Object that hold layers\n   */\n  layers: PropTypes.object,\n  /**\n   * String of the URL of a wms layer\n   */\n  url: PropTypes.string,\n};\n\nexport default MlVectorTileLayer;\n","import React, { useRef, useEffect } from \"react\";\nimport useMap from \"../../hooks/useMap\";\n\nimport PropTypes from \"prop-types\";\n\nconst defaultProps = {\n  visible: true,\n  urlParameters: {\n    bbox: \"{bbox-epsg-3857}\",\n    format: \"image/png\",\n    service: \"WMS\",\n    version: \"1.1.1\",\n    request: \"GetMap\",\n    srs: \"EPSG:3857\",\n    width: 256,\n    height: 256,\n    styles: \"\",\n  },\n  attribution: \"\",\n  sourceOptions: {\n    minZoom: 0,\n    maxZoom: 20,\n  },\n  layerOptions: {\n    minZoom: 0,\n    maxZoom: 20,\n  },\n};\n\n/**\n * Adds a WMS raster source & layer to the maplibre-gl instance\n *\n * @param {object} props\n * @param {object} props.urlParameters URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object\n * @param {string} props.url WMS URL\n * @param {bool} props.visible Sets layer \"visibility\" property to \"visible\" if true or \"none\" if false\n * @param {string} props.attribution MapLibre attribution shown in the bottom right of the map, if this layer is visible\n * @param {string} props.mapId Id of the target MapLibre instance in mapContext\n * @param {object} props.sourceOptions Object that is passed to the MapLibre.addSource call as config option parameter\n * @param {object} props.layerOptions Object that is passed to the MapLibre.addLayer call as config option parameter\n * @param {string} props.insertBeforeLayer Id of an existing layer in the mapLibre instance to help specify the layer order\n                                           This layer will be visually beneath the layer with the \"insertBeforeLayer\" id\n *\n * @component\n */\nconst MlWmsLayer = (props) => {\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n\n  const initializedRef = useRef(false);\n  const layerId = useRef(props.layerId || \"MlWmsLayer-\" + mapHook.componentId);\n\n  useEffect(() => {\n    if (!mapHook.map || initializedRef.current) return;\n\n    initializedRef.current = true;\n\n    let _propsUrlParams;\n    let _wmsUrl = props.url;\n    if (props.url.indexOf(\"?\") !== -1) {\n      _propsUrlParams = props.url.split(\"?\");\n      _wmsUrl = _propsUrlParams[0];\n    }\n    let _urlParamsFromUrl = new URLSearchParams(_propsUrlParams?.[1]);\n    // first spread in default props manually to enable overriding a single parameter without replacing the whole default urlParameters object\n    let urlParamsObj = {\n      ...defaultProps.urlParameters,\n      ...Object.fromEntries(_urlParamsFromUrl),\n      ...props.urlParameters,\n    };\n    let urlParams = new URLSearchParams(urlParamsObj);\n    let urlParamsStr =\n      decodeURIComponent(urlParams.toString()) + \"\".replace(/%2F/g, \"/\").replace(/%3A/g, \":\");\n\n    mapHook.map.addSource(\n      layerId.current,\n      {\n        type: \"raster\",\n        tiles: [_wmsUrl + \"?\" + urlParamsStr],\n        tileSize: urlParamsObj.width,\n        attribution: props.attribution,\n        ...props.sourceOptions,\n      },\n      mapHook.componentId\n    );\n\n    mapHook.map.addLayer(\n      {\n        id: layerId.current,\n        type: \"raster\",\n        source: layerId.current,\n        ...props.layerOptions,\n      },\n      props.insertBeforeLayer,\n      mapHook.componentId\n    );\n\n    if (!props.visible) {\n      mapHook.map.setLayoutProperty(layerId.current, \"visibility\", \"none\");\n    }\n  }, [mapHook, props]);\n\n  useEffect(() => {\n    if (!mapHook.map || !initializedRef.current) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (props.visible) {\n      mapHook.map.setLayoutProperty(layerId.current, \"visibility\", \"visible\");\n    } else {\n      mapHook.map.setLayoutProperty(layerId.current, \"visibility\", \"none\");\n    }\n  }, [props.visible, mapHook.map]);\n\n  return <></>;\n};\n\nMlWmsLayer.defaultProps = {\n  ...defaultProps,\n};\n\nMlWmsLayer.propTypes = {\n  /**\n   * WMS URL\n   */\n  url: PropTypes.string.isRequired,\n  /**\n   * URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object.\n   */\n  urlParameters: PropTypes.shape({\n    layers: PropTypes.string.isRequired,\n    bbox: PropTypes.string,\n    format: PropTypes.string,\n    service: PropTypes.string,\n    version: PropTypes.string,\n    request: PropTypes.string,\n    srs: PropTypes.string,\n    width: PropTypes.number,\n    height: PropTypes.number,\n  }),\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * MapLibre attribution shown in the bottom right of the map, if this layer is visible\n   */\n  attribution: PropTypes.string,\n  /**\n   * Object that is passed to the MapLibre.addLayer call as config option parameter\n   */\n  layerOptions: PropTypes.object,\n  /**\n   * Object that is passed to the MapLibre.addSource call as config option parameter\n   */\n  sourceOptions: PropTypes.object,\n  /**\n   * Id of an existing layer in the mapLibre instance to help specify the layer order\n   * This layer will be visually beneath the layer with the \"insertBeforeLayer\" id.\n   */\n  insertBeforeLayer: PropTypes.string,\n  /**\n   * Sets layer \"visibility\" property to \"visible\" if true or \"none\" if false\n   */\n  visible: PropTypes.bool,\n};\nexport default MlWmsLayer;\n","export const classes = {\n  CONTROL_BASE: 'mapboxgl-ctrl',\n  CONTROL_PREFIX: 'mapboxgl-ctrl-',\n  CONTROL_BUTTON: 'mapbox-gl-draw_ctrl-draw-btn',\n  CONTROL_BUTTON_LINE: 'mapbox-gl-draw_line',\n  CONTROL_BUTTON_POLYGON: 'mapbox-gl-draw_polygon',\n  CONTROL_BUTTON_POINT: 'mapbox-gl-draw_point',\n  CONTROL_BUTTON_TRASH: 'mapbox-gl-draw_trash',\n  CONTROL_BUTTON_COMBINE_FEATURES: 'mapbox-gl-draw_combine',\n  CONTROL_BUTTON_UNCOMBINE_FEATURES: 'mapbox-gl-draw_uncombine',\n  CONTROL_GROUP: 'mapboxgl-ctrl-group',\n  ATTRIBUTION: 'mapboxgl-ctrl-attrib',\n  ACTIVE_BUTTON: 'active',\n  BOX_SELECT: 'mapbox-gl-draw_boxselect'\n};\n\nexport const sources = {\n  HOT: 'mapbox-gl-draw-hot',\n  COLD: 'mapbox-gl-draw-cold'\n};\n\nexport const cursors = {\n  ADD: 'add',\n  MOVE: 'move',\n  DRAG: 'drag',\n  POINTER: 'pointer',\n  NONE: 'none'\n};\n\nexport const types = {\n  POLYGON: 'polygon',\n  LINE: 'line_string',\n  POINT: 'point'\n};\n\nexport const geojsonTypes = {\n  FEATURE: 'Feature',\n  POLYGON: 'Polygon',\n  LINE_STRING: 'LineString',\n  POINT: 'Point',\n  FEATURE_COLLECTION: 'FeatureCollection',\n  MULTI_PREFIX: 'Multi',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon'\n};\n\nexport const modes = {\n  DRAW_LINE_STRING: 'draw_line_string',\n  DRAW_POLYGON: 'draw_polygon',\n  DRAW_POINT: 'draw_point',\n  SIMPLE_SELECT: 'simple_select',\n  DIRECT_SELECT: 'direct_select',\n  STATIC: 'static'\n};\n\nexport const events = {\n  CREATE: 'draw.create',\n  DELETE: 'draw.delete',\n  UPDATE: 'draw.update',\n  SELECTION_CHANGE: 'draw.selectionchange',\n  MODE_CHANGE: 'draw.modechange',\n  ACTIONABLE: 'draw.actionable',\n  RENDER: 'draw.render',\n  COMBINE_FEATURES: 'draw.combine',\n  UNCOMBINE_FEATURES: 'draw.uncombine'\n};\n\nexport const updateActions = {\n  MOVE: 'move',\n  CHANGE_COORDINATES: 'change_coordinates'\n};\n\nexport const meta = {\n  FEATURE: 'feature',\n  MIDPOINT: 'midpoint',\n  VERTEX: 'vertex'\n};\n\nexport const activeStates = {\n  ACTIVE: 'true',\n  INACTIVE: 'false'\n};\n\nexport const interactions = [\n  'scrollZoom',\n  'boxZoom',\n  'dragRotate',\n  'dragPan',\n  'keyboard',\n  'doubleClickZoom',\n  'touchZoomRotate'\n];\n\nexport const LAT_MIN = -90;\nexport const LAT_RENDERED_MIN = -85;\nexport const LAT_MAX = 90;\nexport const LAT_RENDERED_MAX = 85;\nexport const LNG_MIN = -270;\nexport const LNG_MAX = 270;\n","import * as Constants from \"./constants\";\n\nexport function isOfMetaType(type) {\n  return function (e) {\n    const featureTarget = e.featureTarget;\n    if (!featureTarget) return false;\n    if (!featureTarget.properties) return false;\n    return featureTarget.properties.meta === type;\n  };\n}\n\nexport function isShiftMousedown(e) {\n  if (!e.originalEvent) return false;\n  if (!e.originalEvent.shiftKey) return false;\n  return e.originalEvent.button === 0;\n}\n\nexport function isActiveFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return (\n    e.featureTarget.properties.active === Constants.activeStates.ACTIVE &&\n    e.featureTarget.properties.meta === Constants.meta.FEATURE\n  );\n}\n\nexport function isInactiveFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return (\n    e.featureTarget.properties.active === Constants.activeStates.INACTIVE &&\n    e.featureTarget.properties.meta === Constants.meta.FEATURE\n  );\n}\n\nexport function noTarget(e) {\n  return e.featureTarget === undefined;\n}\n\nexport function isFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return e.featureTarget.properties.meta === Constants.meta.FEATURE;\n}\n\nexport function isVertex(e) {\n  const featureTarget = e.featureTarget;\n  if (!featureTarget) return false;\n  if (!featureTarget.properties) return false;\n  return featureTarget.properties.meta === Constants.meta.VERTEX;\n}\n\nexport function isShiftDown(e) {\n  if (!e.originalEvent) return false;\n  return e.originalEvent.shiftKey === true;\n}\n\nexport function isEscapeKey(e) {\n  return e.keyCode === 27;\n}\n\nexport function isEnterKey(e) {\n  return e.keyCode === 13;\n}\n\nexport function isTrue() {\n  return true;\n}\n","const doubleClickZoom = {\n  enable(ctx) {\n    setTimeout(() => {\n      // First check we've got a map and some context.\n      if (\n        !ctx.map ||\n        !ctx.map.doubleClickZoom ||\n        !ctx._ctx ||\n        !ctx._ctx.store ||\n        !ctx._ctx.store.getInitialConfigValue\n      )\n        return;\n      // Now check initial state wasn't false (we leave it disabled if so)\n      if (!ctx._ctx.store.getInitialConfigValue(\"doubleClickZoom\")) return;\n      ctx.map.doubleClickZoom.enable();\n    }, 0);\n  },\n  disable(ctx) {\n    setTimeout(() => {\n      if (!ctx.map || !ctx.map.doubleClickZoom) return;\n      // Always disable here, as it's necessary in some cases.\n      ctx.map.doubleClickZoom.disable();\n    }, 0);\n  },\n};\nexport default doubleClickZoom;\n","function isEventAtCoordinates(event, coordinates) {\n  if (!event.lngLat) return false;\n  return event.lngLat.lng === coordinates[0] && event.lngLat.lat === coordinates[1];\n}\n\nexport default isEventAtCoordinates;\n","import * as Constants from \"./constants\";\n\n/**\n * Returns GeoJSON for a Point representing the\n * vertex of another feature.\n *\n * @param {string} parentId\n * @param {Array<number>} coordinates\n * @param {string} path - Dot-separated numbers indicating exactly\n *   where the point exists within its parent feature's coordinates.\n * @param {boolean} selected\n * @return {GeoJSON} Point\n */\nconst create_vertex = function (parentId, coordinates, path, selected) {\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.VERTEX,\n      parent: parentId,\n      coord_path: path,\n      active: selected\n        ? Constants.activeStates.ACTIVE\n        : Constants.activeStates.INACTIVE,\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates,\n    },\n  };\n};\nexport default create_vertex;\n","import * as CommonSelectors from \"./lib/common_selectors\";\nimport doubleClickZoom from \"./lib/double_click_zoom\";\nimport * as Constants from \"./lib/constants\";\nimport isEventAtCoordinates from \"./lib/is_event_at_coordinates\";\nimport createVertex from \"./lib/create_vertex\";\n\nconst CustomPolygonMode = {};\n\nCustomPolygonMode.onSetup = function () {\n  console.log(\"Change mode: custom polygon\");\n\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]],\n    },\n  });\n\n  this.addFeature(polygon);\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true,\n  });\n\n  return {\n    polygon,\n    currentVertexPosition: 0,\n  };\n};\n\nCustomPolygonMode.clickAnywhere = function (state, e) {\n  if (\n    state.currentVertexPosition > 0 &&\n    isEventAtCoordinates(\n      e,\n      state.polygon.coordinates[0][state.currentVertexPosition - 1]\n    )\n  ) {\n    return this.changeMode(\"custom_select\", {\n      featureIds: [state.polygon.id],\n    });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n  state.currentVertexPosition++;\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n\n  this.map.fire(Constants.events.CREATE, {\n    features: [state.polygon.toGeoJSON()],\n  });\n};\n\nCustomPolygonMode.clickOnVertex = function (state) {\n  return this.changeMode(\"custom_select\", {\n    featureIds: [state.polygon.id],\n  });\n};\n\nCustomPolygonMode.onMouseMove = function (state, e) {\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nCustomPolygonMode.onTap = CustomPolygonMode.onClick = function (state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  return this.clickAnywhere(state, e);\n};\n\nCustomPolygonMode.onKeyUp = function (state, e) {\n  if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(\"custom_select\");\n  } else if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(\"custom_select\", {\n      featureIds: [state.polygon.id],\n    });\n  }\n};\n\nCustomPolygonMode.onStop = function (state) {\n  this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.polygon.id) === undefined) return;\n\n  //remove last added coordinate\n  state.polygon.removeCoordinate(`0.${state.currentVertexPosition}`);\n  if (state.polygon.isValid()) {\n    this.map.fire(Constants.events.CREATE, {\n      features: [state.polygon.toGeoJSON()],\n    });\n  } else {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(\"custom_select\", {}, { silent: true });\n  }\n};\n\nCustomPolygonMode.toDisplayFeatures = function (state, geojson, display) {\n  const isActivePolygon = geojson.properties.id === state.polygon.id;\n  geojson.properties.active = isActivePolygon\n    ? Constants.activeStates.ACTIVE\n    : Constants.activeStates.INACTIVE;\n  if (!isActivePolygon) return display(geojson);\n\n  // Don't render a polygon until it has two positions\n  // (and a 3rd which is just the first repeated)\n  if (geojson.geometry.coordinates.length === 0) return;\n\n  const coordinateCount = geojson.geometry.coordinates[0].length;\n  // 2 coordinates after selecting a draw type\n  // 3 after creating the first point\n  if (coordinateCount < 3) {\n    return;\n  }\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(\n    createVertex(state.polygon.id, geojson.geometry.coordinates[0][0], \"0.0\", false)\n  );\n  if (coordinateCount > 3) {\n    // Add a start position marker to the map, clicking on this will finish the feature\n    // This should only be shown when we're in a valid spot\n    const endPos = geojson.geometry.coordinates[0].length - 3;\n    display(\n      createVertex(\n        state.polygon.id,\n        geojson.geometry.coordinates[0][endPos],\n        `0.${endPos}`,\n        false\n      )\n    );\n  }\n  if (coordinateCount <= 4) {\n    // If we've only drawn two positions (plus the closer),\n    // make a LineString instead of a Polygon\n    const lineCoordinates = [\n      [geojson.geometry.coordinates[0][0][0], geojson.geometry.coordinates[0][0][1]],\n      [geojson.geometry.coordinates[0][1][0], geojson.geometry.coordinates[0][1][1]],\n    ];\n    // create an initial vertex so that we can track the first point on mobile devices\n    display({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: geojson.properties,\n      geometry: {\n        coordinates: lineCoordinates,\n        type: Constants.geojsonTypes.LINE_STRING,\n      },\n    });\n    if (coordinateCount === 3) {\n      return;\n    }\n  }\n  // render the Polygon\n  return display(geojson);\n};\n\nCustomPolygonMode.onTrash = function (state) {\n  this.deleteFeature([state.polygon.id], { silent: true });\n  this.changeMode(\"custom_select\");\n};\n\nexport default CustomPolygonMode;\n","import Point from '@mapbox/point-geometry';\n\n/**\n * Returns a Point representing a mouse event's position\n * relative to a containing element.\n *\n * @param {MouseEvent} mouseEvent\n * @param {Node} container\n * @returns {Point}\n */\nfunction mouseEventPoint(mouseEvent, container) {\n  const rect = container.getBoundingClientRect();\n  return new Point(\n    mouseEvent.clientX - rect.left - (container.clientLeft || 0),\n    mouseEvent.clientY - rect.top - (container.clientTop || 0)\n  );\n}\n\nexport default mouseEventPoint;\n","import * as Constants from \"./constants\";\n\nconst create_midpoint = function (parent, startVertex, endVertex) {\n  const startCoord = startVertex.geometry.coordinates;\n  const endCoord = endVertex.geometry.coordinates;\n\n  // If a coordinate exceeds the projection, we can't calculate a midpoint,\n  // so run away\n  if (\n    startCoord[1] > Constants.LAT_RENDERED_MAX ||\n    startCoord[1] < Constants.LAT_RENDERED_MIN ||\n    endCoord[1] > Constants.LAT_RENDERED_MAX ||\n    endCoord[1] < Constants.LAT_RENDERED_MIN\n  ) {\n    return null;\n  }\n\n  const mid = {\n    lng: (startCoord[0] + endCoord[0]) / 2,\n    lat: (startCoord[1] + endCoord[1]) / 2,\n  };\n\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.MIDPOINT,\n      parent,\n      lng: mid.lng,\n      lat: mid.lat,\n      coord_path: endVertex.properties.coord_path,\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: [mid.lng, mid.lat],\n    },\n  };\n};\nexport default create_midpoint;\n","import createVertex from \"./create_vertex\";\nimport createMidpoint from \"./create_midpoint\";\nimport * as Constants from \"./constants\";\n\nfunction createSupplementaryPoints(geojson, options = {}, basePath = null) {\n  const { type, coordinates } = geojson.geometry;\n  const featureId = geojson.properties && geojson.properties.id;\n\n  let supplementaryPoints = [];\n\n  if (type === Constants.geojsonTypes.POINT) {\n    // For points, just create a vertex\n    supplementaryPoints.push(\n      createVertex(featureId, coordinates, basePath, isSelectedPath(basePath))\n    );\n  } else if (type === Constants.geojsonTypes.POLYGON) {\n    // Cycle through a Polygon's rings and\n    // process each line\n    coordinates.forEach((line, lineIndex) => {\n      processLine(\n        line,\n        basePath !== null ? `${basePath}.${lineIndex}` : String(lineIndex)\n      );\n    });\n  } else if (type === Constants.geojsonTypes.LINE_STRING) {\n    processLine(coordinates, basePath);\n  } else if (type.indexOf(Constants.geojsonTypes.MULTI_PREFIX) === 0) {\n    processMultiGeometry();\n  }\n\n  function processLine(line, lineBasePath) {\n    let firstPointString = \"\";\n    let lastVertex = null;\n    line.forEach((point, pointIndex) => {\n      const pointPath =\n        lineBasePath !== undefined && lineBasePath !== null\n          ? `${lineBasePath}.${pointIndex}`\n          : String(pointIndex);\n      const vertex = createVertex(\n        featureId,\n        point,\n        pointPath,\n        isSelectedPath(pointPath)\n      );\n\n      // If we're creating midpoints, check if there was a\n      // vertex before this one. If so, add a midpoint\n      // between that vertex and this one.\n      if (options.midpoints && lastVertex) {\n        const midpoint = createMidpoint(featureId, lastVertex, vertex);\n        if (midpoint) {\n          supplementaryPoints.push(midpoint);\n        }\n      }\n      lastVertex = vertex;\n\n      // A Polygon line's last point is the same as the first point. If we're on the last\n      // point, we want to draw a midpoint before it but not another vertex on it\n      // (since we already a vertex there, from the first point).\n      const stringifiedPoint = JSON.stringify(point);\n      if (firstPointString !== stringifiedPoint) {\n        supplementaryPoints.push(vertex);\n      }\n      if (pointIndex === 0) {\n        firstPointString = stringifiedPoint;\n      }\n    });\n  }\n\n  function isSelectedPath(path) {\n    if (!options.selectedPaths) return false;\n    return options.selectedPaths.indexOf(path) !== -1;\n  }\n\n  // Split a multi-geometry into constituent\n  // geometries, and accumulate the supplementary points\n  // for each of those constituents\n  function processMultiGeometry() {\n    const subType = type.replace(Constants.geojsonTypes.MULTI_PREFIX, \"\");\n    coordinates.forEach((subCoordinates, index) => {\n      const subFeature = {\n        type: Constants.geojsonTypes.FEATURE,\n        properties: geojson.properties,\n        geometry: {\n          type: subType,\n          coordinates: subCoordinates,\n        },\n      };\n      supplementaryPoints = supplementaryPoints.concat(\n        createSupplementaryPoints(subFeature, options, index)\n      );\n    });\n  }\n\n  return supplementaryPoints;\n}\n\nexport default createSupplementaryPoints;\n","function StringSet(items) {\n  this._items = {};\n  this._nums = {};\n  this._length = items ? items.length : 0;\n  if (!items) return;\n  for (let i = 0, l = items.length; i < l; i++) {\n    this.add(items[i]);\n    if (items[i] === undefined) continue;\n    if (typeof items[i] === 'string') this._items[items[i]] = i;\n    else this._nums[items[i]] = i;\n\n  }\n}\n\nStringSet.prototype.add = function(x) {\n  if (this.has(x)) return this;\n  this._length++;\n  if (typeof x === 'string') this._items[x] = this._length;\n  else this._nums[x] = this._length;\n  return this;\n};\n\nStringSet.prototype.delete = function(x) {\n  if (this.has(x) === false) return this;\n  this._length--;\n  delete this._items[x];\n  delete this._nums[x];\n  return this;\n};\n\nStringSet.prototype.has = function(x) {\n  if (typeof x !== 'string' && typeof x !== 'number') return false;\n  return this._items[x] !== undefined || this._nums[x] !== undefined;\n};\n\nStringSet.prototype.values = function() {\n  const values = [];\n  Object.keys(this._items).forEach((k) => {\n    values.push({ k, v: this._items[k] });\n  });\n  Object.keys(this._nums).forEach((k) => {\n    values.push({ k: JSON.parse(k), v: this._nums[k] });\n  });\n\n  return values.sort((a, b) => a.v - b.v).map(a => a.k);\n};\n\nStringSet.prototype.clear = function() {\n  this._length = 0;\n  this._items = {};\n  this._nums = {};\n  return this;\n};\n\nexport default StringSet;\n","import extent from \"@mapbox/geojson-extent\";\nimport * as Constants from \"./constants\";\n\nconst {\n  LAT_MIN,\n  LAT_MAX,\n  LAT_RENDERED_MIN,\n  LAT_RENDERED_MAX,\n  LNG_MIN,\n  LNG_MAX,\n} = Constants;\n\n// Ensure that we do not drag north-south far enough for\n// - any part of any feature to exceed the poles\n// - any feature to be completely lost in the space between the projection's\n//   edge and the poles, such that it couldn't be re-selected and moved back\nconst constrain_feature_movement = function (geojsonFeatures, delta) {\n  // \"inner edge\" = a feature's latitude closest to the equator\n  let northInnerEdge = LAT_MIN;\n  let southInnerEdge = LAT_MAX;\n  // \"outer edge\" = a feature's latitude furthest from the equator\n  let northOuterEdge = LAT_MIN;\n  let southOuterEdge = LAT_MAX;\n\n  let westEdge = LNG_MAX;\n  let eastEdge = LNG_MIN;\n\n  geojsonFeatures.forEach((feature) => {\n    const bounds = extent(feature);\n    const featureSouthEdge = bounds[1];\n    const featureNorthEdge = bounds[3];\n    const featureWestEdge = bounds[0];\n    const featureEastEdge = bounds[2];\n    if (featureSouthEdge > northInnerEdge) northInnerEdge = featureSouthEdge;\n    if (featureNorthEdge < southInnerEdge) southInnerEdge = featureNorthEdge;\n    if (featureNorthEdge > northOuterEdge) northOuterEdge = featureNorthEdge;\n    if (featureSouthEdge < southOuterEdge) southOuterEdge = featureSouthEdge;\n    if (featureWestEdge < westEdge) westEdge = featureWestEdge;\n    if (featureEastEdge > eastEdge) eastEdge = featureEastEdge;\n  });\n\n  // These changes are not mutually exclusive: we might hit the inner\n  // edge but also have hit the outer edge and therefore need\n  // another readjustment\n  const constrainedDelta = delta;\n  if (northInnerEdge + constrainedDelta.lat > LAT_RENDERED_MAX) {\n    constrainedDelta.lat = LAT_RENDERED_MAX - northInnerEdge;\n  }\n  if (northOuterEdge + constrainedDelta.lat > LAT_MAX) {\n    constrainedDelta.lat = LAT_MAX - northOuterEdge;\n  }\n  if (southInnerEdge + constrainedDelta.lat < LAT_RENDERED_MIN) {\n    constrainedDelta.lat = LAT_RENDERED_MIN - southInnerEdge;\n  }\n  if (southOuterEdge + constrainedDelta.lat < LAT_MIN) {\n    constrainedDelta.lat = LAT_MIN - southOuterEdge;\n  }\n  if (westEdge + constrainedDelta.lng <= LNG_MIN) {\n    constrainedDelta.lng += Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n  if (eastEdge + constrainedDelta.lng >= LNG_MAX) {\n    constrainedDelta.lng -= Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n\n  return constrainedDelta;\n};\n\nexport default constrain_feature_movement;\n","import constrainFeatureMovement from \"./constrain_feature_movement\";\nimport * as Constants from \"./constants\";\n\nvar move_features = function (features, delta) {\n  const constrainedDelta = constrainFeatureMovement(\n    features.map((feature) => feature.toGeoJSON()),\n    delta\n  );\n\n  features.forEach((feature) => {\n    const currentCoordinates = feature.getCoordinates();\n\n    const moveCoordinate = (coord) => {\n      const point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat,\n      };\n      return [point.lng, point.lat];\n    };\n    const moveRing = (ring) => ring.map((coord) => moveCoordinate(coord));\n    const moveMultiPolygon = (multi) => multi.map((ring) => moveRing(ring));\n\n    let nextCoordinates;\n    if (feature.type === Constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (\n      feature.type === Constants.geojsonTypes.LINE_STRING ||\n      feature.type === Constants.geojsonTypes.MULTI_POINT\n    ) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (\n      feature.type === Constants.geojsonTypes.POLYGON ||\n      feature.type === Constants.geojsonTypes.MULTI_LINE_STRING\n    ) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === Constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n};\nexport default move_features;\n","import * as CommonSelectors from \"./lib/common_selectors\";\nimport doubleClickZoom from \"./lib/double_click_zoom\";\nimport * as Constants from \"./lib/constants\";\nimport mouseEventPoint from \"./lib/mouse_event_point\";\nimport createSupplementaryPoints from \"./lib/create_supplementary_points\";\nimport StringSet from \"./lib/string_set\";\nimport moveFeatures from \"./lib/move_features\";\n\nconst CustomSelectMode = {};\nCustomSelectMode.onSetup = function (opts) {\n  console.log(\"Change mode: custom select\");\n\n  // turn the opts into state.\n  const state = {\n    dragMoveLocation: null,\n    boxSelectStartLocation: null,\n    boxSelectElement: undefined,\n    boxSelecting: false,\n    canBoxSelect: false,\n    dragMoving: false,\n    canDragMove: false,\n    initiallySelectedFeatureIds: opts.featureIds || [],\n  };\n\n  this.setSelected(\n    state.initiallySelectedFeatureIds.filter(\n      (id) => this.getFeature(id) !== undefined\n    )\n  );\n  this.fireActionable();\n\n  this.setActionableState({\n    combineFeatures: true,\n    uncombineFeatures: true,\n    trash: true,\n  });\n\n  return state;\n};\n\nCustomSelectMode.fireUpdate = function () {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.MOVE,\n    features: this.getSelected().map((f) => f.toGeoJSON()),\n  });\n};\n\nCustomSelectMode.fireActionable = function () {\n  const selectedFeatures = this.getSelected();\n\n  const multiFeatures = selectedFeatures.filter((feature) =>\n    this.isInstanceOf(\"MultiFeature\", feature)\n  );\n\n  let combineFeatures = false;\n\n  if (selectedFeatures.length > 1) {\n    combineFeatures = true;\n    const featureType = selectedFeatures[0].type.replace(\"Multi\", \"\");\n    selectedFeatures.forEach((feature) => {\n      if (feature.type.replace(\"Multi\", \"\") !== featureType) {\n        combineFeatures = false;\n      }\n    });\n  }\n\n  const uncombineFeatures = multiFeatures.length > 0;\n  const trash = selectedFeatures.length > 0;\n\n  this.setActionableState({\n    combineFeatures,\n    uncombineFeatures,\n    trash,\n  });\n};\n\nCustomSelectMode.getUniqueIds = function (allFeatures) {\n  if (!allFeatures.length) return [];\n  const ids = allFeatures\n    .map((s) => s.properties.id)\n    .filter((id) => id !== undefined)\n    .reduce((memo, id) => {\n      memo.add(id);\n      return memo;\n    }, new StringSet());\n\n  return ids.values();\n};\n\nCustomSelectMode.stopExtendedInteractions = function (state) {\n  if (state.boxSelectElement) {\n    if (state.boxSelectElement.parentNode)\n      state.boxSelectElement.parentNode.removeChild(state.boxSelectElement);\n    state.boxSelectElement = null;\n  }\n\n  this.map.dragPan.enable();\n\n  state.boxSelecting = false;\n  state.canBoxSelect = false;\n  state.dragMoving = false;\n  state.canDragMove = false;\n};\n\nCustomSelectMode.onStop = function () {\n  doubleClickZoom.enable(this);\n};\n\nCustomSelectMode.onMouseMove = function (state) {\n  // On mousemove that is not a drag, stop extended interactions.\n  // This is useful if you drag off the canvas, release the button,\n  // then move the mouse back over the canvas --- we don't allow the\n  // interaction to continue then, but we do let it continue if you held\n  // the mouse button that whole time\n  return this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) return this.fireUpdate();\n};\n\nCustomSelectMode.onTap = CustomSelectMode.onClick = function (state, e) {\n  // Click (with or without shift) on no feature\n  if (CommonSelectors.noTarget(e)) return this.clickAnywhere(state, e); // also tap\n  if (CommonSelectors.isOfMetaType(Constants.meta.VERTEX)(e))\n    return this.clickOnVertex(state, e); //tap\n  if (CommonSelectors.isFeature(e)) return this.clickOnFeature(state, e);\n};\n\nCustomSelectMode.clickAnywhere = function (state) {\n  // Clear the re-render selection\n  const wasSelected = this.getSelectedIds();\n  if (wasSelected.length) {\n    this.clearSelectedFeatures();\n    wasSelected.forEach((id) => this.doRender(id));\n  }\n  doubleClickZoom.enable(this);\n  this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.clickOnVertex = function (state, e) {\n  // Enter direct select mode\n  this.changeMode(\"custom_direct_select\", {\n    featureId: e.featureTarget.properties.parent,\n    coordPath: e.featureTarget.properties.coord_path,\n    startPos: e.lngLat,\n    //    groupMove_vertices: matchingVertices,\n  });\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n};\n\nCustomSelectMode.startOnActiveFeature = function (state, e) {\n  // Stop any already-underway extended interactions\n  this.stopExtendedInteractions(state);\n\n  // Disable map.dragPan immediately so it can't start\n  this.map.dragPan.disable();\n\n  // Re-render it and enable drag move\n  this.doRender(e.featureTarget.properties.id);\n\n  // Set up the state for drag moving\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nCustomSelectMode.clickOnFeature = function (state, e) {\n  // Stop everything\n  doubleClickZoom.disable(this);\n  this.stopExtendedInteractions(state);\n\n  const isShiftClick = CommonSelectors.isShiftDown(e);\n  const selectedFeatureIds = this.getSelectedIds();\n  const featureId = e.featureTarget.properties.id;\n  const isFeatureSelected = this.isSelected(featureId);\n\n  // Click (without shift) on any selected feature but a point\n  if (\n    !isShiftClick &&\n    isFeatureSelected &&\n    this.getFeature(featureId).type !== Constants.geojsonTypes.POINT\n  ) {\n    // Enter direct select mode\n    return this.changeMode(\"custom_direct_select\", {\n      featureId,\n    });\n  }\n\n  // Shift-click on a selected feature\n  if (isFeatureSelected && isShiftClick) {\n    // Deselect it\n    this.deselect(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n    if (selectedFeatureIds.length === 1) {\n      doubleClickZoom.enable(this);\n    }\n    // Shift-click on an unselected feature\n  } else if (!isFeatureSelected && isShiftClick) {\n    // Add it to the selection\n    this.select(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    // Click (without shift) on an unselected feature\n  } else if (!isFeatureSelected && !isShiftClick) {\n    // Make it the only selected feature\n    selectedFeatureIds.forEach((id) => this.doRender(id));\n    this.setSelected(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  }\n\n  // No matter what, re-render the clicked feature\n  this.doRender(featureId);\n};\n\nCustomSelectMode.onMouseDown = function (state, e) {\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n  if (this.drawConfig.boxSelect && CommonSelectors.isShiftMousedown(e))\n    return this.startBoxSelect(state, e);\n};\n\nCustomSelectMode.startBoxSelect = function (state, e) {\n  this.stopExtendedInteractions(state);\n  this.map.dragPan.disable();\n  // Enable box select\n  state.boxSelectStartLocation = mouseEventPoint(\n    e.originalEvent,\n    this.map.getContainer()\n  );\n  state.canBoxSelect = true;\n};\n\nCustomSelectMode.onTouchStart = function (state, e) {\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n};\n\nCustomSelectMode.onDrag = function (state, e) {\n  if (state.canDragMove) return this.dragMove(state, e);\n  if (this.drawConfig.boxSelect && state.canBoxSelect)\n    return this.whileBoxSelect(state, e);\n};\n\nCustomSelectMode.whileBoxSelect = function (state, e) {\n  state.boxSelecting = true;\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n\n  // Create the box node if it doesn't exist\n  if (!state.boxSelectElement) {\n    state.boxSelectElement = document.createElement(\"div\");\n    state.boxSelectElement.classList.add(Constants.classes.BOX_SELECT);\n    this.map.getContainer().appendChild(state.boxSelectElement);\n  }\n\n  // Adjust the box node's width and xy position\n  const current = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  const minX = Math.min(state.boxSelectStartLocation.x, current.x);\n  const maxX = Math.max(state.boxSelectStartLocation.x, current.x);\n  const minY = Math.min(state.boxSelectStartLocation.y, current.y);\n  const maxY = Math.max(state.boxSelectStartLocation.y, current.y);\n  const translateValue = `translate(${minX}px, ${minY}px)`;\n  state.boxSelectElement.style.transform = translateValue;\n  state.boxSelectElement.style.WebkitTransform = translateValue;\n  state.boxSelectElement.style.width = `${maxX - minX}px`;\n  state.boxSelectElement.style.height = `${maxY - minY}px`;\n};\n\nCustomSelectMode.dragMove = function (state, e) {\n  // Dragging when drag move is enabled\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat,\n  };\n\n  moveFeatures(this.getSelected(), delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nCustomSelectMode.onMouseUp = function (state, e) {\n  // End any extended interactions\n  if (state.dragMoving) {\n    this.fireUpdate();\n  } else if (state.boxSelecting) {\n    const bbox = [\n      state.boxSelectStartLocation,\n      mouseEventPoint(e.originalEvent, this.map.getContainer()),\n    ];\n    const featuresInBox = this.featuresAt(null, bbox, \"click\");\n    const idsToSelect = this.getUniqueIds(featuresInBox).filter(\n      (id) => !this.isSelected(id)\n    );\n\n    if (idsToSelect.length) {\n      this.select(idsToSelect);\n      idsToSelect.forEach((id) => this.doRender(id));\n      this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    }\n  }\n  this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.toDisplayFeatures = function (state, geojson, display) {\n  geojson.properties.active = this.isSelected(geojson.properties.id)\n    ? Constants.activeStates.ACTIVE\n    : Constants.activeStates.INACTIVE;\n  display(geojson);\n  this.fireActionable();\n  if (\n    geojson.properties.active !== Constants.activeStates.ACTIVE ||\n    geojson.geometry.type === Constants.geojsonTypes.POINT\n  )\n    return;\n  createSupplementaryPoints(geojson).forEach(display);\n};\n\nCustomSelectMode.onTrash = function () {\n  this.deleteFeature(this.getSelectedIds());\n  this.fireActionable();\n};\n\nCustomSelectMode.onCombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n\n  if (selectedFeatures.length === 0 || selectedFeatures.length < 2) return;\n\n  const coordinates = [],\n    featuresCombined = [];\n  const featureType = selectedFeatures[0].type.replace(\"Multi\", \"\");\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (feature.type.replace(\"Multi\", \"\") !== featureType) {\n      return;\n    }\n    if (feature.type.includes(\"Multi\")) {\n      feature.getCoordinates().forEach((subcoords) => {\n        coordinates.push(subcoords);\n      });\n    } else {\n      coordinates.push(feature.getCoordinates());\n    }\n\n    featuresCombined.push(feature.toGeoJSON());\n  }\n\n  if (featuresCombined.length > 1) {\n    const multiFeature = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: featuresCombined[0].properties,\n      geometry: {\n        type: `Multi${featureType}`,\n        coordinates,\n      },\n    });\n\n    this.addFeature(multiFeature);\n    this.deleteFeature(this.getSelectedIds(), { silent: true });\n    this.setSelected([multiFeature.id]);\n\n    this.map.fire(Constants.events.COMBINE_FEATURES, {\n      createdFeatures: [multiFeature.toGeoJSON()],\n      deletedFeatures: featuresCombined,\n    });\n  }\n  this.fireActionable();\n};\n\nCustomSelectMode.onUncombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0) return;\n\n  const createdFeatures = [];\n  const featuresUncombined = [];\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (this.isInstanceOf(\"MultiFeature\", feature)) {\n      feature.getFeatures().forEach((subFeature) => {\n        this.addFeature(subFeature);\n        subFeature.properties = feature.properties;\n        createdFeatures.push(subFeature.toGeoJSON());\n        this.select([subFeature.id]);\n      });\n      this.deleteFeature(feature.id, { silent: true });\n      featuresUncombined.push(feature.toGeoJSON());\n    }\n  }\n\n  if (createdFeatures.length > 1) {\n    this.map.fire(Constants.events.UNCOMBINE_FEATURES, {\n      createdFeatures,\n      deletedFeatures: featuresUncombined,\n    });\n  }\n  this.fireActionable();\n};\n\nexport default CustomSelectMode;\n","const drawUtils = {\n  getMatchingVertices: (vertex, featureId, allFeatures, map) => {\n    // number of decimals should probably be dynamic depending on zoom level\n    let decimals = 5;\n    let matchingVertices = [];\n\n    let v_lng = vertex[0].toFixed(decimals);\n    let v_lat = vertex[1].toFixed(decimals);\n\n    for (var i = 0; i < allFeatures.length; i++) {\n      if (allFeatures[i].id !== featureId) {\n        for (var k = 0; k < allFeatures[i].geometry.coordinates.length; k++) {\n          for (var m = 0; m < allFeatures[i].geometry.coordinates[k].length; m++) {\n            if (\n              v_lng ===\n                allFeatures[i].geometry.coordinates[k][m][0].toFixed(decimals) &&\n              v_lat ===\n                allFeatures[i].geometry.coordinates[k][m][1].toFixed(decimals)\n            ) {\n              matchingVertices.push({\n                featureId: allFeatures[i].id,\n                coord_path: k + \".\" + m,\n                //feature: map.getFeature(allFeatures[i].id),\n                lng: allFeatures[i].geometry.coordinates[k][m][0],\n                lat: allFeatures[i].geometry.coordinates[k][m][1],\n              });\n            }\n          }\n        }\n      }\n    }\n\n    return matchingVertices;\n  },\n  getDrawInstance: (map) => {\n    for (var i = map._controls.length - 1; i >= 0; i--) {\n      if (\n        map._controls[i].options &&\n        map._controls[i].options.defaultMode === \"custom_select\"\n      ) {\n        return map._controls[i];\n      }\n    }\n    return null;\n  },\n};\n\nexport default drawUtils;\n","import {\n  noTarget,\n  isOfMetaType,\n  isActiveFeature,\n  isInactiveFeature,\n  isShiftDown,\n} from \"./lib/common_selectors\";\nimport createSupplementaryPoints from \"./lib/create_supplementary_points\";\nimport constrainFeatureMovement from \"./lib/constrain_feature_movement\";\nimport doubleClickZoom from \"./lib/double_click_zoom\";\nimport * as Constants from \"./lib/constants\";\nimport moveFeatures from \"./lib/move_features\";\nimport drawUtils from \"./lib/utils\";\n\nconst isVertex = isOfMetaType(Constants.meta.VERTEX);\nconst isMidpoint = isOfMetaType(Constants.meta.MIDPOINT);\n\nconst DirectSelect = {};\n\n// INTERNAL FUCNTIONS\n\nDirectSelect.fireUpdate = function () {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.CHANGE_COORDINATES,\n    features: this.getSelected().map((f) => f.toGeoJSON()),\n  });\n};\n\nDirectSelect.fireActionable = function (state) {\n  this.setActionableState({\n    combineFeatures: false,\n    uncombineFeatures: false,\n    trash: state.selectedCoordPaths.length > 0,\n  });\n};\n\nDirectSelect.startDragging = function (state, e) {\n  this.map.dragPan.disable();\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.stopDragging = function (state) {\n  this.map.dragPan.enable();\n  state.dragMoving = false;\n  state.canDragMove = false;\n  state.dragMoveLocation = null;\n};\n\nDirectSelect.onVertex = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  const selectedIndex = state.selectedCoordPaths.indexOf(about.coord_path);\n  if (!isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths = [about.coord_path];\n  } else if (isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths.push(about.coord_path);\n  }\n\n  // currently this work with single selected vertices only\n  let allFeatures = drawUtils.getDrawInstance(this.map).getAll();\n\n  let matchingVertices = drawUtils.getMatchingVertices(\n    e.featureTarget._geometry.coordinates,\n    e.featureTarget.properties.parent,\n    allFeatures.features,\n    this.map\n  );\n  state.groupMove_vertices = matchingVertices;\n\n  for (let i = 0; i < state.groupMove_vertices.length; i++) {\n    state.groupMove_vertices[i].feature = this.getFeature(\n      state.groupMove_vertices[i].featureId\n    );\n  }\n\n  const selectedCoordinates = this.pathsToCoordinates(\n    state.featureId,\n    state.selectedCoordPaths\n  );\n  this.setSelectedCoordinates(selectedCoordinates);\n};\n\nDirectSelect.onMidpoint = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  state.feature.addCoordinate(about.coord_path, about.lng, about.lat);\n  this.fireUpdate();\n  state.selectedCoordPaths = [about.coord_path];\n};\n\nDirectSelect.pathsToCoordinates = function (featureId, paths) {\n  return paths.map((coord_path) => ({ feature_id: featureId, coord_path }));\n};\n\nDirectSelect.onFeature = function (state, e) {\n  if (state.selectedCoordPaths.length === 0) this.startDragging(state, e);\n  else this.stopDragging(state);\n};\n\nDirectSelect.dragFeature = function (state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.dragVertex = function (state, e, delta) {\n  const selectedCoords = state.selectedCoordPaths.map((coord_path) =>\n    state.feature.getCoordinate(coord_path)\n  );\n  const selectedCoordPoints = selectedCoords.map((coords) => ({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: coords,\n    },\n  }));\n\n  const constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n  for (let i = 0; i < selectedCoords.length; i++) {\n    const coord = selectedCoords[i];\n    state.feature.updateCoordinate(\n      state.selectedCoordPaths[i],\n      coord[0] + constrainedDelta.lng,\n      coord[1] + constrainedDelta.lat\n    );\n\n    for (let k = 0; k < state.groupMove_vertices.length; k++) {\n      let coord_path_m = state.groupMove_vertices[k].coord_path.split(\".\");\n      if (\n        typeof coord_path_m[0] !== \"undefined\" &&\n        typeof coord_path_m[1] !== \"undefined\" &&\n        typeof state.groupMove_vertices[k].feature.coordinates[coord_path_m[0]] !==\n          \"undefined\" &&\n        typeof state.groupMove_vertices[k].feature.coordinates[coord_path_m[0]][\n          coord_path_m[1]\n        ] !== \"undefined\"\n      ) {\n        let coord_m =\n          state.groupMove_vertices[k].feature.coordinates[coord_path_m[0]][\n            coord_path_m[1]\n          ];\n        state.groupMove_vertices[k].feature.updateCoordinate(\n          state.groupMove_vertices[k].coord_path,\n          coord_m[0] + constrainedDelta.lng,\n          coord_m[1] + constrainedDelta.lat\n        );\n      }\n    }\n  }\n};\n\nDirectSelect.clickNoTarget = function () {\n  this.changeMode(\"custom_select\");\n};\n\nDirectSelect.clickInactive = function () {\n  this.changeMode(\"custom_select\");\n};\n\nDirectSelect.clickActiveFeature = function (state) {\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  state.feature.changed();\n};\n\n// EXTERNAL FUNCTIONS\n\nDirectSelect.onSetup = function (opts) {\n  const featureId = opts.featureId;\n  const feature = this.getFeature(featureId);\n\n  if (!feature) {\n    throw new Error(\"You must provide a featureId to enter direct_select mode\");\n  }\n\n  if (feature.type === Constants.geojsonTypes.POINT) {\n    throw new TypeError(\"direct_select mode doesn't handle point features\");\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : [],\n    groupMove_vertices: opts.groupMove_vertices ? opts.groupMove_vertices : [],\n  };\n\n  this.setSelectedCoordinates(\n    this.pathsToCoordinates(featureId, state.selectedCoordPaths)\n  );\n  this.setSelected(featureId);\n  doubleClickZoom.disable(this);\n\n  this.setActionableState({\n    trash: true,\n  });\n\n  return state;\n};\n\nDirectSelect.onStop = function () {\n  doubleClickZoom.enable(this);\n  this.clearSelectedCoordinates();\n};\n\nDirectSelect.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths,\n    }).forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\n\nDirectSelect.onTrash = function (state) {\n  // Uses number-aware sorting to make sure '9' < '10'. Comparison is reversed because we want them\n  // in reverse order so that we can remove by index safely.\n  state.selectedCoordPaths\n    .sort((a, b) => b.localeCompare(a, \"en\", { numeric: true }))\n    .forEach((id) => state.feature.removeCoordinate(id));\n  this.fireUpdate();\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  this.fireActionable(state);\n  if (state.feature.isValid() === false) {\n    this.deleteFeature([state.featureId]);\n    this.changeMode(\"custom_select\", {});\n  }\n};\n\nDirectSelect.onMouseMove = function (state, e) {\n  // On mousemove that is not a drag, stop vertex movement.\n  const isFeature = isActiveFeature(e);\n  const onVertex = isVertex(e);\n  const noCoords = state.selectedCoordPaths.length === 0;\n  if (isFeature && noCoords) this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else if (onVertex && !noCoords)\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  this.stopDragging(state);\n};\n\nDirectSelect.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) this.fireUpdate();\n};\n\nDirectSelect.onTouchStart = DirectSelect.onMouseDown = function (state, e) {\n  if (isVertex(e)) return this.onVertex(state, e);\n  if (isActiveFeature(e)) return this.onFeature(state, e);\n  if (isMidpoint(e)) return this.onMidpoint(state, e);\n};\n\nDirectSelect.onDrag = function (state, e) {\n  if (state.canDragMove !== true) return;\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat,\n  };\n  if (state.selectedCoordPaths.length > 0) this.dragVertex(state, e, delta);\n  else this.dragFeature(state, e, delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.onClick = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n  this.stopDragging(state);\n};\n\nDirectSelect.onTap = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n};\n\nDirectSelect.onTouchEnd = DirectSelect.onMouseUp = function (state) {\n  if (state.dragMoving) {\n    this.fireUpdate();\n  }\n  this.stopDragging(state);\n};\n\nexport default DirectSelect;\n","import React, { useState, useEffect, useContext, useRef } from \"react\";\nimport \"./MlFeatureEditor.css\";\n\nimport \"@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw.css\";\nimport MapboxDraw from \"@mapbox/mapbox-gl-draw\";\nimport CustomPolygonMode from \"./custom-polygon-mode\";\nimport CustomSelectMode from \"./custom-select-mode\";\nimport CustomDirectSelectMode from \"./custom-direct-select-mode\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport { MapContext } from \"@mapcomponents/react-core\";\n\nfunction MlFeatureEditor(props) {\n  const mapRef = useRef(null);\n  const draw = useRef(null);\n  const mapContext = useContext(MapContext);\n  const componentId = useRef(\n    (props.idPrefix ? props.idPrefix : \"MlFeatureEditor-\") + uuidv4()\n  );\n  const onChangeRef = useRef(props.onChange);\n\n  const [drawToolsInitialized, setDrawToolsInitialized] = useState(false);\n  const [drawToolsReady, setDrawToolsReady] = useState(false);\n\n  const [mouseUpTrigger, setMouseUpTrigger] = useState(false);\n\n  const modeChangeHandler = (e) => {\n    console.log(\"MlFeatureEditor mode change to \" + e.mode);\n    //setDrawMode(e.mode);\n  };\n\n  const mouseUpHandler = () => {\n    setMouseUpTrigger(Math.random());\n  };\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        //mapRef.current.removeControl(draw.current, \"top-left\");\n        mapRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      mapContext.mapExists(props.mapId) &&\n      mapContext.getMap(props.mapId).style &&\n      !drawToolsInitialized\n    ) {\n      mapRef.current = mapContext.getMap(props.mapId);\n      setDrawToolsInitialized(true);\n      if (\n        mapRef.current &&\n        mapRef.current.style &&\n        mapRef.current.getSource(\"mapbox-gl-draw-cold\") &&\n        draw.current &&\n        typeof draw.current.remove !== \"undefined\"\n      ) {\n        // remove old Mapbox-gl-Draw from Mapbox instance when hot-reloading this component during development\n        draw.current.remove();\n      }\n\n      draw.current = new MapboxDraw({\n        displayControlsDefault: false,\n        defaultMode: props.mode || \"custom_select\",\n        modes: Object.assign(\n          {\n            custom_polygon: CustomPolygonMode,\n            custom_select: CustomSelectMode,\n            custom_direct_select: CustomDirectSelectMode,\n          },\n          MapboxDraw.modes\n        ),\n      });\n\n      mapRef.current.on(\"draw.modechange\", modeChangeHandler, componentId.current);\n\n      mapRef.current.addControl(draw.current, \"top-left\", componentId.current);\n\n      mapRef.current.on(\"mouseup\", mouseUpHandler, componentId.current);\n\n      setDrawToolsReady(true);\n    }\n  }, [mapContext.map, mapContext, props, drawToolsInitialized]);\n\n  useEffect(() => {\n    if (\n      draw.current &&\n      props.geojson &&\n      props.geojson.geometry &&\n      props.geojson.geometry.coordinates\n    ) {\n      draw.current.set({ type: \"FeatureCollection\", features: [props.geojson] });\n    }\n  }, [props.geojson, drawToolsReady]);\n\n  useEffect(() => {\n    if (draw.current && mouseUpTrigger) {\n      // update drawnFeatures state object\n      let currentFeatureCollection = draw.current.getAll();\n      if (typeof onChangeRef.current === \"function\") {\n        onChangeRef.current(currentFeatureCollection.features);\n      }\n    }\n  }, [mouseUpTrigger]);\n\n  useEffect(() => {\n    if (props.mode && draw.current) {\n      draw.current.changeMode(props.mode);\n    }\n  }, [props.mode]);\n\n  return <></>;\n}\n\nexport default MlFeatureEditor;\n","import React, { useEffect, useContext } from \"react\";\n\nimport { MapContext } from \"@mapcomponents/react-core\";\n\nconst MlBasicComponent = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  // without the requirement of adding it to the dependency list (ignore the false eslint exhaustive deps warning)\n  // const layerRef = useRef(null);\n  const mapContext = useContext(MapContext);\n\n  useEffect(() => {\n    if (!mapContext.mapExists()) return;\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      // try to remove anything this component has added to the MapLibre-gl instance\n      // e.g.: remove the layer\n      // mapContext.map.removeLayer(layerRef.current);\n      if (typeof props.cleanup === \"function\") {\n        props.cleanup(mapContext.getMap(props.mapId));\n      }\n    };\n  });\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId)) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance\n    if (typeof props.mapIsReady === \"function\") {\n      props.mapIsReady(mapContext.getMap(props.mapId));\n    }\n  }, [mapContext.mapIds, mapContext, props]);\n\n  return <></>;\n};\n\nexport default MlBasicComponent;\n","import React, { useContext, useCallback, useRef, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport syncMove from \"@mapbox/mapbox-gl-sync-move\";\nimport \"./style.css\";\nimport { MapContext } from \"@mapcomponents/react-core\";\n\n/**\n *\n * Hides the MapLibreMap referenced by props.map2Id except for the \"magnifier\"-circle that reveals\n * the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id\n *\n * @component\n */\nconst MlLayerMagnify = (props) => {\n  const mapContext = useContext(MapContext);\n  const syncMoveInitializedRef = useRef(false);\n  const syncCleanupFunctionRef = useRef(null);\n\n  const [swipeX, setSwipeX] = useState(50);\n  const swipeXRef = useRef(50);\n  const [swipeY, setSwipeY] = useState(50);\n  const swipeYRef = useRef(50);\n\n  const magnifierRadiusRef = useRef(props.magnifierRadius);\n\n  const [magnifierRadius, setMagnifierRadius] = useState(magnifierRadiusRef.current);\n\n  const mapExists = useCallback(() => {\n    if (!props.map1Id || !props.map2Id) {\n      return false;\n    }\n    if (!mapContext.getMap(props.map1Id) || !mapContext.getMap(props.map2Id)) {\n      return false;\n    }\n\n    return true;\n  }, [props, mapContext]);\n\n  const onResize = useRef(() => {\n    if (!mapExists()) return;\n\n    onMove({\n      clientX: swipeXRef.current,\n      clientY: swipeYRef.current,\n    });\n  });\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", onResize.current);\n    let _onResize = onResize.current;\n\n    return () => {\n      window.removeEventListener(\"resize\", _onResize);\n      if (syncCleanupFunctionRef.current) {\n        syncCleanupFunctionRef.current();\n      }\n    };\n  }, []);\n\n  const onMove = useCallback(\n    (e) => {\n      if (!mapExists()) return;\n\n      let bounds = mapContext.maps[props.map1Id].getCanvas().getBoundingClientRect();\n      let clientX =\n        e.clientX ||\n        (typeof e.touches !== \"undefined\" && typeof e.touches[0] !== \"undefined\"\n          ? e.touches[0].clientX\n          : 0);\n      let clientY =\n        e.clientY ||\n        (typeof e.touches !== \"undefined\" && typeof e.touches[0] !== \"undefined\"\n          ? e.touches[0].clientY\n          : 0);\n\n      clientX -= bounds.x;\n      clientY -= bounds.y;\n      let swipeX_tmp = ((clientX / bounds.width) * 100).toFixed(2);\n      let swipeY_tmp = ((clientY / bounds.height) * 100).toFixed(2);\n\n      if (swipeXRef.current !== swipeX_tmp || swipeYRef.current !== swipeY_tmp) {\n        setSwipeX(swipeX_tmp);\n        swipeXRef.current = swipeX_tmp;\n        setSwipeY(swipeY_tmp);\n        swipeYRef.current = swipeY_tmp;\n\n        mapContext.maps[props.map2Id].getContainer().style.clipPath =\n          `circle(${magnifierRadiusRef.current}px at ` +\n          (swipeXRef.current * bounds.width) / 100 +\n          \"px \" +\n          (swipeYRef.current * bounds.height) / 100 +\n          \"px)\";\n      }\n    },\n    [mapContext, mapExists, props]\n  );\n\n  useEffect(() => {\n    if (!mapExists() || syncMoveInitializedRef.current) return;\n\n    syncMoveInitializedRef.current = true;\n    syncCleanupFunctionRef.current = syncMove(\n      mapContext.getMap(props.map1Id).map,\n      mapContext.getMap(props.map2Id).map\n    );\n\n    if (\n      mapContext.maps[props.map1Id].getCanvas().clientWidth >\n        mapContext.maps[props.map1Id].getCanvas().clientHeight &&\n      magnifierRadiusRef.current * 2 > mapContext.maps[props.map1Id].getCanvas().clientHeight\n    ) {\n      magnifierRadiusRef.current = Math.floor(\n        mapContext.maps[props.map1Id].getCanvas().clientHeight / 2\n      );\n      setMagnifierRadius(magnifierRadiusRef.current);\n    }\n\n    if (\n      mapContext.maps[props.map1Id].getCanvas().clientHeight >\n        mapContext.maps[props.map1Id].getCanvas().clientWidth &&\n      magnifierRadiusRef.current * 2 > mapContext.maps[props.map1Id].getCanvas().clientWidth\n    ) {\n      magnifierRadiusRef.current = Math.floor(\n        mapContext.maps[props.map1Id].getCanvas().clientWidth / 2\n      );\n      setMagnifierRadius(magnifierRadiusRef.current);\n    }\n\n    onMove({\n      clientX: mapContext.maps[props.map1Id].getCanvas().clientWidth / 2,\n      clientY: mapContext.maps[props.map1Id].getCanvas().clientHeight / 2,\n    });\n  }, [mapContext.mapIds, mapContext, mapExists, props, onMove]);\n\n  const onDown = (e) => {\n    if (e.touches) {\n      document.addEventListener(\"touchmove\", onMove);\n      document.addEventListener(\"touchend\", onTouchEnd);\n    } else {\n      document.addEventListener(\"mousemove\", onMove);\n      document.addEventListener(\"mouseup\", onMouseUp);\n    }\n  };\n\n  const onTouchEnd = () => {\n    document.removeEventListener(\"touchmove\", onMove);\n    document.removeEventListener(\"touchend\", onTouchEnd);\n  };\n\n  const onMouseUp = () => {\n    document.removeEventListener(\"mousemove\", onMove);\n    document.removeEventListener(\"mouseup\", onMouseUp);\n  };\n\n  const onWheel = (e) => {\n    let evCopy = new WheelEvent(e.type, e);\n    mapContext.map.getCanvas().dispatchEvent(evCopy);\n  };\n\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        left: swipeX + \"%\",\n        top: swipeY + \"%\",\n        borderRadius: \"50%\",\n        width: magnifierRadius * 2 + 1 + \"px\",\n        height: magnifierRadius * 2 + 1 + \"px\",\n        background: \"rgba(0,0,0,0)\",\n        border: \"2px solid #fafafa\",\n        boxShadow: \"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)\",\n        cursor: \"pointer\",\n        zIndex: \"110\",\n        marginLeft: magnifierRadius * -1 - 1 + \"px\",\n        marginTop: magnifierRadius * -1 - 1 + \"px\",\n        textAlign: \"center\",\n        lineHeight: \"91px\",\n        fontSize: \"2em\",\n        color: \"#fafafa\",\n        userSelect: \"none\",\n      }}\n      onTouchStart={onDown}\n      onMouseDown={onDown}\n      onWheel={onWheel}\n    ></div>\n  );\n};\n\nMlLayerMagnify.defaultProps = {\n  magnifierRadius: 200,\n};\n\nMlLayerMagnify.propTypes = {\n  /**\n   * Id of the first MapLibre instance\n   */\n  map1Id: PropTypes.string,\n  /**\n   * Id of the second MapLibre instance\n   */\n  map2Id: PropTypes.string,\n  /**\n   * Size of the \"magnifier\"-circle\n   */\n  magnifierRadius: PropTypes.number,\n};\nexport default MlLayerMagnify;\n","import React, { useContext, useCallback, useRef, useEffect, useState } from \"react\";\nimport syncMove from \"@mapbox/mapbox-gl-sync-move\";\nimport \"./style.css\";\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport PropTypes from \"prop-types\";\n\n/**\n *  MlLayerSwipe returns a Button that will add a standard OSM tile layer to the maplibre-gl instance, that you can move like a curtain.\n *\n * @component\n */\nconst MlLayerSwipe = (props) => {\n  const mapContext = useContext(MapContext);\n  const initializedRef = useRef(false);\n\n  const [swipeX, setSwipeX] = useState(50);\n  const swipeXRef = useRef(50);\n\n  const syncCleanupFunctionRef = useRef(null);\n\n  const mapExists = useCallback(() => {\n    if (!props.map1Id || !props.map2Id) {\n      return false;\n    }\n    if (!mapContext.getMap(props.map1Id) || !mapContext.getMap(props.map2Id)) {\n      return false;\n    }\n\n    return true;\n  }, [mapContext, props.map1Id, props.map2Id]);\n\n  const cleanup = () => {\n    if (syncCleanupFunctionRef.current) {\n      syncCleanupFunctionRef.current();\n    }\n  };\n\n  const onMove = useCallback(\n    (e) => {\n      if (!mapExists()) return;\n\n      let bounds = mapContext.maps[props.map1Id].getCanvas().getBoundingClientRect();\n      let clientX =\n        e.clientX ||\n        (typeof e.touches !== \"undefined\" && typeof e.touches[0] !== \"undefined\"\n          ? e.touches[0].clientX\n          : 0);\n\n      clientX -= bounds.x;\n      let swipeX_tmp = ((clientX / bounds.width) * 100).toFixed(2);\n\n      if (swipeXRef.current !== swipeX_tmp) {\n        setSwipeX(swipeX_tmp);\n        swipeXRef.current = swipeX_tmp;\n\n        var clipA = \"rect(0, \" + (swipeXRef.current * bounds.width) / 100 + \"px, 999em, 0)\";\n\n        mapContext.maps[props.map2Id].getContainer().style.clip = clipA;\n      }\n    },\n    [mapContext, mapExists, props.map1Id, props.map2Id]\n  );\n\n  useEffect(() => {\n    return cleanup;\n  }, []);\n\n  useEffect(() => {\n    if (!mapExists() || initializedRef.current) return;\n\n    initializedRef.current = true;\n    syncCleanupFunctionRef.current = syncMove(\n      mapContext.getMap(props.map1Id).map,\n      mapContext.getMap(props.map2Id).map\n    );\n    onMove({ clientX: mapContext.maps[props.map1Id].getCanvas().clientWidth / 2 });\n  }, [mapContext.mapIds, mapContext, props, onMove, mapExists]);\n\n  const onDown = (e) => {\n    if (e.touches) {\n      document.addEventListener(\"touchmove\", onMove);\n      document.addEventListener(\"touchend\", onTouchEnd);\n    } else {\n      document.addEventListener(\"mousemove\", onMove);\n      document.addEventListener(\"mouseup\", onMouseUp);\n    }\n  };\n\n  const onTouchEnd = () => {\n    document.removeEventListener(\"touchmove\", onMove);\n    document.removeEventListener(\"touchend\", onTouchEnd);\n  };\n\n  const onMouseUp = () => {\n    document.removeEventListener(\"mousemove\", onMove);\n    document.removeEventListener(\"mouseup\", onMouseUp);\n  };\n\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        left: swipeX + \"%\",\n        top: \"50%\",\n        borderRadius: \"50%\",\n        width: \"100px\",\n        height: \"100px\",\n        background: \"#0066ff\",\n        border: \"3px solid #eaebf1\",\n        cursor: \"pointer\",\n        zIndex: \"110\",\n        marginLeft: \"-50px\",\n        marginTop: \"-50px\",\n        textAlign: \"center\",\n        lineHeight: \"91px\",\n        fontSize: \"2em\",\n        color: \"#fafafa\",\n        userSelect: \"none\",\n      }}\n      onTouchStart={onDown}\n      onMouseDown={onDown}\n    ></div>\n  );\n};\n\nMlLayerSwipe.propTypes = {\n  /**\n   * Id of the first MapLibre instance.\n   */\n  map1Id: PropTypes.string,\n  /**\n   * Id of the second MapLibre instance.\n   */\n  map2Id: PropTypes.string,\n}\n\nexport default MlLayerSwipe;\n","import React from \"react\";\n\nconst GeoJsonContext = React.createContext({});\n\nexport const GeoJsonContextProvider = GeoJsonContext.Provider;\nexport default GeoJsonContext;\n","/**\n * https://github.com/mapbox/togeojson\n *\n * Copyright (c) 2016 Mapbox All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\nvar toGeoJSON = (function () {\n  var removeSpace = /\\s*/g,\n    trimSpace = /^\\s*|\\s*$/g,\n    splitSpace = /\\s+/;\n  // generate a short, numeric hash of a string\n  function okhash(x) {\n    if (!x || !x.length) return 0;\n    for (var i = 0, h = 0; i < x.length; i++) {\n      h = ((h << 5) - h + x.charCodeAt(i)) | 0;\n    }\n    return h;\n  }\n  // all Y children of X\n  function get(x, y) {\n    return x.getElementsByTagName(y);\n  }\n  function attr(x, y) {\n    return x.getAttribute(y);\n  }\n  function attrf(x, y) {\n    return parseFloat(attr(x, y));\n  }\n  // one Y child of X, if any, otherwise null\n  function get1(x, y) {\n    var n = get(x, y);\n    return n.length ? n[0] : null;\n  }\n  // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n  function norm(el) {\n    if (el.normalize) {\n      el.normalize();\n    }\n    return el;\n  }\n  // cast array x into numbers\n  function numarray(x) {\n    for (var j = 0, o = []; j < x.length; j++) {\n      o[j] = parseFloat(x[j]);\n    }\n    return o;\n  }\n  // get the content of a text node, if any\n  function nodeVal(x) {\n    if (x) {\n      norm(x);\n    }\n    return (x && x.textContent) || \"\";\n  }\n  // get the contents of multiple text nodes, if present\n  function getMulti(x, ys) {\n    var o = {},\n      n,\n      k;\n    for (k = 0; k < ys.length; k++) {\n      n = get1(x, ys[k]);\n      if (n) o[ys[k]] = nodeVal(n);\n    }\n    return o;\n  }\n  // add properties of Y to X, overwriting if present in both\n  function extend(x, y) {\n    for (var k in y) x[k] = y[k];\n  }\n  // get one coordinate from a coordinate array, if any\n  function coord1(v) {\n    return numarray(v.replace(removeSpace, \"\").split(\",\"));\n  }\n  // get all coordinates from a coordinate array as [[],[]]\n  function coord(v) {\n    var coords = v.replace(trimSpace, \"\").split(splitSpace),\n      o = [];\n    for (var i = 0; i < coords.length; i++) {\n      o.push(coord1(coords[i]));\n    }\n    return o;\n  }\n  function coordPair(x) {\n    var ll = [attrf(x, \"lon\"), attrf(x, \"lat\")],\n      ele = get1(x, \"ele\"),\n      // handle namespaced attribute in browser\n      heartRate = get1(x, \"gpxtpx:hr\") || get1(x, \"hr\"),\n      time = get1(x, \"time\"),\n      e;\n    if (ele) {\n      e = parseFloat(nodeVal(ele));\n      if (!isNaN(e)) {\n        ll.push(e);\n      }\n    }\n    return {\n      coordinates: ll,\n      time: time ? nodeVal(time) : null,\n      heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null,\n    };\n  }\n\n  // create a new feature collection parent object\n  function fc() {\n    return {\n      type: \"FeatureCollection\",\n      features: [],\n    };\n  }\n\n  var serializer;\n  if (typeof XMLSerializer !== \"undefined\") {\n    /* istanbul ignore next */\n    serializer = new XMLSerializer();\n  } else {\n    var isNodeEnv = typeof process === \"object\" && !process.browser;\n    var isTitaniumEnv = typeof Titanium === \"object\";\n    if (typeof exports === \"object\" && (isNodeEnv || isTitaniumEnv)) {\n      serializer = new (require(\"xmldom\").XMLSerializer)();\n    } else {\n      throw new Error(\"Unable to initialize serializer\");\n    }\n  }\n  function xml2str(str) {\n    // IE9 will create a new XMLSerializer but it'll crash immediately.\n    // This line is ignored because we don't run coverage tests in IE9\n    /* istanbul ignore next */\n    if (str.xml !== undefined) return str.xml;\n    return serializer.serializeToString(str);\n  }\n\n  var t = {\n    kml: function (doc) {\n      var gj = fc(),\n        // styleindex keeps track of hashed styles in order to match features\n        styleIndex = {},\n        styleByHash = {},\n        // stylemapindex keeps track of style maps to expose in properties\n        styleMapIndex = {},\n        // atomic geospatial types supported by KML - MultiGeometry is\n        // handled separately\n        geotypes = [\"Polygon\", \"LineString\", \"Point\", \"Track\", \"gx:Track\"],\n        // all root placemarks in the file\n        placemarks = get(doc, \"Placemark\"),\n        styles = get(doc, \"Style\"),\n        styleMaps = get(doc, \"StyleMap\");\n\n      for (var k = 0; k < styles.length; k++) {\n        var hash = okhash(xml2str(styles[k])).toString(16);\n        styleIndex[\"#\" + attr(styles[k], \"id\")] = hash;\n        styleByHash[hash] = styles[k];\n      }\n      for (var l = 0; l < styleMaps.length; l++) {\n        styleIndex[\"#\" + attr(styleMaps[l], \"id\")] = okhash(xml2str(styleMaps[l])).toString(16);\n        var pairs = get(styleMaps[l], \"Pair\");\n        var pairsMap = {};\n        for (var m = 0; m < pairs.length; m++) {\n          pairsMap[nodeVal(get1(pairs[m], \"key\"))] = nodeVal(get1(pairs[m], \"styleUrl\"));\n        }\n        styleMapIndex[\"#\" + attr(styleMaps[l], \"id\")] = pairsMap;\n      }\n      for (var j = 0; j < placemarks.length; j++) {\n        gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n      }\n      function kmlColor(v) {\n        var color, opacity;\n        v = v || \"\";\n        if (v.substr(0, 1) === \"#\") {\n          v = v.substr(1);\n        }\n        if (v.length === 6 || v.length === 3) {\n          color = v;\n        }\n        if (v.length === 8) {\n          opacity = parseInt(v.substr(0, 2), 16) / 255;\n          color = \"#\" + v.substr(6, 2) + v.substr(4, 2) + v.substr(2, 2);\n        }\n        return [color, isNaN(opacity) ? undefined : opacity];\n      }\n      function gxCoord(v) {\n        return numarray(v.split(\" \"));\n      }\n      function gxCoords(root) {\n        var elems = get(root, \"coord\", \"gx\"),\n          coords = [],\n          times = [];\n        if (elems.length === 0) elems = get(root, \"gx:coord\");\n        for (var i = 0; i < elems.length; i++) coords.push(gxCoord(nodeVal(elems[i])));\n        var timeElems = get(root, \"when\");\n        for (var j = 0; j < timeElems.length; j++) times.push(nodeVal(timeElems[j]));\n        return {\n          coords: coords,\n          times: times,\n        };\n      }\n      function getGeometry(root) {\n        var geomNode,\n          geomNodes,\n          i,\n          j,\n          k,\n          geoms = [],\n          coordTimes = [];\n        if (get1(root, \"MultiGeometry\")) {\n          return getGeometry(get1(root, \"MultiGeometry\"));\n        }\n        if (get1(root, \"MultiTrack\")) {\n          return getGeometry(get1(root, \"MultiTrack\"));\n        }\n        if (get1(root, \"gx:MultiTrack\")) {\n          return getGeometry(get1(root, \"gx:MultiTrack\"));\n        }\n        for (i = 0; i < geotypes.length; i++) {\n          geomNodes = get(root, geotypes[i]);\n          if (geomNodes) {\n            for (j = 0; j < geomNodes.length; j++) {\n              geomNode = geomNodes[j];\n              if (geotypes[i] === \"Point\") {\n                geoms.push({\n                  type: \"Point\",\n                  coordinates: coord1(nodeVal(get1(geomNode, \"coordinates\"))),\n                });\n              } else if (geotypes[i] === \"LineString\") {\n                geoms.push({\n                  type: \"LineString\",\n                  coordinates: coord(nodeVal(get1(geomNode, \"coordinates\"))),\n                });\n              } else if (geotypes[i] === \"Polygon\") {\n                var rings = get(geomNode, \"LinearRing\"),\n                  coords = [];\n                for (k = 0; k < rings.length; k++) {\n                  coords.push(coord(nodeVal(get1(rings[k], \"coordinates\"))));\n                }\n                geoms.push({\n                  type: \"Polygon\",\n                  coordinates: coords,\n                });\n              } else if (geotypes[i] === \"Track\" || geotypes[i] === \"gx:Track\") {\n                var track = gxCoords(geomNode);\n                geoms.push({\n                  type: \"LineString\",\n                  coordinates: track.coords,\n                });\n                if (track.times.length) coordTimes.push(track.times);\n              }\n            }\n          }\n        }\n        return {\n          geoms: geoms,\n          coordTimes: coordTimes,\n        };\n      }\n      function getPlacemark(root) {\n        var geomsAndTimes = getGeometry(root),\n          i,\n          properties = {},\n          name = nodeVal(get1(root, \"name\")),\n          address = nodeVal(get1(root, \"address\")),\n          styleUrl = nodeVal(get1(root, \"styleUrl\")),\n          description = nodeVal(get1(root, \"description\")),\n          timeSpan = get1(root, \"TimeSpan\"),\n          timeStamp = get1(root, \"TimeStamp\"),\n          extendedData = get1(root, \"ExtendedData\"),\n          lineStyle = get1(root, \"LineStyle\"),\n          polyStyle = get1(root, \"PolyStyle\"),\n          visibility = get1(root, \"visibility\");\n\n        if (!geomsAndTimes.geoms.length) return [];\n        if (name) properties.name = name;\n        if (address) properties.address = address;\n        if (styleUrl) {\n          if (styleUrl[0] !== \"#\") {\n            styleUrl = \"#\" + styleUrl;\n          }\n\n          properties.styleUrl = styleUrl;\n          if (styleIndex[styleUrl]) {\n            properties.styleHash = styleIndex[styleUrl];\n          }\n          if (styleMapIndex[styleUrl]) {\n            properties.styleMapHash = styleMapIndex[styleUrl];\n            properties.styleHash = styleIndex[styleMapIndex[styleUrl].normal];\n          }\n          // Try to populate the lineStyle or polyStyle since we got the style hash\n          var style = styleByHash[properties.styleHash];\n          if (style) {\n            if (!lineStyle) lineStyle = get1(style, \"LineStyle\");\n            if (!polyStyle) polyStyle = get1(style, \"PolyStyle\");\n            var iconStyle = get1(style, \"IconStyle\");\n            if (iconStyle) {\n              var icon = get1(iconStyle, \"Icon\");\n              if (icon) {\n                var href = nodeVal(get1(icon, \"href\"));\n                if (href) properties.icon = href;\n              }\n            }\n          }\n        }\n        if (description) properties.description = description;\n        if (timeSpan) {\n          var begin = nodeVal(get1(timeSpan, \"begin\"));\n          var end = nodeVal(get1(timeSpan, \"end\"));\n          properties.timespan = { begin: begin, end: end };\n        }\n        if (timeStamp) {\n          properties.timestamp = nodeVal(get1(timeStamp, \"when\"));\n        }\n        if (lineStyle) {\n          var linestyles = kmlColor(nodeVal(get1(lineStyle, \"color\"))),\n            color = linestyles[0],\n            opacity = linestyles[1],\n            width = parseFloat(nodeVal(get1(lineStyle, \"width\")));\n          if (color) properties.stroke = color;\n          if (!isNaN(opacity)) properties[\"stroke-opacity\"] = opacity;\n          if (!isNaN(width)) properties[\"stroke-width\"] = width;\n        }\n        if (polyStyle) {\n          var polystyles = kmlColor(nodeVal(get1(polyStyle, \"color\"))),\n            pcolor = polystyles[0],\n            popacity = polystyles[1],\n            fill = nodeVal(get1(polyStyle, \"fill\")),\n            outline = nodeVal(get1(polyStyle, \"outline\"));\n          if (pcolor) properties.fill = pcolor;\n          if (!isNaN(popacity)) properties[\"fill-opacity\"] = popacity;\n          if (fill) properties[\"fill-opacity\"] = fill === \"1\" ? properties[\"fill-opacity\"] || 1 : 0;\n          if (outline)\n            properties[\"stroke-opacity\"] = outline === \"1\" ? properties[\"stroke-opacity\"] || 1 : 0;\n        }\n        if (extendedData) {\n          var datas = get(extendedData, \"Data\"),\n            simpleDatas = get(extendedData, \"SimpleData\");\n\n          for (i = 0; i < datas.length; i++) {\n            properties[datas[i].getAttribute(\"name\")] = nodeVal(get1(datas[i], \"value\"));\n          }\n          for (i = 0; i < simpleDatas.length; i++) {\n            properties[simpleDatas[i].getAttribute(\"name\")] = nodeVal(simpleDatas[i]);\n          }\n        }\n        if (visibility) {\n          properties.visibility = nodeVal(visibility);\n        }\n        if (geomsAndTimes.coordTimes.length) {\n          properties.coordTimes =\n            geomsAndTimes.coordTimes.length === 1\n              ? geomsAndTimes.coordTimes[0]\n              : geomsAndTimes.coordTimes;\n        }\n        var feature = {\n          type: \"Feature\",\n          geometry:\n            geomsAndTimes.geoms.length === 1\n              ? geomsAndTimes.geoms[0]\n              : {\n                  type: \"GeometryCollection\",\n                  geometries: geomsAndTimes.geoms,\n                },\n          properties: properties,\n        };\n        if (attr(root, \"id\")) feature.id = attr(root, \"id\");\n        return [feature];\n      }\n      return gj;\n    },\n    gpx: function (doc) {\n      var i,\n        tracks = get(doc, \"trk\"),\n        routes = get(doc, \"rte\"),\n        waypoints = get(doc, \"wpt\"),\n        // a feature collection\n        gj = fc(),\n        feature;\n      for (i = 0; i < tracks.length; i++) {\n        feature = getTrack(tracks[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < routes.length; i++) {\n        feature = getRoute(routes[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < waypoints.length; i++) {\n        gj.features.push(getPoint(waypoints[i]));\n      }\n      function initializeArray(arr, size) {\n        for (var h = 0; h < size; h++) {\n          arr.push(null);\n        }\n        return arr;\n      }\n      function getPoints(node, pointname) {\n        var pts = get(node, pointname),\n          line = [],\n          times = [],\n          heartRates = [],\n          l = pts.length;\n        if (l < 2) return {}; // Invalid line in GeoJSON\n        for (var i = 0; i < l; i++) {\n          var c = coordPair(pts[i]);\n          line.push(c.coordinates);\n          if (c.time) times.push(c.time);\n          if (c.heartRate || heartRates.length) {\n            if (!heartRates.length) initializeArray(heartRates, i);\n            heartRates.push(c.heartRate || null);\n          }\n        }\n        return {\n          line: line,\n          times: times,\n          heartRates: heartRates,\n        };\n      }\n      function getTrack(node) {\n        var segments = get(node, \"trkseg\"),\n          track = [],\n          times = [],\n          heartRates = [],\n          line;\n        for (var i = 0; i < segments.length; i++) {\n          line = getPoints(segments[i], \"trkpt\");\n          if (line) {\n            if (line.line) track.push(line.line);\n            if (line.times && line.times.length) times.push(line.times);\n            if (heartRates.length || (line.heartRates && line.heartRates.length)) {\n              if (!heartRates.length) {\n                for (var s = 0; s < i; s++) {\n                  heartRates.push(initializeArray([], track[s].length));\n                }\n              }\n              if (line.heartRates && line.heartRates.length) {\n                heartRates.push(line.heartRates);\n              } else {\n                heartRates.push(initializeArray([], line.line.length || 0));\n              }\n            }\n          }\n        }\n        if (track.length === 0) return;\n        var properties = getProperties(node);\n        extend(properties, getLineStyle(get1(node, \"extensions\")));\n        if (times.length) properties.coordTimes = track.length === 1 ? times[0] : times;\n        if (heartRates.length)\n          properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n        return {\n          type: \"Feature\",\n          properties: properties,\n          geometry: {\n            type: track.length === 1 ? \"LineString\" : \"MultiLineString\",\n            coordinates: track.length === 1 ? track[0] : track,\n          },\n        };\n      }\n      function getRoute(node) {\n        var line = getPoints(node, \"rtept\");\n        if (!line.line) return;\n        var prop = getProperties(node);\n        extend(prop, getLineStyle(get1(node, \"extensions\")));\n        var routeObj = {\n          type: \"Feature\",\n          properties: prop,\n          geometry: {\n            type: \"LineString\",\n            coordinates: line.line,\n          },\n        };\n        return routeObj;\n      }\n      function getPoint(node) {\n        var prop = getProperties(node);\n        extend(prop, getMulti(node, [\"sym\"]));\n        return {\n          type: \"Feature\",\n          properties: prop,\n          geometry: {\n            type: \"Point\",\n            coordinates: coordPair(node).coordinates,\n          },\n        };\n      }\n      function getLineStyle(extensions) {\n        var style = {};\n        if (extensions) {\n          var lineStyle = get1(extensions, \"line\");\n          if (lineStyle) {\n            var color = nodeVal(get1(lineStyle, \"color\")),\n              opacity = parseFloat(nodeVal(get1(lineStyle, \"opacity\"))),\n              width = parseFloat(nodeVal(get1(lineStyle, \"width\")));\n            if (color) style.stroke = color;\n            if (!isNaN(opacity)) style[\"stroke-opacity\"] = opacity;\n            // GPX width is in mm, convert to px with 96 px per inch\n            if (!isNaN(width)) style[\"stroke-width\"] = (width * 96) / 25.4;\n          }\n        }\n        return style;\n      }\n      function getProperties(node) {\n        var prop = getMulti(node, [\"name\", \"cmt\", \"desc\", \"type\", \"time\", \"keywords\"]),\n          links = get(node, \"link\");\n        if (links.length) prop.links = [];\n        for (var i = 0, link; i < links.length; i++) {\n          link = { href: attr(links[i], \"href\") };\n          extend(link, getMulti(links[i], [\"text\", \"type\"]));\n          prop.links.push(link);\n        }\n        return prop;\n      }\n      return gj;\n    },\n  };\n  return t;\n})();\n\nexport default toGeoJSON;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { bbox } from \"@turf/turf\";\nimport Divider from \"@mui/material/Divider\";\nimport Typography from \"@mui/material/Typography\";\nimport Drawer from \"@mui/material/Drawer\";\nimport IconButton from \"@mui/material/IconButton\";\nimport InfoIcon from \"@mui/icons-material/Info\";\nimport FileCopy from \"@mui/icons-material/FileCopy\";\nimport { Popup } from \"maplibre-gl\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport GeoJsonContext from \"./util/GeoJsonContext\";\nimport toGeoJSON from \"./gpxConverter\";\nimport useMediaQuery from \"@mui/material/useMediaQuery\";\nimport useMap from \"../../hooks/useMap\";\n\n/**\n * MlGPXViewer returns a dropzone and a button to load a GPX Track into the map.\n *\n * @component\n */\nconst MlGPXViewer = (props) => {\n  const dataSource = useContext(GeoJsonContext);\n  const initializedRef = useRef(false);\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n  const sourceName = \"import-source\";\n  const layerNameLines = \"importer-layer-lines\";\n  const layerNamePoints = \"importer-layer-points\";\n\n  const [open, setIsOpen] = useState(false);\n  const dropZone = useRef(null);\n  const [zIndex, setZIndex] = useState(0);\n  const [metaData, setMetaData] = useState([]);\n  const fileupload = useRef(null);\n  const mediaIsMobile = useMediaQuery(\"(max-width:900px)\");\n\n  const popup = useRef(\n    new Popup({\n      closeButton: false,\n      closeOnClick: true,\n    })\n  );\n\n  useEffect(() => {\n    if (!mapHook.map || initializedRef.current) return;\n\n    initializedRef.current = true;\n\n    mapHook.map.addSource(\n      sourceName,\n      {\n        type: \"geojson\",\n        data: dataSource.data,\n      },\n      mapHook.componentId\n    );\n    mapHook.map.addLayer(\n      {\n        id: layerNameLines,\n        source: sourceName,\n        type: \"line\",\n        paint: {\n          \"line-width\": 4,\n          \"line-color\": \"rgba(212, 55, 23,0.5)\",\n        },\n      },\n      props.insertBeforeLayer,\n      mapHook.componentId\n    );\n    mapHook.map.addLayer(\n      {\n        id: layerNamePoints,\n        source: sourceName,\n        type: \"circle\",\n        paint: {\n          \"circle-color\": \"rgba(72, 77, 99,0.5)\",\n          \"circle-radius\": 7,\n        },\n        filter: [\"==\", \"$type\", \"Point\"],\n      },\n      props.insertBeforeLayer,\n      mapHook.componentId\n    );\n\n    [layerNameLines, layerNamePoints].forEach((layerName) => {\n      mapHook.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n    });\n    mapHook.map.on(\n      \"mouseenter\",\n      layerNamePoints,\n      (e) => {\n        // Change the cursor style as a UI indicator.\n\n        const coordinates = e.features[0].geometry.coordinates.slice();\n        //const description = e.features[0].properties.desc;\n        const name = e.features[0].properties.name;\n\n        // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears\n        // over the copy being pointed to.\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n          coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n\n        // Populate the popup and set its coordinates\n\n        // based on the feature found.\n        popup.current.setLngLat(coordinates).setHTML(name).addTo(mapHook.map);\n      },\n      mapHook.componentId\n    );\n\n    mapHook.map.on(\n      \"mouseleave\",\n      \"places\",\n      function () {\n        mapHook.map.getCanvas().style.cursor = \"\";\n        popup.current.remove();\n      },\n      mapHook.componentId\n    );\n\n    mapHook.map.setZoom(10);\n  }, [mapHook.map]);\n\n  useEffect(() => {\n    const dropZoneCurrent = dropZone.current;\n    const raiseDropZoneAndStopDefault = (event) => {\n      setZIndex(1000);\n      stopDefault(event);\n    };\n    const lowerDropZone = () => {\n      setZIndex(0);\n    };\n    const lowerDropZoneAndStopDefault = (event) => {\n      setZIndex(0);\n      stopDefault(event);\n    };\n\n    window.addEventListener(\"dragenter\", raiseDropZoneAndStopDefault);\n    window.addEventListener(\"dragover\", stopDefault);\n\n    dropZoneCurrent.addEventListener(\"dragleave\", lowerDropZone);\n\n    window.addEventListener(\"drop\", lowerDropZoneAndStopDefault);\n\n    return () => {\n      window.removeEventListener(\"dragenter\", raiseDropZoneAndStopDefault);\n      window.removeEventListener(\"dragover\", stopDefault);\n      dropZoneCurrent.removeEventListener(\"dragleave\", lowerDropZone);\n      window.removeEventListener(\"drop\", lowerDropZoneAndStopDefault);\n    };\n  });\n\n  const stopDefault = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  useEffect(() => {\n    if (!mapHook.map) return;\n\n    const visibility = props.visible ? \"visible\" : \"none\";\n\n    [layerNameLines, layerNamePoints].forEach((layerName) => {\n      mapHook.map.setLayoutProperty(layerName, \"visibility\", visibility);\n    });\n  }, [props.visible]);\n\n  const dropHandler = (event) => {\n    event.preventDefault();\n\n    if (event.dataTransfer.items) {\n      if (event.dataTransfer.items.length > 1) {\n        return false;\n      }\n      // If dropped items aren't files, reject them\n      if (event.dataTransfer.items[0].kind === \"file\") {\n        const reader = new FileReader();\n        reader.onload = (payload) => {\n          addGPXToMap(payload.currentTarget.result);\n        };\n        const file = event.dataTransfer.items[0].getAsFile();\n        reader.readAsText(file);\n      }\n    } else {\n      // Use DataTransfer interface to access the file(s)\n    }\n  };\n\n  const addGPXToMap = (gpxAsString) => {\n    if (!mapHook.map) return;\n    try {\n      setMetaData([]);\n      const domParser = new DOMParser();\n      const gpxDoc = domParser.parseFromString(gpxAsString, \"application/xml\");\n      const metadata = gpxDoc.querySelector(\"metadata\");\n      metadata.childNodes.forEach((node) => {\n        let value = node.textContent;\n        const title = node.nodeName;\n\n        if (node.nodeName === \"link\") {\n          value = node.getAttribute(\"href\");\n        }\n        if (!!value.trim().length) {\n          const metaDatEntry = {\n            title: title,\n            value: value,\n            id: new Date().getTime(),\n          };\n          setMetaData((prevState) => [...prevState, metaDatEntry]);\n        }\n      });\n      const data = toGeoJSON.gpx(gpxDoc);\n      dataSource.setData(data);\n      mapHook.map.getSource(sourceName).setData(data);\n      const bounds = bbox(data);\n      mapHook.map.fitBounds(bounds);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const toogleDrawer = () => {\n    setIsOpen((prevState) => !prevState);\n  };\n\n  const fileUploadOnChange = () => {\n    const file = fileupload.current.files[0];\n    if (!file) return false;\n    const reader = new FileReader();\n    reader.onload = (payload) => {\n      addGPXToMap(payload.currentTarget.result);\n    };\n\n    reader.readAsText(file);\n  };\n\n  const manualUpload = () => {\n    fileupload.current.click();\n  };\n  return (\n    <>\n      <div\n        style={{\n          position: \"fixed\",\n          right: \"5px\",\n          bottom: mediaIsMobile ? \"40px\" : \"25px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"5px\",\n          zIndex: 1000,\n        }}\n      >\n        <IconButton\n          onClick={manualUpload}\n          style={{\n            backgroundColor: \"rgba(255,255,255,1)\",\n          }}\n          size=\"large\"\n        >\n          <input\n            ref={fileupload}\n            onChange={fileUploadOnChange}\n            type=\"file\"\n            id=\"input\"\n            multiple\n            style={{ display: \"none\" }}\n          ></input>\n          <FileCopy />\n        </IconButton>\n        <IconButton\n          onClick={toogleDrawer}\n          style={{\n            backgroundColor: \"rgba(255,255,255,1)\",\n          }}\n          size=\"large\"\n        >\n          <InfoIcon />\n        </IconButton>\n      </div>\n      <Drawer variant=\"persistent\" anchor=\"left\" open={open}>\n        <Typography\n          variant=\"h6\"\n          style={{\n            textAlign: \"center\",\n            padding: \"1em\",\n          }}\n          noWrap\n        >\n          Informationen zur Route\n        </Typography>\n        <Divider />\n        <List>\n          {metaData.map((item) => (\n            <ListItem key={`item--${item.id}`}>\n              <ListItemText primary={item.value} />\n            </ListItem>\n          ))}\n        </List>\n      </Drawer>\n      <div\n        onDrop={dropHandler}\n        ref={dropZone}\n        style={{\n          position: \"absolute\",\n          left: \"0\",\n          top: \"0\",\n          backgroundColor: \"rgba(255,255,255,0.5)\",\n          width: \"100%\",\n          height: \"100%\",\n          zIndex: zIndex,\n        }}\n      >\n        <Typography\n          variant=\"h6\"\n          style={{\n            top: \"50%\",\n            position: \"absolute\",\n            left: \"50%\",\n            msTransform: \"translate(-50%, -50%)\",\n            transform: \" translate(-50%, -50%)\",\n          }}\n          noWrap\n        >\n          Gpx-Datei ablegen\n        </Typography>\n      </div>\n    </>\n  );\n};\n\nMlGPXViewer.defaultProps = {\n  visible: true,\n};\n\nMlGPXViewer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapHook\n   */\n  mapId: PropTypes.string,\n  /**\n   * Prefix of the component id this component uses when adding elements to the MapLibreGl-instance\n   */\n  idPrefix: PropTypes.string,\n  /**\n   * Sets the layers layout-property \"visibility\" to \"none\" if false or \"visible\" if true\n   */\n  visible: PropTypes.bool,\n  /**\n   * The layerId of an existing layer this layer should be rendered visually beneath\n   * https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see \"beforeId\" property\n   */\n  insertBeforeLayer: PropTypes.string,\n};\n\nexport default MlGPXViewer;\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { GeoJsonContextProvider } from \"./GeoJsonContext\";\n\nconst GeoJsonProvider = ({ children }) => {\n  const [data, setData] = useState({\n    type: \"FeatureCollection\",\n    features: [],\n  });\n  const getEmptyFeatureCollection = () => {\n    return {\n      type: \"FeatureCollection\",\n      features: [],\n    };\n  };\n  const value = {\n    data,\n    setData,\n    getEmptyFeatureCollection,\n  };\n\n  return <GeoJsonContextProvider value={value}>{children}</GeoJsonContextProvider>;\n};\n\nGeoJsonProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport default GeoJsonProvider;\n","import React, { useCallback, useRef, useContext, useEffect } from \"react\";\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport GeoJsonContext from \"../MlGPXViewer/util/GeoJsonContext\";\nimport { polygon, lineString } from \"@turf/helpers\";\nimport { distance, lineOffset } from \"@turf/turf\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport PropTypes from \"prop-types\";\n\n/**\n * MlSpatialElevationProfile returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n *\n * @component\n */\nconst MlSpatialElevationProfile = (props) => {\n  const mapContext = useContext(MapContext);\n\n  const componentId = useRef(\n    (props.idPrefix ? props.idPrefix : \"MlSpatialElevationProfile-\") + uuidv4()\n  );\n  const mapRef = useRef(null);\n  const initializedRef = useRef(false);\n\n  const dataSource = useContext(GeoJsonContext);\n  const sourceName = useRef(\"elevationprofile-\" + uuidv4());\n  const layerName = useRef(\"elevationprofile-layer-\" + uuidv4());\n\n  const createStep = useCallback(\n    (x, y, z, x2, y2) => {\n      //const summand = 0.0002;\n      const line = lineString([\n        [x, y],\n        [x2, y2],\n      ]);\n      const offsetLine = lineOffset(line, 5, { units: \"meters\" });\n      const x3 = offsetLine.geometry.coordinates[0][0];\n      const y3 = offsetLine.geometry.coordinates[0][1];\n      const x4 = offsetLine.geometry.coordinates[1][0];\n      const y4 = offsetLine.geometry.coordinates[1][1];\n\n      return polygon(\n        [\n          [\n            [x, y],\n            [x2, y2],\n\n            [x4, y4],\n            [x3, y3],\n            [x, y],\n          ],\n        ],\n        { height: z * props.elevationFactor }\n      );\n    },\n    [props.elevationFactor]\n  );\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n\n        mapRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n\n    mapRef.current.addSource(\n      sourceName.current,\n      {\n        type: \"geojson\",\n        data: dataSource.data,\n      },\n      componentId.current\n    );\n    mapRef.current.addLayer(\n      {\n        id: layerName.current,\n        source: sourceName.current,\n        type: \"fill-extrusion\",\n        paint: {\n          \"fill-extrusion-height\": [\"get\", \"height\"],\n          \"fill-extrusion-opacity\": 0.9,\n          \"fill-extrusion-color\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"get\", \"height\"],\n            0,\n            \"rgba(0, 0, 255, 0)\",\n            0.1,\n            \"royalblue\",\n            0.3,\n            \"cyan\",\n            0.5,\n            \"lime\",\n            0.7,\n            \"yellow\",\n            1,\n            \"yellow\",\n          ],\n        },\n      },\n      props.insertBeforeLayer,\n      componentId.current\n    );\n  }, [\n    mapContext.mapIds,\n    props.insertBeforeLayer,\n    props.mapId,\n    dataSource,\n    mapContext,\n  ]);\n\n  useEffect(() => {\n    if (!mapRef.current || !mapRef.current.getLayer(layerName.current)) return;\n    const { data } = dataSource;\n    if (!data || !data.features) return;\n\n    const line = data.features.find((element) => {\n      return element.geometry.type === \"LineString\";\n    });\n    if (!line || !line.geometry) return;\n    const heights = line.geometry.coordinates.map((coordinate, index) => {\n      return coordinate[2];\n    });\n\n    const min = Math.min(...heights);\n\n    let max = Math.max(...heights) - min;\n\n    max = max === 0 ? 1 : max;\n\n    mapRef.current.setPaintProperty(layerName.current, \"fill-extrusion-color\", [\n      \"interpolate\",\n      [\"linear\"],\n      [\"get\", \"height\"],\n      0,\n      \"rgb(0,255,55)\",\n      max * props.elevationFactor,\n      \"rgb(255,0,0)\",\n    ]);\n    const lerp = (x, y, a) => x * (1 - a) + y * a;\n    const points = [];\n\n    line.geometry.coordinates.forEach((coordinate, index) => {\n      //const point = createPoint(coordinate[0],coordinate[1],coordinate[2]-min);\n      //points.push(point);\n      if (line.geometry.coordinates[index + 1]) {\n        const wayLength = distance(\n          [coordinate[0], coordinate[1]],\n          [\n            line.geometry.coordinates[index + 1][0],\n            line.geometry.coordinates[index + 1][1],\n          ],\n          { units: \"kilometers\" }\n        );\n        let listLength = ~~((wayLength * 1000) / 10);\n        listLength = listLength < 1 ? 1 : listLength;\n        for (let i = 0; i < listLength; i++) {\n          const x = lerp(\n            line.geometry.coordinates[index][0],\n            line.geometry.coordinates[index + 1][0],\n            i / listLength\n          );\n          const y = lerp(\n            line.geometry.coordinates[index][1],\n            line.geometry.coordinates[index + 1][1],\n            i / listLength\n          );\n          const z = lerp(\n            line.geometry.coordinates[index][2] - min,\n            line.geometry.coordinates[index + 1][2] - min,\n            i / listLength\n          );\n\n          const x2 = lerp(\n            line.geometry.coordinates[index][0],\n            line.geometry.coordinates[index + 1][0],\n            (i + 1) / listLength\n          );\n          const y2 = lerp(\n            line.geometry.coordinates[index][1],\n            line.geometry.coordinates[index + 1][1],\n            (i + 1) / listLength\n          );\n\n          const point = createStep(x, y, z, x2, y2);\n          points.push(point);\n        }\n      }\n    });\n\n    const newData = dataSource.getEmptyFeatureCollection();\n    newData.features = points;\n\n    mapRef.current.getSource(sourceName.current)?.setData(newData);\n  }, [dataSource.data, createStep, dataSource, props.elevationFactor, mapContext]);\n\n  return <></>;\n};\n\nMlSpatialElevationProfile.defaultProps = {\n  elevationFactor: 1,\n};\n\nMlSpatialElevationProfile.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Prefix of the component id this component uses when adding elements to the MapLibreGl-instance\n   */\n  idPrefix: PropTypes.string,\n  /**\n   * Number describes the factor of the height of the elevation\n   */\n  elevationFactor: PropTypes.number,\n  /**\n   * The layerId of an existing layer this layer should be rendered visually beneath\n   * https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see \"beforeId\" property\n   */\n  insertBeforeLayer: PropTypes.string,\n}\n\nexport default MlSpatialElevationProfile;\n","import * as turf from \"@turf/turf\";\n\nconst _showNextTransitionSegment = function (\n  props,\n  map,\n  transitionInProgressRef,\n  transitionGeojsonDataRef,\n  transitionGeojsonCommonDataRef,\n  currentTransitionStepRef,\n  msPerStep,\n  transitionTimeoutRef,\n  setDisplayGeojson\n) {\n  if (typeof transitionGeojsonDataRef.current[currentTransitionStepRef.current] !== \"undefined\") {\n    // if at last transition step set to target geojson\n    // else to an assembled LineString from common geometry and the current transition step geometry\n    let newData =\n      currentTransitionStepRef.current + 1 === transitionGeojsonDataRef.current.length\n        ? props.geojson\n        : turf.lineString([\n            ...transitionGeojsonCommonDataRef.current,\n            ...transitionGeojsonDataRef.current[currentTransitionStepRef.current].geometry\n              .coordinates,\n          ]);\n\n    setDisplayGeojson(newData);\n\n    if (typeof props.onTransitionFrame === \"function\") {\n      props.onTransitionFrame(newData);\n    }\n\n    currentTransitionStepRef.current++;\n    if (\n      transitionInProgressRef.current &&\n      currentTransitionStepRef.current < transitionGeojsonDataRef.current.length\n    ) {\n      transitionTimeoutRef.current = setTimeout(\n        () => _showNextTransitionSegment(...arguments),\n        msPerStep\n      );\n    } else {\n      if (typeof props.onTransitionEnd === \"function\") {\n        props.onTransitionEnd(props.geojson);\n      }\n      transitionInProgressRef.current = false;\n    }\n  }\n};\n\nconst _transitionToGeojson = (\n  props,\n  transitionGeojsonCommonDataRef,\n  transitionGeojsonDataRef,\n  transitionInProgressRef,\n  oldGeojsonRef,\n  msPerStep,\n  currentTransitionStepRef,\n  map,\n  transitionTimeoutRef,\n  setDisplayGeojson\n) => {\n  // create the transition geojson between oldGeojsonRef.current and props.geojson\n\n  // create a geojson that contains no common point between the two line features\n  let transitionCoordinatesShort = [];\n  let transitionCoordinatesLong = [];\n  let targetCoordinates = [];\n  let srcCoordinates = [];\n  transitionGeojsonCommonDataRef.current = [];\n  let sourceGeojson = oldGeojsonRef.current || {\n    geometry: {\n      type: \"LineString\",\n      coordinates: [],\n    },\n    properties: {},\n    type: \"Feature\",\n  };\n\n  let targetGeojson = props.geojson;\n\n  let longerGeojson = targetGeojson;\n  let shorterGeojson = sourceGeojson;\n  let reverseOrder = false;\n  // In case one geojson is missing completely use the first two coordinates of the other geojson\n  if (\n    typeof longerGeojson.geometry === \"undefined\" &&\n    typeof shorterGeojson.geometry !== \"undefined\" &&\n    shorterGeojson.geometry.coordinates.length > 1\n  ) {\n    longerGeojson = turf.lineString(shorterGeojson.geometry.coordinates.slice(0, 2));\n  } else if (\n    typeof shorterGeojson.geometry === \"undefined\" &&\n    typeof longerGeojson.geometry !== \"undefined\" &&\n    longerGeojson.geometry.coordinates.length > 1\n  ) {\n    shorterGeojson = turf.lineString(longerGeojson.geometry.coordinates.slice(0, 2));\n  } else if (\n    typeof shorterGeojson.geometry === \"undefined\" &&\n    typeof longerGeojson.geometry === \"undefined\"\n  ) {\n    return;\n  }\n\n  if (longerGeojson.geometry.coordinates.length < shorterGeojson.geometry.coordinates.length) {\n    longerGeojson = sourceGeojson;\n    shorterGeojson = targetGeojson;\n    reverseOrder = true;\n  }\n\n  if (longerGeojson && shorterGeojson) {\n    for (var i = 0, len = longerGeojson.geometry.coordinates.length; i < len; i++) {\n      if (\n        typeof shorterGeojson.geometry.coordinates[i] !== \"undefined\" &&\n        longerGeojson.geometry.coordinates[i][0] === shorterGeojson.geometry.coordinates[i][0] &&\n        longerGeojson.geometry.coordinates[i][1] === shorterGeojson.geometry.coordinates[i][1]\n      ) {\n        // if coordinates are equal\n        transitionGeojsonCommonDataRef.current.push(longerGeojson.geometry.coordinates[i]);\n      } else {\n        if (typeof longerGeojson.geometry.coordinates[i] !== \"undefined\") {\n          transitionCoordinatesLong.push(longerGeojson.geometry.coordinates[i]);\n        }\n        if (typeof shorterGeojson.geometry.coordinates[i] !== \"undefined\") {\n          transitionCoordinatesShort.push(shorterGeojson.geometry.coordinates[i]);\n        }\n      }\n    }\n  }\n\n  if (reverseOrder) {\n    targetCoordinates = transitionCoordinatesShort;\n    srcCoordinates = transitionCoordinatesLong;\n  } else {\n    targetCoordinates = transitionCoordinatesLong;\n    srcCoordinates = transitionCoordinatesShort;\n  }\n\n  if (targetCoordinates.length < 2 && srcCoordinates < 2) return;\n  // create props.transitionTime / msPerStep (=: transitionSteps) Versions of transitionGeojsonCommonDataRef.current + transitionCoordinates making the transitionCoordinates transitionCoordinatesDistance / transitionSteps longer on each step\n\n  let transitionSteps = props.transitionTime / msPerStep;\n  let srcCoordinatesDistance =\n    srcCoordinates.length > 1 ? Math.round(turf.length(turf.lineString(srcCoordinates))) : 0;\n  let targetCoordinatesDistance =\n    targetCoordinates.length > 1 ? Math.round(turf.length(turf.lineString(targetCoordinates))) : 0;\n  let transitionDistance = targetCoordinatesDistance + srcCoordinatesDistance;\n\n  let srcCoordinatesShare = srcCoordinatesDistance / transitionDistance;\n  let srcTransitionSteps = Math.round(transitionSteps * srcCoordinatesShare);\n  let srcPerStepDistance = Math.round((srcCoordinatesDistance / srcTransitionSteps) * 100) / 100;\n\n  let targetCoordinatesShare = targetCoordinatesDistance / transitionDistance;\n  let targetTransitionSteps = Math.round(transitionSteps * targetCoordinatesShare);\n  let targetPerStepDistance =\n    Math.round((targetCoordinatesDistance / targetTransitionSteps) * 100) / 100;\n\n  // use srcPerStepDistance as src coordinates are always animated backwards\n  let loopStepDistance = srcCoordinatesDistance;\n  if (loopStepDistance <= 0) {\n    loopStepDistance = 0.1;\n  }\n\n  // create transition step data as an array of all required FeatureCollection states until the transition is complete\n  let transitionStepData;\n\n  transitionStepData = [\n    ...createTransitionSteps(srcCoordinates, srcPerStepDistance, srcTransitionSteps),\n  ];\n  transitionStepData.reverse();\n\n  transitionStepData = [\n    ...transitionStepData,\n    ...createTransitionSteps(targetCoordinates, targetPerStepDistance, targetTransitionSteps),\n  ];\n\n  transitionStepData.push(targetGeojson);\n\n  transitionGeojsonDataRef.current = transitionStepData;\n\n  currentTransitionStepRef.current = 1;\n  transitionInProgressRef.current = true;\n  transitionTimeoutRef.current = setTimeout(\n    () =>\n      _showNextTransitionSegment(\n        props,\n        map,\n        transitionInProgressRef,\n        transitionGeojsonDataRef,\n        transitionGeojsonCommonDataRef,\n        currentTransitionStepRef,\n        msPerStep,\n        transitionTimeoutRef,\n        setDisplayGeojson\n      ),\n    msPerStep\n  );\n};\n\nlet createTransitionSteps = (linestringCoordinates, perStepDistance, stepCnt) => {\n  let transitionSteps = [];\n\n  if (linestringCoordinates.length > 1) {\n    let tmpChunks = turf.lineChunk(turf.lineString(linestringCoordinates), perStepDistance);\n    // tmpLineString contains all coordinates of all previous plus current loop iteration\n    let tmpLinestring = tmpChunks.features[0];\n    for (let i = 0; i < stepCnt; i++) {\n      transitionSteps.push(tmpLinestring);\n      if (typeof tmpChunks.features[i] !== \"undefined\") {\n        tmpLinestring = turf.lineString([\n          ...tmpLinestring.geometry.coordinates,\n          ...tmpChunks.features[i].geometry.coordinates,\n        ]);\n      } else {\n        break;\n      }\n    }\n  }\n  return transitionSteps;\n};\n\nexport { _showNextTransitionSegment, _transitionToGeojson };\n","import React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport * as turf from \"@turf/turf\";\n\nimport useMap from \"../../hooks/useMap\";\n\nimport { _transitionToGeojson } from \"./util/transitionFunctions\";\nimport MlGeoJsonLayer from \"../MlGeoJsonLayer/MlGeoJsonLayer\";\n\nconst msPerStep = 50;\n\n/**\n * Adds source and layer of types \"line\", \"fill\" or \"circle\" to display GeoJSON data on the map.\n *\n * @component\n */\nconst MlTransitionGeoJsonLayer = (props) => {\n  const { geojson, ...restProps } = props;\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapHook = useMap({ mapId: props.mapId, waitForLayer: props.insertBeforeLayer });\n  const initializedRef = useRef(false);\n\n  // transition effect variables\n  const oldGeojsonRef = useRef(null);\n  const transitionInProgressRef = useRef(false);\n  const transitionTimeoutRef = useRef(undefined);\n  const currentTransitionStepRef = useRef(false);\n  const transitionGeojsonDataRef = useRef([]);\n  const transitionGeojsonCommonDataRef = useRef([]);\n  const [displayGeojson, setDisplayGeojson] = useState(turf.featureCollection([]));\n\n  useEffect(() => {\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      if (transitionTimeoutRef.current) {\n        clearTimeout(transitionTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const transitionToGeojson = useCallback(() => {\n    _transitionToGeojson(\n      props,\n      transitionGeojsonCommonDataRef,\n      transitionGeojsonDataRef,\n      transitionInProgressRef,\n      oldGeojsonRef,\n      msPerStep,\n      currentTransitionStepRef,\n      mapHook.map,\n      transitionTimeoutRef,\n      setDisplayGeojson\n    );\n  }, [props, mapHook.map]);\n\n  useEffect(() => {\n    if (!mapHook.map || !initializedRef.current) return;\n\n    if (\n      typeof props.transitionTime !== \"undefined\" &&\n      props.type === \"line\" &&\n      oldGeojsonRef.current\n    ) {\n      transitionInProgressRef.current = false;\n      currentTransitionStepRef.current = false;\n      transitionGeojsonDataRef.current = [];\n      transitionGeojsonCommonDataRef.current = [];\n      transitionToGeojson();\n    }\n    oldGeojsonRef.current = props.geojson;\n  }, [mapHook.map, transitionToGeojson, props]);\n\n  const startTransition = useCallback(() => {\n    if (\n      props.type === \"line\" &&\n      typeof props.transitionTime !== \"undefined\" &&\n      props.transitionTime &&\n      typeof props.geojson.geometry !== \"undefined\" &&\n      JSON.stringify(oldGeojsonRef.current) !== JSON.stringify(props.geojson)\n    ) {\n      transitionToGeojson(props.geojson);\n      oldGeojsonRef.current = props.geojson;\n    }\n  }, [props, transitionToGeojson]);\n\n  useEffect(() => {\n    if (!mapHook.mapIsReady || !props.geojson) return;\n\n    initializedRef.current = true;\n\n    startTransition();\n  }, [mapHook.mapIsReady, startTransition, props]);\n\n  return (\n    <>\n      <MlGeoJsonLayer {...restProps} geojson={displayGeojson} />\n    </>\n  );\n};\n\nMlTransitionGeoJsonLayer.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Type of the layer that will be added to the MapLibre instance.\n   * Possible values: \"line\", \"circle\", \"fill\"\n   */\n  type: PropTypes.string,\n  /**\n   * Layout property object, that is passed to the addLayer call.\n   * Possible props depend on the layer type.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  layout: PropTypes.object,\n  /**\n   * Paint property object, that is passed to the addLayer call.\n   * Possible props depend on the layer type.\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\n   * https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill\n   */\n  paint: PropTypes.object,\n  /**\n   * Javascript object with optional properties \"fill\", \"line\", \"circle\" to override implicit layer type default paint properties.\n   */\n  defaultPaintOverrides: PropTypes.object,\n  /**\n   * Javascript object that is spread into the addLayer commands first parameter.\n   */\n  options: PropTypes.object,\n  /**\n   * GeoJSON data that is supposed to be rendered by this component.\n   */\n  geojson: PropTypes.object,\n  /**\n   * Id of an existing layer in the mapLibre instance to help specify the layer order\n   * This layer will be visually beneath the layer with the \"insertBeforeLayer\" id.\n   */\n  insertBeforeLayer: PropTypes.string,\n  /**\n   * Click event handler that is executed whenever a geometry rendered by this component is clicked.\n   */\n  onClick: PropTypes.func,\n  /**\n   * Hover event handler that is executed whenever a geometry rendered by this component is hovered.\n   */\n  onHover: PropTypes.func,\n  /**\n   * Leave event handler that is executed whenever a geometry rendered by this component is\n   * left/unhovered.\n   */\n  onLeave: PropTypes.func,\n  /**\n   * Creates transition animation whenever the geojson prop changes.\n   * Only works with layer type \"line\" and LineString GeoJSON data.\n   */\n  transitionTime: PropTypes.number,\n};\n\nexport default MlTransitionGeoJsonLayer;\n","import React, { useRef, useState, useEffect, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport MlGeoJsonLayer from \"../MlGeoJsonLayer/MlGeoJsonLayer\";\nimport Paper from \"@mui/material/Paper\";\nimport useMapState from \"../../hooks/useMapState\";\n\nimport { MapContext } from \"@mapcomponents/react-core\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Adds a marker to the map and displays a marker description next to it\n *\n * @param {object} props\n * @param {string} props.mapId Id of the target MapLibre instance in mapContext\n * @param {number} props.lng\n * @param {number} props.lat\n * @param {string} props.content\n *\n * @component\n */\nconst MlMarker = (props) => {\n  const mapContext = useContext(MapContext);\n  const mapState = useMapState({ mapId: props.mapId, watch:{viewport: true}});\n\n  const iframe = useRef(undefined);\n  const initializedRef = useRef(false);\n  const mapRef = useRef(undefined);\n  const componentId = useRef((props.idPrefix ? props.idPrefix : \"MlMarker-\") + uuidv4());\n  const [iframeDimensions, setIframeDimensions] = useState({ width: \"400px\", height: \"500px\" });\n\n  const [markerPixelPos, setMarkerPixelPos] = useState(undefined);\n\n  useEffect(() => {\n    let _componentId = componentId.current;\n\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      // try to remove anything this component has added to the MapLibre-gl instance\n      // e.g.: remove the layer\n      // mapContext.getMap(props.mapId).removeLayer(layerRef.current);\n      // check for the existence of map.style before calling getLayer or getSource\n\n      if (mapRef.current) {\n        mapRef.current.cleanup(_componentId);\n        mapRef.current = undefined;\n      }\n      initializedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId) || initializedRef.current) return;\n    // the MapLibre-gl instance (mapContext.getMap(props.mapId)) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    initializedRef.current = true;\n    mapRef.current = mapContext.getMap(props.mapId);\n  }, [mapContext.mapIds, mapContext, props.mapId]);\n\n  useEffect(() => {\n    if (!mapRef.current?.project) return;\n\n    const _pixelPos = mapRef.current.project([props.lng, props.lat]);\n\n    setMarkerPixelPos(_pixelPos);\n  }, [props.lng, props.lat, mapState.viewport]);\n\n  useEffect(() => {\n    if (mapRef.current && iframe.current?.contentWindow?.document?.body?.scrollHeight) {\n      setTimeout(() => {\n        let mapHeight = mapRef.current._container.clientHeight;\n\n        const _pixelPos = mapRef.current.project([props.lng, props.lat]);\n        let pixelToBottom = mapHeight - _pixelPos.y;\n        let iframeHeight = iframe.current?.contentWindow?.document?.body?.scrollHeight;\n        let iframeWidth = iframe.current?.contentWindow?.document?.body?.scrollWidth;\n\n        setIframeDimensions({\n          width: iframeWidth,\n          height: pixelToBottom < iframeHeight ? pixelToBottom : iframeHeight,\n        });\n      }, 100);\n    }\n  }, [props.lng, props.lat, props.content]);\n\n  return (\n    <>\n      <MlGeoJsonLayer\n        geojson={{\n          type: \"Feature\",\n          geometry: {\n            type: \"Point\",\n            coordinates: [props.lng, props.lat],\n          },\n          properties: {},\n        }}\n        paint={{\n          \"circle-radius\": 14,\n          \"circle-color\": \"rgba(40,200,20,0.5)\",\n        }}\n        type=\"circle\"\n        mapId={props.mapId}\n      ></MlGeoJsonLayer>\n      {markerPixelPos && (\n        <Paper\n          sx={{\n            opacity: 0.7,\n            position: \"fixed\",\n            display: \"flex\",\n            /** TODO: fix positioning delay when moving the map */\n            left: markerPixelPos.x,\n            top: markerPixelPos.y,\n            width: iframeDimensions.width,\n            height: iframeDimensions.height,\n            \"&:hover\": {\n              opacity: 1,\n            },\n            zIndex: -1,\n          }}\n        >\n          <iframe\n            style={{ width: \"100%\" }}\n            srcDoc={props.content}\n            ref={iframe}\n            sandbox=\"allow-same-origin allow-popups-to-escape-sandbox\"\n            frameBorder=\"0\"\n            title={componentId.current}\n          ></iframe>\n        </Paper>\n      )}\n    </>\n  );\n};\n\nMlMarker.defaultProps = {\n  mapId: undefined,\n};\n\nMlMarker.propTypes = {\n  /**\n   * Id of the target MapLibre instance in mapContext\n   */\n  mapId: PropTypes.string,\n  /**\n   * Longitude of the marker position\n   */\n  lng: PropTypes.number,\n  /**\n   * Latitude of the marker position\n   */\n  lat: PropTypes.number,\n  /**\n   * Content of the description popup\n   */\n  content: PropTypes.string,\n};\nexport default MlMarker;\n","import { useState, useEffect } from \"react\";\nimport WMSCapabilities from \"wms-capabilities\";\n\nfunction useWms(props) {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const [getFeatureInfoUrl, setGetFeatureInfoUrl] = useState(undefined);\n  const [url, setUrl] = useState(props.url);\n  const [wmsUrl, setWmsUrl] = useState(\"\");\n  const [capabilities, setCapabilities] = useState(undefined);\n  const [error, setError] = useState(undefined);\n\n  const clearState = () => {\n    setGetFeatureInfoUrl(undefined);\n    setCapabilities(undefined);\n    //setLayers([]);\n    setWmsUrl(\"\");\n  };\n\n  useEffect(() => {\n    // extract URL parameters from the given URL\n    clearState();\n    setError(undefined);\n\n    if (!url) return;\n\n    let _propsUrlParams;\n    let _wmsUrl = url;\n    if (url.indexOf(\"?\") !== -1) {\n      _propsUrlParams = url.split(\"?\");\n      _wmsUrl = _propsUrlParams[0];\n    }\n    let _urlParamsFromUrl = new URLSearchParams(_propsUrlParams?.[1]);\n\n    let urlParamsObj = {\n      ...Object.fromEntries(_urlParamsFromUrl),\n      ...props.urlParameters,\n    };\n    // create URLSearchParams object to assemble the URL Parameters\n    let urlParams = new URLSearchParams(urlParamsObj);\n\n    let urlParamsStr =\n      decodeURIComponent(urlParams.toString()) + \"\".replace(/%2F/g, \"/\").replace(/%3A/g, \":\");\n\n    fetch(_wmsUrl + \"?\" + urlParamsStr)\n      .then((res) => {\n        if (!res.ok) {\n          throw Error(res.statusText + \" (\" + res.status + \" - \" + res.type + \")\");\n        } else {\n          return res.text();\n        }\n      })\n      .then((data) => {\n        setCapabilities(new WMSCapabilities(data).toJSON());\n      })\n      .catch((error) => {\n        //reset local state\n        clearState();\n        console.log(error);\n        setError(error.message);\n      });\n  }, [url, props.urlParameters]);\n\n  useEffect(() => {\n    if (!capabilities?.Service) return;\n\n    setWmsUrl(capabilities.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource);\n    // set getFeatureInfo url\n    setGetFeatureInfoUrl(\n      capabilities.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource\n    );\n  }, [capabilities]);\n\n  return {\n    capabilities,\n    getFeatureInfoUrl,\n    wmsUrl,\n    error,\n    setUrl,\n  };\n}\n\nuseWms.defaultProps = {\n  url: \"\",\n  urlParameters: {\n    SERVICE: \"WMS\",\n    VERSION: \"1.3.0\",\n    REQUEST: \"getCapabilities\",\n  },\n};\n\nexport default useWms;\n"],"names":["MapLibreGlWrapper","props","self","registeredElements","baseLayers","firstSymbolLayer","undefined","eventHandlers","layerchange","viewportchange","wrapper","on","eventName","handler","options","componentId","push","_arguments","initRegisteredElements","wrapperEvents","off","filter","item","Object","is","fire","context","scope","window","event","Event","data","forEach","call","layerState","layerStateString","oldLayerStateStrings","buildLayerObject","layer","id","type","visible","visibility","baseLayer","indexOf","buildLayerObjects","style","_order","map","layerId","_layers","n","refreshLayerState","JSON","stringify","viewportState","viewportStateString","oldViewportStateString","getViewport","getCenter","center","lng","lat","rest","zoom","getZoom","bearing","getBearing","pitch","getPitch","refreshViewport","force","layers","sources","images","events","controls","addLayer","beforeId","source","addSource","sourceId","addImage","image","ref","listener","addControl","control","position","cleanup","getLayer","removeLayer","getSource","removeSource","hasImage","removeImage","removeControl","updatingStyleFunctions","_update","styleFunctions","addNativeMaplibreFunctionsAndProps","getOwnPropertyNames","getPrototypeOf","keys","missingFunctions","initializeMapLibre","mapOptions","fetch","then","response","ok","json","Error","styleJson","catch","error","console","log","maplibregl","Map","onReady","MapLibreMap","useRef","mapContainer","mapContext","useContext","MapContext","mapContextRef","mapIdRef","mapId","useEffect","current","_mapContext","removeMap","remove","container","once","registerMap","setMap","React","defaultProps","accessToken","propTypes","PropTypes","string","object","useMapState","initializedRef","mapRef","viewport","setViewport","useState","viewportRef","setLayers","layersRef","uuidv4","layerIdFilter","useCallback","includeBaseLayers","matchLayerIds","RegExp","test","includes","_layerState","_layerStateString","_componentId","mapExists","getMap","watch","mapIds","shape","bool","oneOfType","instanceOf","matchSourceIds","useMap","mapState","waitForLayer","mapIsReady","setMapIsReady","layerFound","MlComponentTemplate","mapHook","insertBeforeLayer","setCenter","MlFillExtrusionLayer","showLayer","setShowLayer","idPrefix","lastLabelLayerId","sourceLayer","minzoom","minZoom","paint","setLayoutProperty","property","number","getDefaultPaintPropsByType","defaultPaintOverrides","fill","line","circle","mapGeometryTypesToLayerTypes","Position","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","getDefaulLayerTypeByGeometry","geojson","geometry","features","length","legalLayerTypes","MlGeoJsonLayer","layerTypeRef","key","layout","_paint","setPaintProperty","setData","createLayer","onHover","onClick","onLeave","func","MlFollowGps","isFollowed","setIsFollowed","userLocationGeoJson","setUserLocationGeoJson","locationAccessDenied","setLocationAccessDenied","accuracyGeoJson","setAccuracyGeoJson","deviceOrientation","setDeviceOrientation","getLocationSuccess","pos","flyTo","coords","longitude","latitude","speed","curve","showUserLocation","geoJsonPoint","point","accuracy","getLocationError","err","orientationCone","useMemo","radius","bearing1","bearing2","steps","arc","lineArc","copy","coordinates","slice","handleOrientation","alpha","_handleOrientation","addEventListener","removeEventListener","_watchId","navigator","geolocation","watchPosition","clearWatch","accuracyPaint","circlePaint","zIndex","color","onColor","offColor","fontSize","minWidth","minHeight","width","height","backgroundColor","borderRadius","margin","showAccuracyCircle","showOrientation","nmMap","street","place","zip","state","nmConverter","nmAddress","addressArr","some","element","hasOwnProperty","join","toPixels","conversionFactor","createPdf","locationValue","setLoading","actualPixelRatio","devicePixelRatio","hidden","document","createElement","className","body","appendChild","renderMap","interactive","preserveDrawingBuffer","fadeDuration","attributionControl","getStyle","name","src","setStyle","pdf","jsPDF","orientation","unit","compress","defineProperty","get","offsetX","offsetY","marginTop","marginBottom","innerMargin","logo","textBuffer","lineHeight","text","address","textChunksSeperator","split","textChunks","chunk","limitChunks","match","getCanvas","toDataURL","setFillColor","rect","setFontSize","internal","pageSize","infoBoxSize","i","trim","setProperties","title","subject","creator","author","save","parentNode","removeChild","MlCreatePdfButton","MlImageMarkerLayer","layerInitializedRef","imageIdRef","imageId","Date","getTime","tmpOptions","imgSrc","loadImage","NeedleButton","NeedleContainer","RotateButton","MlNavigationCompass","setBearing","_updateBearing","Math","round","css","top","border","background","display","justifyContent","transform","backgroundStyle","rotateRightStyle","RotateRightIcon","abs","needleStyle","NeedleIcon","rotateLeftStyle","RotateLeftIcon","MlNavigationTools","setPitch","mediaIsMobile","useMediaQuery","buttonStyle","zoomIn","_zoom","_maxZoom","easeTo","zoomOut","_minZoom","adjustPitch","targetPitch","moveToCurrentLocation","getCurrentPosition","location","right","bottom","flexDirection","marginLeft","boxShadow","fontWeight","Button","padding","MlLayer","layerPaintConfRef","layerLayoutConfRef","layoutString","paintString","MlOsmLayer","tileSize","sourceOptions","maxzoom","layerOptions","MlVectorTileLayer","layerIdsRef","layerPaintConfsRef","layerLayoutConfsRef","tiles","url","attribution","_layerId","layerPaintConfString","paintKey","layerLayoutConfString","layoutKey","urlParameters","bbox","format","service","version","request","srs","styles","maxZoom","MlWmsLayer","_propsUrlParams","_wmsUrl","_urlParamsFromUrl","URLSearchParams","urlParamsObj","fromEntries","urlParams","urlParamsStr","decodeURIComponent","toString","replace","isRequired","classes","CONTROL_BASE","CONTROL_PREFIX","CONTROL_BUTTON","CONTROL_BUTTON_LINE","CONTROL_BUTTON_POLYGON","CONTROL_BUTTON_POINT","CONTROL_BUTTON_TRASH","CONTROL_BUTTON_COMBINE_FEATURES","CONTROL_BUTTON_UNCOMBINE_FEATURES","CONTROL_GROUP","ATTRIBUTION","ACTIVE_BUTTON","BOX_SELECT","HOT","COLD","cursors","ADD","MOVE","DRAG","POINTER","NONE","types","POLYGON","LINE","POINT","geojsonTypes","FEATURE","LINE_STRING","FEATURE_COLLECTION","MULTI_PREFIX","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","modes","DRAW_LINE_STRING","DRAW_POLYGON","DRAW_POINT","SIMPLE_SELECT","DIRECT_SELECT","STATIC","CREATE","DELETE","UPDATE","SELECTION_CHANGE","MODE_CHANGE","ACTIONABLE","RENDER","COMBINE_FEATURES","UNCOMBINE_FEATURES","updateActions","CHANGE_COORDINATES","meta","MIDPOINT","VERTEX","activeStates","ACTIVE","INACTIVE","interactions","LAT_MIN","LAT_RENDERED_MIN","LAT_MAX","LAT_RENDERED_MAX","LNG_MIN","LNG_MAX","isOfMetaType","e","featureTarget","properties","isShiftMousedown","originalEvent","shiftKey","button","isActiveFeature","active","Constants","isInactiveFeature","noTarget","isFeature","isVertex","isShiftDown","isEscapeKey","keyCode","isEnterKey","doubleClickZoom","enable","ctx","setTimeout","_ctx","store","getInitialConfigValue","disable","isEventAtCoordinates","lngLat","create_vertex","parentId","path","selected","parent","coord_path","CustomPolygonMode","onSetup","polygon","newFeature","addFeature","clearSelectedFeatures","updateUIClasses","mouse","activateUIButton","setActionableState","trash","currentVertexPosition","clickAnywhere","changeMode","featureIds","updateCoordinate","toGeoJSON","clickOnVertex","onMouseMove","CommonSelectors","onTap","onKeyUp","deleteFeature","silent","onStop","getFeature","removeCoordinate","isValid","toDisplayFeatures","isActivePolygon","coordinateCount","createVertex","endPos","lineCoordinates","onTrash","mouseEventPoint","mouseEvent","getBoundingClientRect","clientX","left","clientLeft","clientY","clientTop","create_midpoint","startVertex","endVertex","startCoord","endCoord","mid","createSupplementaryPoints","basePath","featureId","supplementaryPoints","isSelectedPath","lineIndex","processLine","String","processMultiGeometry","lineBasePath","firstPointString","lastVertex","pointIndex","pointPath","vertex","midpoints","midpoint","createMidpoint","stringifiedPoint","selectedPaths","subType","subCoordinates","index","subFeature","concat","StringSet","items","_items","_nums","_length","l","add","prototype","x","has","delete","values","k","v","parse","sort","a","b","clear","constrain_feature_movement","geojsonFeatures","delta","northInnerEdge","southInnerEdge","northOuterEdge","southOuterEdge","westEdge","eastEdge","feature","bounds","extent","featureSouthEdge","featureNorthEdge","featureWestEdge","featureEastEdge","constrainedDelta","ceil","move_features","constrainFeatureMovement","currentCoordinates","getCoordinates","moveCoordinate","coord","moveRing","ring","moveMultiPolygon","multi","nextCoordinates","incomingCoords","CustomSelectMode","opts","dragMoveLocation","boxSelectStartLocation","boxSelectElement","boxSelecting","canBoxSelect","dragMoving","canDragMove","initiallySelectedFeatureIds","setSelected","fireActionable","combineFeatures","uncombineFeatures","fireUpdate","action","getSelected","f","selectedFeatures","multiFeatures","isInstanceOf","featureType","getUniqueIds","allFeatures","ids","s","reduce","memo","stopExtendedInteractions","dragPan","onMouseOut","clickOnFeature","wasSelected","getSelectedIds","doRender","coordPath","startPos","startOnActiveFeature","isShiftClick","selectedFeatureIds","isFeatureSelected","isSelected","deselect","select","onMouseDown","drawConfig","boxSelect","startBoxSelect","getContainer","onTouchStart","onDrag","dragMove","whileBoxSelect","classList","minX","min","maxX","max","minY","y","maxY","translateValue","WebkitTransform","stopPropagation","moveFeatures","onMouseUp","featuresInBox","featuresAt","idsToSelect","onCombineFeatures","featuresCombined","subcoords","multiFeature","createdFeatures","deletedFeatures","onUncombineFeatures","featuresUncombined","getFeatures","drawUtils","getMatchingVertices","decimals","matchingVertices","v_lng","toFixed","v_lat","m","getDrawInstance","_controls","defaultMode","isMidpoint","DirectSelect","selectedCoordPaths","startDragging","stopDragging","onVertex","about","selectedIndex","getAll","_geometry","groupMove_vertices","selectedCoordinates","pathsToCoordinates","setSelectedCoordinates","onMidpoint","addCoordinate","paths","feature_id","onFeature","dragFeature","dragVertex","selectedCoords","getCoordinate","selectedCoordPoints","coord_path_m","coord_m","clickNoTarget","clickInactive","clickActiveFeature","clearSelectedCoordinates","changed","TypeError","localeCompare","numeric","noCoords","onTouchEnd","MlFeatureEditor","draw","onChangeRef","onChange","drawToolsInitialized","setDrawToolsInitialized","drawToolsReady","setDrawToolsReady","mouseUpTrigger","setMouseUpTrigger","modeChangeHandler","mode","mouseUpHandler","random","MapboxDraw","displayControlsDefault","assign","custom_polygon","custom_select","custom_direct_select","CustomDirectSelectMode","set","currentFeatureCollection","MlBasicComponent","MlLayerMagnify","syncMoveInitializedRef","syncCleanupFunctionRef","swipeX","setSwipeX","swipeXRef","swipeY","setSwipeY","swipeYRef","magnifierRadiusRef","magnifierRadius","setMagnifierRadius","map1Id","map2Id","onResize","onMove","_onResize","maps","touches","swipeX_tmp","swipeY_tmp","clipPath","syncMove","clientWidth","clientHeight","floor","onDown","onWheel","evCopy","WheelEvent","dispatchEvent","cursor","textAlign","userSelect","MlLayerSwipe","clipA","clip","GeoJsonContext","createContext","GeoJsonContextProvider","Provider","removeSpace","trimSpace","splitSpace","okhash","h","charCodeAt","getElementsByTagName","attr","getAttribute","attrf","parseFloat","get1","norm","el","normalize","numarray","j","o","nodeVal","textContent","getMulti","ys","extend","coord1","coordPair","ll","ele","heartRate","time","isNaN","fc","serializer","XMLSerializer","isNodeEnv","process","browser","isTitaniumEnv","Titanium","exports","require","xml2str","str","xml","serializeToString","t","kml","doc","gj","styleIndex","styleByHash","styleMapIndex","geotypes","placemarks","styleMaps","hash","pairs","pairsMap","getPlacemark","kmlColor","opacity","substr","parseInt","gxCoord","gxCoords","root","elems","times","timeElems","getGeometry","geomNode","geomNodes","geoms","coordTimes","rings","track","geomsAndTimes","styleUrl","description","timeSpan","timeStamp","extendedData","lineStyle","polyStyle","styleHash","styleMapHash","normal","iconStyle","icon","href","begin","end","timespan","timestamp","linestyles","stroke","polystyles","pcolor","popacity","outline","datas","simpleDatas","geometries","gpx","tracks","routes","waypoints","getTrack","getRoute","getPoint","initializeArray","arr","size","getPoints","node","pointname","pts","heartRates","c","segments","getProperties","getLineStyle","prop","routeObj","extensions","links","link","MlGPXViewer","dataSource","sourceName","layerNameLines","layerNamePoints","open","setIsOpen","dropZone","setZIndex","metaData","setMetaData","fileupload","popup","Popup","closeButton","closeOnClick","layerName","setLngLat","setHTML","addTo","setZoom","dropZoneCurrent","raiseDropZoneAndStopDefault","stopDefault","lowerDropZone","lowerDropZoneAndStopDefault","preventDefault","dropHandler","dataTransfer","kind","reader","FileReader","onload","payload","addGPXToMap","currentTarget","result","file","getAsFile","readAsText","gpxAsString","domParser","DOMParser","gpxDoc","parseFromString","metadata","querySelector","childNodes","value","nodeName","metaDatEntry","prevState","fitBounds","toogleDrawer","fileUploadOnChange","files","manualUpload","click","gap","msTransform","GeoJsonProvider","children","getEmptyFeatureCollection","MlSpatialElevationProfile","createStep","z","x2","y2","lineString","offsetLine","lineOffset","units","x3","y3","x4","y4","elevationFactor","find","heights","coordinate","lerp","points","wayLength","distance","listLength","newData","_showNextTransitionSegment","transitionInProgressRef","transitionGeojsonDataRef","transitionGeojsonCommonDataRef","currentTransitionStepRef","msPerStep","transitionTimeoutRef","setDisplayGeojson","turf","onTransitionFrame","arguments","onTransitionEnd","_transitionToGeojson","oldGeojsonRef","transitionCoordinatesShort","transitionCoordinatesLong","targetCoordinates","srcCoordinates","sourceGeojson","targetGeojson","longerGeojson","shorterGeojson","reverseOrder","len","transitionSteps","transitionTime","srcCoordinatesDistance","targetCoordinatesDistance","transitionDistance","srcCoordinatesShare","srcTransitionSteps","srcPerStepDistance","targetCoordinatesShare","targetTransitionSteps","targetPerStepDistance","transitionStepData","createTransitionSteps","reverse","linestringCoordinates","perStepDistance","stepCnt","tmpChunks","tmpLinestring","MlTransitionGeoJsonLayer","restProps","displayGeojson","clearTimeout","transitionToGeojson","startTransition","MlMarker","iframe","iframeDimensions","setIframeDimensions","markerPixelPos","setMarkerPixelPos","project","_pixelPos","contentWindow","scrollHeight","mapHeight","_container","pixelToBottom","iframeHeight","iframeWidth","scrollWidth","content","useWms","getFeatureInfoUrl","setGetFeatureInfoUrl","setUrl","wmsUrl","setWmsUrl","capabilities","setCapabilities","setError","clearState","res","statusText","status","WMSCapabilities","toJSON","message","Service","Capability","Request","GetMap","DCPType","HTTP","Get","OnlineResource","GetFeatureInfo","SERVICE","VERSION","REQUEST"],"mappings":"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"}