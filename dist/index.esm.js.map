{"version":3,"file":"index.esm.js","sources":["../src/components/MapLibreMap/MapLibreMap.js","../src/components/MlWmsLayer/MlWmsLayer.js","../src/components/MlAerialPhotograph/MlAerialPhotograph.js","../src/components/MlCameraFollowPath/MlCameraFollowPath.js","../src/components/MlComponentTemplate/MlComponentTemplate.js","../src/components/MlCompositeLayer/MlCompositeLayer.js","../src/components/MlCreatePdfButton/lib/nominatimMap.js","../src/components/MlCreatePdfButton/lib/createPdf.js","../src/components/MlCreatePdfButton/MlCreatePdfButton.js","../src/components/MlBasicComponent.js","../src/components/MlDeckGlLayer/MlDeckGlLayer.js","../src/components/MlDeckGlTerrainLayer/MlDeckGlTerrainLayer.js","../src/components/MlGeoJsonLayer/MlGeoJsonLayer.js","../src/components/MlGPXViewer/util/GeoJsonContext.js","../src/components/MlGPXViewer/MlGPXViewer.js","../src/components/MlHillshadeLayer/MlHillshadeLayer.js","../src/components/MlImageMarkerLayer/MlImageMarkerLayer.js","../src/deckgl_components/DeckGlContext.js","../src/ui_components/TopToolbar.js","../src/components/MlLaermkarte/MlLaermkarte.js","../src/components/MlLayer/MlLayer.js","../src/components/MlMapDrawTools/custom-polygon-mode.js","../src/components/MlMapDrawTools/lib/move_features.js","../src/components/MlMapDrawTools/lib/utils.js","../src/components/MlMapDrawTools/custom-select-mode.js","../src/components/MlMapDrawTools/custom-direct-select-mode.js","../src/components/MlMapDrawTools/MlMapDrawTools.js","../src/components/MlOsmLayer/MlOsmLayer.js","../src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js","../src/components/MlThreeJsLayer/MlThreeJsLayer.js","../src/components/MlVectorTileLayer/MlVectorTileLayer.js","../src/components/MlWmsLayerMulti/MlWmsLayerMulti.js"],"sourcesContent":["import React, { useRef, useEffect, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport maplibregl from \"maplibre-gl\";\nimport \"maplibre-gl/dist/maplibre-gl.css\";\n\n/**\n * The MapLibreMap component will create the MapLibre-gl instance and set the reference at MapContext.map after the MapLibre-gl load event has fired. That way (since the map refence is created using the useState hook) you can use the react useEffect hook in depending components to access the MapLibre-gl instance like ```useEffect(() => { \\/** code *\\/ }, [mapContext.map])``` and be sure the code is executed once the MapLibre-gl instance has fired the load event.\n *\n * MapLibreMap returns the html node that will be used by MapLibre-gl to render the map.\n * This Component must be kept unaware of any related components that interact with the MapLibre-gl instance.\n */\nconst MapLibreMap = (props) => {\n  const map = useRef(null);\n  const mapContainer = useRef(null);\n\n  const mapContext = useContext(MapContext);\n\n  const mapOptions = props.options;\n\n  useEffect(() => {\n    return () => {\n      map.current.remove();\n      map.current = null;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (mapContainer.current) {\n      // TODO: adjust defaults\n      let defaultOptions = {\n        lng: 8.607,\n        lat: 53.1409349,\n        zoom: 10,\n        container: mapContainer.current,\n        accessToken:\n          \"pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA\",\n      };\n\n      map.current = new maplibregl.Map({ ...defaultOptions, ...mapOptions });\n\n      map.current.on(\"load\", () => {\n        if (props.mapId) {\n          mapContext.registerMap(props.mapId, map.current);\n        } else {\n          mapContext.setMap(map.current);\n        }\n      });\n\n      // TODO: remove this line\n      window.map = map.current;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mapContainer]);\n\n  return <div ref={mapContainer} className=\"mapContainer\" />;\n};\n\nMapLibreMap.propTypes = {\n  options: PropTypes.object,\n};\n\nexport default MapLibreMap;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\n\n/**\n * MlWmsLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlWmsLayer = (props) => {\n  const mapContext = useContext(MapContext);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const idPostfixRef = useRef(new Date().getTime());\n\n  const cleanup = () => {\n    if (mapContext.map.getLayer(\"raster-tile-layer-\" + idPostfixRef.current)) {\n      mapContext.map.removeLayer(\"raster-tile-layer-\" + idPostfixRef.current);\n    }\n    if (mapContext.map.getSource(\"raster-tile-source-\" + idPostfixRef.current)) {\n      mapContext.map.removeSource(\"raster-tile-source-\" + idPostfixRef.current);\n    }\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    return () => {\n      cleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    cleanup();\n\n    // Add the new layer to the openlayers instance once it is available\n    mapContext.map.addSource(\"raster-tile-source-\" + idPostfixRef.current, {\n      type: \"raster\",\n      tiles: [\n        props.url +\n          \"?bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&width=256&height=256&layers=\" +\n          props.layer,\n      ],\n      tileSize: 256,\n      attribution: \"\",\n      //...props.sourceOptions,\n    });\n\n    mapContext.map.addLayer(\n      {\n        id: \"raster-tile-layer-\" + idPostfixRef.current,\n        type: \"raster\",\n        source: \"raster-tile-source-\" + idPostfixRef.current,\n        minzoom: 0,\n        maxzoom: 10,\n        ...props.sourceOptions,\n      },\n      props.belowLayerId\n    );\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.map.setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"visible\"\n      );\n    } else {\n      mapContext.map.setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"none\"\n      );\n    }\n  }, [showLayer]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      WMS\n    </Button>\n  );\n};\n\nexport default MlWmsLayer;\n","import React, { useContext, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\nimport MlWmsLayer from \"../MlWmsLayer/MlWmsLayer\";\nimport * as turf from \"@turf/turf\";\n\nconst MlAerialPhotograph = () => {\n\n  const mapContext = useContext(MapContext);\n  const [legendData, setLegendData] = useState({\n    name: \"\",\n    class: \"\",\n    x: \"\",\n    y: \"\",\n    z: \"\"\n  });\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n\n    mapContext.map.transform._maxZoom = 19.99;\n\n    mapContext.map.addLayer({\n      id: \"mapData\",\n      source: \"openmaptiles\",\n      \"source-layer\": \"water\",\n      type: \"fill\",\n      paint: {\n        \"fill-opacity\": 0\n      }\n    });\n\n    mapContext.map.addLayer({\n      id: \"greenData\",\n      source: \"openmaptiles\",\n      \"source-layer\": \"landcover\",\n      type: \"fill\",\n      paint: {\n        \"fill-opacity\": 0\n      }\n    });\n\n    mapContext.map.addLayer({\n      id: \"placeData\",\n      source: \"openmaptiles\",\n      \"source-layer\": \"poi\",\n      type: \"circle\",\n      filter: [\"has\", \"name\"],\n      paint: {\n        \"circle-opacity\": 0,\n        \"circle-radius\": {\n          stops: [[0, 0], [20, 500]],\n          base: 2\n        }\n\n      }\n    });\n\n    mapContext.map.addLayer({\n      id: \"riverData\",\n      source: \"openmaptiles\",\n      type: \"line\",\n      \"source-layer\": \"waterway\",\n      filter: [\"==\", \"class\", \"river\"],\n      paint: {\n        \"line-opacity\": 0,\n        \"line-width\": 150\n      }\n    })\n\n    mapContext.map.on(\"mousemove\", function(e) {\n      let features = mapContext.map.queryRenderedFeatures(e.point, {layers: [\"mapData\", \"greenData\", \"placeData\", \"riverData\"]});\n      //let bigFeatures = mapContext.map.queryRenderedFeatures(e.point, {layers: [\"cityData\"]})\n      //let cityName = bigFeatures.find(element => element.properties.class === \"city\") || {properties: {name: \"\"}}\n      let closestFeature = getClosestFeature(features, Object.values(e.point))\n      if (features[0]) {\n        setLegendData({\n          name: closestFeature.properties.name,\n          class: closestFeature.properties.class,\n          x: closestFeature._vectorTileFeature._x,\n          y: closestFeature._vectorTileFeature._y,\n          z: closestFeature._vectorTileFeature._z,\n        });\n      }\n    });\n  }, [mapContext.map]);\n\n\n  function getClosestFeature(featureCollection, mousePoint, identifier){\n    identifier = identifier || true;\n    let closestFeature = featureCollection[0]\n    for(let i in featureCollection){\n      if(featureCollection[i].layer[\"source-layer\"] === identifier) {\n        if (turf.distance(turf.center(featureCollection[i]), mousePoint) > turf.distance(turf.center(closestFeature), mousePoint)) {\n          closestFeature = featureCollection[i]\n        }\n      }\n    }\n    return closestFeature\n  }\n\n  return (\n    <>\n      <MlWmsLayer\n        url=\"https://www.wms.nrw.de/geobasis/wms_nw_dop\"\n        layer=\"nw_dop_rgb\"\n        sourceOptions={{ maxzoom: 20 }}\n        belowLayerId = \"waterway-name\"\n      />\n      <hr style={{ width: \"100%\", color: \"black\", padding: \"none\", height: \"3px\" }} />\n      <ul style={{ \"paddingLeft\": 0 }}>\n        {Object.keys(legendData).map((key) => (\n            <li> {`${key}: ${legendData[key] || \"\"}`} </li>\n          )\n        )}\n      </ul>\n    </>\n  );\n};\n\nexport default MlAerialPhotograph;","import React, { useEffect, useCallback, useContext, useRef, useMemo } from \"react\";\n\nimport * as turf from \"@turf/turf\";\nimport { MapContext } from \"react-map-components-core\";\n\nconst MlCameraFollowPath = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  // without the requirement of adding it to the dependency list (ignore the false eslint exhaustive deps warning)\n  const mapContext = useContext(MapContext);\n  const initializedRef = useRef(false);\n  const clearIntervalRef = useRef(false);\n\n  // default path, for testing default behaviour\n  const route = useMemo(\n    () =>\n      props.path || [\n        [7.09222, 50.725055],\n        [7.0577, 50.7621],\n      ],\n    [props.path]\n  );\n\n  useEffect(() => {\n    return () => {\n      clearIntervalRef.current = true;\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      // try to remove anything this component has added to the MapLibre-gl instance\n      // e.g.: remove the layer\n      // mapContext.getMap(props.mapId).removeLayer(layerRef.current);\n    };\n  }, []);\n\n  const disableInteractivity = useCallback(() => {\n    mapContext.map[\"scrollZoom\"].disable();\n    mapContext.map[\"boxZoom\"].disable();\n    mapContext.map[\"dragRotate\"].disable();\n    mapContext.map[\"dragPan\"].disable();\n    mapContext.map[\"keyboard\"].disable();\n    mapContext.map[\"doubleClickZoom\"].disable();\n    mapContext.map[\"touchZoomRotate\"].disable();\n  }, [mapContext.map]);\n  const enableInteractivity = useCallback(() => {\n    mapContext.map[\"scrollZoom\"].enable();\n    mapContext.map[\"boxZoom\"].enable();\n    mapContext.map[\"dragRotate\"].enable();\n    mapContext.map[\"dragPan\"].enable();\n    mapContext.map[\"keyboard\"].enable();\n    mapContext.map[\"doubleClickZoom\"].enable();\n    mapContext.map[\"touchZoomRotate\"].enable();\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.mapExists() || initializedRef.current) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    initializedRef.current = true;\n    var kmPerStep = props.kmPerStep || 0.01;\n    var routeDistance = turf.lineDistance(turf.lineString(route));\n\n    var zoomOutTo = props.zoomOutTo || 14;\n    var stepDuration = props.stepDuration || 70;\n    var step = 1;\n    var zoom = props.initialZoom || 18;\n    var zoomSteps = 0.04;\n\n    disableInteractivity();\n    if (mapContext.map.getZoom() !== zoom) {\n      mapContext.map.setZoom(zoom);\n    }\n\n    var timer = window.setInterval(function () {\n      if (clearIntervalRef.current) {\n        window.clearInterval(timer);\n        enableInteractivity();\n      }\n\n      var alongRoute = turf.along(turf.lineString(route), step * kmPerStep).geometry\n        .coordinates;\n\n      if (step * kmPerStep < routeDistance) {\n        mapContext.map.panTo(alongRoute, {\n          bearing: turf.bearing(\n            turf.point([\n              mapContext.map.getCenter().lng,\n              mapContext.map.getCenter().lat,\n            ]),\n            turf.point(alongRoute)\n          ),\n          duration: stepDuration,\n          essential: true,\n        });\n\n        step++;\n\n        console.log(\"PAN MOVE\");\n      } else if (zoom > zoomOutTo) {\n        zoom = zoom - zoomSteps;\n        mapContext.map.setZoom(zoom);\n        console.log(\"ZOOM OUT\");\n      } else {\n        window.clearInterval(timer);\n        console.log(\"ENABLE CONTROLS\");\n        enableInteractivity();\n      }\n    }, stepDuration);\n  }, [\n    mapContext.mapIds,\n    mapContext,\n    props,\n    disableInteractivity,\n    enableInteractivity,\n    route,\n  ]);\n\n  return <></>;\n};\n\nexport default MlCameraFollowPath;\n","import React, { useEffect, useContext } from \"react\";\n\nimport { MapContext } from \"react-map-components-core\";\n\nconst MlComponentTemplate = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n\n  useEffect(() => {\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      // try to remove anything this component has added to the MapLibre-gl instance\n      // e.g.: remove the layer\n      // mapContext.getMap(props.mapId).removeLayer(layerRef.current);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId)) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n    mapContext\n      .getMap(props.mapId)\n      .setCenter([7.132122000552613, 50.716405378037706]);\n  }, [mapContext.mapIds, mapContext, props.mapId]);\n\n  return <></>;\n};\n\nexport default MlComponentTemplate;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\n\nconst paintDefaults = {\n  \"fill-extrusion-color\": \"hsl(196, 61%, 83%)\",\n  \"fill-extrusion-height\": {\n    property: \"render_height\",\n    type: \"identity\",\n  },\n  \"fill-extrusion-base\": {\n    property: \"render_min_height\",\n    type: \"identity\",\n  },\n  \"fill-extrusion-opacity\": 1,\n};\n/**\n * MlCompositeLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlCompositeLayer = ({ paint, sourceId, sourceLayer, minZoom }) => {\n  const mapContext = useContext(MapContext);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const layerName = \"building-3d\";\n\n  const componentCleanup = () => {\n    if (mapContext.map.getLayer(layerName)) {\n      mapContext.map.removeLayer(layerName);\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      componentCleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // cleanup fragments left in MapLibre-gl from previous component uses\n    componentCleanup();\n\n    let addCompositeLayer = () => {\n      if (!mapContext.map.getLayer(layerName)) {\n        let lastLabelLayerId = false;\n        if (mapContext.map.getLayer(\"waterway-name\")) {\n          lastLabelLayerId = \"waterway-name\";\n        }\n\n        if (mapContext.map.getLayer(\"poi_label\")) {\n          lastLabelLayerId = \"poi_label\";\n        }\n\n        if (lastLabelLayerId) {\n          console.log({\n            ...paint,\n          });\n          mapContext.map.addLayer(\n            {\n              id: layerName,\n              type: \"fill-extrusion\",\n              source: sourceId || \"openmaptiles\",\n              \"source-layer\": sourceLayer || \"building\",\n              minzoom: minZoom || 14,\n              paint: {\n                ...paintDefaults,\n                ...paint,\n              },\n            },\n            lastLabelLayerId\n          );\n        }\n      }\n    };\n\n    addCompositeLayer();\n    //mapContext.map.setZoom(16.5);\n    //mapContext.map.setPitch(45);\n  }, [mapContext.map, componentCleanup, minZoom, paint, sourceId, sourceLayer]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    if (mapContext.map.getLayer(layerName)) {\n      // toggle layer visibility by changing the layout object's visibility property\n      if (showLayer) {\n        mapContext.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n      } else {\n        mapContext.map.setLayoutProperty(layerName, \"visibility\", \"none\");\n      }\n    }\n    //\n  }, [showLayer, mapContext]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      Composite\n    </Button>\n  );\n};\n\nexport default MlCompositeLayer;\n","const nmMap = {\n  street: [\n    \"footway\",\n    \"street\",\n    \"road\",\n    \"street_name\",\n    \"residential\",\n    \"path\",\n    \"pedestrian\",\n    \"road_reference\",\n    \"road_reference_intl\",\n    \"square\",\n    \"place\",\n  ],\n  number: [\"house_number\", \"street_number\"],\n  place: [\n    \"city\",\n    \"village\",\n    \"hamlet\",\n    \"locality\",\n    \"croft\",\n    \"neighbourhood\",\n    \"suburb\",\n    \"city_district\",\n    \"district\",\n    \"quarter\",\n    \"borough\",\n    \"city_block\",\n    \"residential\",\n    \"commercial\",\n    \"industrial\",\n    \"houses\",\n    \"subdivision\",\n    \"allotments\",\n    \"postal_city\",\n    \"town\",\n    \"municipality\",\n    \"local_administrative_area\",\n  ],\n  zip: [\"postcode\", \"partial_postcode\"],\n  state: [\"state\", \"province\", \"state_code\"],\n};\n\nconst nmConverter = (nmAddress) => {\n  const addressArr = [];\n  for (const [key, value] of Object.entries(nmMap)) {\n    value.some((element) => {\n      if (nmAddress.hasOwnProperty(element)) {\n        addressArr.push(nmAddress[element]);\n        return true;\n      }\n    });\n  }\n  return addressArr.join(\", \");\n};\nexport default nmConverter;\n","import maplibregl from \"maplibre-gl\";\nimport jsPDF from \"jspdf\";\nimport nmConverter from \"./nominatimMap.js\";\n\nconst toPixels = (length) => {\n  let conversionFactor = 96;\n\n  conversionFactor /= 25.4;\n\n  return conversionFactor * length + \"px\";\n};\n\nconst createPdf = (map, locationValue, setLoading) => {\n  console.log(\"start create PDF\");\n  setLoading(true);\n\n  const width = 210;\n  const height = 297;\n  // Calculate pixel ratio\n  const actualPixelRatio = window.devicePixelRatio;\n\n  // Create map container\n  const hidden = document.createElement(\"div\");\n  hidden.className = \"hidden-map\";\n  document.body.appendChild(hidden);\n  const container = document.createElement(\"div\");\n  container.style.width = toPixels(width);\n  container.style.height = toPixels(height);\n  hidden.appendChild(container);\n\n  //Render map\n  var renderMap = new maplibregl.Map({\n    container: container,\n    center: map.getCenter(),\n    zoom: map.getZoom(),\n    bearing: map.getBearing(),\n    pitch: map.getPitch(),\n    interactive: false,\n    preserveDrawingBuffer: true,\n    fadeDuration: 0,\n    attributionControl: false,\n  });\n  let style = map.getStyle();\n  for (let name in style.sources) {\n    let src = style.sources[name];\n\n    Object.keys(src).forEach((key) => {\n      //delete properties if value is undefined.\n      // for instance, raster-dem might has undefined value in \"url\" and \"bounds\"\n      if (!src[key]) {\n        delete src[key];\n      }\n    });\n  }\n  console.log(style);\n  renderMap.setStyle(style);\n\n  renderMap.once(\"idle\", function () {\n    // TO DO: It is still under development\n    const pdf = new jsPDF({\n      orientation: \"p\",\n      unit: \"mm\",\n      compress: true,\n    });\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function () {\n        return 300 / 96;\n      },\n    });\n    const offsetX = 2.5;\n    const offsetY = 2.5;\n    const marginTop = 3;\n    const marginBottom = 3;\n    const innerMargin = 2;\n    const logo =\n      \"data:image/png;base64,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\";\n    const textBuffer = 1;\n    const lineHeight = 3.25;\n    const text = locationValue ? nmConverter(locationValue.address) : \"\";\n    const textChunksSeperator = text.split(\",\");\n    const textChunks = [];\n\n    if (textChunks.length) {\n      textChunksSeperator.forEach((chunk) => {\n        const limitChunks = chunk.match(/.{1,34}/g);\n        textChunks.push(...limitChunks);\n      });\n    }\n\n    //Render map image\n    pdf.addImage(\n      renderMap.getCanvas().toDataURL(\"image/png\"),\n      \"png\",\n      0,\n      0,\n      210,\n      297,\n      null,\n      \"FAST\"\n    );\n\n    //Render lower left Copyright box\n    pdf.setFillColor(\"white\");\n    pdf.rect(138, 287, 297, 10, \"F\");\n    pdf.setFontSize(10); // optional\n    pdf.text(\n      \"Datenquelle: © OpenStreetMap-Mitwirkende\",\n      140,\n      pdf.internal.pageSize.height - 3\n    );\n\n    //Render infobox\n    pdf.setFillColor(\"white\");\n    const infoBoxSize =\n      textChunks.length * lineHeight +\n      marginTop +\n      marginBottom +\n      lineHeight * 2 +\n      innerMargin * 2 +\n      textBuffer;\n\n    pdf.rect(offsetX, 2, 66.5, infoBoxSize, \"F\");\n\n    pdf.setFontSize(10);\n    pdf.text(\"Karten PDF:\", 6, offsetY + marginTop);\n\n    //Render inner infobox\n    pdf.rect(\n      6,\n      7,\n      60,\n      textChunks.length * lineHeight + innerMargin * 2 + textBuffer\n    );\n    pdf.setFontSize(10);\n\n    //Write out address\n    textChunks.forEach((text, i) => {\n      pdf.text(text.trim(), 8, 10 + i * 3.5 + innerMargin);\n    });\n\n    //Add WG Logo\n    pdf.addImage(\n      logo,\n      \"png\",\n      5,\n      offsetY +\n        marginTop +\n        lineHeight * 2 +\n        textChunks.length * 3 +\n        innerMargin * 2,\n      3,\n      3,\n      null,\n      \"FAST\"\n    );\n\n    //Add WG Url\n    pdf.setFontSize(10);\n    pdf.text(\n      \"wheregroup.com\",\n      40,\n      offsetY +\n        marginTop +\n        lineHeight * 2 +\n        textChunks.length * lineHeight +\n        innerMargin * 2 +\n        textBuffer\n    );\n\n    //Set pdfs props\n    pdf.setProperties({\n      title: \"Map export\",\n      subject: \"Map export\",\n      creator: \"WhereGroup GmbH\",\n      author: \"(c)WhereGroup GmbH, (c)OpenStreetMap\",\n    });\n\n    pdf.save(\"Map.pdf\");\n\n    renderMap.remove();\n    hidden.parentNode?.removeChild(hidden);\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function () {\n        return actualPixelRatio;\n      },\n    });\n\n    setLoading(false);\n    console.log(\"end create PDF\");\n  });\n};\n\nexport default createPdf;\n","import React, { useContext } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport createPdf from \"./lib/createPdf.js\";\n\nimport PrinterIcon from \"@material-ui/icons/Print\";\nimport Button from \"@material-ui/core/Button\";\n\n/**\n * MlCreatePdfButton returns a Button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).\n * It expects a MapLibre-gl instance accessible in mapContext.map.\n */\nconst MlCreatePdfButton = () => {\n  const mapContext = useContext(MapContext);\n\n  return (\n    <>\n      <Button\n        color=\"primary\"\n        variant=\"contained\"\n        onClick={() => {\n          createPdf(mapContext.map, null, () => {});\n        }}\n      >\n        <PrinterIcon />\n      </Button>\n    </>\n  );\n};\n\nexport default MlCreatePdfButton;\n","import React, { useEffect, useContext } from \"react\";\n\nimport { MapContext } from \"react-map-components-core\";\n\nconst MlBasicComponent = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  // without the requirement of adding it to the dependency list (ignore the false eslint exhaustive deps warning)\n  // const layerRef = useRef(null);\n  const mapContext = useContext(MapContext);\n\n  useEffect(() => {\n    if (!mapContext.mapExists()) return;\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      // try to remove anything this component has added to the MapLibre-gl instance\n      // e.g.: remove the layer\n      // mapContext.map.removeLayer(layerRef.current);\n      if (typeof props.cleanup === \"function\") {\n        props.cleanup(mapContext.getMap(props.mapId));\n      }\n    };\n  });\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId)) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance\n    if (typeof props.mapIsReady === \"function\") {\n      props.mapIsReady(mapContext.getMap(props.mapId));\n    }\n  }, [mapContext.mapIds, mapContext, props]);\n\n  return <></>;\n};\n\nexport default MlBasicComponent;\n","import React, { useRef, useContext, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport MlBasicComponent from \"../MlBasicComponent\";\nimport Button from \"@material-ui/core/Button\";\nimport * as d3 from \"d3\";\n\nimport { AmbientLight, PointLight, LightingEffect } from \"@deck.gl/core\";\nimport { HexagonLayer } from \"@deck.gl/aggregation-layers\";\nimport { MapboxLayer } from \"@deck.gl/mapbox\";\n\n// Source data CSV\nconst DATA_URL = \"/assets/verspaetungen_gueterverkehr_2016.csv\"; // eslint-disable-line\n//\"https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv\"; // eslint-disable-line\n\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  intensity: 1.0,\n});\n\nconst pointLight1 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-0.144528, 49.739968, 80000],\n});\n\nconst pointLight2 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-3.807751, 54.104682, 8000],\n});\n\nconst lightingEffect = new LightingEffect({\n  ambientLight,\n  pointLight1,\n  pointLight2,\n});\n\nconst material = {\n  ambient: 0.64,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [51, 51, 51],\n};\n\nconst colorRange = [\n  [1, 152, 189],\n  [73, 227, 206],\n  [216, 254, 181],\n  [254, 237, 177],\n  [254, 173, 84],\n  [209, 55, 78],\n];\n\n/**\n * MlDeckGlLayer adds deck.gl hexagonlayer to the maplibre-gl instance.\n */\nconst MlDeckGlLayer = ({ init, onDone }) => {\n  const mapContext = useContext(MapContext);\n  const [showLayer, setShowLayer] = useState(true);\n  const layerName = \"deckgl-layer\";\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (typeof init === \"function\") {\n      init();\n    }\n\n    return () => {\n      if (mapContext.mapExists() && mapContext.getMap().getLayer(layerName)) {\n        mapContext.getMap().removeLayer(layerName);\n      }\n    };\n  }, []);\n\n  const mapIsReady = (map) => {\n    if (initializedRef.current) return;\n    initializedRef.current = true;\n\n    console.log(\"load heatmap data\");\n\n    d3.csv(DATA_URL).then((response) => {\n      const data = response.map((d) => {\n        return {\n          coordinates: [Number(d.LON), Number(d.LAT)],\n          minutes: d.Verspätungsminuten,\n        };\n      });\n      console.log(\"Add deckgl Layer\");\n\n      let mapBoxLayer = new MapboxLayer({\n        effects: [lightingEffect],\n        id: layerName,\n        //type: ScatterplotLayer,\n        //data: [\n        //  { position: [7.0851268, 50.73884], color: [255, 0, 0], radius: 1000 },\n        //],\n        //getPosition: (d) => d.position,\n        //getColor: (d) => d.color,\n        //getRadius: (d) => d.radius,\n        //opacity: 0.3,\n        type: HexagonLayer,\n        colorRange: colorRange,\n        coverage: 1,\n        data: data,\n        elevationRange: [0, 3000],\n        elevationScale: data && data.length ? 50 : 0,\n        extruded: true,\n        getPosition: (d) => d.coordinates,\n        pickable: true,\n        radius: 10000,\n        upperPercentile: 100,\n        material,\n        autoHighlight: true,\n        transitions: {\n          elevationScale: 3000,\n        },\n      });\n      window.mapBoxLayer = mapBoxLayer;\n\n      map.addLayer(mapBoxLayer, \"water-name-lakeline\");\n      if (typeof onDone === \"function\") {\n        console.log(\"hide overlay\");\n        onDone();\n      }\n    });\n    map.setZoom(6);\n    map.setPitch(45);\n    map.setCenter({ lng: 10.388616936080325, lat: 50.98176525739561 });\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n    } else {\n      mapContext.map.setLayoutProperty(layerName, \"visibility\", \"none\");\n    }\n  }, [showLayer]);\n\n  return (\n    <>\n      <MlBasicComponent mapIsReady={mapIsReady}></MlBasicComponent>\n      <Button\n        color=\"primary\"\n        variant={showLayer ? \"contained\" : \"outlined\"}\n        onClick={() => setShowLayer(!showLayer)}\n      >\n        DB Verspätungen im Güterverkehr 2016 (deck.gl)\n      </Button>\n    </>\n  );\n};\n\nexport default MlDeckGlLayer;\n","import React, { useContext, useRef, useEffect, useState, useCallback } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport MlBasicComponent from \"../MlBasicComponent\";\nimport Button from \"@material-ui/core/Button\";\nimport maplibregl from \"maplibre-gl\";\nimport * as d3 from \"d3\";\n\nimport { AmbientLight, PointLight, LightingEffect } from \"@deck.gl/core\";\nimport { MapboxLayer } from \"@deck.gl/mapbox\";\nimport { TerrainLayer } from \"@deck.gl/geo-layers\";\n\n/**\n * MlDeckGlTerrainLayer adds kepler.gl layer to the maplibre-gl instance.\n */\nconst MlDeckGlTerrainLayer = () => {\n  const mapContext = useContext(MapContext);\n  const [showLayer, setShowLayer] = useState(true);\n  const showLayerRef = useRef(true);\n  const layerName = \"deckgl-terrain-layer\";\n\n  const ELEVATION_DECODER = {\n    rScaler: 6553.6,\n    gScaler: 25.6,\n    bScaler: 0.1,\n    offset: -10000,\n  };\n\n  const TERRAIN_IMAGE = `https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA`;\n  const SURFACE_IMAGE = `https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA`;\n\n  let rotateCamera = useCallback(\n    (timestamp) => {\n      if (mapContext.map) {\n        // clamp the rotation between 0 -360 degrees\n        // Divide timestamp by 100 to slow rotation to ~10 degrees / sec\n        mapContext.map.rotateTo((timestamp / 100) % 360, { duration: 0 });\n        // Request the next frame of the animation.\n        console.log(showLayer);\n        if (showLayerRef.current) {\n          requestAnimationFrame(rotateCamera);\n        }\n      }\n    },\n    [showLayerRef, mapContext.map]\n  );\n\n  const cleanup = (map) => {\n    if (map.getLayer(layerName)) {\n      map.removeLayer(layerName);\n    }\n  };\n\n  const mapIsReady = (map) => {\n    map.addLayer(\n      new MapboxLayer({\n        id: layerName,\n        type: TerrainLayer,\n        minZoom: 0,\n        maxZoom: 23,\n        strategy: \"no-overlap\",\n        elevationDecoder: ELEVATION_DECODER,\n        elevationData: TERRAIN_IMAGE,\n        texture: SURFACE_IMAGE,\n        wireframe: false,\n        color: [255, 255, 255],\n      }),\n      \"water-name-lakeline\"\n    );\n    //    setTimeout(() => {\n    //      map.setZoom(13);\n    //      map.setPitch(45);\n    //      map.setCenter({ lng: 11.647776401389137, lat: 46.48726512556033 });\n    //      rotateCamera(0);\n    //    }, 500);\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      showLayerRef.current = true;\n      mapContext.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n      rotateCamera(0);\n    } else {\n      showLayerRef.current = false;\n      mapContext.map.setLayoutProperty(layerName, \"visibility\", \"none\");\n    }\n  }, [showLayer]);\n\n  return (\n    <>\n      <MlBasicComponent cleanup={cleanup} mapIsReady={mapIsReady}></MlBasicComponent>\n      <Button\n        color=\"primary\"\n        variant={showLayer ? \"contained\" : \"outlined\"}\n        onClick={() => setShowLayer(!showLayer)}\n      >\n        Terrain Layer\n      </Button>\n    </>\n  );\n};\n\nexport default MlDeckGlTerrainLayer;\n","import React, { useRef, useEffect, useContext, useCallback } from \"react\";\n\nimport * as turf from \"@turf/turf\";\nimport { MapContext } from \"react-map-components-core\";\n\nconst msPerStep = 50;\n\nconst MlGeoJsonLayer = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n  const idPostfixRef = useRef(props.idSuffix || new Date().getTime());\n  const oldGeojsonRef = useRef(null);\n  const mapRef = useRef(null);\n  const transitionInProgressRef = useRef(false);\n  const currentTransitionStepRef = useRef(false);\n  const transitionGeojsonDataRef = useRef([]);\n  const transitionGeojsonCommonDataRef = useRef([]);\n  const layerId = props.layerId || \"MlGeoJsonLayer-\";\n\n  useEffect(() => {\n    let mapObject = mapContext.getMap(props.mapId);\n    let layerSourceId = layerId + idPostfixRef.current;\n\n    return () => {\n      // This is the cleanup function, it is called when this react component is removed from react-dom\n      if (mapObject && mapObject.getLayer(layerSourceId)) {\n        mapObject.removeLayer(layerSourceId);\n      }\n      if (mapObject && mapObject.getSource(layerSourceId)) {\n        mapObject.removeSource(layerSourceId);\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId).getLayer(layerId + idPostfixRef.current)\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    for (var key in props.paint) {\n      mapContext\n        .getMap(props.mapId)\n        .setPaintProperty(layerId + idPostfixRef.current, key, props.paint[key]);\n    }\n  }, [props.paint, layerId, mapContext, props.mapId]);\n\n  const showNextTransitionSegment = useCallback(() => {\n    if (\n      typeof mapRef.current.getSource(layerId + idPostfixRef.current) ===\n        \"undefined\" ||\n      !transitionInProgressRef.current\n    ) {\n      setTimeout(showNextTransitionSegment, msPerStep);\n      return;\n    }\n    if (\n      typeof transitionGeojsonDataRef.current[currentTransitionStepRef.current] !==\n      \"undefined\"\n    ) {\n      let newData =\n        currentTransitionStepRef.current + 1 ===\n        transitionGeojsonDataRef.current.length\n          ? props.geojson\n          : turf.lineString([\n              ...transitionGeojsonCommonDataRef.current,\n              ...transitionGeojsonDataRef.current[currentTransitionStepRef.current]\n                .geometry.coordinates,\n            ]);\n\n      mapRef.current.getSource(layerId + idPostfixRef.current).setData(newData);\n\n      if (typeof props.onTransitionFrame === \"function\") {\n        props.onTransitionFrame(newData);\n      }\n\n      currentTransitionStepRef.current++;\n      if (\n        transitionInProgressRef.current &&\n        currentTransitionStepRef.current < transitionGeojsonDataRef.current.length\n      ) {\n        setTimeout(showNextTransitionSegment, msPerStep);\n      } else {\n        if (typeof props.onTransitionEnd === \"function\") {\n          props.onTransitionEnd(props.geojson);\n        }\n        transitionInProgressRef.current = false;\n      }\n    }\n  }, [props, layerId]);\n\n  const transitionToGeojson = useCallback(\n    (newGeojson) => {\n      // create the transition geojson between oldGeojsonRef.current and props.geojson\n      //console.log(\"start transition\");\n\n      // create a geojson that contains no common point between the two line features\n      let transitionCoordinatesShort = [];\n      let transitionCoordinatesLong = [];\n      let targetCoordinates = [];\n      let srcCoordinates = [];\n      transitionGeojsonCommonDataRef.current = [];\n      let sourceGeojson = oldGeojsonRef.current || {\n        geometry: {\n          type: \"LineString\",\n          coordinates: [],\n        },\n        properties: {},\n        type: \"Feature\",\n      };\n\n      let targetGeojson = newGeojson;\n\n      let longerGeojson = targetGeojson;\n      let shorterGeojson = sourceGeojson;\n      let reverseOrder = false;\n      // In case one geojson is missing completely use the first two coordinates of the other geojson\n      if (\n        typeof longerGeojson.geometry === \"undefined\" &&\n        typeof shorterGeojson.geometry !== \"undefined\" &&\n        shorterGeojson.geometry.coordinates.length > 1\n      ) {\n        longerGeojson = turf.lineString(\n          shorterGeojson.geometry.coordinates.slice(0, 2)\n        );\n      } else if (\n        typeof shorterGeojson.geometry === \"undefined\" &&\n        typeof longerGeojson.geometry !== \"undefined\" &&\n        longerGeojson.geometry.coordinates.length > 1\n      ) {\n        shorterGeojson = turf.lineString(\n          longerGeojson.geometry.coordinates.slice(0, 2)\n        );\n      } else if (\n        typeof shorterGeojson.geometry === \"undefined\" &&\n        typeof longerGeojson.geometry === \"undefined\"\n      ) {\n        return;\n      }\n\n      if (\n        longerGeojson.geometry.coordinates.length <\n        shorterGeojson.geometry.coordinates.length\n      ) {\n        longerGeojson = sourceGeojson;\n        shorterGeojson = targetGeojson;\n        reverseOrder = true;\n      }\n\n      //console.log(shorterGeojson);\n      //console.log(longerGeojson);\n      if (longerGeojson && shorterGeojson) {\n        for (\n          var i = 0, len = longerGeojson.geometry.coordinates.length;\n          i < len;\n          i++\n        ) {\n          if (\n            typeof shorterGeojson.geometry.coordinates[i] !== \"undefined\" &&\n            longerGeojson.geometry.coordinates[i][0] ===\n              shorterGeojson.geometry.coordinates[i][0] &&\n            longerGeojson.geometry.coordinates[i][1] ===\n              shorterGeojson.geometry.coordinates[i][1]\n          ) {\n            // if coordinates are equal\n            transitionGeojsonCommonDataRef.current.push(\n              longerGeojson.geometry.coordinates[i]\n            );\n          } else {\n            if (typeof longerGeojson.geometry.coordinates[i] !== \"undefined\") {\n              transitionCoordinatesLong.push(longerGeojson.geometry.coordinates[i]);\n            }\n            if (typeof shorterGeojson.geometry.coordinates[i] !== \"undefined\") {\n              transitionCoordinatesShort.push(\n                shorterGeojson.geometry.coordinates[i]\n              );\n            }\n          }\n        }\n      }\n\n      if (reverseOrder) {\n        targetCoordinates = transitionCoordinatesShort;\n        srcCoordinates = transitionCoordinatesLong;\n      } else {\n        targetCoordinates = transitionCoordinatesLong;\n        srcCoordinates = transitionCoordinatesShort;\n      }\n\n      if (targetCoordinates.length < 2 && srcCoordinates < 2) return;\n      // create props.transitionTime / msPerStep (=: transitionSteps) Versions of transitionGeojsonCommonDataRef.current + transitionCoordinates making the transitionCoordinates transitionCoordinatesDistance / transitionSteps longer on each step\n\n      let transitionSteps = props.transitionTime / msPerStep;\n      let srcCoordinatesDistance =\n        srcCoordinates.length > 1\n          ? Math.round(turf.length(turf.lineString(srcCoordinates)))\n          : 0;\n      let targetCoordinatesDistance =\n        targetCoordinates.length > 1\n          ? Math.round(turf.length(turf.lineString(targetCoordinates)))\n          : 0;\n      let transitionDistance = targetCoordinatesDistance + srcCoordinatesDistance;\n\n      let srcCoordinatesShare = srcCoordinatesDistance / transitionDistance;\n      let srcTransitionSteps = Math.round(transitionSteps * srcCoordinatesShare);\n      let srcPerStepDistance =\n        Math.round((srcCoordinatesDistance / srcTransitionSteps) * 100) / 100;\n\n      let targetCoordinatesShare = targetCoordinatesDistance / transitionDistance;\n      let targetTransitionSteps = Math.round(\n        transitionSteps * targetCoordinatesShare\n      );\n      let targetPerStepDistance =\n        Math.round((targetCoordinatesDistance / targetTransitionSteps) * 100) / 100;\n\n      transitionGeojsonDataRef.current = [];\n\n      // use srcPerStepDistance as src coordinates are always animated backwards\n      let loopStepDistance = srcCoordinatesDistance;\n      if (loopStepDistance <= 0) {\n        loopStepDistance = 0.1;\n      }\n      let tmpLinestring = {};\n      let tmpChunks = {};\n\n      if (srcCoordinates.length > 1) {\n        tmpChunks = turf.lineChunk(\n          turf.lineString(srcCoordinates),\n          srcPerStepDistance\n          //{reverse:true}\n        );\n        // for some reason turf.lineChunk returns the full lineString as element 0, chunks start at 1\n        tmpLinestring = tmpChunks.features[1];\n        for (i = 1; i < srcTransitionSteps; i++) {\n          transitionGeojsonDataRef.current.push(tmpLinestring);\n          if (typeof tmpChunks.features[i + 1] !== \"undefined\") {\n            tmpLinestring = turf.lineString([\n              ...tmpLinestring.geometry.coordinates,\n              ...tmpChunks.features[i + 1].geometry.coordinates,\n            ]);\n          } else {\n            transitionGeojsonDataRef.current.push(tmpLinestring);\n            break;\n          }\n        }\n        transitionGeojsonDataRef.current.reverse();\n      }\n\n      if (targetCoordinates.length > 1) {\n        loopStepDistance = 0;\n        tmpChunks = turf.lineChunk(\n          turf.lineString(targetCoordinates),\n          targetPerStepDistance\n        );\n        // for some reason turf.lineChunk returns the full lineString as element 0, chunks start at 1\n        tmpLinestring = tmpChunks.features[1];\n        for (i = 1; i < targetTransitionSteps; i++) {\n          transitionGeojsonDataRef.current.push(tmpLinestring);\n          if (typeof tmpChunks.features[i + 1] !== \"undefined\") {\n            tmpLinestring = turf.lineString([\n              ...tmpLinestring.geometry.coordinates,\n              ...tmpChunks.features[i + 1].geometry.coordinates,\n            ]);\n          } else {\n            transitionGeojsonDataRef.current.push(tmpLinestring);\n            break;\n          }\n        }\n      }\n      transitionGeojsonDataRef.current.push(props.geojson);\n\n      currentTransitionStepRef.current = 1;\n      transitionInProgressRef.current = true;\n      setTimeout(showNextTransitionSegment, msPerStep);\n    },\n    [props.geojson, showNextTransitionSegment, props.transitionTime]\n  );\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId).getSource(layerId + idPostfixRef.current)\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    if (\n      typeof props.transitionTime !== \"undefined\" &&\n      props.type === \"line\" &&\n      oldGeojsonRef.current\n    ) {\n      transitionInProgressRef.current = false;\n      currentTransitionStepRef.current = false;\n      transitionGeojsonDataRef.current = [];\n      transitionGeojsonCommonDataRef.current = [];\n      transitionToGeojson(props.geojson);\n    } else {\n      mapContext\n        .getMap(props.mapId)\n        .getSource(layerId + idPostfixRef.current)\n        .setData(props.geojson);\n    }\n    oldGeojsonRef.current = props.geojson;\n  }, [\n    props.geojson,\n    layerId,\n    props.mapId,\n    mapContext,\n    props.type,\n    transitionToGeojson,\n    props.transitionTime,\n  ]);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId)) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    if (\n      !mapContext.getMap(props.mapId).getSource(layerId + idPostfixRef.current) &&\n      props.geojson\n    ) {\n      let geojson = props.geojson;\n\n      if (\n        props.type === \"line\" &&\n        typeof props.transitionTime !== \"undefined\" &&\n        props.transitionTime &&\n        typeof props.geojson.geometry !== \"undefined\"\n      ) {\n        var tmpChunks = turf.lineChunk(props.geojson, 0.01);\n        geojson = tmpChunks.features[0];\n      }\n\n      mapRef.current = mapContext.getMap(props.mapId);\n\n      mapContext.getMap(props.mapId).addLayer(\n        {\n          id: layerId + idPostfixRef.current,\n          source: {\n            type: \"geojson\",\n            data: geojson,\n          },\n          type: props.type || \"line\",\n          paint: props.paint || {\n            \"line-color\": \"rgb(100,200,100)\",\n            \"line-width\": 10,\n          },\n        },\n        props.insertBeforeLayer\n      );\n      if (\n        props.type === \"line\" &&\n        typeof props.transitionTime !== \"undefined\" &&\n        typeof props.geojson.geometry !== \"undefined\"\n      ) {\n        transitionToGeojson(props.geojson);\n        setTimeout(() => {\n          oldGeojsonRef.current = props.geojson;\n        }, props.transitionTime / 2);\n      }\n    }\n  }, [\n    mapContext.mapIds,\n    mapContext,\n    layerId,\n    props.geojson,\n    props.insertBeforeLayer,\n    props.mapId,\n    props.type,\n    props.transitionTime,\n    props.paint,\n    transitionToGeojson,\n  ]);\n\n  return <></>;\n};\n\nexport default MlGeoJsonLayer;\n","import React from \"react\";\n\nconst GeoJsonContext = React.createContext({});\n\nexport const GeoJsonContextProvider = GeoJsonContext.Provider;\nexport default GeoJsonContext;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\nimport { bbox } from \"@turf/turf\";\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport InfoIcon from \"@material-ui/icons/Info\";\nimport FileCopy from \"@material-ui/icons/FileCopy\";\nimport { Popup } from \"maplibre-gl\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport GeoJsonContext from './util/GeoJsonContext'\nconst toGeoJSON = require(\"./gpxConverter\");\n/**\n * MlGPXViewer returns a dropzone and a button to load a GPX Track into the map.\n */\nconst MlGPXViewer = (props) => {\n  console.log(GeoJsonContext)\n  const dataSource = useContext(GeoJsonContext);\n  console.log(dataSource);\n  const mapContext = useContext(MapContext);\n  const mapId = props.mapId;\n  const sourceName = \"import-source\";\n  const layerNameLines = \"importer-layer-lines\";\n  const layerNamePoints = \"importer-layer-points\";\n\n  const [showLayer, setShowLayer] = useState(true);\n  const [open, setIsOpen] = useState(false);\n  const dropZone = useRef(null);\n  const [zIndex, setZIndex] = useState(0);\n  const [metaData, setMetaData] = useState([]);\n  const fileupload = useRef(null);\n\n  const popup = new Popup({\n    closeButton: false,\n    closeOnClick: true,\n  });\n\n  const componentCleanup = () => {\n    let map = null;\n    if (mapId) {\n      map = mapContext.maps[mapId];\n    } else {\n      map = mapContext.map;\n    }\n    [layerNameLines, layerNamePoints].forEach((layerName) => {\n      if (map.getLayer(layerName)) {\n        map.removeLayer(layerName);\n      }\n    });\n\n    if (map.getSource(sourceName)) {\n      map.removeSource(sourceName);\n    }\n    map.getCanvas().style.cursor = \"\";\n    popup.remove();\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    return () => {\n      componentCleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n    let map = null;\n    if (mapId) {\n      map = mapContext.maps[mapId];\n    } else {\n      map = mapContext.map;\n    }\n\n    // cleanup fragments left in MapLibre-gl from previous component uses\n    componentCleanup();\n    \n    map.addSource(sourceName, {\n      type: \"geojson\",\n      data: dataSource.data,\n    });\n    map.addLayer({\n      id: layerNameLines,\n      source: sourceName,\n      type: \"line\",\n      paint: {\n        \"line-width\": 4,\n        \"line-color\": \"rgba(212, 55, 23,0.5)\",\n      },\n    });\n    map.addLayer({\n      id: layerNamePoints,\n      source: sourceName,\n      type: \"circle\",\n      paint: {\n        \"circle-color\": \"rgba(72, 77, 99,0.5)\",\n        \"circle-radius\": 7,\n      },\n      filter: [\"==\", \"$type\", \"Point\"],\n    });\n\n    [layerNameLines, layerNamePoints].forEach((layerName) => {\n      map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n    });\n    map.on(\"mouseenter\", layerNamePoints, (e) => {\n      // Change the cursor style as a UI indicator.\n      map.getCanvas().style.cursor = \"pointer\";\n\n      const coordinates = e.features[0].geometry.coordinates.slice();\n      const description = e.features[0].properties.desc;\n      const name = e.features[0].properties.name;\n\n      // Ensure that if the map is zoomed out such that multiple\n      // copies of the feature are visible, the popup appears\n      // over the copy being pointed to.\n      while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n      }\n\n      // Populate the popup and set its coordinates\n\n      // based on the feature found.\n      popup.setLngLat(coordinates).setHTML(name).addTo(map);\n    });\n\n    map.on(\"mouseleave\", \"places\", function () {\n      map.getCanvas().style.cursor = \"\";\n      popup.remove();\n    });\n\n    map.setZoom(10);\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    const dropZoneCurrent = dropZone.current;\n    const raiseDropZoneAndStopDefault = (event) => {\n      setZIndex(1000);\n      stopDefault(event);\n    };\n    const lowerDropZone = () => {\n      setZIndex(0);\n    };\n    const lowerDropZoneAndStopDefault = (event) => {\n      setZIndex(0);\n      stopDefault(event);\n    };\n\n    window.addEventListener(\"dragenter\", raiseDropZoneAndStopDefault);\n    window.addEventListener(\"dragover\", stopDefault);\n\n    dropZoneCurrent.addEventListener(\"dragleave\", lowerDropZone);\n\n    window.addEventListener(\"drop\", lowerDropZoneAndStopDefault);\n\n    return () => {\n      window.removeEventListener(\"dragenter\", raiseDropZoneAndStopDefault);\n      window.removeEventListener(\"dragover\", stopDefault);\n      window.removeEventListener(\"drop\", stopDefault);\n      dropZoneCurrent.removeEventListener(\"dragleave\", lowerDropZone);\n      window.removeEventListener(\"drop\", (event) => lowerDropZoneAndStopDefault);\n    };\n  });\n\n  const stopDefault = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n    let map = null;\n    if (mapId) {\n      map = mapContext.maps[mapId];\n    } else {\n      map = mapContext.map;\n    }\n    const visibility = showLayer ? \"visible\" : \"none\";\n\n    [layerNameLines, layerNamePoints].forEach((layerName) => {\n      map.setLayoutProperty(layerName, \"visibility\", visibility);\n    });\n  }, [showLayer, mapContext]);\n\n  const dropHandler = (event) => {\n    event.preventDefault();\n\n    if (event.dataTransfer.items) {\n      if (event.dataTransfer.items.length > 1) {\n        return false;\n      }\n      // If dropped items aren't files, reject them\n      if (event.dataTransfer.items[0].kind === \"file\") {\n        const reader = new FileReader();\n        reader.onload = (payload) => {\n          addGPXToMap(payload.currentTarget.result);\n        };\n        const file = event.dataTransfer.items[0].getAsFile();\n        reader.readAsText(file);\n      }\n    } else {\n      // Use DataTransfer interface to access the file(s)\n    }\n  };\n\n  const addGPXToMap = (gpxAsString) => {\n    let map = null;\n    if (mapId) {\n      map = mapContext.maps[mapId];\n    } else {\n      map = mapContext.map;\n    }\n    try {\n      setMetaData([]);\n      const domParser = new DOMParser();\n      const gpxDoc = domParser.parseFromString(gpxAsString, \"application/xml\");\n      const metadata = gpxDoc.querySelector(\"metadata\");\n      metadata.childNodes.forEach((node) => {\n        let value = node.textContent;\n        const title = node.nodeName;\n\n        if (node.nodeName === \"link\") {\n          value = node.getAttribute(\"href\");\n        }\n        if (!!value.trim().length) {\n          const metaDatEntry = {\n            title: title,\n            value: value,\n            id: new Date().getTime(),\n          };\n          setMetaData((prevState) => [...prevState, metaDatEntry]);\n        }\n      });\n      const data = toGeoJSON.gpx(gpxDoc);\n      dataSource.setData(data)\n      map.getSource(sourceName).setData(data);\n      const bounds = bbox(data);\n      map.fitBounds(bounds);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n  const toogleDrawer = () => {\n    setIsOpen((prevState) => !prevState);\n  };\n\n  const fileUploadOnChange = () => {\n    const file = fileupload.current.files[0];\n    if (!file) return false;\n    const reader = new FileReader();\n    reader.onload = (payload) => {\n      addGPXToMap(payload.currentTarget.result);\n    };\n\n    reader.readAsText(file);\n  };\n\n  const manualUpload = () => {\n    fileupload.current.click();\n  };\n  return (\n    <>\n      <IconButton\n        onClick={manualUpload}\n        style={{\n          position: \"absolute\",\n          right: \"5px\",\n          bottom: \"75px\",\n          backgroundColor: \"rgba(255,255,255,1)\",\n\n          zIndex: 1000,\n        }}\n      >\n        <input\n          ref={fileupload}\n          onChange={fileUploadOnChange}\n          type=\"file\"\n          id=\"input\"\n          multiple\n          style={{ display: \"none\" }}\n        ></input>\n        <FileCopy />\n      </IconButton>\n      <IconButton\n        onClick={toogleDrawer}\n        style={{\n          position: \"absolute\",\n          right: \"5px\",\n          bottom: \"25px\",\n          backgroundColor: \"rgba(255,255,255,1)\",\n\n          zIndex: 1000,\n        }}\n      >\n        <InfoIcon />\n      </IconButton>\n      <Drawer variant=\"persistent\" anchor=\"left\" open={open}>\n        <Typography\n          variant=\"h6\"\n          style={{\n            textAlign: \"center\",\n            padding: \"1em\",\n          }}\n          noWrap\n        >\n          Informationen zur Route\n        </Typography>\n        <Divider />\n        <List>\n          {metaData.map((item) => (\n            <ListItem key={`item--${item.id}`}>\n              <ListItemText primary={item.value} />\n            </ListItem>\n          ))}\n        </List>\n      </Drawer>\n      <div\n        onDrop={dropHandler}\n        ref={dropZone}\n        style={{\n          position: \"absolute\",\n          left: \"0\",\n          top: \"0\",\n          backgroundColor: \"rgba(255,255,255,0.5)\",\n          width: \"100%\",\n          height: \"100%\",\n          zIndex: zIndex,\n        }}\n      >\n        <Typography\n          variant=\"h6\"\n          style={{\n            top: \"50%\",\n            position: \"absolute\",\n            left: \"50%\",\n            msTransform: \"translate(-50%, -50%)\",\n            transform: \" translate(-50%, -50%)\",\n          }}\n          noWrap\n        >\n          Gpx-Datei ablegen\n        </Typography>\n      </div>\n    \n    </>\n  );\n};\n\nexport default MlGPXViewer;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\n\n/**\n * MlHillshadeLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlHillshadeLayer = () => {\n  const mapContext = useContext(MapContext);\n\n  const layerRef = useRef(null);\n  const [showLayer, setShowLayer] = useState(true);\n  const idPostfixRef = useRef(new Date().getTime());\n\n  const componentCleanup = () => {\n    if (mapContext.map.getLayer(\"hillshading\")) {\n      mapContext.map.removeLayer(\"hillshading\");\n    }\n    if (mapContext.map.getSource(\"hillshading-source\")) {\n      mapContext.map.removeSource(\"hillshading-source\");\n    }\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    return () => {\n      componentCleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // cleanup fragments left in MapLibre-gl from previous component uses\n    componentCleanup();\n\n    mapContext.map.addSource(\"hillshading-source\", {\n      type: \"raster-dem\",\n      url: \"mapbox://mapbox.terrain-rgb\",\n    });\n    mapContext.map.addLayer({\n      id: \"hillshading\",\n      source: \"hillshading-source\",\n      type: \"hillshade\",\n    });\n    mapContext.map.setLayoutProperty(\"hillshading\", \"visibility\", \"visible\");\n    mapContext.map.setZoom(10);\n    //mapContext.map.setPitch(45);\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.map.setLayoutProperty(\"hillshading\", \"visibility\", \"visible\");\n    } else {\n      mapContext.map.setLayoutProperty(\"hillshading\", \"visibility\", \"none\");\n    }\n    //\n  }, [showLayer, mapContext]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      Hillshade\n    </Button>\n  );\n};\n\nexport default MlHillshadeLayer;\n","import React, { useRef, useCallback, useEffect, useContext } from \"react\";\n\nimport { MapContext } from \"react-map-components-core\";\n\nconst MlImageMarkerLayer = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n  const layerInitializedRef = useRef(false);\n  const idPostfixRef = useRef(props.idSuffix || new Date().getTime());\n  const imageIdRef = useRef(props.imageId || \"img_\" + new Date().getTime());\n  const layerId = (props.layerId || \"MlImageMarkerLayer-\") + idPostfixRef.current;\n\n  useEffect(() => {\n    return () => {\n      if (mapContext.getMap(props.mapId)) {\n        // This is the cleanup function, it is called when this react component is removed from react-dom\n        if (mapContext.getMap(props.mapId).getLayer(layerId)) {\n          mapContext.getMap(props.mapId).removeLayer(layerId);\n        }\n        if (mapContext.getMap(props.mapId).getSource(layerId)) {\n          mapContext.getMap(props.mapId).removeSource(layerId);\n        }\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId).getLayer(layerId) ||\n      !props.options\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    if (props.options.layout) {\n      for (var key in props.options.layout) {\n        mapContext\n          .getMap(props.mapId)\n          .setLayoutProperty(layerId, key, props.options.layout[key]);\n      }\n    }\n    if (props.options.paint) {\n      for (var key in props.options.paint) {\n        mapContext\n          .getMap(props.mapId)\n          .setPaintProperty(layerId, key, props.options.paint[key]);\n      }\n    }\n  }, [props.options, layerId, mapContext, props.mapId]);\n\n  const addLayer = useCallback(() => {\n    let tmpOptions = {\n      id: layerId,\n      ...props.options,\n    };\n    tmpOptions.layout[\"icon-image\"] = imageIdRef.current;\n    mapContext.getMap(props.mapId).addLayer(tmpOptions);\n  }, [mapContext, props.options, props, imageIdRef, layerId]);\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId).getSource(layerId)\n    ) {\n      return;\n    }\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    mapContext.getMap(props.mapId).getSource(layerId).setData(props.geojson);\n  }, [props.geojson, layerId, mapContext, props]);\n\n  useEffect(() => {\n    if (\n      !props.options ||\n      !mapContext.mapExists(props.mapId) ||\n      layerInitializedRef.current\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    if (!mapContext.getMap(props.mapId).getLayer(layerId)) {\n      layerInitializedRef.current = true;\n      if (!mapContext.getMap(props.mapId).hasImage(imageIdRef.current)) {\n        mapContext\n          .getMap(props.mapId)\n          .loadImage(props.imgSrc, function (error, image) {\n            if (error) throw error;\n            mapContext.getMap(props.mapId).addImage(imageIdRef.current, image);\n            addLayer();\n          });\n      } else {\n        addLayer();\n      }\n    }\n  }, [mapContext.mapIds, mapContext, props, layerId, addLayer]);\n\n  return <></>;\n};\n\nexport default MlImageMarkerLayer;\n","import React from \"react\";\n\nconst DeckGlContext = React.createContext({});\n\nexport const DeckGlContextProvider = DeckGlContext.Provider;\nexport default DeckGlContext;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n    zIndex: 120,\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n  },\n  AppBar: {\n    backgroundColor: \"#fafafa\",\n    minHeight: \"62px\",\n  },\n}));\n\nexport default function TopToolbar(props) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <AppBar className={classes.AppBar} position=\"static\">\n        <Toolbar>{props.children}</Toolbar>\n      </AppBar>\n    </div>\n  );\n}\n","import React, { useRef, useMemo, useState, useEffect, useContext } from \"react\";\n\nimport { MapContext, SimpleDataContext } from \"react-map-components-core\";\nimport DeckGlContext from \"../../deckgl_components/DeckGlContext\";\n\nimport { HexagonLayer } from \"@deck.gl/aggregation-layers\";\nimport { ScatterplotLayer } from \"@deck.gl/layers\";\nimport * as d3 from \"d3\";\nimport * as turf from \"@turf/turf\";\n\nimport Typography from \"@material-ui/core/Typography\";\nimport Slider from \"@material-ui/core/Slider\";\nimport Button from \"@material-ui/core/Button\";\n\nimport TopToolbar from \"../../ui_components/TopToolbar\";\n\n//import Tooltip from \"@material-ui/core/Tooltip\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nfunction ValueLabelComponent(props) {\n  const { children, open, value } = props;\n\n  return (\n    <Tooltip open={open} enterTouchDelay={0} placement=\"top\" title={value}>\n      {children}\n    </Tooltip>\n  );\n}\n\nconst getColorRange = (layerOpacity) => [\n  [1, 152, 189, Math.round(80 * layerOpacity)],\n  [73, 227, 206, Math.round(90 * layerOpacity)],\n  [216, 254, 181, Math.round(100 * layerOpacity)],\n  [254, 237, 177, Math.round(110 * layerOpacity)],\n  [254, 173, 84, Math.round(120 * layerOpacity)],\n  [209, 55, 78, Math.round(150 * layerOpacity)],\n];\n\nconst DATA_URL = \"/assets/laerm.json\"; // eslint-disable-line\n\nconst MlLaermkarte = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  // without the requirement of adding it to the dependency list (ignore the false eslint exhaustive deps warning)\n  const initializedRef = useRef(false);\n  const mapContext = useContext(MapContext);\n  const deckGlContext = useContext(DeckGlContext);\n  const simpleDataContext = useContext(SimpleDataContext);\n  const layerName = \"deckgl-layer\";\n  const [layerOpacity, setLayerOpacity] = useState(0.8);\n  const [radius, setRadius] = useState(16);\n  const [elevationScale, setElevationScale] = useState(0.3);\n\n  const deckLayerProps = useMemo(() => {\n    return {\n      id: layerName,\n      onClick: (obj) => {\n        console.log(obj);\n        //mapContext.map.zoomIn();\n        //mapContext.map.panTo(obj.coordinate);\n        //setRadius(radius - 5);\n      },\n      data: simpleDataContext.data ? simpleDataContext.data.features : [],\n      type: HexagonLayer,\n      colorRange: getColorRange(layerOpacity),\n      coverage: 0.9,\n      elevationRange: [30, 75],\n      elevationScale: elevationScale,\n      extruded: true,\n      autoHighlight: true,\n      getPosition: (d) => {\n        return d.geometry.coordinates;\n      },\n      pickable: true,\n      radius: radius,\n      upperPercentile: 100,\n      material: {\n        ambient: 0.8,\n        diffuse: 0.5,\n        shininess: 20,\n        specularColor: [51, 51, 51],\n      },\n      transitions: {\n        elevationScale: 1500,\n      },\n      getColorValue: (points) => {\n        let elVal = points.reduce((acc, point) => {\n          if (!point.properties && point.source.properties)\n            return acc < point.source.properties.dba\n              ? point.source.properties.dba\n              : acc;\n          return acc < point.properties.dba ? point.properties.dba : acc;\n        }, -Infinity);\n        return Math.round(elVal);\n      },\n      getElevationValue: (points) => {\n        let elVal = points.reduce((acc, point) => {\n          if (!point.properties && point.source.properties)\n            return acc < point.source.properties.dba\n              ? point.source.properties.dba\n              : acc;\n          return acc < point.properties.dba ? point.properties.dba : acc;\n        }, -Infinity);\n        return Math.round(elVal);\n      },\n    };\n  }, [radius, layerOpacity, simpleDataContext.data, elevationScale]);\n\n  useEffect(() => {\n    if (!deckGlContext.deckGl) return;\n\n    console.log(\"update props\");\n    deckGlContext.deckGl.setProps({\n      layers: [\n        new HexagonLayer({\n          ...deckLayerProps,\n        }),\n      ],\n    });\n  }, [radius, layerOpacity, elevationScale]);\n\n  useEffect(() => {\n    if (typeof props.init === \"function\") {\n      props.init();\n    }\n\n    if (!mapContext.mapExists(props.mapId)) return;\n    return () => {\n      if (deckGlContext.deckGl) {\n        deckGlContext.deckGl.setProps({\n          layers: [],\n        });\n        initializedRef.current = false;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !simpleDataContext.data ||\n      !mapContext.mapExists() ||\n      !deckGlContext.deckGl ||\n      (deckGlContext.deckGl &&\n        mapContext.mapExists() &&\n        simpleDataContext.data &&\n        initializedRef.current)\n    )\n      return;\n\n    initializedRef.current = true;\n\n    // for debugging\n    window.DeckGlMapLibreLayer = deckGlContext.maplibreLayer;\n\n    deckGlContext.deckGl.setProps({\n      layers: [\n        new HexagonLayer({\n          ...deckLayerProps,\n          data: simpleDataContext.data.features,\n          radius: radius,\n        }),\n      ],\n    });\n\n    if (typeof props.onDone === \"function\") {\n      console.log(\"hide overlay\");\n      props.onDone();\n    }\n  }, [\n    mapContext.mapIds,\n    mapContext,\n    deckGlContext.deckGl,\n    deckGlContext.maplibreLayer,\n    deckLayerProps,\n    radius,\n    setRadius,\n    simpleDataContext.data,\n  ]);\n\n  return (\n    <>\n      <TopToolbar\n        style={{\n          alignItems: \"flex-end\",\n        }}\n      >\n        <Typography\n          id=\"discrete-slider\"\n          style={{ color: \"#121212\", marginRight: \"5px\" }}\n        >\n          Radius\n        </Typography>\n        <Slider\n          value={radius}\n          onChange={(ev, value) => {\n            setRadius(value);\n          }}\n          getAriaValueText={(value) => value}\n          aria-labelledby=\"discrete-slider\"\n          valueLabelDisplay=\"auto\"\n          ValueLabelComponent={ValueLabelComponent}\n          step={5}\n          marks\n          min={10}\n          max={70}\n          style={{ marginRight: \"10px\", maxWidth: \"200px\" }}\n        />\n        <Typography\n          id=\"discrete-slider\"\n          style={{ color: \"#121212\", marginRight: \"5px\" }}\n        >\n          Deckkraft\n        </Typography>\n        <Slider\n          value={layerOpacity}\n          onChange={(ev, value) => {\n            setLayerOpacity(value);\n          }}\n          getAriaValueText={(value) => value}\n          aria-labelledby=\"discrete-slider\"\n          valueLabelDisplay=\"auto\"\n          ValueLabelComponent={ValueLabelComponent}\n          step={0.02}\n          marks\n          min={0.01}\n          max={1.0}\n          style={{ marginRight: \"10px\", maxWidth: \"200px\" }}\n        />\n        <Typography\n          id=\"discrete-slider\"\n          style={{ color: \"#121212\", marginRight: \"5px\" }}\n        >\n          Höhe\n        </Typography>\n        <Slider\n          value={elevationScale}\n          onChange={(ev, value) => {\n            setElevationScale(value);\n          }}\n          getAriaValueText={(value) => value}\n          aria-labelledby=\"discrete-slider\"\n          valueLabelDisplay=\"auto\"\n          ValueLabelComponent={ValueLabelComponent}\n          step={0.1}\n          marks\n          min={0}\n          max={4.0}\n          style={{ marginRight: \"10px\", maxWidth: \"200px\" }}\n        />\n      </TopToolbar>\n    </>\n  );\n};\n\nexport default MlLaermkarte;\n","import React, { useRef, useEffect, useContext } from \"react\";\n\nimport { MapContext } from \"react-map-components-core\";\n\nconst MlLayer = (props) => {\n  // Use a useRef hook to reference the layer object to be able to access it later inside useEffect hooks\n  const mapContext = useContext(MapContext);\n  const layerInitializedRef = useRef(false);\n  const idPostfixRef = useRef(props.idSuffix || new Date().getTime());\n  const layerId = (props.layerId || \"MlLayer-\") + idPostfixRef.current;\n\n  useEffect(() => {\n    return () => {\n      if (mapContext.getMap(props.mapId)) {\n        // This is the cleanup function, it is called when this react component is removed from react-dom\n        if (mapContext.getMap(props.mapId).getLayer(layerId)) {\n          mapContext.getMap(props.mapId).removeLayer(layerId);\n        }\n        if (mapContext.getMap(props.mapId).getSource(layerId)) {\n          mapContext.getMap(props.mapId).removeSource(layerId);\n        }\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !mapContext.mapExists(props.mapId) ||\n      !mapContext.getMap(props.mapId).getLayer(layerId) ||\n      !props.options\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    if (props.options.layout) {\n      for (var key in props.options.layout) {\n        mapContext\n          .getMap(props.mapId)\n          .setLayoutProperty(layerId, key, props.options.layout[key]);\n      }\n    }\n    if (props.options.paint) {\n      for (var key in props.options.paint) {\n        mapContext\n          .getMap(props.mapId)\n          .setPaintProperty(layerId, key, props.options.paint[key]);\n      }\n    }\n  }, [props.options]);\n\n  useEffect(() => {\n    if (\n      !props.options ||\n      !mapContext.mapExists(props.mapId) ||\n      layerInitializedRef.current\n    )\n      return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    console.log(props.options);\n    if (!mapContext.getMap(props.mapId).getLayer(layerId)) {\n      layerInitializedRef.current = true;\n      console.log(layerId);\n      mapContext.getMap(props.mapId).addLayer({ id: layerId, ...props.options });\n    }\n  }, [mapContext.mapIds, mapContext, props, layerId]);\n\n  return <></>;\n};\n\nexport default MlLayer;\n","import * as CommonSelectors from \"@mapbox/mapbox-gl-draw/src/lib/common_selectors\";\nimport doubleClickZoom from \"@mapbox/mapbox-gl-draw/src/lib/double_click_zoom\";\nimport * as Constants from \"@mapbox/mapbox-gl-draw/src/constants\";\nimport isEventAtCoordinates from \"@mapbox/mapbox-gl-draw/src/lib/is_event_at_coordinates\";\nimport createVertex from \"@mapbox/mapbox-gl-draw/src/lib/create_vertex\";\n\nconst CustomPolygonMode = {};\n\nCustomPolygonMode.onSetup = function () {\n  console.log(\"Change mode: custom polygon\");\n\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]],\n    },\n  });\n\n  this.addFeature(polygon);\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true,\n  });\n\n  return {\n    polygon,\n    currentVertexPosition: 0,\n  };\n};\n\nCustomPolygonMode.clickAnywhere = function (state, e) {\n  if (\n    state.currentVertexPosition > 0 &&\n    isEventAtCoordinates(\n      e,\n      state.polygon.coordinates[0][state.currentVertexPosition - 1]\n    )\n  ) {\n    return this.changeMode(\"custom_select\", {\n      featureIds: [state.polygon.id],\n    });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n  state.currentVertexPosition++;\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n\n  this.map.fire(Constants.events.CREATE, {\n    features: [state.polygon.toGeoJSON()],\n  });\n};\n\nCustomPolygonMode.clickOnVertex = function (state) {\n  return this.changeMode(\"custom_select\", {\n    featureIds: [state.polygon.id],\n  });\n};\n\nCustomPolygonMode.onMouseMove = function (state, e) {\n  state.polygon.updateCoordinate(\n    `0.${state.currentVertexPosition}`,\n    e.lngLat.lng,\n    e.lngLat.lat\n  );\n\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nCustomPolygonMode.onTap = CustomPolygonMode.onClick = function (state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  return this.clickAnywhere(state, e);\n};\n\nCustomPolygonMode.onKeyUp = function (state, e) {\n  if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(\"custom_select\");\n  } else if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(\"custom_select\", {\n      featureIds: [state.polygon.id],\n    });\n  }\n};\n\nCustomPolygonMode.onStop = function (state) {\n  this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.polygon.id) === undefined) return;\n\n  //remove last added coordinate\n  state.polygon.removeCoordinate(`0.${state.currentVertexPosition}`);\n  if (state.polygon.isValid()) {\n    this.map.fire(Constants.events.CREATE, {\n      features: [state.polygon.toGeoJSON()],\n    });\n  } else {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(\"custom_select\", {}, { silent: true });\n  }\n};\n\nCustomPolygonMode.toDisplayFeatures = function (state, geojson, display) {\n  const isActivePolygon = geojson.properties.id === state.polygon.id;\n  geojson.properties.active = isActivePolygon\n    ? Constants.activeStates.ACTIVE\n    : Constants.activeStates.INACTIVE;\n  if (!isActivePolygon) return display(geojson);\n\n  // Don't render a polygon until it has two positions\n  // (and a 3rd which is just the first repeated)\n  if (geojson.geometry.coordinates.length === 0) return;\n\n  const coordinateCount = geojson.geometry.coordinates[0].length;\n  // 2 coordinates after selecting a draw type\n  // 3 after creating the first point\n  if (coordinateCount < 3) {\n    return;\n  }\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(\n    createVertex(\n      state.polygon.id,\n      geojson.geometry.coordinates[0][0],\n      \"0.0\",\n      false\n    )\n  );\n  if (coordinateCount > 3) {\n    // Add a start position marker to the map, clicking on this will finish the feature\n    // This should only be shown when we're in a valid spot\n    const endPos = geojson.geometry.coordinates[0].length - 3;\n    display(\n      createVertex(\n        state.polygon.id,\n        geojson.geometry.coordinates[0][endPos],\n        `0.${endPos}`,\n        false\n      )\n    );\n  }\n  if (coordinateCount <= 4) {\n    // If we've only drawn two positions (plus the closer),\n    // make a LineString instead of a Polygon\n    const lineCoordinates = [\n      [\n        geojson.geometry.coordinates[0][0][0],\n        geojson.geometry.coordinates[0][0][1],\n      ],\n      [\n        geojson.geometry.coordinates[0][1][0],\n        geojson.geometry.coordinates[0][1][1],\n      ],\n    ];\n    // create an initial vertex so that we can track the first point on mobile devices\n    display({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: geojson.properties,\n      geometry: {\n        coordinates: lineCoordinates,\n        type: Constants.geojsonTypes.LINE_STRING,\n      },\n    });\n    if (coordinateCount === 3) {\n      return;\n    }\n  }\n  // render the Polygon\n  return display(geojson);\n};\n\nCustomPolygonMode.onTrash = function (state) {\n  this.deleteFeature([state.polygon.id], { silent: true });\n  this.changeMode(\"custom_select\");\n};\n\nexport default CustomPolygonMode;\n","import constrainFeatureMovement from \"@mapbox/mapbox-gl-draw/src/lib/constrain_feature_movement\";\nimport * as Constants from \"@mapbox/mapbox-gl-draw/src/constants\";\n\nconst move_features = function (features, delta, allFeatures) {\n  const constrainedDelta = constrainFeatureMovement(\n    features.map((feature) => feature.toGeoJSON()),\n    delta\n  );\n\n  features.forEach((feature) => {\n    const currentCoordinates = feature.getCoordinates();\n\n    const moveCoordinate = (coord) => {\n      const point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat,\n      };\n      return [point.lng, point.lat];\n    };\n    const moveRing = (ring) => ring.map((coord) => moveCoordinate(coord));\n    const moveMultiPolygon = (multi) => multi.map((ring) => moveRing(ring));\n\n    let nextCoordinates;\n    if (feature.type === Constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (\n      feature.type === Constants.geojsonTypes.LINE_STRING ||\n      feature.type === Constants.geojsonTypes.MULTI_POINT\n    ) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (\n      feature.type === Constants.geojsonTypes.POLYGON ||\n      feature.type === Constants.geojsonTypes.MULTI_LINE_STRING\n    ) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === Constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n};\nexport default move_features;\n","const drawUtils = {\n  getMatchingVertices: (vertex, featureId, allFeatures, map) => {\n    // number of decimals should probably be dynamic depending on zoom level\n    let decimals = 5;\n    let matchingVertices = [];\n\n    let v_lng = vertex[0].toFixed(decimals);\n    let v_lat = vertex[1].toFixed(decimals);\n\n    for (var i = 0; i < allFeatures.length; i++) {\n      if (allFeatures[i].id !== featureId) {\n        for (var k = 0; k < allFeatures[i].geometry.coordinates.length; k++) {\n          for (\n            var m = 0;\n            m < allFeatures[i].geometry.coordinates[k].length;\n            m++\n          ) {\n            if (\n              v_lng ===\n                allFeatures[i].geometry.coordinates[k][m][0].toFixed(\n                  decimals\n                ) &&\n              v_lat ===\n                allFeatures[i].geometry.coordinates[k][m][1].toFixed(decimals)\n            ) {\n              matchingVertices.push({\n                featureId: allFeatures[i].id,\n                coord_path: k + \".\" + m,\n                //feature: map.getFeature(allFeatures[i].id),\n                lng: allFeatures[i].geometry.coordinates[k][m][0],\n                lat: allFeatures[i].geometry.coordinates[k][m][1],\n              });\n            }\n          }\n        }\n      }\n    }\n\n    return matchingVertices;\n  },\n  getDrawInstance: (map) => {\n    for (var i = map._controls.length - 1; i >= 0; i--) {\n      if (\n        map._controls[i].constructor.name === \"MapboxDraw\" ||\n        map._controls[i].constructor.name === \"ye\"\n      ) {\n        return map._controls[i];\n      }\n    }\n    return null;\n  },\n};\n\nexport default drawUtils;\n","import * as CommonSelectors from \"@mapbox/mapbox-gl-draw/src/lib/common_selectors\";\nimport doubleClickZoom from \"@mapbox/mapbox-gl-draw/src/lib/double_click_zoom\";\nimport * as Constants from \"@mapbox/mapbox-gl-draw/src/constants\";\nimport mouseEventPoint from \"@mapbox/mapbox-gl-draw/src/lib/mouse_event_point\";\nimport createSupplementaryPoints from \"@mapbox/mapbox-gl-draw/src/lib/create_supplementary_points\";\nimport StringSet from \"@mapbox/mapbox-gl-draw/src/lib/string_set\";\nimport moveFeatures from \"./lib/move_features\";\nimport drawUtils from \"./lib/utils\";\n\nconst CustomSelectMode = {};\nCustomSelectMode.onSetup = function (opts) {\n  console.log(\"Change mode: custom select\");\n\n  // turn the opts into state.\n  const state = {\n    dragMoveLocation: null,\n    boxSelectStartLocation: null,\n    boxSelectElement: undefined,\n    boxSelecting: false,\n    canBoxSelect: false,\n    dragMoving: false,\n    canDragMove: false,\n    initiallySelectedFeatureIds: opts.featureIds || [],\n  };\n\n  this.setSelected(\n    state.initiallySelectedFeatureIds.filter(\n      (id) => this.getFeature(id) !== undefined\n    )\n  );\n  this.fireActionable();\n\n  this.setActionableState({\n    combineFeatures: true,\n    uncombineFeatures: true,\n    trash: true,\n  });\n\n  return state;\n};\n\nCustomSelectMode.fireUpdate = function () {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.MOVE,\n    features: this.getSelected().map((f) => f.toGeoJSON()),\n  });\n};\n\nCustomSelectMode.fireActionable = function () {\n  const selectedFeatures = this.getSelected();\n\n  const multiFeatures = selectedFeatures.filter((feature) =>\n    this.isInstanceOf(\"MultiFeature\", feature)\n  );\n\n  let combineFeatures = false;\n\n  if (selectedFeatures.length > 1) {\n    combineFeatures = true;\n    const featureType = selectedFeatures[0].type.replace(\"Multi\", \"\");\n    selectedFeatures.forEach((feature) => {\n      if (feature.type.replace(\"Multi\", \"\") !== featureType) {\n        combineFeatures = false;\n      }\n    });\n  }\n\n  const uncombineFeatures = multiFeatures.length > 0;\n  const trash = selectedFeatures.length > 0;\n\n  this.setActionableState({\n    combineFeatures,\n    uncombineFeatures,\n    trash,\n  });\n};\n\nCustomSelectMode.getUniqueIds = function (allFeatures) {\n  if (!allFeatures.length) return [];\n  const ids = allFeatures\n    .map((s) => s.properties.id)\n    .filter((id) => id !== undefined)\n    .reduce((memo, id) => {\n      memo.add(id);\n      return memo;\n    }, new StringSet());\n\n  return ids.values();\n};\n\nCustomSelectMode.stopExtendedInteractions = function (state) {\n  if (state.boxSelectElement) {\n    if (state.boxSelectElement.parentNode)\n      state.boxSelectElement.parentNode.removeChild(state.boxSelectElement);\n    state.boxSelectElement = null;\n  }\n\n  this.map.dragPan.enable();\n\n  state.boxSelecting = false;\n  state.canBoxSelect = false;\n  state.dragMoving = false;\n  state.canDragMove = false;\n};\n\nCustomSelectMode.onStop = function () {\n  doubleClickZoom.enable(this);\n};\n\nCustomSelectMode.onMouseMove = function (state) {\n  // On mousemove that is not a drag, stop extended interactions.\n  // This is useful if you drag off the canvas, release the button,\n  // then move the mouse back over the canvas --- we don't allow the\n  // interaction to continue then, but we do let it continue if you held\n  // the mouse button that whole time\n  return this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) return this.fireUpdate();\n};\n\nCustomSelectMode.onTap = CustomSelectMode.onClick = function (state, e) {\n  // Click (with or without shift) on no feature\n  if (CommonSelectors.noTarget(e)) return this.clickAnywhere(state, e); // also tap\n  if (CommonSelectors.isOfMetaType(Constants.meta.VERTEX)(e))\n    return this.clickOnVertex(state, e); //tap\n  if (CommonSelectors.isFeature(e)) return this.clickOnFeature(state, e);\n};\n\nCustomSelectMode.clickAnywhere = function (state) {\n  // Clear the re-render selection\n  const wasSelected = this.getSelectedIds();\n  if (wasSelected.length) {\n    this.clearSelectedFeatures();\n    wasSelected.forEach((id) => this.doRender(id));\n  }\n  doubleClickZoom.enable(this);\n  this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.clickOnVertex = function (state, e) {\n  // Enter direct select mode\n  this.changeMode(\"custom_direct_select\", {\n    featureId: e.featureTarget.properties.parent,\n    coordPath: e.featureTarget.properties.coord_path,\n    startPos: e.lngLat,\n    //    groupMove_vertices: matchingVertices,\n  });\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n};\n\nCustomSelectMode.startOnActiveFeature = function (state, e) {\n  // Stop any already-underway extended interactions\n  this.stopExtendedInteractions(state);\n\n  // Disable map.dragPan immediately so it can't start\n  this.map.dragPan.disable();\n\n  // Re-render it and enable drag move\n  this.doRender(e.featureTarget.properties.id);\n\n  // Set up the state for drag moving\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nCustomSelectMode.clickOnFeature = function (state, e) {\n  // Stop everything\n  doubleClickZoom.disable(this);\n  this.stopExtendedInteractions(state);\n\n  const isShiftClick = CommonSelectors.isShiftDown(e);\n  const selectedFeatureIds = this.getSelectedIds();\n  const featureId = e.featureTarget.properties.id;\n  const isFeatureSelected = this.isSelected(featureId);\n\n  // Click (without shift) on any selected feature but a point\n  if (\n    !isShiftClick &&\n    isFeatureSelected &&\n    this.getFeature(featureId).type !== Constants.geojsonTypes.POINT\n  ) {\n    // Enter direct select mode\n    return this.changeMode(\"custom_direct_select\", {\n      featureId,\n    });\n  }\n\n  // Shift-click on a selected feature\n  if (isFeatureSelected && isShiftClick) {\n    // Deselect it\n    this.deselect(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n    if (selectedFeatureIds.length === 1) {\n      doubleClickZoom.enable(this);\n    }\n    // Shift-click on an unselected feature\n  } else if (!isFeatureSelected && isShiftClick) {\n    // Add it to the selection\n    this.select(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    // Click (without shift) on an unselected feature\n  } else if (!isFeatureSelected && !isShiftClick) {\n    // Make it the only selected feature\n    selectedFeatureIds.forEach((id) => this.doRender(id));\n    this.setSelected(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  }\n\n  // No matter what, re-render the clicked feature\n  this.doRender(featureId);\n};\n\nCustomSelectMode.onMouseDown = function (state, e) {\n  if (CommonSelectors.isActiveFeature(e))\n    return this.startOnActiveFeature(state, e);\n  if (this.drawConfig.boxSelect && CommonSelectors.isShiftMousedown(e))\n    return this.startBoxSelect(state, e);\n};\n\nCustomSelectMode.startBoxSelect = function (state, e) {\n  this.stopExtendedInteractions(state);\n  this.map.dragPan.disable();\n  // Enable box select\n  state.boxSelectStartLocation = mouseEventPoint(\n    e.originalEvent,\n    this.map.getContainer()\n  );\n  state.canBoxSelect = true;\n};\n\nCustomSelectMode.onTouchStart = function (state, e) {\n  if (CommonSelectors.isActiveFeature(e))\n    return this.startOnActiveFeature(state, e);\n};\n\nCustomSelectMode.onDrag = function (state, e) {\n  if (state.canDragMove) return this.dragMove(state, e);\n  if (this.drawConfig.boxSelect && state.canBoxSelect)\n    return this.whileBoxSelect(state, e);\n};\n\nCustomSelectMode.whileBoxSelect = function (state, e) {\n  state.boxSelecting = true;\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n\n  // Create the box node if it doesn't exist\n  if (!state.boxSelectElement) {\n    state.boxSelectElement = document.createElement(\"div\");\n    state.boxSelectElement.classList.add(Constants.classes.BOX_SELECT);\n    this.map.getContainer().appendChild(state.boxSelectElement);\n  }\n\n  // Adjust the box node's width and xy position\n  const current = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  const minX = Math.min(state.boxSelectStartLocation.x, current.x);\n  const maxX = Math.max(state.boxSelectStartLocation.x, current.x);\n  const minY = Math.min(state.boxSelectStartLocation.y, current.y);\n  const maxY = Math.max(state.boxSelectStartLocation.y, current.y);\n  const translateValue = `translate(${minX}px, ${minY}px)`;\n  state.boxSelectElement.style.transform = translateValue;\n  state.boxSelectElement.style.WebkitTransform = translateValue;\n  state.boxSelectElement.style.width = `${maxX - minX}px`;\n  state.boxSelectElement.style.height = `${maxY - minY}px`;\n};\n\nCustomSelectMode.dragMove = function (state, e) {\n  // Dragging when drag move is enabled\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat,\n  };\n\n  moveFeatures(this.getSelected(), delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nCustomSelectMode.onMouseUp = function (state, e) {\n  // End any extended interactions\n  if (state.dragMoving) {\n    this.fireUpdate();\n  } else if (state.boxSelecting) {\n    const bbox = [\n      state.boxSelectStartLocation,\n      mouseEventPoint(e.originalEvent, this.map.getContainer()),\n    ];\n    const featuresInBox = this.featuresAt(null, bbox, \"click\");\n    const idsToSelect = this.getUniqueIds(featuresInBox).filter(\n      (id) => !this.isSelected(id)\n    );\n\n    if (idsToSelect.length) {\n      this.select(idsToSelect);\n      idsToSelect.forEach((id) => this.doRender(id));\n      this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    }\n  }\n  this.stopExtendedInteractions(state);\n};\n\nCustomSelectMode.toDisplayFeatures = function (state, geojson, display) {\n  geojson.properties.active = this.isSelected(geojson.properties.id)\n    ? Constants.activeStates.ACTIVE\n    : Constants.activeStates.INACTIVE;\n  display(geojson);\n  this.fireActionable();\n  if (\n    geojson.properties.active !== Constants.activeStates.ACTIVE ||\n    geojson.geometry.type === Constants.geojsonTypes.POINT\n  )\n    return;\n  createSupplementaryPoints(geojson).forEach(display);\n};\n\nCustomSelectMode.onTrash = function () {\n  this.deleteFeature(this.getSelectedIds());\n  this.fireActionable();\n};\n\nCustomSelectMode.onCombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n\n  if (selectedFeatures.length === 0 || selectedFeatures.length < 2) return;\n\n  const coordinates = [],\n    featuresCombined = [];\n  const featureType = selectedFeatures[0].type.replace(\"Multi\", \"\");\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (feature.type.replace(\"Multi\", \"\") !== featureType) {\n      return;\n    }\n    if (feature.type.includes(\"Multi\")) {\n      feature.getCoordinates().forEach((subcoords) => {\n        coordinates.push(subcoords);\n      });\n    } else {\n      coordinates.push(feature.getCoordinates());\n    }\n\n    featuresCombined.push(feature.toGeoJSON());\n  }\n\n  if (featuresCombined.length > 1) {\n    const multiFeature = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: featuresCombined[0].properties,\n      geometry: {\n        type: `Multi${featureType}`,\n        coordinates,\n      },\n    });\n\n    this.addFeature(multiFeature);\n    this.deleteFeature(this.getSelectedIds(), { silent: true });\n    this.setSelected([multiFeature.id]);\n\n    this.map.fire(Constants.events.COMBINE_FEATURES, {\n      createdFeatures: [multiFeature.toGeoJSON()],\n      deletedFeatures: featuresCombined,\n    });\n  }\n  this.fireActionable();\n};\n\nCustomSelectMode.onUncombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0) return;\n\n  const createdFeatures = [];\n  const featuresUncombined = [];\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (this.isInstanceOf(\"MultiFeature\", feature)) {\n      feature.getFeatures().forEach((subFeature) => {\n        this.addFeature(subFeature);\n        subFeature.properties = feature.properties;\n        createdFeatures.push(subFeature.toGeoJSON());\n        this.select([subFeature.id]);\n      });\n      this.deleteFeature(feature.id, { silent: true });\n      featuresUncombined.push(feature.toGeoJSON());\n    }\n  }\n\n  if (createdFeatures.length > 1) {\n    this.map.fire(Constants.events.UNCOMBINE_FEATURES, {\n      createdFeatures,\n      deletedFeatures: featuresUncombined,\n    });\n  }\n  this.fireActionable();\n};\n\nexport default CustomSelectMode;\n","import {\n  noTarget,\n  isOfMetaType,\n  isActiveFeature,\n  isInactiveFeature,\n  isShiftDown,\n} from \"@mapbox/mapbox-gl-draw/src/lib/common_selectors\";\nimport createSupplementaryPoints from \"@mapbox/mapbox-gl-draw/src/lib/create_supplementary_points\";\nimport constrainFeatureMovement from \"@mapbox/mapbox-gl-draw/src/lib/constrain_feature_movement\";\nimport doubleClickZoom from \"@mapbox/mapbox-gl-draw/src/lib/double_click_zoom\";\nimport * as Constants from \"@mapbox/mapbox-gl-draw/src/constants\";\nimport moveFeatures from \"@mapbox/mapbox-gl-draw/src/lib/move_features\";\nimport drawUtils from \"./lib/utils\";\n\nconst isVertex = isOfMetaType(Constants.meta.VERTEX);\nconst isMidpoint = isOfMetaType(Constants.meta.MIDPOINT);\n\nconst DirectSelect = {};\n\n// INTERNAL FUCNTIONS\n\nDirectSelect.fireUpdate = function () {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.CHANGE_COORDINATES,\n    features: this.getSelected().map((f) => f.toGeoJSON()),\n  });\n};\n\nDirectSelect.fireActionable = function (state) {\n  this.setActionableState({\n    combineFeatures: false,\n    uncombineFeatures: false,\n    trash: state.selectedCoordPaths.length > 0,\n  });\n};\n\nDirectSelect.startDragging = function (state, e) {\n  this.map.dragPan.disable();\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.stopDragging = function (state) {\n  this.map.dragPan.enable();\n  state.dragMoving = false;\n  state.canDragMove = false;\n  state.dragMoveLocation = null;\n};\n\nDirectSelect.onVertex = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  const selectedIndex = state.selectedCoordPaths.indexOf(about.coord_path);\n  if (!isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths = [about.coord_path];\n  } else if (isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths.push(about.coord_path);\n  }\n\n  // currently this work with single selected vertices only\n  let allFeatures = drawUtils.getDrawInstance(this.map).getAll();\n\n  let matchingVertices = drawUtils.getMatchingVertices(\n    e.featureTarget._geometry.coordinates,\n    e.featureTarget.properties.parent,\n    allFeatures.features,\n    this.map\n  );\n  state.groupMove_vertices = matchingVertices;\n\n  for (let i = 0; i < state.groupMove_vertices.length; i++) {\n    state.groupMove_vertices[i].feature = this.getFeature(\n      state.groupMove_vertices[i].featureId\n    );\n  }\n\n  const selectedCoordinates = this.pathsToCoordinates(\n    state.featureId,\n    state.selectedCoordPaths\n  );\n  this.setSelectedCoordinates(selectedCoordinates);\n};\n\nDirectSelect.onMidpoint = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  state.feature.addCoordinate(about.coord_path, about.lng, about.lat);\n  this.fireUpdate();\n  state.selectedCoordPaths = [about.coord_path];\n};\n\nDirectSelect.pathsToCoordinates = function (featureId, paths) {\n  return paths.map((coord_path) => ({ feature_id: featureId, coord_path }));\n};\n\nDirectSelect.onFeature = function (state, e) {\n  if (state.selectedCoordPaths.length === 0) this.startDragging(state, e);\n  else this.stopDragging(state);\n};\n\nDirectSelect.dragFeature = function (state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.dragVertex = function (state, e, delta) {\n  const selectedCoords = state.selectedCoordPaths.map((coord_path) =>\n    state.feature.getCoordinate(coord_path)\n  );\n  const selectedCoordPoints = selectedCoords.map((coords) => ({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: coords,\n    },\n  }));\n\n  const constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n  for (let i = 0; i < selectedCoords.length; i++) {\n    const coord = selectedCoords[i];\n    state.feature.updateCoordinate(\n      state.selectedCoordPaths[i],\n      coord[0] + constrainedDelta.lng,\n      coord[1] + constrainedDelta.lat\n    );\n\n    for (let k = 0; k < state.groupMove_vertices.length; k++) {\n      let coord_path_m = state.groupMove_vertices[k].coord_path.split(\".\");\n      if (\n        typeof coord_path_m[0] !== \"undefined\" &&\n        typeof coord_path_m[1] !== \"undefined\" &&\n        typeof state.groupMove_vertices[k].feature.coordinates[\n          coord_path_m[0]\n        ] !== \"undefined\" &&\n        typeof state.groupMove_vertices[k].feature.coordinates[coord_path_m[0]][\n          coord_path_m[1]\n        ] !== \"undefined\"\n      ) {\n        let coord_m =\n          state.groupMove_vertices[k].feature.coordinates[coord_path_m[0]][\n            coord_path_m[1]\n          ];\n        state.groupMove_vertices[k].feature.updateCoordinate(\n          state.groupMove_vertices[k].coord_path,\n          coord_m[0] + constrainedDelta.lng,\n          coord_m[1] + constrainedDelta.lat\n        );\n      }\n    }\n  }\n};\n\nDirectSelect.clickNoTarget = function () {\n  this.changeMode(\"custom_select\");\n};\n\nDirectSelect.clickInactive = function () {\n  this.changeMode(\"custom_select\");\n};\n\nDirectSelect.clickActiveFeature = function (state) {\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  state.feature.changed();\n};\n\n// EXTERNAL FUNCTIONS\n\nDirectSelect.onSetup = function (opts) {\n  const featureId = opts.featureId;\n  const feature = this.getFeature(featureId);\n\n  if (!feature) {\n    throw new Error(\"You must provide a featureId to enter direct_select mode\");\n  }\n\n  if (feature.type === Constants.geojsonTypes.POINT) {\n    throw new TypeError(\"direct_select mode doesn't handle point features\");\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : [],\n    groupMove_vertices: opts.groupMove_vertices ? opts.groupMove_vertices : [],\n  };\n\n  this.setSelectedCoordinates(\n    this.pathsToCoordinates(featureId, state.selectedCoordPaths)\n  );\n  this.setSelected(featureId);\n  doubleClickZoom.disable(this);\n\n  this.setActionableState({\n    trash: true,\n  });\n\n  return state;\n};\n\nDirectSelect.onStop = function () {\n  doubleClickZoom.enable(this);\n  this.clearSelectedCoordinates();\n};\n\nDirectSelect.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths,\n    }).forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\n\nDirectSelect.onTrash = function (state) {\n  // Uses number-aware sorting to make sure '9' < '10'. Comparison is reversed because we want them\n  // in reverse order so that we can remove by index safely.\n  state.selectedCoordPaths\n    .sort((a, b) => b.localeCompare(a, \"en\", { numeric: true }))\n    .forEach((id) => state.feature.removeCoordinate(id));\n  this.fireUpdate();\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  this.fireActionable(state);\n  if (state.feature.isValid() === false) {\n    this.deleteFeature([state.featureId]);\n    this.changeMode(\"custom_select\", {});\n  }\n};\n\nDirectSelect.onMouseMove = function (state, e) {\n  // On mousemove that is not a drag, stop vertex movement.\n  const isFeature = isActiveFeature(e);\n  const onVertex = isVertex(e);\n  const noCoords = state.selectedCoordPaths.length === 0;\n  if (isFeature && noCoords)\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else if (onVertex && !noCoords)\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  this.stopDragging(state);\n};\n\nDirectSelect.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) this.fireUpdate();\n};\n\nDirectSelect.onTouchStart = DirectSelect.onMouseDown = function (state, e) {\n  if (isVertex(e)) return this.onVertex(state, e);\n  if (isActiveFeature(e)) return this.onFeature(state, e);\n  if (isMidpoint(e)) return this.onMidpoint(state, e);\n};\n\nDirectSelect.onDrag = function (state, e) {\n  if (state.canDragMove !== true) return;\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat,\n  };\n  if (state.selectedCoordPaths.length > 0) this.dragVertex(state, e, delta);\n  else this.dragFeature(state, e, delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.onClick = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n  this.stopDragging(state);\n};\n\nDirectSelect.onTap = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n};\n\nDirectSelect.onTouchEnd = DirectSelect.onMouseUp = function (state) {\n  if (state.dragMoving) {\n    this.fireUpdate();\n  }\n  this.stopDragging(state);\n};\n\nexport default DirectSelect;\n","import React, { useState, useEffect, useContext, useRef } from \"react\";\nimport \"./MlMapDrawTools.css\";\n\nimport \"@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw.css\";\nimport MapboxDraw from \"@mapbox/mapbox-gl-draw\";\nimport CustomPolygonMode from \"./custom-polygon-mode\";\nimport CustomSelectMode from \"./custom-select-mode\";\nimport CustomDirectSelectMode from \"./custom-direct-select-mode\";\n\nimport { MapContext } from \"react-map-components-core\";\n\nimport DeleteIcon from \"@material-ui/icons/DeleteForever\";\nimport Button from \"@material-ui/core/Button\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\n\nfunction MlMapDrawTools() {\n  const draw = useRef(null);\n  const mapContext = useContext(MapContext);\n\n  const [firstLoad, setFirstLoad] = useState(true);\n  const [mouseUpTrigger, setMouseUpTrigger] = useState(false);\n\n  //const [groupCloseVertices, setGroupCloseVertices] = useState(false);\n\n  const [storedMapFeatures, setStoredMapFeatures] = useState(null);\n\n  const [drawnFeatures, setDrawnFeatures] = useState([]);\n  const [drawModeActive, setDrawModeActive] = useState(true);\n  const [currentDrawMode, setCurrentDrawMode] = useState(\"custom_select\");\n  const [selectedFeatureId, setSelectedFeatureId] = useState(\"\");\n\n  useEffect(() => {\n    // retrieve stored features from localstorage\n    let storedMapFeaturesStr = localStorage.getItem(\"storedMapFeatures\");\n\n    if (storedMapFeaturesStr) {\n      let storedMapFeaturesObj = JSON.parse(storedMapFeaturesStr);\n      setStoredMapFeatures(storedMapFeaturesObj);\n      setDrawnFeatures(storedMapFeaturesObj.features);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (mapContext.map && firstLoad) {\n      setFirstLoad(false);\n      if (\n        mapContext.map.getSource(\"mapbox-gl-draw-cold\") &&\n        window.MapboxDraw &&\n        typeof window.MapboxDraw.remove !== \"undefined\"\n      ) {\n        // remove old Mapbox-gl-Draw from Mapbox instance when hot-reloading this component during development\n        window.MapboxDraw.remove();\n      }\n      window.MapLibreObj = mapContext.map;\n\n      draw.current = new MapboxDraw({\n        displayControlsDefault: false,\n        defaultMode: \"custom_select\",\n        modes: Object.assign(\n          {\n            custom_polygon: CustomPolygonMode,\n            custom_select: CustomSelectMode,\n            custom_direct_select: CustomDirectSelectMode,\n          },\n          MapboxDraw.modes\n        ),\n      });\n\n      mapContext.map.on(\"draw.modechange\", (e) => {\n        console.log(\"modechange\");\n        setCurrentDrawMode(e.mode);\n      });\n\n      window.MapboxDraw = draw.current;\n\n      // sadly there is no featureAdd event available in MapLibre\n      mapContext.map.addControl(draw.current, \"top-left\");\n\n      mapContext.map.on(\"mouseup\", () => {\n        setMouseUpTrigger(Math.random());\n      });\n\n      if (storedMapFeatures) {\n        draw.current.set(storedMapFeatures);\n      }\n    }\n  }, [mapContext.map, drawnFeatures, firstLoad]);\n\n  useEffect(() => {\n    if (draw.current) {\n      // update drawnFeatures state object\n      let currentFeatureCollection = draw.current.getAll();\n      if (\n        currentDrawMode === \"custom_polygon\" ||\n        currentDrawMode === \"custom_select\"\n      ) {\n        setDrawnFeatures([...currentFeatureCollection.features]);\n\n        localStorage.setItem(\n          \"storedMapFeatures\",\n          JSON.stringify(currentFeatureCollection)\n        );\n      }\n\n      // update selected feature\n      let selectedFeature = draw.current.getSelected();\n      for (var i = 0; i < drawnFeatures.length; i++) {\n        if (\n          typeof selectedFeature.features[0] !== \"undefined\" &&\n          selectedFeature.features[0].id === drawnFeatures[i].id\n        ) {\n          setSelectedFeatureId(selectedFeature.features[0].id);\n        }\n      }\n    }\n  }, [mouseUpTrigger]);\n\n  useEffect(() => {\n    if (draw.current) {\n      switch (currentDrawMode) {\n        case \"custom_polygon\":\n          draw.current.changeMode(\"custom_polygon\");\n          break;\n        case \"custom_select\":\n        default:\n          draw.current.changeMode(\"custom_select\");\n          break;\n      }\n    }\n  }, [currentDrawMode]);\n\n  return (\n    <>\n      <Button\n        color=\"primary\"\n        variant={drawModeActive ? \"contained\" : \"outlined\"}\n        onClick={() => setDrawModeActive(!drawModeActive)}\n        style={{}}\n      >\n        Draw\n      </Button>\n      {drawModeActive && (\n        <>\n          <Button\n            variant={\n              currentDrawMode === \"custom_select\" ||\n              currentDrawMode === \"custom_direct_select\"\n                ? \"contained\"\n                : \"outlined\"\n            }\n            onClick={() => setCurrentDrawMode(\"custom_select\")}\n            style={{}}\n          >\n            Select\n          </Button>\n          <Button\n            variant={\n              currentDrawMode === \"custom_polygon\" ? \"contained\" : \"outlined\"\n            }\n            onClick={() =>\n              setCurrentDrawMode(\n                currentDrawMode !== \"custom_polygon\"\n                  ? \"custom_polygon\"\n                  : \"custom_select\"\n              )\n            }\n            style={{}}\n          >\n            Polygon\n          </Button>\n          <Button\n            variant=\"contained\"\n            onClick={() => {\n              localStorage.setItem(\"storedMapFeatures\", \"\");\n              setStoredMapFeatures(null);\n              setDrawnFeatures([]);\n              draw.current.deleteAll();\n            }}\n            style={{}}\n          >\n            <DeleteIcon></DeleteIcon>\n          </Button>\n          <div\n            style={{\n              position: \"absolute\",\n              left: \"34px\",\n              top: \"96px\",\n              backgroundColor: \"#f8f9fa\",\n              borderRadius: \"4px\",\n              width: \"150px\",\n              height: \"200px\",\n            }}\n          >\n            <List dense={false}>\n              {drawnFeatures.map((feature, id) => (\n                <ListItem\n                  key={id}\n                  style={{\n                    color: \"#000\",\n                    backgroundColor:\n                      selectedFeatureId === feature.id ? \"#00ffff\" : \"#fff\",\n                  }}\n                >\n                  <ListItemText primary={feature.type} secondary={id} />\n                </ListItem>\n              ))}\n            </List>\n          </div>\n        </>\n      )}\n    </>\n  );\n}\n\nexport default MlMapDrawTools;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\n\n/**\n * MlOsmLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlOsmLayer = () => {\n  const mapContext = useContext(MapContext);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const idPostfixRef = useRef(new Date().getTime());\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    return () => {\n      if (\n        mapContext.map.getLayer(\"raster-tile-layer-\" + idPostfixRef.current)\n      ) {\n        mapContext.map.removeLayer(\"raster-tile-layer-\" + idPostfixRef.current);\n      }\n      if (\n        mapContext.map.getSource(\"raster-tile-source-\" + idPostfixRef.current)\n      ) {\n        mapContext.map.removeSource(\n          \"raster-tile-source-\" + idPostfixRef.current\n        );\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // Add the new layer to the openlayers instance once it is available\n    //mapContext.map.addSource(\"vector-tile-source-\" + idPostfixRef.current, {\n    //  type: \"vector\",\n    //  style: \"https://wms.wheregroup.com/tileserver/style/osm-bright.json\",\n    //  tileSize: 512,\n    //  attribution: \"\",\n    //});\n\n    mapContext.map.addSource(\"raster-tile-source-\" + idPostfixRef.current, {\n      type: \"raster\",\n      tiles: [\n        \"https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",\n      ],\n      tileSize: 256,\n      attribution:\n        'Map tiles by <a target=\"_top\" rel=\"noopener\" href=\"http://stamen.com\">Stamen Design</a>, under <a target=\"_top\" rel=\"noopener\" href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a target=\"_top\" rel=\"noopener\" href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a target=\"_top\" rel=\"noopener\" href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>',\n    });\n    mapContext.map.addLayer({\n      id: \"raster-tile-layer-\" + idPostfixRef.current,\n      type: \"raster\",\n      source: \"raster-tile-source-\" + idPostfixRef.current,\n      minzoom: 0,\n      maxzoom: 22,\n    });\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.map.setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"visible\"\n      );\n    } else {\n      mapContext.map.setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"none\"\n      );\n    }\n  }, [showLayer]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      OSM\n    </Button>\n  );\n};\n\nexport default MlOsmLayer;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\nimport GeoJsonContext from \"../MlGPXViewer/util/GeoJsonContext\";\nimport { polygon,lineString } from \"@turf/helpers\";\nimport { distance,lineOffset } from \"@turf/turf\";\n\n\n\n/**\n * MlSpatialElevationProfile returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlSpatialElevationProfile = ({elevationFactor = 1, mapId = null }) => {\n  const mapContext = useContext(MapContext);\n  const dataSource = useContext(GeoJsonContext);\n  const sourceName = \"elevationprofile\";\n  const layerName = \"elevationprofile-layer\";\n \n  \n  console.log(elevationFactor)\n\n  const createStep = (x, y, z, x2, y2) => {\n    const summand = 0.00020;\n    const line = lineString([[x,y], [x2,y2]]);\n    const offsetLine = lineOffset(line,5, {units: 'meters'});\n    const x3 = offsetLine.geometry.coordinates[0][0];\n    const y3 = offsetLine.geometry.coordinates[0][1];\n    const x4 = offsetLine.geometry.coordinates[1][0];\n    const y4 = offsetLine.geometry.coordinates[1][1];\n    \n    return polygon(\n      [\n        [\n          [x, y],\n          [x2, y2],\n          \n          [x4, y4],\n          [x3,y3],\n          [x, y],\n        ],\n      ],\n      { height: (z) * elevationFactor }\n    );\n  };\n\n  const cleanUp = () => {\n    const map = mapContext.maps[mapId] || mapContext.map;\n    [layerName].forEach((layerName) => {\n      if (map.getLayer(layerName)) {\n        map.removeLayer(layerName);\n      }\n    });\n\n    if (map.getSource(sourceName)) {\n      map.removeSource(sourceName);\n    }\n  };\n  useEffect(() => {\n    const map = mapContext.maps[mapId] || mapContext.map;\n    if (!map) return;\n    map.addSource(sourceName, {\n      type: \"geojson\",\n      data: dataSource.data,\n    });\n    map.addLayer({\n      id: layerName,\n      source: sourceName,\n      type: \"fill-extrusion\",\n      paint: {\n        \"fill-extrusion-height\": [\"get\", \"height\"],\n        \"fill-extrusion-opacity\": 0.9,\n        \"fill-extrusion-color\": [\n          \"interpolate\",\n          [\"linear\"],\n          [\"get\", \"height\"],\n          0,\n          \"rgba(0, 0, 255, 0)\",\n          0.1,\n          \"royalblue\",\n          0.3,\n          \"cyan\",\n          0.5,\n          \"lime\",\n          0.7,\n          \"yellow\",\n          1,\n          \"yellow\",\n        ],\n      },\n    });\n\n    return cleanUp;\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    const map = mapContext.maps[mapId] || mapContext.map;\n    if (!map) return;\n    const { data } = dataSource;\n\n    const line = data.features.find((element) => {\n      return element.geometry.type === \"LineString\";\n    });\n    const heights = line.geometry.coordinates.map((coordinate, index) => {\n      return coordinate[2];\n    });\n    \n    const min = Math.min(...heights);\n   \n    let max = Math.max(...heights)-min;\n    \n    max = max ===0 ? 1 : max;\n   \n    map.setPaintProperty(layerName, \"fill-extrusion-color\", [\n      \"interpolate\",\n      [\"linear\"],\n      [\"get\", \"height\"],\n      0,\n      \"rgb(0,255,55)\",\n      (max)*elevationFactor,\n      \"rgb(255,0,0)\",\n    ]);\n    const lerp = (x, y, a) => x * (1 - a) + y * a;\n    const points = [];\n\n    line.geometry.coordinates.forEach((coordinate, index) => {\n      //const point = createPoint(coordinate[0],coordinate[1],coordinate[2]-min);\n      //points.push(point);\n      if (line.geometry.coordinates[index + 1]) {\n        const wayLength = distance(\n          [coordinate[0], coordinate[1]],\n          [\n            line.geometry.coordinates[index + 1][0],\n            line.geometry.coordinates[index + 1][1],\n          ],\n          { units: \"kilometers\" }\n        );\n        let listLength = ~~((wayLength * 1000) / 10);\n        listLength = listLength < 1 ? 1 : listLength;\n        for (let i = 0; i < listLength; i++) {\n          const x = lerp(\n            line.geometry.coordinates[index][0],\n            line.geometry.coordinates[index + 1][0],\n            i / listLength\n          );\n          const y = lerp(\n            line.geometry.coordinates[index][1],\n            line.geometry.coordinates[index + 1][1],\n            i / listLength\n          );\n          const z = lerp(\n            line.geometry.coordinates[index][2] - min,\n            line.geometry.coordinates[index + 1][2] - min,\n            i / listLength\n          );\n\n          const x2 = lerp(\n            line.geometry.coordinates[index][0],\n            line.geometry.coordinates[index + 1][0],\n            (i + 1) / listLength\n          );\n          const y2 = lerp(\n            line.geometry.coordinates[index][1],\n            line.geometry.coordinates[index + 1][1],\n            (i + 1) / listLength\n          );\n\n          const point = createStep(x, y, z, x2, y2);\n          points.push(point);\n        }\n      }\n    });\n\n    const newData = dataSource.getEmptyFeatureCollection();\n    newData.features = points;\n    \n    map.getSource(sourceName)?.setData(newData);\n  }, [dataSource.data]);\n\n  return <></>;\n};\n\nexport default MlSpatialElevationProfile;\n","import React, { useContext, useCallback, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\nimport maplibregl from \"maplibre-gl\";\nimport * as THREE from \"three\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\n\n/**\n * MlThreeJsLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlThreeJsLayer = ({ init, onDone }) => {\n  const mapContext = useContext(MapContext);\n\n  const layerRef = useRef(null);\n  const layerName = \"3d-model\";\n  const [showLayer, setShowLayer] = useState(true);\n  const [play, setPlay] = useState(false);\n  const showLayerRef = useRef(true);\n  const idPostfixRef = useRef(new Date().getTime());\n\n  const componentCleanup = () => {\n    if (mapContext.map.getLayer(layerName)) {\n      mapContext.map.removeLayer(layerName);\n    }\n    if (mapContext.map.getSource(layerName + \"-source\")) {\n      mapContext.map.removeSource(layerName + \"-source\");\n    }\n  };\n\n  let rotateCamera = useCallback(\n    (timestamp) => {\n      if (!play || !mapContext.map) return;\n      // clamp the rotation between 0 -360 degrees\n      // Divide timestamp by 100 to slow rotation to ~10 degrees / sec\n      mapContext.map.rotateTo((timestamp / 100) % 360, { duration: 0 });\n      // Request the next frame of the animation.\n      if (showLayerRef.current && play) {\n        requestAnimationFrame(rotateCamera);\n      }\n    },\n    [play]\n  );\n  useEffect(() => {\n    if (play) {\n      //rotateCamera(0);\n    }\n  }, [play]);\n\n  useEffect(() => {\n    if (typeof init === \"function\") {\n      init();\n    }\n\n    if (!mapContext.map) return;\n\n    return () => {\n      componentCleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // cleanup fragments left in MapLibre-gl from previous component uses\n    componentCleanup();\n\n    // parameters to ensure the model is georeferenced correctly on the map\n    var modelOrigin = [7.1300753566457304, 50.71596191210998];\n    var modelAltitude = 0;\n    var modelRotate = [Math.PI / 2, 90, 0];\n\n    var modelAsMercatorCoordinate = maplibregl.MercatorCoordinate.fromLngLat(\n      modelOrigin,\n      modelAltitude\n    );\n\n    // transformation parameters to position, rotate and scale the 3D model onto the map\n    var modelTransform = {\n      translateX: modelAsMercatorCoordinate.x + 0.0000008,\n      translateY: modelAsMercatorCoordinate.y + 0.0000018,\n      translateZ: modelAsMercatorCoordinate.z,\n      rotateX: modelRotate[0],\n      rotateY: modelRotate[1],\n      rotateZ: modelRotate[2],\n      /* Since our 3D model is in real world meters, a scale transform needs to be\n       * applied since the CustomLayerInterface expects units in MercatorCoordinates.\n       */\n      scale: modelAsMercatorCoordinate.meterInMercatorCoordinateUnits() + 0.00000003,\n    };\n\n    //var THREE = window.THREE;\n\n    // configuration of the custom layer for a 3D model per the CustomLayerInterface\n    var customLayer = {\n      id: \"3d-model\",\n      type: \"custom\",\n      renderingMode: \"3d\",\n      onAdd: function (map, gl) {\n        this.camera = new THREE.Camera();\n        this.scene = new THREE.Scene();\n\n        // create two three.js lights to illuminate the model\n        var directionalLight = new THREE.DirectionalLight(0xffffff);\n        directionalLight.position.set(0, -70, 100).normalize();\n        this.scene.add(directionalLight);\n\n        var directionalLight2 = new THREE.DirectionalLight(0xffffff);\n        directionalLight2.position.set(0, 70, 100).normalize();\n        this.scene.add(directionalLight2);\n\n        // use the three.js GLTF loader to add the 3D model to the three.js scene\n        var loader = new GLTFLoader();\n        loader.load(\n          //\"/assets/3D/posttower_simple.gltf\",\n          \"/assets/3D/godzilla_simple.glb\",\n          //\"https://docs.mapbox.com/mapbox-gl-js/assets/34M_17/34M_17.gltf\",\n          function (gltf) {\n            this.scene.add(gltf.scene);\n            if (typeof onDone === \"function\") {\n              onDone();\n            }\n          }.bind(this)\n        );\n        var loader = new GLTFLoader();\n        loader.load(\n          \"/assets/3D/posttower.gltf\",\n          //\"/assets/3D/posttower_wh.gltf.glb\",\n          //\"https://docs.mapbox.com/mapbox-gl-js/assets/34M_17/34M_17.gltf\",\n          function (gltf) {\n            this.scene.add(gltf.scene);\n          }.bind(this)\n        );\n        this.map = map;\n\n        // use the Mapbox GL JS map canvas for three.js\n        this.renderer = new THREE.WebGLRenderer({\n          canvas: map.getCanvas(),\n          context: gl,\n          antialias: true,\n        });\n\n        this.renderer.autoClear = false;\n      },\n      render: function (gl, matrix) {\n        var rotationX = new THREE.Matrix4().makeRotationAxis(\n          new THREE.Vector3(1, 0, 0),\n          modelTransform.rotateX\n        );\n        var rotationY = new THREE.Matrix4().makeRotationAxis(\n          new THREE.Vector3(0, 1, 0),\n          modelTransform.rotateY\n        );\n        var rotationZ = new THREE.Matrix4().makeRotationAxis(\n          new THREE.Vector3(0, 0, 1),\n          modelTransform.rotateZ\n        );\n\n        var m = new THREE.Matrix4().fromArray(matrix);\n        var l = new THREE.Matrix4()\n          .makeTranslation(\n            modelTransform.translateX,\n            modelTransform.translateY,\n            modelTransform.translateZ\n          )\n          .scale(\n            new THREE.Vector3(\n              modelTransform.scale,\n              -modelTransform.scale,\n              modelTransform.scale\n            )\n          )\n          .multiply(rotationX)\n          .multiply(rotationY)\n          .multiply(rotationZ);\n\n        this.camera.projectionMatrix = m.multiply(l);\n        this.renderer.resetState();\n        this.renderer.render(this.scene, this.camera);\n        this.map.triggerRepaint();\n      },\n    };\n\n    mapContext.map.addLayer(customLayer);\n\n    if (mapContext.map.getLayer(layerName)) {\n      mapContext.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n    }\n    mapContext.map.setCenter([7.130255969902919, 50.7143656091998]);\n    mapContext.map.setZoom(15);\n    mapContext.map.setPitch(45);\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    if (mapContext.map.getLayer(layerName)) {\n      // toggle layer visibility by changing the layout object's visibility property\n      if (showLayer) {\n        mapContext.map.setLayoutProperty(layerName, \"visibility\", \"visible\");\n      } else {\n        mapContext.map.setLayoutProperty(layerName, \"visibility\", \"none\");\n      }\n    }\n    //\n  }, [showLayer, mapContext]);\n\n  return (\n    <>\n      <Button\n        color=\"primary\"\n        variant={showLayer ? \"contained\" : \"outlined\"}\n        onClick={() => {\n          setShowLayer(!showLayer);\n          showLayerRef.current = !showLayer;\n        }}\n      >\n        3D\n      </Button>\n      {/**\n      <Button\n        color=\"primary\"\n        variant={play ? \"contained\" : \"outlined\"}\n        onClick={() => {\n          setPlay(!play);\n        }}\n      >\n        Play\n      </Button>\n      **/}\n    </>\n  );\n};\n\nexport default MlThreeJsLayer;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\n/**\n * MlVectorTileLayer returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlVectorTileLayer = (props) => {\n  const mapContext = useContext(MapContext);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const layerName = \"vector-tile-layer-\";\n  const sourceName = \"vector-tile-source-\";\n  const idPostfixRef = useRef(new Date().getTime());\n  const layerIdsRef = useRef({});\n\n  const cleanup = () => {\n    for (let key in layerIdsRef.current) {\n      if (mapContext.map.getLayer(layerIdsRef.current[key])) {\n        mapContext.map.removeLayer(layerIdsRef.current[key]);\n      }\n    }\n    if (mapContext.map.getSource(sourceName + idPostfixRef.current)) {\n      mapContext.map.removeSource(sourceName + idPostfixRef.current);\n    }\n  };\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    return () => {\n      cleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    cleanup();\n\n    // Add the new layer to the openlayers instance once it is available\n    mapContext.map.addSource(sourceName + idPostfixRef.current, {\n      type: \"vector\",\n      tiles: [props.url],\n      tileSize: 512,\n      attribution: \"\",\n      //...props.sourceOptions,\n    });\n\n    for (let key in props.layers) {\n      let layerId = layerName + \"_\" + key + \"_\" + idPostfixRef.current;\n      layerIdsRef.current[key] = layerId;\n\n      mapContext.map.addLayer({\n        id: layerId,\n        source: sourceName + idPostfixRef.current,\n        type: \"line\",\n        minzoom: 0,\n        maxzoom: 22,\n        layout: {},\n        paint: {\n          \"line-opacity\": 0.5,\n          \"line-color\": \"rgb(80, 80, 80)\",\n          \"line-width\": 2,\n        },\n        ...props.layers[key],\n      });\n    }\n  }, [mapContext.map]);\n\n  useEffect(() => {\n    if (!mapContext.mapExists(props.mapId)) return;\n    // the MapLibre-gl instance (mapContext.map) is accessible here\n    // initialize the layer and add it to the MapLibre-gl instance or do something else with it\n\n    for (var key in props.layers) {\n      if (mapContext.map.getLayer(layerIdsRef.current[key])) {\n        for (let paintKey in props.layers[key].paint) {\n          console.log(props.layers[key].paint[paintKey]);\n          mapContext\n            .getMap(props.mapId)\n            .setPaintProperty(\n              layerIdsRef.current[key],\n              paintKey,\n              props.layers[key].paint[paintKey]\n            );\n        }\n      }\n    }\n  }, [props.layers]);\n\n  useEffect(() => {\n    if (!mapContext.map) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.map.setLayoutProperty(\n        layerName + idPostfixRef.current,\n        \"visibility\",\n        \"visible\"\n      );\n    } else {\n      mapContext.map.setLayoutProperty(\n        layerName + idPostfixRef.current,\n        \"visibility\",\n        \"none\"\n      );\n    }\n  }, [showLayer]);\n\n  return <></>;\n};\n\nexport default MlVectorTileLayer;\n","import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { MapContext } from \"react-map-components-core\";\n\nimport Button from \"@material-ui/core/Button\";\n\n/**\n * MlWmsLayerMulti returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n */\nconst MlWmsLayerMulti = (props) => {\n  const mapContext = useContext(MapContext);\n\n  const [showLayer, setShowLayer] = useState(true);\n  const idPostfixRef = useRef(new Date().getTime());\n\n  const mapExists = () => {\n    if (!props.mapId) {\n      return false;\n    }\n    if (mapContext.mapIds.indexOf(props.mapId) === -1) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const cleanup = () => {\n    if (mapExists()) {\n      if (\n        mapContext.maps[props.mapId].getLayer(\n          \"raster-tile-layer-\" + idPostfixRef.current\n        )\n      ) {\n        mapContext.maps[props.mapId].removeLayer(\n          \"raster-tile-layer-\" + idPostfixRef.current\n        );\n      }\n      if (\n        mapContext.maps[props.mapId].getSource(\n          \"raster-tile-source-\" + idPostfixRef.current\n        )\n      ) {\n        mapContext.maps[props.mapId].removeSource(\n          \"raster-tile-source-\" + idPostfixRef.current\n        );\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (!mapExists()) return;\n\n    return () => {\n      cleanup();\n    };\n  }, []);\n\n  useEffect(() => {\n    console.log(mapContext);\n    if (!mapExists()) return;\n\n    cleanup();\n\n    console.log(\"HALLO\");\n    // Add the new layer to the openlayers instance once it is available\n    mapContext.maps[props.mapId].addSource(\n      \"raster-tile-source-\" + idPostfixRef.current,\n      {\n        type: \"raster\",\n        tiles: [\n          props.url +\n            \"?bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&width=256&height=256&layers=\" +\n            props.layer,\n        ],\n        tileSize: 256,\n        attribution: \"\",\n        //...props.sourceOptions,\n      }\n    );\n\n    mapContext.maps[props.mapId].addLayer({\n      id: \"raster-tile-layer-\" + idPostfixRef.current,\n      type: \"raster\",\n      source: \"raster-tile-source-\" + idPostfixRef.current,\n      minzoom: 0,\n      maxzoom: 10,\n      ...props.sourceOptions,\n    });\n    console.log(\"WMS Layer added to \" + props.mapId);\n  }, [mapContext.mapIds]);\n\n  useEffect(() => {\n    if (!mapExists()) return;\n\n    // toggle layer visibility by changing the layout object's visibility property\n    if (showLayer) {\n      mapContext.maps[props.mapId].setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"visible\"\n      );\n    } else {\n      mapContext.maps[props.mapId].setLayoutProperty(\n        \"raster-tile-layer-\" + idPostfixRef.current,\n        \"visibility\",\n        \"none\"\n      );\n    }\n  }, [showLayer]);\n\n  return (\n    <Button\n      color=\"primary\"\n      variant={showLayer ? \"contained\" : \"outlined\"}\n      onClick={() => setShowLayer(!showLayer)}\n    >\n      WMS\n    </Button>\n  );\n};\n\nexport default MlWmsLayerMulti;\n"],"names":["MapLibreMap","props","map","useRef","mapContainer","mapContext","useContext","MapContext","mapOptions","options","useEffect","current","remove","defaultOptions","lng","lat","zoom","container","accessToken","maplibregl","Map","on","mapId","registerMap","setMap","window","propTypes","PropTypes","object","MlWmsLayer","useState","showLayer","setShowLayer","idPostfixRef","Date","getTime","cleanup","getLayer","removeLayer","getSource","removeSource","addSource","type","tiles","url","layer","tileSize","attribution","addLayer","id","source","minzoom","maxzoom","sourceOptions","belowLayerId","setLayoutProperty","MlAerialPhotograph","name","class","x","y","z","legendData","setLegendData","transform","_maxZoom","paint","filter","stops","base","e","features","queryRenderedFeatures","point","layers","closestFeature","getClosestFeature","Object","values","properties","_vectorTileFeature","_x","_y","_z","featureCollection","mousePoint","identifier","i","turf","width","color","padding","height","keys","key","MlCameraFollowPath","initializedRef","clearIntervalRef","route","useMemo","path","disableInteractivity","useCallback","disable","enableInteractivity","enable","mapExists","kmPerStep","routeDistance","zoomOutTo","stepDuration","step","initialZoom","zoomSteps","getZoom","setZoom","timer","setInterval","clearInterval","alongRoute","geometry","coordinates","panTo","bearing","getCenter","duration","essential","console","log","mapIds","MlComponentTemplate","getMap","setCenter","paintDefaults","property","MlCompositeLayer","sourceId","sourceLayer","minZoom","layerName","componentCleanup","addCompositeLayer","lastLabelLayerId","nmMap","street","number","place","zip","state","nmConverter","nmAddress","addressArr","entries","value","some","element","hasOwnProperty","push","join","toPixels","length","conversionFactor","createPdf","locationValue","setLoading","actualPixelRatio","devicePixelRatio","hidden","document","createElement","className","body","appendChild","style","renderMap","center","getBearing","pitch","getPitch","interactive","preserveDrawingBuffer","fadeDuration","attributionControl","getStyle","src","sources","forEach","setStyle","once","pdf","jsPDF","orientation","unit","compress","defineProperty","get","offsetX","offsetY","marginTop","marginBottom","innerMargin","logo","textBuffer","lineHeight","text","address","textChunksSeperator","split","textChunks","chunk","limitChunks","match","addImage","getCanvas","toDataURL","setFillColor","rect","setFontSize","internal","pageSize","infoBoxSize","trim","setProperties","title","subject","creator","author","save","parentNode","removeChild","MlCreatePdfButton","MlBasicComponent","mapIsReady","DATA_URL","ambientLight","AmbientLight","intensity","pointLight1","PointLight","position","pointLight2","lightingEffect","LightingEffect","material","ambient","diffuse","shininess","specularColor","colorRange","MlDeckGlLayer","init","onDone","d3","then","response","data","d","Number","LON","LAT","minutes","Verspätungsminuten","mapBoxLayer","MapboxLayer","effects","HexagonLayer","coverage","elevationRange","elevationScale","extruded","getPosition","pickable","radius","upperPercentile","autoHighlight","transitions","setPitch","MlDeckGlTerrainLayer","showLayerRef","ELEVATION_DECODER","rScaler","gScaler","bScaler","offset","TERRAIN_IMAGE","SURFACE_IMAGE","rotateCamera","timestamp","rotateTo","requestAnimationFrame","TerrainLayer","maxZoom","strategy","elevationDecoder","elevationData","texture","wireframe","msPerStep","MlGeoJsonLayer","idSuffix","oldGeojsonRef","mapRef","transitionInProgressRef","currentTransitionStepRef","transitionGeojsonDataRef","transitionGeojsonCommonDataRef","layerId","mapObject","layerSourceId","setPaintProperty","showNextTransitionSegment","setTimeout","newData","geojson","setData","onTransitionFrame","onTransitionEnd","transitionToGeojson","newGeojson","transitionCoordinatesShort","transitionCoordinatesLong","targetCoordinates","srcCoordinates","sourceGeojson","targetGeojson","longerGeojson","shorterGeojson","reverseOrder","slice","len","transitionSteps","transitionTime","srcCoordinatesDistance","Math","round","targetCoordinatesDistance","transitionDistance","srcCoordinatesShare","srcTransitionSteps","srcPerStepDistance","targetCoordinatesShare","targetTransitionSteps","targetPerStepDistance","tmpLinestring","tmpChunks","reverse","loopStepDistance","insertBeforeLayer","GeoJsonContext","React","createContext","GeoJsonContextProvider","Provider","toGeoJSON","require","MlGPXViewer","dataSource","sourceName","layerNameLines","layerNamePoints","open","setIsOpen","dropZone","zIndex","setZIndex","metaData","setMetaData","fileupload","popup","Popup","closeButton","closeOnClick","maps","cursor","description","desc","abs","lngLat","setLngLat","setHTML","addTo","dropZoneCurrent","raiseDropZoneAndStopDefault","event","stopDefault","lowerDropZone","lowerDropZoneAndStopDefault","addEventListener","removeEventListener","preventDefault","stopPropagation","visibility","dropHandler","dataTransfer","items","kind","reader","FileReader","onload","payload","addGPXToMap","currentTarget","result","file","getAsFile","readAsText","gpxAsString","domParser","DOMParser","gpxDoc","parseFromString","metadata","querySelector","childNodes","node","textContent","nodeName","getAttribute","metaDatEntry","prevState","gpx","bounds","bbox","fitBounds","toogleDrawer","fileUploadOnChange","files","manualUpload","click","right","bottom","backgroundColor","display","textAlign","item","left","top","msTransform","MlHillshadeLayer","layerRef","MlImageMarkerLayer","layerInitializedRef","imageIdRef","imageId","layout","tmpOptions","hasImage","loadImage","imgSrc","error","image","DeckGlContext","DeckGlContextProvider","useStyles","makeStyles","theme","root","flexGrow","AppBar","minHeight","TopToolbar","classes","children","ValueLabelComponent","getColorRange","layerOpacity","MlLaermkarte","deckGlContext","simpleDataContext","SimpleDataContext","setLayerOpacity","setRadius","setElevationScale","deckLayerProps","onClick","obj","getColorValue","points","elVal","reduce","acc","dba","Infinity","getElevationValue","deckGl","setProps","DeckGlMapLibreLayer","maplibreLayer","alignItems","marginRight","ev","maxWidth","MlLayer","CustomPolygonMode","onSetup","polygon","newFeature","Constants","FEATURE","POLYGON","addFeature","clearSelectedFeatures","doubleClickZoom","updateUIClasses","mouse","ADD","activateUIButton","setActionableState","trash","currentVertexPosition","clickAnywhere","isEventAtCoordinates","changeMode","featureIds","updateCoordinate","fire","CREATE","clickOnVertex","onMouseMove","CommonSelectors","POINTER","onTap","onKeyUp","deleteFeature","silent","onStop","NONE","getFeature","undefined","removeCoordinate","isValid","toDisplayFeatures","isActivePolygon","active","ACTIVE","INACTIVE","coordinateCount","meta","createVertex","endPos","lineCoordinates","LINE_STRING","onTrash","move_features","delta","allFeatures","constrainedDelta","constrainFeatureMovement","feature","currentCoordinates","getCoordinates","moveCoordinate","coord","moveRing","ring","moveMultiPolygon","multi","nextCoordinates","POINT","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","incomingCoords","drawUtils","getMatchingVertices","vertex","featureId","decimals","matchingVertices","v_lng","toFixed","v_lat","k","m","coord_path","getDrawInstance","_controls","constructor","CustomSelectMode","opts","dragMoveLocation","boxSelectStartLocation","boxSelectElement","boxSelecting","canBoxSelect","dragMoving","canDragMove","initiallySelectedFeatureIds","setSelected","fireActionable","combineFeatures","uncombineFeatures","fireUpdate","UPDATE","action","MOVE","getSelected","f","selectedFeatures","multiFeatures","isInstanceOf","featureType","replace","getUniqueIds","ids","s","memo","add","StringSet","stopExtendedInteractions","dragPan","onMouseOut","VERTEX","clickOnFeature","wasSelected","getSelectedIds","doRender","featureTarget","parent","coordPath","startPos","startOnActiveFeature","isShiftClick","selectedFeatureIds","isFeatureSelected","isSelected","deselect","select","onMouseDown","drawConfig","boxSelect","startBoxSelect","mouseEventPoint","originalEvent","getContainer","onTouchStart","onDrag","dragMove","whileBoxSelect","classList","BOX_SELECT","minX","min","maxX","max","minY","maxY","translateValue","WebkitTransform","moveFeatures","onMouseUp","featuresInBox","featuresAt","idsToSelect","createSupplementaryPoints","onCombineFeatures","featuresCombined","includes","subcoords","multiFeature","COMBINE_FEATURES","createdFeatures","deletedFeatures","onUncombineFeatures","featuresUncombined","getFeatures","subFeature","UNCOMBINE_FEATURES","isVertex","isOfMetaType","isMidpoint","MIDPOINT","DirectSelect","CHANGE_COORDINATES","selectedCoordPaths","startDragging","stopDragging","onVertex","about","selectedIndex","indexOf","isShiftDown","getAll","_geometry","groupMove_vertices","selectedCoordinates","pathsToCoordinates","setSelectedCoordinates","onMidpoint","addCoordinate","paths","feature_id","onFeature","dragFeature","dragVertex","selectedCoords","getCoordinate","selectedCoordPoints","coords","coord_path_m","coord_m","clickNoTarget","clickInactive","clickActiveFeature","clearSelectedCoordinates","changed","Error","TypeError","midpoints","selectedPaths","sort","a","b","localeCompare","numeric","isFeature","isActiveFeature","noCoords","noTarget","isInactiveFeature","onTouchEnd","MlMapDrawTools","draw","firstLoad","setFirstLoad","mouseUpTrigger","setMouseUpTrigger","storedMapFeatures","setStoredMapFeatures","drawnFeatures","setDrawnFeatures","drawModeActive","setDrawModeActive","currentDrawMode","setCurrentDrawMode","selectedFeatureId","setSelectedFeatureId","storedMapFeaturesStr","localStorage","getItem","storedMapFeaturesObj","JSON","parse","MapboxDraw","MapLibreObj","displayControlsDefault","defaultMode","modes","assign","custom_polygon","custom_select","custom_direct_select","CustomDirectSelectMode","mode","addControl","random","set","currentFeatureCollection","setItem","stringify","selectedFeature","deleteAll","borderRadius","MlOsmLayer","MlSpatialElevationProfile","elevationFactor","createStep","x2","y2","line","lineString","offsetLine","lineOffset","units","x3","y3","x4","y4","cleanUp","find","heights","coordinate","index","lerp","wayLength","distance","listLength","getEmptyFeatureCollection","MlThreeJsLayer","play","setPlay","modelOrigin","modelAltitude","modelRotate","PI","modelAsMercatorCoordinate","MercatorCoordinate","fromLngLat","modelTransform","translateX","translateY","translateZ","rotateX","rotateY","rotateZ","scale","meterInMercatorCoordinateUnits","customLayer","renderingMode","onAdd","gl","camera","THREE","scene","directionalLight","normalize","directionalLight2","loader","GLTFLoader","load","gltf","bind","renderer","canvas","context","antialias","autoClear","render","matrix","rotationX","makeRotationAxis","rotationY","rotationZ","fromArray","l","makeTranslation","multiply","projectionMatrix","resetState","triggerRepaint","MlVectorTileLayer","layerIdsRef","paintKey","MlWmsLayerMulti"],"mappings":"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"}