const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-CXmEimrv.js","./iframe-Bom5zVKB.js","./preload-helper-D9Z9MdNV.js","./iframe-DG6F43G8.css","./index-B8bAXh5V.js","./index-Bow3mxig.js"])))=>i.map(i=>d[i]);
import{j as Z,P as q_,r as Fd}from"./index-B8bAXh5V.js";import{g as ad,V as jw,r as ee,R as ht,a as hW,c as Np,b as Nb}from"./iframe-Bom5zVKB.js";import{_ as e3}from"./preload-helper-D9Z9MdNV.js";var aw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */var bie=aw.exports,tF;function xie(){return tF||(tF=1,(function(t,e){(function(r,n){t.exports=n()})(bie,(function(){var r={},n={};function i(s,o,u){if(n[s]=u,s==="index"){var h="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",f={};return n.shared(f),n.index(r,f),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([h],{type:"text/javascript"}))),r}}i("shared",["exports"],(function(s){function o(m,c,g,x){return new(g||(g=Promise))((function(C,D){function F(oe){try{Q(x.next(oe))}catch(he){D(he)}}function $(oe){try{Q(x.throw(oe))}catch(he){D(he)}}function Q(oe){var he;oe.done?C(oe.value):(he=oe.value,he instanceof g?he:new g((function(ve){ve(he)}))).then(F,$)}Q((x=x.apply(m,c||[])).next())}))}function u(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var h,f;function d(){if(f)return h;function m(c,g){this.x=c,this.y=g}return f=1,h=m,m.prototype={clone:function(){return new m(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,g){return this.clone()._rotateAround(c,g)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var g=c.x-this.x,x=c.y-this.y;return g*g+x*x},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,g){return Math.atan2(this.x*g-this.y*c,this.x*c+this.y*g)},_matMult:function(c){var g=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=g,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var g=Math.cos(c),x=Math.sin(c),C=x*this.x+g*this.y;return this.x=g*this.x-x*this.y,this.y=C,this},_rotateAround:function(c,g){var x=Math.cos(c),C=Math.sin(c),D=g.y+C*(this.x-g.x)+x*(this.y-g.y);return this.x=g.x+x*(this.x-g.x)-C*(this.y-g.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(c){return c instanceof m?c:Array.isArray(c)?new m(c[0],c[1]):c},h}typeof SuppressedError=="function"&&SuppressedError;var b,v,S=u(d()),E=(function(){if(v)return b;function m(c,g,x,C){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*g,this.by=3*(C-g)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=g,this.p2x=x,this.p2y=C}return v=1,b=m,m.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,g){if(g===void 0&&(g=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,C=0;C<8;C++){var D=this.sampleCurveX(x)-c;if(Math.abs(D)<g)return x;var F=this.sampleCurveDerivativeX(x);if(Math.abs(F)<1e-6)break;x-=D/F}var $=0,Q=1;for(x=c,C=0;C<20&&(D=this.sampleCurveX(x),!(Math.abs(D-c)<g));C++)c>D?$=x:Q=x,x=.5*(Q-$)+$;return x},solve:function(c,g){return this.sampleCurveY(this.solveCurveX(c,g))}},b})(),P=u(E);let k,L;function N(){return k==null&&(k=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),k}function M(){if(L==null&&(L=!1,N())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let x=0;x<25;x++){const C=4*x;c.fillStyle=`rgb(${C},${C+1},${C+2})`,c.fillRect(x%5,Math.floor(x/5),1,1)}const g=c.getImageData(0,0,5,5).data;for(let x=0;x<100;x++)if(x%4!=3&&g[x]!==x){L=!0;break}}}return L||!1}var z=1e-6,B=typeof Float32Array<"u"?Float32Array:Array;function q(){var m=new B(9);return B!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m}function W(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function G(){var m=new B(3);return B!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0),m}function ie(m){return Math.hypot(m[0],m[1],m[2])}function J(m,c,g){var x=new B(3);return x[0]=m,x[1]=c,x[2]=g,x}function H(m,c,g){return m[0]=c[0]+g[0],m[1]=c[1]+g[1],m[2]=c[2]+g[2],m}function ne(m,c,g){return m[0]=c[0]*g,m[1]=c[1]*g,m[2]=c[2]*g,m}function ae(m,c,g){var x=c[0],C=c[1],D=c[2],F=g[0],$=g[1],Q=g[2];return m[0]=C*Q-D*$,m[1]=D*F-x*Q,m[2]=x*$-C*F,m}Math.hypot||(Math.hypot=function(){for(var m=0,c=arguments.length;c--;)m+=arguments[c]*arguments[c];return Math.sqrt(m)});var ue,de=ie;function Pe(m,c,g){var x=c[0],C=c[1],D=c[2],F=c[3];return m[0]=g[0]*x+g[4]*C+g[8]*D+g[12]*F,m[1]=g[1]*x+g[5]*C+g[9]*D+g[13]*F,m[2]=g[2]*x+g[6]*C+g[10]*D+g[14]*F,m[3]=g[3]*x+g[7]*C+g[11]*D+g[15]*F,m}function me(){var m=new B(4);return B!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0),m[3]=1,m}function Ee(m,c,g,x){var C=.5*Math.PI/180;c*=C,g*=C,x*=C;var D=Math.sin(c),F=Math.cos(c),$=Math.sin(g),Q=Math.cos(g),oe=Math.sin(x),he=Math.cos(x);return m[0]=D*Q*he-F*$*oe,m[1]=F*$*he+D*Q*oe,m[2]=F*Q*oe-D*$*he,m[3]=F*Q*he+D*$*oe,m}function we(){var m=new B(2);return B!=Float32Array&&(m[0]=0,m[1]=0),m}function Ae(m,c){var g=new B(2);return g[0]=m,g[1]=c,g}G(),ue=new B(4),B!=Float32Array&&(ue[0]=0,ue[1]=0,ue[2]=0,ue[3]=0),G(),J(1,0,0),J(0,1,0),me(),me(),q(),we();const ce=8192;function xe(m,c,g){return c*(ce/(m.tileSize*Math.pow(2,g-m.tileID.overscaledZ)))}function _e(m,c){return(m%c+c)%c}function Me(m,c,g){return m*(1-g)+c*g}function Re(m){if(m<=0)return 0;if(m>=1)return 1;const c=m*m,g=c*m;return 4*(m<.5?g:3*(m-c)+g-.75)}function He(m,c,g,x){const C=new P(m,c,g,x);return D=>C.solve(D)}const Fe=He(.25,.1,.25,1);function tt(m,c,g){return Math.min(g,Math.max(c,m))}function Ze(m,c,g){const x=g-c,C=((m-c)%x+x)%x+c;return C===c?g:C}function Qe(m,...c){for(const g of c)for(const x in g)m[x]=g[x];return m}let Ie=1;function Lt(m,c,g){const x={};for(const C in m)x[C]=c.call(this,m[C],C,m);return x}function at(m,c,g){const x={};for(const C in m)c.call(this,m[C],C,m)&&(x[C]=m[C]);return x}function Ve(m){return Array.isArray(m)?m.map(Ve):typeof m=="object"&&m?Lt(m,Ve):m}const nr={};function Yt(m){nr[m]||(typeof console<"u"&&console.warn(m),nr[m]=!0)}function yr(m,c,g){return(g.y-m.y)*(c.x-m.x)>(c.y-m.y)*(g.x-m.x)}function mt(m){return typeof WorkerGlobalScope<"u"&&m!==void 0&&m instanceof WorkerGlobalScope}let br=null;function Tr(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const mr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Mr(m,c,g,x,C){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const D=new VideoFrame(m,{timestamp:0});try{const F=D?.format;if(!F||!F.startsWith("BGR")&&!F.startsWith("RGB"))throw new Error(`Unrecognized format ${F}`);const $=F.startsWith("BGR"),Q=new Uint8ClampedArray(x*C*4);if(yield D.copyTo(Q,(function(oe,he,ve,De,je){const $e=4*Math.max(1,0),Xe=(Math.max(0,ve)-ve)*De*4+$e,ot=4*De,vt=Math.max(0,he),Ht=Math.max(0,ve);return{rect:{x:vt,y:Ht,width:Math.min(oe.width,he+De)-vt,height:Math.min(oe.height,ve+je)-Ht},layout:[{offset:Xe,stride:ot}]}})(m,c,g,x,C)),$)for(let oe=0;oe<Q.length;oe+=4){const he=Q[oe];Q[oe]=Q[oe+2],Q[oe+2]=he}return Q}finally{D.close()}}))}let Pr,ar;function fr(m,c,g,x){return m.addEventListener(c,g,x),{unsubscribe:()=>{m.removeEventListener(c,g,x)}}}function Nr(m){return m*Math.PI/180}function or(m){return m/Math.PI*180}const Dr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},er={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Gt="AbortError";function Tt(){return new Error(Gt)}const Oe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Be(m){return Oe.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const Ne="global-dispatcher";class rt extends Error{constructor(c,g,x,C){super(`AJAXError: ${g} (${c}): ${x}`),this.status=c,this.statusText=g,this.url=x,this.body=C}}const pt=()=>mt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Rt=function(m,c){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){const x=Be(m.url);if(x)return x(m,c);if(mt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:m,targetMapId:Ne},c)}if(!(/^file:/.test(g=m.url)||/^file:/.test(pt())&&!/^\w+:/.test(g))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(x,C){return o(this,void 0,void 0,(function*(){const D=new Request(x.url,{method:x.method||"GET",body:x.body,credentials:x.credentials,headers:x.headers,cache:x.cache,referrer:pt(),signal:C.signal});let F,$;x.type!=="json"||D.headers.has("Accept")||D.headers.set("Accept","application/json");try{F=yield fetch(D)}catch(oe){throw new rt(0,oe.message,x.url,new Blob)}if(!F.ok){const oe=yield F.blob();throw new rt(F.status,F.statusText,x.url,oe)}$=x.type==="arrayBuffer"||x.type==="image"?F.arrayBuffer():x.type==="json"?F.json():F.text();const Q=yield $;if(C.signal.aborted)throw Tt();return{data:Q,cacheControl:F.headers.get("Cache-Control"),expires:F.headers.get("Expires")}}))})(m,c);if(mt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:m,mustQueue:!0,targetMapId:Ne},c)}var g;return(function(x,C){return new Promise(((D,F)=>{var $;const Q=new XMLHttpRequest;Q.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||(Q.responseType="arraybuffer");for(const oe in x.headers)Q.setRequestHeader(oe,x.headers[oe]);x.type==="json"&&(Q.responseType="text",!(($=x.headers)===null||$===void 0)&&$.Accept||Q.setRequestHeader("Accept","application/json")),Q.withCredentials=x.credentials==="include",Q.onerror=()=>{F(new Error(Q.statusText))},Q.onload=()=>{if(!C.signal.aborted)if((Q.status>=200&&Q.status<300||Q.status===0)&&Q.response!==null){let oe=Q.response;if(x.type==="json")try{oe=JSON.parse(Q.response)}catch(he){return void F(he)}D({data:oe,cacheControl:Q.getResponseHeader("Cache-Control"),expires:Q.getResponseHeader("Expires")})}else{const oe=new Blob([Q.response],{type:Q.getResponseHeader("Content-Type")});F(new rt(Q.status,Q.statusText,x.url,oe))}},C.signal.addEventListener("abort",(()=>{Q.abort(),F(Tt())})),Q.send(x.body)}))})(m,c)};function Bt(m){if(!m||m.indexOf("://")<=0||m.indexOf("data:image/")===0||m.indexOf("blob:")===0)return!0;const c=new URL(m),g=window.location;return c.protocol===g.protocol&&c.host===g.host}function At(m,c,g){g[m]&&g[m].indexOf(c)!==-1||(g[m]=g[m]||[],g[m].push(c))}function Zt(m,c,g){if(g&&g[m]){const x=g[m].indexOf(c);x!==-1&&g[m].splice(x,1)}}class jt{constructor(c,g={}){Qe(this,g),this.type=c}}class St extends jt{constructor(c,g={}){super("error",Qe({error:c},g))}}class Xt{on(c,g){return this._listeners=this._listeners||{},At(c,g,this._listeners),{unsubscribe:()=>{this.off(c,g)}}}off(c,g){return Zt(c,g,this._listeners),Zt(c,g,this._oneTimeListeners),this}once(c,g){return g?(this._oneTimeListeners=this._oneTimeListeners||{},At(c,g,this._oneTimeListeners),this):new Promise((x=>this.once(c,x)))}fire(c,g){typeof c=="string"&&(c=new jt(c,g||{}));const x=c.type;if(this.listens(x)){c.target=this;const C=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(const $ of C)$.call(this,c);const D=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(const $ of D)Zt(x,$,this._oneTimeListeners),$.call(this,c);const F=this._eventedParent;F&&(Qe(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(c))}else c instanceof St&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,g){return this._eventedParent=c,this._eventedParentData=g,this}}var Ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Lr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qt(m,c){const g={};for(const x in m)x!=="ref"&&(g[x]=m[x]);return Lr.forEach((x=>{x in c&&(g[x]=c[x])})),g}function Zr(m,c){if(Array.isArray(m)){if(!Array.isArray(c)||m.length!==c.length)return!1;for(let g=0;g<m.length;g++)if(!Zr(m[g],c[g]))return!1;return!0}if(typeof m=="object"&&m!==null&&c!==null){if(typeof c!="object"||Object.keys(m).length!==Object.keys(c).length)return!1;for(const g in m)if(!Zr(m[g],c[g]))return!1;return!0}return m===c}function jr(m,c){m.push(c)}function vn(m,c,g){jr(g,{command:"addSource",args:[m,c[m]]})}function Ce(m,c,g){jr(c,{command:"removeSource",args:[m]}),g[m]=!0}function Ue(m,c,g,x){Ce(m,g,x),vn(m,c,g)}function ft(m,c,g){let x;for(x in m[g])if(Object.prototype.hasOwnProperty.call(m[g],x)&&x!=="data"&&!Zr(m[g][x],c[g][x]))return!1;for(x in c[g])if(Object.prototype.hasOwnProperty.call(c[g],x)&&x!=="data"&&!Zr(m[g][x],c[g][x]))return!1;return!0}function Mt(m,c,g,x,C,D){m=m||{},c=c||{};for(const F in m)Object.prototype.hasOwnProperty.call(m,F)&&(Zr(m[F],c[F])||g.push({command:D,args:[x,F,c[F],C]}));for(const F in c)Object.prototype.hasOwnProperty.call(c,F)&&!Object.prototype.hasOwnProperty.call(m,F)&&(Zr(m[F],c[F])||g.push({command:D,args:[x,F,c[F],C]}))}function xr(m){return m.id}function Kr(m,c){return m[c.id]=c,m}class Rr{constructor(c,g,x,C){this.message=(c?`${c}: `:"")+x,C&&(this.identifier=C),g!=null&&g.__line__&&(this.line=g.__line__)}}function di(m,...c){for(const g of c)for(const x in g)m[x]=g[x];return m}class ti extends Error{constructor(c,g){super(g),this.message=g,this.key=c}}class bi{constructor(c,g=[]){this.parent=c,this.bindings={};for(const[x,C]of g)this.bindings[x]=C}concat(c){return new bi(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Ui={kind:"null"},Xr={kind:"number"},_n={kind:"string"},Fn={kind:"boolean"},na={kind:"color"},Ca={kind:"projectionDefinition"},ua={kind:"object"},Mn={kind:"value"},oo={kind:"collator"},_a={kind:"formatted"},Hi={kind:"padding"},Ya={kind:"colorArray"},Xs={kind:"numberArray"},ki={kind:"resolvedImage"},bl={kind:"variableAnchorOffsetCollection"};function zo(m,c){return{kind:"array",itemType:m,N:c}}function xi(m){if(m.kind==="array"){const c=xi(m.itemType);return typeof m.N=="number"?`array<${c}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${c}>`}return m.kind}const So=[Ui,Xr,_n,Fn,na,Ca,_a,ua,zo(Mn),Hi,Xs,Ya,ki,bl];function Fs(m,c){if(c.kind==="error")return null;if(m.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!Fs(m.itemType,c.itemType))&&(typeof m.N!="number"||m.N===c.N))return null}else{if(m.kind===c.kind)return null;if(m.kind==="value"){for(const g of So)if(!Fs(g,c))return null}}return`Expected ${xi(m)} but found ${xi(c)} instead.`}function Mo(m,c){return c.some((g=>g.kind===m.kind))}function so(m,c){return c.some((g=>g==="null"?m===null:g==="array"?Array.isArray(m):g==="object"?m&&!Array.isArray(m)&&typeof m=="object":g===typeof m))}function xl(m,c){return m.kind==="array"&&c.kind==="array"?m.itemType.kind===c.itemType.kind&&typeof m.N=="number":m.kind===c.kind}const Za=.96422,Lc=.82521,cc=4/29,Yo=6/29,Bs=3*Yo*Yo,Ka=Yo*Yo*Yo,Eo=Math.PI/180,Va=180/Math.PI;function wl(m){return(m%=360)<0&&(m+=360),m}function xu([m,c,g,x]){let C,D;const F=K((.2225045*(m=wu(m))+.7168786*(c=wu(c))+.0606169*(g=wu(g)))/1);m===c&&c===g?C=D=F:(C=K((.4360747*m+.3850649*c+.1430804*g)/Za),D=K((.0139322*m+.0971045*c+.7141733*g)/Lc));const $=116*F-16;return[$<0?0:$,500*(C-F),200*(F-D),x]}function wu(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function K(m){return m>Ka?Math.pow(m,1/3):m/Bs+cc}function pe([m,c,g,x]){let C=(m+16)/116,D=isNaN(c)?C:C+c/500,F=isNaN(g)?C:C-g/200;return C=1*Et(C),D=Za*Et(D),F=Lc*Et(F),[Ye(3.1338561*D-1.6168667*C-.4906146*F),Ye(-.9787684*D+1.9161415*C+.033454*F),Ye(.0719453*D-.2289914*C+1.4052427*F),x]}function Ye(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:m>1?1:m}function Et(m){return m>Yo?m*m*m:Bs*(m-cc)}const Ut=Object.hasOwn||function(m,c){return Object.prototype.hasOwnProperty.call(m,c)};function Nt(m,c){return Ut(m,c)?m[c]:void 0}function Qt(m){return parseInt(m.padEnd(2,m),16)/255}function Gr(m,c){return on(c?m/100:m,0,1)}function on(m,c,g){return Math.min(Math.max(c,m),g)}function en(m){return!m.some(Number.isNaN)}const hn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function nn(m,c,g){return m+g*(c-m)}function Xn(m,c,g){return m.map(((x,C)=>nn(x,c[C],g)))}class En{constructor(c,g,x,C=1,D=!0){this.r=c,this.g=g,this.b=x,this.a=C,D||(this.r*=C,this.g*=C,this.b*=C,C||this.overwriteGetter("rgb",[c,g,x,C]))}static parse(c){if(c instanceof En)return c;if(typeof c!="string")return;const g=(function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];const C=Nt(hn,x);if(C){const[F,$,Q]=C;return[F/255,$/255,Q/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){const F=x.length<6?1:2;let $=1;return[Qt(x.slice($,$+=F)),Qt(x.slice($,$+=F)),Qt(x.slice($,$+=F)),Qt(x.slice($,$+F)||"ff")]}if(x.startsWith("rgb")){const F=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(F){const[$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht]=F,Ot=[he||" ",je||" ",ot].join("");if(Ot==="  "||Ot==="  /"||Ot===",,"||Ot===",,,"){const ze=[oe,De,Xe].join(""),nt=ze==="%%%"?100:ze===""?255:0;if(nt){const Ft=[on(+Q/nt,0,1),on(+ve/nt,0,1),on(+$e/nt,0,1),vt?Gr(+vt,Ht):1];if(en(Ft))return Ft}}return}}const D=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(D){const[F,$,Q,oe,he,ve,De,je,$e]=D,Xe=[Q||" ",he||" ",De].join("");if(Xe==="  "||Xe==="  /"||Xe===",,"||Xe===",,,"){const ot=[+$,on(+oe,0,100),on(+ve,0,100),je?Gr(+je,$e):1];if(en(ot))return(function([vt,Ht,Ot,ze]){function nt(Ft){const Sr=(Ft+vt/30)%12,Jr=Ht*Math.min(Ot,1-Ot);return Ot-Jr*Math.max(-1,Math.min(Sr-3,9-Sr,1))}return vt=wl(vt),Ht/=100,Ot/=100,[nt(0),nt(8),nt(4),ze]})(ot)}}})(c);return g?new En(...g,!1):void 0}get rgb(){const{r:c,g,b:x,a:C}=this,D=C||1/0;return this.overwriteGetter("rgb",[c/D,g/D,x/D,C])}get hcl(){return this.overwriteGetter("hcl",(function(c){const[g,x,C,D]=xu(c),F=Math.sqrt(x*x+C*C);return[Math.round(1e4*F)?wl(Math.atan2(C,x)*Va):NaN,F,g,D]})(this.rgb))}get lab(){return this.overwriteGetter("lab",xu(this.rgb))}overwriteGetter(c,g){return Object.defineProperty(this,c,{value:g}),g}toString(){const[c,g,x,C]=this.rgb;return`rgba(${[c,g,x].map((D=>Math.round(255*D))).join(",")},${C})`}static interpolate(c,g,x,C="rgb"){switch(C){case"rgb":{const[D,F,$,Q]=Xn(c.rgb,g.rgb,x);return new En(D,F,$,Q,!1)}case"hcl":{const[D,F,$,Q]=c.hcl,[oe,he,ve,De]=g.hcl;let je,$e;if(isNaN(D)||isNaN(oe))isNaN(D)?isNaN(oe)?je=NaN:(je=oe,$!==1&&$!==0||($e=he)):(je=D,ve!==1&&ve!==0||($e=F));else{let Ot=oe-D;oe>D&&Ot>180?Ot-=360:oe<D&&D-oe>180&&(Ot+=360),je=D+x*Ot}const[Xe,ot,vt,Ht]=(function([Ot,ze,nt,Ft]){return Ot=isNaN(Ot)?0:Ot*Eo,pe([nt,Math.cos(Ot)*ze,Math.sin(Ot)*ze,Ft])})([je,$e??nn(F,he,x),nn($,ve,x),nn(Q,De,x)]);return new En(Xe,ot,vt,Ht,!1)}case"lab":{const[D,F,$,Q]=pe(Xn(c.lab,g.lab,x));return new En(D,F,$,Q,!1)}}}}En.black=new En(0,0,0,1),En.white=new En(1,1,1,1),En.transparent=new En(0,0,0,0),En.red=new En(1,0,0,1);class $n{constructor(c,g,x){this.sensitivity=c?g?"variant":"case":g?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,g){return this.collator.compare(c,g)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ln=["bottom","center","top"];class $r{constructor(c,g,x,C,D,F){this.text=c,this.image=g,this.scale=x,this.fontStack=C,this.textColor=D,this.verticalAlign=F}}class xn{constructor(c){this.sections=c}static fromString(c){return new xn([new $r(c,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((c=>c.text.length!==0||c.image&&c.image.name.length!==0))}static factory(c){return c instanceof xn?c:xn.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map((c=>c.text)).join("")}}class si{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof si)return c;if(typeof c=="number")return new si([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const g of c)if(typeof g!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new si(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,g,x){return new si(Xn(c.values,g.values,x))}}class Li{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Li)return c;if(typeof c=="number")return new Li([c]);if(Array.isArray(c)){for(const g of c)if(typeof g!="number")return;return new Li(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,g,x){return new Li(Xn(c.values,g.values,x))}}class wi{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof wi)return c;if(typeof c=="string"){const x=En.parse(c);return x?new wi([x]):void 0}if(!Array.isArray(c))return;const g=[];for(const x of c){if(typeof x!="string")return;const C=En.parse(x);if(!C)return;g.push(C)}return new wi(g)}toString(){return JSON.stringify(this.values)}static interpolate(c,g,x,C="rgb"){const D=[];if(c.values.length!=g.values.length)throw new Error(`colorArray: Arrays have mismatched length (${c.values.length} vs. ${g.values.length}), cannot interpolate.`);for(let F=0;F<c.values.length;F++)D.push(En.interpolate(c.values[F],g.values[F],x,C));return new wi(D)}}class Vi extends Error{constructor(c){super(c),this.name="RuntimeError"}toJSON(){return this.message}}const Bi=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Pn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Pn)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let g=0;g<c.length;g+=2){const x=c[g],C=c[g+1];if(typeof x!="string"||!Bi.has(x)||!Array.isArray(C)||C.length!==2||typeof C[0]!="number"||typeof C[1]!="number")return}return new Pn(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,g,x){const C=c.values,D=g.values;if(C.length!==D.length)throw new Vi(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${g.toString()}`);const F=[];for(let $=0;$<C.length;$+=2){if(C[$]!==D[$])throw new Vi(`Cannot interpolate values containing mismatched anchors. from[${$}]: ${C[$]}, to[${$}]: ${D[$]}`);F.push(C[$]);const[Q,oe]=C[$+1],[he,ve]=D[$+1];F.push([nn(Q,he,x),nn(oe,ve,x)])}return new Pn(F)}}class $a{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new $a({name:c,available:!1}):null}}class ii{constructor(c,g,x){this.from=c,this.to=g,this.transition=x}static interpolate(c,g,x){return new ii(c,g,x)}static parse(c){return c instanceof ii?c:Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"?new ii(c[0],c[1],c[2]):typeof c=="object"&&typeof c.from=="string"&&typeof c.to=="string"&&typeof c.transition=="number"?new ii(c.from,c.to,c.transition):typeof c=="string"?new ii(c,c,1):void 0}}function Wn(m,c,g,x){return typeof m=="number"&&m>=0&&m<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof g=="number"&&g>=0&&g<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[m,c,g,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[m,c,g,x]:[m,c,g]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ws(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof ii||m instanceof En||m instanceof $n||m instanceof xn||m instanceof si||m instanceof Li||m instanceof wi||m instanceof Pn||m instanceof $a)return!0;if(Array.isArray(m)){for(const c of m)if(!ws(c))return!1;return!0}if(typeof m=="object"){for(const c in m)if(!ws(m[c]))return!1;return!0}return!1}function In(m){if(m===null)return Ui;if(typeof m=="string")return _n;if(typeof m=="boolean")return Fn;if(typeof m=="number")return Xr;if(m instanceof En)return na;if(m instanceof ii)return Ca;if(m instanceof $n)return oo;if(m instanceof xn)return _a;if(m instanceof si)return Hi;if(m instanceof Li)return Xs;if(m instanceof wi)return Ya;if(m instanceof Pn)return bl;if(m instanceof $a)return ki;if(Array.isArray(m)){const c=m.length;let g;for(const x of m){const C=In(x);if(g){if(g===C)continue;g=Mn;break}g=C}return zo(g||Mn,c)}return ua}function Sl(m){const c=typeof m;return m===null?"":c==="string"||c==="number"||c==="boolean"?String(m):m instanceof En||m instanceof ii||m instanceof xn||m instanceof si||m instanceof Li||m instanceof wi||m instanceof Pn||m instanceof $a?m.toString():JSON.stringify(m)}class Na{constructor(c,g){this.type=c,this.value=g}static parse(c,g){if(c.length!==2)return g.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!ws(c[1]))return g.error("invalid value");const x=c[1];let C=In(x);const D=g.expectedType;return C.kind!=="array"||C.N!==0||!D||D.kind!=="array"||typeof D.N=="number"&&D.N!==0||(C=D),new Na(C,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ys={string:_n,number:Xr,boolean:Fn,object:ua};class lo{constructor(c,g){this.type=c,this.args=g}static parse(c,g){if(c.length<2)return g.error("Expected at least one argument.");let x,C=1;const D=c[0];if(D==="array"){let $,Q;if(c.length>2){const oe=c[1];if(typeof oe!="string"||!(oe in Ys)||oe==="object")return g.error('The item type argument of "array" must be one of string, number, boolean',1);$=Ys[oe],C++}else $=Mn;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return g.error('The length argument to "array" must be a positive integer literal',2);Q=c[2],C++}x=zo($,Q)}else{if(!Ys[D])throw new Error(`Types doesn't contain name = ${D}`);x=Ys[D]}const F=[];for(;C<c.length;C++){const $=g.parse(c[C],C,Mn);if(!$)return null;F.push($)}return new lo(x,F)}evaluate(c){for(let g=0;g<this.args.length;g++){const x=this.args[g].evaluate(c);if(!Fs(this.type,In(x)))return x;if(g===this.args.length-1)throw new Vi(`Expected value to be of type ${xi(this.type)}, but found ${xi(In(x))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}const iu={"to-boolean":Fn,"to-color":na,"to-number":Xr,"to-string":_n};class os{constructor(c,g){this.type=c,this.args=g}static parse(c,g){if(c.length<2)return g.error("Expected at least one argument.");const x=c[0];if(!iu[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&c.length!==2)return g.error("Expected one argument.");const C=iu[x],D=[];for(let F=1;F<c.length;F++){const $=g.parse(c[F],F,Mn);if(!$)return null;D.push($)}return new os(C,D)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let g,x;for(const C of this.args){if(g=C.evaluate(c),x=null,g instanceof En)return g;if(typeof g=="string"){const D=c.parseColor(g);if(D)return D}else if(Array.isArray(g)&&(x=g.length<3||g.length>4?`Invalid rgba value ${JSON.stringify(g)}: expected an array containing either three or four numeric values.`:Wn(g[0],g[1],g[2],g[3]),!x))return new En(g[0]/255,g[1]/255,g[2]/255,g[3])}throw new Vi(x||`Could not parse color from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}case"padding":{let g;for(const x of this.args){g=x.evaluate(c);const C=si.parse(g);if(C)return C}throw new Vi(`Could not parse padding from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}case"numberArray":{let g;for(const x of this.args){g=x.evaluate(c);const C=Li.parse(g);if(C)return C}throw new Vi(`Could not parse numberArray from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}case"colorArray":{let g;for(const x of this.args){g=x.evaluate(c);const C=wi.parse(g);if(C)return C}throw new Vi(`Could not parse colorArray from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}case"variableAnchorOffsetCollection":{let g;for(const x of this.args){g=x.evaluate(c);const C=Pn.parse(g);if(C)return C}throw new Vi(`Could not parse variableAnchorOffsetCollection from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}case"number":{let g=null;for(const x of this.args){if(g=x.evaluate(c),g===null)return 0;const C=Number(g);if(!isNaN(C))return C}throw new Vi(`Could not convert ${JSON.stringify(g)} to number.`)}case"formatted":return xn.fromString(Sl(this.args[0].evaluate(c)));case"resolvedImage":return $a.fromString(Sl(this.args[0].evaluate(c)));case"projectionDefinition":return this.args[0].evaluate(c);default:return Sl(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}const ss=["Unknown","Point","LineString","Polygon"];class zl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ss[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let g=this._parseColorCache.get(c);return g||(g=En.parse(c),this._parseColorCache.set(c,g)),g}}class Zs{constructor(c,g,x=[],C,D=new bi,F=[]){this.registry=c,this.path=x,this.key=x.map(($=>`[${$}]`)).join(""),this.scope=D,this.errors=F,this.expectedType=C,this._isConstant=g}parse(c,g,x,C,D={}){return g?this.concat(g,x,C)._parse(c,D):this._parse(c,D)}_parse(c,g){function x(C,D,F){return F==="assert"?new lo(D,[C]):F==="coerce"?new os(D,[C]):C}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const C=c[0];if(typeof C!="string")return this.error(`Expression name must be a string, but found ${typeof C} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const D=this.registry[C];if(D){let F=D.parse(c,this);if(!F)return null;if(this.expectedType){const $=this.expectedType,Q=F.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||Q.kind!=="value"){if($.kind==="projectionDefinition"&&["string","array"].includes(Q.kind)||["color","formatted","resolvedImage"].includes($.kind)&&["value","string"].includes(Q.kind)||["padding","numberArray"].includes($.kind)&&["value","number","array"].includes(Q.kind)||$.kind==="colorArray"&&["value","string","array"].includes(Q.kind)||$.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(Q.kind))F=x(F,$,g.typeAnnotation||"coerce");else if(this.checkSubtype($,Q))return null}else F=x(F,$,g.typeAnnotation||"assert")}if(!(F instanceof Na)&&F.type.kind!=="resolvedImage"&&this._isConstant(F)){const $=new zl;try{F=new Na(F.type,F.evaluate($))}catch(Q){return this.error(Q.message),null}}return F}return this.error(`Unknown expression "${C}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,g,x){const C=typeof c=="number"?this.path.concat(c):this.path,D=x?this.scope.concat(x):this.scope;return new Zs(this.registry,this._isConstant,C,g||null,D,this.errors)}error(c,...g){const x=`${this.key}${g.map((C=>`[${C}]`)).join("")}`;this.errors.push(new ti(x,c))}checkSubtype(c,g){const x=Fs(c,g);return x&&this.error(x),x}}class Ja{constructor(c,g){this.type=g.type,this.bindings=[].concat(c),this.result=g}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const g of this.bindings)c(g[1]);c(this.result)}static parse(c,g){if(c.length<4)return g.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const x=[];for(let D=1;D<c.length-1;D+=2){const F=c[D];if(typeof F!="string")return g.error(`Expected string, but found ${typeof F} instead.`,D);if(/[^a-zA-Z0-9_]/.test(F))return g.error("Variable names must contain only alphanumeric characters or '_'.",D);const $=g.parse(c[D+1],D+1);if(!$)return null;x.push([F,$])}const C=g.parse(c[c.length-1],c.length-1,g.expectedType,x);return C?new Ja(x,C):null}outputDefined(){return this.result.outputDefined()}}class uo{constructor(c,g){this.type=g.type,this.name=c,this.boundExpression=g}static parse(c,g){if(c.length!==2||typeof c[1]!="string")return g.error("'var' expression requires exactly one string literal argument.");const x=c[1];return g.scope.has(x)?new uo(x,g.scope.get(x)):g.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class sa{constructor(c,g,x){this.type=c,this.index=g,this.input=x}static parse(c,g){if(c.length!==3)return g.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=g.parse(c[1],1,Xr),C=g.parse(c[2],2,zo(g.expectedType||Mn));return x&&C?new sa(C.type.itemType,x,C):null}evaluate(c){const g=this.index.evaluate(c),x=this.input.evaluate(c);if(g<0)throw new Vi(`Array index out of bounds: ${g} < 0.`);if(g>=x.length)throw new Vi(`Array index out of bounds: ${g} > ${x.length-1}.`);if(g!==Math.floor(g))throw new Vi(`Array index must be an integer, but found ${g} instead.`);return x[g]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class La{constructor(c,g){this.type=Fn,this.needle=c,this.haystack=g}static parse(c,g){if(c.length!==3)return g.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=g.parse(c[1],1,Mn),C=g.parse(c[2],2,Mn);return x&&C?Mo(x.type,[Fn,_n,Xr,Ui,Mn])?new La(x,C):g.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(x.type)} instead`):null}evaluate(c){const g=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!x)return!1;if(!so(g,["boolean","string","number","null"]))throw new Vi(`Expected first argument to be of type boolean, string, number or null, but found ${xi(In(g))} instead.`);if(!so(x,["string","array"]))throw new Vi(`Expected second argument to be of type array or string, but found ${xi(In(x))} instead.`);return x.indexOf(g)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class se{constructor(c,g,x){this.type=Xr,this.needle=c,this.haystack=g,this.fromIndex=x}static parse(c,g){if(c.length<=2||c.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const x=g.parse(c[1],1,Mn),C=g.parse(c[2],2,Mn);if(!x||!C)return null;if(!Mo(x.type,[Fn,_n,Xr,Ui,Mn]))return g.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(x.type)} instead`);if(c.length===4){const D=g.parse(c[3],3,Xr);return D?new se(x,C,D):null}return new se(x,C)}evaluate(c){const g=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!so(g,["boolean","string","number","null"]))throw new Vi(`Expected first argument to be of type boolean, string, number or null, but found ${xi(In(g))} instead.`);let C;if(this.fromIndex&&(C=this.fromIndex.evaluate(c)),so(x,["string"])){const D=x.indexOf(g,C);return D===-1?-1:[...x.slice(0,D)].length}if(so(x,["array"]))return x.indexOf(g,C);throw new Vi(`Expected second argument to be of type array or string, but found ${xi(In(x))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class qe{constructor(c,g,x,C,D,F){this.inputType=c,this.type=g,this.input=x,this.cases=C,this.outputs=D,this.otherwise=F}static parse(c,g){if(c.length<5)return g.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return g.error("Expected an even number of arguments.");let x,C;g.expectedType&&g.expectedType.kind!=="value"&&(C=g.expectedType);const D={},F=[];for(let oe=2;oe<c.length-1;oe+=2){let he=c[oe];const ve=c[oe+1];Array.isArray(he)||(he=[he]);const De=g.concat(oe);if(he.length===0)return De.error("Expected at least one branch label.");for(const $e of he){if(typeof $e!="number"&&typeof $e!="string")return De.error("Branch labels must be numbers or strings.");if(typeof $e=="number"&&Math.abs($e)>Number.MAX_SAFE_INTEGER)return De.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $e=="number"&&Math.floor($e)!==$e)return De.error("Numeric branch labels must be integer values.");if(x){if(De.checkSubtype(x,In($e)))return null}else x=In($e);if(D[String($e)]!==void 0)return De.error("Branch labels must be unique.");D[String($e)]=F.length}const je=g.parse(ve,oe,C);if(!je)return null;C=C||je.type,F.push(je)}const $=g.parse(c[1],1,Mn);if(!$)return null;const Q=g.parse(c[c.length-1],c.length-1,C);return Q?$.type.kind!=="value"&&g.concat(1).checkSubtype(x,$.type)?null:new qe(x,C,$,D,F,Q):null}evaluate(c){const g=this.input.evaluate(c);return(In(g)===this.inputType&&this.outputs[this.cases[g]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))&&this.otherwise.outputDefined()}}class dt{constructor(c,g,x){this.type=c,this.branches=g,this.otherwise=x}static parse(c,g){if(c.length<4)return g.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return g.error("Expected an odd number of arguments.");let x;g.expectedType&&g.expectedType.kind!=="value"&&(x=g.expectedType);const C=[];for(let F=1;F<c.length-1;F+=2){const $=g.parse(c[F],F,Fn);if(!$)return null;const Q=g.parse(c[F+1],F+1,x);if(!Q)return null;C.push([$,Q]),x=x||Q.type}const D=g.parse(c[c.length-1],c.length-1,x);if(!D)return null;if(!x)throw new Error("Can't infer output type");return new dt(x,C,D)}evaluate(c){for(const[g,x]of this.branches)if(g.evaluate(c))return x.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[g,x]of this.branches)c(g),c(x);c(this.otherwise)}outputDefined(){return this.branches.every((([c,g])=>g.outputDefined()))&&this.otherwise.outputDefined()}}class Vt{constructor(c,g,x,C){this.type=c,this.input=g,this.beginIndex=x,this.endIndex=C}static parse(c,g){if(c.length<=2||c.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const x=g.parse(c[1],1,Mn),C=g.parse(c[2],2,Xr);if(!x||!C)return null;if(!Mo(x.type,[zo(Mn),_n,Mn]))return g.error(`Expected first argument to be of type array or string, but found ${xi(x.type)} instead`);if(c.length===4){const D=g.parse(c[3],3,Xr);return D?new Vt(x.type,x,C,D):null}return new Vt(x.type,x,C)}evaluate(c){const g=this.input.evaluate(c),x=this.beginIndex.evaluate(c);let C;if(this.endIndex&&(C=this.endIndex.evaluate(c)),so(g,["string"]))return[...g].slice(x,C).join("");if(so(g,["array"]))return g.slice(x,C);throw new Vi(`Expected first argument to be of type array or string, but found ${xi(In(g))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function sr(m,c){const g=m.length-1;let x,C,D=0,F=g,$=0;for(;D<=F;)if($=Math.floor((D+F)/2),x=m[$],C=m[$+1],x<=c){if($===g||c<C)return $;D=$+1}else{if(!(x>c))throw new Vi("Input is not a number.");F=$-1}return 0}class Vr{constructor(c,g,x){this.type=c,this.input=g,this.labels=[],this.outputs=[];for(const[C,D]of x)this.labels.push(C),this.outputs.push(D)}static parse(c,g){if(c.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return g.error("Expected an even number of arguments.");const x=g.parse(c[1],1,Xr);if(!x)return null;const C=[];let D=null;g.expectedType&&g.expectedType.kind!=="value"&&(D=g.expectedType);for(let F=1;F<c.length;F+=2){const $=F===1?-1/0:c[F],Q=c[F+1],oe=F,he=F+1;if(typeof $!="number")return g.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',oe);if(C.length&&C[C.length-1][0]>=$)return g.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',oe);const ve=g.parse(Q,he,D);if(!ve)return null;D=D||ve.type,C.push([$,ve])}return new Vr(D,x,C)}evaluate(c){const g=this.labels,x=this.outputs;if(g.length===1)return x[0].evaluate(c);const C=this.input.evaluate(c);if(C<=g[0])return x[0].evaluate(c);const D=g.length;return C>=g[D-1]?x[D-1].evaluate(c):x[sr(g,C)].evaluate(c)}eachChild(c){c(this.input);for(const g of this.outputs)c(g)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function rn(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var kn,Vn,ci=(function(){if(Vn)return kn;function m(c,g,x,C){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*g,this.by=3*(C-g)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=g,this.p2x=x,this.p2y=C}return Vn=1,kn=m,m.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,g){if(g===void 0&&(g=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,C=0;C<8;C++){var D=this.sampleCurveX(x)-c;if(Math.abs(D)<g)return x;var F=this.sampleCurveDerivativeX(x);if(Math.abs(F)<1e-6)break;x-=D/F}var $=0,Q=1;for(x=c,C=0;C<20&&(D=this.sampleCurveX(x),!(Math.abs(D-c)<g));C++)c>D?$=x:Q=x,x=.5*(Q-$)+$;return x},solve:function(c,g){return this.sampleCurveY(this.solveCurveX(c,g))}},kn})(),Ti=rn(ci);class li{constructor(c,g,x,C,D){this.type=c,this.operator=g,this.interpolation=x,this.input=C,this.labels=[],this.outputs=[];for(const[F,$]of D)this.labels.push(F),this.outputs.push($)}static interpolationFactor(c,g,x,C){let D=0;if(c.name==="exponential")D=$i(g,c.base,x,C);else if(c.name==="linear")D=$i(g,1,x,C);else if(c.name==="cubic-bezier"){const F=c.controlPoints;D=new Ti(F[0],F[1],F[2],F[3]).solve($i(g,1,x,C))}return D}static parse(c,g){let[x,C,D,...F]=c;if(!Array.isArray(C)||C.length===0)return g.error("Expected an interpolation type expression.",1);if(C[0]==="linear")C={name:"linear"};else if(C[0]==="exponential"){const oe=C[1];if(typeof oe!="number")return g.error("Exponential interpolation requires a numeric base.",1,1);C={name:"exponential",base:oe}}else{if(C[0]!=="cubic-bezier")return g.error(`Unknown interpolation type ${String(C[0])}`,1,0);{const oe=C.slice(1);if(oe.length!==4||oe.some((he=>typeof he!="number"||he<0||he>1)))return g.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);C={name:"cubic-bezier",controlPoints:oe}}}if(c.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return g.error("Expected an even number of arguments.");if(D=g.parse(D,2,Xr),!D)return null;const $=[];let Q=null;x!=="interpolate-hcl"&&x!=="interpolate-lab"||g.expectedType==Ya?g.expectedType&&g.expectedType.kind!=="value"&&(Q=g.expectedType):Q=na;for(let oe=0;oe<F.length;oe+=2){const he=F[oe],ve=F[oe+1],De=oe+3,je=oe+4;if(typeof he!="number")return g.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',De);if($.length&&$[$.length-1][0]>=he)return g.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',De);const $e=g.parse(ve,je,Q);if(!$e)return null;Q=Q||$e.type,$.push([he,$e])}return xl(Q,Xr)||xl(Q,Ca)||xl(Q,na)||xl(Q,Hi)||xl(Q,Xs)||xl(Q,Ya)||xl(Q,bl)||xl(Q,zo(Xr))?new li(Q,x,C,D,$):g.error(`Type ${xi(Q)} is not interpolatable.`)}evaluate(c){const g=this.labels,x=this.outputs;if(g.length===1)return x[0].evaluate(c);const C=this.input.evaluate(c);if(C<=g[0])return x[0].evaluate(c);const D=g.length;if(C>=g[D-1])return x[D-1].evaluate(c);const F=sr(g,C),$=li.interpolationFactor(this.interpolation,C,g[F],g[F+1]),Q=x[F].evaluate(c),oe=x[F+1].evaluate(c);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return nn(Q,oe,$);case"color":return En.interpolate(Q,oe,$);case"padding":return si.interpolate(Q,oe,$);case"colorArray":return wi.interpolate(Q,oe,$);case"numberArray":return Li.interpolate(Q,oe,$);case"variableAnchorOffsetCollection":return Pn.interpolate(Q,oe,$);case"array":return Xn(Q,oe,$);case"projectionDefinition":return ii.interpolate(Q,oe,$)}case"interpolate-hcl":switch(this.type.kind){case"color":return En.interpolate(Q,oe,$,"hcl");case"colorArray":return wi.interpolate(Q,oe,$,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return En.interpolate(Q,oe,$,"lab");case"colorArray":return wi.interpolate(Q,oe,$,"lab")}}}eachChild(c){c(this.input);for(const g of this.outputs)c(g)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function $i(m,c,g,x){const C=x-g,D=m-g;return C===0?0:c===1?D/C:(Math.pow(c,D)-1)/(Math.pow(c,C)-1)}const Si={color:En.interpolate,number:nn,padding:si.interpolate,numberArray:Li.interpolate,colorArray:wi.interpolate,variableAnchorOffsetCollection:Pn.interpolate,array:Xn};class Ii{constructor(c,g){this.type=c,this.args=g}static parse(c,g){if(c.length<2)return g.error("Expected at least one argument.");let x=null;const C=g.expectedType;C&&C.kind!=="value"&&(x=C);const D=[];for(const $ of c.slice(1)){const Q=g.parse($,1+D.length,x,void 0,{typeAnnotation:"omit"});if(!Q)return null;x=x||Q.type,D.push(Q)}if(!x)throw new Error("No output type");const F=C&&D.some(($=>Fs(C,$.type)));return new Ii(F?Mn:x,D)}evaluate(c){let g,x=null,C=0;for(const D of this.args)if(C++,x=D.evaluate(c),x&&x instanceof $a&&!x.available&&(g||(g=x.name),x=null,C===this.args.length&&(x=g)),x!==null)break;return x}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}function Aa(m,c){return m==="=="||m==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function ca(m,c,g,x){return x.compare(c,g)===0}function ba(m,c,g){const x=m!=="=="&&m!=="!=";return class fW{constructor(D,F,$){this.type=Fn,this.lhs=D,this.rhs=F,this.collator=$,this.hasUntypedArgument=D.type.kind==="value"||F.type.kind==="value"}static parse(D,F){if(D.length!==3&&D.length!==4)return F.error("Expected two or three arguments.");const $=D[0];let Q=F.parse(D[1],1,Mn);if(!Q)return null;if(!Aa($,Q.type))return F.concat(1).error(`"${$}" comparisons are not supported for type '${xi(Q.type)}'.`);let oe=F.parse(D[2],2,Mn);if(!oe)return null;if(!Aa($,oe.type))return F.concat(2).error(`"${$}" comparisons are not supported for type '${xi(oe.type)}'.`);if(Q.type.kind!==oe.type.kind&&Q.type.kind!=="value"&&oe.type.kind!=="value")return F.error(`Cannot compare types '${xi(Q.type)}' and '${xi(oe.type)}'.`);x&&(Q.type.kind==="value"&&oe.type.kind!=="value"?Q=new lo(oe.type,[Q]):Q.type.kind!=="value"&&oe.type.kind==="value"&&(oe=new lo(Q.type,[oe])));let he=null;if(D.length===4){if(Q.type.kind!=="string"&&oe.type.kind!=="string"&&Q.type.kind!=="value"&&oe.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(he=F.parse(D[3],3,oo),!he)return null}return new fW(Q,oe,he)}evaluate(D){const F=this.lhs.evaluate(D),$=this.rhs.evaluate(D);if(x&&this.hasUntypedArgument){const Q=In(F),oe=In($);if(Q.kind!==oe.kind||Q.kind!=="string"&&Q.kind!=="number")throw new Vi(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${Q.kind}, ${oe.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const Q=In(F),oe=In($);if(Q.kind!=="string"||oe.kind!=="string")return c(D,F,$)}return this.collator?g(D,F,$,this.collator.evaluate(D)):c(D,F,$)}eachChild(D){D(this.lhs),D(this.rhs),this.collator&&D(this.collator)}outputDefined(){return!0}}}const Ss=ba("==",(function(m,c,g){return c===g}),ca),Ks=ba("!=",(function(m,c,g){return c!==g}),(function(m,c,g,x){return!ca(0,c,g,x)})),Su=ba("<",(function(m,c,g){return c<g}),(function(m,c,g,x){return x.compare(c,g)<0})),Es=ba(">",(function(m,c,g){return c>g}),(function(m,c,g,x){return x.compare(c,g)>0})),Eu=ba("<=",(function(m,c,g){return c<=g}),(function(m,c,g,x){return x.compare(c,g)<=0})),xa=ba(">=",(function(m,c,g){return c>=g}),(function(m,c,g,x){return x.compare(c,g)>=0}));class Js{constructor(c,g,x){this.type=oo,this.locale=x,this.caseSensitive=c,this.diacriticSensitive=g}static parse(c,g){if(c.length!==2)return g.error("Expected one argument.");const x=c[1];if(typeof x!="object"||Array.isArray(x))return g.error("Collator options argument must be an object.");const C=g.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,Fn);if(!C)return null;const D=g.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,Fn);if(!D)return null;let F=null;return x.locale&&(F=g.parse(x.locale,1,_n),!F)?null:new Js(C,D,F)}evaluate(c){return new $n(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class au{constructor(c,g,x,C,D){this.type=_n,this.number=c,this.locale=g,this.currency=x,this.minFractionDigits=C,this.maxFractionDigits=D}static parse(c,g){if(c.length!==3)return g.error("Expected two arguments.");const x=g.parse(c[1],1,Xr);if(!x)return null;const C=c[2];if(typeof C!="object"||Array.isArray(C))return g.error("NumberFormat options argument must be an object.");let D=null;if(C.locale&&(D=g.parse(C.locale,1,_n),!D))return null;let F=null;if(C.currency&&(F=g.parse(C.currency,1,_n),!F))return null;let $=null;if(C["min-fraction-digits"]&&($=g.parse(C["min-fraction-digits"],1,Xr),!$))return null;let Q=null;return C["max-fraction-digits"]&&(Q=g.parse(C["max-fraction-digits"],1,Xr),!Q)?null:new au(x,D,F,$,Q)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class Ts{constructor(c){this.type=_a,this.sections=c}static parse(c,g){if(c.length<2)return g.error("Expected at least one argument.");const x=c[1];if(!Array.isArray(x)&&typeof x=="object")return g.error("First argument must be an image or text section.");const C=[];let D=!1;for(let F=1;F<=c.length-1;++F){const $=c[F];if(D&&typeof $=="object"&&!Array.isArray($)){D=!1;let Q=null;if($["font-scale"]&&(Q=g.parse($["font-scale"],1,Xr),!Q))return null;let oe=null;if($["text-font"]&&(oe=g.parse($["text-font"],1,zo(_n)),!oe))return null;let he=null;if($["text-color"]&&(he=g.parse($["text-color"],1,na),!he))return null;let ve=null;if($["vertical-align"]){if(typeof $["vertical-align"]=="string"&&!Ln.includes($["vertical-align"]))return g.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${$["vertical-align"]}' instead.`);if(ve=g.parse($["vertical-align"],1,_n),!ve)return null}const De=C[C.length-1];De.scale=Q,De.font=oe,De.textColor=he,De.verticalAlign=ve}else{const Q=g.parse(c[F],1,Mn);if(!Q)return null;const oe=Q.type.kind;if(oe!=="string"&&oe!=="value"&&oe!=="null"&&oe!=="resolvedImage")return g.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");D=!0,C.push({content:Q,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ts(C)}evaluate(c){return new xn(this.sections.map((g=>{const x=g.content.evaluate(c);return In(x)===ki?new $r("",x,null,null,null,g.verticalAlign?g.verticalAlign.evaluate(c):null):new $r(Sl(x),null,g.scale?g.scale.evaluate(c):null,g.font?g.font.evaluate(c).join(","):null,g.textColor?g.textColor.evaluate(c):null,g.verticalAlign?g.verticalAlign.evaluate(c):null)})))}eachChild(c){for(const g of this.sections)c(g.content),g.scale&&c(g.scale),g.font&&c(g.font),g.textColor&&c(g.textColor),g.verticalAlign&&c(g.verticalAlign)}outputDefined(){return!1}}class Da{constructor(c){this.type=ki,this.input=c}static parse(c,g){if(c.length!==2)return g.error("Expected two arguments.");const x=g.parse(c[1],1,_n);return x?new Da(x):g.error("No image name provided.")}evaluate(c){const g=this.input.evaluate(c),x=$a.fromString(g);return x&&c.availableImages&&(x.available=c.availableImages.indexOf(g)>-1),x}eachChild(c){c(this.input)}outputDefined(){return!1}}class To{constructor(c){this.type=Xr,this.input=c}static parse(c,g){if(c.length!==2)return g.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=g.parse(c[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?g.error(`Expected argument of type string or array, but found ${xi(x.type)} instead.`):new To(x):null}evaluate(c){const g=this.input.evaluate(c);if(typeof g=="string")return[...g].length;if(Array.isArray(g))return g.length;throw new Vi(`Expected value to be of type string or array, but found ${xi(In(g))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const ha=8192;function Qs(m,c){const g=(180+m[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,C=Math.pow(2,c.z);return[Math.round(g*C*ha),Math.round(x*C*ha)]}function jl(m,c){const g=Math.pow(2,c.z);return[(C=(m[0]/ha+c.x)/g,360*C-180),(x=(m[1]/ha+c.y)/g,360/Math.PI*Math.atan(Math.exp((180-360*x)*Math.PI/180))-90)];var x,C}function wa(m,c){m[0]=Math.min(m[0],c[0]),m[1]=Math.min(m[1],c[1]),m[2]=Math.max(m[2],c[0]),m[3]=Math.max(m[3],c[1])}function Tu(m,c){return!(m[0]<=c[0]||m[2]>=c[2]||m[1]<=c[1]||m[3]>=c[3])}function Ul(m,c,g){const x=m[0]-c[0],C=m[1]-c[1],D=m[0]-g[0],F=m[1]-g[1];return x*F-D*C==0&&x*D<=0&&C*F<=0}function el(m,c,g,x){return(C=[x[0]-g[0],x[1]-g[1]])[0]*(D=[c[0]-m[0],c[1]-m[1]])[1]-C[1]*D[0]!=0&&!(!$l(m,c,g,x)||!$l(g,x,m,c));var C,D}function Qa(m,c,g){for(const x of g)for(let C=0;C<x.length-1;++C)if(el(m,c,x[C],x[C+1]))return!0;return!1}function Ro(m,c,g=!1){let x=!1;for(const $ of c)for(let Q=0;Q<$.length-1;Q++){if(Ul(m,$[Q],$[Q+1]))return g;(D=$[Q])[1]>(C=m)[1]!=(F=$[Q+1])[1]>C[1]&&C[0]<(F[0]-D[0])*(C[1]-D[1])/(F[1]-D[1])+D[0]&&(x=!x)}var C,D,F;return x}function hc(m,c){for(const g of c)if(Ro(m,g))return!0;return!1}function fc(m,c){for(const g of m)if(!Ro(g,c))return!1;for(let g=0;g<m.length-1;++g)if(Qa(m[g],m[g+1],c))return!1;return!0}function Vl(m,c){for(const g of c)if(fc(m,g))return!0;return!1}function $l(m,c,g,x){const C=x[0]-g[0],D=x[1]-g[1],F=(m[0]-g[0])*D-C*(m[1]-g[1]),$=(c[0]-g[0])*D-C*(c[1]-g[1]);return F>0&&$<0||F<0&&$>0}function Co(m,c,g){const x=[];for(let C=0;C<m.length;C++){const D=[];for(let F=0;F<m[C].length;F++){const $=Qs(m[C][F],g);wa(c,$),D.push($)}x.push(D)}return x}function co(m,c,g){const x=[];for(let C=0;C<m.length;C++){const D=Co(m[C],c,g);x.push(D)}return x}function Cu(m,c,g,x){if(m[0]<g[0]||m[0]>g[2]){const C=.5*x;let D=m[0]-g[0]>C?-x:g[0]-m[0]>C?x:0;D===0&&(D=m[0]-g[2]>C?-x:g[2]-m[0]>C?x:0),m[0]+=D}wa(c,m)}function Ao(m,c,g,x){const C=Math.pow(2,x.z)*ha,D=[x.x*ha,x.y*ha],F=[];for(const $ of m)for(const Q of $){const oe=[Q.x+D[0],Q.y+D[1]];Cu(oe,c,g,C),F.push(oe)}return F}function ql(m,c,g,x){const C=Math.pow(2,x.z)*ha,D=[x.x*ha,x.y*ha],F=[];for(const Q of m){const oe=[];for(const he of Q){const ve=[he.x+D[0],he.y+D[1]];wa(c,ve),oe.push(ve)}F.push(oe)}if(c[2]-c[0]<=C/2){($=c)[0]=$[1]=1/0,$[2]=$[3]=-1/0;for(const Q of F)for(const oe of Q)Cu(oe,c,g,C)}var $;return F}class jo{constructor(c,g){this.type=Fn,this.geojson=c,this.geometries=g}static parse(c,g){if(c.length!==2)return g.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(ws(c[1])){const x=c[1];if(x.type==="FeatureCollection"){const C=[];for(const D of x.features){const{type:F,coordinates:$}=D.geometry;F==="Polygon"&&C.push($),F==="MultiPolygon"&&C.push(...$)}if(C.length)return new jo(x,{type:"MultiPolygon",coordinates:C})}else if(x.type==="Feature"){const C=x.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new jo(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new jo(x,x)}return g.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(g,x){const C=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],F=g.canonicalID();if(x.type==="Polygon"){const $=Co(x.coordinates,D,F),Q=Ao(g.geometry(),C,D,F);if(!Tu(C,D))return!1;for(const oe of Q)if(!Ro(oe,$))return!1}if(x.type==="MultiPolygon"){const $=co(x.coordinates,D,F),Q=Ao(g.geometry(),C,D,F);if(!Tu(C,D))return!1;for(const oe of Q)if(!hc(oe,$))return!1}return!0})(c,this.geometries);if(c.geometryType()==="LineString")return(function(g,x){const C=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],F=g.canonicalID();if(x.type==="Polygon"){const $=Co(x.coordinates,D,F),Q=ql(g.geometry(),C,D,F);if(!Tu(C,D))return!1;for(const oe of Q)if(!fc(oe,$))return!1}if(x.type==="MultiPolygon"){const $=co(x.coordinates,D,F),Q=ql(g.geometry(),C,D,F);if(!Tu(C,D))return!1;for(const oe of Q)if(!Vl(oe,$))return!1}return!0})(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let El=class{constructor(m=[],c=(g,x)=>g<x?-1:g>x?1:0){if(this.data=m,this.length=this.data.length,this.compare=c,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(m){this.data.push(m),this._up(this.length++)}pop(){if(this.length===0)return;const m=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),m}peek(){return this.data[0]}_up(m){const{data:c,compare:g}=this,x=c[m];for(;m>0;){const C=m-1>>1,D=c[C];if(g(x,D)>=0)break;c[m]=D,m=C}c[m]=x}_down(m){const{data:c,compare:g}=this,x=this.length>>1,C=c[m];for(;m<x;){let D=1+(m<<1);const F=D+1;if(F<this.length&&g(c[F],c[D])<0&&(D=F),g(c[D],C)>=0)break;c[m]=c[D],m=D}c[m]=C}};function Ia(m,c,g=0,x=m.length-1,C=rl){for(;x>g;){if(x-g>600){const Q=x-g+1,oe=c-g+1,he=Math.log(Q),ve=.5*Math.exp(2*he/3),De=.5*Math.sqrt(he*ve*(Q-ve)/Q)*(oe-Q/2<0?-1:1);Ia(m,c,Math.max(g,Math.floor(c-oe*ve/Q+De)),Math.min(x,Math.floor(c+(Q-oe)*ve/Q+De)),C)}const D=m[c];let F=g,$=x;for(tl(m,g,c),C(m[x],D)>0&&tl(m,g,x);F<$;){for(tl(m,F,$),F++,$--;C(m[F],D)<0;)F++;for(;C(m[$],D)>0;)$--}C(m[g],D)===0?tl(m,g,$):($++,tl(m,$,x)),$<=c&&(g=$+1),c<=$&&(x=$-1)}}function tl(m,c,g){const x=m[c];m[c]=m[g],m[g]=x}function rl(m,c){return m<c?-1:m>c?1:0}function ls(m,c){if(m.length<=1)return[m];const g=[];let x,C;for(const D of m){const F=Yu(D);F!==0&&(D.area=Math.abs(F),C===void 0&&(C=F<0),C===F<0?(x&&g.push(x),x=[D]):x.push(D))}if(x&&g.push(x),c>1)for(let D=0;D<g.length;D++)g[D].length<=c||(Ia(g[D],c,1,g[D].length-1,ou),g[D]=g[D].slice(0,c));return g}function ou(m,c){return c.area-m.area}function Yu(m){let c=0;for(let g,x,C=0,D=m.length,F=D-1;C<D;F=C++)g=m[C],x=m[F],c+=(x.x-g.x)*(g.y+x.y);return c}const nl=1/298.257223563,su=nl*(2-nl),Au=Math.PI/180;class tr{constructor(c){const g=6378.137*Au*1e3,x=Math.cos(c*Au),C=1/(1-su*(1-x*x)),D=Math.sqrt(C);this.kx=g*D*x,this.ky=g*D*C*(1-su)}distance(c,g){const x=this.wrap(c[0]-g[0])*this.kx,C=(c[1]-g[1])*this.ky;return Math.sqrt(x*x+C*C)}pointOnLine(c,g){let x,C,D,F,$=1/0;for(let Q=0;Q<c.length-1;Q++){let oe=c[Q][0],he=c[Q][1],ve=this.wrap(c[Q+1][0]-oe)*this.kx,De=(c[Q+1][1]-he)*this.ky,je=0;ve===0&&De===0||(je=(this.wrap(g[0]-oe)*this.kx*ve+(g[1]-he)*this.ky*De)/(ve*ve+De*De),je>1?(oe=c[Q+1][0],he=c[Q+1][1]):je>0&&(oe+=ve/this.kx*je,he+=De/this.ky*je)),ve=this.wrap(g[0]-oe)*this.kx,De=(g[1]-he)*this.ky;const $e=ve*ve+De*De;$e<$&&($=$e,x=oe,C=he,D=Q,F=je)}return{point:[x,C],index:D,t:Math.max(0,Math.min(1,F))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function ur(m,c){return c[0]-m[0]}function mn(m){return m[1]-m[0]+1}function Tn(m,c){return m[1]>=m[0]&&m[1]<c}function yi(m,c){if(m[0]>m[1])return[null,null];const g=mn(m);if(c){if(g===2)return[m,null];const C=Math.floor(g/2);return[[m[0],m[0]+C],[m[0]+C,m[1]]]}if(g===1)return[m,null];const x=Math.floor(g/2)-1;return[[m[0],m[0]+x],[m[0]+x+1,m[1]]]}function Rn(m,c){if(!Tn(c,m.length))return[1/0,1/0,-1/0,-1/0];const g=[1/0,1/0,-1/0,-1/0];for(let x=c[0];x<=c[1];++x)wa(g,m[x]);return g}function A(m){const c=[1/0,1/0,-1/0,-1/0];for(const g of m)for(const x of g)wa(c,x);return c}function y(m){return m[0]!==-1/0&&m[1]!==-1/0&&m[2]!==1/0&&m[3]!==1/0}function _(m,c,g){if(!y(m)||!y(c))return NaN;let x=0,C=0;return m[2]<c[0]&&(x=c[0]-m[2]),m[0]>c[2]&&(x=m[0]-c[2]),m[1]>c[3]&&(C=m[1]-c[3]),m[3]<c[1]&&(C=c[1]-m[3]),g.distance([0,0],[x,C])}function I(m,c,g){const x=g.pointOnLine(c,m);return g.distance(m,x.point)}function U(m,c,g,x,C){const D=Math.min(I(m,[g,x],C),I(c,[g,x],C)),F=Math.min(I(g,[m,c],C),I(x,[m,c],C));return Math.min(D,F)}function re(m,c,g,x,C){if(!Tn(c,m.length)||!Tn(x,g.length))return 1/0;let D=1/0;for(let F=c[0];F<c[1];++F){const $=m[F],Q=m[F+1];for(let oe=x[0];oe<x[1];++oe){const he=g[oe],ve=g[oe+1];if(el($,Q,he,ve))return 0;D=Math.min(D,U($,Q,he,ve,C))}}return D}function ye(m,c,g,x,C){if(!Tn(c,m.length)||!Tn(x,g.length))return NaN;let D=1/0;for(let F=c[0];F<=c[1];++F)for(let $=x[0];$<=x[1];++$)if(D=Math.min(D,C.distance(m[F],g[$])),D===0)return D;return D}function ke(m,c,g){if(Ro(m,c,!0))return 0;let x=1/0;for(const C of c){const D=C[0],F=C[C.length-1];if(D!==F&&(x=Math.min(x,I(m,[F,D],g)),x===0))return x;const $=g.pointOnLine(C,m);if(x=Math.min(x,g.distance(m,$.point)),x===0)return x}return x}function Ke(m,c,g,x){if(!Tn(c,m.length))return NaN;for(let D=c[0];D<=c[1];++D)if(Ro(m[D],g,!0))return 0;let C=1/0;for(let D=c[0];D<c[1];++D){const F=m[D],$=m[D+1];for(const Q of g)for(let oe=0,he=Q.length,ve=he-1;oe<he;ve=oe++){const De=Q[ve],je=Q[oe];if(el(F,$,De,je))return 0;C=Math.min(C,U(F,$,De,je,x))}}return C}function yt(m,c){for(const g of m)for(const x of g)if(Ro(x,c,!0))return!0;return!1}function rr(m,c,g,x=1/0){const C=A(m),D=A(c);if(x!==1/0&&_(C,D,g)>=x)return x;if(Tu(C,D)){if(yt(m,c))return 0}else if(yt(c,m))return 0;let F=1/0;for(const $ of m)for(let Q=0,oe=$.length,he=oe-1;Q<oe;he=Q++){const ve=$[he],De=$[Q];for(const je of c)for(let $e=0,Xe=je.length,ot=Xe-1;$e<Xe;ot=$e++){const vt=je[ot],Ht=je[$e];if(el(ve,De,vt,Ht))return 0;F=Math.min(F,U(ve,De,vt,Ht,g))}}return F}function gr(m,c,g,x,C,D){if(!D)return;const F=_(Rn(x,D),C,g);F<c&&m.push([F,D,[0,0]])}function Wr(m,c,g,x,C,D,F){if(!D||!F)return;const $=_(Rn(x,D),Rn(C,F),g);$<c&&m.push([$,D,F])}function wn(m,c,g,x,C=1/0){let D=Math.min(x.distance(m[0],g[0][0]),C);if(D===0)return D;const F=new El([[0,[0,m.length-1],[0,0]]],ur),$=A(g);for(;F.length>0;){const Q=F.pop();if(Q[0]>=D)continue;const oe=Q[1],he=c?50:100;if(mn(oe)<=he){if(!Tn(oe,m.length))return NaN;if(c){const ve=Ke(m,oe,g,x);if(isNaN(ve)||ve===0)return ve;D=Math.min(D,ve)}else for(let ve=oe[0];ve<=oe[1];++ve){const De=ke(m[ve],g,x);if(D=Math.min(D,De),D===0)return 0}}else{const ve=yi(oe,c);gr(F,D,x,m,$,ve[0]),gr(F,D,x,m,$,ve[1])}}return D}function Un(m,c,g,x,C,D=1/0){let F=Math.min(D,C.distance(m[0],g[0]));if(F===0)return F;const $=new El([[0,[0,m.length-1],[0,g.length-1]]],ur);for(;$.length>0;){const Q=$.pop();if(Q[0]>=F)continue;const oe=Q[1],he=Q[2],ve=c?50:100,De=x?50:100;if(mn(oe)<=ve&&mn(he)<=De){if(!Tn(oe,m.length)&&Tn(he,g.length))return NaN;let je;if(c&&x)je=re(m,oe,g,he,C),F=Math.min(F,je);else if(c&&!x){const $e=m.slice(oe[0],oe[1]+1);for(let Xe=he[0];Xe<=he[1];++Xe)if(je=I(g[Xe],$e,C),F=Math.min(F,je),F===0)return F}else if(!c&&x){const $e=g.slice(he[0],he[1]+1);for(let Xe=oe[0];Xe<=oe[1];++Xe)if(je=I(m[Xe],$e,C),F=Math.min(F,je),F===0)return F}else je=ye(m,oe,g,he,C),F=Math.min(F,je)}else{const je=yi(oe,c),$e=yi(he,x);Wr($,F,C,m,g,je[0],$e[0]),Wr($,F,C,m,g,je[0],$e[1]),Wr($,F,C,m,g,je[1],$e[0]),Wr($,F,C,m,g,je[1],$e[1])}}return F}function Kn(m){return m.type==="MultiPolygon"?m.coordinates.map((c=>({type:"Polygon",coordinates:c}))):m.type==="MultiLineString"?m.coordinates.map((c=>({type:"LineString",coordinates:c}))):m.type==="MultiPoint"?m.coordinates.map((c=>({type:"Point",coordinates:c}))):[m]}class jn{constructor(c,g){this.type=Xr,this.geojson=c,this.geometries=g}static parse(c,g){if(c.length!==2)return g.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(ws(c[1])){const x=c[1];if(x.type==="FeatureCollection")return new jn(x,x.features.map((C=>Kn(C.geometry))).flat());if(x.type==="Feature")return new jn(x,Kn(x.geometry));if("type"in x&&"coordinates"in x)return new jn(x,Kn(x))}return g.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(g,x){const C=g.geometry(),D=C.flat().map((Q=>jl([Q.x,Q.y],g.canonical)));if(C.length===0)return NaN;const F=new tr(D[0][1]);let $=1/0;for(const Q of x){switch(Q.type){case"Point":$=Math.min($,Un(D,!1,[Q.coordinates],!1,F,$));break;case"LineString":$=Math.min($,Un(D,!1,Q.coordinates,!0,F,$));break;case"Polygon":$=Math.min($,wn(D,!1,Q.coordinates,F,$))}if($===0)return $}return $})(c,this.geometries);if(c.geometryType()==="LineString")return(function(g,x){const C=g.geometry(),D=C.flat().map((Q=>jl([Q.x,Q.y],g.canonical)));if(C.length===0)return NaN;const F=new tr(D[0][1]);let $=1/0;for(const Q of x){switch(Q.type){case"Point":$=Math.min($,Un(D,!0,[Q.coordinates],!1,F,$));break;case"LineString":$=Math.min($,Un(D,!0,Q.coordinates,!0,F,$));break;case"Polygon":$=Math.min($,wn(D,!0,Q.coordinates,F,$))}if($===0)return $}return $})(c,this.geometries);if(c.geometryType()==="Polygon")return(function(g,x){const C=g.geometry();if(C.length===0||C[0].length===0)return NaN;const D=ls(C,0).map((Q=>Q.map((oe=>oe.map((he=>jl([he.x,he.y],g.canonical))))))),F=new tr(D[0][0][0][1]);let $=1/0;for(const Q of x)for(const oe of D){switch(Q.type){case"Point":$=Math.min($,wn([Q.coordinates],!1,oe,F,$));break;case"LineString":$=Math.min($,wn(Q.coordinates,!0,oe,F,$));break;case"Polygon":$=Math.min($,rr(oe,Q.coordinates,F,$))}if($===0)return $}return $})(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Bn{constructor(c){this.type=Mn,this.key=c}static parse(c,g){if(c.length!==2)return g.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=c[1];return x==null?g.error("Global state property must be defined."):typeof x!="string"?g.error(`Global state property must be string, but found ${typeof c[1]} instead.`):new Bn(x)}evaluate(c){var g;const x=(g=c.globals)===null||g===void 0?void 0:g.globalState;return x&&Object.keys(x).length!==0?Nt(x,this.key):null}eachChild(){}outputDefined(){return!1}}const zi={"==":Ss,"!=":Ks,">":Es,"<":Su,">=":xa,"<=":Eu,array:lo,at:sa,boolean:lo,case:dt,coalesce:Ii,collator:Js,format:Ts,image:Da,in:La,"index-of":se,interpolate:li,"interpolate-hcl":li,"interpolate-lab":li,length:To,let:Ja,literal:Na,match:qe,number:lo,"number-format":au,object:lo,slice:Vt,step:Vr,string:lo,"to-boolean":os,"to-color":os,"to-number":os,"to-string":os,var:uo,within:jo,distance:jn,"global-state":Bn};class Ri{constructor(c,g,x,C){this.name=c,this.type=g,this._evaluate=x,this.args=C}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,g){const x=c[0],C=Ri.definitions[x];if(!C)return g.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const D=Array.isArray(C)?C[0]:C.type,F=Array.isArray(C)?[[C[1],C[2]]]:C.overloads,$=F.filter((([oe])=>!Array.isArray(oe)||oe.length===c.length-1));let Q=null;for(const[oe,he]of $){Q=new Zs(g.registry,Hl,g.path,null,g.scope);const ve=[];let De=!1;for(let je=1;je<c.length;je++){const $e=c[je],Xe=Array.isArray(oe)?oe[je-1]:oe.type,ot=Q.parse($e,1+ve.length,Xe);if(!ot){De=!0;break}ve.push(ot)}if(!De)if(Array.isArray(oe)&&oe.length!==ve.length)Q.error(`Expected ${oe.length} arguments, but found ${ve.length} instead.`);else{for(let je=0;je<ve.length;je++){const $e=Array.isArray(oe)?oe[je]:oe.type,Xe=ve[je];Q.concat(je+1).checkSubtype($e,Xe.type)}if(Q.errors.length===0)return new Ri(x,D,he,ve)}}if($.length===1)g.errors.push(...Q.errors);else{const oe=($.length?$:F).map((([ve])=>{return De=ve,Array.isArray(De)?`(${De.map(xi).join(", ")})`:`(${xi(De.type)}...)`;var De})).join(" | "),he=[];for(let ve=1;ve<c.length;ve++){const De=g.parse(c[ve],1+he.length);if(!De)return null;he.push(xi(De.type))}g.error(`Expected arguments of type ${oe}, but found (${he.join(", ")}) instead.`)}return null}static register(c,g){Ri.definitions=g;for(const x in g)c[x]=Ri}}function ho(m,[c,g,x,C]){c=c.evaluate(m),g=g.evaluate(m),x=x.evaluate(m);const D=C?C.evaluate(m):1,F=Wn(c,g,x,D);if(F)throw new Vi(F);return new En(c/255,g/255,x/255,D,!1)}function fo(m,c){return m in c}function Zo(m,c){const g=c[m];return g===void 0?null:g}function Ko(m){return{type:m}}function Hl(m){if(m instanceof uo)return Hl(m.boundExpression);if(m instanceof Ri&&m.name==="error"||m instanceof Js||m instanceof jo||m instanceof jn||m instanceof Bn)return!1;const c=m instanceof os||m instanceof lo;let g=!0;return m.eachChild((x=>{g=c?g&&Hl(x):g&&x instanceof Na})),!!g&&lu(m)&&Cs(m,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function lu(m){if(m instanceof Ri&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof jo||m instanceof jn)return!1;let c=!0;return m.eachChild((g=>{c&&!lu(g)&&(c=!1)})),c}function il(m){if(m instanceof Ri&&m.name==="feature-state")return!1;let c=!0;return m.eachChild((g=>{c&&!il(g)&&(c=!1)})),c}function Cs(m,c){if(m instanceof Ri&&c.indexOf(m.name)>=0)return!1;let g=!0;return m.eachChild((x=>{g&&!Cs(x,c)&&(g=!1)})),g}function dc(m){return{result:"success",value:m}}function As(m){return{result:"error",value:m}}function qa(m){return m["property-type"]==="data-driven"||m["property-type"]==="cross-faded-data-driven"}function us(m){return!!m.expression&&m.expression.parameters.indexOf("zoom")>-1}function Zu(m){return!!m.expression&&m.expression.interpolated}function Ci(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}function uu(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)&&In(m)===ua}function pc(m){return m}function hd(m,c){const g=m.stops&&typeof m.stops[0][0]=="object",x=g||!(g||m.property!==void 0),C=m.type||(Zu(c)?"exponential":"interval"),D=(function(he){switch(he.type){case"color":return En.parse;case"padding":return si.parse;case"numberArray":return Li.parse;case"colorArray":return wi.parse;default:return null}})(c);if(D&&((m=di({},m)).stops&&(m.stops=m.stops.map((he=>[he[0],D(he[1])]))),m.default=D(m.default?m.default:c.default)),m.colorSpace&&(F=m.colorSpace)!=="rgb"&&F!=="hcl"&&F!=="lab")throw new Error(`Unknown color space: "${m.colorSpace}"`);var F;const $=(function(he){switch(he){case"exponential":return op;case"interval":return pg;case"categorical":return ey;case"identity":return fd;default:throw new Error(`Unknown function type "${he}"`)}})(C);let Q,oe;if(C==="categorical"){Q=Object.create(null);for(const he of m.stops)Q[he[0]]=he[1];oe=typeof m.stops[0][0]}if(g){const he={},ve=[];for(let $e=0;$e<m.stops.length;$e++){const Xe=m.stops[$e],ot=Xe[0].zoom;he[ot]===void 0&&(he[ot]={zoom:ot,type:m.type,property:m.property,default:m.default,stops:[]},ve.push(ot)),he[ot].stops.push([Xe[0].value,Xe[1]])}const De=[];for(const $e of ve)De.push([he[$e].zoom,hd(he[$e],c)]);const je={name:"linear"};return{kind:"composite",interpolationType:je,interpolationFactor:li.interpolationFactor.bind(void 0,je),zoomStops:De.map(($e=>$e[0])),evaluate:({zoom:$e},Xe)=>op({stops:De,base:m.base},c,$e).evaluate($e,Xe)}}if(x){const he=C==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:he,interpolationFactor:li.interpolationFactor.bind(void 0,he),zoomStops:m.stops.map((ve=>ve[0])),evaluate:({zoom:ve})=>$(m,c,ve,Q,oe)}}return{kind:"source",evaluate(he,ve){const De=ve&&ve.properties?ve.properties[m.property]:void 0;return De===void 0?Fh(m.default,c.default):$(m,c,De,Q,oe)}}}function Fh(m,c,g){return m!==void 0?m:c!==void 0?c:g!==void 0?g:void 0}function ey(m,c,g,x,C){return Fh(typeof g===C?x[g]:void 0,m.default,c.default)}function pg(m,c,g){if(Ci(g)!=="number")return Fh(m.default,c.default);const x=m.stops.length;if(x===1||g<=m.stops[0][0])return m.stops[0][1];if(g>=m.stops[x-1][0])return m.stops[x-1][1];const C=sr(m.stops.map((D=>D[0])),g);return m.stops[C][1]}function op(m,c,g){const x=m.base!==void 0?m.base:1;if(Ci(g)!=="number")return Fh(m.default,c.default);const C=m.stops.length;if(C===1||g<=m.stops[0][0])return m.stops[0][1];if(g>=m.stops[C-1][0])return m.stops[C-1][1];const D=sr(m.stops.map((he=>he[0])),g),F=(function(he,ve,De,je){const $e=je-De,Xe=he-De;return $e===0?0:ve===1?Xe/$e:(Math.pow(ve,Xe)-1)/(Math.pow(ve,$e)-1)})(g,x,m.stops[D][0],m.stops[D+1][0]),$=m.stops[D][1],Q=m.stops[D+1][1],oe=Si[c.type]||pc;return typeof $.evaluate=="function"?{evaluate(...he){const ve=$.evaluate.apply(void 0,he),De=Q.evaluate.apply(void 0,he);if(ve!==void 0&&De!==void 0)return oe(ve,De,F,m.colorSpace)}}:oe($,Q,F,m.colorSpace)}function fd(m,c,g){switch(c.type){case"color":g=En.parse(g);break;case"formatted":g=xn.fromString(g.toString());break;case"resolvedImage":g=$a.fromString(g.toString());break;case"padding":g=si.parse(g);break;case"colorArray":g=wi.parse(g);break;case"numberArray":g=Li.parse(g);break;default:Ci(g)===c.type||c.type==="enum"&&c.values[g]||(g=void 0)}return Fh(g,m.default,c.default)}Ri.register(zi,{error:[{kind:"error"},[_n],(m,[c])=>{throw new Vi(c.evaluate(m))}],typeof:[_n,[Mn],(m,[c])=>xi(In(c.evaluate(m)))],"to-rgba":[zo(Xr,4),[na],(m,[c])=>{const[g,x,C,D]=c.evaluate(m).rgb;return[255*g,255*x,255*C,D]}],rgb:[na,[Xr,Xr,Xr],ho],rgba:[na,[Xr,Xr,Xr,Xr],ho],has:{type:Fn,overloads:[[[_n],(m,[c])=>fo(c.evaluate(m),m.properties())],[[_n,ua],(m,[c,g])=>fo(c.evaluate(m),g.evaluate(m))]]},get:{type:Mn,overloads:[[[_n],(m,[c])=>Zo(c.evaluate(m),m.properties())],[[_n,ua],(m,[c,g])=>Zo(c.evaluate(m),g.evaluate(m))]]},"feature-state":[Mn,[_n],(m,[c])=>Zo(c.evaluate(m),m.featureState||{})],properties:[ua,[],m=>m.properties()],"geometry-type":[_n,[],m=>m.geometryType()],id:[Mn,[],m=>m.id()],zoom:[Xr,[],m=>m.globals.zoom],"heatmap-density":[Xr,[],m=>m.globals.heatmapDensity||0],elevation:[Xr,[],m=>m.globals.elevation||0],"line-progress":[Xr,[],m=>m.globals.lineProgress||0],accumulated:[Mn,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[Xr,Ko(Xr),(m,c)=>{let g=0;for(const x of c)g+=x.evaluate(m);return g}],"*":[Xr,Ko(Xr),(m,c)=>{let g=1;for(const x of c)g*=x.evaluate(m);return g}],"-":{type:Xr,overloads:[[[Xr,Xr],(m,[c,g])=>c.evaluate(m)-g.evaluate(m)],[[Xr],(m,[c])=>-c.evaluate(m)]]},"/":[Xr,[Xr,Xr],(m,[c,g])=>c.evaluate(m)/g.evaluate(m)],"%":[Xr,[Xr,Xr],(m,[c,g])=>c.evaluate(m)%g.evaluate(m)],ln2:[Xr,[],()=>Math.LN2],pi:[Xr,[],()=>Math.PI],e:[Xr,[],()=>Math.E],"^":[Xr,[Xr,Xr],(m,[c,g])=>Math.pow(c.evaluate(m),g.evaluate(m))],sqrt:[Xr,[Xr],(m,[c])=>Math.sqrt(c.evaluate(m))],log10:[Xr,[Xr],(m,[c])=>Math.log(c.evaluate(m))/Math.LN10],ln:[Xr,[Xr],(m,[c])=>Math.log(c.evaluate(m))],log2:[Xr,[Xr],(m,[c])=>Math.log(c.evaluate(m))/Math.LN2],sin:[Xr,[Xr],(m,[c])=>Math.sin(c.evaluate(m))],cos:[Xr,[Xr],(m,[c])=>Math.cos(c.evaluate(m))],tan:[Xr,[Xr],(m,[c])=>Math.tan(c.evaluate(m))],asin:[Xr,[Xr],(m,[c])=>Math.asin(c.evaluate(m))],acos:[Xr,[Xr],(m,[c])=>Math.acos(c.evaluate(m))],atan:[Xr,[Xr],(m,[c])=>Math.atan(c.evaluate(m))],min:[Xr,Ko(Xr),(m,c)=>Math.min(...c.map((g=>g.evaluate(m))))],max:[Xr,Ko(Xr),(m,c)=>Math.max(...c.map((g=>g.evaluate(m))))],abs:[Xr,[Xr],(m,[c])=>Math.abs(c.evaluate(m))],round:[Xr,[Xr],(m,[c])=>{const g=c.evaluate(m);return g<0?-Math.round(-g):Math.round(g)}],floor:[Xr,[Xr],(m,[c])=>Math.floor(c.evaluate(m))],ceil:[Xr,[Xr],(m,[c])=>Math.ceil(c.evaluate(m))],"filter-==":[Fn,[_n,Mn],(m,[c,g])=>m.properties()[c.value]===g.value],"filter-id-==":[Fn,[Mn],(m,[c])=>m.id()===c.value],"filter-type-==":[Fn,[_n],(m,[c])=>m.geometryType()===c.value],"filter-<":[Fn,[_n,Mn],(m,[c,g])=>{const x=m.properties()[c.value],C=g.value;return typeof x==typeof C&&x<C}],"filter-id-<":[Fn,[Mn],(m,[c])=>{const g=m.id(),x=c.value;return typeof g==typeof x&&g<x}],"filter->":[Fn,[_n,Mn],(m,[c,g])=>{const x=m.properties()[c.value],C=g.value;return typeof x==typeof C&&x>C}],"filter-id->":[Fn,[Mn],(m,[c])=>{const g=m.id(),x=c.value;return typeof g==typeof x&&g>x}],"filter-<=":[Fn,[_n,Mn],(m,[c,g])=>{const x=m.properties()[c.value],C=g.value;return typeof x==typeof C&&x<=C}],"filter-id-<=":[Fn,[Mn],(m,[c])=>{const g=m.id(),x=c.value;return typeof g==typeof x&&g<=x}],"filter->=":[Fn,[_n,Mn],(m,[c,g])=>{const x=m.properties()[c.value],C=g.value;return typeof x==typeof C&&x>=C}],"filter-id->=":[Fn,[Mn],(m,[c])=>{const g=m.id(),x=c.value;return typeof g==typeof x&&g>=x}],"filter-has":[Fn,[Mn],(m,[c])=>c.value in m.properties()],"filter-has-id":[Fn,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[Fn,[zo(_n)],(m,[c])=>c.value.indexOf(m.geometryType())>=0],"filter-id-in":[Fn,[zo(Mn)],(m,[c])=>c.value.indexOf(m.id())>=0],"filter-in-small":[Fn,[_n,zo(Mn)],(m,[c,g])=>g.value.indexOf(m.properties()[c.value])>=0],"filter-in-large":[Fn,[_n,zo(Mn)],(m,[c,g])=>(function(x,C,D,F){for(;D<=F;){const $=D+F>>1;if(C[$]===x)return!0;C[$]>x?F=$-1:D=$+1}return!1})(m.properties()[c.value],g.value,0,g.value.length-1)],all:{type:Fn,overloads:[[[Fn,Fn],(m,[c,g])=>c.evaluate(m)&&g.evaluate(m)],[Ko(Fn),(m,c)=>{for(const g of c)if(!g.evaluate(m))return!1;return!0}]]},any:{type:Fn,overloads:[[[Fn,Fn],(m,[c,g])=>c.evaluate(m)||g.evaluate(m)],[Ko(Fn),(m,c)=>{for(const g of c)if(g.evaluate(m))return!0;return!1}]]},"!":[Fn,[Fn],(m,[c])=>!c.evaluate(m)],"is-supported-script":[Fn,[_n],(m,[c])=>{const g=m.globals&&m.globals.isSupportedScript;return!g||g(c.evaluate(m))}],upcase:[_n,[_n],(m,[c])=>c.evaluate(m).toUpperCase()],downcase:[_n,[_n],(m,[c])=>c.evaluate(m).toLowerCase()],concat:[_n,Ko(Mn),(m,c)=>c.map((g=>Sl(g.evaluate(m)))).join("")],"resolved-locale":[_n,[oo],(m,[c])=>c.evaluate(m).resolvedLocale()]});class _f{constructor(c,g){this.expression=c,this._warningHistory={},this._evaluator=new zl,this._defaultValue=g?(function(x){if(x.type==="color"&&uu(x.default))return new En(0,0,0,0);switch(x.type){case"color":return En.parse(x.default)||null;case"padding":return si.parse(x.default)||null;case"numberArray":return Li.parse(x.default)||null;case"colorArray":return wi.parse(x.default)||null;case"variableAnchorOffsetCollection":return Pn.parse(x.default)||null;case"projectionDefinition":return ii.parse(x.default)||null;default:return x.default===void 0?null:x.default}})(g):null,this._enumValues=g&&g.type==="enum"?g.values:null}evaluateWithoutErrorHandling(c,g,x,C,D,F){return this._evaluator.globals=c,this._evaluator.feature=g,this._evaluator.featureState=x,this._evaluator.canonical=C,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(c,g,x,C,D,F){this._evaluator.globals=c,this._evaluator.feature=g||null,this._evaluator.featureState=x||null,this._evaluator.canonical=C,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=F||null;try{const $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Vi(`Expected value to be one of ${Object.keys(this._enumValues).map((Q=>JSON.stringify(Q))).join(", ")}, but found ${JSON.stringify($)} instead.`);return $}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}}}function sp(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in zi}function lp(m,c){const g=new Zs(zi,Hl,[],c?(function(C){const D={color:na,string:_n,number:Xr,enum:_n,boolean:Fn,formatted:_a,padding:Hi,numberArray:Xs,colorArray:Ya,projectionDefinition:Ca,resolvedImage:ki,variableAnchorOffsetCollection:bl};return C.type==="array"?zo(D[C.value]||Mn,C.length):D[C.type]})(c):void 0),x=g.parse(m,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?dc(new _f(x,c)):As(g.errors)}class bf{constructor(c,g){this.kind=c,this._styleExpression=g,this.isStateDependent=c!=="constant"&&!il(g.expression),this.globalStateRefs=wf(g.expression)}evaluateWithoutErrorHandling(c,g,x,C,D,F){return this._styleExpression.evaluateWithoutErrorHandling(c,g,x,C,D,F)}evaluate(c,g,x,C,D,F){return this._styleExpression.evaluate(c,g,x,C,D,F)}}class up{constructor(c,g,x,C){this.kind=c,this.zoomStops=x,this._styleExpression=g,this.isStateDependent=c!=="camera"&&!il(g.expression),this.globalStateRefs=wf(g.expression),this.interpolationType=C}evaluateWithoutErrorHandling(c,g,x,C,D,F){return this._styleExpression.evaluateWithoutErrorHandling(c,g,x,C,D,F)}evaluate(c,g,x,C,D,F){return this._styleExpression.evaluate(c,g,x,C,D,F)}interpolationFactor(c,g,x){return this.interpolationType?li.interpolationFactor(this.interpolationType,c,g,x):0}}function gg(m,c){const g=lp(m,c);if(g.result==="error")return g;const x=g.value.expression,C=lu(x);if(!C&&!qa(c))return As([new ti("","data expressions not supported")]);const D=Cs(x,["zoom"]);if(!D&&!us(c))return As([new ti("","zoom expressions not supported")]);const F=xf(x);return F||D?F instanceof ti?As([F]):F instanceof li&&!Zu(c)?As([new ti("",'"interpolate" expressions cannot be used with this property')]):dc(F?new up(C?"camera":"composite",g.value,F.labels,F instanceof li?F.interpolation:void 0):new bf(C?"constant":"source",g.value)):As([new ti("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class dd{constructor(c,g){this._parameters=c,this._specification=g,di(this,hd(this._parameters,this._specification))}static deserialize(c){return new dd(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function xf(m){let c=null;if(m instanceof Ja)c=xf(m.result);else if(m instanceof Ii){for(const g of m.args)if(c=xf(g),c)break}else(m instanceof Vr||m instanceof li)&&m.input instanceof Ri&&m.input.name==="zoom"&&(c=m);return c instanceof ti||m.eachChild((g=>{const x=xf(g);x instanceof ti?c=x:!c&&x?c=new ti("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&x&&c!==x&&(c=new ti("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),c}function wf(m,c=new Set){return m instanceof Bn&&c.add(m.key),m.eachChild((g=>{wf(g,c)})),c}function Bh(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const c of m.slice(1))if(!Bh(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const pd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Iu(m){if(m==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Bh(m)||(m=gd(m));const c=lp(m,pd);if(c.result==="error")throw new Error(c.value.map((g=>`${g.key}: ${g.message}`)).join(", "));return{filter:(g,x,C)=>c.value.evaluate(g,x,{},C),needGeometry:ty(m),getGlobalStateRefs:()=>wf(c.value.expression)}}function W0(m,c){return m<c?-1:m>c?1:0}function ty(m){if(!Array.isArray(m))return!1;if(m[0]==="within"||m[0]==="distance")return!0;for(let c=1;c<m.length;c++)if(ty(m[c]))return!0;return!1}function gd(m){if(!m)return!0;const c=m[0];return m.length<=1?c!=="any":c==="=="?mg(m[1],m[2],"=="):c==="!="?md(mg(m[1],m[2],"==")):c==="<"||c===">"||c==="<="||c===">="?mg(m[1],m[2],c):c==="any"?(g=m.slice(1),["any"].concat(g.map(gd))):c==="all"?["all"].concat(m.slice(1).map(gd)):c==="none"?["all"].concat(m.slice(1).map(gd).map(md)):c==="in"?ry(m[1],m.slice(2)):c==="!in"?md(ry(m[1],m.slice(2))):c==="has"?ny(m[1]):c!=="!has"||md(ny(m[1]));var g}function mg(m,c,g){switch(m){case"$type":return[`filter-type-${g}`,c];case"$id":return[`filter-id-${g}`,c];default:return[`filter-${g}`,m,c]}}function ry(m,c){if(c.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some((g=>typeof g!=typeof c[0]))?["filter-in-large",m,["literal",c.sort(W0)]]:["filter-in-small",m,["literal",c]]}}function ny(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function md(m){return["!",m]}function Ku(m){const c=typeof m;if(c==="number"||c==="boolean"||c==="string"||m==null)return JSON.stringify(m);if(Array.isArray(m)){let C="[";for(const D of m)C+=`${Ku(D)},`;return`${C}]`}const g=Object.keys(m).sort();let x="{";for(let C=0;C<g.length;C++)x+=`${JSON.stringify(g[C])}:${Ku(m[g[C]])},`;return`${x}}`}function Wl(m){let c="";for(const g of Lr)c+=`/${Ku(m[g])}`;return c}function gc(m){const c=m.value;return c?[new Rr(m.key,c,"constants have been deprecated as of v8")]:[]}function Io(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Dc(m){if(Array.isArray(m))return m.map(Dc);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const c={};for(const g in m)c[g]=Dc(m[g]);return c}return Io(m)}function cs(m){const c=m.key,g=m.value,x=m.valueSpec||{},C=m.objectElementValidators||{},D=m.style,F=m.styleSpec,$=m.validateSpec;let Q=[];const oe=Ci(g);if(oe!=="object")return[new Rr(c,g,`object expected, ${oe} found`)];for(const he in g){const ve=he.split(".")[0],De=Nt(x,ve)||x["*"];let je;if(Nt(C,ve))je=C[ve];else if(Nt(x,ve))je=$;else if(C["*"])je=C["*"];else{if(!x["*"]){Q.push(new Rr(c,g[he],`unknown property "${he}"`));continue}je=$}Q=Q.concat(je({key:(c&&`${c}.`)+he,value:g[he],valueSpec:De,style:D,styleSpec:F,object:g,objectKey:he,validateSpec:$},g))}for(const he in x)C[he]||x[he].required&&x[he].default===void 0&&g[he]===void 0&&Q.push(new Rr(c,g,`missing required property "${he}"`));return Q}function Tl(m){const c=m.value,g=m.valueSpec,x=m.style,C=m.styleSpec,D=m.key,F=m.arrayElementValidator||m.validateSpec;if(Ci(c)!=="array")return[new Rr(D,c,`array expected, ${Ci(c)} found`)];if(g.length&&c.length!==g.length)return[new Rr(D,c,`array length ${g.length} expected, length ${c.length} found`)];if(g["min-length"]&&c.length<g["min-length"])return[new Rr(D,c,`array length at least ${g["min-length"]} expected, length ${c.length} found`)];let $={type:g.value,values:g.values};C.$version<7&&($.function=g.function),Ci(g.value)==="object"&&($=g.value);let Q=[];for(let oe=0;oe<c.length;oe++)Q=Q.concat(F({array:c,arrayIndex:oe,value:c[oe],valueSpec:$,validateSpec:m.validateSpec,style:x,styleSpec:C,key:`${D}[${oe}]`}));return Q}function yd(m){const c=m.key,g=m.value,x=m.valueSpec;let C=Ci(g);return C==="number"&&g!=g&&(C="NaN"),C!=="number"?[new Rr(c,g,`number expected, ${C} found`)]:"minimum"in x&&g<x.minimum?[new Rr(c,g,`${g} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&g>x.maximum?[new Rr(c,g,`${g} is greater than the maximum value ${x.maximum}`)]:[]}function Sf(m){const c=m.valueSpec,g=Io(m.value.type);let x,C,D,F={};const $=g!=="categorical"&&m.value.property===void 0,Q=!$,oe=Ci(m.value.stops)==="array"&&Ci(m.value.stops[0])==="array"&&Ci(m.value.stops[0][0])==="object",he=cs({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(je){if(g==="identity")return[new Rr(je.key,je.value,'identity function may not have a "stops" property')];let $e=[];const Xe=je.value;return $e=$e.concat(Tl({key:je.key,value:Xe,valueSpec:je.valueSpec,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,arrayElementValidator:ve})),Ci(Xe)==="array"&&Xe.length===0&&$e.push(new Rr(je.key,Xe,"array must have at least one stop")),$e},default:function(je){return je.validateSpec({key:je.key,value:je.value,valueSpec:c,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec})}}});return g==="identity"&&$&&he.push(new Rr(m.key,m.value,'missing required property "property"')),g==="identity"||m.value.stops||he.push(new Rr(m.key,m.value,'missing required property "stops"')),g==="exponential"&&m.valueSpec.expression&&!Zu(m.valueSpec)&&he.push(new Rr(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(Q&&!qa(m.valueSpec)?he.push(new Rr(m.key,m.value,"property functions not supported")):$&&!us(m.valueSpec)&&he.push(new Rr(m.key,m.value,"zoom functions not supported"))),g!=="categorical"&&!oe||m.value.property!==void 0||he.push(new Rr(m.key,m.value,'"property" property is required')),he;function ve(je){let $e=[];const Xe=je.value,ot=je.key;if(Ci(Xe)!=="array")return[new Rr(ot,Xe,`array expected, ${Ci(Xe)} found`)];if(Xe.length!==2)return[new Rr(ot,Xe,`array length 2 expected, length ${Xe.length} found`)];if(oe){if(Ci(Xe[0])!=="object")return[new Rr(ot,Xe,`object expected, ${Ci(Xe[0])} found`)];if(Xe[0].zoom===void 0)return[new Rr(ot,Xe,"object stop key must have zoom")];if(Xe[0].value===void 0)return[new Rr(ot,Xe,"object stop key must have value")];if(D&&D>Io(Xe[0].zoom))return[new Rr(ot,Xe[0].zoom,"stop zoom values must appear in ascending order")];Io(Xe[0].zoom)!==D&&(D=Io(Xe[0].zoom),C=void 0,F={}),$e=$e.concat(cs({key:`${ot}[0]`,value:Xe[0],valueSpec:{zoom:{}},validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,objectElementValidators:{zoom:yd,value:De}}))}else $e=$e.concat(De({key:`${ot}[0]`,value:Xe[0],validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec},Xe));return sp(Dc(Xe[1]))?$e.concat([new Rr(`${ot}[1]`,Xe[1],"expressions are not allowed in function stops.")]):$e.concat(je.validateSpec({key:`${ot}[1]`,value:Xe[1],valueSpec:c,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec}))}function De(je,$e){const Xe=Ci(je.value),ot=Io(je.value),vt=je.value!==null?je.value:$e;if(x){if(Xe!==x)return[new Rr(je.key,vt,`${Xe} stop domain type must match previous stop domain type ${x}`)]}else x=Xe;if(Xe!=="number"&&Xe!=="string"&&Xe!=="boolean")return[new Rr(je.key,vt,"stop domain value must be a number, string, or boolean")];if(Xe!=="number"&&g!=="categorical"){let Ht=`number expected, ${Xe} found`;return qa(c)&&g===void 0&&(Ht+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rr(je.key,vt,Ht)]}return g!=="categorical"||Xe!=="number"||isFinite(ot)&&Math.floor(ot)===ot?g!=="categorical"&&Xe==="number"&&C!==void 0&&ot<C?[new Rr(je.key,vt,"stop domain values must appear in ascending order")]:(C=ot,g==="categorical"&&ot in F?[new Rr(je.key,vt,"stop domain values must be unique")]:(F[ot]=!0,[])):[new Rr(je.key,vt,`integer expected, found ${ot}`)]}}function zh(m){const c=(m.expressionContext==="property"?gg:lp)(Dc(m.value),m.valueSpec);if(c.result==="error")return c.value.map((x=>new Rr(`${m.key}${x.key}`,m.value,x.message)));const g=c.value.expression||c.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!g.outputDefined())return[new Rr(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!il(g))return[new Rr(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter"&&!il(g))return[new Rr(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!Cs(g,["zoom","feature-state"]))return[new Rr(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!lu(g))return[new Rr(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cp(m){const c=m.key,g=m.value,x=Ci(g);return x!=="string"?[new Rr(c,g,`color expected, ${x} found`)]:En.parse(String(g))?[]:[new Rr(c,g,`color expected, "${g}" found`)]}function Ef(m){const c=m.key,g=m.value,x=m.valueSpec,C=[];return Array.isArray(x.values)?x.values.indexOf(Io(g))===-1&&C.push(new Rr(c,g,`expected one of [${x.values.join(", ")}], ${JSON.stringify(g)} found`)):Object.keys(x.values).indexOf(Io(g))===-1&&C.push(new Rr(c,g,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(g)} found`)),C}function hp(m){return Bh(Dc(m.value))?zh(di({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):iy(m)}function iy(m){const c=m.value,g=m.key;if(Ci(c)!=="array")return[new Rr(g,c,`array expected, ${Ci(c)} found`)];const x=m.styleSpec;let C,D=[];if(c.length<1)return[new Rr(g,c,"filter array must have at least 1 element")];switch(D=D.concat(Ef({key:`${g}[0]`,value:c[0],valueSpec:x.filter_operator,style:m.style,styleSpec:m.styleSpec})),Io(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Io(c[1])==="$type"&&D.push(new Rr(g,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&D.push(new Rr(g,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(C=Ci(c[1]),C!=="string"&&D.push(new Rr(`${g}[1]`,c[1],`string expected, ${C} found`)));for(let F=2;F<c.length;F++)C=Ci(c[F]),Io(c[1])==="$type"?D=D.concat(Ef({key:`${g}[${F}]`,value:c[F],valueSpec:x.geometry_type,style:m.style,styleSpec:m.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&D.push(new Rr(`${g}[${F}]`,c[F],`string, number, or boolean expected, ${C} found`));break;case"any":case"all":case"none":for(let F=1;F<c.length;F++)D=D.concat(iy({key:`${g}[${F}]`,value:c[F],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":C=Ci(c[1]),c.length!==2?D.push(new Rr(g,c,`filter array for "${c[0]}" operator must have 2 elements`)):C!=="string"&&D.push(new Rr(`${g}[1]`,c[1],`string expected, ${C} found`))}return D}function vd(m,c){const g=m.key,x=m.validateSpec,C=m.style,D=m.styleSpec,F=m.value,$=m.objectKey,Q=D[`${c}_${m.layerType}`];if(!Q)return[];const oe=$.match(/^(.*)-transition$/);if(c==="paint"&&oe&&Q[oe[1]]&&Q[oe[1]].transition)return x({key:g,value:F,valueSpec:D.transition,style:C,styleSpec:D});const he=m.valueSpec||Q[$];if(!he)return[new Rr(g,F,`unknown property "${$}"`)];let ve;if(Ci(F)==="string"&&qa(he)&&!he.tokens&&(ve=/^{([^}]+)}$/.exec(F)))return[new Rr(g,F,`"${$}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ve[1])} }\`.`)];const De=[];return m.layerType==="symbol"&&($==="text-field"&&C&&!C.glyphs&&De.push(new Rr(g,F,'use of "text-field" requires a style "glyphs" property')),$==="text-font"&&uu(Dc(F))&&Io(F.type)==="identity"&&De.push(new Rr(g,F,'"text-font" does not support identity functions'))),De.concat(x({key:m.key,value:F,valueSpec:he,style:C,styleSpec:D,expressionContext:"property",propertyType:c,propertyKey:$}))}function Fc(m){return vd(m,"paint")}function mc(m){return vd(m,"layout")}function al(m){let c=[];const g=m.value,x=m.key,C=m.style,D=m.styleSpec;if(Ci(g)!=="object")return[new Rr(x,g,`object expected, ${Ci(g)} found`)];g.type||g.ref||c.push(new Rr(x,g,'either "type" or "ref" is required'));let F=Io(g.type);const $=Io(g.ref);if(g.id){const Q=Io(g.id);for(let oe=0;oe<m.arrayIndex;oe++){const he=C.layers[oe];Io(he.id)===Q&&c.push(new Rr(x,g.id,`duplicate layer id "${g.id}", previously used at line ${he.id.__line__}`))}}if("ref"in g){let Q;["type","source","source-layer","filter","layout"].forEach((oe=>{oe in g&&c.push(new Rr(x,g[oe],`"${oe}" is prohibited for ref layers`))})),C.layers.forEach((oe=>{Io(oe.id)===$&&(Q=oe)})),Q?Q.ref?c.push(new Rr(x,g.ref,"ref cannot reference another ref layer")):F=Io(Q.type):c.push(new Rr(x,g.ref,`ref layer "${$}" not found`))}else if(F!=="background")if(g.source){const Q=C.sources&&C.sources[g.source],oe=Q&&Io(Q.type);Q?oe==="vector"&&F==="raster"?c.push(new Rr(x,g.source,`layer "${g.id}" requires a raster source`)):oe!=="raster-dem"&&F==="hillshade"||oe!=="raster-dem"&&F==="color-relief"?c.push(new Rr(x,g.source,`layer "${g.id}" requires a raster-dem source`)):oe==="raster"&&F!=="raster"?c.push(new Rr(x,g.source,`layer "${g.id}" requires a vector source`)):oe!=="vector"||g["source-layer"]?oe==="raster-dem"&&F!=="hillshade"&&F!=="color-relief"?c.push(new Rr(x,g.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):F!=="line"||!g.paint||!g.paint["line-gradient"]||oe==="geojson"&&Q.lineMetrics||c.push(new Rr(x,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new Rr(x,g,`layer "${g.id}" must specify a "source-layer"`)):c.push(new Rr(x,g.source,`source "${g.source}" not found`))}else c.push(new Rr(x,g,'missing required property "source"'));return c=c.concat(cs({key:x,value:g,valueSpec:D.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:`${x}.type`,value:g.type,valueSpec:D.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:g,objectKey:"type"}),filter:hp,layout:Q=>cs({layer:g,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":oe=>mc(di({layerType:F},oe))}}),paint:Q=>cs({layer:g,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":oe=>Fc(di({layerType:F},oe))}})}})),c}function Ju(m){const c=m.value,g=m.key,x=Ci(c);return x!=="string"?[new Rr(g,c,`string expected, ${x} found`)]:[]}const fp={promoteId:function({key:m,value:c}){if(Ci(c)==="string")return Ju({key:m,value:c});{const g=[];for(const x in c)g.push(...Ju({key:`${m}.${x}`,value:c[x]}));return g}}};function ay(m){const c=m.value,g=m.key,x=m.styleSpec,C=m.style,D=m.validateSpec;if(!c.type)return[new Rr(g,c,'"type" is required')];const F=Io(c.type);let $;switch(F){case"vector":case"raster":return $=cs({key:g,value:c,valueSpec:x[`source_${F.replace("-","_")}`],style:m.style,styleSpec:x,objectElementValidators:fp,validateSpec:D}),$;case"raster-dem":return $=(function(Q){var oe;const he=(oe=Q.sourceName)!==null&&oe!==void 0?oe:"",ve=Q.value,De=Q.styleSpec,je=De.source_raster_dem,$e=Q.style;let Xe=[];const ot=Ci(ve);if(ve===void 0)return Xe;if(ot!=="object")return Xe.push(new Rr("source_raster_dem",ve,`object expected, ${ot} found`)),Xe;const vt=Io(ve.encoding)==="custom",Ht=["redFactor","greenFactor","blueFactor","baseShift"],Ot=Q.value.encoding?`"${Q.value.encoding}"`:"Default";for(const ze in ve)!vt&&Ht.includes(ze)?Xe.push(new Rr(ze,ve[ze],`In "${he}": "${ze}" is only valid when "encoding" is set to "custom". ${Ot} encoding found`)):je[ze]?Xe=Xe.concat(Q.validateSpec({key:ze,value:ve[ze],valueSpec:je[ze],validateSpec:Q.validateSpec,style:$e,styleSpec:De})):Xe.push(new Rr(ze,ve[ze],`unknown property "${ze}"`));return Xe})({sourceName:g,value:c,style:m.style,styleSpec:x,validateSpec:D}),$;case"geojson":if($=cs({key:g,value:c,valueSpec:x.source_geojson,style:C,styleSpec:x,validateSpec:D,objectElementValidators:fp}),c.cluster)for(const Q in c.clusterProperties){const[oe,he]=c.clusterProperties[Q],ve=typeof oe=="string"?[oe,["accumulated"],["get",Q]]:oe;$.push(...zh({key:`${g}.${Q}.map`,value:he,expressionContext:"cluster-map"})),$.push(...zh({key:`${g}.${Q}.reduce`,value:ve,expressionContext:"cluster-reduce"}))}return $;case"video":return cs({key:g,value:c,valueSpec:x.source_video,style:C,validateSpec:D,styleSpec:x});case"image":return cs({key:g,value:c,valueSpec:x.source_image,style:C,validateSpec:D,styleSpec:x});case"canvas":return[new Rr(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ef({key:`${g}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function oy(m){const c=m.value,g=m.styleSpec,x=g.light,C=m.style;let D=[];const F=Ci(c);if(c===void 0)return D;if(F!=="object")return D=D.concat([new Rr("light",c,`object expected, ${F} found`)]),D;for(const $ in c){const Q=$.match(/^(.*)-transition$/);D=D.concat(Q&&x[Q[1]]&&x[Q[1]].transition?m.validateSpec({key:$,value:c[$],valueSpec:g.transition,validateSpec:m.validateSpec,style:C,styleSpec:g}):x[$]?m.validateSpec({key:$,value:c[$],valueSpec:x[$],validateSpec:m.validateSpec,style:C,styleSpec:g}):[new Rr($,c[$],`unknown property "${$}"`)])}return D}function Tf(m){const c=m.value,g=m.styleSpec,x=g.sky,C=m.style,D=Ci(c);if(c===void 0)return[];if(D!=="object")return[new Rr("sky",c,`object expected, ${D} found`)];let F=[];for(const $ in c)F=F.concat(x[$]?m.validateSpec({key:$,value:c[$],valueSpec:x[$],style:C,styleSpec:g}):[new Rr($,c[$],`unknown property "${$}"`)]);return F}function yg(m){const c=m.value,g=m.styleSpec,x=g.terrain,C=m.style;let D=[];const F=Ci(c);if(c===void 0)return D;if(F!=="object")return D=D.concat([new Rr("terrain",c,`object expected, ${F} found`)]),D;for(const $ in c)D=D.concat(x[$]?m.validateSpec({key:$,value:c[$],valueSpec:x[$],validateSpec:m.validateSpec,style:C,styleSpec:g}):[new Rr($,c[$],`unknown property "${$}"`)]);return D}function dp(m){let c=[];const g=m.value,x=m.key;if(Array.isArray(g)){const C=[],D=[];for(const F in g)g[F].id&&C.includes(g[F].id)&&c.push(new Rr(x,g,`all the sprites' ids must be unique, but ${g[F].id} is duplicated`)),C.push(g[F].id),g[F].url&&D.includes(g[F].url)&&c.push(new Rr(x,g,`all the sprites' URLs must be unique, but ${g[F].url} is duplicated`)),D.push(g[F].url),c=c.concat(cs({key:`${x}[${F}]`,value:g[F],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return c}return Ju({key:x,value:g})}function sy(m){return c=m.value,c&&c.constructor===Object?[]:[new Rr(m.key,m.value,`object expected, ${Ci(m.value)} found`)];var c}const _d={"*":()=>[],array:Tl,boolean:function(m){const c=m.value,g=m.key,x=Ci(c);return x!=="boolean"?[new Rr(g,c,`boolean expected, ${x} found`)]:[]},number:yd,color:cp,constants:gc,enum:Ef,filter:hp,function:Sf,layer:al,object:cs,source:ay,light:oy,sky:Tf,terrain:yg,projection:function(m){const c=m.value,g=m.styleSpec,x=g.projection,C=m.style,D=Ci(c);if(c===void 0)return[];if(D!=="object")return[new Rr("projection",c,`object expected, ${D} found`)];let F=[];for(const $ in c)F=F.concat(x[$]?m.validateSpec({key:$,value:c[$],valueSpec:x[$],style:C,styleSpec:g}):[new Rr($,c[$],`unknown property "${$}"`)]);return F},projectionDefinition:function(m){const c=m.key;let g=m.value;g=g instanceof String?g.valueOf():g;const x=Ci(g);return x!=="array"||(function(C){return Array.isArray(C)&&C.length===3&&typeof C[0]=="string"&&typeof C[1]=="string"&&typeof C[2]=="number"})(g)||(function(C){return!!["interpolate","step","literal"].includes(C[0])})(g)?["array","string"].includes(x)?[]:[new Rr(c,g,`projection expected, invalid type "${x}" found`)]:[new Rr(c,g,`projection expected, invalid array ${JSON.stringify(g)} found`)]},string:Ju,formatted:function(m){return Ju(m).length===0?[]:zh(m)},resolvedImage:function(m){return Ju(m).length===0?[]:zh(m)},padding:function(m){const c=m.key,g=m.value;if(Ci(g)==="array"){if(g.length<1||g.length>4)return[new Rr(c,g,`padding requires 1 to 4 values; ${g.length} values found`)];const x={type:"number"};let C=[];for(let D=0;D<g.length;D++)C=C.concat(m.validateSpec({key:`${c}[${D}]`,value:g[D],validateSpec:m.validateSpec,valueSpec:x}));return C}return yd({key:c,value:g,valueSpec:{}})},numberArray:function(m){const c=m.key,g=m.value;if(Ci(g)==="array"){const x={type:"number"};if(g.length<1)return[new Rr(c,g,"array length at least 1 expected, length 0 found")];let C=[];for(let D=0;D<g.length;D++)C=C.concat(m.validateSpec({key:`${c}[${D}]`,value:g[D],validateSpec:m.validateSpec,valueSpec:x}));return C}return yd({key:c,value:g,valueSpec:{}})},colorArray:function(m){const c=m.key,g=m.value;if(Ci(g)==="array"){if(g.length<1)return[new Rr(c,g,"array length at least 1 expected, length 0 found")];let x=[];for(let C=0;C<g.length;C++)x=x.concat(cp({key:`${c}[${C}]`,value:g[C]}));return x}return cp({key:c,value:g})},variableAnchorOffsetCollection:function(m){const c=m.key,g=m.value,x=Ci(g),C=m.styleSpec;if(x!=="array"||g.length<1||g.length%2!=0)return[new Rr(c,g,"variableAnchorOffsetCollection requires a non-empty array of even length")];let D=[];for(let F=0;F<g.length;F+=2)D=D.concat(Ef({key:`${c}[${F}]`,value:g[F],valueSpec:C.layout_symbol["text-anchor"]})),D=D.concat(Tl({key:`${c}[${F+1}]`,value:g[F+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:C}));return D},sprite:dp,state:sy};function jh(m){const c=m.value,g=m.valueSpec,x=m.styleSpec;return m.validateSpec=jh,g.expression&&uu(Io(c))?Sf(m):g.expression&&sp(Dc(c))?zh(m):g.type&&_d[g.type]?_d[g.type](m):cs(di({},m,{valueSpec:g.type?x[g.type]:g}))}function Cf(m){const c=m.value,g=m.key,x=Ju(m);return x.length||(c.indexOf("{fontstack}")===-1&&x.push(new Rr(g,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&x.push(new Rr(g,c,'"glyphs" url must include a "{range}" token'))),x}function Pu(m,c=Ct){let g=[];return g=g.concat(jh({key:"",value:m,valueSpec:c.$root,styleSpec:c,style:m,validateSpec:jh,objectElementValidators:{glyphs:Cf,"*":()=>[]}})),m.constants&&(g=g.concat(gc({key:"constants",value:m.constants}))),V(g)}function ku(m){return function(c){return m({...c,validateSpec:jh})}}function V(m){return[].concat(m).sort(((c,g)=>c.line-g.line))}function Y(m){return function(...c){return V(m.apply(this,c))}}Pu.source=Y(ku(ay)),Pu.sprite=Y(ku(dp)),Pu.glyphs=Y(ku(Cf)),Pu.light=Y(ku(oy)),Pu.sky=Y(ku(Tf)),Pu.terrain=Y(ku(yg)),Pu.state=Y(ku(sy)),Pu.layer=Y(ku(al)),Pu.filter=Y(ku(hp)),Pu.paintProperty=Y(ku(Fc)),Pu.layoutProperty=Y(ku(mc));const fe=Pu,Te=fe.light,We=fe.sky,Je=fe.paintProperty,et=fe.layoutProperty;function it(m,c){let g=!1;if(c&&c.length)for(const x of c)m.fire(new St(new Error(x.message))),g=!0;return g}class ct{constructor(c,g,x){const C=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const F=new Int32Array(this.arrayBuffer);c=F[0],this.d=(g=F[1])+2*(x=F[2]);for(let Q=0;Q<this.d*this.d;Q++){const oe=F[3+Q],he=F[3+Q+1];C.push(oe===he?null:F.subarray(oe,he))}const $=F[3+C.length+1];this.keys=F.subarray(F[3+C.length],$),this.bboxes=F.subarray($),this.insert=this._insertReadonly}else{this.d=g+2*x;for(let F=0;F<this.d*this.d;F++)C.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=c,this.padding=x,this.scale=g/c,this.uid=0;const D=x/g*c;this.min=-D,this.max=c+D}insert(c,g,x,C,D){this._forEachCell(g,x,C,D,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(D)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,g,x,C,D,F){this.cells[D].push(F)}query(c,g,x,C,D){const F=this.min,$=this.max;if(c<=F&&g<=F&&$<=x&&$<=C&&!D)return Array.prototype.slice.call(this.keys);{const Q=[];return this._forEachCell(c,g,x,C,this._queryCell,Q,{},D),Q}}_queryCell(c,g,x,C,D,F,$,Q){const oe=this.cells[D];if(oe!==null){const he=this.keys,ve=this.bboxes;for(let De=0;De<oe.length;De++){const je=oe[De];if($[je]===void 0){const $e=4*je;(Q?Q(ve[$e+0],ve[$e+1],ve[$e+2],ve[$e+3]):c<=ve[$e+2]&&g<=ve[$e+3]&&x>=ve[$e+0]&&C>=ve[$e+1])?($[je]=!0,F.push(he[je])):$[je]=!1}}}}_forEachCell(c,g,x,C,D,F,$,Q){const oe=this._convertToCellCoord(c),he=this._convertToCellCoord(g),ve=this._convertToCellCoord(x),De=this._convertToCellCoord(C);for(let je=oe;je<=ve;je++)for(let $e=he;$e<=De;$e++){const Xe=this.d*$e+je;if((!Q||Q(this._convertFromCellCoord(je),this._convertFromCellCoord($e),this._convertFromCellCoord(je+1),this._convertFromCellCoord($e+1)))&&D.call(this,c,g,x,C,Xe,F,$,Q))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,g=3+this.cells.length+1+1;let x=0;for(let F=0;F<this.cells.length;F++)x+=this.cells[F].length;const C=new Int32Array(g+x+this.keys.length+this.bboxes.length);C[0]=this.extent,C[1]=this.n,C[2]=this.padding;let D=g;for(let F=0;F<c.length;F++){const $=c[F];C[3+F]=D,C.set($,D),D+=$.length}return C[3+c.length]=D,C.set(this.keys,D),D+=this.keys.length,C[3+c.length+1]=D,C.set(this.bboxes,D),D+=this.bboxes.length,C.buffer}static serialize(c,g){const x=c.toArrayBuffer();return g&&g.push(x),{buffer:x}}static deserialize(c){return new ct(c.buffer)}}const bt={};function xt(m,c,g={}){if(bt[m])throw new Error(`${m} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:m,writeable:!1}),bt[m]={klass:c,omit:g.omit||[],shallow:g.shallow||[]}}xt("Object",Object),xt("Set",Set),xt("TransferableGridIndex",ct),xt("Color",En),xt("Error",Error),xt("AJAXError",rt),xt("ResolvedImage",$a),xt("StylePropertyFunction",dd),xt("StyleExpression",_f,{omit:["_evaluator"]}),xt("ZoomDependentExpression",up),xt("ZoomConstantExpression",bf),xt("CompoundExpression",Ri,{omit:["_evaluate"]});for(const m in zi)zi[m]._classRegistryKey||xt(`Expression_${m}`,zi[m]);function kr(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function wt(m){return m.$name||m.constructor._classRegistryKey}function ir(m){return!(function(c){if(c===null||typeof c!="object")return!1;const g=wt(c);return!(!g||g==="Object")})(m)&&(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||kr(m)||Tr(m)||ArrayBuffer.isView(m)||m instanceof ImageData)}function dr(m,c){if(ir(m))return(kr(m)||Tr(m))&&c&&c.push(m),ArrayBuffer.isView(m)&&c&&c.push(m.buffer),m instanceof ImageData&&c&&c.push(m.data.buffer),m;if(Array.isArray(m)){const D=[];for(const F of m)D.push(dr(F,c));return D}if(typeof m!="object")throw new Error("can't serialize object of type "+typeof m);const g=wt(m);if(!g)throw new Error(`can't serialize object of unregistered class ${m.constructor.name}`);if(!bt[g])throw new Error(`${g} is not registered.`);const{klass:x}=bt[g],C=x.serialize?x.serialize(m,c):{};if(x.serialize){if(c&&C===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const D in m){if(!m.hasOwnProperty(D)||bt[g].omit.indexOf(D)>=0)continue;const F=m[D];C[D]=bt[g].shallow.indexOf(D)>=0?F:dr(F,c)}m instanceof Error&&(C.message=m.message)}if(C.$name)throw new Error("$name property is reserved for worker serialization logic.");return g!=="Object"&&(C.$name=g),C}function Ur(m){if(ir(m))return m;if(Array.isArray(m))return m.map(Ur);if(typeof m!="object")throw new Error("can't deserialize object of type "+typeof m);const c=wt(m)||"Object";if(!bt[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:g}=bt[c];if(!g)throw new Error(`can't deserialize unregistered class ${c}`);if(g.deserialize)return g.deserialize(m);const x=Object.create(g.prototype);for(const C of Object.keys(m)){if(C==="$name")continue;const D=m[C];x[C]=bt[c].shallow.indexOf(C)>=0?D:Ur(D)}return x}class Cr{constructor(){this.first=!0}update(c,g){const x=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=g):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=g),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=x,!0))}}const wr={"Latin-1 Supplement":m=>m>=128&&m<=255,"Hangul Jamo":m=>m>=4352&&m<=4607,Khmer:m=>m>=6016&&m<=6143,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Kanbun:m=>m>=12688&&m<=12703,"CJK Strokes":m=>m>=12736&&m<=12783,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Hangul Syllables":m=>m>=44032&&m<=55215,"Private Use Area":m=>m>=57344&&m<=63743,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519};function qr(m){for(const c of m)if(Yn(c.charCodeAt(0)))return!0;return!1}function fn(m){for(const c of m)if(!Gn(c.charCodeAt(0)))return!1;return!0}function an(m){const c=m.map((g=>{try{return new RegExp(`\\p{sc=${g}}`,"u").source}catch{return null}})).filter((g=>g));return new RegExp(c.join("|"),"u")}const ri=an(["Arab","Dupl","Mong","Ougr","Syrc"]);function Gn(m){return!ri.test(String.fromCodePoint(m))}const Oi=an(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Yn(m){return!(m!==746&&m!==747&&(m<4352||!(wr["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||wr["CJK Compatibility"](m)||wr["CJK Strokes"](m)||!(!wr["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||wr["Enclosed CJK Letters and Months"](m)||wr["Ideographic Description Characters"](m)||wr.Kanbun(m)||wr.Katakana(m)&&m!==12540||!(!wr["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!wr["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||wr["Vertical Forms"](m)||wr["Yijing Hexagram Symbols"](m)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(m))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(m))||Oi.test(String.fromCodePoint(m)))))}function Zi(m){return!(Yn(m)||(function(c){return!!(wr["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||wr["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||wr["Letterlike Symbols"](c)||wr["Number Forms"](c)||wr["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||wr["Control Pictures"](c)&&c!==9251||wr["Optical Character Recognition"](c)||wr["Enclosed Alphanumerics"](c)||wr["Geometric Shapes"](c)||wr["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||wr["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||wr["CJK Symbols and Punctuation"](c)||wr.Katakana(c)||wr["Private Use Area"](c)||wr["CJK Compatibility Forms"](c)||wr["Small Form Variants"](c)||wr["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)})(m))}const Jo=an(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Pi(m){return Jo.test(String.fromCodePoint(m))}function Jn(m,c){return!(!c&&Pi(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||wr.Khmer(m))}function Cn(m){for(const c of m)if(Pi(c.charCodeAt(0)))return!0;return!1}const Pa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(m){if(Pa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(m,c){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(m.pluginStatus!=="loading")return this.setState(m),m;const g=m.pluginURL,x=new Promise((D=>{this.loadScriptResolve=D}));c(g);const C=new Promise((D=>setTimeout((()=>D()),this.TIMEOUT)));if(yield Promise.race([x,C]),this.isParsed()){const D={pluginStatus:"loaded",pluginURL:g};return this.setState(D),D}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${g}`)}))}};class qn{constructor(c,g){this.zoom=c,g?(this.now=g.now||0,this.fadeDuration=g.fadeDuration||0,this.zoomHistory=g.zoomHistory||new Cr,this.transition=g.transition||{},this.globalState=g.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cr,this.transition={},this.globalState={})}isSupportedScript(c){return(function(g,x){for(const C of g)if(!Jn(C.charCodeAt(0),x))return!1;return!0})(c,Pa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,g=c-Math.floor(c),x=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:g+(1-g)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*g}}}class Wi{constructor(c,g){this.property=c,this.value=g,this.expression=(function(x,C){if(uu(x))return new dd(x,C);if(sp(x)){const D=gg(x,C);if(D.result==="error")throw new Error(D.value.map((F=>`${F.key}: ${F.message}`)).join(", "));return D.value}{let D=x;return C.type==="color"&&typeof x=="string"?D=En.parse(x):C.type!=="padding"||typeof x!="number"&&!Array.isArray(x)?C.type!=="numberArray"||typeof x!="number"&&!Array.isArray(x)?C.type!=="colorArray"||typeof x!="string"&&!Array.isArray(x)?C.type==="variableAnchorOffsetCollection"&&Array.isArray(x)?D=Pn.parse(x):C.type==="projectionDefinition"&&typeof x=="string"&&(D=ii.parse(x)):D=wi.parse(x):D=Li.parse(x):D=si.parse(x),{globalStateRefs:new Set,kind:"constant",evaluate:()=>D}}})(g===void 0?c.specification.default:g,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(c,g,x){return this.property.possiblyEvaluate(this,c,g,x)}}class ka{constructor(c){this.property=c,this.value=new Wi(c,void 0)}transitioned(c,g){return new ol(this.property,this.value,g,Qe({},c.transition,this.transition),c.now)}untransitioned(){return new ol(this.property,this.value,null,{},0)}}class hs{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return Ve(this._values[c].value.value)}setValue(c,g){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new ka(this._values[c].property)),this._values[c].value=new Wi(this._values[c].property,g===null?void 0:Ve(g))}getTransition(c){return Ve(this._values[c].transition)}setTransition(c,g){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new ka(this._values[c].property)),this._values[c].transition=Ve(g)||void 0}serialize(){const c={};for(const g of Object.keys(this._values)){const x=this.getValue(g);x!==void 0&&(c[g]=x);const C=this.getTransition(g);C!==void 0&&(c[`${g}-transition`]=C)}return c}transitioned(c,g){const x=new Po(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].transitioned(c,g._values[C]);return x}untransitioned(){const c=new Po(this._properties);for(const g of Object.keys(this._values))c._values[g]=this._values[g].untransitioned();return c}}class ol{constructor(c,g,x,C,D){this.property=c,this.value=g,this.begin=D+C.delay||0,this.end=this.begin+C.duration||0,c.specification.transition&&(C.delay||C.duration)&&(this.prior=x)}possiblyEvaluate(c,g,x){const C=c.now||0,D=this.value.possiblyEvaluate(c,g,x),F=this.prior;if(F){if(C>this.end)return this.prior=null,D;if(this.value.isDataDriven())return this.prior=null,D;if(C<this.begin)return F.possiblyEvaluate(c,g,x);{const $=(C-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(c,g,x),D,Re($))}}return D}}class Po{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,g,x){const C=new Oo(this._properties);for(const D of Object.keys(this._values))C._values[D]=this._values[D].possiblyEvaluate(c,g,x);return C}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class sl{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return Ve(this._values[c].value)}setValue(c,g){this._values[c]=new Wi(this._values[c].property,g===null?void 0:Ve(g))}serialize(){const c={};for(const g of Object.keys(this._values)){const x=this.getValue(g);x!==void 0&&(c[g]=x)}return c}possiblyEvaluate(c,g,x){const C=new Oo(this._properties);for(const D of Object.keys(this._values))C._values[D]=this._values[D].possiblyEvaluate(c,g,x);return C}}class po{constructor(c,g,x){this.property=c,this.value=g,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,g,x,C){return this.property.evaluate(this.value,this.parameters,c,g,x,C)}}class Oo{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class sn{constructor(c){this.specification=c}possiblyEvaluate(c,g){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(g)}interpolate(c,g,x){const C=Si[this.specification.type];return C?C(c,g,x):c}}class Sn{constructor(c,g){this.specification=c,this.overrides=g}possiblyEvaluate(c,g,x,C){return new po(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(g,null,{},x,C)}:c.expression,g)}interpolate(c,g,x){if(c.value.kind!=="constant"||g.value.kind!=="constant")return c;if(c.value.value===void 0||g.value.value===void 0)return new po(this,{kind:"constant",value:void 0},c.parameters);const C=Si[this.specification.type];if(C){const D=C(c.value.value,g.value.value,x);return new po(this,{kind:"constant",value:D},c.parameters)}return c}evaluate(c,g,x,C,D,F){return c.kind==="constant"?c.value:c.evaluate(g,x,C,D,F)}}class eo extends Sn{possiblyEvaluate(c,g,x,C){if(c.value===void 0)return new po(this,{kind:"constant",value:void 0},g);if(c.expression.kind==="constant"){const D=c.expression.evaluate(g,null,{},x,C),F=c.property.specification.type==="resolvedImage"&&typeof D!="string"?D.name:D,$=this._calculate(F,F,F,g);return new po(this,{kind:"constant",value:$},g)}if(c.expression.kind==="camera"){const D=this._calculate(c.expression.evaluate({zoom:g.zoom-1}),c.expression.evaluate({zoom:g.zoom}),c.expression.evaluate({zoom:g.zoom+1}),g);return new po(this,{kind:"constant",value:D},g)}return new po(this,c.expression,g)}evaluate(c,g,x,C,D,F){if(c.kind==="source"){const $=c.evaluate(g,x,C,D,F);return this._calculate($,$,$,g)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(g.zoom)-1},x,C),c.evaluate({zoom:Math.floor(g.zoom)},x,C),c.evaluate({zoom:Math.floor(g.zoom)+1},x,C),g):c.value}_calculate(c,g,x,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:c,to:g}:{from:x,to:g}}interpolate(c){return c}}class ga{constructor(c){this.specification=c}possiblyEvaluate(c,g,x,C){if(c.value!==void 0){if(c.expression.kind==="constant"){const D=c.expression.evaluate(g,null,{},x,C);return this._calculate(D,D,D,g)}return this._calculate(c.expression.evaluate(new qn(Math.floor(g.zoom-1),g)),c.expression.evaluate(new qn(Math.floor(g.zoom),g)),c.expression.evaluate(new qn(Math.floor(g.zoom+1),g)),g)}}_calculate(c,g,x,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:c,to:g}:{from:x,to:g}}interpolate(c){return c}}class Uo{constructor(c){this.specification=c}possiblyEvaluate(c,g,x,C){return!!c.expression.evaluate(g,null,{},x,C)}interpolate(){return!1}}class to{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const g in c){const x=c[g];x.specification.overridable&&this.overridableProperties.push(g);const C=this.defaultPropertyValues[g]=new Wi(x,void 0),D=this.defaultTransitionablePropertyValues[g]=new ka(x);this.defaultTransitioningPropertyValues[g]=D.untransitioned(),this.defaultPossiblyEvaluatedValues[g]=C.possiblyEvaluate({})}}}xt("DataDrivenProperty",Sn),xt("DataConstantProperty",sn),xt("CrossFadedDataDrivenProperty",eo),xt("CrossFadedProperty",ga),xt("ColorRampProperty",Uo);const No="-transition";class Sa extends Xt{constructor(c,g){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter,this._featureFilter=Iu(c.filter)),g.layout&&(this._unevaluatedLayout=new sl(g.layout)),g.paint)){this._transitionablePaint=new hs(g.paint);for(const x in c.paint)this.setPaintProperty(x,c.paint[x],{validate:!1});for(const x in c.layout)this.setLayoutProperty(x,c.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oo(g.paint)}}setFilter(c){this.filter=c,this._featureFilter=Iu(c)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}getLayoutAffectingGlobalStateRefs(){const c=new Set;if(this._unevaluatedLayout)for(const g in this._unevaluatedLayout._values){const x=this._unevaluatedLayout._values[g];for(const C of x.getGlobalStateRefs())c.add(C)}for(const g of this._featureFilter.getGlobalStateRefs())c.add(g);return c}setLayoutProperty(c,g,x={}){g!=null&&this._validate(et,`layers.${this.id}.layout.${c}`,c,g,x)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,g):this.visibility=g)}getPaintProperty(c){return c.endsWith(No)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,g,x={}){if(g!=null&&this._validate(Je,`layers.${this.id}.paint.${c}`,c,g,x))return!1;if(c.endsWith(No))return this._transitionablePaint.setTransition(c.slice(0,-11),g||void 0),!1;{const C=this._transitionablePaint._values[c],D=C.property.specification["property-type"]==="cross-faded-data-driven",F=C.value.isDataDriven(),$=C.value;this._transitionablePaint.setValue(c,g),this._handleSpecialPaintPropertyUpdate(c);const Q=this._transitionablePaint._values[c].value;return Q.isDataDriven()||F||D||this._handleOverridablePaintPropertyUpdate(c,$,Q)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,g,x){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,g){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,g)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),at(c,((g,x)=>!(g===void 0||x==="layout"&&!Object.keys(g).length||x==="paint"&&!Object.keys(g).length)))}_validate(c,g,x,C,D={}){return(!D||D.validate!==!1)&&it(this,c.call(fe,{key:g,layerType:this.type,objectKey:x,value:C,styleSpec:Ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const g=this.paint.get(c);if(g instanceof po&&qa(g.property.specification)&&(g.value.kind==="source"||g.value.kind==="composite")&&g.value.isStateDependent)return!0}return!1}}const Ma={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ro{constructor(c,g){this._structArray=c,this._pos1=g*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ia{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,g){return c._trim(),g&&(c.isTransferred=!0,g.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const g=Object.create(this.prototype);return g.arrayBuffer=c.arrayBuffer,g.length=c.length,g.capacity=c.arrayBuffer.byteLength/g.bytesPerElement,g._refreshViews(),g}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const g=this.uint8;this._refreshViews(),g&&this.uint8.set(g)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ki(m,c=1){let g=0,x=0;return{members:m.map((C=>{const D=Ma[C.type].BYTES_PER_ELEMENT,F=g=Gl(g,Math.max(c,D)),$=C.components||1;return x=Math.max(x,D),g+=D*$,{name:C.name,type:C.type,components:$,offset:F}})),size:Gl(g,Math.max(x,c)),alignment:c}}function Gl(m,c){return Math.ceil(m/c)*c}class Qo extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g){const x=this.length;return this.resize(x+1),this.emplace(x,c,g)}emplace(c,g,x){const C=2*c;return this.int16[C+0]=g,this.int16[C+1]=x,c}}Qo.prototype.bytesPerElement=4,xt("StructArrayLayout2i4",Qo);class Vo extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x){const C=this.length;return this.resize(C+1),this.emplace(C,c,g,x)}emplace(c,g,x,C){const D=3*c;return this.int16[D+0]=g,this.int16[D+1]=x,this.int16[D+2]=C,c}}Vo.prototype.bytesPerElement=6,xt("StructArrayLayout3i6",Vo);class Cl extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C){const D=this.length;return this.resize(D+1),this.emplace(D,c,g,x,C)}emplace(c,g,x,C,D){const F=4*c;return this.int16[F+0]=g,this.int16[F+1]=x,this.int16[F+2]=C,this.int16[F+3]=D,c}}Cl.prototype.bytesPerElement=8,xt("StructArrayLayout4i8",Cl);class Ea extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F){const $=this.length;return this.resize($+1),this.emplace($,c,g,x,C,D,F)}emplace(c,g,x,C,D,F,$){const Q=6*c;return this.int16[Q+0]=g,this.int16[Q+1]=x,this.int16[Q+2]=C,this.int16[Q+3]=D,this.int16[Q+4]=F,this.int16[Q+5]=$,c}}Ea.prototype.bytesPerElement=12,xt("StructArrayLayout2i4i12",Ea);class fs extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F){const $=this.length;return this.resize($+1),this.emplace($,c,g,x,C,D,F)}emplace(c,g,x,C,D,F,$){const Q=4*c,oe=8*c;return this.int16[Q+0]=g,this.int16[Q+1]=x,this.uint8[oe+4]=C,this.uint8[oe+5]=D,this.uint8[oe+6]=F,this.uint8[oe+7]=$,c}}fs.prototype.bytesPerElement=8,xt("StructArrayLayout2i4ub8",fs);class Al extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g){const x=this.length;return this.resize(x+1),this.emplace(x,c,g)}emplace(c,g,x){const C=2*c;return this.float32[C+0]=g,this.float32[C+1]=x,c}}Al.prototype.bytesPerElement=8,xt("StructArrayLayout2f8",Al);class Bc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F,$,Q,oe,he){const ve=this.length;return this.resize(ve+1),this.emplace(ve,c,g,x,C,D,F,$,Q,oe,he)}emplace(c,g,x,C,D,F,$,Q,oe,he,ve){const De=10*c;return this.uint16[De+0]=g,this.uint16[De+1]=x,this.uint16[De+2]=C,this.uint16[De+3]=D,this.uint16[De+4]=F,this.uint16[De+5]=$,this.uint16[De+6]=Q,this.uint16[De+7]=oe,this.uint16[De+8]=he,this.uint16[De+9]=ve,c}}Bc.prototype.bytesPerElement=20,xt("StructArrayLayout10ui20",Bc);class Mu extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F,$,Q,oe,he,ve,De){const je=this.length;return this.resize(je+1),this.emplace(je,c,g,x,C,D,F,$,Q,oe,he,ve,De)}emplace(c,g,x,C,D,F,$,Q,oe,he,ve,De,je){const $e=12*c;return this.int16[$e+0]=g,this.int16[$e+1]=x,this.int16[$e+2]=C,this.int16[$e+3]=D,this.uint16[$e+4]=F,this.uint16[$e+5]=$,this.uint16[$e+6]=Q,this.uint16[$e+7]=oe,this.int16[$e+8]=he,this.int16[$e+9]=ve,this.int16[$e+10]=De,this.int16[$e+11]=je,c}}Mu.prototype.bytesPerElement=24,xt("StructArrayLayout4i4ui4i24",Mu);class ds extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g,x){const C=this.length;return this.resize(C+1),this.emplace(C,c,g,x)}emplace(c,g,x,C){const D=3*c;return this.float32[D+0]=g,this.float32[D+1]=x,this.float32[D+2]=C,c}}ds.prototype.bytesPerElement=12,xt("StructArrayLayout3f12",ds);class R extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const g=this.length;return this.resize(g+1),this.emplace(g,c)}emplace(c,g){return this.uint32[1*c+0]=g,c}}R.prototype.bytesPerElement=4,xt("StructArrayLayout1ul4",R);class l extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F,$,Q,oe){const he=this.length;return this.resize(he+1),this.emplace(he,c,g,x,C,D,F,$,Q,oe)}emplace(c,g,x,C,D,F,$,Q,oe,he){const ve=10*c,De=5*c;return this.int16[ve+0]=g,this.int16[ve+1]=x,this.int16[ve+2]=C,this.int16[ve+3]=D,this.int16[ve+4]=F,this.int16[ve+5]=$,this.uint32[De+3]=Q,this.uint16[ve+8]=oe,this.uint16[ve+9]=he,c}}l.prototype.bytesPerElement=20,xt("StructArrayLayout6i1ul2ui20",l);class p extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F){const $=this.length;return this.resize($+1),this.emplace($,c,g,x,C,D,F)}emplace(c,g,x,C,D,F,$){const Q=6*c;return this.int16[Q+0]=g,this.int16[Q+1]=x,this.int16[Q+2]=C,this.int16[Q+3]=D,this.int16[Q+4]=F,this.int16[Q+5]=$,c}}p.prototype.bytesPerElement=12,xt("StructArrayLayout2i2i2i12",p);class w extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D){const F=this.length;return this.resize(F+1),this.emplace(F,c,g,x,C,D)}emplace(c,g,x,C,D,F){const $=4*c,Q=8*c;return this.float32[$+0]=g,this.float32[$+1]=x,this.float32[$+2]=C,this.int16[Q+6]=D,this.int16[Q+7]=F,c}}w.prototype.bytesPerElement=16,xt("StructArrayLayout2f1f2i16",w);class T extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F){const $=this.length;return this.resize($+1),this.emplace($,c,g,x,C,D,F)}emplace(c,g,x,C,D,F,$){const Q=16*c,oe=4*c,he=8*c;return this.uint8[Q+0]=g,this.uint8[Q+1]=x,this.float32[oe+1]=C,this.float32[oe+2]=D,this.int16[he+6]=F,this.int16[he+7]=$,c}}T.prototype.bytesPerElement=16,xt("StructArrayLayout2ub2f2i16",T);class O extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g,x){const C=this.length;return this.resize(C+1),this.emplace(C,c,g,x)}emplace(c,g,x,C){const D=3*c;return this.uint16[D+0]=g,this.uint16[D+1]=x,this.uint16[D+2]=C,c}}O.prototype.bytesPerElement=6,xt("StructArrayLayout3ui6",O);class j extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt)}emplace(c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht){const Ot=24*c,ze=12*c,nt=48*c;return this.int16[Ot+0]=g,this.int16[Ot+1]=x,this.uint16[Ot+2]=C,this.uint16[Ot+3]=D,this.uint32[ze+2]=F,this.uint32[ze+3]=$,this.uint32[ze+4]=Q,this.uint16[Ot+10]=oe,this.uint16[Ot+11]=he,this.uint16[Ot+12]=ve,this.float32[ze+7]=De,this.float32[ze+8]=je,this.uint8[nt+36]=$e,this.uint8[nt+37]=Xe,this.uint8[nt+38]=ot,this.uint32[ze+10]=vt,this.int16[Ot+22]=Ht,c}}j.prototype.bytesPerElement=48,xt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",j);class X extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht,Ot,ze,nt,Ft,Sr,Jr,Or,Fr,ln,Qr){const cn=this.length;return this.resize(cn+1),this.emplace(cn,c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht,Ot,ze,nt,Ft,Sr,Jr,Or,Fr,ln,Qr)}emplace(c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht,Ot,ze,nt,Ft,Sr,Jr,Or,Fr,ln,Qr,cn){const zr=32*c,zn=16*c;return this.int16[zr+0]=g,this.int16[zr+1]=x,this.int16[zr+2]=C,this.int16[zr+3]=D,this.int16[zr+4]=F,this.int16[zr+5]=$,this.int16[zr+6]=Q,this.int16[zr+7]=oe,this.uint16[zr+8]=he,this.uint16[zr+9]=ve,this.uint16[zr+10]=De,this.uint16[zr+11]=je,this.uint16[zr+12]=$e,this.uint16[zr+13]=Xe,this.uint16[zr+14]=ot,this.uint16[zr+15]=vt,this.uint16[zr+16]=Ht,this.uint16[zr+17]=Ot,this.uint16[zr+18]=ze,this.uint16[zr+19]=nt,this.uint16[zr+20]=Ft,this.uint16[zr+21]=Sr,this.uint16[zr+22]=Jr,this.uint32[zn+12]=Or,this.float32[zn+13]=Fr,this.float32[zn+14]=ln,this.uint16[zr+30]=Qr,this.uint16[zr+31]=cn,c}}X.prototype.bytesPerElement=64,xt("StructArrayLayout8i15ui1ul2f2ui64",X);class te extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const g=this.length;return this.resize(g+1),this.emplace(g,c)}emplace(c,g){return this.float32[1*c+0]=g,c}}te.prototype.bytesPerElement=4,xt("StructArrayLayout1f4",te);class le extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g,x){const C=this.length;return this.resize(C+1),this.emplace(C,c,g,x)}emplace(c,g,x,C){const D=3*c;return this.uint16[6*c+0]=g,this.float32[D+1]=x,this.float32[D+2]=C,c}}le.prototype.bytesPerElement=12,xt("StructArrayLayout1ui2f12",le);class ge extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g,x){const C=this.length;return this.resize(C+1),this.emplace(C,c,g,x)}emplace(c,g,x,C){const D=4*c;return this.uint32[2*c+0]=g,this.uint16[D+2]=x,this.uint16[D+3]=C,c}}ge.prototype.bytesPerElement=8,xt("StructArrayLayout1ul2ui8",ge);class Se extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,g){const x=this.length;return this.resize(x+1),this.emplace(x,c,g)}emplace(c,g,x){const C=2*c;return this.uint16[C+0]=g,this.uint16[C+1]=x,c}}Se.prototype.bytesPerElement=4,xt("StructArrayLayout2ui4",Se);class be extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const g=this.length;return this.resize(g+1),this.emplace(g,c)}emplace(c,g){return this.uint16[1*c+0]=g,c}}be.prototype.bytesPerElement=2,xt("StructArrayLayout1ui2",be);class Le extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,g,x,C){const D=this.length;return this.resize(D+1),this.emplace(D,c,g,x,C)}emplace(c,g,x,C,D){const F=4*c;return this.float32[F+0]=g,this.float32[F+1]=x,this.float32[F+2]=C,this.float32[F+3]=D,c}}Le.prototype.bytesPerElement=16,xt("StructArrayLayout4f16",Le);class Ge extends ro{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new S(this.anchorPointX,this.anchorPointY)}}Ge.prototype.size=20;class lt extends l{get(c){return new Ge(this,c)}}xt("CollisionBoxArray",lt);class st extends ro{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}st.prototype.size=48;class ut extends j{get(c){return new st(this,c)}}xt("PlacedSymbolArray",ut);class _t extends ro{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}_t.prototype.size=64;class Dt extends X{get(c){return new _t(this,c)}}xt("SymbolInstanceArray",Dt);class kt extends te{getoffsetX(c){return this.float32[1*c+0]}}xt("GlyphOffsetArray",kt);class zt extends Vo{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}xt("SymbolLineVertexArray",zt);class $t extends ro{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$t.prototype.size=12;class It extends le{get(c){return new $t(this,c)}}xt("TextAnchorOffsetArray",It);class Kt extends ro{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Kt.prototype.size=8;class Er extends ge{get(c){return new Kt(this,c)}}xt("FeatureIndexArray",Er);class vr extends Qo{}class _r extends Qo{}class Ar extends Qo{}class gn extends Ea{}class dn extends fs{}class Yr extends Al{}class Nn extends Bc{}class Mi extends Mu{}class Ji extends ds{}class Ha extends R{}class fa extends p{}class da extends T{}class oa extends O{}class aa extends Se{}const ma=Ki([{name:"a_pos",components:2,type:"Int16"}],4),{members:ps}=ma;class Gi{constructor(c=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=c}prepareSegment(c,g,x,C){const D=this.segments[this.segments.length-1];return c>Gi.MAX_VERTEX_ARRAY_LENGTH&&Yt(`Max vertices per segment is ${Gi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Gi.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!D||D.vertexLength+c>Gi.MAX_VERTEX_ARRAY_LENGTH||D.sortKey!==C?this.createNewSegment(g,x,C):D}createNewSegment(c,g,x){const C={vertexOffset:c.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0,vaos:{}};return x!==void 0&&(C.sortKey=x),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(C),C}getOrCreateLatestSegment(c,g,x){return this.prepareSegment(0,c,g,x)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const c of this.segments)for(const g in c.vaos)c.vaos[g].destroy()}static simpleSegment(c,g,x,C){return new Gi([{vertexOffset:c,primitiveOffset:g,vertexLength:x,primitiveLength:C,vaos:{},sortKey:0}])}}function Is(m,c){return 256*(m=tt(Math.floor(m),0,255))+tt(Math.floor(c),0,255)}Gi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xt("SegmentVector",Gi);const gs=Ki([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yc,Af,If,uh={exports:{}},vg={exports:{}},_g={exports:{}},pp=(function(){if(If)return uh.exports;If=1;var m=(yc||(yc=1,vg.exports=function(g,x){var C,D,F,$,Q,oe,he,ve;for(D=g.length-(C=3&g.length),F=x,Q=3432918353,oe=461845907,ve=0;ve<D;)he=255&g.charCodeAt(ve)|(255&g.charCodeAt(++ve))<<8|(255&g.charCodeAt(++ve))<<16|(255&g.charCodeAt(++ve))<<24,++ve,F=27492+(65535&($=5*(65535&(F=(F^=he=(65535&(he=(he=(65535&he)*Q+(((he>>>16)*Q&65535)<<16)&4294967295)<<15|he>>>17))*oe+(((he>>>16)*oe&65535)<<16)&4294967295)<<13|F>>>19))+((5*(F>>>16)&65535)<<16)&4294967295))+((58964+($>>>16)&65535)<<16);switch(he=0,C){case 3:he^=(255&g.charCodeAt(ve+2))<<16;case 2:he^=(255&g.charCodeAt(ve+1))<<8;case 1:F^=he=(65535&(he=(he=(65535&(he^=255&g.charCodeAt(ve)))*Q+(((he>>>16)*Q&65535)<<16)&4294967295)<<15|he>>>17))*oe+(((he>>>16)*oe&65535)<<16)&4294967295}return F^=g.length,F=2246822507*(65535&(F^=F>>>16))+((2246822507*(F>>>16)&65535)<<16)&4294967295,F=3266489909*(65535&(F^=F>>>13))+((3266489909*(F>>>16)&65535)<<16)&4294967295,(F^=F>>>16)>>>0}),vg.exports),c=(Af||(Af=1,_g.exports=function(g,x){for(var C,D=g.length,F=x^D,$=0;D>=4;)C=1540483477*(65535&(C=255&g.charCodeAt($)|(255&g.charCodeAt(++$))<<8|(255&g.charCodeAt(++$))<<16|(255&g.charCodeAt(++$))<<24))+((1540483477*(C>>>16)&65535)<<16),F=1540483477*(65535&F)+((1540483477*(F>>>16)&65535)<<16)^(C=1540483477*(65535&(C^=C>>>24))+((1540483477*(C>>>16)&65535)<<16)),D-=4,++$;switch(D){case 3:F^=(255&g.charCodeAt($+2))<<16;case 2:F^=(255&g.charCodeAt($+1))<<8;case 1:F=1540483477*(65535&(F^=255&g.charCodeAt($)))+((1540483477*(F>>>16)&65535)<<16)}return F=1540483477*(65535&(F^=F>>>13))+((1540483477*(F>>>16)&65535)<<16),(F^=F>>>15)>>>0}),_g.exports);return uh.exports=m,uh.exports.murmur3=m,uh.exports.murmur2=c,uh.exports})(),Ru=u(pp);class zc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,g,x,C){this.ids.push(Pf(c)),this.positions.push(g,x,C)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const g=Pf(c);let x=0,C=this.ids.length-1;for(;x<C;){const F=x+C>>1;this.ids[F]>=g?C=F:x=F+1}const D=[];for(;this.ids[x]===g;)D.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return D}static serialize(c,g){const x=new Float64Array(c.ids),C=new Uint32Array(c.positions);return bd(x,C,0,x.length-1),g&&g.push(x.buffer,C.buffer),{ids:x,positions:C}}static deserialize(c){const g=new zc;return g.ids=c.ids,g.positions=c.positions,g.indexed=!0,g}}function Pf(m){const c=+m;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:Ru(String(m))}function bd(m,c,g,x){for(;g<x;){const C=m[g+x>>1];let D=g-1,F=x+1;for(;;){do D++;while(m[D]<C);do F--;while(m[F]>C);if(D>=F)break;es(m,D,F),es(c,3*D,3*F),es(c,3*D+1,3*F+1),es(c,3*D+2,3*F+2)}F-g<x-F?(bd(m,c,g,F),g=F+1):(bd(m,c,F+1,x),x=F)}}function es(m,c,g){const x=m[c];m[c]=m[g],m[g]=x}xt("FeaturePositionMap",zc);class go{constructor(c,g){this.gl=c.gl,this.location=g}}class cu extends go{constructor(c,g){super(c,g),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class zs extends go{constructor(c,g){super(c,g),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class bx extends go{constructor(c,g){super(c,g),this.current=En.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const cC=new Float32Array(16);function G0(m){return[Is(255*m.r,255*m.g),Is(255*m.b,255*m.a)]}class bg{constructor(c,g,x){this.value=c,this.uniformNames=g.map((C=>`u_${C}`)),this.type=x}setUniform(c,g,x){c.set(x.constantOr(this.value))}getBinding(c,g,x){return this.type==="color"?new bx(c,g):new cu(c,g)}}class gp{constructor(c,g){this.uniformNames=g.map((x=>`u_${x}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,g){this.pixelRatioFrom=g.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=g.tlbr,this.patternTo=c.tlbr}setUniform(c,g,x,C){const D=C==="u_pattern_to"?this.patternTo:C==="u_pattern_from"?this.patternFrom:C==="u_pixel_ratio_to"?this.pixelRatioTo:C==="u_pixel_ratio_from"?this.pixelRatioFrom:null;D&&c.set(D)}getBinding(c,g,x){return x.substr(0,9)==="u_pattern"?new zs(c,g):new cu(c,g)}}class Uh{constructor(c,g,x,C){this.expression=c,this.type=x,this.maxValue=0,this.paintVertexAttributes=g.map((D=>({name:`a_${D}`,type:"Float32",components:x==="color"?2:1,offset:0}))),this.paintVertexArray=new C}populatePaintArray(c,g,x,C,D){const F=this.paintVertexArray.length,$=this.expression.evaluate(new qn(0),g,{},C,[],D);this.paintVertexArray.resize(c),this._setPaintValue(F,c,$)}updatePaintArray(c,g,x,C){const D=this.expression.evaluate({zoom:0},x,C);this._setPaintValue(c,g,D)}_setPaintValue(c,g,x){if(this.type==="color"){const C=G0(x);for(let D=c;D<g;D++)this.paintVertexArray.emplace(D,C[0],C[1])}else{for(let C=c;C<g;C++)this.paintVertexArray.emplace(C,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Il{constructor(c,g,x,C,D,F){this.expression=c,this.uniformNames=g.map(($=>`u_${$}_t`)),this.type=x,this.useIntegerZoom=C,this.zoom=D,this.maxValue=0,this.paintVertexAttributes=g.map(($=>({name:`a_${$}`,type:"Float32",components:x==="color"?4:2,offset:0}))),this.paintVertexArray=new F}populatePaintArray(c,g,x,C,D){const F=this.expression.evaluate(new qn(this.zoom),g,{},C,[],D),$=this.expression.evaluate(new qn(this.zoom+1),g,{},C,[],D),Q=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(Q,c,F,$)}updatePaintArray(c,g,x,C){const D=this.expression.evaluate({zoom:this.zoom},x,C),F=this.expression.evaluate({zoom:this.zoom+1},x,C);this._setPaintValue(c,g,D,F)}_setPaintValue(c,g,x,C){if(this.type==="color"){const D=G0(x),F=G0(C);for(let $=c;$<g;$++)this.paintVertexArray.emplace($,D[0],D[1],F[0],F[1])}else{for(let D=c;D<g;D++)this.paintVertexArray.emplace(D,x,C);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(C))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,g){const x=this.useIntegerZoom?Math.floor(g.zoom):g.zoom,C=tt(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(C)}getBinding(c,g,x){return new cu(c,g)}}class Vh{constructor(c,g,x,C,D,F){this.expression=c,this.type=g,this.useIntegerZoom=x,this.zoom=C,this.layerId=F,this.zoomInPaintVertexArray=new D,this.zoomOutPaintVertexArray=new D}populatePaintArray(c,g,x){const C=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(C,c,g.patterns&&g.patterns[this.layerId],x)}updatePaintArray(c,g,x,C,D){this._setPaintValues(c,g,x.patterns&&x.patterns[this.layerId],D)}_setPaintValues(c,g,x,C){if(!C||!x)return;const{min:D,mid:F,max:$}=x,Q=C[D],oe=C[F],he=C[$];if(Q&&oe&&he)for(let ve=c;ve<g;ve++)this.zoomInPaintVertexArray.emplace(ve,oe.tl[0],oe.tl[1],oe.br[0],oe.br[1],Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],oe.pixelRatio,Q.pixelRatio),this.zoomOutPaintVertexArray.emplace(ve,oe.tl[0],oe.tl[1],oe.br[0],oe.br[1],he.tl[0],he.tl[1],he.br[0],he.br[1],oe.pixelRatio,he.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,gs.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,gs.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class X0{constructor(c,g,x){this.binders={},this._buffers=[];const C=[];for(const D in c.paint._values){if(!x(D))continue;const F=c.paint.get(D);if(!(F instanceof po&&qa(F.property.specification)))continue;const $=Y0(D,c.type),Q=F.value,oe=F.property.specification.type,he=F.property.useIntegerZoom,ve=F.property.specification["property-type"],De=ve==="cross-faded"||ve==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[D]=De?new gp(Q.value,$):new bg(Q.value,$,oe),C.push(`/u_${D}`);else if(Q.kind==="source"||De){const je=Z0(D,oe,"source");this.binders[D]=De?new Vh(Q,oe,he,g,je,c.id):new Uh(Q,$,oe,je),C.push(`/a_${D}`)}else{const je=Z0(D,oe,"composite");this.binders[D]=new Il(Q,$,oe,he,g,je),C.push(`/z_${D}`)}}this.cacheKey=C.sort().join("")}getMaxValue(c){const g=this.binders[c];return g instanceof Uh||g instanceof Il?g.maxValue:0}populatePaintArrays(c,g,x,C,D){for(const F in this.binders){const $=this.binders[F];($ instanceof Uh||$ instanceof Il||$ instanceof Vh)&&$.populatePaintArray(c,g,x,C,D)}}setConstantPatternPositions(c,g){for(const x in this.binders){const C=this.binders[x];C instanceof gp&&C.setConstantPatternPositions(c,g)}}updatePaintArrays(c,g,x,C,D){let F=!1;for(const $ in c){const Q=g.getPositions($);for(const oe of Q){const he=x.feature(oe.index);for(const ve in this.binders){const De=this.binders[ve];if((De instanceof Uh||De instanceof Il||De instanceof Vh)&&De.expression.isStateDependent===!0){const je=C.paint.get(ve);De.expression=je.value,De.updatePaintArray(oe.start,oe.end,he,c[$],D),F=!0}}}}return F}defines(){const c=[];for(const g in this.binders){const x=this.binders[g];(x instanceof bg||x instanceof gp)&&c.push(...x.uniformNames.map((C=>`#define HAS_UNIFORM_${C}`)))}return c}getBinderAttributes(){const c=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof Uh||x instanceof Il)for(let C=0;C<x.paintVertexAttributes.length;C++)c.push(x.paintVertexAttributes[C].name);else if(x instanceof Vh)for(let C=0;C<gs.members.length;C++)c.push(gs.members[C].name)}return c}getBinderUniforms(){const c=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof bg||x instanceof gp||x instanceof Il)for(const C of x.uniformNames)c.push(C)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,g){const x=[];for(const C in this.binders){const D=this.binders[C];if(D instanceof bg||D instanceof gp||D instanceof Il){for(const F of D.uniformNames)if(g[F]){const $=D.getBinding(c,g[F],F);x.push({name:F,property:C,binding:$})}}}return x}setUniforms(c,g,x,C){for(const{name:D,property:F,binding:$}of g)this.binders[F].setUniform($,C,x.get(F),D)}updatePaintBuffers(c){this._buffers=[];for(const g in this.binders){const x=this.binders[g];if(c&&x instanceof Vh){const C=c.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;C&&this._buffers.push(C)}else(x instanceof Uh||x instanceof Il)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(c){for(const g in this.binders){const x=this.binders[g];(x instanceof Uh||x instanceof Il||x instanceof Vh)&&x.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const g=this.binders[c];(g instanceof Uh||g instanceof Il||g instanceof Vh)&&g.destroy()}}}class kf{constructor(c,g,x=()=>!0){this.programConfigurations={};for(const C of c)this.programConfigurations[C.id]=new X0(C,g,x);this.needsUpload=!1,this._featureMap=new zc,this._bufferOffset=0}populatePaintArrays(c,g,x,C,D,F){for(const $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(c,g,C,D,F);g.id!==void 0&&this._featureMap.add(g.id,x,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,g,x,C){for(const D of x)this.needsUpload=this.programConfigurations[D.id].updatePaintArrays(c,this._featureMap,g,D,C)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const g in this.programConfigurations)this.programConfigurations[g].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function Y0(m,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(`${c}-`,"").replace(/-/g,"_")]}function Z0(m,c,g){const x={color:{source:Al,composite:Le},number:{source:te,composite:Al}},C=(function(D){return{"line-pattern":{source:Nn,composite:Nn},"fill-pattern":{source:Nn,composite:Nn},"fill-extrusion-pattern":{source:Nn,composite:Nn}}[D]})(m);return C&&C[g]||x[c][g]}xt("ConstantBinder",bg),xt("CrossFadedConstantBinder",gp),xt("SourceExpressionBinder",Uh),xt("CrossFadedCompositeBinder",Vh),xt("CompositeExpressionBinder",Il),xt("ProgramConfiguration",X0,{omit:["_buffers"]}),xt("ProgramConfigurationSet",kf);const xg=Math.pow(2,14)-1,gD=-xg-1;function wg(m){const c=ce/m.extent,g=m.loadGeometry();for(let x=0;x<g.length;x++){const C=g[x];for(let D=0;D<C.length;D++){const F=C[D],$=Math.round(F.x*c),Q=Math.round(F.y*c);F.x=tt($,gD,xg),F.y=tt(Q,gD,xg),($<F.x||$>F.x+1||Q<F.y||Q>F.y+1)&&Yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return g}function Sg(m,c){return{type:m.type,id:m.id,properties:m.properties,geometry:c?wg(m):[]}}const mD=-32768;function Lre(m,c,g,x,C){m.emplaceBack(mD+8*c+x,mD+8*g+C)}class hC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new _r,this.indexArray=new oa,this.segments=new Gi,this.programConfigurations=new kf(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id))}populate(c,g,x){const C=this.layers[0],D=[];let F=null,$=!1,Q=C.type==="heatmap";if(C.type==="circle"){const he=C;F=he.layout.get("circle-sort-key"),$=!F.isConstant(),Q=Q||he.paint.get("circle-pitch-alignment")==="map"}const oe=Q?g.subdivisionGranularity.circle:1;for(const{feature:he,id:ve,index:De,sourceLayerIndex:je}of c){const $e=this.layers[0]._featureFilter.needGeometry,Xe=Sg(he,$e);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom,{globalState:this.globalState}),Xe,x))continue;const ot=$?F.evaluate(Xe,{},x):void 0,vt={id:ve,properties:he.properties,type:he.type,sourceLayerIndex:je,index:De,geometry:$e?Xe.geometry:wg(he),patterns:{},sortKey:ot};D.push(vt)}$&&D.sort(((he,ve)=>he.sortKey-ve.sortKey));for(const he of D){const{geometry:ve,index:De,sourceLayerIndex:je}=he,$e=c[De].feature;this.addFeature(he,ve,De,x,oe),g.featureIndex.insert($e,ve,De,je,this.index)}}update(c,g,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,g,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ps),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,g,x,C,D=1){let F;switch(D){case 1:F=[0,7];break;case 3:F=[0,2,5,7];break;case 5:F=[0,1,3,4,6,7];break;case 7:F=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${D}; valid values are 1, 3, 5, 7.`)}const $=F.length;for(const Q of g)for(const oe of Q){const he=oe.x,ve=oe.y;if(he<0||he>=ce||ve<0||ve>=ce)continue;const De=this.segments.prepareSegment($*$,this.layoutVertexArray,this.indexArray,c.sortKey),je=De.vertexLength;for(let $e=0;$e<$;$e++)for(let Xe=0;Xe<$;Xe++)Lre(this.layoutVertexArray,he,ve,F[Xe],F[$e]);for(let $e=0;$e<$-1;$e++)for(let Xe=0;Xe<$-1;Xe++){const ot=je+$e*$+Xe,vt=je+($e+1)*$+Xe;this.indexArray.emplaceBack(ot,vt+1,ot+1),this.indexArray.emplaceBack(ot,vt,vt+1)}De.vertexLength+=$*$,De.primitiveLength+=($-1)*($-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{},C)}}function yD(m,c){for(let g=0;g<m.length;g++)if(ly(c,m[g]))return!0;for(let g=0;g<c.length;g++)if(ly(m,c[g]))return!0;return!!fC(m,c)}function Dre(m,c,g){return!!ly(m,c)||!!dC(c,m,g)}function vD(m,c){if(m.length===1)return bD(c,m[0]);for(let g=0;g<c.length;g++){const x=c[g];for(let C=0;C<x.length;C++)if(ly(m,x[C]))return!0}for(let g=0;g<m.length;g++)if(bD(c,m[g]))return!0;for(let g=0;g<c.length;g++)if(fC(m,c[g]))return!0;return!1}function Fre(m,c,g){if(m.length>1){if(fC(m,c))return!0;for(let x=0;x<c.length;x++)if(dC(c[x],m,g))return!0}for(let x=0;x<m.length;x++)if(dC(m[x],c,g))return!0;return!1}function fC(m,c){if(m.length===0||c.length===0)return!1;for(let g=0;g<m.length-1;g++){const x=m[g],C=m[g+1];for(let D=0;D<c.length-1;D++)if(Bre(x,C,c[D],c[D+1]))return!0}return!1}function Bre(m,c,g,x){return yr(m,g,x)!==yr(c,g,x)&&yr(m,c,g)!==yr(m,c,x)}function dC(m,c,g){const x=g*g;if(c.length===1)return m.distSqr(c[0])<x;for(let C=1;C<c.length;C++)if(_D(m,c[C-1],c[C])<x)return!0;return!1}function _D(m,c,g){const x=c.distSqr(g);if(x===0)return m.distSqr(c);const C=((m.x-c.x)*(g.x-c.x)+(m.y-c.y)*(g.y-c.y))/x;return m.distSqr(C<0?c:C>1?g:g.sub(c)._mult(C)._add(c))}function bD(m,c){let g,x,C,D=!1;for(let F=0;F<m.length;F++){g=m[F];for(let $=0,Q=g.length-1;$<g.length;Q=$++)x=g[$],C=g[Q],x.y>c.y!=C.y>c.y&&c.x<(C.x-x.x)*(c.y-x.y)/(C.y-x.y)+x.x&&(D=!D)}return D}function ly(m,c){let g=!1;for(let x=0,C=m.length-1;x<m.length;C=x++){const D=m[x],F=m[C];D.y>c.y!=F.y>c.y&&c.x<(F.x-D.x)*(c.y-D.y)/(F.y-D.y)+D.x&&(g=!g)}return g}function zre(m,c,g){const x=g[0],C=g[2];if(m.x<x.x&&c.x<x.x||m.x>C.x&&c.x>C.x||m.y<x.y&&c.y<x.y||m.y>C.y&&c.y>C.y)return!1;const D=yr(m,c,g[0]);return D!==yr(m,c,g[1])||D!==yr(m,c,g[2])||D!==yr(m,c,g[3])}function K0(m,c,g){const x=c.paint.get(m).value;return x.kind==="constant"?x.value:g.programConfigurations.get(c.id).getMaxValue(m)}function xx(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function wx(m,c,g,x,C){if(!c[0]&&!c[1])return m;const D=S.convert(c)._mult(C);g==="viewport"&&D._rotate(-x);const F=[];for(let $=0;$<m.length;$++)F.push(m[$].sub(D));return F}let xD,wD;xt("CircleBucket",hC,{omit:["layers"]});var jre={get paint(){return wD=wD||new to({"circle-radius":new Sn(Ct.paint_circle["circle-radius"]),"circle-color":new Sn(Ct.paint_circle["circle-color"]),"circle-blur":new Sn(Ct.paint_circle["circle-blur"]),"circle-opacity":new Sn(Ct.paint_circle["circle-opacity"]),"circle-translate":new sn(Ct.paint_circle["circle-translate"]),"circle-translate-anchor":new sn(Ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new sn(Ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new sn(Ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sn(Ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sn(Ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sn(Ct.paint_circle["circle-stroke-opacity"])})},get layout(){return xD=xD||new to({"circle-sort-key":new Sn(Ct.layout_circle["circle-sort-key"])})}};class Ure extends Sa{constructor(c){super(c,jre)}createBucket(c){return new hC(c)}queryRadius(c){const g=c;return K0("circle-radius",this,g)+K0("circle-stroke-width",this,g)+xx(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:c,feature:g,featureState:x,geometry:C,transform:D,pixelsToTileUnits:F,unwrappedTileID:$,getElevation:Q}){const oe=wx(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-D.bearingInRadians,F),he=this.paint.get("circle-radius").evaluate(g,x)+this.paint.get("circle-stroke-width").evaluate(g,x),ve=this.paint.get("circle-pitch-alignment")==="map",De=ve?oe:(function($e,Xe,ot,vt){return $e.map((Ht=>SD(Ht,Xe,ot,vt)))})(oe,D,$,Q),je=ve?he*F:he;for(const $e of C)for(const Xe of $e){const ot=ve?Xe:SD(Xe,D,$,Q);let vt=je;const Ht=D.projectTileCoordinates(Xe.x,Xe.y,$,Q).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?vt*=Ht/D.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(vt*=D.cameraToCenterDistance/Ht),Dre(De,ot,vt))return!0}return!1}}function SD(m,c,g,x){const C=c.projectTileCoordinates(m.x,m.y,g,x).point;return new S((.5*C.x+.5)*c.width,(.5*-C.y+.5)*c.height)}class ED extends hC{}let TD;xt("HeatmapBucket",ED,{omit:["layers"]});var Vre={get paint(){return TD=TD||new to({"heatmap-radius":new Sn(Ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sn(Ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new sn(Ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Uo(Ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new sn(Ct.paint_heatmap["heatmap-opacity"])})}};function pC(m,{width:c,height:g},x,C){if(C){if(C instanceof Uint8ClampedArray)C=new Uint8Array(C.buffer);else if(C.length!==c*g*x)throw new RangeError(`mismatched image size. expected: ${C.length} but got: ${c*g*x}`)}else C=new Uint8Array(c*g*x);return m.width=c,m.height=g,m.data=C,m}function CD(m,{width:c,height:g},x){if(c===m.width&&g===m.height)return;const C=pC({},{width:c,height:g},x);gC(m,C,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,c),height:Math.min(m.height,g)},x),m.width=c,m.height=g,m.data=C.data}function gC(m,c,g,x,C,D){if(C.width===0||C.height===0)return c;if(C.width>m.width||C.height>m.height||g.x>m.width-C.width||g.y>m.height-C.height)throw new RangeError("out of range source coordinates for image copy");if(C.width>c.width||C.height>c.height||x.x>c.width-C.width||x.y>c.height-C.height)throw new RangeError("out of range destination coordinates for image copy");const F=m.data,$=c.data;if(F===$)throw new Error("srcData equals dstData, so image is already copied");for(let Q=0;Q<C.height;Q++){const oe=((g.y+Q)*m.width+g.x)*D,he=((x.y+Q)*c.width+x.x)*D;for(let ve=0;ve<C.width*D;ve++)$[he+ve]=F[oe+ve]}return c}class J0{constructor(c,g){pC(this,c,1,g)}resize(c){CD(this,c,1)}clone(){return new J0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,g,x,C,D){gC(c,g,x,C,D,1)}}class Qu{constructor(c,g){pC(this,c,4,g)}resize(c){CD(this,c,4)}replace(c,g){g?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new Qu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,g,x,C,D){gC(c,g,x,C,D,4)}setPixel(c,g,x){const C=4*(c*this.width+g);this.data[C+0]=Math.round(255*x.r/x.a),this.data[C+1]=Math.round(255*x.g/x.a),this.data[C+2]=Math.round(255*x.b/x.a),this.data[C+3]=Math.round(255*x.a)}}function AD(m){const c={},g=m.resolution||256,x=m.clips?m.clips.length:1,C=m.image||new Qu({width:g,height:x});if(Math.log(g)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${g}`);const D=(F,$,Q)=>{c[m.evaluationKey]=Q;const oe=m.expression.evaluate(c);C.setPixel(F/4/g,$/4,oe)};if(m.clips)for(let F=0,$=0;F<x;++F,$+=4*g)for(let Q=0,oe=0;Q<g;Q++,oe+=4){const he=Q/(g-1),{start:ve,end:De}=m.clips[F];D($,oe,ve*(1-he)+De*he)}else for(let F=0,$=0;F<g;F++,$+=4)D(0,$,F/(g-1));return C}xt("AlphaImage",J0),xt("RGBAImage",Qu);const mC="big-fb";class $re extends Sa{createBucket(c){return new ED(c)}constructor(c){super(c,Vre),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=AD({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(mC)&&this.heatmapFbos.delete(mC)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ID;var qre={get paint(){return ID=ID||new to({"hillshade-illumination-direction":new sn(Ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new sn(Ct.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new sn(Ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new sn(Ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new sn(Ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new sn(Ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new sn(Ct.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new sn(Ct.paint_hillshade["hillshade-method"])})}};class Hre extends Sa{constructor(c){super(c,qre),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let c=this.paint.get("hillshade-illumination-direction").values,g=this.paint.get("hillshade-illumination-altitude").values,x=this.paint.get("hillshade-highlight-color").values,C=this.paint.get("hillshade-shadow-color").values;const D=Math.max(c.length,g.length,x.length,C.length);c=c.concat(Array(D-c.length).fill(c.at(-1))),g=g.concat(Array(D-g.length).fill(g.at(-1))),x=x.concat(Array(D-x.length).fill(x.at(-1))),C=C.concat(Array(D-C.length).fill(C.at(-1)));const F=g.map(Nr);return{directionRadians:c.map(Nr),altitudeRadians:F,shadowColor:C,highlightColor:x}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let PD;var Wre={get paint(){return PD=PD||new to({"color-relief-opacity":new sn(Ct["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Uo(Ct["paint_color-relief"]["color-relief-color"])})}};class yC{constructor(c,g,x,C){this.context=c,this.format=x,this.texture=c.gl.createTexture(),this.update(g,C)}update(c,g,x){const{width:C,height:D}=c,F=!(this.size&&this.size[0]===C&&this.size[1]===D||x),{context:$}=this,{gl:Q}=$;if(this.useMipmap=!!(g&&g.useMipmap),Q.bindTexture(Q.TEXTURE_2D,this.texture),$.pixelStoreUnpackFlipY.set(!1),$.pixelStoreUnpack.set(1),$.pixelStoreUnpackPremultiplyAlpha.set(this.format===Q.RGBA&&(!g||g.premultiply!==!1)),F)this.size=[C,D],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Tr(c)?Q.texImage2D(Q.TEXTURE_2D,0,this.format,this.format,Q.UNSIGNED_BYTE,c):Q.texImage2D(Q.TEXTURE_2D,0,this.format,C,D,0,this.format,Q.UNSIGNED_BYTE,c.data);else{const{x:oe,y:he}=x||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Tr(c)?Q.texSubImage2D(Q.TEXTURE_2D,0,oe,he,Q.RGBA,Q.UNSIGNED_BYTE,c):Q.texSubImage2D(Q.TEXTURE_2D,0,oe,he,C,D,Q.RGBA,Q.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Q.generateMipmap(Q.TEXTURE_2D),$.pixelStoreUnpackFlipY.setDefault(),$.pixelStoreUnpack.setDefault(),$.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(c,g,x){const{context:C}=this,{gl:D}=C;D.bindTexture(D.TEXTURE_2D,this.texture),x!==D.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=D.LINEAR),c!==this.filter&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,c),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,x||c),this.filter=c),g!==this.wrap&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,g),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,g),this.wrap=g)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class kD{constructor(c,g,x,C=1,D=1,F=1,$=0){if(this.uid=c,g.height!==g.width)throw new RangeError("DEM tiles must be square");if(x&&!["mapbox","terrarium","custom"].includes(x))return void Yt(`"${x}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=g.height;const Q=this.dim=g.height-2;switch(this.data=new Uint32Array(g.data.buffer),x){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=C,this.greenFactor=D,this.blueFactor=F,this.baseShift=$;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let oe=0;oe<Q;oe++)this.data[this._idx(-1,oe)]=this.data[this._idx(0,oe)],this.data[this._idx(Q,oe)]=this.data[this._idx(Q-1,oe)],this.data[this._idx(oe,-1)]=this.data[this._idx(oe,0)],this.data[this._idx(oe,Q)]=this.data[this._idx(oe,Q-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Q,-1)]=this.data[this._idx(Q-1,0)],this.data[this._idx(-1,Q)]=this.data[this._idx(0,Q-1)],this.data[this._idx(Q,Q)]=this.data[this._idx(Q-1,Q-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let oe=0;oe<Q;oe++)for(let he=0;he<Q;he++){const ve=this.get(oe,he);ve>this.max&&(this.max=ve),ve<this.min&&(this.min=ve)}}get(c,g){const x=new Uint8Array(this.data.buffer),C=4*this._idx(c,g);return this.unpack(x[C],x[C+1],x[C+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,g){if(c<-1||c>=this.dim+1||g<-1||g>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(g+1)*this.stride+(c+1)}unpack(c,g,x){return c*this.redFactor+g*this.greenFactor+x*this.blueFactor-this.baseShift}pack(c){return MD(c,this.getUnpackVector())}getPixels(){return new Qu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,g,x){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let C=g*this.dim,D=g*this.dim+this.dim,F=x*this.dim,$=x*this.dim+this.dim;switch(g){case-1:C=D-1;break;case 1:D=C+1}switch(x){case-1:F=$-1;break;case 1:$=F+1}const Q=-g*this.dim,oe=-x*this.dim;for(let he=F;he<$;he++)for(let ve=C;ve<D;ve++)this.data[this._idx(ve,he)]=c.data[this._idx(ve+Q,he+oe)]}}function MD(m,c){const g=c[0],x=c[1],C=c[2],D=c[3],F=Math.min(g,x,C),$=Math.round((m+D)/F);return{r:Math.floor($*F/g)%256,g:Math.floor($*F/x)%256,b:Math.floor($*F/C)%256}}xt("DEMData",kD);class Gre extends Sa{constructor(c){super(c,Wre)}_createColorRamp(c){const g={elevationStops:[],colorStops:[]},x=this._transitionablePaint._values["color-relief-color"].value.expression;if(x instanceof bf&&x._styleExpression.expression instanceof li){this.colorRampExpression=x;const F=x._styleExpression.expression;g.elevationStops=F.labels,g.colorStops=[];for(const $ of g.elevationStops)g.colorStops.push(F.evaluate({globals:{elevation:$}}))}if(g.elevationStops.length<1&&(g.elevationStops=[0],g.colorStops=[En.transparent]),g.elevationStops.length<2&&(g.elevationStops.push(g.elevationStops[0]+1),g.colorStops.push(g.colorStops[0])),g.elevationStops.length<=c)return g;const C={elevationStops:[],colorStops:[]},D=(g.elevationStops.length-1)/(c-1);for(let F=0;F<g.elevationStops.length-.5;F+=D)C.elevationStops.push(g.elevationStops[Math.round(F)]),C.colorStops.push(g.colorStops[Math.round(F)]);return Yt(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),C}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(c,g,x){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const C=this._createColorRamp(g),D=new Qu({width:C.colorStops.length,height:1}),F=new Qu({width:C.colorStops.length,height:1});for(let $=0;$<C.elevationStops.length;$++){const Q=MD(C.elevationStops[$],x);F.setPixel(0,$,new En(Q.r/255,Q.g/255,Q.b/255,1)),D.setPixel(0,$,C.colorStops[$])}return this.colorRampTextures={elevationTexture:new yC(c,F,c.gl.RGBA),colorTexture:new yC(c,D,c.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Xre=Ki([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yre}=Xre;function vC(m,c,g){const x=g.patternDependencies;let C=!1;for(const D of c){const F=D.paint.get(`${m}-pattern`);F.isConstant()||(C=!0);const $=F.constantOr(null);$&&(C=!0,x[$.to]=!0,x[$.from]=!0)}return C}function _C(m,c,g,x,C){const D=C.patternDependencies;for(const F of c){const $=F.paint.get(`${m}-pattern`).value;if($.kind!=="constant"){let Q=$.evaluate({zoom:x-1},g,{},C.availableImages),oe=$.evaluate({zoom:x},g,{},C.availableImages),he=$.evaluate({zoom:x+1},g,{},C.availableImages);Q=Q&&Q.name?Q.name:Q,oe=oe&&oe.name?oe.name:oe,he=he&&he.name?he.name:he,D[Q]=!0,D[oe]=!0,D[he]=!0,g.patterns[F.id]={min:Q,mid:oe,max:he}}}return g}function RD(m,c,g,x,C){let D;if(C===(function(F,$,Q,oe){let he=0;for(let ve=$,De=Q-oe;ve<Q;ve+=oe)he+=(F[De]-F[ve])*(F[ve+1]+F[De+1]),De=ve;return he})(m,c,g,x)>0)for(let F=c;F<g;F+=x)D=DD(F/x|0,m[F],m[F+1],D);else for(let F=g-x;F>=c;F-=x)D=DD(F/x|0,m[F],m[F+1],D);return D&&uy(D,D.next)&&(r_(D),D=D.next),D}function Eg(m,c){if(!m)return m;c||(c=m);let g,x=m;do if(g=!1,x.steiner||!uy(x,x.next)&&ms(x.prev,x,x.next)!==0)x=x.next;else{if(r_(x),x=c=x.prev,x===x.next)break;g=!0}while(g||x!==c);return c}function Q0(m,c,g,x,C,D,F){if(!m)return;!F&&D&&(function(Q,oe,he,ve){let De=Q;do De.z===0&&(De.z=bC(De.x,De.y,oe,he,ve)),De.prevZ=De.prev,De.nextZ=De.next,De=De.next;while(De!==Q);De.prevZ.nextZ=null,De.prevZ=null,(function(je){let $e,Xe=1;do{let ot,vt=je;je=null;let Ht=null;for($e=0;vt;){$e++;let Ot=vt,ze=0;for(let Ft=0;Ft<Xe&&(ze++,Ot=Ot.nextZ,Ot);Ft++);let nt=Xe;for(;ze>0||nt>0&&Ot;)ze!==0&&(nt===0||!Ot||vt.z<=Ot.z)?(ot=vt,vt=vt.nextZ,ze--):(ot=Ot,Ot=Ot.nextZ,nt--),Ht?Ht.nextZ=ot:je=ot,ot.prevZ=Ht,Ht=ot;vt=Ot}Ht.nextZ=null,Xe*=2}while($e>1)})(De)})(m,x,C,D);let $=m;for(;m.prev!==m.next;){const Q=m.prev,oe=m.next;if(D?Kre(m,x,C,D):Zre(m))c.push(Q.i,m.i,oe.i),r_(m),m=oe.next,$=oe.next;else if((m=oe)===$){F?F===1?Q0(m=Jre(Eg(m),c),c,g,x,C,D,2):F===2&&Qre(m,c,g,x,C,D):Q0(Eg(m),c,g,x,C,D,1);break}}}function Zre(m){const c=m.prev,g=m,x=m.next;if(ms(c,g,x)>=0)return!1;const C=c.x,D=g.x,F=x.x,$=c.y,Q=g.y,oe=x.y,he=Math.min(C,D,F),ve=Math.min($,Q,oe),De=Math.max(C,D,F),je=Math.max($,Q,oe);let $e=x.next;for(;$e!==c;){if($e.x>=he&&$e.x<=De&&$e.y>=ve&&$e.y<=je&&e_(C,$,D,Q,F,oe,$e.x,$e.y)&&ms($e.prev,$e,$e.next)>=0)return!1;$e=$e.next}return!0}function Kre(m,c,g,x){const C=m.prev,D=m,F=m.next;if(ms(C,D,F)>=0)return!1;const $=C.x,Q=D.x,oe=F.x,he=C.y,ve=D.y,De=F.y,je=Math.min($,Q,oe),$e=Math.min(he,ve,De),Xe=Math.max($,Q,oe),ot=Math.max(he,ve,De),vt=bC(je,$e,c,g,x),Ht=bC(Xe,ot,c,g,x);let Ot=m.prevZ,ze=m.nextZ;for(;Ot&&Ot.z>=vt&&ze&&ze.z<=Ht;){if(Ot.x>=je&&Ot.x<=Xe&&Ot.y>=$e&&Ot.y<=ot&&Ot!==C&&Ot!==F&&e_($,he,Q,ve,oe,De,Ot.x,Ot.y)&&ms(Ot.prev,Ot,Ot.next)>=0||(Ot=Ot.prevZ,ze.x>=je&&ze.x<=Xe&&ze.y>=$e&&ze.y<=ot&&ze!==C&&ze!==F&&e_($,he,Q,ve,oe,De,ze.x,ze.y)&&ms(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;Ot&&Ot.z>=vt;){if(Ot.x>=je&&Ot.x<=Xe&&Ot.y>=$e&&Ot.y<=ot&&Ot!==C&&Ot!==F&&e_($,he,Q,ve,oe,De,Ot.x,Ot.y)&&ms(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.prevZ}for(;ze&&ze.z<=Ht;){if(ze.x>=je&&ze.x<=Xe&&ze.y>=$e&&ze.y<=ot&&ze!==C&&ze!==F&&e_($,he,Q,ve,oe,De,ze.x,ze.y)&&ms(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function Jre(m,c){let g=m;do{const x=g.prev,C=g.next.next;!uy(x,C)&&ND(x,g,g.next,C)&&t_(x,C)&&t_(C,x)&&(c.push(x.i,g.i,C.i),r_(g),r_(g.next),g=m=C),g=g.next}while(g!==m);return Eg(g)}function Qre(m,c,g,x,C,D){let F=m;do{let $=F.next.next;for(;$!==F.prev;){if(F.i!==$.i&&ine(F,$)){let Q=LD(F,$);return F=Eg(F,F.next),Q=Eg(Q,Q.next),Q0(F,c,g,x,C,D,0),void Q0(Q,c,g,x,C,D,0)}$=$.next}F=F.next}while(F!==m)}function ene(m,c){let g=m.x-c.x;return g===0&&(g=m.y-c.y,g===0)&&(g=(m.next.y-m.y)/(m.next.x-m.x)-(c.next.y-c.y)/(c.next.x-c.x)),g}function tne(m,c){const g=(function(C,D){let F=D;const $=C.x,Q=C.y;let oe,he=-1/0;if(uy(C,F))return F;do{if(uy(C,F.next))return F.next;if(Q<=F.y&&Q>=F.next.y&&F.next.y!==F.y){const Xe=F.x+(Q-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Xe<=$&&Xe>he&&(he=Xe,oe=F.x<F.next.x?F:F.next,Xe===$))return oe}F=F.next}while(F!==D);if(!oe)return null;const ve=oe,De=oe.x,je=oe.y;let $e=1/0;F=oe;do{if($>=F.x&&F.x>=De&&$!==F.x&&OD(Q<je?$:he,Q,De,je,Q<je?he:$,Q,F.x,F.y)){const Xe=Math.abs(Q-F.y)/($-F.x);t_(F,C)&&(Xe<$e||Xe===$e&&(F.x>oe.x||F.x===oe.x&&rne(oe,F)))&&(oe=F,$e=Xe)}F=F.next}while(F!==ve);return oe})(m,c);if(!g)return c;const x=LD(g,m);return Eg(x,x.next),Eg(g,g.next)}function rne(m,c){return ms(m.prev,m,c.prev)<0&&ms(c.next,m,m.next)<0}function bC(m,c,g,x,C){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-g)*C|0)|m<<8))|m<<4))|m<<2))|m<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-x)*C|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function nne(m){let c=m,g=m;do(c.x<g.x||c.x===g.x&&c.y<g.y)&&(g=c),c=c.next;while(c!==m);return g}function OD(m,c,g,x,C,D,F,$){return(C-F)*(c-$)>=(m-F)*(D-$)&&(m-F)*(x-$)>=(g-F)*(c-$)&&(g-F)*(D-$)>=(C-F)*(x-$)}function e_(m,c,g,x,C,D,F,$){return!(m===F&&c===$)&&OD(m,c,g,x,C,D,F,$)}function ine(m,c){return m.next.i!==c.i&&m.prev.i!==c.i&&!(function(g,x){let C=g;do{if(C.i!==g.i&&C.next.i!==g.i&&C.i!==x.i&&C.next.i!==x.i&&ND(C,C.next,g,x))return!0;C=C.next}while(C!==g);return!1})(m,c)&&(t_(m,c)&&t_(c,m)&&(function(g,x){let C=g,D=!1;const F=(g.x+x.x)/2,$=(g.y+x.y)/2;do C.y>$!=C.next.y>$&&C.next.y!==C.y&&F<(C.next.x-C.x)*($-C.y)/(C.next.y-C.y)+C.x&&(D=!D),C=C.next;while(C!==g);return D})(m,c)&&(ms(m.prev,m,c.prev)||ms(m,c.prev,c))||uy(m,c)&&ms(m.prev,m,m.next)>0&&ms(c.prev,c,c.next)>0)}function ms(m,c,g){return(c.y-m.y)*(g.x-c.x)-(c.x-m.x)*(g.y-c.y)}function uy(m,c){return m.x===c.x&&m.y===c.y}function ND(m,c,g,x){const C=Ex(ms(m,c,g)),D=Ex(ms(m,c,x)),F=Ex(ms(g,x,m)),$=Ex(ms(g,x,c));return C!==D&&F!==$||!(C!==0||!Sx(m,g,c))||!(D!==0||!Sx(m,x,c))||!(F!==0||!Sx(g,m,x))||!($!==0||!Sx(g,c,x))}function Sx(m,c,g){return c.x<=Math.max(m.x,g.x)&&c.x>=Math.min(m.x,g.x)&&c.y<=Math.max(m.y,g.y)&&c.y>=Math.min(m.y,g.y)}function Ex(m){return m>0?1:m<0?-1:0}function t_(m,c){return ms(m.prev,m,m.next)<0?ms(m,c,m.next)>=0&&ms(m,m.prev,c)>=0:ms(m,c,m.prev)<0||ms(m,m.next,c)<0}function LD(m,c){const g=xC(m.i,m.x,m.y),x=xC(c.i,c.x,c.y),C=m.next,D=c.prev;return m.next=c,c.prev=m,g.next=C,C.prev=g,x.next=g,g.prev=x,D.next=x,x.prev=D,x}function DD(m,c,g,x){const C=xC(m,c,g);return x?(C.next=x.next,C.prev=x,x.next.prev=C,x.next=C):(C.prev=C,C.next=C),C}function r_(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function xC(m,c,g){return{i:m,x:c,y:g,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class cy{constructor(c,g){if(g>c)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=c,this._minGranularity=g}getGranularityForZoomLevel(c){return Math.max(Math.floor(this._baseZoomGranularity/(1<<c)),this._minGranularity,1)}}class Tx{constructor(c){this.fill=c.fill,this.line=c.line,this.tile=c.tile,this.stencil=c.stencil,this.circle=c.circle}}Tx.noSubdivision=new Tx({fill:new cy(0,0),line:new cy(0,0),tile:new cy(0,0),stencil:new cy(0,0),circle:1}),xt("SubdivisionGranularityExpression",cy),xt("SubdivisionGranularitySetting",Tx);const hy=-32768,n_=32767;class ane{constructor(c,g){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=c,this._granularityCellSize=ce/c,this._canonical=g}_getKey(c,g){return(c+=32768)<<16|g+32768}_vertexToIndex(c,g){if(c<-32768||g<-32768||c>32767||g>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const x=0|Math.round(c),C=0|Math.round(g),D=this._getKey(x,C);if(this._vertexDictionary.has(D))return this._vertexDictionary.get(D);const F=this._vertexBuffer.length/2;return this._vertexDictionary.set(D,F),this._vertexBuffer.push(x,C),F}_subdivideTrianglesScanline(c){if(this._granularity<2)return(function(C,D){const F=[];for(let $=0;$<D.length;$+=3){const Q=D[$],oe=D[$+1],he=D[$+2],ve=C[2*Q],De=C[2*Q+1];(C[2*oe]-ve)*(C[2*he+1]-De)-(C[2*oe+1]-De)*(C[2*he]-ve)>0?(F.push(Q),F.push(he),F.push(oe)):(F.push(Q),F.push(oe),F.push(he))}return F})(this._vertexBuffer,c);const g=[],x=c.length;for(let C=0;C<x;C+=3){const D=[c[C+0],c[C+1],c[C+2]],F=[this._vertexBuffer[2*c[C+0]+0],this._vertexBuffer[2*c[C+0]+1],this._vertexBuffer[2*c[C+1]+0],this._vertexBuffer[2*c[C+1]+1],this._vertexBuffer[2*c[C+2]+0],this._vertexBuffer[2*c[C+2]+1]];let $=1/0,Q=1/0,oe=-1/0,he=-1/0;for(let Xe=0;Xe<3;Xe++){const ot=F[2*Xe],vt=F[2*Xe+1];$=Math.min($,ot),oe=Math.max(oe,ot),Q=Math.min(Q,vt),he=Math.max(he,vt)}if($===oe||Q===he)continue;const ve=Math.floor($/this._granularityCellSize),De=Math.ceil(oe/this._granularityCellSize),je=Math.floor(Q/this._granularityCellSize),$e=Math.ceil(he/this._granularityCellSize);if(ve!==De||je!==$e)for(let Xe=je;Xe<$e;Xe++){const ot=this._scanlineGenerateVertexRingForCellRow(Xe,F,D);one(this._vertexBuffer,ot,g)}else g.push(...D)}return g}_scanlineGenerateVertexRingForCellRow(c,g,x){const C=c*this._granularityCellSize,D=C+this._granularityCellSize,F=[];for(let $=0;$<3;$++){const Q=g[2*$],oe=g[2*$+1],he=g[2*($+1)%6],ve=g[(2*($+1)+1)%6],De=g[2*($+2)%6],je=g[(2*($+2)+1)%6],$e=he-Q,Xe=ve-oe,ot=$e===0,vt=Xe===0,Ht=(C-oe)/Xe,Ot=(D-oe)/Xe,ze=Math.min(Ht,Ot),nt=Math.max(Ht,Ot);if(!vt&&(ze>=1||nt<=0)||vt&&(oe<C||oe>D)){ve>=C&&ve<=D&&F.push(x[($+1)%3]);continue}!vt&&ze>0&&F.push(this._vertexToIndex(Q+$e*ze,oe+Xe*ze));const Ft=Q+$e*Math.max(ze,0),Sr=Q+$e*Math.min(nt,1);ot||this._generateIntraEdgeVertices(F,Q,oe,he,ve,Ft,Sr),!vt&&nt<1&&F.push(this._vertexToIndex(Q+$e*nt,oe+Xe*nt)),(vt||ve>=C&&ve<=D)&&F.push(x[($+1)%3]),!vt&&(ve<=C||ve>=D)&&this._generateInterEdgeVertices(F,Q,oe,he,ve,De,je,Sr,C,D)}return F}_generateIntraEdgeVertices(c,g,x,C,D,F,$){const Q=C-g,oe=D-x,he=oe===0,ve=he?Math.min(g,C):Math.min(F,$),De=he?Math.max(g,C):Math.max(F,$),je=Math.floor(ve/this._granularityCellSize)+1,$e=Math.ceil(De/this._granularityCellSize)-1;if(he?g<C:F<$)for(let Xe=je;Xe<=$e;Xe++){const ot=Xe*this._granularityCellSize;c.push(this._vertexToIndex(ot,x+oe*(ot-g)/Q))}else for(let Xe=$e;Xe>=je;Xe--){const ot=Xe*this._granularityCellSize;c.push(this._vertexToIndex(ot,x+oe*(ot-g)/Q))}}_generateInterEdgeVertices(c,g,x,C,D,F,$,Q,oe,he){const ve=D-x,De=F-C,je=$-D,$e=(oe-D)/je,Xe=(he-D)/je,ot=Math.min($e,Xe),vt=Math.max($e,Xe),Ht=C+De*ot;let Ot=Math.floor(Math.min(Ht,Q)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(Ht,Q)/this._granularityCellSize)-1,nt=Q<Ht;const Ft=je===0;if(Ft&&($===oe||$===he))return;if(Ft||ot>=1||vt<=0){const Jr=x-$,Or=F+(g-F)*Math.min((oe-$)/Jr,(he-$)/Jr);Ot=Math.floor(Math.min(Or,Q)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(Or,Q)/this._granularityCellSize)-1,nt=Q<Or}const Sr=ve>0?he:oe;if(nt)for(let Jr=Ot;Jr<=ze;Jr++)c.push(this._vertexToIndex(Jr*this._granularityCellSize,Sr));else for(let Jr=ze;Jr>=Ot;Jr--)c.push(this._vertexToIndex(Jr*this._granularityCellSize,Sr))}_generateOutline(c){const g=[];for(const x of c){const C=Tg(x,this._granularity,!0),D=this._pointArrayToIndices(C),F=[];for(let $=1;$<D.length;$++)F.push(D[$-1]),F.push(D[$]);g.push(F)}return g}_handlePoles(c){let g=!1,x=!1;this._canonical&&(this._canonical.y===0&&(g=!0),this._canonical.y===(1<<this._canonical.z)-1&&(x=!0)),(g||x)&&this._fillPoles(c,g,x)}_ensureNoPoleVertices(){const c=this._vertexBuffer;for(let g=0;g<c.length;g+=2){const x=c[g+1];x===hy&&(c[g+1]=-32767),x===n_&&(c[g+1]=32766)}}_generatePoleQuad(c,g,x,C,D,F){C>D!=(F===hy)?(c.push(g),c.push(x),c.push(this._vertexToIndex(C,F)),c.push(x),c.push(this._vertexToIndex(D,F)),c.push(this._vertexToIndex(C,F))):(c.push(x),c.push(g),c.push(this._vertexToIndex(C,F)),c.push(this._vertexToIndex(D,F)),c.push(x),c.push(this._vertexToIndex(C,F)))}_fillPoles(c,g,x){const C=this._vertexBuffer,D=ce,F=c.length;for(let $=2;$<F;$+=3){const Q=c[$-2],oe=c[$-1],he=c[$],ve=C[2*Q],De=C[2*Q+1],je=C[2*oe],$e=C[2*oe+1],Xe=C[2*he],ot=C[2*he+1];g&&(De===0&&$e===0&&this._generatePoleQuad(c,Q,oe,ve,je,hy),$e===0&&ot===0&&this._generatePoleQuad(c,oe,he,je,Xe,hy),ot===0&&De===0&&this._generatePoleQuad(c,he,Q,Xe,ve,hy)),x&&(De===D&&$e===D&&this._generatePoleQuad(c,Q,oe,ve,je,n_),$e===D&&ot===D&&this._generatePoleQuad(c,oe,he,je,Xe,n_),ot===D&&De===D&&this._generatePoleQuad(c,he,Q,Xe,ve,n_))}}_initializeVertices(c){for(let g=0;g<c.length;g+=2)this._vertexToIndex(c[g],c[g+1])}subdividePolygonInternal(c,g){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:x,holeIndices:C}=(function($){const Q=[],oe=[];for(const he of $)if(he.length!==0){he!==$[0]&&Q.push(oe.length/2);for(let ve=0;ve<he.length;ve++)oe.push(he[ve].x),oe.push(he[ve].y)}return{flattened:oe,holeIndices:Q}})(c);let D;this._initializeVertices(x);try{const $=(function(oe,he,ve=2){const De=he&&he.length,je=De?he[0]*ve:oe.length;let $e=RD(oe,0,je,ve,!0);const Xe=[];if(!$e||$e.next===$e.prev)return Xe;let ot,vt,Ht;if(De&&($e=(function(Ot,ze,nt,Ft){const Sr=[];for(let Jr=0,Or=ze.length;Jr<Or;Jr++){const Fr=RD(Ot,ze[Jr]*Ft,Jr<Or-1?ze[Jr+1]*Ft:Ot.length,Ft,!1);Fr===Fr.next&&(Fr.steiner=!0),Sr.push(nne(Fr))}Sr.sort(ene);for(let Jr=0;Jr<Sr.length;Jr++)nt=tne(Sr[Jr],nt);return nt})(oe,he,$e,ve)),oe.length>80*ve){ot=1/0,vt=1/0;let Ot=-1/0,ze=-1/0;for(let nt=ve;nt<je;nt+=ve){const Ft=oe[nt],Sr=oe[nt+1];Ft<ot&&(ot=Ft),Sr<vt&&(vt=Sr),Ft>Ot&&(Ot=Ft),Sr>ze&&(ze=Sr)}Ht=Math.max(Ot-ot,ze-vt),Ht=Ht!==0?32767/Ht:0}return Q0($e,Xe,ve,ot,vt,Ht,0),Xe})(x,C),Q=this._convertIndices(x,$);D=this._subdivideTrianglesScanline(Q)}catch($){console.error($)}let F=[];return g&&(F=this._generateOutline(c)),this._ensureNoPoleVertices(),this._handlePoles(D),{verticesFlattened:this._vertexBuffer,indicesTriangles:D,indicesLineList:F}}_convertIndices(c,g){const x=[];for(let C=0;C<g.length;C++)x.push(this._vertexToIndex(c[2*g[C]],c[2*g[C]+1]));return x}_pointArrayToIndices(c){const g=[];for(let x=0;x<c.length;x++){const C=c[x];g.push(this._vertexToIndex(C.x,C.y))}return g}}function FD(m,c,g,x=!0){return new ane(g,c).subdividePolygonInternal(m,x)}function Tg(m,c,g=!1){if(!m||m.length<1)return[];if(m.length<2)return[];const x=m[0],C=m[m.length-1],D=g&&(x.x!==C.x||x.y!==C.y);if(c<2)return D?[...m,m[0]]:[...m];const F=Math.floor(ce/c),$=[];$.push(new S(m[0].x,m[0].y));const Q=m.length,oe=D?Q:Q-1;for(let he=0;he<oe;he++){const ve=m[he],De=he<Q-1?m[he+1]:m[0],je=ve.x,$e=ve.y,Xe=De.x,ot=De.y,vt=je!==Xe,Ht=$e!==ot;if(!vt&&!Ht)continue;const Ot=Xe-je,ze=ot-$e,nt=Math.abs(Ot),Ft=Math.abs(ze);let Sr=je,Jr=$e;for(;;){const Fr=Ot>0?(Math.floor(Sr/F)+1)*F:(Math.ceil(Sr/F)-1)*F,ln=ze>0?(Math.floor(Jr/F)+1)*F:(Math.ceil(Jr/F)-1)*F,Qr=Math.abs(Sr-Fr),cn=Math.abs(Jr-ln),zr=Math.abs(Sr-Xe),zn=Math.abs(Jr-ot),ni=vt?Qr/nt:Number.POSITIVE_INFINITY,ei=Ht?cn/Ft:Number.POSITIVE_INFINITY;if((zr<=Qr||!vt)&&(zn<=cn||!Ht))break;if(ni<ei&&vt||!Ht){Sr=Fr,Jr+=ze*ni;const Hn=new S(Sr,Math.round(Jr));$[$.length-1].x===Hn.x&&$[$.length-1].y===Hn.y||$.push(Hn)}else{Sr+=Ot*ei,Jr=ln;const Hn=new S(Math.round(Sr),Jr);$[$.length-1].x===Hn.x&&$[$.length-1].y===Hn.y||$.push(Hn)}}const Or=new S(Xe,ot);$[$.length-1].x===Or.x&&$[$.length-1].y===Or.y||$.push(Or)}return $}function one(m,c,g){if(c.length===0)throw new Error("Subdivision vertex ring is empty.");let x=0,C=m[2*c[0]];for(let Q=1;Q<c.length;Q++){const oe=m[2*c[Q]];oe<C&&(C=oe,x=Q)}const D=c.length;let F=x,$=(F+1)%D;for(;;){const Q=F-1>=0?F-1:D-1,oe=($+1)%D,he=m[2*c[Q]],ve=m[2*c[oe]],De=m[2*c[F]],je=m[2*c[F]+1],$e=m[2*c[$]+1];let Xe=!1;if(he<ve)Xe=!0;else if(he>ve)Xe=!1;else{const ot=$e-je,vt=-(m[2*c[$]]-De),Ht=je<$e?1:-1;((he-De)*ot+(m[2*c[Q]+1]-je)*vt)*Ht>((ve-De)*ot+(m[2*c[oe]+1]-je)*vt)*Ht&&(Xe=!0)}if(Xe){const ot=c[Q],vt=c[F],Ht=c[$];ot!==vt&&ot!==Ht&&vt!==Ht&&g.push(Ht,vt,ot),F--,F<0&&(F=D-1)}else{const ot=c[oe],vt=c[F],Ht=c[$];ot!==vt&&ot!==Ht&&vt!==Ht&&g.push(Ht,vt,ot),$++,$>=D&&($=0)}if(Q===oe)break}}function BD(m,c,g,x,C,D,F,$,Q){const oe=C.length/2,he=F&&$&&Q;if(oe<Gi.MAX_VERTEX_ARRAY_LENGTH){const ve=c.prepareSegment(oe,g,x),De=ve.vertexLength;for(let Xe=0;Xe<D.length;Xe+=3)x.emplaceBack(De+D[Xe],De+D[Xe+1],De+D[Xe+2]);let je,$e;ve.vertexLength+=oe,ve.primitiveLength+=D.length/3,he&&($e=F.prepareSegment(oe,g,$),je=$e.vertexLength,$e.vertexLength+=oe);for(let Xe=0;Xe<C.length;Xe+=2)m(C[Xe],C[Xe+1]);if(he)for(let Xe=0;Xe<Q.length;Xe++){const ot=Q[Xe];for(let vt=1;vt<ot.length;vt+=2)$.emplaceBack(je+ot[vt-1],je+ot[vt]);$e.primitiveLength+=ot.length/2}}else(function(ve,De,je,$e,Xe,ot){const vt=[];for(let Ft=0;Ft<$e.length/2;Ft++)vt.push(-1);const Ht={count:0};let Ot=0,ze=ve.getOrCreateLatestSegment(De,je),nt=ze.vertexLength;for(let Ft=2;Ft<Xe.length;Ft+=3){const Sr=Xe[Ft-2],Jr=Xe[Ft-1],Or=Xe[Ft];let Fr=vt[Sr]<Ot,ln=vt[Jr]<Ot,Qr=vt[Or]<Ot;ze.vertexLength+((Fr?1:0)+(ln?1:0)+(Qr?1:0))>Gi.MAX_VERTEX_ARRAY_LENGTH&&(ze=ve.createNewSegment(De,je),Ot=Ht.count,Fr=!0,ln=!0,Qr=!0,nt=0);const cn=i_(vt,$e,ot,Ht,Sr,Fr,ze),zr=i_(vt,$e,ot,Ht,Jr,ln,ze),zn=i_(vt,$e,ot,Ht,Or,Qr,ze);je.emplaceBack(nt+cn-Ot,nt+zr-Ot,nt+zn-Ot),ze.primitiveLength++}})(c,g,x,C,D,m),he&&(function(ve,De,je,$e,Xe,ot){const vt=[];for(let Ft=0;Ft<$e.length/2;Ft++)vt.push(-1);const Ht={count:0};let Ot=0,ze=ve.getOrCreateLatestSegment(De,je),nt=ze.vertexLength;for(let Ft=0;Ft<Xe.length;Ft++){const Sr=Xe[Ft];for(let Jr=1;Jr<Xe[Ft].length;Jr+=2){const Or=Sr[Jr-1],Fr=Sr[Jr];let ln=vt[Or]<Ot,Qr=vt[Fr]<Ot;ze.vertexLength+((ln?1:0)+(Qr?1:0))>Gi.MAX_VERTEX_ARRAY_LENGTH&&(ze=ve.createNewSegment(De,je),Ot=Ht.count,ln=!0,Qr=!0,nt=0);const cn=i_(vt,$e,ot,Ht,Or,ln,ze),zr=i_(vt,$e,ot,Ht,Fr,Qr,ze);je.emplaceBack(nt+cn-Ot,nt+zr-Ot),ze.primitiveLength++}}})(F,g,$,C,Q,m),c.forceNewSegmentOnNextPrepare(),F?.forceNewSegmentOnNextPrepare()}function i_(m,c,g,x,C,D,F){if(D){const $=x.count;return g(c[2*C],c[2*C+1]),m[C]=x.count,x.count++,F.vertexLength++,$}return m[C]}class wC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ar,this.indexArray=new oa,this.indexArray2=new aa,this.programConfigurations=new kf(c.layers,c.zoom),this.segments=new Gi,this.segments2=new Gi,this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id))}populate(c,g,x){this.hasPattern=vC("fill",this.layers,g);const C=this.layers[0].layout.get("fill-sort-key"),D=!C.isConstant(),F=[];for(const{feature:$,id:Q,index:oe,sourceLayerIndex:he}of c){const ve=this.layers[0]._featureFilter.needGeometry,De=Sg($,ve);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom,{globalState:this.globalState}),De,x))continue;const je=D?C.evaluate(De,{},x,g.availableImages):void 0,$e={id:Q,properties:$.properties,type:$.type,sourceLayerIndex:he,index:oe,geometry:ve?De.geometry:wg($),patterns:{},sortKey:je};F.push($e)}D&&F.sort((($,Q)=>$.sortKey-Q.sortKey));for(const $ of F){const{geometry:Q,index:oe,sourceLayerIndex:he}=$;if(this.hasPattern){const ve=_C("fill",this.layers,$,this.zoom,g);this.patternFeatures.push(ve)}else this.addFeature($,Q,oe,x,{},g.subdivisionGranularity);g.featureIndex.insert(c[oe].feature,Q,oe,he,this.index)}}update(c,g,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,g,this.stateDependentLayers,x)}addFeatures(c,g,x){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,g,x,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Yre),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,g,x,C,D,F){for(const $ of ls(g,500)){const Q=FD($,C,F.fill.getGranularityForZoomLevel(C.z)),oe=this.layoutVertexArray;BD(((he,ve)=>{oe.emplaceBack(he,ve)}),this.segments,this.layoutVertexArray,this.indexArray,Q.verticesFlattened,Q.indicesTriangles,this.segments2,this.indexArray2,Q.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,D,C)}}let zD,jD;xt("FillBucket",wC,{omit:["layers","patternFeatures"]});var sne={get paint(){return jD=jD||new to({"fill-antialias":new sn(Ct.paint_fill["fill-antialias"]),"fill-opacity":new Sn(Ct.paint_fill["fill-opacity"]),"fill-color":new Sn(Ct.paint_fill["fill-color"]),"fill-outline-color":new Sn(Ct.paint_fill["fill-outline-color"]),"fill-translate":new sn(Ct.paint_fill["fill-translate"]),"fill-translate-anchor":new sn(Ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new eo(Ct.paint_fill["fill-pattern"])})},get layout(){return zD=zD||new to({"fill-sort-key":new Sn(Ct.layout_fill["fill-sort-key"])})}};class lne extends Sa{constructor(c){super(c,sne)}recalculate(c,g){super.recalculate(c,g);const x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new wC(c)}queryRadius(){return xx(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:c,geometry:g,transform:x,pixelsToTileUnits:C}){return vD(wx(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-x.bearingInRadians,C),g)}isTileClipped(){return!0}}const une=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),cne=Ki([{name:"a_centroid",components:2,type:"Int16"}],4),{members:hne}=une;var SC,UD,EC,VD,TC,$D,qD,Cx={};function HD(){if(UD)return SC;UD=1;var m=d();function c(C,D,F,$,Q){this.properties={},this.extent=F,this.type=0,this._pbf=C,this._geometry=-1,this._keys=$,this._values=Q,C.readFields(g,this,D)}function g(C,D,F){C==1?D.id=F.readVarint():C==2?(function($,Q){for(var oe=$.readVarint()+$.pos;$.pos<oe;){var he=Q._keys[$.readVarint()],ve=Q._values[$.readVarint()];Q.properties[he]=ve}})(F,D):C==3?D.type=F.readVarint():C==4&&(D._geometry=F.pos)}function x(C){for(var D,F,$=0,Q=0,oe=C.length,he=oe-1;Q<oe;he=Q++)$+=((F=C[he]).x-(D=C[Q]).x)*(D.y+F.y);return $}return SC=c,c.types=["Unknown","Point","LineString","Polygon"],c.prototype.loadGeometry=function(){var C=this._pbf;C.pos=this._geometry;for(var D,F=C.readVarint()+C.pos,$=1,Q=0,oe=0,he=0,ve=[];C.pos<F;){if(Q<=0){var De=C.readVarint();$=7&De,Q=De>>3}if(Q--,$===1||$===2)oe+=C.readSVarint(),he+=C.readSVarint(),$===1&&(D&&ve.push(D),D=[]),D.push(new m(oe,he));else{if($!==7)throw new Error("unknown command "+$);D&&D.push(D[0].clone())}}return D&&ve.push(D),ve},c.prototype.bbox=function(){var C=this._pbf;C.pos=this._geometry;for(var D=C.readVarint()+C.pos,F=1,$=0,Q=0,oe=0,he=1/0,ve=-1/0,De=1/0,je=-1/0;C.pos<D;){if($<=0){var $e=C.readVarint();F=7&$e,$=$e>>3}if($--,F===1||F===2)(Q+=C.readSVarint())<he&&(he=Q),Q>ve&&(ve=Q),(oe+=C.readSVarint())<De&&(De=oe),oe>je&&(je=oe);else if(F!==7)throw new Error("unknown command "+F)}return[he,De,ve,je]},c.prototype.toGeoJSON=function(C,D,F){var $,Q,oe=this.extent*Math.pow(2,F),he=this.extent*C,ve=this.extent*D,De=this.loadGeometry(),je=c.types[this.type];function $e(vt){for(var Ht=0;Ht<vt.length;Ht++){var Ot=vt[Ht];vt[Ht]=[360*(Ot.x+he)/oe-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ot.y+ve)/oe)*Math.PI/180))-90]}}switch(this.type){case 1:var Xe=[];for($=0;$<De.length;$++)Xe[$]=De[$][0];$e(De=Xe);break;case 2:for($=0;$<De.length;$++)$e(De[$]);break;case 3:for(De=(function(vt){var Ht=vt.length;if(Ht<=1)return[vt];for(var Ot,ze,nt=[],Ft=0;Ft<Ht;Ft++){var Sr=x(vt[Ft]);Sr!==0&&(ze===void 0&&(ze=Sr<0),ze===Sr<0?(Ot&&nt.push(Ot),Ot=[vt[Ft]]):Ot.push(vt[Ft]))}return Ot&&nt.push(Ot),nt})(De),$=0;$<De.length;$++)for(Q=0;Q<De[$].length;Q++)$e(De[$][Q])}De.length===1?De=De[0]:je="Multi"+je;var ot={type:"Feature",geometry:{type:je,coordinates:De},properties:this.properties};return"id"in this&&(ot.id=this.id),ot},SC}function WD(){if(VD)return EC;VD=1;var m=HD();function c(x,C){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=x,this._keys=[],this._values=[],this._features=[],x.readFields(g,this,C),this.length=this._features.length}function g(x,C,D){x===15?C.version=D.readVarint():x===1?C.name=D.readString():x===5?C.extent=D.readVarint():x===2?C._features.push(D.pos):x===3?C._keys.push(D.readString()):x===4&&C._values.push((function(F){for(var $=null,Q=F.readVarint()+F.pos;F.pos<Q;){var oe=F.readVarint()>>3;$=oe===1?F.readString():oe===2?F.readFloat():oe===3?F.readDouble():oe===4?F.readVarint64():oe===5?F.readVarint():oe===6?F.readSVarint():oe===7?F.readBoolean():null}return $})(D))}return EC=c,c.prototype.feature=function(x){if(x<0||x>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[x];var C=this._pbf.readVarint()+this._pbf.pos;return new m(this._pbf,C,this.extent,this._keys,this._values)},EC}function GD(){return qD||(qD=1,Cx.VectorTile=(function(){if($D)return TC;$D=1;var m=WD();function c(g,x,C){if(g===3){var D=new m(C,C.readVarint()+C.pos);D.length&&(x[D.name]=D)}}return TC=function(g,x){this.layers=g.readFields(c,{},x)},TC})(),Cx.VectorTileFeature=HD(),Cx.VectorTileLayer=WD()),Cx}var a_=u(GD());const fne=a_.VectorTileFeature.types,CC=Math.pow(2,13);function o_(m,c,g,x,C,D,F,$){m.emplaceBack(c,g,2*Math.floor(x*CC)+F,C*CC*2,D*CC*2,Math.round($))}class AC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new gn,this.centroidVertexArray=new vr,this.indexArray=new oa,this.programConfigurations=new kf(c.layers,c.zoom),this.segments=new Gi,this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id))}populate(c,g,x){this.features=[],this.hasPattern=vC("fill-extrusion",this.layers,g);for(const{feature:C,id:D,index:F,sourceLayerIndex:$}of c){const Q=this.layers[0]._featureFilter.needGeometry,oe=Sg(C,Q);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom,{globalState:this.globalState}),oe,x))continue;const he={id:D,sourceLayerIndex:$,index:F,geometry:Q?oe.geometry:wg(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(_C("fill-extrusion",this.layers,he,this.zoom,g)):this.addFeature(he,he.geometry,F,x,{},g.subdivisionGranularity),g.featureIndex.insert(C,he.geometry,F,$,this.index,!0)}}addFeatures(c,g,x){for(const C of this.features){const{geometry:D}=C;this.addFeature(C,D,C.index,g,x,c.subdivisionGranularity)}}update(c,g,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,g,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,hne),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,cne.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,g,x,C,D,F){for(const $ of ls(g,500)){const Q={x:0,y:0,sampleCount:0},oe=this.layoutVertexArray.length;this.processPolygon(Q,C,c,$,F);const he=this.layoutVertexArray.length-oe,ve=Math.floor(Q.x/Q.sampleCount),De=Math.floor(Q.y/Q.sampleCount);for(let je=0;je<he;je++)this.centroidVertexArray.emplaceBack(ve,De)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,D,C)}processPolygon(c,g,x,C,D){if(C.length<1||XD(C[0]))return;for(const ve of C)ve.length!==0&&dne(c,ve);const F={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},$=D.fill.getGranularityForZoomLevel(g.z),Q=fne[x.type]==="Polygon";for(const ve of C){if(ve.length===0||XD(ve))continue;const De=Tg(ve,$,Q);this._generateSideFaces(De,F)}if(!Q)return;const oe=FD(C,g,$,!1),he=this.layoutVertexArray;BD(((ve,De)=>{o_(he,ve,De,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,oe.verticesFlattened,oe.indicesTriangles)}_generateSideFaces(c,g){let x=0;for(let C=1;C<c.length;C++){const D=c[C],F=c[C-1];if(pne(D,F))continue;g.segment.vertexLength+4>Gi.MAX_VERTEX_ARRAY_LENGTH&&(g.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const $=D.sub(F)._perp()._unit(),Q=F.dist(D);x+Q>32768&&(x=0),o_(this.layoutVertexArray,D.x,D.y,$.x,$.y,0,0,x),o_(this.layoutVertexArray,D.x,D.y,$.x,$.y,0,1,x),x+=Q,o_(this.layoutVertexArray,F.x,F.y,$.x,$.y,0,0,x),o_(this.layoutVertexArray,F.x,F.y,$.x,$.y,0,1,x);const oe=g.segment.vertexLength;this.indexArray.emplaceBack(oe,oe+2,oe+1),this.indexArray.emplaceBack(oe+1,oe+2,oe+3),g.segment.vertexLength+=4,g.segment.primitiveLength+=2}}}function dne(m,c){for(let g=0;g<c.length;g++){const x=c[g];g===c.length-1&&c[0].x===x.x&&c[0].y===x.y||(m.x+=x.x,m.y+=x.y,m.sampleCount++)}}function pne(m,c){return m.x===c.x&&(m.x<0||m.x>ce)||m.y===c.y&&(m.y<0||m.y>ce)}function XD(m){return m.every((c=>c.x<0))||m.every((c=>c.x>ce))||m.every((c=>c.y<0))||m.every((c=>c.y>ce))}let YD;xt("FillExtrusionBucket",AC,{omit:["layers","features"]});var gne={get paint(){return YD=YD||new to({"fill-extrusion-opacity":new sn(Ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sn(Ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new sn(Ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new sn(Ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new eo(Ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sn(Ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sn(Ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new sn(Ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class mne extends Sa{constructor(c){super(c,gne)}createBucket(c){return new AC(c)}queryRadius(){return xx(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:c,feature:g,featureState:x,geometry:C,transform:D,pixelsToTileUnits:F,pixelPosMatrix:$}){const Q=wx(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-D.bearingInRadians,F),oe=this.paint.get("fill-extrusion-height").evaluate(g,x),he=this.paint.get("fill-extrusion-base").evaluate(g,x),ve=(function(je,$e){const Xe=[];for(const ot of je){const vt=[ot.x,ot.y,0,1];Pe(vt,vt,$e),Xe.push(new S(vt[0]/vt[3],vt[1]/vt[3]))}return Xe})(Q,$),De=(function(je,$e,Xe,ot){const vt=[],Ht=[],Ot=ot[8]*$e,ze=ot[9]*$e,nt=ot[10]*$e,Ft=ot[11]*$e,Sr=ot[8]*Xe,Jr=ot[9]*Xe,Or=ot[10]*Xe,Fr=ot[11]*Xe;for(const ln of je){const Qr=[],cn=[];for(const zr of ln){const zn=zr.x,ni=zr.y,ei=ot[0]*zn+ot[4]*ni+ot[12],Hn=ot[1]*zn+ot[5]*ni+ot[13],Qi=ot[2]*zn+ot[6]*ni+ot[14],$o=ot[3]*zn+ot[7]*ni+ot[15],js=Qi+nt,Yl=$o+Ft,Uc=ei+Sr,ec=Hn+Jr,Pl=Qi+Or,Lo=$o+Fr,ul=new S((ei+Ot)/Yl,(Hn+ze)/Yl);ul.z=js/Yl,Qr.push(ul);const kl=new S(Uc/Lo,ec/Lo);kl.z=Pl/Lo,cn.push(kl)}vt.push(Qr),Ht.push(cn)}return[vt,Ht]})(C,he,oe,$);return(function(je,$e,Xe){let ot=1/0;vD(Xe,$e)&&(ot=ZD(Xe,$e[0]));for(let vt=0;vt<$e.length;vt++){const Ht=$e[vt],Ot=je[vt];for(let ze=0;ze<Ht.length-1;ze++){const nt=Ht[ze],Ft=[nt,Ht[ze+1],Ot[ze+1],Ot[ze],nt];yD(Xe,Ft)&&(ot=Math.min(ot,ZD(Xe,Ft)))}}return ot!==1/0&&ot})(De[0],De[1],ve)}}function s_(m,c){return m.x*c.x+m.y*c.y}function ZD(m,c){if(m.length===1){let g=0;const x=c[g++];let C;for(;!C||x.equals(C);)if(C=c[g++],!C)return 1/0;for(;g<c.length;g++){const D=c[g],F=m[0],$=C.sub(x),Q=D.sub(x),oe=F.sub(x),he=s_($,$),ve=s_($,Q),De=s_(Q,Q),je=s_(oe,$),$e=s_(oe,Q),Xe=he*De-ve*ve,ot=(De*je-ve*$e)/Xe,vt=(he*$e-ve*je)/Xe,Ht=x.z*(1-ot-vt)+C.z*ot+D.z*vt;if(isFinite(Ht))return Ht}return 1/0}{let g=1/0;for(const x of c)g=Math.min(g,x.z);return g}}const yne=Ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:vne}=yne,_ne=Ki([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:bne}=_ne,xne=a_.VectorTileFeature.types,wne=Math.cos(Math.PI/180*37.5),KD=Math.pow(2,14)/.5;class IC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((g=>{this.gradients[g.id]={}})),this.layoutVertexArray=new dn,this.layoutVertexArray2=new Yr,this.indexArray=new oa,this.programConfigurations=new kf(c.layers,c.zoom),this.segments=new Gi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id))}populate(c,g,x){this.hasPattern=vC("line",this.layers,g);const C=this.layers[0].layout.get("line-sort-key"),D=!C.isConstant(),F=[];for(const{feature:$,id:Q,index:oe,sourceLayerIndex:he}of c){const ve=this.layers[0]._featureFilter.needGeometry,De=Sg($,ve);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom,{globalState:this.globalState}),De,x))continue;const je=D?C.evaluate(De,{},x):void 0,$e={id:Q,properties:$.properties,type:$.type,sourceLayerIndex:he,index:oe,geometry:ve?De.geometry:wg($),patterns:{},sortKey:je};F.push($e)}D&&F.sort((($,Q)=>$.sortKey-Q.sortKey));for(const $ of F){const{geometry:Q,index:oe,sourceLayerIndex:he}=$;if(this.hasPattern){const ve=_C("line",this.layers,$,this.zoom,g);this.patternFeatures.push(ve)}else this.addFeature($,Q,oe,x,{},g.subdivisionGranularity);g.featureIndex.insert(c[oe].feature,Q,oe,he,this.index)}}update(c,g,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,g,this.stateDependentLayers,x)}addFeatures(c,g,x){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,g,x,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,bne)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,vne),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,g,x,C,D,F){const $=this.layers[0].layout,Q=$.get("line-join").evaluate(c,{}),oe=$.get("line-cap"),he=$.get("line-miter-limit"),ve=$.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const De of g)this.addLine(De,c,Q,oe,he,ve,C,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,D,C)}addLine(c,g,x,C,D,F,$,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,c=Tg(c,$?Q.line.getGranularityForZoomLevel($.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ot=0;Ot<c.length-1;Ot++)this.totalDistance+=c[Ot].dist(c[Ot+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const oe=xne[g.type]==="Polygon";let he=c.length;for(;he>=2&&c[he-1].equals(c[he-2]);)he--;let ve=0;for(;ve<he-1&&c[ve].equals(c[ve+1]);)ve++;if(he<(oe?3:2))return;x==="bevel"&&(D=1.05);const De=this.overscaling<=16?122880/(512*this.overscaling):0,je=this.segments.prepareSegment(10*he,this.layoutVertexArray,this.indexArray);let $e,Xe,ot,vt,Ht;this.e1=this.e2=-1,oe&&($e=c[he-2],Ht=c[ve].sub($e)._unit()._perp());for(let Ot=ve;Ot<he;Ot++){if(ot=Ot===he-1?oe?c[ve+1]:void 0:c[Ot+1],ot&&c[Ot].equals(ot))continue;Ht&&(vt=Ht),$e&&(Xe=$e),$e=c[Ot],Ht=ot?ot.sub($e)._unit()._perp():vt,vt=vt||Ht;let ze=vt.add(Ht);ze.x===0&&ze.y===0||ze._unit();const nt=vt.x*Ht.x+vt.y*Ht.y,Ft=ze.x*Ht.x+ze.y*Ht.y,Sr=Ft!==0?1/Ft:1/0,Jr=2*Math.sqrt(2-2*Ft),Or=Ft<wne&&Xe&&ot,Fr=vt.x*Ht.y-vt.y*Ht.x>0;if(Or&&Ot>ve){const cn=$e.dist(Xe);if(cn>2*De){const zr=$e.sub($e.sub(Xe)._mult(De/cn)._round());this.updateDistance(Xe,zr),this.addCurrentVertex(zr,vt,0,0,je),Xe=zr}}const ln=Xe&&ot;let Qr=ln?x:oe?"butt":C;if(ln&&Qr==="round"&&(Sr<F?Qr="miter":Sr<=2&&(Qr="fakeround")),Qr==="miter"&&Sr>D&&(Qr="bevel"),Qr==="bevel"&&(Sr>2&&(Qr="flipbevel"),Sr<D&&(Qr="miter")),Xe&&this.updateDistance(Xe,$e),Qr==="miter")ze._mult(Sr),this.addCurrentVertex($e,ze,0,0,je);else if(Qr==="flipbevel"){if(Sr>100)ze=Ht.mult(-1);else{const cn=Sr*vt.add(Ht).mag()/vt.sub(Ht).mag();ze._perp()._mult(cn*(Fr?-1:1))}this.addCurrentVertex($e,ze,0,0,je),this.addCurrentVertex($e,ze.mult(-1),0,0,je)}else if(Qr==="bevel"||Qr==="fakeround"){const cn=-Math.sqrt(Sr*Sr-1),zr=Fr?cn:0,zn=Fr?0:cn;if(Xe&&this.addCurrentVertex($e,vt,zr,zn,je),Qr==="fakeround"){const ni=Math.round(180*Jr/Math.PI/20);for(let ei=1;ei<ni;ei++){let Hn=ei/ni;if(Hn!==.5){const $o=Hn-.5;Hn+=Hn*$o*(Hn-1)*((1.0904+nt*(nt*(3.55645-1.43519*nt)-3.2452))*$o*$o+(.848013+nt*(.215638*nt-1.06021)))}const Qi=Ht.sub(vt)._mult(Hn)._add(vt)._unit()._mult(Fr?-1:1);this.addHalfVertex($e,Qi.x,Qi.y,!1,Fr,0,je)}}ot&&this.addCurrentVertex($e,Ht,-zr,-zn,je)}else if(Qr==="butt")this.addCurrentVertex($e,ze,0,0,je);else if(Qr==="square"){const cn=Xe?1:-1;this.addCurrentVertex($e,ze,cn,cn,je)}else Qr==="round"&&(Xe&&(this.addCurrentVertex($e,vt,0,0,je),this.addCurrentVertex($e,vt,1,1,je,!0)),ot&&(this.addCurrentVertex($e,Ht,-1,-1,je,!0),this.addCurrentVertex($e,Ht,0,0,je)));if(Or&&Ot<he-1){const cn=$e.dist(ot);if(cn>2*De){const zr=$e.add(ot.sub($e)._mult(De/cn)._round());this.updateDistance($e,zr),this.addCurrentVertex(zr,Ht,0,0,je),$e=zr}}}}addCurrentVertex(c,g,x,C,D,F=!1){const $=g.y*C-g.x,Q=-g.y-g.x*C;this.addHalfVertex(c,g.x+g.y*x,g.y-g.x*x,F,!1,x,D),this.addHalfVertex(c,$,Q,F,!0,-C,D),this.distance>KD/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,g,x,C,D,F))}addHalfVertex({x:c,y:g},x,C,D,F,$,Q){const oe=.5*(this.lineClips?this.scaledDistance*(KD-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(D?1:0),(g<<1)+(F?1:0),Math.round(63*x)+128,Math.round(63*C)+128,1+($===0?0:$<0?-1:1)|(63&oe)<<2,oe>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const he=Q.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,he,this.e2),Q.primitiveLength++),F?this.e2=he:this.e1=he}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,g){this.distance+=c.dist(g),this.updateScaledDistance()}}let JD,QD;xt("LineBucket",IC,{omit:["layers","patternFeatures"]});var e6={get paint(){return QD=QD||new to({"line-opacity":new Sn(Ct.paint_line["line-opacity"]),"line-color":new Sn(Ct.paint_line["line-color"]),"line-translate":new sn(Ct.paint_line["line-translate"]),"line-translate-anchor":new sn(Ct.paint_line["line-translate-anchor"]),"line-width":new Sn(Ct.paint_line["line-width"]),"line-gap-width":new Sn(Ct.paint_line["line-gap-width"]),"line-offset":new Sn(Ct.paint_line["line-offset"]),"line-blur":new Sn(Ct.paint_line["line-blur"]),"line-dasharray":new ga(Ct.paint_line["line-dasharray"]),"line-pattern":new eo(Ct.paint_line["line-pattern"]),"line-gradient":new Uo(Ct.paint_line["line-gradient"])})},get layout(){return JD=JD||new to({"line-cap":new sn(Ct.layout_line["line-cap"]),"line-join":new Sn(Ct.layout_line["line-join"]),"line-miter-limit":new sn(Ct.layout_line["line-miter-limit"]),"line-round-limit":new sn(Ct.layout_line["line-round-limit"]),"line-sort-key":new Sn(Ct.layout_line["line-sort-key"])})}};class Sne extends Sn{possiblyEvaluate(c,g){return g=new qn(Math.floor(g.zoom),{now:g.now,fadeDuration:g.fadeDuration,zoomHistory:g.zoomHistory,transition:g.transition}),super.possiblyEvaluate(c,g)}evaluate(c,g,x,C){return g=Qe({},g,{zoom:Math.floor(g.zoom)}),super.evaluate(c,g,x,C)}}let Ax;class Ene extends Sa{constructor(c){super(c,e6),this.gradientVersion=0,Ax||(Ax=new Sne(e6.paint.properties["line-width"].specification),Ax.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const g=this.gradientExpression();this.stepInterpolant=!!(function(x){return x._styleExpression!==void 0})(g)&&g._styleExpression.expression instanceof Vr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,g){super.recalculate(c,g),this.paint._values["line-floorwidth"]=Ax.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new IC(c)}queryRadius(c){const g=c,x=t6(K0("line-width",this,g),K0("line-gap-width",this,g)),C=K0("line-offset",this,g);return x/2+Math.abs(C)+xx(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:c,feature:g,featureState:x,geometry:C,transform:D,pixelsToTileUnits:F}){const $=wx(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-D.bearingInRadians,F),Q=F/2*t6(this.paint.get("line-width").evaluate(g,x),this.paint.get("line-gap-width").evaluate(g,x)),oe=this.paint.get("line-offset").evaluate(g,x);return oe&&(C=(function(he,ve){const De=[];for(let je=0;je<he.length;je++){const $e=he[je],Xe=[];for(let ot=0;ot<$e.length;ot++){const vt=$e[ot-1],Ht=$e[ot],Ot=$e[ot+1],ze=ot===0?new S(0,0):Ht.sub(vt)._unit()._perp(),nt=ot===$e.length-1?new S(0,0):Ot.sub(Ht)._unit()._perp(),Ft=ze._add(nt)._unit(),Sr=Ft.x*nt.x+Ft.y*nt.y;Sr!==0&&Ft._mult(1/Sr),Xe.push(Ft._mult(ve)._add(Ht))}De.push(Xe)}return De})(C,oe*F)),(function(he,ve,De){for(let je=0;je<ve.length;je++){const $e=ve[je];if(he.length>=3){for(let Xe=0;Xe<$e.length;Xe++)if(ly(he,$e[Xe]))return!0}if(Fre(he,$e,De))return!0}return!1})($,C,Q)}isTileClipped(){return!0}}function t6(m,c){return c>0?c+2*m:m}const Tne=Ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Cne=Ki([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ane=Ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ki([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const r6=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ine=Ki([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Pne(m,c,g){return m.sections.forEach((x=>{x.text=(function(C,D,F){const $=D.layout.get("text-transform").evaluate(F,{});return $==="uppercase"?C=C.toLocaleUpperCase():$==="lowercase"&&(C=C.toLocaleLowerCase()),Pa.applyArabicShaping&&(C=Pa.applyArabicShaping(C)),C})(x.text,c,g)})),m}Ki([{name:"triangle",components:3,type:"Uint16"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ki([{type:"Float32",name:"offsetX"}]),Ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ki([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const l_={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var n6,PC,i6,ll=24,kC={};function kne(){return n6||(n6=1,kC.read=function(m,c,g,x,C){var D,F,$=8*C-x-1,Q=(1<<$)-1,oe=Q>>1,he=-7,ve=g?C-1:0,De=g?-1:1,je=m[c+ve];for(ve+=De,D=je&(1<<-he)-1,je>>=-he,he+=$;he>0;D=256*D+m[c+ve],ve+=De,he-=8);for(F=D&(1<<-he)-1,D>>=-he,he+=x;he>0;F=256*F+m[c+ve],ve+=De,he-=8);if(D===0)D=1-oe;else{if(D===Q)return F?NaN:1/0*(je?-1:1);F+=Math.pow(2,x),D-=oe}return(je?-1:1)*F*Math.pow(2,D-x)},kC.write=function(m,c,g,x,C,D){var F,$,Q,oe=8*D-C-1,he=(1<<oe)-1,ve=he>>1,De=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,je=x?0:D-1,$e=x?1:-1,Xe=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?($=isNaN(c)?1:0,F=he):(F=Math.floor(Math.log(c)/Math.LN2),c*(Q=Math.pow(2,-F))<1&&(F--,Q*=2),(c+=F+ve>=1?De/Q:De*Math.pow(2,1-ve))*Q>=2&&(F++,Q/=2),F+ve>=he?($=0,F=he):F+ve>=1?($=(c*Q-1)*Math.pow(2,C),F+=ve):($=c*Math.pow(2,ve-1)*Math.pow(2,C),F=0));C>=8;m[g+je]=255&$,je+=$e,$/=256,C-=8);for(F=F<<C|$,oe+=C;oe>0;m[g+je]=255&F,je+=$e,F/=256,oe-=8);m[g+je-$e]|=128*Xe}),kC}function a6(){if(i6)return PC;i6=1,PC=c;var m=kne();function c(ze){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ze)?ze:new Uint8Array(ze||0),this.pos=0,this.type=0,this.length=this.buf.length}c.Varint=0,c.Fixed64=1,c.Bytes=2,c.Fixed32=5;var g=4294967296,x=1/g,C=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function D(ze){return ze.type===c.Bytes?ze.readVarint()+ze.pos:ze.pos+1}function F(ze,nt,Ft){return Ft?4294967296*nt+(ze>>>0):4294967296*(nt>>>0)+(ze>>>0)}function $(ze,nt,Ft){var Sr=nt<=16383?1:nt<=2097151?2:nt<=268435455?3:Math.floor(Math.log(nt)/(7*Math.LN2));Ft.realloc(Sr);for(var Jr=Ft.pos-1;Jr>=ze;Jr--)Ft.buf[Jr+Sr]=Ft.buf[Jr]}function Q(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeVarint(ze[Ft])}function oe(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeSVarint(ze[Ft])}function he(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeFloat(ze[Ft])}function ve(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeDouble(ze[Ft])}function De(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeBoolean(ze[Ft])}function je(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeFixed32(ze[Ft])}function $e(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeSFixed32(ze[Ft])}function Xe(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeFixed64(ze[Ft])}function ot(ze,nt){for(var Ft=0;Ft<ze.length;Ft++)nt.writeSFixed64(ze[Ft])}function vt(ze,nt){return(ze[nt]|ze[nt+1]<<8|ze[nt+2]<<16)+16777216*ze[nt+3]}function Ht(ze,nt,Ft){ze[Ft]=nt,ze[Ft+1]=nt>>>8,ze[Ft+2]=nt>>>16,ze[Ft+3]=nt>>>24}function Ot(ze,nt){return(ze[nt]|ze[nt+1]<<8|ze[nt+2]<<16)+(ze[nt+3]<<24)}return c.prototype={destroy:function(){this.buf=null},readFields:function(ze,nt,Ft){for(Ft=Ft||this.length;this.pos<Ft;){var Sr=this.readVarint(),Jr=Sr>>3,Or=this.pos;this.type=7&Sr,ze(Jr,nt,this),this.pos===Or&&this.skip(Sr)}return nt},readMessage:function(ze,nt){return this.readFields(ze,nt,this.readVarint()+this.pos)},readFixed32:function(){var ze=vt(this.buf,this.pos);return this.pos+=4,ze},readSFixed32:function(){var ze=Ot(this.buf,this.pos);return this.pos+=4,ze},readFixed64:function(){var ze=vt(this.buf,this.pos)+vt(this.buf,this.pos+4)*g;return this.pos+=8,ze},readSFixed64:function(){var ze=vt(this.buf,this.pos)+Ot(this.buf,this.pos+4)*g;return this.pos+=8,ze},readFloat:function(){var ze=m.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ze},readDouble:function(){var ze=m.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ze},readVarint:function(ze){var nt,Ft,Sr=this.buf;return nt=127&(Ft=Sr[this.pos++]),Ft<128?nt:(nt|=(127&(Ft=Sr[this.pos++]))<<7,Ft<128?nt:(nt|=(127&(Ft=Sr[this.pos++]))<<14,Ft<128?nt:(nt|=(127&(Ft=Sr[this.pos++]))<<21,Ft<128?nt:(function(Jr,Or,Fr){var ln,Qr,cn=Fr.buf;if(ln=(112&(Qr=cn[Fr.pos++]))>>4,Qr<128||(ln|=(127&(Qr=cn[Fr.pos++]))<<3,Qr<128)||(ln|=(127&(Qr=cn[Fr.pos++]))<<10,Qr<128)||(ln|=(127&(Qr=cn[Fr.pos++]))<<17,Qr<128)||(ln|=(127&(Qr=cn[Fr.pos++]))<<24,Qr<128)||(ln|=(1&(Qr=cn[Fr.pos++]))<<31,Qr<128))return F(Jr,ln,Or);throw new Error("Expected varint not more than 10 bytes")})(nt|=(15&(Ft=Sr[this.pos]))<<28,ze,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ze=this.readVarint();return ze%2==1?(ze+1)/-2:ze/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ze=this.readVarint()+this.pos,nt=this.pos;return this.pos=ze,ze-nt>=12&&C?(function(Ft,Sr,Jr){return C.decode(Ft.subarray(Sr,Jr))})(this.buf,nt,ze):(function(Ft,Sr,Jr){for(var Or="",Fr=Sr;Fr<Jr;){var ln,Qr,cn,zr=Ft[Fr],zn=null,ni=zr>239?4:zr>223?3:zr>191?2:1;if(Fr+ni>Jr)break;ni===1?zr<128&&(zn=zr):ni===2?(192&(ln=Ft[Fr+1]))==128&&(zn=(31&zr)<<6|63&ln)<=127&&(zn=null):ni===3?(Qr=Ft[Fr+2],(192&(ln=Ft[Fr+1]))==128&&(192&Qr)==128&&((zn=(15&zr)<<12|(63&ln)<<6|63&Qr)<=2047||zn>=55296&&zn<=57343)&&(zn=null)):ni===4&&(Qr=Ft[Fr+2],cn=Ft[Fr+3],(192&(ln=Ft[Fr+1]))==128&&(192&Qr)==128&&(192&cn)==128&&((zn=(15&zr)<<18|(63&ln)<<12|(63&Qr)<<6|63&cn)<=65535||zn>=1114112)&&(zn=null)),zn===null?(zn=65533,ni=1):zn>65535&&(zn-=65536,Or+=String.fromCharCode(zn>>>10&1023|55296),zn=56320|1023&zn),Or+=String.fromCharCode(zn),Fr+=ni}return Or})(this.buf,nt,ze)},readBytes:function(){var ze=this.readVarint()+this.pos,nt=this.buf.subarray(this.pos,ze);return this.pos=ze,nt},readPackedVarint:function(ze,nt){if(this.type!==c.Bytes)return ze.push(this.readVarint(nt));var Ft=D(this);for(ze=ze||[];this.pos<Ft;)ze.push(this.readVarint(nt));return ze},readPackedSVarint:function(ze){if(this.type!==c.Bytes)return ze.push(this.readSVarint());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readSVarint());return ze},readPackedBoolean:function(ze){if(this.type!==c.Bytes)return ze.push(this.readBoolean());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readBoolean());return ze},readPackedFloat:function(ze){if(this.type!==c.Bytes)return ze.push(this.readFloat());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readFloat());return ze},readPackedDouble:function(ze){if(this.type!==c.Bytes)return ze.push(this.readDouble());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readDouble());return ze},readPackedFixed32:function(ze){if(this.type!==c.Bytes)return ze.push(this.readFixed32());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readFixed32());return ze},readPackedSFixed32:function(ze){if(this.type!==c.Bytes)return ze.push(this.readSFixed32());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readSFixed32());return ze},readPackedFixed64:function(ze){if(this.type!==c.Bytes)return ze.push(this.readFixed64());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readFixed64());return ze},readPackedSFixed64:function(ze){if(this.type!==c.Bytes)return ze.push(this.readSFixed64());var nt=D(this);for(ze=ze||[];this.pos<nt;)ze.push(this.readSFixed64());return ze},skip:function(ze){var nt=7&ze;if(nt===c.Varint)for(;this.buf[this.pos++]>127;);else if(nt===c.Bytes)this.pos=this.readVarint()+this.pos;else if(nt===c.Fixed32)this.pos+=4;else{if(nt!==c.Fixed64)throw new Error("Unimplemented type: "+nt);this.pos+=8}},writeTag:function(ze,nt){this.writeVarint(ze<<3|nt)},realloc:function(ze){for(var nt=this.length||16;nt<this.pos+ze;)nt*=2;if(nt!==this.length){var Ft=new Uint8Array(nt);Ft.set(this.buf),this.buf=Ft,this.length=nt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ze){this.realloc(4),Ht(this.buf,ze,this.pos),this.pos+=4},writeSFixed32:function(ze){this.realloc(4),Ht(this.buf,ze,this.pos),this.pos+=4},writeFixed64:function(ze){this.realloc(8),Ht(this.buf,-1&ze,this.pos),Ht(this.buf,Math.floor(ze*x),this.pos+4),this.pos+=8},writeSFixed64:function(ze){this.realloc(8),Ht(this.buf,-1&ze,this.pos),Ht(this.buf,Math.floor(ze*x),this.pos+4),this.pos+=8},writeVarint:function(ze){(ze=+ze||0)>268435455||ze<0?(function(nt,Ft){var Sr,Jr;if(nt>=0?(Sr=nt%4294967296|0,Jr=nt/4294967296|0):(Jr=~(-nt/4294967296),4294967295^(Sr=~(-nt%4294967296))?Sr=Sr+1|0:(Sr=0,Jr=Jr+1|0)),nt>=18446744073709552e3||nt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Ft.realloc(10),(function(Or,Fr,ln){ln.buf[ln.pos++]=127&Or|128,Or>>>=7,ln.buf[ln.pos++]=127&Or|128,Or>>>=7,ln.buf[ln.pos++]=127&Or|128,Or>>>=7,ln.buf[ln.pos++]=127&Or|128,ln.buf[ln.pos]=127&(Or>>>=7)})(Sr,0,Ft),(function(Or,Fr){var ln=(7&Or)<<4;Fr.buf[Fr.pos++]|=ln|((Or>>>=3)?128:0),Or&&(Fr.buf[Fr.pos++]=127&Or|((Or>>>=7)?128:0),Or&&(Fr.buf[Fr.pos++]=127&Or|((Or>>>=7)?128:0),Or&&(Fr.buf[Fr.pos++]=127&Or|((Or>>>=7)?128:0),Or&&(Fr.buf[Fr.pos++]=127&Or|((Or>>>=7)?128:0),Or&&(Fr.buf[Fr.pos++]=127&Or)))))})(Jr,Ft)})(ze,this):(this.realloc(4),this.buf[this.pos++]=127&ze|(ze>127?128:0),ze<=127||(this.buf[this.pos++]=127&(ze>>>=7)|(ze>127?128:0),ze<=127||(this.buf[this.pos++]=127&(ze>>>=7)|(ze>127?128:0),ze<=127||(this.buf[this.pos++]=ze>>>7&127))))},writeSVarint:function(ze){this.writeVarint(ze<0?2*-ze-1:2*ze)},writeBoolean:function(ze){this.writeVarint(!!ze)},writeString:function(ze){ze=String(ze),this.realloc(4*ze.length),this.pos++;var nt=this.pos;this.pos=(function(Sr,Jr,Or){for(var Fr,ln,Qr=0;Qr<Jr.length;Qr++){if((Fr=Jr.charCodeAt(Qr))>55295&&Fr<57344){if(!ln){Fr>56319||Qr+1===Jr.length?(Sr[Or++]=239,Sr[Or++]=191,Sr[Or++]=189):ln=Fr;continue}if(Fr<56320){Sr[Or++]=239,Sr[Or++]=191,Sr[Or++]=189,ln=Fr;continue}Fr=ln-55296<<10|Fr-56320|65536,ln=null}else ln&&(Sr[Or++]=239,Sr[Or++]=191,Sr[Or++]=189,ln=null);Fr<128?Sr[Or++]=Fr:(Fr<2048?Sr[Or++]=Fr>>6|192:(Fr<65536?Sr[Or++]=Fr>>12|224:(Sr[Or++]=Fr>>18|240,Sr[Or++]=Fr>>12&63|128),Sr[Or++]=Fr>>6&63|128),Sr[Or++]=63&Fr|128)}return Or})(this.buf,ze,this.pos);var Ft=this.pos-nt;Ft>=128&&$(nt,Ft,this),this.pos=nt-1,this.writeVarint(Ft),this.pos+=Ft},writeFloat:function(ze){this.realloc(4),m.write(this.buf,ze,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ze){this.realloc(8),m.write(this.buf,ze,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ze){var nt=ze.length;this.writeVarint(nt),this.realloc(nt);for(var Ft=0;Ft<nt;Ft++)this.buf[this.pos++]=ze[Ft]},writeRawMessage:function(ze,nt){this.pos++;var Ft=this.pos;ze(nt,this);var Sr=this.pos-Ft;Sr>=128&&$(Ft,Sr,this),this.pos=Ft-1,this.writeVarint(Sr),this.pos+=Sr},writeMessage:function(ze,nt,Ft){this.writeTag(ze,c.Bytes),this.writeRawMessage(nt,Ft)},writePackedVarint:function(ze,nt){nt.length&&this.writeMessage(ze,Q,nt)},writePackedSVarint:function(ze,nt){nt.length&&this.writeMessage(ze,oe,nt)},writePackedBoolean:function(ze,nt){nt.length&&this.writeMessage(ze,De,nt)},writePackedFloat:function(ze,nt){nt.length&&this.writeMessage(ze,he,nt)},writePackedDouble:function(ze,nt){nt.length&&this.writeMessage(ze,ve,nt)},writePackedFixed32:function(ze,nt){nt.length&&this.writeMessage(ze,je,nt)},writePackedSFixed32:function(ze,nt){nt.length&&this.writeMessage(ze,$e,nt)},writePackedFixed64:function(ze,nt){nt.length&&this.writeMessage(ze,Xe,nt)},writePackedSFixed64:function(ze,nt){nt.length&&this.writeMessage(ze,ot,nt)},writeBytesField:function(ze,nt){this.writeTag(ze,c.Bytes),this.writeBytes(nt)},writeFixed32Field:function(ze,nt){this.writeTag(ze,c.Fixed32),this.writeFixed32(nt)},writeSFixed32Field:function(ze,nt){this.writeTag(ze,c.Fixed32),this.writeSFixed32(nt)},writeFixed64Field:function(ze,nt){this.writeTag(ze,c.Fixed64),this.writeFixed64(nt)},writeSFixed64Field:function(ze,nt){this.writeTag(ze,c.Fixed64),this.writeSFixed64(nt)},writeVarintField:function(ze,nt){this.writeTag(ze,c.Varint),this.writeVarint(nt)},writeSVarintField:function(ze,nt){this.writeTag(ze,c.Varint),this.writeSVarint(nt)},writeStringField:function(ze,nt){this.writeTag(ze,c.Bytes),this.writeString(nt)},writeFloatField:function(ze,nt){this.writeTag(ze,c.Fixed32),this.writeFloat(nt)},writeDoubleField:function(ze,nt){this.writeTag(ze,c.Fixed64),this.writeDouble(nt)},writeBooleanField:function(ze,nt){this.writeVarintField(ze,!!nt)}},PC}var mp,MC=u(a6());function Mne(m,c,g){m===1&&g.readMessage(Rne,c)}function Rne(m,c,g){if(m===3){const{id:x,bitmap:C,width:D,height:F,left:$,top:Q,advance:oe}=g.readMessage(One,{});c.push({id:x,bitmap:new J0({width:D+6,height:F+6},C),metrics:{width:D,height:F,left:$,top:Q,advance:oe}})}}function One(m,c,g){m===1?c.id=g.readVarint():m===2?c.bitmap=g.readBytes():m===3?c.width=g.readVarint():m===4?c.height=g.readVarint():m===5?c.left=g.readSVarint():m===6?c.top=g.readSVarint():m===7&&(c.advance=g.readVarint())}function o6(m){let c=0,g=0;for(const F of m)c+=F.w*F.h,g=Math.max(g,F.w);m.sort(((F,$)=>$.h-F.h));const x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),g),h:1/0}];let C=0,D=0;for(const F of m)for(let $=x.length-1;$>=0;$--){const Q=x[$];if(!(F.w>Q.w||F.h>Q.h)){if(F.x=Q.x,F.y=Q.y,D=Math.max(D,F.y+F.h),C=Math.max(C,F.x+F.w),F.w===Q.w&&F.h===Q.h){const oe=x.pop();$<x.length&&(x[$]=oe)}else F.h===Q.h?(Q.x+=F.w,Q.w-=F.w):F.w===Q.w?(Q.y+=F.h,Q.h-=F.h):(x.push({x:Q.x+F.w,y:Q.y,w:Q.w-F.w,h:F.h}),Q.y+=F.h,Q.h-=F.h);break}}return{w:C,h:D,fill:c/(C*D)||0}}class RC{constructor(c,{pixelRatio:g,version:x,stretchX:C,stretchY:D,content:F,textFitWidth:$,textFitHeight:Q}){this.paddedRect=c,this.pixelRatio=g,this.stretchX=C,this.stretchY=D,this.content=F,this.version=x,this.textFitWidth=$,this.textFitHeight=Q}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class s6{constructor(c,g){const x={},C={};this.haveRenderCallbacks=[];const D=[];this.addImages(c,x,D),this.addImages(g,C,D);const{w:F,h:$}=o6(D),Q=new Qu({width:F||1,height:$||1});for(const oe in c){const he=c[oe],ve=x[oe].paddedRect;Qu.copy(he.data,Q,{x:0,y:0},{x:ve.x+1,y:ve.y+1},he.data)}for(const oe in g){const he=g[oe],ve=C[oe].paddedRect,De=ve.x+1,je=ve.y+1,$e=he.data.width,Xe=he.data.height;Qu.copy(he.data,Q,{x:0,y:0},{x:De,y:je},he.data),Qu.copy(he.data,Q,{x:0,y:Xe-1},{x:De,y:je-1},{width:$e,height:1}),Qu.copy(he.data,Q,{x:0,y:0},{x:De,y:je+Xe},{width:$e,height:1}),Qu.copy(he.data,Q,{x:$e-1,y:0},{x:De-1,y:je},{width:1,height:Xe}),Qu.copy(he.data,Q,{x:0,y:0},{x:De+$e,y:je},{width:1,height:Xe})}this.image=Q,this.iconPositions=x,this.patternPositions=C}addImages(c,g,x){for(const C in c){const D=c[C],F={x:0,y:0,w:D.data.width+2,h:D.data.height+2};x.push(F),g[C]=new RC(F,D),D.hasRenderCallback&&this.haveRenderCallbacks.push(C)}}patchUpdatedImages(c,g){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const x in c.updatedImages)this.patchUpdatedImage(this.iconPositions[x],c.getImage(x),g),this.patchUpdatedImage(this.patternPositions[x],c.getImage(x),g)}patchUpdatedImage(c,g,x){if(!c||!g||c.version===g.version)return;c.version=g.version;const[C,D]=c.tl;x.update(g.data,void 0,{x:C,y:D})}}xt("ImagePosition",RC),xt("ImageAtlas",s6),s.an=void 0,(mp=s.an||(s.an={}))[mp.none=0]="none",mp[mp.horizontal=1]="horizontal",mp[mp.vertical=2]="vertical",mp[mp.horizontalOnly=3]="horizontalOnly";class u_{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(c,g,x){const C=new u_;return C.scale=c||1,C.fontStack=g,C.verticalAlign=x||"bottom",C}static forImage(c,g){const x=new u_;return x.imageName=c,x.verticalAlign=g||"bottom",x}}class fy{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,g){const x=new fy;for(let C=0;C<c.sections.length;C++){const D=c.sections[C];D.image?x.addImageSection(D):x.addTextSection(D,g)}return x}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=(function(c){let g="";for(let x=0;x<c.length;x++){const C=c.charCodeAt(x+1)||null,D=c.charCodeAt(x-1)||null;g+=C&&Zi(C)&&!l_[c[x+1]]||D&&Zi(D)&&!l_[c[x-1]]||!l_[c[x]]?c[x]:l_[c[x]]}return g})(this.text)}trim(){let c=0;for(let x=0;x<this.text.length&&Px[this.text.charCodeAt(x)];x++)c++;let g=this.text.length;for(let x=this.text.length-1;x>=0&&x>=c&&Px[this.text.charCodeAt(x)];x--)g--;this.text=this.text.substring(c,g),this.sectionIndex=this.sectionIndex.slice(c,g)}substring(c,g){const x=new fy;return x.text=this.text.substring(c,g),x.sectionIndex=this.sectionIndex.slice(c,g),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((c,g)=>Math.max(c,this.sections[g].scale)),0)}getMaxImageSize(c){let g=0,x=0;for(let C=0;C<this.length();C++){const D=this.getSection(C);if(D.imageName){const F=c[D.imageName];if(!F)continue;const $=F.displaySize;g=Math.max(g,$[0]),x=Math.max(x,$[1])}}return{maxImageWidth:g,maxImageHeight:x}}addTextSection(c,g){this.text+=c.text,this.sections.push(u_.forText(c.scale,c.fontStack||g,c.verticalAlign));const x=this.sections.length-1;for(let C=0;C<c.text.length;++C)this.sectionIndex.push(x)}addImageSection(c){const g=c.image?c.image.name:"";if(g.length===0)return void Yt("Can't add FormattedSection with an empty image.");const x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(u_.forImage(g,c.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Yt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ix(m,c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e){const Xe=fy.fromFeature(m,C);let ot;ve===s.an.vertical&&Xe.verticalizePunctuation();const{processBidirectionalText:vt,processStyledBidirectionalText:Ht}=Pa;if(vt&&Xe.sections.length===1){ot=[];const nt=vt(Xe.toString(),OC(Xe,oe,D,c,x,je));for(const Ft of nt){const Sr=new fy;Sr.text=Ft,Sr.sections=Xe.sections;for(let Jr=0;Jr<Ft.length;Jr++)Sr.sectionIndex.push(0);ot.push(Sr)}}else if(Ht){ot=[];const nt=Ht(Xe.text,Xe.sectionIndex,OC(Xe,oe,D,c,x,je));for(const Ft of nt){const Sr=new fy;Sr.text=Ft[0],Sr.sectionIndex=Ft[1],Sr.sections=Xe.sections,ot.push(Sr)}}else ot=(function(nt,Ft){const Sr=[],Jr=nt.text;let Or=0;for(const Fr of Ft)Sr.push(nt.substring(Or,Fr)),Or=Fr;return Or<Jr.length&&Sr.push(nt.substring(Or,Jr.length)),Sr})(Xe,OC(Xe,oe,D,c,x,je));const Ot=[],ze={positionedLines:Ot,text:Xe.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:ve,iconsInText:!1,verticalizable:!1};return(function(nt,Ft,Sr,Jr,Or,Fr,ln,Qr,cn,zr,zn,ni){let ei=0,Hn=0,Qi=0,$o=0;const js=Qr==="right"?1:Qr==="left"?0:.5,Yl=ll/ni;let Uc=0;for(const Lo of Or){Lo.trim();const ul=Lo.getMaxScale(),kl={positionedGlyphs:[],lineOffset:0};nt.positionedLines[Uc]=kl;const Ml=kl.positionedGlyphs;let Ou=0;if(!Lo.length()){Hn+=Fr,++Uc;continue}const Vc=Fne(Jr,Lo,Yl);for(let tc=0;tc<Lo.length();tc++){const Us=Lo.getSection(tc),hl=Lo.getSectionIndex(tc),fl=Lo.getCharCode(tc),Ps=Bne(cn,zn,fl);let mo;if(Us.imageName){if(nt.iconsInText=!0,Us.scale=Us.scale*Yl,mo=jne(Us,Ps,ul,Vc,Jr),!mo)continue;Ou=Math.max(Ou,mo.imageOffset)}else if(mo=zne(Us,fl,Ps,Vc,Ft,Sr),!mo)continue;const{rect:$h,metrics:my,baselineOffset:qh}=mo;Ml.push({glyph:fl,imageName:Us.imageName,x:ei,y:Hn+qh+-17,vertical:Ps,scale:Us.scale,fontStack:Us.fontStack,sectionIndex:hl,metrics:my,rect:$h}),Ps?(nt.verticalizable=!0,ei+=(Us.imageName?my.advance:ll)*Us.scale+zr):ei+=my.advance*Us.scale+zr}Ml.length!==0&&(Qi=Math.max(ei-zr,Qi),Une(Ml,0,Ml.length-1,js)),ei=0,kl.lineOffset=Math.max(Ou,(ul-1)*ll);const cl=Fr*ul+Ou;Hn+=cl,$o=Math.max(cl,$o),++Uc}const{horizontalAlign:ec,verticalAlign:Pl}=NC(ln);(function(Lo,ul,kl,Ml,Ou,Vc,cl,tc,Us){const hl=(ul-kl)*Ou;let fl=0;fl=Vc!==cl?-tc*Ml- -17:-Ml*Us*cl+.5*cl;for(const Ps of Lo)for(const mo of Ps.positionedGlyphs)mo.x+=hl,mo.y+=fl})(nt.positionedLines,js,ec,Pl,Qi,$o,Fr,Hn,Or.length),nt.top+=-Pl*Hn,nt.bottom=nt.top+Hn,nt.left+=-ec*Qi,nt.right=nt.left+Qi})(ze,c,g,x,ot,F,$,Q,ve,oe,De,$e),!(function(nt){for(const Ft of nt)if(Ft.positionedGlyphs.length!==0)return!1;return!0})(Ot)&&ze}const Px={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Nne={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Lne={40:!0};function l6(m,c,g,x,C,D){if(c.imageName){const F=x[c.imageName];return F?F.displaySize[0]*c.scale*ll/D+C:0}{const F=g[c.fontStack],$=F&&F[m];return $?$.metrics.advance*c.scale+C:0}}function u6(m,c,g,x){const C=Math.pow(m-c,2);return x?m<c?C/2:2*C:C+Math.abs(g)*g}function Dne(m,c,g){let x=0;return m===10&&(x-=1e4),g&&(x+=150),m!==40&&m!==65288||(x+=50),c!==41&&c!==65289||(x+=50),x}function c6(m,c,g,x,C,D){let F=null,$=u6(c,g,C,D);for(const Q of x){const oe=u6(c-Q.x,g,C,D)+Q.badness;oe<=$&&(F=Q,$=oe)}return{index:m,x:c,priorBreak:F,badness:$}}function h6(m){return m?h6(m.priorBreak).concat(m.index):[]}function OC(m,c,g,x,C,D){if(!m)return[];const F=[],$=(function(ve,De,je,$e,Xe,ot){let vt=0;for(let Ht=0;Ht<ve.length();Ht++){const Ot=ve.getSection(Ht);vt+=l6(ve.getCharCode(Ht),Ot,$e,Xe,De,ot)}return vt/Math.max(1,Math.ceil(vt/je))})(m,c,g,x,C,D),Q=m.text.indexOf("​")>=0;let oe=0;for(let ve=0;ve<m.length();ve++){const De=m.getSection(ve),je=m.getCharCode(ve);if(Px[je]||(oe+=l6(je,De,x,C,c,D)),ve<m.length()-1){const $e=!((he=je)<11904)&&(!!wr["CJK Compatibility Forms"](he)||!!wr["CJK Compatibility"](he)||!!wr["CJK Strokes"](he)||!!wr["CJK Symbols and Punctuation"](he)||!!wr["Enclosed CJK Letters and Months"](he)||!!wr["Halfwidth and Fullwidth Forms"](he)||!!wr["Ideographic Description Characters"](he)||!!wr["Vertical Forms"](he)||Oi.test(String.fromCodePoint(he)));(Nne[je]||$e||De.imageName||ve!==m.length()-2&&Lne[m.getCharCode(ve+1)])&&F.push(c6(ve+1,oe,$,F,Dne(je,m.getCharCode(ve+1),$e&&Q),!1))}}var he;return h6(c6(m.length(),oe,$,F,0,!0))}function NC(m){let c=.5,g=.5;switch(m){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:c,verticalAlign:g}}function Fne(m,c,g){const x=c.getMaxScale()*ll,{maxImageWidth:C,maxImageHeight:D}=c.getMaxImageSize(m),F=Math.max(x,D*g);return{verticalLineContentWidth:Math.max(x,C*g),horizontalLineContentHeight:F}}function f6(m){switch(m){case"top":return 0;case"center":return .5;default:return 1}}function Bne(m,c,g){return!(m===s.an.horizontal||!c&&!Yn(g)||c&&(Px[g]||(x=g,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(x)))));var x}function zne(m,c,g,x,C,D){const F=D[m.fontStack],$=(function(oe,he,ve,De){if(oe&&oe.rect)return oe;const je=he[ve.fontStack],$e=je&&je[De];return $e?{rect:null,metrics:$e.metrics}:null})(F&&F[c],C,m,c);if($===null)return null;let Q;if(g)Q=x.verticalLineContentWidth-m.scale*ll;else{const oe=f6(m.verticalAlign);Q=(x.horizontalLineContentHeight-m.scale*ll)*oe}return{rect:$.rect,metrics:$.metrics,baselineOffset:Q}}function jne(m,c,g,x,C){const D=C[m.imageName];if(!D)return null;const F=D.paddedRect,$=D.displaySize,Q={width:$[0],height:$[1],left:1,top:-3,advance:c?$[1]:$[0]};let oe;if(c)oe=x.verticalLineContentWidth-$[1]*m.scale;else{const he=f6(m.verticalAlign);oe=(x.horizontalLineContentHeight-$[1]*m.scale)*he}return{rect:F,metrics:Q,baselineOffset:oe,imageOffset:(c?$[0]:$[1])*m.scale-ll*g}}function Une(m,c,g,x){if(x===0)return;const C=m[g],D=(m[g].x+C.metrics.advance*C.scale)*x;for(let F=c;F<=g;F++)m[F].x-=D}function Vne(m,c,g){const{horizontalAlign:x,verticalAlign:C}=NC(g),D=c[0]-m.displaySize[0]*x,F=c[1]-m.displaySize[1]*C;return{image:m,top:F,bottom:F+m.displaySize[1],left:D,right:D+m.displaySize[0]}}function d6(m){var c,g;let x=m.left,C=m.top,D=m.right-x,F=m.bottom-C;const $=(c=m.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",Q=(g=m.image.textFitHeight)!==null&&g!==void 0?g:"stretchOrShrink",oe=(m.image.content[2]-m.image.content[0])/(m.image.content[3]-m.image.content[1]);if(Q==="proportional"){if($==="stretchOnly"&&D/F<oe||$==="proportional"){const he=Math.ceil(F*oe);x*=he/D,D=he}}else if($==="proportional"&&Q==="stretchOnly"&&oe!==0&&D/F>oe){const he=Math.ceil(D/oe);C*=he/F,F=he}return{x1:x,y1:C,x2:x+D,y2:C+F}}function p6(m,c,g,x,C,D){const F=m.image;let $;if(F.content){const ot=F.content,vt=F.pixelRatio||1;$=[ot[0]/vt,ot[1]/vt,F.displaySize[0]-ot[2]/vt,F.displaySize[1]-ot[3]/vt]}const Q=c.left*D,oe=c.right*D;let he,ve,De,je;g==="width"||g==="both"?(je=C[0]+Q-x[3],ve=C[0]+oe+x[1]):(je=C[0]+(Q+oe-F.displaySize[0])/2,ve=je+F.displaySize[0]);const $e=c.top*D,Xe=c.bottom*D;return g==="height"||g==="both"?(he=C[1]+$e-x[0],De=C[1]+Xe+x[2]):(he=C[1]+($e+Xe-F.displaySize[1])/2,De=he+F.displaySize[1]),{image:F,top:he,right:ve,bottom:De,left:je,collisionPadding:$}}const xd=128,yp=32640;function g6(m,c){const{expression:g}=c;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new qn(m+1))};if(g.kind==="source")return{kind:"source"};{const{zoomStops:x,interpolationType:C}=g;let D=0;for(;D<x.length&&x[D]<=m;)D++;D=Math.max(0,D-1);let F=D;for(;F<x.length&&x[F]<m+1;)F++;F=Math.min(x.length-1,F);const $=x[D],Q=x[F];return g.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:Q,interpolationType:C}:{kind:"camera",minZoom:$,maxZoom:Q,minSize:g.evaluate(new qn($)),maxSize:g.evaluate(new qn(Q)),interpolationType:C}}}function LC(m,c,g){let x="never";const C=m.get(c);return C?x=C:m.get(g)&&(x="always"),x}const $ne=a_.VectorTileFeature.types,qne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function kx(m,c,g,x,C,D,F,$,Q,oe,he,ve,De){const je=$?Math.min(yp,Math.round($[0])):0,$e=$?Math.min(yp,Math.round($[1])):0;m.emplaceBack(c,g,Math.round(32*x),Math.round(32*C),D,F,(je<<1)+(Q?1:0),$e,16*oe,16*he,256*ve,256*De)}function DC(m,c,g){m.emplaceBack(c.x,c.y,g),m.emplaceBack(c.x,c.y,g),m.emplaceBack(c.x,c.y,g),m.emplaceBack(c.x,c.y,g)}function Hne(m){for(const c of m.sections)if(Cn(c.text))return!0;return!1}class FC{constructor(c){this.layoutVertexArray=new Mi,this.indexArray=new oa,this.programConfigurations=c,this.segments=new Gi,this.dynamicLayoutVertexArray=new Ji,this.opacityVertexArray=new Ha,this.hasVisibleVertices=!1,this.placedSymbolArray=new ut}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,g,x,C){this.isEmpty()||(x&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Tne.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,g),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,Cne.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,qne,!0),this.opacityVertexBuffer.itemSize=1),(x||C)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xt("SymbolBuffers",FC);class BC{constructor(c,g,x){this.layoutVertexArray=new c,this.layoutAttributes=g,this.indexArray=new x,this.segments=new Gi,this.collisionVertexArray=new da}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,Ane.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xt("CollisionBuffers",BC);class dy{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((F=>F.id)),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const g=this.layers[0]._unevaluatedLayout._values;this.textSizeData=g6(this.zoom,g["text-size"]),this.iconSizeData=g6(this.zoom,g["icon-size"]);const x=this.layers[0].layout,C=x.get("symbol-sort-key"),D=x.get("symbol-z-order");this.canOverlap=LC(x,"text-overlap","text-allow-overlap")!=="never"||LC(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=D!=="viewport-y"&&!C.isConstant(),this.sortFeaturesByY=(D==="viewport-y"||D==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map((F=>s.an[F]))),this.stateDependentLayerIds=this.layers.filter((F=>F.isStateDependent())).map((F=>F.id)),this.sourceID=c.sourceID}createArrays(){this.text=new FC(new kf(this.layers,this.zoom,(c=>/^text/.test(c)))),this.icon=new FC(new kf(this.layers,this.zoom,(c=>/^icon/.test(c)))),this.glyphOffsetArray=new kt,this.lineVertexArray=new zt,this.symbolInstances=new Dt,this.textAnchorOffsets=new It}calculateGlyphDependencies(c,g,x,C,D){for(let F=0;F<c.length;F++)if(g[c.charCodeAt(F)]=!0,(x||C)&&D){const $=l_[c.charAt(F)];$&&(g[$.charCodeAt(0)]=!0)}}populate(c,g,x){const C=this.layers[0],D=C.layout,F=D.get("text-font"),$=D.get("text-field"),Q=D.get("icon-image"),oe=($.value.kind!=="constant"||$.value.value instanceof xn&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),he=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,ve=D.get("symbol-sort-key");if(this.features=[],!oe&&!he)return;const De=g.iconDependencies,je=g.glyphDependencies,$e=g.availableImages,Xe=new qn(this.zoom,{globalState:this.globalState});for(const{feature:ot,id:vt,index:Ht,sourceLayerIndex:Ot}of c){const ze=C._featureFilter.needGeometry,nt=Sg(ot,ze);if(!C._featureFilter.filter(Xe,nt,x))continue;let Ft,Sr;if(ze||(nt.geometry=wg(ot)),oe){const Or=C.getValueAndResolveTokens("text-field",nt,x,$e),Fr=xn.factory(Or),ln=this.hasRTLText=this.hasRTLText||Hne(Fr);(!ln||Pa.getRTLTextPluginStatus()==="unavailable"||ln&&Pa.isParsed())&&(Ft=Pne(Fr,C,nt))}if(he){const Or=C.getValueAndResolveTokens("icon-image",nt,x,$e);Sr=Or instanceof $a?Or:$a.fromString(Or)}if(!Ft&&!Sr)continue;const Jr=this.sortFeaturesByKey?ve.evaluate(nt,{},x):void 0;if(this.features.push({id:vt,text:Ft,icon:Sr,index:Ht,sourceLayerIndex:Ot,geometry:nt.geometry,properties:ot.properties,type:$ne[ot.type],sortKey:Jr}),Sr&&(De[Sr.name]=!0),Ft){const Or=F.evaluate(nt,{},x).join(","),Fr=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.an.vertical)>=0;for(const ln of Ft.sections)if(ln.image)De[ln.image.name]=!0;else{const Qr=qr(Ft.toString()),cn=ln.fontStack||Or,zr=je[cn]=je[cn]||{};this.calculateGlyphDependencies(ln.text,zr,Fr,this.allowVerticalPlacement,Qr)}}}D.get("symbol-placement")==="line"&&(this.features=(function(ot){const vt={},Ht={},Ot=[];let ze=0;function nt(Or){Ot.push(ot[Or]),ze++}function Ft(Or,Fr,ln){const Qr=Ht[Or];return delete Ht[Or],Ht[Fr]=Qr,Ot[Qr].geometry[0].pop(),Ot[Qr].geometry[0]=Ot[Qr].geometry[0].concat(ln[0]),Qr}function Sr(Or,Fr,ln){const Qr=vt[Fr];return delete vt[Fr],vt[Or]=Qr,Ot[Qr].geometry[0].shift(),Ot[Qr].geometry[0]=ln[0].concat(Ot[Qr].geometry[0]),Qr}function Jr(Or,Fr,ln){const Qr=ln?Fr[0][Fr[0].length-1]:Fr[0][0];return`${Or}:${Qr.x}:${Qr.y}`}for(let Or=0;Or<ot.length;Or++){const Fr=ot[Or],ln=Fr.geometry,Qr=Fr.text?Fr.text.toString():null;if(!Qr){nt(Or);continue}const cn=Jr(Qr,ln),zr=Jr(Qr,ln,!0);if(cn in Ht&&zr in vt&&Ht[cn]!==vt[zr]){const zn=Sr(cn,zr,ln),ni=Ft(cn,zr,Ot[zn].geometry);delete vt[cn],delete Ht[zr],Ht[Jr(Qr,Ot[ni].geometry,!0)]=ni,Ot[zn].geometry=null}else cn in Ht?Ft(cn,zr,ln):zr in vt?Sr(cn,zr,ln):(nt(Or),vt[cn]=ze-1,Ht[zr]=ze-1)}return Ot.filter((Or=>Or.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ot,vt)=>ot.sortKey-vt.sortKey))}update(c,g,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,g,this.layers,x),this.icon.programConfigurations.updatePaintArrays(c,g,this.layers,x))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,g){const x=this.lineVertexArray.length;if(c.segment!==void 0){let C=c.dist(g[c.segment+1]),D=c.dist(g[c.segment]);const F={};for(let $=c.segment+1;$<g.length;$++)F[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:C},$<g.length-1&&(C+=g[$+1].dist(g[$]));for(let $=c.segment||0;$>=0;$--)F[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:D},$>0&&(D+=g[$-1].dist(g[$]));for(let $=0;$<g.length;$++){const Q=F[$];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(c,g,x,C,D,F,$,Q,oe,he,ve,De){const je=c.indexArray,$e=c.layoutVertexArray,Xe=c.segments.prepareSegment(4*g.length,$e,je,this.canOverlap?F.sortKey:void 0),ot=this.glyphOffsetArray.length,vt=Xe.vertexLength,Ht=this.allowVerticalPlacement&&$===s.an.vertical?Math.PI/2:0,Ot=F.text&&F.text.sections;for(let ze=0;ze<g.length;ze++){const{tl:nt,tr:Ft,bl:Sr,br:Jr,tex:Or,pixelOffsetTL:Fr,pixelOffsetBR:ln,minFontScaleX:Qr,minFontScaleY:cn,glyphOffset:zr,isSDF:zn,sectionIndex:ni}=g[ze],ei=Xe.vertexLength,Hn=zr[1];kx($e,Q.x,Q.y,nt.x,Hn+nt.y,Or.x,Or.y,x,zn,Fr.x,Fr.y,Qr,cn),kx($e,Q.x,Q.y,Ft.x,Hn+Ft.y,Or.x+Or.w,Or.y,x,zn,ln.x,Fr.y,Qr,cn),kx($e,Q.x,Q.y,Sr.x,Hn+Sr.y,Or.x,Or.y+Or.h,x,zn,Fr.x,ln.y,Qr,cn),kx($e,Q.x,Q.y,Jr.x,Hn+Jr.y,Or.x+Or.w,Or.y+Or.h,x,zn,ln.x,ln.y,Qr,cn),DC(c.dynamicLayoutVertexArray,Q,Ht),je.emplaceBack(ei,ei+2,ei+1),je.emplaceBack(ei+1,ei+2,ei+3),Xe.vertexLength+=4,Xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(zr[0]),ze!==g.length-1&&ni===g[ze+1].sectionIndex||c.programConfigurations.populatePaintArrays($e.length,F,F.index,{},De,Ot&&Ot[ni])}c.placedSymbolArray.emplaceBack(Q.x,Q.y,ot,this.glyphOffsetArray.length-ot,vt,oe,he,Q.segment,x?x[0]:0,x?x[1]:0,C[0],C[1],$,0,!1,0,ve)}_addCollisionDebugVertex(c,g,x,C,D,F){return g.emplaceBack(0,0),c.emplaceBack(x.x,x.y,C,D,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(c,g,x,C,D,F,$){const Q=D.segments.prepareSegment(4,D.layoutVertexArray,D.indexArray),oe=Q.vertexLength,he=D.layoutVertexArray,ve=D.collisionVertexArray,De=$.anchorX,je=$.anchorY;this._addCollisionDebugVertex(he,ve,F,De,je,new S(c,g)),this._addCollisionDebugVertex(he,ve,F,De,je,new S(x,g)),this._addCollisionDebugVertex(he,ve,F,De,je,new S(x,C)),this._addCollisionDebugVertex(he,ve,F,De,je,new S(c,C)),Q.vertexLength+=4;const $e=D.indexArray;$e.emplaceBack(oe,oe+1),$e.emplaceBack(oe+1,oe+2),$e.emplaceBack(oe+2,oe+3),$e.emplaceBack(oe+3,oe),Q.primitiveLength+=4}addDebugCollisionBoxes(c,g,x,C){for(let D=c;D<g;D++){const F=this.collisionBoxArray.get(D);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,C?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new BC(fa,r6.members,aa),this.iconCollisionBox=new BC(fa,r6.members,aa);for(let c=0;c<this.symbolInstances.length;c++){const g=this.symbolInstances.get(c);this.addDebugCollisionBoxes(g.textBoxStartIndex,g.textBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.iconBoxStartIndex,g.iconBoxEndIndex,g,!1),this.addDebugCollisionBoxes(g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g,!1)}}_deserializeCollisionBoxesForSymbol(c,g,x,C,D,F,$,Q,oe){const he={};for(let ve=g;ve<x;ve++){const De=c.get(ve);he.textBox={x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,anchorPointX:De.anchorPointX,anchorPointY:De.anchorPointY},he.textFeatureIndex=De.featureIndex;break}for(let ve=C;ve<D;ve++){const De=c.get(ve);he.verticalTextBox={x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,anchorPointX:De.anchorPointX,anchorPointY:De.anchorPointY},he.verticalTextFeatureIndex=De.featureIndex;break}for(let ve=F;ve<$;ve++){const De=c.get(ve);he.iconBox={x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,anchorPointX:De.anchorPointX,anchorPointY:De.anchorPointY},he.iconFeatureIndex=De.featureIndex;break}for(let ve=Q;ve<oe;ve++){const De=c.get(ve);he.verticalIconBox={x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,anchorPointX:De.anchorPointX,anchorPointY:De.anchorPointY},he.verticalIconFeatureIndex=De.featureIndex;break}return he}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let g=0;g<this.symbolInstances.length;g++){const x=this.symbolInstances.get(g);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,g){const x=c.placedSymbolArray.get(g),C=x.vertexStartIndex+4*x.numGlyphs;for(let D=x.vertexStartIndex;D<C;D+=4)c.indexArray.emplaceBack(D,D+2,D+1),c.indexArray.emplaceBack(D+1,D+2,D+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const g=Math.sin(c),x=Math.cos(c),C=[],D=[],F=[];for(let $=0;$<this.symbolInstances.length;++$){F.push($);const Q=this.symbolInstances.get($);C.push(0|Math.round(g*Q.anchorX+x*Q.anchorY)),D.push(Q.featureIndex)}return F.sort((($,Q)=>C[$]-C[Q]||D[Q]-D[$])),F}addToSortKeyRanges(c,g){const x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===g?x.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:g,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const g of this.symbolInstanceIndexes){const x=this.symbolInstances.get(g);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach(((C,D,F)=>{C>=0&&F.indexOf(C)===D&&this.addIndicesForPlacedSymbol(this.text,C)})),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let m6,y6;xt("SymbolBucket",dy,{omit:["layers","collisionBoxArray","features","compareText"]}),dy.MAX_GLYPHS=65535,dy.addDynamicAttributes=DC;var zC={get paint(){return y6=y6||new to({"icon-opacity":new Sn(Ct.paint_symbol["icon-opacity"]),"icon-color":new Sn(Ct.paint_symbol["icon-color"]),"icon-halo-color":new Sn(Ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sn(Ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sn(Ct.paint_symbol["icon-halo-blur"]),"icon-translate":new sn(Ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new sn(Ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sn(Ct.paint_symbol["text-opacity"]),"text-color":new Sn(Ct.paint_symbol["text-color"],{runtimeType:na,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new Sn(Ct.paint_symbol["text-halo-color"]),"text-halo-width":new Sn(Ct.paint_symbol["text-halo-width"]),"text-halo-blur":new Sn(Ct.paint_symbol["text-halo-blur"]),"text-translate":new sn(Ct.paint_symbol["text-translate"]),"text-translate-anchor":new sn(Ct.paint_symbol["text-translate-anchor"])})},get layout(){return m6=m6||new to({"symbol-placement":new sn(Ct.layout_symbol["symbol-placement"]),"symbol-spacing":new sn(Ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new sn(Ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sn(Ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new sn(Ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new sn(Ct.layout_symbol["icon-allow-overlap"]),"icon-overlap":new sn(Ct.layout_symbol["icon-overlap"]),"icon-ignore-placement":new sn(Ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new sn(Ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new sn(Ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sn(Ct.layout_symbol["icon-size"]),"icon-text-fit":new sn(Ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new sn(Ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sn(Ct.layout_symbol["icon-image"]),"icon-rotate":new Sn(Ct.layout_symbol["icon-rotate"]),"icon-padding":new Sn(Ct.layout_symbol["icon-padding"]),"icon-keep-upright":new sn(Ct.layout_symbol["icon-keep-upright"]),"icon-offset":new Sn(Ct.layout_symbol["icon-offset"]),"icon-anchor":new Sn(Ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new sn(Ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new sn(Ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new sn(Ct.layout_symbol["text-rotation-alignment"]),"text-field":new Sn(Ct.layout_symbol["text-field"]),"text-font":new Sn(Ct.layout_symbol["text-font"]),"text-size":new Sn(Ct.layout_symbol["text-size"]),"text-max-width":new Sn(Ct.layout_symbol["text-max-width"]),"text-line-height":new sn(Ct.layout_symbol["text-line-height"]),"text-letter-spacing":new Sn(Ct.layout_symbol["text-letter-spacing"]),"text-justify":new Sn(Ct.layout_symbol["text-justify"]),"text-radial-offset":new Sn(Ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new sn(Ct.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sn(Ct.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sn(Ct.layout_symbol["text-anchor"]),"text-max-angle":new sn(Ct.layout_symbol["text-max-angle"]),"text-writing-mode":new sn(Ct.layout_symbol["text-writing-mode"]),"text-rotate":new Sn(Ct.layout_symbol["text-rotate"]),"text-padding":new sn(Ct.layout_symbol["text-padding"]),"text-keep-upright":new sn(Ct.layout_symbol["text-keep-upright"]),"text-transform":new Sn(Ct.layout_symbol["text-transform"]),"text-offset":new Sn(Ct.layout_symbol["text-offset"]),"text-allow-overlap":new sn(Ct.layout_symbol["text-allow-overlap"]),"text-overlap":new sn(Ct.layout_symbol["text-overlap"]),"text-ignore-placement":new sn(Ct.layout_symbol["text-ignore-placement"]),"text-optional":new sn(Ct.layout_symbol["text-optional"])})}};class v6{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Ui,this.defaultValue=c}evaluate(c){if(c.formattedSection){const g=this.defaultValue.property.overrides;if(g&&g.hasOverride(c.formattedSection))return g.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xt("FormatSectionOverride",v6,{omit:["defaultValue"]});class Mx extends Sa{constructor(c){super(c,zC)}recalculate(c,g){if(super.recalculate(c,g),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const x=this.layout.get("text-writing-mode");if(x){const C=[];for(const D of x)C.indexOf(D)<0&&C.push(D);this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,g,x,C){const D=this.layout.get(c).evaluate(g,{},x,C),F=this._unevaluatedLayout._values[c];return F.isDataDriven()||sp(F.value)||!D?D:(function($,Q){return Q.replace(/{([^{}]+)}/g,((oe,he)=>$&&he in $?String($[he]):""))})(g.properties,D)}createBucket(c){return new dy(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of zC.paint.overridableProperties){if(!Mx.hasPaintOverride(this.layout,c))continue;const g=this.paint.get(c),x=new v6(g),C=new _f(x,g.property.specification);let D=null;D=g.value.kind==="constant"||g.value.kind==="source"?new bf("source",C):new up("composite",C,g.value.zoomStops),this.paint._values[c]=new po(g.property,D,g.parameters)}}_handleOverridablePaintPropertyUpdate(c,g,x){return!(!this.layout||g.isDataDriven()||x.isDataDriven())&&Mx.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,g){const x=c.get("text-field"),C=zC.paint.properties[g];let D=!1;const F=$=>{for(const Q of $)if(C.overrides&&C.overrides.hasOverride(Q))return void(D=!0)};if(x.value.kind==="constant"&&x.value.value instanceof xn)F(x.value.value.sections);else if(x.value.kind==="source"){const $=oe=>{D||(oe instanceof Na&&In(oe.value)===_a?F(oe.value.sections):oe instanceof Ts?F(oe.sections):oe.eachChild($))},Q=x.value;Q._styleExpression&&$(Q._styleExpression.expression)}return D}}let _6;var Wne={get paint(){return _6=_6||new to({"background-color":new sn(Ct.paint_background["background-color"]),"background-pattern":new ga(Ct.paint_background["background-pattern"]),"background-opacity":new sn(Ct.paint_background["background-opacity"])})}};class Gne extends Sa{constructor(c){super(c,Wne)}}let b6;var Xne={get paint(){return b6=b6||new to({"raster-opacity":new sn(Ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new sn(Ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new sn(Ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new sn(Ct.paint_raster["raster-brightness-max"]),"raster-saturation":new sn(Ct.paint_raster["raster-saturation"]),"raster-contrast":new sn(Ct.paint_raster["raster-contrast"]),"raster-resampling":new sn(Ct.paint_raster["raster-resampling"]),"raster-fade-duration":new sn(Ct.paint_raster["raster-fade-duration"])})}};class Yne extends Sa{constructor(c){super(c,Xne)}}class Zne extends Sa{constructor(c){super(c,{}),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Kne{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Jne={once:!0},jC=63710088e-1;class vp{constructor(c,g){if(isNaN(c)||isNaN(g))throw new Error(`Invalid LngLat object: (${c}, ${g})`);if(this.lng=+c,this.lat=+g,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vp(Ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const g=Math.PI/180,x=this.lat*g,C=c.lat*g,D=Math.sin(x)*Math.sin(C)+Math.cos(x)*Math.cos(C)*Math.cos((c.lng-this.lng)*g);return jC*Math.acos(Math.min(D,1))}static convert(c){if(c instanceof vp)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new vp(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new vp(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const x6=2*Math.PI*jC;function w6(m){return x6*Math.cos(m*Math.PI/180)}function S6(m){return(180+m)/360}function E6(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function T6(m,c){return m/w6(c)}function UC(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}function C6(m,c){return m*w6(UC(c))}class c_{constructor(c,g,x=0){this.x=+c,this.y=+g,this.z=+x}static fromLngLat(c,g=0){const x=vp.convert(c);return new c_(S6(x.lng),E6(x.lat),T6(g,x.lat))}toLngLat(){return new vp(360*this.x-180,UC(this.y))}toAltitude(){return C6(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/x6*(c=UC(this.y),1/Math.cos(c*Math.PI/180));var c}}function A6(m,c,g){var x=2*Math.PI*6378137/256/Math.pow(2,g);return[m*x-2*Math.PI*6378137/2,c*x-2*Math.PI*6378137/2]}class VC{constructor(c,g,x){if(!(function(C,D,F){return!(C<0||C>25||F<0||F>=Math.pow(2,C)||D<0||D>=Math.pow(2,C))})(c,g,x))throw new Error(`x=${g}, y=${x}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=g,this.y=x,this.key=py(0,c,c,g,x)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,g,x){const C=(F=this.y,$=this.z,Q=A6(256*(D=this.x),256*(F=Math.pow(2,$)-F-1),$),oe=A6(256*(D+1),256*(F+1),$),Q[0]+","+Q[1]+","+oe[0]+","+oe[1]);var D,F,$,Q,oe;const he=(function(ve,De,je){let $e,Xe="";for(let ot=ve;ot>0;ot--)$e=1<<ot-1,Xe+=(De&$e?1:0)+(je&$e?2:0);return Xe})(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,g>1?"@2x":"").replace(/{quadkey}/g,he).replace(/{bbox-epsg-3857}/g,C)}isChildOf(c){const g=this.z-c.z;return g>0&&c.x===this.x>>g&&c.y===this.y>>g}getTilePoint(c){const g=Math.pow(2,this.z);return new S((c.x*g-this.x)*ce,(c.y*g-this.y)*ce)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I6{constructor(c,g){this.wrap=c,this.canonical=g,this.key=py(c,g.z,g.z,g.x,g.y)}}class jc{constructor(c,g,x,C,D){if(this.terrainRttPosMatrix32f=null,c<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${x}`);this.overscaledZ=c,this.wrap=g,this.canonical=new VC(x,+C,+D),this.key=py(g,c,x,C,D)}clone(){return new jc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-c;return c>this.canonical.z?new jc(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jc(c,this.wrap,c,this.canonical.x>>g,this.canonical.y>>g)}calculateScaledKey(c,g){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-c;return c>this.canonical.z?py(this.wrap*+g,c,this.canonical.z,this.canonical.x,this.canonical.y):py(this.wrap*+g,c,c,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const g=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>g&&c.canonical.y===this.canonical.y>>g}children(c){if(this.overscaledZ>=c)return[new jc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const g=this.canonical.z+1,x=2*this.canonical.x,C=2*this.canonical.y;return[new jc(g,this.wrap,g,x,C),new jc(g,this.wrap,g,x+1,C),new jc(g,this.wrap,g,x,C+1),new jc(g,this.wrap,g,x+1,C+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new jc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new jc(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I6(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new c_(c.x-this.wrap,c.y))}}function py(m,c,g,x,C){(m*=2)<0&&(m=-1*m-1);const D=1<<g;return(D*D*m+D*C+x).toString(36)+g.toString(36)+c.toString(36)}xt("CanonicalTileID",VC),xt("OverscaledTileID",jc,{omit:["terrainRttPosMatrix32f"]});class Cg{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(c){return this.minX=Math.min(this.minX,c.x),this.minY=Math.min(this.minY,c.y),this.maxX=Math.max(this.maxX,c.x),this.maxY=Math.max(this.maxY,c.y),this}expandBy(c){return this.minX-=c,this.minY-=c,this.maxX+=c,this.maxY+=c,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(c){return this.expandBy(-c)}map(c){const g=new Cg;return g.extend(c(new S(this.minX,this.minY))),g.extend(c(new S(this.maxX,this.minY))),g.extend(c(new S(this.minX,this.maxY))),g.extend(c(new S(this.maxX,this.maxY))),g}static fromPoints(c){const g=new Cg;for(const x of c)g.extend(x);return g}contains(c){return c.x>=this.minX&&c.x<=this.maxX&&c.y>=this.minY&&c.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(c){return!this.empty()&&!c.empty()&&c.minX>=this.minX&&c.maxX<=this.maxX&&c.minY>=this.minY&&c.maxY<=this.maxY}intersects(c){return!this.empty()&&!c.empty()&&c.minX<=this.maxX&&c.maxX>=this.minX&&c.minY<=this.maxY&&c.maxY>=this.minY}}class P6{constructor(c){this._stringToNumber={},this._numberToString=[];for(let g=0;g<c.length;g++){const x=c[g];this._stringToNumber[x]=g,this._numberToString[g]=x}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class k6{constructor(c,g,x,C,D){this.type="Feature",this._vectorTileFeature=c,c._z=g,c._x=x,c._y=C,this.properties=c.properties,this.id=D}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const g in this)g!=="_geometry"&&g!=="_vectorTileFeature"&&(c[g]=this[g]);return c}}class M6{constructor(c,g){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new ct(ce,16,0),this.grid3D=new ct(ce,16,0),this.featureIndexArray=new Er,this.promoteId=g}insert(c,g,x,C,D,F){const $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,C,D);const Q=F?this.grid3D:this.grid;for(let oe=0;oe<g.length;oe++){const he=g[oe],ve=[1/0,1/0,-1/0,-1/0];for(let De=0;De<he.length;De++){const je=he[De];ve[0]=Math.min(ve[0],je.x),ve[1]=Math.min(ve[1],je.y),ve[2]=Math.max(ve[2],je.x),ve[3]=Math.max(ve[3],je.y)}ve[0]<ce&&ve[1]<ce&&ve[2]>=0&&ve[3]>=0&&Q.insert($,ve[0],ve[1],ve[2],ve[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new a_.VectorTile(new MC(this.rawTileData)).layers,this.sourceLayerCoder=new P6(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,g,x,C){this.loadVTLayers();const D=c.params,F=ce/c.tileSize/c.scale,$=Iu(D.filter),Q=c.queryGeometry,oe=c.queryPadding*F,he=Cg.fromPoints(Q),ve=this.grid.query(he.minX-oe,he.minY-oe,he.maxX+oe,he.maxY+oe),De=Cg.fromPoints(c.cameraQueryGeometry).expandBy(oe),je=this.grid3D.query(De.minX,De.minY,De.maxX,De.maxY,((ot,vt,Ht,Ot)=>(function(ze,nt,Ft,Sr,Jr){for(const Fr of ze)if(nt<=Fr.x&&Ft<=Fr.y&&Sr>=Fr.x&&Jr>=Fr.y)return!0;const Or=[new S(nt,Ft),new S(nt,Jr),new S(Sr,Jr),new S(Sr,Ft)];if(ze.length>2){for(const Fr of Or)if(ly(ze,Fr))return!0}for(let Fr=0;Fr<ze.length-1;Fr++)if(zre(ze[Fr],ze[Fr+1],Or))return!0;return!1})(c.cameraQueryGeometry,ot-oe,vt-oe,Ht+oe,Ot+oe)));for(const ot of je)ve.push(ot);ve.sort(Qne);const $e={};let Xe;for(let ot=0;ot<ve.length;ot++){const vt=ve[ot];if(vt===Xe)continue;Xe=vt;const Ht=this.featureIndexArray.get(vt);let Ot=null;this.loadMatchingFeature($e,Ht.bucketIndex,Ht.sourceLayerIndex,Ht.featureIndex,$,D.layers,D.availableImages,g,x,C,((ze,nt,Ft)=>(Ot||(Ot=wg(ze)),nt.queryIntersectsFeature({queryGeometry:Q,feature:ze,featureState:Ft,geometry:Ot,zoom:this.z,transform:c.transform,pixelsToTileUnits:F,pixelPosMatrix:c.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:c.getElevation}))))}return $e}loadMatchingFeature(c,g,x,C,D,F,$,Q,oe,he,ve){const De=this.bucketLayerIDs[g];if(F&&!De.some((ot=>F.has(ot))))return;const je=this.sourceLayerCoder.decode(x),$e=this.vtLayers[je].feature(C);if(D.needGeometry){const ot=Sg($e,!0);if(!D.filter(new qn(this.tileID.overscaledZ),ot,this.tileID.canonical))return}else if(!D.filter(new qn(this.tileID.overscaledZ),$e))return;const Xe=this.getId($e,je);for(let ot=0;ot<De.length;ot++){const vt=De[ot];if(F&&!F.has(vt))continue;const Ht=Q[vt];if(!Ht)continue;let Ot={};Xe&&he&&(Ot=he.getState(Ht.sourceLayer||"_geojsonTileLayer",Xe));const ze=Qe({},oe[vt]);ze.paint=R6(ze.paint,Ht.paint,$e,Ot,$),ze.layout=R6(ze.layout,Ht.layout,$e,Ot,$);const nt=!ve||ve($e,Ht,Ot);if(!nt)continue;const Ft=new k6($e,this.z,this.x,this.y,Xe);Ft.layer=ze;let Sr=c[vt];Sr===void 0&&(Sr=c[vt]=[]),Sr.push({featureIndex:C,feature:Ft,intersectionZ:nt})}}lookupSymbolFeatures(c,g,x,C,D,F,$,Q){const oe={};this.loadVTLayers();const he=Iu(D);for(const ve of c)this.loadMatchingFeature(oe,x,C,ve,he,F,$,Q,g);return oe}hasLayer(c){for(const g of this.bucketLayerIDs)for(const x of g)if(c===x)return!0;return!1}getId(c,g){var x;let C=c.id;return this.promoteId&&(C=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[g]],typeof C=="boolean"&&(C=Number(C)),C===void 0&&(!((x=c.properties)===null||x===void 0)&&x.cluster)&&this.promoteId&&(C=Number(c.properties.cluster_id))),C}}function R6(m,c,g,x,C){return Lt(m,((D,F)=>{const $=c instanceof Oo?c.get(F):null;return $&&$.evaluate?$.evaluate(g,x,C):$}))}function Qne(m,c){return c-m}function O6(m,c,g,x,C){const D=[];for(let F=0;F<m.length;F++){const $=m[F];let Q;for(let oe=0;oe<$.length-1;oe++){let he=$[oe],ve=$[oe+1];he.x<c&&ve.x<c||(he.x<c?he=new S(c,he.y+(c-he.x)/(ve.x-he.x)*(ve.y-he.y))._round():ve.x<c&&(ve=new S(c,he.y+(c-he.x)/(ve.x-he.x)*(ve.y-he.y))._round()),he.y<g&&ve.y<g||(he.y<g?he=new S(he.x+(g-he.y)/(ve.y-he.y)*(ve.x-he.x),g)._round():ve.y<g&&(ve=new S(he.x+(g-he.y)/(ve.y-he.y)*(ve.x-he.x),g)._round()),he.x>=x&&ve.x>=x||(he.x>=x?he=new S(x,he.y+(x-he.x)/(ve.x-he.x)*(ve.y-he.y))._round():ve.x>=x&&(ve=new S(x,he.y+(x-he.x)/(ve.x-he.x)*(ve.y-he.y))._round()),he.y>=C&&ve.y>=C||(he.y>=C?he=new S(he.x+(C-he.y)/(ve.y-he.y)*(ve.x-he.x),C)._round():ve.y>=C&&(ve=new S(he.x+(C-he.y)/(ve.y-he.y)*(ve.x-he.x),C)._round()),Q&&he.equals(Q[Q.length-1])||(Q=[he],D.push(Q)),Q.push(ve)))))}}return D}xt("FeatureIndex",M6,{omit:["rawTileData","sourceLayerCoder"]});class _p extends S{constructor(c,g,x,C){super(c,g),this.angle=x,C!==void 0&&(this.segment=C)}clone(){return new _p(this.x,this.y,this.angle,this.segment)}}function N6(m,c,g,x,C){if(c.segment===void 0||g===0)return!0;let D=c,F=c.segment+1,$=0;for(;$>-g/2;){if(F--,F<0)return!1;$-=m[F].dist(D),D=m[F]}$+=m[F].dist(m[F+1]),F++;const Q=[];let oe=0;for(;$<g/2;){const he=m[F],ve=m[F+1];if(!ve)return!1;let De=m[F-1].angleTo(he)-he.angleTo(ve);for(De=Math.abs((De+3*Math.PI)%(2*Math.PI)-Math.PI),Q.push({distance:$,angleDelta:De}),oe+=De;$-Q[0].distance>x;)oe-=Q.shift().angleDelta;if(oe>C)return!1;F++,$+=he.dist(ve)}return!0}function L6(m){let c=0;for(let g=0;g<m.length-1;g++)c+=m[g].dist(m[g+1]);return c}function D6(m,c,g){return m?.6*c*g:0}function F6(m,c){return Math.max(m?m.right-m.left:0,c?c.right-c.left:0)}function eie(m,c,g,x,C,D){const F=D6(g,C,D),$=F6(g,x)*D;let Q=0;const oe=L6(m)/2;for(let he=0;he<m.length-1;he++){const ve=m[he],De=m[he+1],je=ve.dist(De);if(Q+je>oe){const $e=(oe-Q)/je,Xe=Si.number(ve.x,De.x,$e),ot=Si.number(ve.y,De.y,$e),vt=new _p(Xe,ot,De.angleTo(ve),he);return vt._round(),!F||N6(m,vt,$,F,c)?vt:void 0}Q+=je}}function tie(m,c,g,x,C,D,F,$,Q){const oe=D6(x,D,F),he=F6(x,C),ve=he*F,De=m[0].x===0||m[0].x===Q||m[0].y===0||m[0].y===Q;return c-ve<c/4&&(c=ve+c/4),B6(m,De?c/2*$%c:(he/2+2*D)*F*$%c,c,oe,g,ve,De,!1,Q)}function B6(m,c,g,x,C,D,F,$,Q){const oe=D/2,he=L6(m);let ve=0,De=c-g,je=[];for(let $e=0;$e<m.length-1;$e++){const Xe=m[$e],ot=m[$e+1],vt=Xe.dist(ot),Ht=ot.angleTo(Xe);for(;De+g<ve+vt;){De+=g;const Ot=(De-ve)/vt,ze=Si.number(Xe.x,ot.x,Ot),nt=Si.number(Xe.y,ot.y,Ot);if(ze>=0&&ze<Q&&nt>=0&&nt<Q&&De-oe>=0&&De+oe<=he){const Ft=new _p(ze,nt,Ht,$e);Ft._round(),x&&!N6(m,Ft,D,x,C)||je.push(Ft)}}ve+=vt}return $||je.length||F||(je=B6(m,ve/2,g,x,C,D,F,!0,Q)),je}function z6(m,c,g,x){const C=[],D=m.image,F=D.pixelRatio,$=D.paddedRect.w-2,Q=D.paddedRect.h-2;let oe={x1:m.left,y1:m.top,x2:m.right,y2:m.bottom};const he=D.stretchX||[[0,$]],ve=D.stretchY||[[0,Q]],De=(zr,zn)=>zr+zn[1]-zn[0],je=he.reduce(De,0),$e=ve.reduce(De,0),Xe=$-je,ot=Q-$e;let vt=0,Ht=je,Ot=0,ze=$e,nt=0,Ft=Xe,Sr=0,Jr=ot;if(D.content&&x){const zr=D.content,zn=zr[2]-zr[0],ni=zr[3]-zr[1];(D.textFitWidth||D.textFitHeight)&&(oe=d6(m)),vt=Rx(he,0,zr[0]),Ot=Rx(ve,0,zr[1]),Ht=Rx(he,zr[0],zr[2]),ze=Rx(ve,zr[1],zr[3]),nt=zr[0]-vt,Sr=zr[1]-Ot,Ft=zn-Ht,Jr=ni-ze}const Or=oe.x1,Fr=oe.y1,ln=oe.x2-Or,Qr=oe.y2-Fr,cn=(zr,zn,ni,ei)=>{const Hn=Ox(zr.stretch-vt,Ht,ln,Or),Qi=Nx(zr.fixed-nt,Ft,zr.stretch,je),$o=Ox(zn.stretch-Ot,ze,Qr,Fr),js=Nx(zn.fixed-Sr,Jr,zn.stretch,$e),Yl=Ox(ni.stretch-vt,Ht,ln,Or),Uc=Nx(ni.fixed-nt,Ft,ni.stretch,je),ec=Ox(ei.stretch-Ot,ze,Qr,Fr),Pl=Nx(ei.fixed-Sr,Jr,ei.stretch,$e),Lo=new S(Hn,$o),ul=new S(Yl,$o),kl=new S(Yl,ec),Ml=new S(Hn,ec),Ou=new S(Qi/F,js/F),Vc=new S(Uc/F,Pl/F),cl=c*Math.PI/180;if(cl){const hl=Math.sin(cl),fl=Math.cos(cl),Ps=[fl,-hl,hl,fl];Lo._matMult(Ps),ul._matMult(Ps),Ml._matMult(Ps),kl._matMult(Ps)}const tc=zr.stretch+zr.fixed,Us=zn.stretch+zn.fixed;return{tl:Lo,tr:ul,bl:Ml,br:kl,tex:{x:D.paddedRect.x+1+tc,y:D.paddedRect.y+1+Us,w:ni.stretch+ni.fixed-tc,h:ei.stretch+ei.fixed-Us},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ou,pixelOffsetBR:Vc,minFontScaleX:Ft/F/ln,minFontScaleY:Jr/F/Qr,isSDF:g}};if(x&&(D.stretchX||D.stretchY)){const zr=j6(he,Xe,je),zn=j6(ve,ot,$e);for(let ni=0;ni<zr.length-1;ni++){const ei=zr[ni],Hn=zr[ni+1];for(let Qi=0;Qi<zn.length-1;Qi++)C.push(cn(ei,zn[Qi],Hn,zn[Qi+1]))}}else C.push(cn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:Q+1}));return C}function Rx(m,c,g){let x=0;for(const C of m)x+=Math.max(c,Math.min(g,C[1]))-Math.max(c,Math.min(g,C[0]));return x}function j6(m,c,g){const x=[{fixed:-1,stretch:0}];for(const[C,D]of m){const F=x[x.length-1];x.push({fixed:C-F.stretch,stretch:F.stretch}),x.push({fixed:C-F.stretch,stretch:F.stretch+(D-C)})}return x.push({fixed:c+1,stretch:g}),x}function Ox(m,c,g,x){return m/c*g+x}function Nx(m,c,g,x){return m-c*g/x}xt("Anchor",_p);class Lx{constructor(c,g,x,C,D,F,$,Q,oe,he){var ve;if(this.boxStartIndex=c.length,oe){let De=F.top,je=F.bottom;const $e=F.collisionPadding;$e&&(De-=$e[1],je+=$e[3]);let Xe=je-De;Xe>0&&(Xe=Math.max(10,Xe),this.circleDiameter=Xe)}else{const De=!((ve=F.image)===null||ve===void 0)&&ve.content&&(F.image.textFitWidth||F.image.textFitHeight)?d6(F):{x1:F.left,y1:F.top,x2:F.right,y2:F.bottom};De.y1=De.y1*$-Q[0],De.y2=De.y2*$+Q[2],De.x1=De.x1*$-Q[3],De.x2=De.x2*$+Q[1];const je=F.collisionPadding;if(je&&(De.x1-=je[0]*$,De.y1-=je[1]*$,De.x2+=je[2]*$,De.y2+=je[3]*$),he){const $e=new S(De.x1,De.y1),Xe=new S(De.x2,De.y1),ot=new S(De.x1,De.y2),vt=new S(De.x2,De.y2),Ht=he*Math.PI/180;$e._rotate(Ht),Xe._rotate(Ht),ot._rotate(Ht),vt._rotate(Ht),De.x1=Math.min($e.x,Xe.x,ot.x,vt.x),De.x2=Math.max($e.x,Xe.x,ot.x,vt.x),De.y1=Math.min($e.y,Xe.y,ot.y,vt.y),De.y2=Math.max($e.y,Xe.y,ot.y,vt.y)}c.emplaceBack(g.x,g.y,De.x1,De.y1,De.x2,De.y2,x,C,D)}this.boxEndIndex=c.length}}class rie{constructor(c=[],g=(x,C)=>x<C?-1:x>C?1:0){if(this.data=c,this.length=this.data.length,this.compare=g,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],g=this.data.pop();return--this.length>0&&(this.data[0]=g,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:g,compare:x}=this,C=g[c];for(;c>0;){const D=c-1>>1,F=g[D];if(x(C,F)>=0)break;g[c]=F,c=D}g[c]=C}_down(c){const{data:g,compare:x}=this,C=this.length>>1,D=g[c];for(;c<C;){let F=1+(c<<1);const $=F+1;if($<this.length&&x(g[$],g[F])<0&&(F=$),x(g[F],D)>=0)break;g[c]=g[F],c=F}g[c]=D}}function nie(m,c=1,g=!1){const x=Cg.fromPoints(m[0]),C=Math.min(x.width(),x.height());let D=C/2;const F=new rie([],iie),{minX:$,minY:Q,maxX:oe,maxY:he}=x;if(C===0)return new S($,Q);for(let je=$;je<oe;je+=C)for(let $e=Q;$e<he;$e+=C)F.push(new gy(je+D,$e+D,D,m));let ve=(function(je){let $e=0,Xe=0,ot=0;const vt=je[0];for(let Ht=0,Ot=vt.length,ze=Ot-1;Ht<Ot;ze=Ht++){const nt=vt[Ht],Ft=vt[ze],Sr=nt.x*Ft.y-Ft.x*nt.y;Xe+=(nt.x+Ft.x)*Sr,ot+=(nt.y+Ft.y)*Sr,$e+=3*Sr}return new gy(Xe/$e,ot/$e,0,je)})(m),De=F.length;for(;F.length;){const je=F.pop();(je.d>ve.d||!ve.d)&&(ve=je,g&&console.log("found best %d after %d probes",Math.round(1e4*je.d)/1e4,De)),je.max-ve.d<=c||(D=je.h/2,F.push(new gy(je.p.x-D,je.p.y-D,D,m)),F.push(new gy(je.p.x+D,je.p.y-D,D,m)),F.push(new gy(je.p.x-D,je.p.y+D,D,m)),F.push(new gy(je.p.x+D,je.p.y+D,D,m)),De+=4)}return g&&(console.log(`num probes: ${De}`),console.log(`best distance: ${ve.d}`)),ve.p}function iie(m,c){return c.max-m.max}function gy(m,c,g,x){this.p=new S(m,c),this.h=g,this.d=(function(C,D){let F=!1,$=1/0;for(let Q=0;Q<D.length;Q++){const oe=D[Q];for(let he=0,ve=oe.length,De=ve-1;he<ve;De=he++){const je=oe[he],$e=oe[De];je.y>C.y!=$e.y>C.y&&C.x<($e.x-je.x)*(C.y-je.y)/($e.y-je.y)+je.x&&(F=!F),$=Math.min($,_D(C,je,$e))}}return(F?1:-1)*Math.sqrt($)})(this.p,x),this.max=this.d+this.h*Math.SQRT2}var Xl;s.aD=void 0,(Xl=s.aD||(s.aD={}))[Xl.center=1]="center",Xl[Xl.left=2]="left",Xl[Xl.right=3]="right",Xl[Xl.top=4]="top",Xl[Xl.bottom=5]="bottom",Xl[Xl["top-left"]=6]="top-left",Xl[Xl["top-right"]=7]="top-right",Xl[Xl["bottom-left"]=8]="bottom-left",Xl[Xl["bottom-right"]=9]="bottom-right";const $C=Number.POSITIVE_INFINITY;function U6(m,c){return c[1]!==$C?(function(g,x,C){let D=0,F=0;switch(x=Math.abs(x),C=Math.abs(C),g){case"top-right":case"top-left":case"top":F=C-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-C}switch(g){case"top-right":case"bottom-right":case"right":D=-x;break;case"top-left":case"bottom-left":case"left":D=x}return[D,F]})(m,c[0],c[1]):(function(g,x){let C=0,D=0;x<0&&(x=0);const F=x/Math.SQRT2;switch(g){case"top-right":case"top-left":D=F-7;break;case"bottom-right":case"bottom-left":D=7-F;break;case"bottom":D=7-x;break;case"top":D=x-7}switch(g){case"top-right":case"bottom-right":C=-F;break;case"top-left":case"bottom-left":C=F;break;case"left":C=x;break;case"right":C=-x}return[C,D]})(m,c[0])}function V6(m,c,g){var x;const C=m.layout,D=(x=C.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(c,{},g);if(D){const $=D.values,Q=[];for(let oe=0;oe<$.length;oe+=2){const he=Q[oe]=$[oe],ve=$[oe+1].map((De=>De*ll));he.startsWith("top")?ve[1]-=7:he.startsWith("bottom")&&(ve[1]+=7),Q[oe+1]=ve}return new Pn(Q)}const F=C.get("text-variable-anchor");if(F){let $;$=m._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[C.get("text-radial-offset").evaluate(c,{},g)*ll,$C]:C.get("text-offset").evaluate(c,{},g).map((oe=>oe*ll));const Q=[];for(const oe of F)Q.push(oe,U6(oe,$));return new Pn(Q)}return null}function qC(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function aie(m,c,g,x,C,D,F,$,Q,oe,he,ve){let De=D.textMaxSize.evaluate(c,{});De===void 0&&(De=F);const je=m.layers[0].layout,$e=je.get("icon-offset").evaluate(c,{},he),Xe=q6(g.horizontal),ot=F/24,vt=m.tilePixelRatio*ot,Ht=m.tilePixelRatio*De/24,Ot=m.tilePixelRatio*$,ze=m.tilePixelRatio*je.get("symbol-spacing"),nt=je.get("text-padding")*m.tilePixelRatio,Ft=(function(ni,ei,Hn,Qi=1){const $o=ni.get("icon-padding").evaluate(ei,{},Hn),js=$o&&$o.values;return[js[0]*Qi,js[1]*Qi,js[2]*Qi,js[3]*Qi]})(je,c,he,m.tilePixelRatio),Sr=je.get("text-max-angle")/180*Math.PI,Jr=je.get("text-rotation-alignment")!=="viewport"&&je.get("symbol-placement")!=="point",Or=je.get("icon-rotation-alignment")==="map"&&je.get("symbol-placement")!=="point",Fr=je.get("symbol-placement"),ln=ze/2,Qr=je.get("icon-text-fit");let cn;x&&Qr!=="none"&&(m.allowVerticalPlacement&&g.vertical&&(cn=p6(x,g.vertical,Qr,je.get("icon-text-fit-padding"),$e,ot)),Xe&&(x=p6(x,Xe,Qr,je.get("icon-text-fit-padding"),$e,ot)));const zr=he?ve.line.getGranularityForZoomLevel(he.z):1,zn=(ni,ei)=>{ei.x<0||ei.x>=ce||ei.y<0||ei.y>=ce||(function(Hn,Qi,$o,js,Yl,Uc,ec,Pl,Lo,ul,kl,Ml,Ou,Vc,cl,tc,Us,hl,fl,Ps,mo,$h,my,qh,lie){const yy=Hn.addToLineVertexArray(Qi,$o);let Ag,vy,_y,by,X6=0,Y6=0,Z6=0,K6=0,JC=-1,QC=-1;const wd={};let J6=Ru("");if(Hn.allowVerticalPlacement&&js.vertical){const hu=Pl.layout.get("text-rotate").evaluate(mo,{},qh)+90;_y=new Lx(Lo,Qi,ul,kl,Ml,js.vertical,Ou,Vc,cl,hu),ec&&(by=new Lx(Lo,Qi,ul,kl,Ml,ec,Us,hl,cl,hu))}if(Yl){const hu=Pl.layout.get("icon-rotate").evaluate(mo,{}),$c=Pl.layout.get("icon-text-fit")!=="none",Ig=z6(Yl,hu,my,$c),Wh=ec?z6(ec,hu,my,$c):void 0;vy=new Lx(Lo,Qi,ul,kl,Ml,Yl,Us,hl,!1,hu),X6=4*Ig.length;const Pg=Hn.iconSizeData;let Mf=null;Pg.kind==="source"?(Mf=[xd*Pl.layout.get("icon-size").evaluate(mo,{})],Mf[0]>yp&&Yt(`${Hn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Pg.kind==="composite"&&(Mf=[xd*$h.compositeIconSizes[0].evaluate(mo,{},qh),xd*$h.compositeIconSizes[1].evaluate(mo,{},qh)],(Mf[0]>yp||Mf[1]>yp)&&Yt(`${Hn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Hn.addSymbols(Hn.icon,Ig,Mf,Ps,fl,mo,s.an.none,Qi,yy.lineStartIndex,yy.lineLength,-1,qh),JC=Hn.icon.placedSymbolArray.length-1,Wh&&(Y6=4*Wh.length,Hn.addSymbols(Hn.icon,Wh,Mf,Ps,fl,mo,s.an.vertical,Qi,yy.lineStartIndex,yy.lineLength,-1,qh),QC=Hn.icon.placedSymbolArray.length-1)}const Q6=Object.keys(js.horizontal);for(const hu of Q6){const $c=js.horizontal[hu];if(!Ag){J6=Ru($c.text);const Wh=Pl.layout.get("text-rotate").evaluate(mo,{},qh);Ag=new Lx(Lo,Qi,ul,kl,Ml,$c,Ou,Vc,cl,Wh)}const Ig=$c.positionedLines.length===1;if(Z6+=$6(Hn,Qi,$c,Uc,Pl,cl,mo,tc,yy,js.vertical?s.an.horizontal:s.an.horizontalOnly,Ig?Q6:[hu],wd,JC,$h,qh),Ig)break}js.vertical&&(K6+=$6(Hn,Qi,js.vertical,Uc,Pl,cl,mo,tc,yy,s.an.vertical,["vertical"],wd,QC,$h,qh));const uie=Ag?Ag.boxStartIndex:Hn.collisionBoxArray.length,cie=Ag?Ag.boxEndIndex:Hn.collisionBoxArray.length,hie=_y?_y.boxStartIndex:Hn.collisionBoxArray.length,fie=_y?_y.boxEndIndex:Hn.collisionBoxArray.length,die=vy?vy.boxStartIndex:Hn.collisionBoxArray.length,pie=vy?vy.boxEndIndex:Hn.collisionBoxArray.length,gie=by?by.boxStartIndex:Hn.collisionBoxArray.length,mie=by?by.boxEndIndex:Hn.collisionBoxArray.length;let Hh=-1;const Fx=(hu,$c)=>hu&&hu.circleDiameter?Math.max(hu.circleDiameter,$c):$c;Hh=Fx(Ag,Hh),Hh=Fx(_y,Hh),Hh=Fx(vy,Hh),Hh=Fx(by,Hh);const eF=Hh>-1?1:0;eF&&(Hh*=lie/ll),Hn.glyphOffsetArray.length>=dy.MAX_GLYPHS&&Yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mo.sortKey!==void 0&&Hn.addToSortKeyRanges(Hn.symbolInstances.length,mo.sortKey);const yie=V6(Pl,mo,qh),[vie,_ie]=(function(hu,$c){const Ig=hu.length,Wh=$c?.values;if(Wh?.length>0)for(let Pg=0;Pg<Wh.length;Pg+=2){const Mf=Wh[Pg+1];hu.emplaceBack(s.aD[Wh[Pg]],Mf[0],Mf[1])}return[Ig,hu.length]})(Hn.textAnchorOffsets,yie);Hn.symbolInstances.emplaceBack(Qi.x,Qi.y,wd.right>=0?wd.right:-1,wd.center>=0?wd.center:-1,wd.left>=0?wd.left:-1,wd.vertical||-1,JC,QC,J6,uie,cie,hie,fie,die,pie,gie,mie,ul,Z6,K6,X6,Y6,eF,0,Ou,Hh,vie,_ie)})(m,ei,ni,g,x,C,cn,m.layers[0],m.collisionBoxArray,c.index,c.sourceLayerIndex,m.index,vt,[nt,nt,nt,nt],Jr,Q,Ot,Ft,Or,$e,c,D,oe,he,F)};if(Fr==="line")for(const ni of O6(c.geometry,0,0,ce,ce)){const ei=Tg(ni,zr),Hn=tie(ei,ze,Sr,g.vertical||Xe,x,24,Ht,m.overscaling,ce);for(const Qi of Hn)Xe&&oie(m,Xe.text,ln,Qi)||zn(ei,Qi)}else if(Fr==="line-center"){for(const ni of c.geometry)if(ni.length>1){const ei=Tg(ni,zr),Hn=eie(ei,Sr,g.vertical||Xe,x,24,Ht);Hn&&zn(ei,Hn)}}else if(c.type==="Polygon")for(const ni of ls(c.geometry,0)){const ei=nie(ni,16);zn(Tg(ni[0],zr,!0),new _p(ei.x,ei.y,0))}else if(c.type==="LineString")for(const ni of c.geometry){const ei=Tg(ni,zr);zn(ei,new _p(ei[0].x,ei[0].y,0))}else if(c.type==="Point")for(const ni of c.geometry)for(const ei of ni)zn([ei],new _p(ei.x,ei.y,0))}function $6(m,c,g,x,C,D,F,$,Q,oe,he,ve,De,je,$e){const Xe=(function(Ht,Ot,ze,nt,Ft,Sr,Jr,Or){const Fr=nt.layout.get("text-rotate").evaluate(Sr,{})*Math.PI/180,ln=[];for(const Qr of Ot.positionedLines)for(const cn of Qr.positionedGlyphs){if(!cn.rect)continue;const zr=cn.rect||{};let zn=4,ni=!0,ei=1,Hn=0;const Qi=(Ft||Or)&&cn.vertical,$o=cn.metrics.advance*cn.scale/2;if(Or&&Ot.verticalizable&&(Hn=Qr.lineOffset/2-(cn.imageName?-(ll-cn.metrics.width*cn.scale)/2:(cn.scale-1)*ll)),cn.imageName){const hl=Jr[cn.imageName];ni=hl.sdf,ei=hl.pixelRatio,zn=1/ei}const js=Ft?[cn.x+$o,cn.y]:[0,0];let Yl=Ft?[0,0]:[cn.x+$o+ze[0],cn.y+ze[1]-Hn],Uc=[0,0];Qi&&(Uc=Yl,Yl=[0,0]);const ec=cn.metrics.isDoubleResolution?2:1,Pl=(cn.metrics.left-zn)*cn.scale-$o+Yl[0],Lo=(-cn.metrics.top-zn)*cn.scale+Yl[1],ul=Pl+zr.w/ec*cn.scale/ei,kl=Lo+zr.h/ec*cn.scale/ei,Ml=new S(Pl,Lo),Ou=new S(ul,Lo),Vc=new S(Pl,kl),cl=new S(ul,kl);if(Qi){const hl=new S(-$o,$o- -17),fl=-Math.PI/2,Ps=12-$o,mo=new S(22-Ps,-(cn.imageName?Ps:0)),$h=new S(...Uc);Ml._rotateAround(fl,hl)._add(mo)._add($h),Ou._rotateAround(fl,hl)._add(mo)._add($h),Vc._rotateAround(fl,hl)._add(mo)._add($h),cl._rotateAround(fl,hl)._add(mo)._add($h)}if(Fr){const hl=Math.sin(Fr),fl=Math.cos(Fr),Ps=[fl,-hl,hl,fl];Ml._matMult(Ps),Ou._matMult(Ps),Vc._matMult(Ps),cl._matMult(Ps)}const tc=new S(0,0),Us=new S(0,0);ln.push({tl:Ml,tr:Ou,bl:Vc,br:cl,tex:zr,writingMode:Ot.writingMode,glyphOffset:js,sectionIndex:cn.sectionIndex,isSDF:ni,pixelOffsetTL:tc,pixelOffsetBR:Us,minFontScaleX:0,minFontScaleY:0})}return ln})(0,g,$,C,D,F,x,m.allowVerticalPlacement),ot=m.textSizeData;let vt=null;ot.kind==="source"?(vt=[xd*C.layout.get("text-size").evaluate(F,{})],vt[0]>yp&&Yt(`${m.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ot.kind==="composite"&&(vt=[xd*je.compositeTextSizes[0].evaluate(F,{},$e),xd*je.compositeTextSizes[1].evaluate(F,{},$e)],(vt[0]>yp||vt[1]>yp)&&Yt(`${m.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),m.addSymbols(m.text,Xe,vt,$,D,F,oe,c,Q.lineStartIndex,Q.lineLength,De,$e);for(const Ht of he)ve[Ht]=m.text.placedSymbolArray.length-1;return 4*Xe.length}function q6(m){for(const c in m)return m[c];return null}function oie(m,c,g,x){const C=m.compareText;if(c in C){const D=C[c];for(let F=D.length-1;F>=0;F--)if(x.dist(D[F])<g)return!0}else C[c]=[];return C[c].push(x),!1}const H6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class HC{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[g,x]=new Uint8Array(c,0,2);if(g!==219)throw new Error("Data does not appear to be in a KDBush format.");const C=x>>4;if(C!==1)throw new Error(`Got v${C} data when expected v1.`);const D=H6[15&x];if(!D)throw new Error("Unrecognized array type.");const[F]=new Uint16Array(c,2,1),[$]=new Uint32Array(c,4,1);return new HC($,F,D,c)}constructor(c,g=64,x=Float64Array,C){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+g,2),65535),this.ArrayType=x,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const D=H6.indexOf(this.ArrayType),F=2*c*this.ArrayType.BYTES_PER_ELEMENT,$=c*this.IndexArrayType.BYTES_PER_ELEMENT,Q=(8-$%8)%8;if(D<0)throw new Error(`Unexpected typed array class: ${x}.`);C&&C instanceof ArrayBuffer?(this.data=C,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+$+Q,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+F+$+Q),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+$+Q,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+D]),new Uint16Array(this.data,2,1)[0]=g,new Uint32Array(this.data,4,1)[0]=c)}add(c,g){const x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=c,this.coords[this._pos++]=g,x}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return WC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,g,x,C){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:D,coords:F,nodeSize:$}=this,Q=[0,D.length-1,0],oe=[];for(;Q.length;){const he=Q.pop()||0,ve=Q.pop()||0,De=Q.pop()||0;if(ve-De<=$){for(let ot=De;ot<=ve;ot++){const vt=F[2*ot],Ht=F[2*ot+1];vt>=c&&vt<=x&&Ht>=g&&Ht<=C&&oe.push(D[ot])}continue}const je=De+ve>>1,$e=F[2*je],Xe=F[2*je+1];$e>=c&&$e<=x&&Xe>=g&&Xe<=C&&oe.push(D[je]),(he===0?c<=$e:g<=Xe)&&(Q.push(De),Q.push(je-1),Q.push(1-he)),(he===0?x>=$e:C>=Xe)&&(Q.push(je+1),Q.push(ve),Q.push(1-he))}return oe}within(c,g,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:D,nodeSize:F}=this,$=[0,C.length-1,0],Q=[],oe=x*x;for(;$.length;){const he=$.pop()||0,ve=$.pop()||0,De=$.pop()||0;if(ve-De<=F){for(let ot=De;ot<=ve;ot++)G6(D[2*ot],D[2*ot+1],c,g)<=oe&&Q.push(C[ot]);continue}const je=De+ve>>1,$e=D[2*je],Xe=D[2*je+1];G6($e,Xe,c,g)<=oe&&Q.push(C[je]),(he===0?c-x<=$e:g-x<=Xe)&&($.push(De),$.push(je-1),$.push(1-he)),(he===0?c+x>=$e:g+x>=Xe)&&($.push(je+1),$.push(ve),$.push(1-he))}return Q}}function WC(m,c,g,x,C,D){if(C-x<=g)return;const F=x+C>>1;W6(m,c,F,x,C,D),WC(m,c,g,x,F-1,1-D),WC(m,c,g,F+1,C,1-D)}function W6(m,c,g,x,C,D){for(;C>x;){if(C-x>600){const oe=C-x+1,he=g-x+1,ve=Math.log(oe),De=.5*Math.exp(2*ve/3),je=.5*Math.sqrt(ve*De*(oe-De)/oe)*(he-oe/2<0?-1:1);W6(m,c,g,Math.max(x,Math.floor(g-he*De/oe+je)),Math.min(C,Math.floor(g+(oe-he)*De/oe+je)),D)}const F=c[2*g+D];let $=x,Q=C;for(h_(m,c,x,g),c[2*C+D]>F&&h_(m,c,x,C);$<Q;){for(h_(m,c,$,Q),$++,Q--;c[2*$+D]<F;)$++;for(;c[2*Q+D]>F;)Q--}c[2*x+D]===F?h_(m,c,x,Q):(Q++,h_(m,c,Q,C)),Q<=g&&(x=Q+1),g<=Q&&(C=Q-1)}}function h_(m,c,g,x){GC(m,g,x),GC(c,2*g,2*x),GC(c,2*g+1,2*x+1)}function GC(m,c,g){const x=m[c];m[c]=m[g],m[g]=x}function G6(m,c,g,x){const C=m-g,D=c-x;return C*C+D*D}var XC;s.cw=void 0,(XC=s.cw||(s.cw={})).create="create",XC.load="load",XC.fullLoad="fullLoad";let Dx=null,f_=[];const YC=1e3/60,ZC="loadTime",KC="fullLoadTime",sie={mark(m){performance.mark(m)},frame(m){const c=m;Dx!=null&&f_.push(c-Dx),Dx=c},clearMetrics(){Dx=null,f_=[],performance.clearMeasures(ZC),performance.clearMeasures(KC);for(const m in s.cw)performance.clearMarks(s.cw[m])},getPerformanceMetrics(){performance.measure(ZC,s.cw.create,s.cw.load),performance.measure(KC,s.cw.create,s.cw.fullLoad);const m=performance.getEntriesByName(ZC)[0].duration,c=performance.getEntriesByName(KC)[0].duration,g=f_.length,x=1/(f_.reduce(((D,F)=>D+F),0)/g/1e3),C=f_.filter((D=>D>YC)).reduce(((D,F)=>D+(F-YC)/YC),0);return{loadTime:m,fullLoadTime:c,fps:x,percentDroppedFrames:C/(g+C)*100,totalFrames:g}}};s.$=ce,s.A=B,s.B=function([m,c,g]){return c+=90,c*=Math.PI/180,g*=Math.PI/180,{x:m*Math.cos(c)*Math.sin(g),y:m*Math.sin(c)*Math.sin(g),z:m*Math.cos(g)}},s.C=Si,s.D=sn,s.E=Xt,s.F=qn,s.G=We,s.H=function(m){if(br==null){const c=m.navigator?m.navigator.userAgent:null;br=!!m.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return br},s.I=RC,s.J=class{constructor(m,c){this.target=m,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Kne((()=>this.process())),this.subscription=fr(this.target,"message",(g=>this.receive(g)),!1),this.globalScope=mt(self)?m:window}registerMessageHandler(m,c){this.messageHandlers[m]=c}sendAsync(m,c){return new Promise(((g,x)=>{const C=Math.round(1e18*Math.random()).toString(36).substring(0,10),D=c?fr(c.signal,"abort",(()=>{D?.unsubscribe(),delete this.resolveRejects[C];const Q={id:C,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(Q)}),Jne):null;this.resolveRejects[C]={resolve:Q=>{D?.unsubscribe(),g(Q)},reject:Q=>{D?.unsubscribe(),x(Q)}};const F=[],$=Object.assign(Object.assign({},m),{id:C,sourceMapId:this.mapId,origin:location.origin,data:dr(m.data,F)});this.target.postMessage($,{transfer:F})}))}receive(m){const c=m.data,g=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[g];const x=this.abortControllers[g];return delete this.abortControllers[g],void(x&&x.abort())}if(mt(self)||c.mustQueue)return this.tasks[g]=c,this.taskQueue.push(g),void this.invoker.trigger();this.processTask(g,c)}}process(){if(this.taskQueue.length===0)return;const m=this.taskQueue.shift(),c=this.tasks[m];delete this.tasks[m],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(m,c)}processTask(m,c){return o(this,void 0,void 0,(function*(){if(c.type==="<response>"){const C=this.resolveRejects[m];return delete this.resolveRejects[m],C?void(c.error?C.reject(Ur(c.error)):C.resolve(Ur(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(m,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const g=Ur(c.data),x=new AbortController;this.abortControllers[m]=x;try{const C=yield this.messageHandlers[c.type](c.sourceMapId,g,x);this.completeTask(m,null,C)}catch(C){this.completeTask(m,C)}}))}completeTask(m,c,g){const x=[];delete this.abortControllers[m];const C={id:m,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?dr(c):null,data:dr(g,x)};this.target.postMessage(C,{transfer:x})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.K=Ne,s.L=function(){var m=new B(16);return B!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},s.M=function(m,c,g){var x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe=g[0],ot=g[1],vt=g[2];return c===m?(m[12]=c[0]*Xe+c[4]*ot+c[8]*vt+c[12],m[13]=c[1]*Xe+c[5]*ot+c[9]*vt+c[13],m[14]=c[2]*Xe+c[6]*ot+c[10]*vt+c[14],m[15]=c[3]*Xe+c[7]*ot+c[11]*vt+c[15]):(C=c[1],D=c[2],F=c[3],$=c[4],Q=c[5],oe=c[6],he=c[7],ve=c[8],De=c[9],je=c[10],$e=c[11],m[0]=x=c[0],m[1]=C,m[2]=D,m[3]=F,m[4]=$,m[5]=Q,m[6]=oe,m[7]=he,m[8]=ve,m[9]=De,m[10]=je,m[11]=$e,m[12]=x*Xe+$*ot+ve*vt+c[12],m[13]=C*Xe+Q*ot+De*vt+c[13],m[14]=D*Xe+oe*ot+je*vt+c[14],m[15]=F*Xe+he*ot+$e*vt+c[15]),m},s.N=function(m,c,g){var x=g[0],C=g[1],D=g[2];return m[0]=c[0]*x,m[1]=c[1]*x,m[2]=c[2]*x,m[3]=c[3]*x,m[4]=c[4]*C,m[5]=c[5]*C,m[6]=c[6]*C,m[7]=c[7]*C,m[8]=c[8]*D,m[9]=c[9]*D,m[10]=c[10]*D,m[11]=c[11]*D,m[12]=c[12],m[13]=c[13],m[14]=c[14],m[15]=c[15],m},s.O=function(m,c,g){var x=c[0],C=c[1],D=c[2],F=c[3],$=c[4],Q=c[5],oe=c[6],he=c[7],ve=c[8],De=c[9],je=c[10],$e=c[11],Xe=c[12],ot=c[13],vt=c[14],Ht=c[15],Ot=g[0],ze=g[1],nt=g[2],Ft=g[3];return m[0]=Ot*x+ze*$+nt*ve+Ft*Xe,m[1]=Ot*C+ze*Q+nt*De+Ft*ot,m[2]=Ot*D+ze*oe+nt*je+Ft*vt,m[3]=Ot*F+ze*he+nt*$e+Ft*Ht,m[4]=(Ot=g[4])*x+(ze=g[5])*$+(nt=g[6])*ve+(Ft=g[7])*Xe,m[5]=Ot*C+ze*Q+nt*De+Ft*ot,m[6]=Ot*D+ze*oe+nt*je+Ft*vt,m[7]=Ot*F+ze*he+nt*$e+Ft*Ht,m[8]=(Ot=g[8])*x+(ze=g[9])*$+(nt=g[10])*ve+(Ft=g[11])*Xe,m[9]=Ot*C+ze*Q+nt*De+Ft*ot,m[10]=Ot*D+ze*oe+nt*je+Ft*vt,m[11]=Ot*F+ze*he+nt*$e+Ft*Ht,m[12]=(Ot=g[12])*x+(ze=g[13])*$+(nt=g[14])*ve+(Ft=g[15])*Xe,m[13]=Ot*C+ze*Q+nt*De+Ft*ot,m[14]=Ot*D+ze*oe+nt*je+Ft*vt,m[15]=Ot*F+ze*he+nt*$e+Ft*Ht,m},s.P=S,s.Q=function(m,c){const g={};for(let x=0;x<c.length;x++){const C=c[x];C in m&&(g[C]=m[C])}return g},s.R=Qu,s.S=vp,s.T=yC,s.U=E6,s.V=S6,s.W=N,s.X=M,s.Y=Mr,s.Z=jc,s._=o,s.a=Oe,s.a$=function(m,c,g){return m[0]=c[0]*g,m[1]=c[1]*g,m[2]=c[2]*g,m[3]=c[3]*g,m},s.a0=c_,s.a1=Cg,s.a2=25,s.a3=VC,s.a4=m=>{const c=window.document.createElement("video");return c.muted=!0,new Promise((g=>{c.onloadstart=()=>{g(c)};for(const x of m){const C=window.document.createElement("source");Bt(x)||(c.crossOrigin="Anonymous"),C.src=x,c.appendChild(C)}}))},s.a5=Rr,s.a6=function(){return Ie++},s.a7=lt,s.a8=dy,s.a9=Iu,s.aA=ll,s.aB=xe,s.aC=function(m,c,g,x,C=!1){if(!g[0]&&!g[1])return[0,0];const D=C?x==="map"?-m.bearingInRadians:0:x==="viewport"?m.bearingInRadians:0;if(D){const F=Math.sin(D),$=Math.cos(D);g=[g[0]*$-g[1]*F,g[0]*F+g[1]*$]}return[C?g[0]:xe(c,g[0],m.zoom),C?g[1]:xe(c,g[1],m.zoom)]},s.aE=LC,s.aF=qC,s.aG=NC,s.aH=HC,s.aI=Ki,s.aJ=Tx,s.aK=vr,s.aL=Gi,s.aM=oa,s.aN=Ze,s.aO=or,s.aP=C6,s.aQ=ne,s.aR=H,s.aS=function(m){var c=new B(3);return c[0]=m[0],c[1]=m[1],c[2]=m[2],c},s.aT=function(m,c,g){return m[0]=c[0]-g[0],m[1]=c[1]-g[1],m[2]=c[2]-g[2],m},s.aU=function(m,c){var g=c[0],x=c[1],C=c[2],D=g*g+x*x+C*C;return D>0&&(D=1/Math.sqrt(D)),m[0]=c[0]*D,m[1]=c[1]*D,m[2]=c[2]*D,m},s.aV=ae,s.aW=function(m,c){return m[0]*c[0]+m[1]*c[1]+m[2]*c[2]},s.aX=function(m,c,g){return m[0]=c[0]*g[0],m[1]=c[1]*g[1],m[2]=c[2]*g[2],m[3]=c[3]*g[3],m},s.aY=ie,s.aZ=function(m,c,g){const x=c[0]*g[0]+c[1]*g[1]+c[2]*g[2];return x===0?null:(-(m[0]*g[0]+m[1]*g[1]+m[2]*g[2])-g[3])/x},s.a_=de,s.aa=Sg,s.ab=k6,s.ac=function(m){const c={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((g,x,C,D)=>{const F=C||D;return c[x]=!F||F.toLowerCase(),""})),c["max-age"]){const g=parseInt(c["max-age"],10);isNaN(g)?delete c["max-age"]:c["max-age"]=g}return c},s.ad=Nr,s.ae=function(m){return Math.pow(2,m)},s.af=W,s.ag=tt,s.ah=85.051129,s.ai=T6,s.aj=function(m){return Math.log(m)/Math.LN2},s.ak=function(m){var c=m[0],g=m[1];return c*c+g*g},s.al=function(m,c){const g=[];for(const x in m)x in c||g.push(x);return g},s.am=function(m,c){let g=0,x=0;if(m.kind==="constant")x=m.layoutSize;else if(m.kind!=="source"){const{interpolationType:C,minZoom:D,maxZoom:F}=m,$=C?tt(li.interpolationFactor(C,c,D,F),0,1):0;m.kind==="camera"?x=Si.number(m.minSize,m.maxSize,$):g=$}return{uSizeT:g,uSize:x}},s.ao=function(m,{uSize:c,uSizeT:g},{lowerSize:x,upperSize:C}){return m.kind==="source"?x/xd:m.kind==="composite"?Si.number(x/xd,C/xd,g):c},s.ap=function(m,c){var g=c[0],x=c[1],C=c[2],D=c[3],F=c[4],$=c[5],Q=c[6],oe=c[7],he=c[8],ve=c[9],De=c[10],je=c[11],$e=c[12],Xe=c[13],ot=c[14],vt=c[15],Ht=g*$-x*F,Ot=g*Q-C*F,ze=g*oe-D*F,nt=x*Q-C*$,Ft=x*oe-D*$,Sr=C*oe-D*Q,Jr=he*Xe-ve*$e,Or=he*ot-De*$e,Fr=he*vt-je*$e,ln=ve*ot-De*Xe,Qr=ve*vt-je*Xe,cn=De*vt-je*ot,zr=Ht*cn-Ot*Qr+ze*ln+nt*Fr-Ft*Or+Sr*Jr;return zr?(m[0]=($*cn-Q*Qr+oe*ln)*(zr=1/zr),m[1]=(C*Qr-x*cn-D*ln)*zr,m[2]=(Xe*Sr-ot*Ft+vt*nt)*zr,m[3]=(De*Ft-ve*Sr-je*nt)*zr,m[4]=(Q*Fr-F*cn-oe*Or)*zr,m[5]=(g*cn-C*Fr+D*Or)*zr,m[6]=(ot*ze-$e*Sr-vt*Ot)*zr,m[7]=(he*Sr-De*ze+je*Ot)*zr,m[8]=(F*Qr-$*Fr+oe*Jr)*zr,m[9]=(x*Fr-g*Qr-D*Jr)*zr,m[10]=($e*Ft-Xe*ze+vt*Ht)*zr,m[11]=(ve*ze-he*Ft-je*Ht)*zr,m[12]=($*Or-F*ln-Q*Jr)*zr,m[13]=(g*ln-x*Or+C*Jr)*zr,m[14]=(Xe*Ot-$e*nt-ot*Ht)*zr,m[15]=(he*nt-ve*Ot+De*Ht)*zr,m):null},s.aq=we,s.ar=function(m){return Math.hypot(m[0],m[1])},s.as=function(m){return m[0]=0,m[1]=0,m},s.at=function(m,c,g){return m[0]=c[0]*g,m[1]=c[1]*g,m},s.au=DC,s.av=Pe,s.aw=function(m,c,g,x){const C=c.y-m.y,D=c.x-m.x,F=x.y-g.y,$=x.x-g.x,Q=F*D-$*C;if(Q===0)return null;const oe=($*(m.y-g.y)-F*(m.x-g.x))/Q;return new S(m.x+oe*D,m.y+oe*C)},s.ax=O6,s.ay=yD,s.az=function(m){let c=1/0,g=1/0,x=-1/0,C=-1/0;for(const D of m)c=Math.min(c,D.x),g=Math.min(g,D.y),x=Math.max(x,D.x),C=Math.max(C,D.y);return[c,g,x,C]},s.b=Tr,s.b$=Ine,s.b0=function(m,c){return m[0]*c[0]+m[1]*c[1]+m[2]*c[2]+m[3]},s.b1=I6,s.b2=py,s.b3=function(m,c,g,x,C){var D,F=1/Math.tan(c/2);return m[0]=F/g,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=F,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,C!=null&&C!==1/0?(m[10]=(C+x)*(D=1/(x-C)),m[14]=2*C*x*D):(m[10]=-1,m[14]=-2*x),m},s.b4=function(m){var c=new B(16);return c[0]=m[0],c[1]=m[1],c[2]=m[2],c[3]=m[3],c[4]=m[4],c[5]=m[5],c[6]=m[6],c[7]=m[7],c[8]=m[8],c[9]=m[9],c[10]=m[10],c[11]=m[11],c[12]=m[12],c[13]=m[13],c[14]=m[14],c[15]=m[15],c},s.b5=function(m,c,g){var x=Math.sin(g),C=Math.cos(g),D=c[0],F=c[1],$=c[2],Q=c[3],oe=c[4],he=c[5],ve=c[6],De=c[7];return c!==m&&(m[8]=c[8],m[9]=c[9],m[10]=c[10],m[11]=c[11],m[12]=c[12],m[13]=c[13],m[14]=c[14],m[15]=c[15]),m[0]=D*C+oe*x,m[1]=F*C+he*x,m[2]=$*C+ve*x,m[3]=Q*C+De*x,m[4]=oe*C-D*x,m[5]=he*C-F*x,m[6]=ve*C-$*x,m[7]=De*C-Q*x,m},s.b6=function(m,c,g){var x=Math.sin(g),C=Math.cos(g),D=c[4],F=c[5],$=c[6],Q=c[7],oe=c[8],he=c[9],ve=c[10],De=c[11];return c!==m&&(m[0]=c[0],m[1]=c[1],m[2]=c[2],m[3]=c[3],m[12]=c[12],m[13]=c[13],m[14]=c[14],m[15]=c[15]),m[4]=D*C+oe*x,m[5]=F*C+he*x,m[6]=$*C+ve*x,m[7]=Q*C+De*x,m[8]=oe*C-D*x,m[9]=he*C-F*x,m[10]=ve*C-$*x,m[11]=De*C-Q*x,m},s.b7=function(){const m=new Float32Array(16);return W(m),m},s.b8=function(){const m=new Float64Array(16);return W(m),m},s.b9=function(){return new Float64Array(16)},s.bA=function(m){return m[0]=0,m[1]=0,m[2]=0,m},s.bB=function(m,c,g,x){const C=Math.sqrt(m*m+c*c),D=Math.sqrt(g*g+x*x);m/=C,c/=C,g/=D,x/=D;const F=Math.acos(m*g+c*x);return-c*g+m*x>0?F:-F},s.bC=function(m,c){const g=_e(m,2*Math.PI),x=_e(c,2*Math.PI);return Math.min(Math.abs(g-x),Math.abs(g-x+2*Math.PI),Math.abs(g-x-2*Math.PI))},s.bD=function(){const m={},c=Ct.$version;for(const g in Ct.$root){const x=Ct.$root[g];if(x.required){let C=null;C=g==="version"?c:x.type==="array"?[]:{},C!=null&&(m[g]=C)}}return m},s.bE=Cr,s.bF=pt,s.bG=function m(c,g){if(Array.isArray(c)){if(!Array.isArray(g)||c.length!==g.length)return!1;for(let x=0;x<c.length;x++)if(!m(c[x],g[x]))return!1;return!0}if(typeof c=="object"&&c!==null&&g!==null){if(typeof g!="object"||Object.keys(c).length!==Object.keys(g).length)return!1;for(const x in c)if(!m(c[x],g[x]))return!1;return!0}return c===g},s.bH=function(m){m=m.slice();const c=Object.create(null);for(let g=0;g<m.length;g++)c[m[g].id]=m[g];for(let g=0;g<m.length;g++)"ref"in m[g]&&(m[g]=qt(m[g],c[m[g].ref]));return m},s.bI=function(m){if(m.type==="custom")return new Zne(m);switch(m.type){case"background":return new Gne(m);case"circle":return new Ure(m);case"color-relief":return new Gre(m);case"fill":return new lne(m);case"fill-extrusion":return new mne(m);case"heatmap":return new $re(m);case"hillshade":return new Hre(m);case"line":return new Ene(m);case"raster":return new Yne(m);case"symbol":return new Mx(m)}},s.bJ=Ve,s.bK=function(m,c){if(!m)return[{command:"setStyle",args:[c]}];let g=[];try{if(!Zr(m.version,c.version))return[{command:"setStyle",args:[c]}];Zr(m.center,c.center)||g.push({command:"setCenter",args:[c.center]}),Zr(m.state,c.state)||g.push({command:"setGlobalState",args:[c.state]}),Zr(m.centerAltitude,c.centerAltitude)||g.push({command:"setCenterAltitude",args:[c.centerAltitude]}),Zr(m.zoom,c.zoom)||g.push({command:"setZoom",args:[c.zoom]}),Zr(m.bearing,c.bearing)||g.push({command:"setBearing",args:[c.bearing]}),Zr(m.pitch,c.pitch)||g.push({command:"setPitch",args:[c.pitch]}),Zr(m.roll,c.roll)||g.push({command:"setRoll",args:[c.roll]}),Zr(m.sprite,c.sprite)||g.push({command:"setSprite",args:[c.sprite]}),Zr(m.glyphs,c.glyphs)||g.push({command:"setGlyphs",args:[c.glyphs]}),Zr(m.transition,c.transition)||g.push({command:"setTransition",args:[c.transition]}),Zr(m.light,c.light)||g.push({command:"setLight",args:[c.light]}),Zr(m.terrain,c.terrain)||g.push({command:"setTerrain",args:[c.terrain]}),Zr(m.sky,c.sky)||g.push({command:"setSky",args:[c.sky]}),Zr(m.projection,c.projection)||g.push({command:"setProjection",args:[c.projection]});const x={},C=[];(function(F,$,Q,oe){let he;for(he in $=$||{},F=F||{})Object.prototype.hasOwnProperty.call(F,he)&&(Object.prototype.hasOwnProperty.call($,he)||Ce(he,Q,oe));for(he in $)Object.prototype.hasOwnProperty.call($,he)&&(Object.prototype.hasOwnProperty.call(F,he)?Zr(F[he],$[he])||(F[he].type==="geojson"&&$[he].type==="geojson"&&ft(F,$,he)?jr(Q,{command:"setGeoJSONSourceData",args:[he,$[he].data]}):Ue(he,$,Q,oe)):vn(he,$,Q))})(m.sources,c.sources,C,x);const D=[];m.layers&&m.layers.forEach((F=>{"source"in F&&x[F.source]?g.push({command:"removeLayer",args:[F.id]}):D.push(F)})),g=g.concat(C),(function(F,$,Q){$=$||[];const oe=(F=F||[]).map(xr),he=$.map(xr),ve=F.reduce(Kr,{}),De=$.reduce(Kr,{}),je=oe.slice(),$e=Object.create(null);let Xe,ot,vt,Ht,Ot;for(let ze=0,nt=0;ze<oe.length;ze++)Xe=oe[ze],Object.prototype.hasOwnProperty.call(De,Xe)?nt++:(jr(Q,{command:"removeLayer",args:[Xe]}),je.splice(je.indexOf(Xe,nt),1));for(let ze=0,nt=0;ze<he.length;ze++)Xe=he[he.length-1-ze],je[je.length-1-ze]!==Xe&&(Object.prototype.hasOwnProperty.call(ve,Xe)?(jr(Q,{command:"removeLayer",args:[Xe]}),je.splice(je.lastIndexOf(Xe,je.length-nt),1)):nt++,Ht=je[je.length-ze],jr(Q,{command:"addLayer",args:[De[Xe],Ht]}),je.splice(je.length-ze,0,Xe),$e[Xe]=!0);for(let ze=0;ze<he.length;ze++)if(Xe=he[ze],ot=ve[Xe],vt=De[Xe],!$e[Xe]&&!Zr(ot,vt))if(Zr(ot.source,vt.source)&&Zr(ot["source-layer"],vt["source-layer"])&&Zr(ot.type,vt.type)){for(Ot in Mt(ot.layout,vt.layout,Q,Xe,null,"setLayoutProperty"),Mt(ot.paint,vt.paint,Q,Xe,null,"setPaintProperty"),Zr(ot.filter,vt.filter)||jr(Q,{command:"setFilter",args:[Xe,vt.filter]}),Zr(ot.minzoom,vt.minzoom)&&Zr(ot.maxzoom,vt.maxzoom)||jr(Q,{command:"setLayerZoomRange",args:[Xe,vt.minzoom,vt.maxzoom]}),ot)Object.prototype.hasOwnProperty.call(ot,Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&(Ot.indexOf("paint.")===0?Mt(ot[Ot],vt[Ot],Q,Xe,Ot.slice(6),"setPaintProperty"):Zr(ot[Ot],vt[Ot])||jr(Q,{command:"setLayerProperty",args:[Xe,Ot,vt[Ot]]}));for(Ot in vt)Object.prototype.hasOwnProperty.call(vt,Ot)&&!Object.prototype.hasOwnProperty.call(ot,Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&(Ot.indexOf("paint.")===0?Mt(ot[Ot],vt[Ot],Q,Xe,Ot.slice(6),"setPaintProperty"):Zr(ot[Ot],vt[Ot])||jr(Q,{command:"setLayerProperty",args:[Xe,Ot,vt[Ot]]}))}else jr(Q,{command:"removeLayer",args:[Xe]}),Ht=je[je.lastIndexOf(Xe)+1],jr(Q,{command:"addLayer",args:[vt,Ht]})})(D,c.layers,g)}catch(x){console.warn("Unable to compute style diff:",x),g=[{command:"setStyle",args:[c]}]}return g},s.bL=function(m){const c=[],g=m.id;return g===void 0&&c.push({message:`layers.${g}: missing required property "id"`}),m.render===void 0&&c.push({message:`layers.${g}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&c.push({message:`layers.${g}: property "renderingMode" must be either "2d" or "3d"`}),c},s.bM=Lt,s.bN=at,s.bO=class extends go{constructor(m,c){super(m,c),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},s.bP=bx,s.bQ=class extends go{constructor(m,c){super(m,c),this.current=cC}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(let c=1;c<16;c++)if(m[c]!==this.current[c]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},s.bR=zs,s.bS=class extends go{constructor(m,c){super(m,c),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},s.bT=class extends go{constructor(m,c){super(m,c),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},s.bU=q,s.bV=function(m,c){var g=Math.sin(c),x=Math.cos(c);return m[0]=x,m[1]=g,m[2]=0,m[3]=-g,m[4]=x,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},s.bW=function(m,c,g){var x=c[0],C=c[1],D=c[2];return m[0]=x*g[0]+C*g[3]+D*g[6],m[1]=x*g[1]+C*g[4]+D*g[7],m[2]=x*g[2]+C*g[5]+D*g[8],m},s.bX=function(m,c,g,x,C,D,F){var $=1/(c-g),Q=1/(x-C),oe=1/(D-F);return m[0]=-2*$,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*Q,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*oe,m[11]=0,m[12]=(c+g)*$,m[13]=(C+x)*Q,m[14]=(F+D)*oe,m[15]=1,m},s.bY=class extends go{constructor(m,c){super(m,c),this.current=new Array}set(m){if(m!=this.current){this.current=m;const c=new Float32Array(4*m.length);for(let g=0;g<m.length;g++)c[4*g]=m[g].r,c[4*g+1]=m[g].g,c[4*g+2]=m[g].b,c[4*g+3]=m[g].a;this.gl.uniform4fv(this.location,c)}}},s.bZ=class extends go{constructor(m,c){super(m,c),this.current=new Array}set(m){if(m!=this.current){this.current=m;const c=new Float32Array(m);this.gl.uniform1fv(this.location,c)}}},s.b_=class extends w{},s.ba=function(m,c,g){const x=new Float64Array(4);return Ee(x,m,c-90,g),x},s.bb=function(m,c,g,x){var C,D,F,$,Q,oe=c[0],he=c[1],ve=c[2],De=c[3],je=g[0],$e=g[1],Xe=g[2],ot=g[3];return(D=oe*je+he*$e+ve*Xe+De*ot)<0&&(D=-D,je=-je,$e=-$e,Xe=-Xe,ot=-ot),1-D>z?(C=Math.acos(D),F=Math.sin(C),$=Math.sin((1-x)*C)/F,Q=Math.sin(x*C)/F):($=1-x,Q=x),m[0]=$*oe+Q*je,m[1]=$*he+Q*$e,m[2]=$*ve+Q*Xe,m[3]=$*De+Q*ot,m},s.bc=function(m){const c=new Float64Array(9);var g,x,C,D,F,$,Q,oe,he,ve,De,je,$e,Xe,ot,vt,Ht,Ot;ve=(C=(x=m)[0])*(Q=C+C),De=(D=x[1])*Q,$e=(F=x[2])*Q,Xe=F*(oe=D+D),vt=($=x[3])*Q,Ht=$*oe,Ot=$*(he=F+F),(g=c)[0]=1-(je=D*oe)-(ot=F*he),g[3]=De-Ot,g[6]=$e+Ht,g[1]=De+Ot,g[4]=1-ve-ot,g[7]=Xe-vt,g[2]=$e-Ht,g[5]=Xe+vt,g[8]=1-ve-je;const ze=or(-Math.asin(tt(c[2],-1,1)));let nt,Ft;return Math.hypot(c[5],c[8])<.001?(nt=0,Ft=-or(Math.atan2(c[3],c[4]))):(nt=or(c[5]===0&&c[8]===0?0:Math.atan2(c[5],c[8])),Ft=or(c[1]===0&&c[0]===0?0:Math.atan2(c[1],c[0]))),{roll:nt,pitch:ze+90,bearing:Ft}},s.bd=function(m,c){return m.roll==c.roll&&m.pitch==c.pitch&&m.bearing==c.bearing},s.be=En,s.bf=cu,s.bg=hy,s.bh=n_,s.bi=cy,s.bj=Me,s.bk=Re,s.bl=ii,s.bm=function(m,c,g,x,C){return Me(x,C,tt((m-c)/(g-c),0,1))},s.bn=_e,s.bo=function(){return new Float64Array(3)},s.bp=function(m,c,g,x){return m[0]=c[0]+g[0]*x,m[1]=c[1]+g[1]*x,m[2]=c[2]+g[2]*x,m},s.bq=Ee,s.br=function(m,c,g){var x=g[0],C=g[1],D=g[2],F=c[0],$=c[1],Q=c[2],oe=C*Q-D*$,he=D*F-x*Q,ve=x*$-C*F,De=C*ve-D*he,je=D*oe-x*ve,$e=x*he-C*oe,Xe=2*g[3];return he*=Xe,ve*=Xe,je*=2,$e*=2,m[0]=F+(oe*=Xe)+(De*=2),m[1]=$+he+je,m[2]=Q+ve+$e,m},s.bs=function(m,c,g){const x=(C=[m[0],m[1],m[2],c[0],c[1],c[2],g[0],g[1],g[2]])[0]*((he=C[8])*(F=C[4])-($=C[5])*(oe=C[7]))+C[1]*(-he*(D=C[3])+$*(Q=C[6]))+C[2]*(oe*D-F*Q);var C,D,F,$,Q,oe,he;if(x===0)return null;const ve=ae([],[c[0],c[1],c[2]],[g[0],g[1],g[2]]),De=ae([],[g[0],g[1],g[2]],[m[0],m[1],m[2]]),je=ae([],[m[0],m[1],m[2]],[c[0],c[1],c[2]]),$e=ne([],ve,-m[3]);return H($e,$e,ne([],De,-c[3])),H($e,$e,ne([],je,-g[3])),ne($e,$e,1/x),$e},s.bt=jC,s.bu=function(){return new Float64Array(4)},s.bv=function(m,c,g,x){var C=[],D=[];return C[0]=c[0]-g[0],C[1]=c[1]-g[1],C[2]=c[2]-g[2],D[0]=C[0]*Math.cos(x)-C[1]*Math.sin(x),D[1]=C[0]*Math.sin(x)+C[1]*Math.cos(x),D[2]=C[2],m[0]=D[0]+g[0],m[1]=D[1]+g[1],m[2]=D[2]+g[2],m},s.bw=function(m,c,g,x){var C=[],D=[];return C[0]=c[0]-g[0],C[1]=c[1]-g[1],C[2]=c[2]-g[2],D[0]=C[0],D[1]=C[1]*Math.cos(x)-C[2]*Math.sin(x),D[2]=C[1]*Math.sin(x)+C[2]*Math.cos(x),m[0]=D[0]+g[0],m[1]=D[1]+g[1],m[2]=D[2]+g[2],m},s.bx=function(m,c,g,x){var C=[],D=[];return C[0]=c[0]-g[0],C[1]=c[1]-g[1],C[2]=c[2]-g[2],D[0]=C[2]*Math.sin(x)+C[0]*Math.cos(x),D[1]=C[1],D[2]=C[2]*Math.cos(x)-C[0]*Math.sin(x),m[0]=D[0]+g[0],m[1]=D[1]+g[1],m[2]=D[2]+g[2],m},s.by=function(m,c,g){var x=Math.sin(g),C=Math.cos(g),D=c[0],F=c[1],$=c[2],Q=c[3],oe=c[8],he=c[9],ve=c[10],De=c[11];return c!==m&&(m[4]=c[4],m[5]=c[5],m[6]=c[6],m[7]=c[7],m[12]=c[12],m[13]=c[13],m[14]=c[14],m[15]=c[15]),m[0]=D*C-oe*x,m[1]=F*C-he*x,m[2]=$*C-ve*x,m[3]=Q*C-De*x,m[8]=D*x+oe*C,m[9]=F*x+he*C,m[10]=$*x+ve*C,m[11]=Q*x+De*C,m},s.bz=function(m,c){const g=_e(m,360),x=_e(c,360),C=x-g,D=x>g?C-360:C+360;return Math.abs(C)<Math.abs(D)?C:D},s.c=Tt,s.c0=class extends O{},s.c1=mC,s.c2=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},s.c3=AD,s.c4=function(m,c,g){var x=c[0],C=c[1],D=c[2],F=g[3]*x+g[7]*C+g[11]*D+g[15];return m[0]=(g[0]*x+g[4]*C+g[8]*D+g[12])/(F=F||1),m[1]=(g[1]*x+g[5]*C+g[9]*D+g[13])/F,m[2]=(g[2]*x+g[6]*C+g[10]*D+g[14])/F,m},s.c5=class extends Cl{},s.c6=class extends be{},s.c7=function(m,c){return m[0]===c[0]&&m[1]===c[1]&&m[2]===c[2]&&m[3]===c[3]&&m[4]===c[4]&&m[5]===c[5]&&m[6]===c[6]&&m[7]===c[7]&&m[8]===c[8]&&m[9]===c[9]&&m[10]===c[10]&&m[11]===c[11]&&m[12]===c[12]&&m[13]===c[13]&&m[14]===c[14]&&m[15]===c[15]},s.c8=function(m,c){var g=m[0],x=m[1],C=m[2],D=m[3],F=m[4],$=m[5],Q=m[6],oe=m[7],he=m[8],ve=m[9],De=m[10],je=m[11],$e=m[12],Xe=m[13],ot=m[14],vt=m[15],Ht=c[0],Ot=c[1],ze=c[2],nt=c[3],Ft=c[4],Sr=c[5],Jr=c[6],Or=c[7],Fr=c[8],ln=c[9],Qr=c[10],cn=c[11],zr=c[12],zn=c[13],ni=c[14],ei=c[15];return Math.abs(g-Ht)<=z*Math.max(1,Math.abs(g),Math.abs(Ht))&&Math.abs(x-Ot)<=z*Math.max(1,Math.abs(x),Math.abs(Ot))&&Math.abs(C-ze)<=z*Math.max(1,Math.abs(C),Math.abs(ze))&&Math.abs(D-nt)<=z*Math.max(1,Math.abs(D),Math.abs(nt))&&Math.abs(F-Ft)<=z*Math.max(1,Math.abs(F),Math.abs(Ft))&&Math.abs($-Sr)<=z*Math.max(1,Math.abs($),Math.abs(Sr))&&Math.abs(Q-Jr)<=z*Math.max(1,Math.abs(Q),Math.abs(Jr))&&Math.abs(oe-Or)<=z*Math.max(1,Math.abs(oe),Math.abs(Or))&&Math.abs(he-Fr)<=z*Math.max(1,Math.abs(he),Math.abs(Fr))&&Math.abs(ve-ln)<=z*Math.max(1,Math.abs(ve),Math.abs(ln))&&Math.abs(De-Qr)<=z*Math.max(1,Math.abs(De),Math.abs(Qr))&&Math.abs(je-cn)<=z*Math.max(1,Math.abs(je),Math.abs(cn))&&Math.abs($e-zr)<=z*Math.max(1,Math.abs($e),Math.abs(zr))&&Math.abs(Xe-zn)<=z*Math.max(1,Math.abs(Xe),Math.abs(zn))&&Math.abs(ot-ni)<=z*Math.max(1,Math.abs(ot),Math.abs(ni))&&Math.abs(vt-ei)<=z*Math.max(1,Math.abs(vt),Math.abs(ei))},s.c9=function(m,c){return m[0]=c[0],m[1]=c[1],m[2]=c[2],m[3]=c[3],m[4]=c[4],m[5]=c[5],m[6]=c[6],m[7]=c[7],m[8]=c[8],m[9]=c[9],m[10]=c[10],m[11]=c[11],m[12]=c[12],m[13]=c[13],m[14]=c[14],m[15]=c[15],m},s.cA=function(m){delete Oe.REGISTERED_PROTOCOLS[m]},s.cB=function(m,c){const g={};for(let C=0;C<m.length;C++){const D=c&&c[m[C].id]||Wl(m[C]);c&&(c[m[C].id]=D);let F=g[D];F||(F=g[D]=[]),F.push(m[C])}const x=[];for(const C in g)x.push(g[C]);return x},s.cC=xt,s.cD=P6,s.cE=M6,s.cF=s6,s.cG=function(m){m.bucket.createArrays(),m.bucket.tilePixelRatio=ce/(512*m.bucket.overscaling),m.bucket.compareText={},m.bucket.iconsNeedLinear=!1;const c=m.bucket.layers[0],g=c.layout,x=c._unevaluatedLayout._values,C={layoutIconSize:x["icon-size"].possiblyEvaluate(new qn(m.bucket.zoom+1),m.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new qn(m.bucket.zoom+1),m.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new qn(18))};if(m.bucket.textSizeData.kind==="composite"){const{minZoom:oe,maxZoom:he}=m.bucket.textSizeData;C.compositeTextSizes=[x["text-size"].possiblyEvaluate(new qn(oe),m.canonical),x["text-size"].possiblyEvaluate(new qn(he),m.canonical)]}if(m.bucket.iconSizeData.kind==="composite"){const{minZoom:oe,maxZoom:he}=m.bucket.iconSizeData;C.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new qn(oe),m.canonical),x["icon-size"].possiblyEvaluate(new qn(he),m.canonical)]}const D=g.get("text-line-height")*ll,F=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point",$=g.get("text-keep-upright"),Q=g.get("text-size");for(const oe of m.bucket.features){const he=g.get("text-font").evaluate(oe,{},m.canonical).join(","),ve=Q.evaluate(oe,{},m.canonical),De=C.layoutTextSize.evaluate(oe,{},m.canonical),je=C.layoutIconSize.evaluate(oe,{},m.canonical),$e={horizontal:{},vertical:void 0},Xe=oe.text;let ot,vt=[0,0];if(Xe){const ze=Xe.toString(),nt=g.get("text-letter-spacing").evaluate(oe,{},m.canonical)*ll,Ft=fn(ze)?nt:0,Sr=g.get("text-anchor").evaluate(oe,{},m.canonical),Jr=V6(c,oe,m.canonical);if(!Jr){const Qr=g.get("text-radial-offset").evaluate(oe,{},m.canonical);vt=Qr?U6(Sr,[Qr*ll,$C]):g.get("text-offset").evaluate(oe,{},m.canonical).map((cn=>cn*ll))}let Or=F?"center":g.get("text-justify").evaluate(oe,{},m.canonical);const Fr=g.get("symbol-placement")==="point"?g.get("text-max-width").evaluate(oe,{},m.canonical)*ll:1/0,ln=()=>{m.bucket.allowVerticalPlacement&&qr(ze)&&($e.vertical=Ix(Xe,m.glyphMap,m.glyphPositions,m.imagePositions,he,Fr,D,Sr,"left",Ft,vt,s.an.vertical,!0,De,ve))};if(!F&&Jr){const Qr=new Set;if(Or==="auto")for(let zr=0;zr<Jr.values.length;zr+=2)Qr.add(qC(Jr.values[zr]));else Qr.add(Or);let cn=!1;for(const zr of Qr)if(!$e.horizontal[zr])if(cn)$e.horizontal[zr]=$e.horizontal[0];else{const zn=Ix(Xe,m.glyphMap,m.glyphPositions,m.imagePositions,he,Fr,D,"center",zr,Ft,vt,s.an.horizontal,!1,De,ve);zn&&($e.horizontal[zr]=zn,cn=zn.positionedLines.length===1)}ln()}else{Or==="auto"&&(Or=qC(Sr));const Qr=Ix(Xe,m.glyphMap,m.glyphPositions,m.imagePositions,he,Fr,D,Sr,Or,Ft,vt,s.an.horizontal,!1,De,ve);Qr&&($e.horizontal[Or]=Qr),ln(),qr(ze)&&F&&$&&($e.vertical=Ix(Xe,m.glyphMap,m.glyphPositions,m.imagePositions,he,Fr,D,Sr,Or,Ft,vt,s.an.vertical,!1,De,ve))}}let Ht=!1;if(oe.icon&&oe.icon.name){const ze=m.imageMap[oe.icon.name];ze&&(ot=Vne(m.imagePositions[oe.icon.name],g.get("icon-offset").evaluate(oe,{},m.canonical),g.get("icon-anchor").evaluate(oe,{},m.canonical)),Ht=!!ze.sdf,m.bucket.sdfIcons===void 0?m.bucket.sdfIcons=Ht:m.bucket.sdfIcons!==Ht&&Yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ze.pixelRatio!==m.bucket.pixelRatio||g.get("icon-rotate").constantOr(1)!==0)&&(m.bucket.iconsNeedLinear=!0))}const Ot=q6($e.horizontal)||$e.vertical;m.bucket.iconsInText=!!Ot&&Ot.iconsInText,(Ot||ot)&&aie(m.bucket,oe,$e,ot,m.imageMap,C,De,je,vt,Ht,m.canonical,m.subdivisionGranularity)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},s.cH=IC,s.cI=wC,s.cJ=AC,s.cK=a_,s.cL=MC,s.cM=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return m.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},s.cN=function(m,c,g,x,C){return o(this,void 0,void 0,(function*(){if(M())try{return yield Mr(m,c,g,x,C)}catch{}return(function(D,F,$,Q,oe){const he=D.width,ve=D.height;Pr&&ar||(Pr=new OffscreenCanvas(he,ve),ar=Pr.getContext("2d",{willReadFrequently:!0})),Pr.width=he,Pr.height=ve,ar.drawImage(D,0,0,he,ve);const De=ar.getImageData(F,$,Q,oe);return ar.clearRect(0,0,he,ve),De.data})(m,c,g,x,C)}))},s.cO=kD,s.cP=u,s.cQ=d,s.cR=GD,s.cS=a6,s.cT=lp,s.cU=Pa,s.ca=m=>m.type==="symbol",s.cb=m=>m.type==="circle",s.cc=m=>m.type==="heatmap",s.cd=m=>m.type==="line",s.ce=m=>m.type==="fill",s.cf=m=>m.type==="fill-extrusion",s.cg=m=>m.type==="hillshade",s.ch=m=>m.type==="color-relief",s.ci=m=>m.type==="raster",s.cj=m=>m.type==="background",s.ck=m=>m.type==="custom",s.cl=He,s.cm=function(m,c,g){const x=Ae(c.x-g.x,c.y-g.y),C=Ae(m.x-g.x,m.y-g.y);var D,F;return or(Math.atan2(x[0]*C[1]-x[1]*C[0],(D=x)[0]*(F=C)[0]+D[1]*F[1]))},s.cn=Fe,s.co=function(m,c){return er[c]&&(m instanceof MouseEvent||m instanceof WheelEvent)},s.cp=function(m,c){return Dr[c]&&"touches"in m},s.cq=function(m){return Dr[m]||er[m]},s.cr=function(m,c,g){var x=c[0],C=c[1];return m[0]=g[0]*x+g[4]*C+g[12],m[1]=g[1]*x+g[5]*C+g[13],m},s.cs=function(m,c){const{x:g,y:x}=c_.fromLngLat(c);return!(m<0||m>25||x<0||x>=1||g<0||g>=1)},s.ct=function(m,c){return m[0]=c[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=c[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=c[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},s.cu=class extends Vo{},s.cv=sie,s.cx=function(m){return m.message===Gt},s.cy=rt,s.cz=function(m,c){Oe.REGISTERED_PROTOCOLS[m]=c},s.d=Bt,s.e=Qe,s.f=m=>o(void 0,void 0,void 0,(function*(){if(m.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(c)}catch(g){throw new Error(`Could not load image because of ${g.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),s.g=Be,s.h=m=>new Promise(((c,g)=>{const x=new Image;x.onload=()=>{c(x),URL.revokeObjectURL(x.src),x.onload=null,window.requestAnimationFrame((()=>{x.src=mr}))},x.onerror=()=>g(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const C=new Blob([new Uint8Array(m)],{type:"image/png"});x.src=m.byteLength?URL.createObjectURL(C):mr})),s.i=mt,s.j=(m,c)=>Rt(Qe(m,{type:"json"}),c),s.k=St,s.l=jt,s.m=Rt,s.n=(m,c)=>Rt(Qe(m,{type:"arrayBuffer"}),c),s.o=function(m){return new MC(m).readFields(Mne,[])},s.p=o6,s.q=J0,s.r=to,s.s=fr,s.t=hs,s.u=wr,s.v=Ct,s.w=Yt,s.x=Te,s.y=it,s.z=fe})),i("worker",["./shared"],(function(s){class o{constructor(Oe){this.keyCache={},Oe&&this.replace(Oe)}replace(Oe){this._layerConfigs={},this._layers={},this.update(Oe,[])}update(Oe,Be){for(const rt of Oe){this._layerConfigs[rt.id]=rt;const pt=this._layers[rt.id]=s.bI(rt);pt._featureFilter=s.a9(pt.filter),this.keyCache[rt.id]&&delete this.keyCache[rt.id]}for(const rt of Be)delete this.keyCache[rt],delete this._layerConfigs[rt],delete this._layers[rt];this.familiesBySource={};const Ne=s.cB(Object.values(this._layerConfigs),this.keyCache);for(const rt of Ne){const pt=rt.map((St=>this._layers[St.id])),Rt=pt[0];if(Rt.visibility==="none")continue;const Bt=Rt.source||"";let At=this.familiesBySource[Bt];At||(At=this.familiesBySource[Bt]={});const Zt=Rt.sourceLayer||"_geojsonTileLayer";let jt=At[Zt];jt||(jt=At[Zt]=[]),jt.push(pt)}}}class u{constructor(Oe){const Be={},Ne=[];for(const Bt in Oe){const At=Oe[Bt],Zt=Be[Bt]={};for(const jt in At){const St=At[+jt];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const Xt={x:0,y:0,w:St.bitmap.width+2,h:St.bitmap.height+2};Ne.push(Xt),Zt[jt]={rect:Xt,metrics:St.metrics}}}const{w:rt,h:pt}=s.p(Ne),Rt=new s.q({width:rt||1,height:pt||1});for(const Bt in Oe){const At=Oe[Bt];for(const Zt in At){const jt=At[+Zt];if(!jt||jt.bitmap.width===0||jt.bitmap.height===0)continue;const St=Be[Bt][Zt].rect;s.q.copy(jt.bitmap,Rt,{x:0,y:0},{x:St.x+1,y:St.y+1},jt.bitmap)}}this.image=Rt,this.positions=Be}}s.cC("GlyphAtlas",u);class h{constructor(Oe){this.tileID=new s.Z(Oe.tileID.overscaledZ,Oe.tileID.wrap,Oe.tileID.canonical.z,Oe.tileID.canonical.x,Oe.tileID.canonical.y),this.uid=Oe.uid,this.zoom=Oe.zoom,this.pixelRatio=Oe.pixelRatio,this.tileSize=Oe.tileSize,this.source=Oe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Oe.showCollisionBoxes,this.collectResourceTiming=!!Oe.collectResourceTiming,this.returnDependencies=!!Oe.returnDependencies,this.promoteId=Oe.promoteId,this.inFlightDependencies=[],this.globalState=Oe.globalState}parse(Oe,Be,Ne,rt,pt){return s._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Oe,this.collisionBoxArray=new s.a7;const Rt=new s.cD(Object.keys(Oe.layers).sort()),Bt=new s.cE(this.tileID,this.promoteId);Bt.bucketLayerIDs=[];const At={},Zt={featureIndex:Bt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ne,subdivisionGranularity:pt},jt=Be.familiesBySource[this.source];for(const Mt in jt){const xr=Oe.layers[Mt];if(!xr)continue;xr.version===1&&s.w(`Vector tile source "${this.source}" layer "${Mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kr=Rt.encode(Mt),Rr=[];for(let di=0;di<xr.length;di++){const ti=xr.feature(di),bi=Bt.getId(ti,Mt);Rr.push({feature:ti,id:bi,index:di,sourceLayerIndex:Kr})}for(const di of jt[Mt]){const ti=di[0];ti.source!==this.source&&s.w(`layer.source = ${ti.source} does not equal this.source = ${this.source}`),ti.minzoom&&this.zoom<Math.floor(ti.minzoom)||ti.maxzoom&&this.zoom>=ti.maxzoom||ti.visibility!=="none"&&(f(di,this.zoom,Ne),(At[ti.id]=ti.createBucket({index:Bt.bucketLayerIDs.length,layers:di,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kr,sourceID:this.source,globalState:this.globalState})).populate(Rr,Zt,this.tileID.canonical),Bt.bucketLayerIDs.push(di.map((bi=>bi.id))))}}const St=s.bM(Zt.glyphDependencies,(Mt=>Object.keys(Mt).map(Number)));this.inFlightDependencies.forEach((Mt=>Mt?.abort())),this.inFlightDependencies=[];let Xt=Promise.resolve({});if(Object.keys(St).length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Xt=rt.sendAsync({type:"GG",data:{stacks:St,source:this.source,tileID:this.tileID,type:"glyphs"}},Mt)}const Ct=Object.keys(Zt.iconDependencies);let Lr=Promise.resolve({});if(Ct.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Lr=rt.sendAsync({type:"GI",data:{icons:Ct,source:this.source,tileID:this.tileID,type:"icons"}},Mt)}const qt=Object.keys(Zt.patternDependencies);let Zr=Promise.resolve({});if(qt.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Zr=rt.sendAsync({type:"GI",data:{icons:qt,source:this.source,tileID:this.tileID,type:"patterns"}},Mt)}const[jr,vn,Ce]=yield Promise.all([Xt,Lr,Zr]),Ue=new u(jr),ft=new s.cF(vn,Ce);for(const Mt in At){const xr=At[Mt];xr instanceof s.a8?(f(xr.layers,this.zoom,Ne),s.cG({bucket:xr,glyphMap:jr,glyphPositions:Ue.positions,imageMap:vn,imagePositions:ft.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Zt.subdivisionGranularity})):xr.hasPattern&&(xr instanceof s.cH||xr instanceof s.cI||xr instanceof s.cJ)&&(f(xr.layers,this.zoom,Ne),xr.addFeatures(Zt,this.tileID.canonical,ft.patternPositions))}return this.status="done",{buckets:Object.values(At).filter((Mt=>!Mt.isEmpty())),featureIndex:Bt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ue.image,imageAtlas:ft,glyphMap:this.returnDependencies?jr:null,iconMap:this.returnDependencies?vn:null,glyphPositions:this.returnDependencies?Ue.positions:null}}))}}function f(Tt,Oe,Be){const Ne=new s.F(Oe);for(const rt of Tt)rt.recalculate(Ne,Be)}class d{constructor(Oe,Be,Ne){this.actor=Oe,this.layerIndex=Be,this.availableImages=Ne,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Oe,Be){return s._(this,void 0,void 0,(function*(){const Ne=yield s.n(Oe.request,Be);try{return{vectorTile:new s.cK.VectorTile(new s.cL(Ne.data)),rawData:Ne.data,cacheControl:Ne.cacheControl,expires:Ne.expires}}catch(rt){const pt=new Uint8Array(Ne.data);let Rt=`Unable to parse the tile at ${Oe.request.url}, `;throw Rt+=pt[0]===31&&pt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${rt.message}`,new Error(Rt)}}))}loadTile(Oe){return s._(this,void 0,void 0,(function*(){const Be=Oe.uid,Ne=!!(Oe&&Oe.request&&Oe.request.collectResourceTiming)&&new s.cM(Oe.request),rt=new h(Oe);this.loading[Be]=rt;const pt=new AbortController;rt.abort=pt;try{const Rt=yield this.loadVectorTile(Oe,pt);if(delete this.loading[Be],!Rt)return null;const Bt=Rt.rawData,At={};Rt.expires&&(At.expires=Rt.expires),Rt.cacheControl&&(At.cacheControl=Rt.cacheControl);const Zt={};if(Ne){const St=Ne.finish();St&&(Zt.resourceTiming=JSON.parse(JSON.stringify(St)))}rt.vectorTile=Rt.vectorTile;const jt=rt.parse(Rt.vectorTile,this.layerIndex,this.availableImages,this.actor,Oe.subdivisionGranularity);this.loaded[Be]=rt,this.fetching[Be]={rawTileData:Bt,cacheControl:At,resourceTiming:Zt};try{const St=yield jt;return s.e({rawTileData:Bt.slice(0)},St,At,Zt)}finally{delete this.fetching[Be]}}catch(Rt){throw delete this.loading[Be],rt.status="done",this.loaded[Be]=rt,Rt}}))}reloadTile(Oe){return s._(this,void 0,void 0,(function*(){const Be=Oe.uid;if(!this.loaded||!this.loaded[Be])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Ne=this.loaded[Be];if(Ne.showCollisionBoxes=Oe.showCollisionBoxes,Ne.globalState=Oe.globalState,Ne.status==="parsing"){const rt=yield Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,Oe.subdivisionGranularity);let pt;if(this.fetching[Be]){const{rawTileData:Rt,cacheControl:Bt,resourceTiming:At}=this.fetching[Be];delete this.fetching[Be],pt=s.e({rawTileData:Rt.slice(0)},rt,Bt,At)}else pt=rt;return pt}if(Ne.status==="done"&&Ne.vectorTile)return Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,Oe.subdivisionGranularity)}))}abortTile(Oe){return s._(this,void 0,void 0,(function*(){const Be=this.loading,Ne=Oe.uid;Be&&Be[Ne]&&Be[Ne].abort&&(Be[Ne].abort.abort(),delete Be[Ne])}))}removeTile(Oe){return s._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Oe.uid]&&delete this.loaded[Oe.uid]}))}}class b{constructor(){this.loaded={}}loadTile(Oe){return s._(this,void 0,void 0,(function*(){const{uid:Be,encoding:Ne,rawImageData:rt,redFactor:pt,greenFactor:Rt,blueFactor:Bt,baseShift:At}=Oe,Zt=rt.width+2,jt=rt.height+2,St=s.b(rt)?new s.R({width:Zt,height:jt},yield s.cN(rt,-1,-1,Zt,jt)):rt,Xt=new s.cO(Be,St,Ne,pt,Rt,Bt,At);return this.loaded=this.loaded||{},this.loaded[Be]=Xt,Xt}))}removeTile(Oe){const Be=this.loaded,Ne=Oe.uid;Be&&Be[Ne]&&delete Be[Ne]}}var v,S,E=(function(){if(S)return v;function Tt(Be,Ne){if(Be.length!==0){Oe(Be[0],Ne);for(var rt=1;rt<Be.length;rt++)Oe(Be[rt],!Ne)}}function Oe(Be,Ne){for(var rt=0,pt=0,Rt=0,Bt=Be.length,At=Bt-1;Rt<Bt;At=Rt++){var Zt=(Be[Rt][0]-Be[At][0])*(Be[At][1]+Be[Rt][1]),jt=rt+Zt;pt+=Math.abs(rt)>=Math.abs(Zt)?rt-jt+Zt:Zt-jt+rt,rt=jt}rt+pt>=0!=!!Ne&&Be.reverse()}return S=1,v=function Be(Ne,rt){var pt,Rt=Ne&&Ne.type;if(Rt==="FeatureCollection")for(pt=0;pt<Ne.features.length;pt++)Be(Ne.features[pt],rt);else if(Rt==="GeometryCollection")for(pt=0;pt<Ne.geometries.length;pt++)Be(Ne.geometries[pt],rt);else if(Rt==="Feature")Be(Ne.geometry,rt);else if(Rt==="Polygon")Tt(Ne.coordinates,rt);else if(Rt==="MultiPolygon")for(pt=0;pt<Ne.coordinates.length;pt++)Tt(Ne.coordinates[pt],rt);return Ne}})(),P=s.cP(E);const k=s.cK.VectorTileFeature.prototype.toGeoJSON;class L{constructor(Oe){this._feature=Oe,this.extent=s.$,this.type=Oe.type,this.properties=Oe.tags,"id"in Oe&&!isNaN(Oe.id)&&(this.id=parseInt(Oe.id,10))}loadGeometry(){if(this._feature.type===1){const Oe=[];for(const Be of this._feature.geometry)Oe.push([new s.P(Be[0],Be[1])]);return Oe}{const Oe=[];for(const Be of this._feature.geometry){const Ne=[];for(const rt of Be)Ne.push(new s.P(rt[0],rt[1]));Oe.push(Ne)}return Oe}}toGeoJSON(Oe,Be,Ne){return k.call(this,Oe,Be,Ne)}}class N{constructor(Oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.$,this.length=Oe.length,this._features=Oe}feature(Oe){return new L(this._features[Oe])}}var M,z,B,q={exports:{}},W=(function(){if(B)return q.exports;B=1;var Tt=s.cS(),Oe=(function(){if(z)return M;z=1;var jt=s.cQ(),St=s.cR().VectorTileFeature;function Xt(Lr,qt){this.options=qt||{},this.features=Lr,this.length=Lr.length}function Ct(Lr,qt){this.id=typeof Lr.id=="number"?Lr.id:void 0,this.type=Lr.type,this.rawGeometry=Lr.type===1?[Lr.geometry]:Lr.geometry,this.properties=Lr.tags,this.extent=qt||4096}return M=Xt,Xt.prototype.feature=function(Lr){return new Ct(this.features[Lr],this.options.extent)},Ct.prototype.loadGeometry=function(){var Lr=this.rawGeometry;this.geometry=[];for(var qt=0;qt<Lr.length;qt++){for(var Zr=Lr[qt],jr=[],vn=0;vn<Zr.length;vn++)jr.push(new jt(Zr[vn][0],Zr[vn][1]));this.geometry.push(jr)}return this.geometry},Ct.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Lr=this.geometry,qt=1/0,Zr=-1/0,jr=1/0,vn=-1/0,Ce=0;Ce<Lr.length;Ce++)for(var Ue=Lr[Ce],ft=0;ft<Ue.length;ft++){var Mt=Ue[ft];qt=Math.min(qt,Mt.x),Zr=Math.max(Zr,Mt.x),jr=Math.min(jr,Mt.y),vn=Math.max(vn,Mt.y)}return[qt,jr,Zr,vn]},Ct.prototype.toGeoJSON=St.prototype.toGeoJSON,M})();function Be(jt){var St=new Tt;return(function(Xt,Ct){for(var Lr in Xt.layers)Ct.writeMessage(3,Ne,Xt.layers[Lr])})(jt,St),St.finish()}function Ne(jt,St){var Xt;St.writeVarintField(15,jt.version||1),St.writeStringField(1,jt.name||""),St.writeVarintField(5,jt.extent||4096);var Ct={keys:[],values:[],keycache:{},valuecache:{}};for(Xt=0;Xt<jt.length;Xt++)Ct.feature=jt.feature(Xt),St.writeMessage(2,rt,Ct);var Lr=Ct.keys;for(Xt=0;Xt<Lr.length;Xt++)St.writeStringField(3,Lr[Xt]);var qt=Ct.values;for(Xt=0;Xt<qt.length;Xt++)St.writeMessage(4,Zt,qt[Xt])}function rt(jt,St){var Xt=jt.feature;Xt.id!==void 0&&St.writeVarintField(1,Xt.id),St.writeMessage(2,pt,jt),St.writeVarintField(3,Xt.type),St.writeMessage(4,At,Xt)}function pt(jt,St){var Xt=jt.feature,Ct=jt.keys,Lr=jt.values,qt=jt.keycache,Zr=jt.valuecache;for(var jr in Xt.properties){var vn=Xt.properties[jr],Ce=qt[jr];if(vn!==null){Ce===void 0&&(Ct.push(jr),qt[jr]=Ce=Ct.length-1),St.writeVarint(Ce);var Ue=typeof vn;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(vn=JSON.stringify(vn));var ft=Ue+":"+vn,Mt=Zr[ft];Mt===void 0&&(Lr.push(vn),Zr[ft]=Mt=Lr.length-1),St.writeVarint(Mt)}}}function Rt(jt,St){return(St<<3)+(7&jt)}function Bt(jt){return jt<<1^jt>>31}function At(jt,St){for(var Xt=jt.loadGeometry(),Ct=jt.type,Lr=0,qt=0,Zr=Xt.length,jr=0;jr<Zr;jr++){var vn=Xt[jr],Ce=1;Ct===1&&(Ce=vn.length),St.writeVarint(Rt(1,Ce));for(var Ue=Ct===3?vn.length-1:vn.length,ft=0;ft<Ue;ft++){ft===1&&Ct!==1&&St.writeVarint(Rt(2,Ue-1));var Mt=vn[ft].x-Lr,xr=vn[ft].y-qt;St.writeVarint(Bt(Mt)),St.writeVarint(Bt(xr)),Lr+=Mt,qt+=xr}Ct===3&&St.writeVarint(Rt(7,1))}}function Zt(jt,St){var Xt=typeof jt;Xt==="string"?St.writeStringField(1,jt):Xt==="boolean"?St.writeBooleanField(7,jt):Xt==="number"&&(jt%1!=0?St.writeDoubleField(3,jt):jt<0?St.writeSVarintField(6,jt):St.writeVarintField(5,jt))}return q.exports=Be,q.exports.fromVectorTileJs=Be,q.exports.fromGeojsonVt=function(jt,St){St=St||{};var Xt={};for(var Ct in jt)Xt[Ct]=new Oe(jt[Ct].features,St),Xt[Ct].name=Ct,Xt[Ct].version=St.version,Xt[Ct].extent=St.extent;return Be({layers:Xt})},q.exports.GeoJSONWrapper=Oe,q.exports})(),G=s.cP(W);const ie={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Tt=>Tt},J=Math.fround||(H=new Float32Array(1),Tt=>(H[0]=+Tt,H[0]));var H;class ne{constructor(Oe){this.options=Object.assign(Object.create(ie),Oe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Oe){const{log:Be,minZoom:Ne,maxZoom:rt}=this.options;Be&&console.time("total time");const pt=`prepare ${Oe.length} points`;Be&&console.time(pt),this.points=Oe;const Rt=[];for(let At=0;At<Oe.length;At++){const Zt=Oe[At];if(!Zt.geometry)continue;const[jt,St]=Zt.geometry.coordinates,Xt=J(de(jt)),Ct=J(Pe(St));Rt.push(Xt,Ct,1/0,At,-1,1),this.options.reduce&&Rt.push(0)}let Bt=this.trees[rt+1]=this._createTree(Rt);Be&&console.timeEnd(pt);for(let At=rt;At>=Ne;At--){const Zt=+Date.now();Bt=this.trees[At]=this._createTree(this._cluster(Bt,At)),Be&&console.log("z%d: %d clusters in %dms",At,Bt.numItems,+Date.now()-Zt)}return Be&&console.timeEnd("total time"),this}getClusters(Oe,Be){let Ne=((Oe[0]+180)%360+360)%360-180;const rt=Math.max(-90,Math.min(90,Oe[1]));let pt=Oe[2]===180?180:((Oe[2]+180)%360+360)%360-180;const Rt=Math.max(-90,Math.min(90,Oe[3]));if(Oe[2]-Oe[0]>=360)Ne=-180,pt=180;else if(Ne>pt){const St=this.getClusters([Ne,rt,180,Rt],Be),Xt=this.getClusters([-180,rt,pt,Rt],Be);return St.concat(Xt)}const Bt=this.trees[this._limitZoom(Be)],At=Bt.range(de(Ne),Pe(Rt),de(pt),Pe(rt)),Zt=Bt.data,jt=[];for(const St of At){const Xt=this.stride*St;jt.push(Zt[Xt+5]>1?ae(Zt,Xt,this.clusterProps):this.points[Zt[Xt+3]])}return jt}getChildren(Oe){const Be=this._getOriginId(Oe),Ne=this._getOriginZoom(Oe),rt="No cluster with the specified id.",pt=this.trees[Ne];if(!pt)throw new Error(rt);const Rt=pt.data;if(Be*this.stride>=Rt.length)throw new Error(rt);const Bt=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),At=pt.within(Rt[Be*this.stride],Rt[Be*this.stride+1],Bt),Zt=[];for(const jt of At){const St=jt*this.stride;Rt[St+4]===Oe&&Zt.push(Rt[St+5]>1?ae(Rt,St,this.clusterProps):this.points[Rt[St+3]])}if(Zt.length===0)throw new Error(rt);return Zt}getLeaves(Oe,Be,Ne){const rt=[];return this._appendLeaves(rt,Oe,Be=Be||10,Ne=Ne||0,0),rt}getTile(Oe,Be,Ne){const rt=this.trees[this._limitZoom(Oe)],pt=Math.pow(2,Oe),{extent:Rt,radius:Bt}=this.options,At=Bt/Rt,Zt=(Ne-At)/pt,jt=(Ne+1+At)/pt,St={features:[]};return this._addTileFeatures(rt.range((Be-At)/pt,Zt,(Be+1+At)/pt,jt),rt.data,Be,Ne,pt,St),Be===0&&this._addTileFeatures(rt.range(1-At/pt,Zt,1,jt),rt.data,pt,Ne,pt,St),Be===pt-1&&this._addTileFeatures(rt.range(0,Zt,At/pt,jt),rt.data,-1,Ne,pt,St),St.features.length?St:null}getClusterExpansionZoom(Oe){let Be=this._getOriginZoom(Oe)-1;for(;Be<=this.options.maxZoom;){const Ne=this.getChildren(Oe);if(Be++,Ne.length!==1)break;Oe=Ne[0].properties.cluster_id}return Be}_appendLeaves(Oe,Be,Ne,rt,pt){const Rt=this.getChildren(Be);for(const Bt of Rt){const At=Bt.properties;if(At&&At.cluster?pt+At.point_count<=rt?pt+=At.point_count:pt=this._appendLeaves(Oe,At.cluster_id,Ne,rt,pt):pt<rt?pt++:Oe.push(Bt),Oe.length===Ne)break}return pt}_createTree(Oe){const Be=new s.aH(Oe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ne=0;Ne<Oe.length;Ne+=this.stride)Be.add(Oe[Ne],Oe[Ne+1]);return Be.finish(),Be.data=Oe,Be}_addTileFeatures(Oe,Be,Ne,rt,pt,Rt){for(const Bt of Oe){const At=Bt*this.stride,Zt=Be[At+5]>1;let jt,St,Xt;if(Zt)jt=ue(Be,At,this.clusterProps),St=Be[At],Xt=Be[At+1];else{const qt=this.points[Be[At+3]];jt=qt.properties;const[Zr,jr]=qt.geometry.coordinates;St=de(Zr),Xt=Pe(jr)}const Ct={type:1,geometry:[[Math.round(this.options.extent*(St*pt-Ne)),Math.round(this.options.extent*(Xt*pt-rt))]],tags:jt};let Lr;Lr=Zt||this.options.generateId?Be[At+3]:this.points[Be[At+3]].id,Lr!==void 0&&(Ct.id=Lr),Rt.features.push(Ct)}}_limitZoom(Oe){return Math.max(this.options.minZoom,Math.min(Math.floor(+Oe),this.options.maxZoom+1))}_cluster(Oe,Be){const{radius:Ne,extent:rt,reduce:pt,minPoints:Rt}=this.options,Bt=Ne/(rt*Math.pow(2,Be)),At=Oe.data,Zt=[],jt=this.stride;for(let St=0;St<At.length;St+=jt){if(At[St+2]<=Be)continue;At[St+2]=Be;const Xt=At[St],Ct=At[St+1],Lr=Oe.within(At[St],At[St+1],Bt),qt=At[St+5];let Zr=qt;for(const jr of Lr){const vn=jr*jt;At[vn+2]>Be&&(Zr+=At[vn+5])}if(Zr>qt&&Zr>=Rt){let jr,vn=Xt*qt,Ce=Ct*qt,Ue=-1;const ft=(St/jt<<5)+(Be+1)+this.points.length;for(const Mt of Lr){const xr=Mt*jt;if(At[xr+2]<=Be)continue;At[xr+2]=Be;const Kr=At[xr+5];vn+=At[xr]*Kr,Ce+=At[xr+1]*Kr,At[xr+4]=ft,pt&&(jr||(jr=this._map(At,St,!0),Ue=this.clusterProps.length,this.clusterProps.push(jr)),pt(jr,this._map(At,xr)))}At[St+4]=ft,Zt.push(vn/Zr,Ce/Zr,1/0,ft,-1,Zr),pt&&Zt.push(Ue)}else{for(let jr=0;jr<jt;jr++)Zt.push(At[St+jr]);if(Zr>1)for(const jr of Lr){const vn=jr*jt;if(!(At[vn+2]<=Be)){At[vn+2]=Be;for(let Ce=0;Ce<jt;Ce++)Zt.push(At[vn+Ce])}}}}return Zt}_getOriginId(Oe){return Oe-this.points.length>>5}_getOriginZoom(Oe){return(Oe-this.points.length)%32}_map(Oe,Be,Ne){if(Oe[Be+5]>1){const Rt=this.clusterProps[Oe[Be+6]];return Ne?Object.assign({},Rt):Rt}const rt=this.points[Oe[Be+3]].properties,pt=this.options.map(rt);return Ne&&pt===rt?Object.assign({},pt):pt}}function ae(Tt,Oe,Be){return{type:"Feature",id:Tt[Oe+3],properties:ue(Tt,Oe,Be),geometry:{type:"Point",coordinates:[(Ne=Tt[Oe],360*(Ne-.5)),me(Tt[Oe+1])]}};var Ne}function ue(Tt,Oe,Be){const Ne=Tt[Oe+5],rt=Ne>=1e4?`${Math.round(Ne/1e3)}k`:Ne>=1e3?Math.round(Ne/100)/10+"k":Ne,pt=Tt[Oe+6],Rt=pt===-1?{}:Object.assign({},Be[pt]);return Object.assign(Rt,{cluster:!0,cluster_id:Tt[Oe+3],point_count:Ne,point_count_abbreviated:rt})}function de(Tt){return Tt/360+.5}function Pe(Tt){const Oe=Math.sin(Tt*Math.PI/180),Be=.5-.25*Math.log((1+Oe)/(1-Oe))/Math.PI;return Be<0?0:Be>1?1:Be}function me(Tt){const Oe=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp(Oe))/Math.PI-90}function Ee(Tt,Oe,Be,Ne){let rt=Ne;const pt=Oe+(Be-Oe>>1);let Rt,Bt=Be-Oe;const At=Tt[Oe],Zt=Tt[Oe+1],jt=Tt[Be],St=Tt[Be+1];for(let Xt=Oe+3;Xt<Be;Xt+=3){const Ct=we(Tt[Xt],Tt[Xt+1],At,Zt,jt,St);if(Ct>rt)Rt=Xt,rt=Ct;else if(Ct===rt){const Lr=Math.abs(Xt-pt);Lr<Bt&&(Rt=Xt,Bt=Lr)}}rt>Ne&&(Rt-Oe>3&&Ee(Tt,Oe,Rt,Ne),Tt[Rt+2]=rt,Be-Rt>3&&Ee(Tt,Rt,Be,Ne))}function we(Tt,Oe,Be,Ne,rt,pt){let Rt=rt-Be,Bt=pt-Ne;if(Rt!==0||Bt!==0){const At=((Tt-Be)*Rt+(Oe-Ne)*Bt)/(Rt*Rt+Bt*Bt);At>1?(Be=rt,Ne=pt):At>0&&(Be+=Rt*At,Ne+=Bt*At)}return Rt=Tt-Be,Bt=Oe-Ne,Rt*Rt+Bt*Bt}function Ae(Tt,Oe,Be,Ne){const rt={id:Tt??null,type:Oe,geometry:Be,tags:Ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")ce(rt,Be);else if(Oe==="Polygon")ce(rt,Be[0]);else if(Oe==="MultiLineString")for(const pt of Be)ce(rt,pt);else if(Oe==="MultiPolygon")for(const pt of Be)ce(rt,pt[0]);return rt}function ce(Tt,Oe){for(let Be=0;Be<Oe.length;Be+=3)Tt.minX=Math.min(Tt.minX,Oe[Be]),Tt.minY=Math.min(Tt.minY,Oe[Be+1]),Tt.maxX=Math.max(Tt.maxX,Oe[Be]),Tt.maxY=Math.max(Tt.maxY,Oe[Be+1])}function xe(Tt,Oe,Be,Ne){if(!Oe.geometry)return;const rt=Oe.geometry.coordinates;if(rt&&rt.length===0)return;const pt=Oe.geometry.type,Rt=Math.pow(Be.tolerance/((1<<Be.maxZoom)*Be.extent),2);let Bt=[],At=Oe.id;if(Be.promoteId?At=Oe.properties[Be.promoteId]:Be.generateId&&(At=Ne||0),pt==="Point")_e(rt,Bt);else if(pt==="MultiPoint")for(const Zt of rt)_e(Zt,Bt);else if(pt==="LineString")Me(rt,Bt,Rt,!1);else if(pt==="MultiLineString"){if(Be.lineMetrics){for(const Zt of rt)Bt=[],Me(Zt,Bt,Rt,!1),Tt.push(Ae(At,"LineString",Bt,Oe.properties));return}Re(rt,Bt,Rt,!1)}else if(pt==="Polygon")Re(rt,Bt,Rt,!0);else{if(pt!=="MultiPolygon"){if(pt==="GeometryCollection"){for(const Zt of Oe.geometry.geometries)xe(Tt,{id:At,geometry:Zt,properties:Oe.properties},Be,Ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Zt of rt){const jt=[];Re(Zt,jt,Rt,!0),Bt.push(jt)}}Tt.push(Ae(At,pt,Bt,Oe.properties))}function _e(Tt,Oe){Oe.push(He(Tt[0]),Fe(Tt[1]),0)}function Me(Tt,Oe,Be,Ne){let rt,pt,Rt=0;for(let At=0;At<Tt.length;At++){const Zt=He(Tt[At][0]),jt=Fe(Tt[At][1]);Oe.push(Zt,jt,0),At>0&&(Rt+=Ne?(rt*jt-Zt*pt)/2:Math.sqrt(Math.pow(Zt-rt,2)+Math.pow(jt-pt,2))),rt=Zt,pt=jt}const Bt=Oe.length-3;Oe[2]=1,Ee(Oe,0,Bt,Be),Oe[Bt+2]=1,Oe.size=Math.abs(Rt),Oe.start=0,Oe.end=Oe.size}function Re(Tt,Oe,Be,Ne){for(let rt=0;rt<Tt.length;rt++){const pt=[];Me(Tt[rt],pt,Be,Ne),Oe.push(pt)}}function He(Tt){return Tt/360+.5}function Fe(Tt){const Oe=Math.sin(Tt*Math.PI/180),Be=.5-.25*Math.log((1+Oe)/(1-Oe))/Math.PI;return Be<0?0:Be>1?1:Be}function tt(Tt,Oe,Be,Ne,rt,pt,Rt,Bt){if(Ne/=Oe,pt>=(Be/=Oe)&&Rt<Ne)return Tt;if(Rt<Be||pt>=Ne)return null;const At=[];for(const Zt of Tt){const jt=Zt.geometry;let St=Zt.type;const Xt=rt===0?Zt.minX:Zt.minY,Ct=rt===0?Zt.maxX:Zt.maxY;if(Xt>=Be&&Ct<Ne){At.push(Zt);continue}if(Ct<Be||Xt>=Ne)continue;let Lr=[];if(St==="Point"||St==="MultiPoint")Ze(jt,Lr,Be,Ne,rt);else if(St==="LineString")Qe(jt,Lr,Be,Ne,rt,!1,Bt.lineMetrics);else if(St==="MultiLineString")Lt(jt,Lr,Be,Ne,rt,!1);else if(St==="Polygon")Lt(jt,Lr,Be,Ne,rt,!0);else if(St==="MultiPolygon")for(const qt of jt){const Zr=[];Lt(qt,Zr,Be,Ne,rt,!0),Zr.length&&Lr.push(Zr)}if(Lr.length){if(Bt.lineMetrics&&St==="LineString"){for(const qt of Lr)At.push(Ae(Zt.id,St,qt,Zt.tags));continue}St!=="LineString"&&St!=="MultiLineString"||(Lr.length===1?(St="LineString",Lr=Lr[0]):St="MultiLineString"),St!=="Point"&&St!=="MultiPoint"||(St=Lr.length===3?"Point":"MultiPoint"),At.push(Ae(Zt.id,St,Lr,Zt.tags))}}return At.length?At:null}function Ze(Tt,Oe,Be,Ne,rt){for(let pt=0;pt<Tt.length;pt+=3){const Rt=Tt[pt+rt];Rt>=Be&&Rt<=Ne&&at(Oe,Tt[pt],Tt[pt+1],Tt[pt+2])}}function Qe(Tt,Oe,Be,Ne,rt,pt,Rt){let Bt=Ie(Tt);const At=rt===0?Ve:nr;let Zt,jt,St=Tt.start;for(let Zr=0;Zr<Tt.length-3;Zr+=3){const jr=Tt[Zr],vn=Tt[Zr+1],Ce=Tt[Zr+2],Ue=Tt[Zr+3],ft=Tt[Zr+4],Mt=rt===0?jr:vn,xr=rt===0?Ue:ft;let Kr=!1;Rt&&(Zt=Math.sqrt(Math.pow(jr-Ue,2)+Math.pow(vn-ft,2))),Mt<Be?xr>Be&&(jt=At(Bt,jr,vn,Ue,ft,Be),Rt&&(Bt.start=St+Zt*jt)):Mt>Ne?xr<Ne&&(jt=At(Bt,jr,vn,Ue,ft,Ne),Rt&&(Bt.start=St+Zt*jt)):at(Bt,jr,vn,Ce),xr<Be&&Mt>=Be&&(jt=At(Bt,jr,vn,Ue,ft,Be),Kr=!0),xr>Ne&&Mt<=Ne&&(jt=At(Bt,jr,vn,Ue,ft,Ne),Kr=!0),!pt&&Kr&&(Rt&&(Bt.end=St+Zt*jt),Oe.push(Bt),Bt=Ie(Tt)),Rt&&(St+=Zt)}let Xt=Tt.length-3;const Ct=Tt[Xt],Lr=Tt[Xt+1],qt=rt===0?Ct:Lr;qt>=Be&&qt<=Ne&&at(Bt,Ct,Lr,Tt[Xt+2]),Xt=Bt.length-3,pt&&Xt>=3&&(Bt[Xt]!==Bt[0]||Bt[Xt+1]!==Bt[1])&&at(Bt,Bt[0],Bt[1],Bt[2]),Bt.length&&Oe.push(Bt)}function Ie(Tt){const Oe=[];return Oe.size=Tt.size,Oe.start=Tt.start,Oe.end=Tt.end,Oe}function Lt(Tt,Oe,Be,Ne,rt,pt){for(const Rt of Tt)Qe(Rt,Oe,Be,Ne,rt,pt,!1)}function at(Tt,Oe,Be,Ne){Tt.push(Oe,Be,Ne)}function Ve(Tt,Oe,Be,Ne,rt,pt){const Rt=(pt-Oe)/(Ne-Oe);return at(Tt,pt,Be+(rt-Be)*Rt,1),Rt}function nr(Tt,Oe,Be,Ne,rt,pt){const Rt=(pt-Be)/(rt-Be);return at(Tt,Oe+(Ne-Oe)*Rt,pt,1),Rt}function Yt(Tt,Oe){const Be=[];for(let Ne=0;Ne<Tt.length;Ne++){const rt=Tt[Ne],pt=rt.type;let Rt;if(pt==="Point"||pt==="MultiPoint"||pt==="LineString")Rt=yr(rt.geometry,Oe);else if(pt==="MultiLineString"||pt==="Polygon"){Rt=[];for(const Bt of rt.geometry)Rt.push(yr(Bt,Oe))}else if(pt==="MultiPolygon"){Rt=[];for(const Bt of rt.geometry){const At=[];for(const Zt of Bt)At.push(yr(Zt,Oe));Rt.push(At)}}Be.push(Ae(rt.id,pt,Rt,rt.tags))}return Be}function yr(Tt,Oe){const Be=[];Be.size=Tt.size,Tt.start!==void 0&&(Be.start=Tt.start,Be.end=Tt.end);for(let Ne=0;Ne<Tt.length;Ne+=3)Be.push(Tt[Ne]+Oe,Tt[Ne+1],Tt[Ne+2]);return Be}function mt(Tt,Oe){if(Tt.transformed)return Tt;const Be=1<<Tt.z,Ne=Tt.x,rt=Tt.y;for(const pt of Tt.features){const Rt=pt.geometry,Bt=pt.type;if(pt.geometry=[],Bt===1)for(let At=0;At<Rt.length;At+=2)pt.geometry.push(br(Rt[At],Rt[At+1],Oe,Be,Ne,rt));else for(let At=0;At<Rt.length;At++){const Zt=[];for(let jt=0;jt<Rt[At].length;jt+=2)Zt.push(br(Rt[At][jt],Rt[At][jt+1],Oe,Be,Ne,rt));pt.geometry.push(Zt)}}return Tt.transformed=!0,Tt}function br(Tt,Oe,Be,Ne,rt,pt){return[Math.round(Be*(Tt*Ne-rt)),Math.round(Be*(Oe*Ne-pt))]}function Tr(Tt,Oe,Be,Ne,rt){const pt=Oe===rt.maxZoom?0:rt.tolerance/((1<<Oe)*rt.extent),Rt={features:[],numPoints:0,numSimplified:0,numFeatures:Tt.length,source:null,x:Be,y:Ne,z:Oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Bt of Tt)mr(Rt,Bt,pt,rt);return Rt}function mr(Tt,Oe,Be,Ne){const rt=Oe.geometry,pt=Oe.type,Rt=[];if(Tt.minX=Math.min(Tt.minX,Oe.minX),Tt.minY=Math.min(Tt.minY,Oe.minY),Tt.maxX=Math.max(Tt.maxX,Oe.maxX),Tt.maxY=Math.max(Tt.maxY,Oe.maxY),pt==="Point"||pt==="MultiPoint")for(let Bt=0;Bt<rt.length;Bt+=3)Rt.push(rt[Bt],rt[Bt+1]),Tt.numPoints++,Tt.numSimplified++;else if(pt==="LineString")Mr(Rt,rt,Tt,Be,!1,!1);else if(pt==="MultiLineString"||pt==="Polygon")for(let Bt=0;Bt<rt.length;Bt++)Mr(Rt,rt[Bt],Tt,Be,pt==="Polygon",Bt===0);else if(pt==="MultiPolygon")for(let Bt=0;Bt<rt.length;Bt++){const At=rt[Bt];for(let Zt=0;Zt<At.length;Zt++)Mr(Rt,At[Zt],Tt,Be,!0,Zt===0)}if(Rt.length){let Bt=Oe.tags||null;if(pt==="LineString"&&Ne.lineMetrics){Bt={};for(const Zt in Oe.tags)Bt[Zt]=Oe.tags[Zt];Bt.mapbox_clip_start=rt.start/rt.size,Bt.mapbox_clip_end=rt.end/rt.size}const At={geometry:Rt,type:pt==="Polygon"||pt==="MultiPolygon"?3:pt==="LineString"||pt==="MultiLineString"?2:1,tags:Bt};Oe.id!==null&&(At.id=Oe.id),Tt.features.push(At)}}function Mr(Tt,Oe,Be,Ne,rt,pt){const Rt=Ne*Ne;if(Ne>0&&Oe.size<(rt?Rt:Ne))return void(Be.numPoints+=Oe.length/3);const Bt=[];for(let At=0;At<Oe.length;At+=3)(Ne===0||Oe[At+2]>Rt)&&(Be.numSimplified++,Bt.push(Oe[At],Oe[At+1])),Be.numPoints++;rt&&(function(At,Zt){let jt=0;for(let St=0,Xt=At.length,Ct=Xt-2;St<Xt;Ct=St,St+=2)jt+=(At[St]-At[Ct])*(At[St+1]+At[Ct+1]);if(jt>0===Zt)for(let St=0,Xt=At.length;St<Xt/2;St+=2){const Ct=At[St],Lr=At[St+1];At[St]=At[Xt-2-St],At[St+1]=At[Xt-1-St],At[Xt-2-St]=Ct,At[Xt-1-St]=Lr}})(Bt,pt),Tt.push(Bt)}const Pr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ar{constructor(Oe,Be){const Ne=(Be=this.options=(function(pt,Rt){for(const Bt in Rt)pt[Bt]=Rt[Bt];return pt})(Object.create(Pr),Be)).debug;if(Ne&&console.time("preprocess data"),Be.maxZoom<0||Be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Be.promoteId&&Be.generateId)throw new Error("promoteId and generateId cannot be used together.");let rt=(function(pt,Rt){const Bt=[];if(pt.type==="FeatureCollection")for(let At=0;At<pt.features.length;At++)xe(Bt,pt.features[At],Rt,At);else xe(Bt,pt.type==="Feature"?pt:{geometry:pt},Rt);return Bt})(Oe,Be);this.tiles={},this.tileCoords=[],Ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Be.indexMaxZoom,Be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),rt=(function(pt,Rt){const Bt=Rt.buffer/Rt.extent;let At=pt;const Zt=tt(pt,1,-1-Bt,Bt,0,-1,2,Rt),jt=tt(pt,1,1-Bt,2+Bt,0,-1,2,Rt);return(Zt||jt)&&(At=tt(pt,1,-Bt,1+Bt,0,-1,2,Rt)||[],Zt&&(At=Yt(Zt,1).concat(At)),jt&&(At=At.concat(Yt(jt,-1)))),At})(rt,Be),rt.length&&this.splitTile(rt,0,0,0),Ne&&(rt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Oe,Be,Ne,rt,pt,Rt,Bt){const At=[Oe,Be,Ne,rt],Zt=this.options,jt=Zt.debug;for(;At.length;){rt=At.pop(),Ne=At.pop(),Be=At.pop(),Oe=At.pop();const St=1<<Be,Xt=fr(Be,Ne,rt);let Ct=this.tiles[Xt];if(!Ct&&(jt>1&&console.time("creation"),Ct=this.tiles[Xt]=Tr(Oe,Be,Ne,rt,Zt),this.tileCoords.push({z:Be,x:Ne,y:rt}),jt)){jt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Be,Ne,rt,Ct.numFeatures,Ct.numPoints,Ct.numSimplified),console.timeEnd("creation"));const Kr=`z${Be}`;this.stats[Kr]=(this.stats[Kr]||0)+1,this.total++}if(Ct.source=Oe,pt==null){if(Be===Zt.indexMaxZoom||Ct.numPoints<=Zt.indexMaxPoints)continue}else{if(Be===Zt.maxZoom||Be===pt)continue;if(pt!=null){const Kr=pt-Be;if(Ne!==Rt>>Kr||rt!==Bt>>Kr)continue}}if(Ct.source=null,Oe.length===0)continue;jt>1&&console.time("clipping");const Lr=.5*Zt.buffer/Zt.extent,qt=.5-Lr,Zr=.5+Lr,jr=1+Lr;let vn=null,Ce=null,Ue=null,ft=null,Mt=tt(Oe,St,Ne-Lr,Ne+Zr,0,Ct.minX,Ct.maxX,Zt),xr=tt(Oe,St,Ne+qt,Ne+jr,0,Ct.minX,Ct.maxX,Zt);Oe=null,Mt&&(vn=tt(Mt,St,rt-Lr,rt+Zr,1,Ct.minY,Ct.maxY,Zt),Ce=tt(Mt,St,rt+qt,rt+jr,1,Ct.minY,Ct.maxY,Zt),Mt=null),xr&&(Ue=tt(xr,St,rt-Lr,rt+Zr,1,Ct.minY,Ct.maxY,Zt),ft=tt(xr,St,rt+qt,rt+jr,1,Ct.minY,Ct.maxY,Zt),xr=null),jt>1&&console.timeEnd("clipping"),At.push(vn||[],Be+1,2*Ne,2*rt),At.push(Ce||[],Be+1,2*Ne,2*rt+1),At.push(Ue||[],Be+1,2*Ne+1,2*rt),At.push(ft||[],Be+1,2*Ne+1,2*rt+1)}}getTile(Oe,Be,Ne){Oe=+Oe,Be=+Be,Ne=+Ne;const rt=this.options,{extent:pt,debug:Rt}=rt;if(Oe<0||Oe>24)return null;const Bt=1<<Oe,At=fr(Oe,Be=Be+Bt&Bt-1,Ne);if(this.tiles[At])return mt(this.tiles[At],pt);Rt>1&&console.log("drilling down to z%d-%d-%d",Oe,Be,Ne);let Zt,jt=Oe,St=Be,Xt=Ne;for(;!Zt&&jt>0;)jt--,St>>=1,Xt>>=1,Zt=this.tiles[fr(jt,St,Xt)];return Zt&&Zt.source?(Rt>1&&(console.log("found parent tile z%d-%d-%d",jt,St,Xt),console.time("drilling down")),this.splitTile(Zt.source,jt,St,Xt,Oe,Be,Ne),Rt>1&&console.timeEnd("drilling down"),this.tiles[At]?mt(this.tiles[At],pt):null):null}}function fr(Tt,Oe,Be){return 32*((1<<Tt)*Be+Oe)+Tt}function Nr(Tt,Oe){return Oe?Tt.properties[Oe]:Tt.id}function or(Tt,Oe){if(Tt==null)return!0;if(Tt.type==="Feature")return Nr(Tt,Oe)!=null;if(Tt.type==="FeatureCollection"){const Be=new Set;for(const Ne of Tt.features){const rt=Nr(Ne,Oe);if(rt==null||Be.has(rt))return!1;Be.add(rt)}return!0}return!1}function Dr(Tt,Oe){const Be=new Map;if(Tt!=null)if(Tt.type==="Feature")Be.set(Nr(Tt,Oe),Tt);else for(const Ne of Tt.features)Be.set(Nr(Ne,Oe),Ne);return Be}class er extends d{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Oe,Be){return s._(this,void 0,void 0,(function*(){const Ne=Oe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const rt=this._geoJSONIndex.getTile(Ne.z,Ne.x,Ne.y);if(!rt)return null;const pt=new N(rt.features);let Rt=G(pt);return Rt.byteOffset===0&&Rt.byteLength===Rt.buffer.byteLength||(Rt=new Uint8Array(Rt)),{vectorTile:pt,rawData:Rt.buffer}}))}loadData(Oe){return s._(this,void 0,void 0,(function*(){var Be;(Be=this._pendingRequest)===null||Be===void 0||Be.abort();const Ne=!!(Oe&&Oe.request&&Oe.request.collectResourceTiming)&&new s.cM(Oe.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Oe,this._pendingRequest),this._geoJSONIndex=Oe.cluster?new ne((function({superclusterOptions:Rt,clusterProperties:Bt}){if(!Bt||!Rt)return Rt;const At={},Zt={},jt={accumulated:null,zoom:0},St={properties:null},Xt=Object.keys(Bt);for(const Ct of Xt){const[Lr,qt]=Bt[Ct],Zr=s.cT(qt),jr=s.cT(typeof Lr=="string"?[Lr,["accumulated"],["get",Ct]]:Lr);At[Ct]=Zr.value,Zt[Ct]=jr.value}return Rt.map=Ct=>{St.properties=Ct;const Lr={};for(const qt of Xt)Lr[qt]=At[qt].evaluate(jt,St);return Lr},Rt.reduce=(Ct,Lr)=>{St.properties=Lr;for(const qt of Xt)jt.accumulated=Ct[qt],Ct[qt]=Zt[qt].evaluate(jt,St)},Rt})(Oe)).load((yield this._pendingData).features):(rt=yield this._pendingData,new ar(rt,Oe.geojsonVtOptions)),this.loaded={};const pt={};if(Ne){const Rt=Ne.finish();Rt&&(pt.resourceTiming={},pt.resourceTiming[Oe.source]=JSON.parse(JSON.stringify(Rt)))}return pt}catch(pt){if(delete this._pendingRequest,s.cx(pt))return{abandoned:!0};throw pt}var rt}))}getData(){return s._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Oe){const Be=this.loaded;return Be&&Be[Oe.uid]?super.reloadTile(Oe):this.loadTile(Oe)}loadAndProcessGeoJSON(Oe,Be){return s._(this,void 0,void 0,(function*(){let Ne=yield this.loadGeoJSON(Oe,Be);if(delete this._pendingRequest,typeof Ne!="object")throw new Error(`Input data given to '${Oe.source}' is not a valid GeoJSON object.`);if(P(Ne,!0),Oe.filter){const rt=s.cT(Oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(rt.result==="error")throw new Error(rt.value.map((Rt=>`${Rt.key}: ${Rt.message}`)).join(", "));Ne={type:"FeatureCollection",features:Ne.features.filter((Rt=>rt.value.evaluate({zoom:0},Rt)))}}return Ne}))}loadGeoJSON(Oe,Be){return s._(this,void 0,void 0,(function*(){const{promoteId:Ne}=Oe;if(Oe.request){const rt=yield s.j(Oe.request,Be);return this._dataUpdateable=or(rt.data,Ne)?Dr(rt.data,Ne):void 0,rt.data}if(typeof Oe.data=="string")try{const rt=JSON.parse(Oe.data);return this._dataUpdateable=or(rt,Ne)?Dr(rt,Ne):void 0,rt}catch{throw new Error(`Input data given to '${Oe.source}' is not a valid GeoJSON object.`)}if(!Oe.dataDiff)throw new Error(`Input data given to '${Oe.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Oe.source}`);return(function(rt,pt,Rt){var Bt,At,Zt,jt;if(pt.removeAll&&rt.clear(),pt.remove)for(const St of pt.remove)rt.delete(St);if(pt.add)for(const St of pt.add){const Xt=Nr(St,Rt);Xt!=null&&rt.set(Xt,St)}if(pt.update)for(const St of pt.update){let Xt=rt.get(St.id);if(Xt==null)continue;const Ct=!St.removeAllProperties&&(((Bt=St.removeProperties)===null||Bt===void 0?void 0:Bt.length)>0||((At=St.addOrUpdateProperties)===null||At===void 0?void 0:At.length)>0);if((St.newGeometry||St.removeAllProperties||Ct)&&(Xt=Object.assign({},Xt),rt.set(St.id,Xt),Ct&&(Xt.properties=Object.assign({},Xt.properties))),St.newGeometry&&(Xt.geometry=St.newGeometry),St.removeAllProperties)Xt.properties={};else if(((Zt=St.removeProperties)===null||Zt===void 0?void 0:Zt.length)>0)for(const Lr of St.removeProperties)Object.prototype.hasOwnProperty.call(Xt.properties,Lr)&&delete Xt.properties[Lr];if(((jt=St.addOrUpdateProperties)===null||jt===void 0?void 0:jt.length)>0)for(const{key:Lr,value:qt}of St.addOrUpdateProperties)Xt.properties[Lr]=qt}})(this._dataUpdateable,Oe.dataDiff,Ne),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(Oe){return s._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Oe){return this._geoJSONIndex.getClusterExpansionZoom(Oe.clusterId)}getClusterChildren(Oe){return this._geoJSONIndex.getChildren(Oe.clusterId)}getClusterLeaves(Oe){return this._geoJSONIndex.getLeaves(Oe.clusterId,Oe.limit,Oe.offset)}}class Gt{constructor(Oe){this.self=Oe,this.actor=new s.J(Oe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Be,Ne)=>{if(this.externalWorkerSourceTypes[Be])throw new Error(`Worker source with name "${Be}" already registered.`);this.externalWorkerSourceTypes[Be]=Ne},this.self.addProtocol=s.cz,this.self.removeProtocol=s.cA,this.self.registerRTLTextPlugin=Be=>{s.cU.setMethods(Be)},this.actor.registerMessageHandler("LDT",((Be,Ne)=>this._getDEMWorkerSource(Be,Ne.source).loadTile(Ne))),this.actor.registerMessageHandler("RDT",((Be,Ne)=>s._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Be,Ne.source).removeTile(Ne)})))),this.actor.registerMessageHandler("GCEZ",((Be,Ne)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(Be,Ne.type,Ne.source).getClusterExpansionZoom(Ne)})))),this.actor.registerMessageHandler("GCC",((Be,Ne)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(Be,Ne.type,Ne.source).getClusterChildren(Ne)})))),this.actor.registerMessageHandler("GCL",((Be,Ne)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(Be,Ne.type,Ne.source).getClusterLeaves(Ne)})))),this.actor.registerMessageHandler("LD",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).loadData(Ne))),this.actor.registerMessageHandler("GD",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).getData())),this.actor.registerMessageHandler("LT",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).loadTile(Ne))),this.actor.registerMessageHandler("RT",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).reloadTile(Ne))),this.actor.registerMessageHandler("AT",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).abortTile(Ne))),this.actor.registerMessageHandler("RMT",((Be,Ne)=>this._getWorkerSource(Be,Ne.type,Ne.source).removeTile(Ne))),this.actor.registerMessageHandler("RS",((Be,Ne)=>s._(this,void 0,void 0,(function*(){if(!this.workerSources[Be]||!this.workerSources[Be][Ne.type]||!this.workerSources[Be][Ne.type][Ne.source])return;const rt=this.workerSources[Be][Ne.type][Ne.source];delete this.workerSources[Be][Ne.type][Ne.source],rt.removeSource!==void 0&&rt.removeSource(Ne)})))),this.actor.registerMessageHandler("RM",(Be=>s._(this,void 0,void 0,(function*(){delete this.layerIndexes[Be],delete this.availableImages[Be],delete this.workerSources[Be],delete this.demWorkerSources[Be]})))),this.actor.registerMessageHandler("SR",((Be,Ne)=>s._(this,void 0,void 0,(function*(){this.referrer=Ne})))),this.actor.registerMessageHandler("SRPS",((Be,Ne)=>this._syncRTLPluginState(Be,Ne))),this.actor.registerMessageHandler("IS",((Be,Ne)=>s._(this,void 0,void 0,(function*(){this.self.importScripts(Ne)})))),this.actor.registerMessageHandler("SI",((Be,Ne)=>this._setImages(Be,Ne))),this.actor.registerMessageHandler("UL",((Be,Ne)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(Be).update(Ne.layers,Ne.removedIds)})))),this.actor.registerMessageHandler("SL",((Be,Ne)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(Be).replace(Ne)}))))}_setImages(Oe,Be){return s._(this,void 0,void 0,(function*(){this.availableImages[Oe]=Be;for(const Ne in this.workerSources[Oe]){const rt=this.workerSources[Oe][Ne];for(const pt in rt)rt[pt].availableImages=Be}}))}_syncRTLPluginState(Oe,Be){return s._(this,void 0,void 0,(function*(){return yield s.cU.syncState(Be,this.self.importScripts)}))}_getAvailableImages(Oe){let Be=this.availableImages[Oe];return Be||(Be=[]),Be}_getLayerIndex(Oe){let Be=this.layerIndexes[Oe];return Be||(Be=this.layerIndexes[Oe]=new o),Be}_getWorkerSource(Oe,Be,Ne){if(this.workerSources[Oe]||(this.workerSources[Oe]={}),this.workerSources[Oe][Be]||(this.workerSources[Oe][Be]={}),!this.workerSources[Oe][Be][Ne]){const rt={sendAsync:(pt,Rt)=>(pt.targetMapId=Oe,this.actor.sendAsync(pt,Rt))};switch(Be){case"vector":this.workerSources[Oe][Be][Ne]=new d(rt,this._getLayerIndex(Oe),this._getAvailableImages(Oe));break;case"geojson":this.workerSources[Oe][Be][Ne]=new er(rt,this._getLayerIndex(Oe),this._getAvailableImages(Oe));break;default:this.workerSources[Oe][Be][Ne]=new this.externalWorkerSourceTypes[Be](rt,this._getLayerIndex(Oe),this._getAvailableImages(Oe))}}return this.workerSources[Oe][Be][Ne]}_getDEMWorkerSource(Oe,Be){return this.demWorkerSources[Oe]||(this.demWorkerSources[Oe]={}),this.demWorkerSources[Oe][Be]||(this.demWorkerSources[Oe][Be]=new b),this.demWorkerSources[Oe][Be]}}return s.i(self)&&(self.worker=new Gt(self)),Gt})),i("index",["exports","./shared"],(function(s,o){var u="5.6.0";function h(){var R=new o.A(4);return o.A!=Float32Array&&(R[1]=0,R[2]=0),R[0]=1,R[3]=1,R}let f,d;const b={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(R,l,p){const w=requestAnimationFrame((O=>{T(),l(O)})),{unsubscribe:T}=o.s(R.signal,"abort",(()=>{T(),cancelAnimationFrame(w),p(o.c())}),!1)},frameAsync(R){return new Promise(((l,p)=>{this.frame(R,l,p)}))},getImageData(R,l=0){return this.getImageCanvasContext(R).getImageData(-l,-l,R.width+2*l,R.height+2*l)},getImageCanvasContext(R){const l=window.document.createElement("canvas"),p=l.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return l.width=R.width,l.height=R.height,p.drawImage(R,0,0,R.width,R.height),p},resolveURL:R=>(f||(f=document.createElement("a")),f.href=R,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(d==null&&(d=matchMedia("(prefers-reduced-motion: reduce)")),d.matches)}};class v{static testProp(l){if(!v.docStyle)return l[0];for(let p=0;p<l.length;p++)if(l[p]in v.docStyle)return l[p];return l[0]}static create(l,p,w){const T=window.document.createElement(l);return p!==void 0&&(T.className=p),w&&w.appendChild(T),T}static createNS(l,p){return window.document.createElementNS(l,p)}static disableDrag(){v.docStyle&&v.selectProp&&(v.userSelect=v.docStyle[v.selectProp],v.docStyle[v.selectProp]="none")}static enableDrag(){v.docStyle&&v.selectProp&&(v.docStyle[v.selectProp]=v.userSelect)}static setTransform(l,p){l.style[v.transformProp]=p}static addEventListener(l,p,w,T={}){l.addEventListener(p,w,"passive"in T?T:T.capture)}static removeEventListener(l,p,w,T={}){l.removeEventListener(p,w,"passive"in T?T:T.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",v.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",v.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",v.suppressClickInternal,!0)}),0)}static getScale(l){const p=l.getBoundingClientRect();return{x:p.width/l.offsetWidth||1,y:p.height/l.offsetHeight||1,boundingClientRect:p}}static getPoint(l,p,w){const T=p.boundingClientRect;return new o.P((w.clientX-T.left)/p.x-l.clientLeft,(w.clientY-T.top)/p.y-l.clientTop)}static mousePos(l,p){const w=v.getScale(l);return v.getPoint(l,w,p)}static touchPos(l,p){const w=[],T=v.getScale(l);for(let O=0;O<p.length;O++)w.push(v.getPoint(l,T,p[O]));return w}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){const p=new DOMParser().parseFromString(l,"text/html").body||document.createElement("body"),w=p.querySelectorAll("script");for(const T of w)T.remove();return v.clean(p),p.innerHTML}static isPossiblyDangerous(l,p){const w=p.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(l)||!w.includes("javascript:")&&!w.includes("data:"))||!!l.startsWith("on")||void 0}static clean(l){const p=l.children;for(const w of p)v.removeAttributes(w),v.clean(w)}static removeAttributes(l){for(const{name:p,value:w}of l.attributes)v.isPossiblyDangerous(p,w)&&l.removeAttribute(p)}}v.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,v.selectProp=v.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),v.transformProp=v.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(R){!k&&P&&(L?N(R):E=R)}};let E,P,k=!1,L=!1;function N(R){const l=R.createTexture();R.bindTexture(R.TEXTURE_2D,l);try{if(R.texImage2D(R.TEXTURE_2D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,P),R.isContextLost())return;S.supported=!0}catch{}R.deleteTexture(l),k=!0}var M;typeof document<"u"&&(P=document.createElement("img"),P.onload=()=>{E&&N(E),E=null,L=!0},P.onerror=()=>{k=!0,E=null},P.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(R){let l,p,w,T;R.resetRequestQueue=()=>{l=[],p=0,w=0,T={}},R.addThrottleControl=te=>{const le=w++;return T[le]=te,le},R.removeThrottleControl=te=>{delete T[te],j()},R.getImage=(te,le,ge=!0)=>new Promise(((Se,be)=>{S.supported&&(te.headers||(te.headers={}),te.headers.accept="image/webp,*/*"),o.e(te,{type:"image"}),l.push({abortController:le,requestParameters:te,supportImageRefresh:ge,state:"queued",onError:Le=>{be(Le)},onSuccess:Le=>{Se(Le)}}),j()}));const O=te=>o._(this,void 0,void 0,(function*(){te.state="running";const{requestParameters:le,supportImageRefresh:ge,onError:Se,onSuccess:be,abortController:Le}=te,Ge=ge===!1&&!o.i(self)&&!o.g(le.url)&&(!le.headers||Object.keys(le.headers).reduce(((ut,_t)=>ut&&_t==="accept"),!0));p++;const lt=Ge?X(le,Le):o.m(le,Le);try{const ut=yield lt;delete te.abortController,te.state="completed",ut.data instanceof HTMLImageElement||o.b(ut.data)?be(ut):ut.data&&be({data:yield(st=ut.data,typeof createImageBitmap=="function"?o.f(st):o.h(st)),cacheControl:ut.cacheControl,expires:ut.expires})}catch(ut){delete te.abortController,Se(ut)}finally{p--,j()}var st})),j=()=>{const te=(()=>{for(const le of Object.keys(T))if(T[le]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let le=p;le<te&&l.length>0;le++){const ge=l.shift();ge.abortController.signal.aborted?le--:O(ge)}},X=(te,le)=>new Promise(((ge,Se)=>{const be=new Image,Le=te.url,Ge=te.credentials;Ge&&Ge==="include"?be.crossOrigin="use-credentials":(Ge&&Ge==="same-origin"||!o.d(Le))&&(be.crossOrigin="anonymous"),le.signal.addEventListener("abort",(()=>{be.src="",Se(o.c())})),be.fetchPriority="high",be.onload=()=>{be.onerror=be.onload=null,ge({data:be})},be.onerror=()=>{be.onerror=be.onload=null,le.signal.aborted||Se(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},be.src=Le}))})(M||(M={})),M.resetRequestQueue();class z{constructor(l){this._transformRequestFn=l}transformRequest(l,p){return this._transformRequestFn&&this._transformRequestFn(l,p)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function B(R){const l=[];if(typeof R=="string")l.push({id:"default",url:R});else if(R&&R.length>0){const p=[];for(const{id:w,url:T}of R){const O=`${w}${T}`;p.indexOf(O)===-1&&(p.push(O),l.push({id:w,url:T}))}}return l}function q(R,l,p){try{const w=new URL(R);return w.pathname+=`${l}${p}`,w.toString()}catch{throw new Error(`Invalid sprite URL "${R}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function W(R){const{userImage:l}=R;return!!(l&&l.render&&l.render())&&(R.data.replace(new Uint8Array(l.data.buffer)),!0)}class G extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,promiseResolve:w}of this.requestors)w(this._getImagesForIds(p));this.requestors=[]}}getImage(l){const p=this.images[l];if(p&&!p.data&&p.spriteData){const w=p.spriteData;p.data=new o.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),p.spriteData=null}return p}addImage(l,p){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let w=!0;const T=p.data||p.spriteData;return this._validateStretch(p.stretchX,T&&T.width)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchX" value`))),w=!1),this._validateStretch(p.stretchY,T&&T.height)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchY" value`))),w=!1),this._validateContent(p.content,p)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "content" value`))),w=!1),w}_validateStretch(l,p){if(!l)return!0;let w=0;for(const T of l){if(T[0]<w||T[1]<T[0]||p<T[1])return!1;w=T[1]}return!0}_validateContent(l,p){if(!l)return!0;if(l.length!==4)return!1;const w=p.spriteData,T=w&&w.width||p.data.width,O=w&&w.height||p.data.height;return!(l[0]<0||T<l[0]||l[1]<0||O<l[1]||l[2]<0||T<l[2]||l[3]<0||O<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,p,w=!0){const T=this.getImage(l);if(w&&(T.data.width!==p.data.width||T.data.height!==p.data.height))throw new Error(`size mismatch between old image (${T.data.width}x${T.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=T.version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise(((p,w)=>{let T=!0;if(!this.isLoaded())for(const O of l)this.images[O]||(T=!1);this.isLoaded()||T?p(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:p})}))}_getImagesForIds(l){const p={};for(const w of l){let T=this.getImage(w);T||(this.fire(new o.l("styleimagemissing",{id:w})),T=this.getImage(w)),T?p[w]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,textFitWidth:T.textFitWidth,textFitHeight:T.textFitHeight,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return p}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],w=this.getImage(l);if(!w)return null;if(p&&p.position.version===w.version)return p.position;if(p)p.position.version=w.version;else{const T={w:w.data.width+2,h:w.data.height+2,x:0,y:0},O=new o.I(T,w);this.patterns[l]={bin:T,position:O}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(l,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const O in this.patterns)l.push(this.patterns[O].bin);const{w:p,h:w}=o.p(l),T=this.atlasImage;T.resize({width:p||1,height:w||1});for(const O in this.patterns){const{bin:j}=this.patterns[O],X=j.x+1,te=j.y+1,le=this.getImage(O).data,ge=le.width,Se=le.height;o.R.copy(le,T,{x:0,y:0},{x:X,y:te},{width:ge,height:Se}),o.R.copy(le,T,{x:0,y:Se-1},{x:X,y:te-1},{width:ge,height:1}),o.R.copy(le,T,{x:0,y:0},{x:X,y:te+Se},{width:ge,height:1}),o.R.copy(le,T,{x:ge-1,y:0},{x:X-1,y:te},{width:1,height:Se}),o.R.copy(le,T,{x:0,y:0},{x:X+ge,y:te},{width:1,height:Se})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const w=this.getImage(p);w||o.w(`Image with ID: "${p}" was not found`),W(w)&&this.updateImage(p,w)}}}const ie=1e20;function J(R,l,p,w,T,O,j,X,te){for(let le=l;le<l+w;le++)H(R,p*O+le,O,T,j,X,te);for(let le=p;le<p+T;le++)H(R,le*O+l,1,w,j,X,te)}function H(R,l,p,w,T,O,j){O[0]=0,j[0]=-1e20,j[1]=ie,T[0]=R[l];for(let X=1,te=0,le=0;X<w;X++){T[X]=R[l+X*p];const ge=X*X;do{const Se=O[te];le=(T[X]-T[Se]+ge-Se*Se)/(X-Se)/2}while(le<=j[te]&&--te>-1);te++,O[te]=X,j[te]=le,j[te+1]=ie}for(let X=0,te=0;X<w;X++){for(;j[te+1]<X;)te++;const le=O[te],ge=X-le;R[l+X*p]=T[le]+ge*ge}}class ne{constructor(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,(function*(){const p=[];for(const O in l)for(const j of l[O])p.push(this._getAndCacheGlyphsPromise(O,j));const w=yield Promise.all(p),T={};for(const{stack:O,id:j,glyph:X}of w)T[O]||(T[O]={}),T[O][j]=X&&{id:X.id,bitmap:X.bitmap.clone(),metrics:X.metrics};return T}))}_getAndCacheGlyphsPromise(l,p){return o._(this,void 0,void 0,(function*(){let w=this.entries[l];w||(w=this.entries[l]={glyphs:{},requests:{},ranges:{}});let T=w.glyphs[p];if(T!==void 0)return{stack:l,id:p,glyph:T};if(T=this._tinySDF(w,l,p),T)return w.glyphs[p]=T,{stack:l,id:p,glyph:T};const O=Math.floor(p/256);if(256*O>65535)throw new Error("glyphs > 65535 not supported");if(w.ranges[O])return{stack:l,id:p,glyph:T};if(!this.url)throw new Error("glyphsUrl is not set");if(!w.requests[O]){const X=ne.loadGlyphRange(l,O,this.url,this.requestManager);w.requests[O]=X}const j=yield w.requests[O];for(const X in j)this._doesCharSupportLocalGlyph(+X)||(w.glyphs[+X]=j[+X]);return w.ranges[O]=!0,{stack:l,id:p,glyph:j[p]||null}}))}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))||o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l)||o.u["CJK Symbols and Punctuation"](l)||o.u["Halfwidth and Fullwidth Forms"](l))}_tinySDF(l,p,w){const T=this.localIdeographFontFamily;if(!T||!this._doesCharSupportLocalGlyph(w))return;let O=l.tinySDF;if(!O){let X="400";/bold/i.test(p)?X="900":/medium/i.test(p)?X="500":/light/i.test(p)&&(X="200"),O=l.tinySDF=new ne.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:T,fontWeight:X})}const j=O.draw(String.fromCharCode(w));return{id:w,bitmap:new o.q({width:j.width||60,height:j.height||60},j.data),metrics:{width:j.glyphWidth/2||24,height:j.glyphHeight/2||24,left:j.glyphLeft/2+.5||0,top:j.glyphTop/2-27.5||-8,advance:j.glyphAdvance/2||24,isDoubleResolution:!0}}}}ne.loadGlyphRange=function(R,l,p,w){return o._(this,void 0,void 0,(function*(){const T=256*l,O=T+255,j=w.transformRequest(p.replace("{fontstack}",R).replace("{range}",`${T}-${O}`),"Glyphs"),X=yield o.n(j,new AbortController);if(!X||!X.data)throw new Error(`Could not load glyph range. range: ${l}, ${T}-${O}`);const te={};for(const le of o.o(X.data))te[le.id]=le;return te}))},ne.TinySDF=class{constructor({fontSize:R=24,buffer:l=3,radius:p=8,cutoff:w=.25,fontFamily:T="sans-serif",fontWeight:O="normal",fontStyle:j="normal"}={}){this.buffer=l,this.cutoff=w,this.radius=p;const X=this.size=R+4*l,te=this._createCanvas(X),le=this.ctx=te.getContext("2d",{willReadFrequently:!0});le.font=`${j} ${O} ${R}px ${T}`,le.textBaseline="alphabetic",le.textAlign="left",le.fillStyle="black",this.gridOuter=new Float64Array(X*X),this.gridInner=new Float64Array(X*X),this.f=new Float64Array(X),this.z=new Float64Array(X+1),this.v=new Uint16Array(X)}_createCanvas(R){const l=document.createElement("canvas");return l.width=l.height=R,l}draw(R){const{width:l,actualBoundingBoxAscent:p,actualBoundingBoxDescent:w,actualBoundingBoxLeft:T,actualBoundingBoxRight:O}=this.ctx.measureText(R),j=Math.ceil(p),X=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(O-T))),te=Math.min(this.size-this.buffer,j+Math.ceil(w)),le=X+2*this.buffer,ge=te+2*this.buffer,Se=Math.max(le*ge,0),be=new Uint8ClampedArray(Se),Le={data:be,width:le,height:ge,glyphWidth:X,glyphHeight:te,glyphTop:j,glyphLeft:0,glyphAdvance:l};if(X===0||te===0)return Le;const{ctx:Ge,buffer:lt,gridInner:st,gridOuter:ut}=this;Ge.clearRect(lt,lt,X,te),Ge.fillText(R,lt,lt+j);const _t=Ge.getImageData(lt,lt,X,te);ut.fill(ie,0,Se),st.fill(0,0,Se);for(let Dt=0;Dt<te;Dt++)for(let kt=0;kt<X;kt++){const zt=_t.data[4*(Dt*X+kt)+3]/255;if(zt===0)continue;const $t=(Dt+lt)*le+kt+lt;if(zt===1)ut[$t]=0,st[$t]=ie;else{const It=.5-zt;ut[$t]=It>0?It*It:0,st[$t]=It<0?It*It:0}}J(ut,0,0,le,ge,le,this.f,this.v,this.z),J(st,lt,lt,X,te,le,this.f,this.v,this.z);for(let Dt=0;Dt<Se;Dt++){const kt=Math.sqrt(ut[Dt])-Math.sqrt(st[Dt]);be[Dt]=Math.round(255-255*(kt/this.radius+this.cutoff))}return Le}};class ae{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,p){return o.B(l.expression.evaluate(p))}interpolate(l,p,w){return{x:o.C.number(l.x,p.x,w),y:o.C.number(l.y,p.y,w),z:o.C.number(l.z,p.z,w)}}}let ue;class de extends o.E{constructor(l){super(),ue=ue||new o.r({anchor:new o.D(o.v.light.anchor),position:new ae,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(ue),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(o.x,l,p))for(const w in l){const T=l[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,w){return(!w||w.validate!==!1)&&o.y(this,l.call(o.z,{value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Pe=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class me extends o.E{constructor(l){super(),this._transitionable=new o.t(Pe),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(l,p={}){if(!this._validate(o.G,l,p)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const w in l){const T=l[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,w={}){return w?.validate!==!1&&o.y(this,l.call(o.z,o.e({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class Ee{constructor(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,p){const w=l.join(",")+String(p);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(l,p)),this.dashEntry[w]}getDashRanges(l,p,w){const T=[];let O=l.length%2==1?-l[l.length-1]*w:0,j=l[0]*w,X=!0;T.push({left:O,right:j,isDash:X,zeroLength:l[0]===0});let te=l[0];for(let le=1;le<l.length;le++){X=!X;const ge=l[le];O=te*w,te+=ge,j=te*w,T.push({left:O,right:j,isDash:X,zeroLength:ge===0})}return T}addRoundDash(l,p,w){const T=p/2;for(let O=-w;O<=w;O++){const j=this.width*(this.nextRow+w+O);let X=0,te=l[X];for(let le=0;le<this.width;le++){le/te.right>1&&(te=l[++X]);const ge=Math.abs(le-te.left),Se=Math.abs(le-te.right),be=Math.min(ge,Se);let Le;const Ge=O/w*(T+1);if(te.isDash){const lt=T-Math.abs(Ge);Le=Math.sqrt(be*be+lt*lt)}else Le=T-Math.sqrt(be*be+Ge*Ge);this.data[j+le]=Math.max(0,Math.min(255,Le+128))}}}addRegularDash(l){for(let X=l.length-1;X>=0;--X){const te=l[X],le=l[X+1];te.zeroLength?l.splice(X,1):le&&le.isDash===te.isDash&&(le.left=te.left,l.splice(X,1))}const p=l[0],w=l[l.length-1];p.isDash===w.isDash&&(p.left=w.left-this.width,w.right=p.right+this.width);const T=this.width*this.nextRow;let O=0,j=l[O];for(let X=0;X<this.width;X++){X/j.right>1&&(j=l[++O]);const te=Math.abs(X-j.left),le=Math.abs(X-j.right),ge=Math.min(te,le);this.data[T+X]=Math.max(0,Math.min(255,(j.isDash?ge:-ge)+128))}}addDash(l,p){const w=p?7:0,T=2*w+1;if(this.nextRow+T>this.height)return o.w("LineAtlas out of space"),null;let O=0;for(let X=0;X<l.length;X++)O+=l[X];if(O!==0){const X=this.width/O,te=this.getDashRanges(l,this.width,X);p?this.addRoundDash(te,X,w):this.addRegularDash(te)}const j={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:O};return this.nextRow+=T,this.dirty=!0,j}bind(l){const p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}const we="maplibre_preloaded_worker_pool";class Ae{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Ae.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach((p=>{p.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[we]}numActive(){return Object.keys(this.active).length}}const ce=Math.floor(b.hardwareConcurrency/2);let xe,_e;function Me(){return xe||(xe=new Ae),xe}Ae.workerCount=o.H(globalThis)?Math.max(Math.min(ce,3),1):1;class Re{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=p;const w=this.workerPool.acquire(p);for(let T=0;T<w.length;T++){const O=new o.J(w[T],p);O.name=`Worker ${T}`,this.actors.push(O)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,p){const w=[];for(const T of this.actors)w.push(T.sendAsync({type:l,data:p}));return Promise.all(w)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach((p=>{p.remove()})),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,p){for(const w of this.actors)w.registerMessageHandler(l,p)}}function He(){return _e||(_e=new Re(Me(),o.K),_e.registerMessageHandler("GR",((R,l,p)=>o.m(l,p)))),_e}function Fe(R,l){const p=o.L();return o.M(p,p,[1,1,0]),o.N(p,p,[.5*R.width,.5*R.height,1]),R.calculatePosMatrix?o.O(p,p,R.calculatePosMatrix(l.toUnwrapped())):p}function tt(R,l,p,w,T,O,j){var X;const te=(function(be,Le,Ge){if(be)for(const lt of be){const st=Le[lt];if(st&&st.source===Ge&&st.type==="fill-extrusion")return!0}else for(const lt in Le){const st=Le[lt];if(st.source===Ge&&st.type==="fill-extrusion")return!0}return!1})((X=T?.layers)!==null&&X!==void 0?X:null,l,R.id),le=O.maxPitchScaleFactor(),ge=R.tilesIn(w,le,te);ge.sort(Ze);const Se=[];for(const be of ge)Se.push({wrappedTileID:be.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(l,p,R._state,be.queryGeometry,be.cameraQueryGeometry,be.scale,T,O,le,Fe(R.transform,be.tileID),j?(Le,Ge)=>j(be.tileID,Le,Ge):void 0)});return(function(be,Le){for(const Ge in be)for(const lt of be[Ge])Qe(lt,Le);return be})((function(be){const Le={},Ge={};for(const lt of be){const st=lt.queryResults,ut=lt.wrappedTileID,_t=Ge[ut]=Ge[ut]||{};for(const Dt in st){const kt=st[Dt],zt=_t[Dt]=_t[Dt]||{},$t=Le[Dt]=Le[Dt]||[];for(const It of kt)zt[It.featureIndex]||(zt[It.featureIndex]=!0,$t.push(It))}}return Le})(Se),R)}function Ze(R,l){const p=R.tileID,w=l.tileID;return p.overscaledZ-w.overscaledZ||p.canonical.y-w.canonical.y||p.wrap-w.wrap||p.canonical.x-w.canonical.x}function Qe(R,l){const p=R.feature,w=l.getFeatureState(p.layer["source-layer"],p.id);p.source=p.layer.source,p.layer["source-layer"]&&(p.sourceLayer=p.layer["source-layer"]),p.state=w}function Ie(R,l,p){return o._(this,void 0,void 0,(function*(){let w=R;if(R.url?w=(yield o.j(l.transformRequest(R.url,"Source"),p)).data:yield b.frameAsync(p),!w)return null;const T=o.Q(o.e(w,R),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in w&&w.vector_layers&&(T.vectorLayerIds=w.vector_layers.map((O=>O.id))),T}))}class Lt{constructor(l,p){l&&(p?this.setSouthWest(l).setNorthEast(p):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}extend(l){const p=this._sw,w=this._ne;let T,O;if(l instanceof o.S)T=l,O=l;else{if(!(l instanceof Lt))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Lt.convert(l)):this.extend(o.S.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.S.convert(l)):this;if(T=l._sw,O=l._ne,!T||!O)return this}return p||w?(p.lng=Math.min(T.lng,p.lng),p.lat=Math.min(T.lat,p.lat),w.lng=Math.max(O.lng,w.lng),w.lat=Math.max(O.lat,w.lat)):(this._sw=new o.S(T.lng,T.lat),this._ne=new o.S(O.lng,O.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:p,lat:w}=o.S.convert(l);let T=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&T}static convert(l){return l instanceof Lt?l:l&&new Lt(l)}static fromLngLat(l,p=0){const w=360*p/40075017,T=w/Math.cos(Math.PI/180*l.lat);return new Lt(new o.S(l.lng-T,l.lat-w),new o.S(l.lng+T,l.lat+w))}adjustAntiMeridian(){const l=new o.S(this._sw.lng,this._sw.lat),p=new o.S(this._ne.lng,this._ne.lat);return new Lt(l,l.lng>p.lng?new o.S(p.lng+360,p.lat):p)}}class at{constructor(l,p,w){this.bounds=Lt.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=w||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),w=Math.floor(o.V(this.bounds.getWest())*p),T=Math.floor(o.U(this.bounds.getNorth())*p),O=Math.ceil(o.V(this.bounds.getEast())*p),j=Math.ceil(o.U(this.bounds.getSouth())*p);return l.x>=w&&l.x<O&&l.y>=T&&l.y<j}}class Ve extends o.E{constructor(l,p,w,T){if(super(),this.id=l,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(p,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Ie(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new at(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.k(l))}}))}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,(function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(p,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};w.request.collectResourceTiming=this._collectResourceTiming;let T="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise(((O,j)=>{l.reloadPromise={resolve:O,reject:j}}))}else l.actor=this.dispatcher.getActor(),T="LT";l.abortController=new AbortController;try{const O=yield l.actor.sendAsync({type:T,data:w},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,O)}catch(O){if(delete l.abortController,l.aborted)return;if(O&&O.status!==404)throw O;this._afterTileLoadWorkerResponse(l,null)}}))}_afterTileLoadWorkerResponse(l,p){if(p&&p.resourceTiming&&(l.resourceTiming=p.resourceTiming),p&&this.map._refreshExpiredTiles&&l.setExpiryData(p),l.loadVectorData(p,this.map.painter),l.reloadPromise){const w=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(w.resolve).catch(w.reject)}}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class nr extends o.E{constructor(l,p,w,T){super(),this.id=l,this.dispatcher=w,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},p),o.e(this,o.Q(p,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(l=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const p=yield Ie(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,p&&(o.e(this,p),p.bounds&&(this.tileBounds=new at(p.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:l})))}catch(p){this._tileJSONRequest=null,this.fire(new o.k(p))}}))}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,(function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const w=yield M.getImage(this.map._requestManager.transformRequest(p,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(w&&w.data){this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&l.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});const T=this.map.painter.context,O=T.gl,j=w.data;l.texture=this.map.painter.getTileTexture(j.width),l.texture?l.texture.update(j,{useMipmap:!0}):(l.texture=new o.T(T,j,O.RGBA,{useMipmap:!0}),l.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(w){if(delete l.abortController,l.aborted)l.state="unloaded";else if(w)throw l.state="errored",w}}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)}))}hasTransition(){return!1}}class Yt extends nr{constructor(l,p,w,T){super(l,p,w,T),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox",this.redFactor=p.redFactor,this.greenFactor=p.greenFactor,this.blueFactor=p.blueFactor,this.baseShift=p.baseShift}loadTile(l){return o._(this,void 0,void 0,(function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w=this.map._requestManager.transformRequest(p,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const T=yield M.getImage(w,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(T&&T.data){const O=T.data;this.map._refreshExpiredTiles&&(T.cacheControl||T.expires)&&l.setExpiryData({cacheControl:T.cacheControl,expires:T.expires});const j=o.b(O)&&o.W()?O:yield this.readImageNow(O),X={type:this.type,uid:l.uid,source:this.id,rawImageData:j,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const te=yield l.actor.sendAsync({type:"LDT",data:X});l.dem=te,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(T){if(delete l.abortController,l.aborted)l.state="unloaded";else if(T)throw l.state="errored",T}}))}readImageNow(l){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.X()){const p=l.width+2,w=l.height+2;try{return new o.R({width:p,height:w},yield o.Y(l,-1,-1,p,w))}catch{}}return b.getImageData(l,1)}))}_getNeighboringTiles(l){const p=l.canonical,w=Math.pow(2,p.z),T=(p.x-1+w)%w,O=p.x===0?l.wrap-1:l.wrap,j=(p.x+1+w)%w,X=p.x+1===w?l.wrap+1:l.wrap,te={};return te[new o.Z(l.overscaledZ,O,p.z,T,p.y).key]={backfilled:!1},te[new o.Z(l.overscaledZ,X,p.z,j,p.y).key]={backfilled:!1},p.y>0&&(te[new o.Z(l.overscaledZ,O,p.z,T,p.y-1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,l.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,X,p.z,j,p.y-1).key]={backfilled:!1}),p.y+1<w&&(te[new o.Z(l.overscaledZ,O,p.z,T,p.y+1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,l.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,X,p.z,j,p.y+1).key]={backfilled:!1}),te}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))}))}}class yr extends o.E{constructor(l,p,w,T){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=w.getActor(),this.setEventedParent(T),this._data=p.data,this._options=o.e({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId,p.clusterMaxZoom!==void 0&&this.maxzoom<=p.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${p.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(p.buffer!==void 0?p.buffer:128),tolerance:this._pixelsToTileUnits(p.tolerance!==void 0?p.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(p.clusterMaxZoom),minPoints:Math.max(2,p.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(p.clusterRadius||50),log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(l){return l*(o.$/this.tileSize)}_getClusterMaxZoom(l){const p=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${l}" rounded to "${p}"`),p}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}getData(){return o._(this,void 0,void 0,(function*(){const l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})}))}getCoordinatesFromGeometry(l){return l.type==="GeometryCollection"?l.geometries.map((p=>p.coordinates)).flat(1/0):l.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,(function*(){const l=new Lt,p=yield this.getData();let w;switch(p.type){case"FeatureCollection":w=p.features.map((T=>this.getCoordinatesFromGeometry(T.geometry))).flat(1/0);break;case"Feature":w=this.getCoordinatesFromGeometry(p.geometry);break;default:w=this.getCoordinatesFromGeometry(p)}if(w.length==0)return l;for(let T=0;T<w.length-1;T+=2)l.extend([w[T],w[T+1]]);return l}))}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,p,w){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:p,offset:w}})}_updateWorkerData(l){return o._(this,void 0,void 0,(function*(){const p=o.e({type:this.type},this.workerOptions);l?p.dataDiff=l:typeof this._data=="string"?(p.request=this.map._requestManager.transformRequest(b.resolveURL(this._data),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.l("dataloading",{dataType:"source"}));try{const w=yield this.actor.sendAsync({type:"LD",data:p});if(this._pendingLoads--,this._removed||w.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));let T=null;w.resourceTiming&&w.resourceTiming[this.id]&&(T=w.resourceTiming[this.id].slice(0));const O={dataType:"source"};this._collectResourceTiming&&T&&T.length>0&&o.e(O,{resourceTiming:T}),this.fire(new o.l("data",Object.assign(Object.assign({},O),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},O),{sourceDataType:"content"})))}catch(w){if(this._pendingLoads--,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(w))}}))}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,(function*(){const p=l.actor?"RT":"LT";l.actor=this.actor;const w={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};l.abortController=new AbortController;const T=yield this.actor.sendAsync({type:p,data:w},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(T,this.map.painter,p==="RT")}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class mt extends o.E{constructor(l,p,w,T){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=w,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=p}load(l){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const p=yield M.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,p&&p.data&&(this.image=p.data,l&&(this.coordinates=l),this._finishLoading())}catch(p){this._request=null,this._loaded=!0,this.fire(new o.k(p))}}))}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const p=l.map(o.a0.fromLngLat);var w;return this.tileID=(function(T){const O=o.a1.fromPoints(T),j=O.width(),X=O.height(),te=Math.max(j,X),le=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),ge=Math.pow(2,le);return new o.a3(le,Math.floor((O.minX+O.maxX)/2*ge),Math.floor((O.minY+O.maxY)/2*ge))})(p),this.terrainTileRanges=this._getOverlappingTileRanges(p),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=p.map((T=>this.tileID.getTilePoint(T)._round())),this.flippedWindingOrder=((w=this.tileCoords)[1].x-w[0].x)*(w[2].y-w[0].y)-(w[1].y-w[0].y)*(w[2].x-w[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this.texture||(this.texture=new o.T(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const O=this.tiles[T];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){const{minX:p,minY:w,maxX:T,maxY:O}=o.a1.fromPoints(l),j={};for(let X=0;X<=o.a2;X++){const te=Math.pow(2,X),le=Math.floor(p*te),ge=Math.floor(w*te),Se=Math.floor(T*te),be=Math.floor(O*te);j[X]={minTileX:le,minTileY:ge,maxTileX:Se,maxTileY:be}}return j}}class br extends mt{constructor(l,p,w,T){super(l,p,w,T),this.roundZoom=!0,this.type="video",this.options=p}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const p of l.urls)this.urls.push(this.map._requestManager.transformRequest(p,"Source").url);try{const p=yield o.a4(this.urls);if(this._loaded=!0,!p)return;this.video=p,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(p){this.fire(new o.k(p))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const p=this.video.seekable;l<p.start(0)||l>p.end(0)?this.fire(new o.k(new o.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,p=l.gl;this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(l,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const O=this.tiles[T];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Tr extends mt{constructor(l,p,w,T){super(l,p,w,T),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some((O=>!Array.isArray(O)||O.length!==2||O.some((j=>typeof j!="number"))))||this.fire(new o.k(new o.a5(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a5(`sources.${l}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new o.k(new o.a5(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a5(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a5(`sources.${l}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,w=p.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(p,this.canvas,w.RGBA,{premultiply:!0});let T=!1;for(const O in this.tiles){const j=this.tiles[O];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,T=!0)}T&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const mr={},Mr=R=>{switch(R){case"geojson":return yr;case"image":return mt;case"raster":return nr;case"raster-dem":return Yt;case"vector":return Ve;case"video":return br;case"canvas":return Tr}return mr[R]},Pr="RTLPluginLoaded";class ar extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=He()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch((p=>{throw this.status="error",p}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,(function*(p,w=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=b.resolveURL(p),!this.url)throw new Error(`requested url ${p} is invalid`);if(this.status==="unavailable"){if(!w)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(Pr))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let fr=null;function Nr(){return fr||(fr=new ar),fr}class or{constructor(l,p){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a6(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const p=l+this.timeAdded;p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,p,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=(function(T,O){const j={};if(!O)return j;for(const X of T){const te=X.layerIds.map((le=>O.getLayer(le))).filter(Boolean);if(te.length!==0){X.layers=te,X.stateDependentLayerIds&&(X.stateDependentLayers=X.stateDependentLayerIds.map((le=>te.filter((ge=>ge.id===le))[0])));for(const le of te)j[le.id]=X}}return j})(l.buckets,p?.style),this.hasSymbolBuckets=!1;for(const T in this.buckets){const O=this.buckets[T];if(O instanceof o.a8){if(this.hasSymbolBuckets=!0,!w)break;O.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const T in this.buckets){const O=this.buckets[T];if(O instanceof o.a8&&O.hasRTLText){this.hasRTLText=!0,Nr().lazyLoad();break}}this.queryPadding=0;for(const T in this.buckets){const O=this.buckets[T];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(T).queryRadius(O))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a7}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const w in this.buckets){const T=this.buckets[w];T.uploadPending()&&T.upload(l)}const p=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(l,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(l,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,p,w,T,O,j,X,te,le,ge,Se){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:T,cameraQueryGeometry:O,scale:j,tileSize:this.tileSize,pixelPosMatrix:ge,transform:te,params:X,queryPadding:this.queryPadding*le,getElevation:Se},l,p,w):{}}querySourceFeatures(l,p){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const T=w.loadVTLayers(),O=p&&p.sourceLayer?p.sourceLayer:"",j=T._geojsonTileLayer||T[O];if(!j)return;const X=o.a9(p&&p.filter),{z:te,x:le,y:ge}=this.tileID.canonical,Se={z:te,x:le,y:ge};for(let be=0;be<j.length;be++){const Le=j.feature(be);if(X.needGeometry){const st=o.aa(Le,!0);if(!X.filter(new o.F(this.tileID.overscaledZ),st,this.tileID.canonical))continue}else if(!X.filter(new o.F(this.tileID.overscaledZ),Le))continue;const Ge=w.getId(Le,O),lt=new o.ab(Le,te,le,ge,Ge);lt.tile=Se,l.push(lt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const p=this.expirationTime;if(l.cacheControl){const w=o.ac(l.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const w=Date.now();let T=!1;if(this.expirationTime>w)T=!1;else if(p)if(this.expirationTime<p)T=!0;else{const O=this.expirationTime-p;O?this.expirationTime=w+Math.max(O,3e4):T=!0}else T=!0;T?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const T in this.buckets){if(!p.style.hasLayer(T))continue;const O=this.buckets[T],j=O.layers[0].sourceLayer||"_geojsonTileLayer",X=w[j],te=l[j];if(!X||!te||Object.keys(te).length===0)continue;O.update(te,X,this.imageAtlas&&this.imageAtlas.patternPositions||{});const le=p&&p.style&&p.style.getLayer(T);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(O)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<b.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=b.now()+l}setDependencies(l,p){const w={};for(const T of p)w[T]=!0;this.dependencies[l]=w}hasDependency(l,p){for(const w of l){const T=this.dependencies[w];if(T){for(const O of p)if(T[O])return!0}}return!1}}class Dr{constructor(l,p){this.max=l,this.onRemove=p,this.reset()}reset(){for(const l in this.data)for(const p of this.data[l])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(l,p,w){const T=l.wrapped().key;this.data[T]===void 0&&(this.data[T]=[]);const O={value:p,timeout:void 0};if(w!==void 0&&(O.timeout=setTimeout((()=>{this.remove(l,O)}),w)),this.data[T].push(O),this.order.push(T),this.order.length>this.max){const j=this._getAndRemoveByKey(this.order[0]);j&&this.onRemove(j)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value}getByKey(l){const p=this.data[l];return p?p[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,p){if(!this.has(l))return this;const w=l.wrapped().key,T=p===void 0?0:this.data[w].indexOf(p),O=this.data[w][T];return this.data[w].splice(T,1),O.timeout&&clearTimeout(O.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(O.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(l){const p=[];for(const w in this.data)for(const T of this.data[w])l(T.value)||p.push(T);for(const w of p)this.remove(w.value.tileID,w)}}class er{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,p,w){const T=String(p);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][T]=this.stateChanges[l][T]||{},o.e(this.stateChanges[l][T],w),this.deletedStates[l]===null){this.deletedStates[l]={};for(const O in this.state[l])O!==T&&(this.deletedStates[l][O]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][T]===null){this.deletedStates[l][T]={};for(const O in this.state[l][T])w[O]||(this.deletedStates[l][T][O]=null)}else for(const O in w)this.deletedStates[l]&&this.deletedStates[l][T]&&this.deletedStates[l][T][O]===null&&delete this.deletedStates[l][T][O]}removeFeatureState(l,p,w){if(this.deletedStates[l]===null)return;const T=String(p);if(this.deletedStates[l]=this.deletedStates[l]||{},w&&p!==void 0)this.deletedStates[l][T]!==null&&(this.deletedStates[l][T]=this.deletedStates[l][T]||{},this.deletedStates[l][T][w]=null);else if(p!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][T])for(w in this.deletedStates[l][T]={},this.stateChanges[l][T])this.deletedStates[l][T][w]=null;else this.deletedStates[l][T]=null;else this.deletedStates[l]=null}getState(l,p){const w=String(p),T=o.e({},(this.state[l]||{})[w],(this.stateChanges[l]||{})[w]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const O=this.deletedStates[l][p];if(O===null)return{};for(const j in O)delete T[j]}return T}initializeTileState(l,p){l.setFeatureState(this.state,p)}coalesceChanges(l,p){const w={};for(const T in this.stateChanges){this.state[T]=this.state[T]||{};const O={};for(const j in this.stateChanges[T])this.state[T][j]||(this.state[T][j]={}),o.e(this.state[T][j],this.stateChanges[T][j]),O[j]=this.state[T][j];w[T]=O}for(const T in this.deletedStates){this.state[T]=this.state[T]||{};const O={};if(this.deletedStates[T]===null)for(const j in this.state[T])O[j]={},this.state[T][j]={};else for(const j in this.deletedStates[T]){if(this.deletedStates[T][j]===null)this.state[T][j]={};else for(const X of Object.keys(this.deletedStates[T][j]))delete this.state[T][j][X];O[j]=this.state[T][j]}w[T]=w[T]||{},o.e(w[T],O)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const T in l)l[T].setFeatureState(w,p)}}const Gt=89.25;function Tt(R,l){const p=o.ag(l.lat,-85.051129,o.ah);return new o.P(o.V(l.lng)*R,o.U(p)*R)}function Oe(R,l){return new o.a0(l.x/R,l.y/R).toLngLat()}function Be(R){return R.cameraToCenterDistance*Math.min(.85*Math.tan(o.ad(90-R.pitch)),Math.tan(o.ad(Gt-R.pitch)))}function Ne(R,l){const p=R.canonical,w=l/o.ae(p.z),T=p.x+Math.pow(2,p.z)*R.wrap,O=o.af(new Float64Array(16));return o.M(O,O,[T*w,p.y*w,0]),o.N(O,O,[w/o.$,w/o.$,1]),O}function rt(R,l,p,w,T){const O=o.a0.fromLngLat(R,l),j=T*o.ai(1,R.lat),X=j*Math.cos(o.ad(p)),te=Math.sqrt(j*j-X*X),le=te*Math.sin(o.ad(-w)),ge=te*Math.cos(o.ad(-w));return new o.a0(O.x+le,O.y+ge,O.z+X)}function pt(R,l,p){const w=l.intersectsFrustum(R);if(!p||w===0)return w;const T=l.intersectsPlane(p);return T===0?0:w===2&&T===2?2:1}function Rt(R,l,p){let w=0;const T=(p-l)/10;for(let O=0;O<10;O++)w+=T*Math.pow(Math.cos(l+(O+.5)/10*(p-l)),R);return w}function Bt(R,l){return function(p,w,T,O,j){const X=2*((R-1)/o.aj(Math.cos(o.ad(Gt-j))/Math.cos(o.ad(Gt)))-1),te=Math.acos(T/O),le=2*Rt(X-1,0,o.ad(j/2)),ge=Math.min(o.ad(Gt),te+o.ad(j/2)),Se=Rt(X-1,Math.min(ge,te-o.ad(j/2)),ge),be=Math.atan(w/T),Le=Math.hypot(w,T);let Ge=p;return Ge+=o.aj(O/Le/Math.max(.5,Math.cos(o.ad(j/2)))),Ge+=X*o.aj(Math.cos(be))/2,Ge-=o.aj(Math.max(1,Se/le/l))/2,Ge}}const At=Bt(9.314,3);function Zt(R,l){const p=(l.roundZoom?Math.round:Math.floor)(R.zoom+o.aj(R.tileSize/l.tileSize));return Math.max(0,p)}function jt(R,l){const p=R.getCameraFrustum(),w=R.getClippingPlane(),T=R.screenPointToMercatorCoordinate(R.getCameraPoint()),O=o.a0.fromLngLat(R.center,R.elevation);T.z=O.z+Math.cos(R.pitchInRadians)*R.cameraToCenterDistance/R.worldSize;const j=R.getCoveringTilesDetailsProvider(),X=j.allowVariableZoom(R,l),te=Zt(R,l),le=l.minzoom||0,ge=l.maxzoom!==void 0?l.maxzoom:R.maxZoom,Se=Math.min(Math.max(0,te),ge),be=Math.pow(2,Se),Le=[be*T.x,be*T.y,0],Ge=[be*O.x,be*O.y,0],lt=Math.hypot(O.x-T.x,O.y-T.y),st=Math.abs(O.z-T.z),ut=Math.hypot(lt,st),_t=zt=>({zoom:0,x:0,y:0,wrap:zt,fullyVisible:!1}),Dt=[],kt=[];if(R.renderWorldCopies&&j.allowWorldCopies())for(let zt=1;zt<=3;zt++)Dt.push(_t(-zt)),Dt.push(_t(zt));for(Dt.push(_t(0));Dt.length>0;){const zt=Dt.pop(),$t=zt.x,It=zt.y;let Kt=zt.fullyVisible;const Er={x:$t,y:It,z:zt.zoom},vr=j.getTileBoundingVolume(Er,zt.wrap,R.elevation,l);if(!Kt){const dn=pt(p,vr,w);if(dn===0)continue;Kt=dn===2}const _r=j.distanceToTile2d(T.x,T.y,Er,vr);let Ar=te;X&&(Ar=(l.calculateTileZoom||At)(R.zoom+o.aj(R.tileSize/l.tileSize),_r,st,ut,R.fov)),Ar=(l.roundZoom?Math.round:Math.floor)(Ar),Ar=Math.max(0,Ar);const gn=Math.min(Ar,ge);if(zt.wrap=j.getWrap(O,Er,zt.wrap),zt.zoom>=gn){if(zt.zoom<le)continue;const dn=Se-zt.zoom,Yr=Le[0]-.5-($t<<dn),Nn=Le[1]-.5-(It<<dn),Mi=l.reparseOverscaled?Math.max(zt.zoom,Ar):zt.zoom;kt.push({tileID:new o.Z(zt.zoom===ge?Mi:zt.zoom,zt.wrap,zt.zoom,$t,It),distanceSq:o.ak([Ge[0]-.5-$t,Ge[1]-.5-It]),tileDistanceToCamera:Math.sqrt(Yr*Yr+Nn*Nn)})}else for(let dn=0;dn<4;dn++)Dt.push({zoom:zt.zoom+1,x:($t<<1)+dn%2,y:(It<<1)+(dn>>1),wrap:zt.wrap,fullyVisible:Kt})}return kt.sort(((zt,$t)=>zt.distanceSq-$t.distanceSq)).map((zt=>zt.tileID))}const St=o.a1.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class Xt extends o.E{constructor(l,p,w){super(),this.id=l,this.dispatcher=w,this.on("data",(T=>this._dataHandler(T))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((T,O,j,X)=>{const te=new(Mr(O.type))(T,O,j,X);if(te.id!==T)throw new Error(`Expected Source id to be ${T} instead of ${te.id}`);return te})(l,p,w,this),this._tiles={},this._cache=new Dr(0,(T=>this._unloadTile(T))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new er,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const p=this._tiles[l];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,p,w){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,p,w)}catch(T){l.state="errored",T.status!==404?this._source.fire(new o.k(T,{tile:l})):this.update(this.transform,this.terrain)}}))}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.l("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const w=this._tiles[p];w.upload(l),w.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((l=>l.tileID)).sort(Ct).map((l=>l.key))}getRenderableIds(l){const p=[];for(const w in this._tiles)this._isIdRenderable(w,l)&&p.push(this._tiles[w]);return l?p.sort(((w,T)=>{const O=w.tileID,j=T.tileID,X=new o.P(O.canonical.x,O.canonical.y)._rotate(-this.transform.bearingInRadians),te=new o.P(j.canonical.x,j.canonical.y)._rotate(-this.transform.bearingInRadians);return O.overscaledZ-j.overscaledZ||te.y-X.y||te.x-X.x})).map((w=>w.tileID.key)):p.map((w=>w.tileID)).sort(Ct).map((w=>w.key))}hasRenderableParent(l){const p=this.findLoadedParent(l,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(l,p){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(p||!this._tiles[l].holdingForFade())}reload(l){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const p in this._tiles)l?this._reloadTile(p,"expired"):this._tiles[p].state!=="errored"&&this._reloadTile(p,"reloading")}}_reloadTile(l,p){return o._(this,void 0,void 0,(function*(){const w=this._tiles[l];w&&(w.state!=="loading"&&(w.state=p),yield this._loadTile(w,l,p))}))}_tileLoaded(l,p,w){l.timeAdded=b.now(),w==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(p,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const p=this.getRenderableIds();for(let T=0;T<p.length;T++){const O=p[T];if(l.neighboringTiles&&l.neighboringTiles[O]){const j=this.getTileByID(O);w(l,j),w(j,l)}}function w(T,O){T.needsHillshadePrepare=!0,T.needsTerrainPrepare=!0;let j=O.tileID.canonical.x-T.tileID.canonical.x;const X=O.tileID.canonical.y-T.tileID.canonical.y,te=Math.pow(2,T.tileID.canonical.z),le=O.tileID.key;j===0&&X===0||Math.abs(X)>1||(Math.abs(j)>1&&(Math.abs(j+te)===1?j+=te:Math.abs(j-te)===1&&(j-=te)),O.dem&&T.dem&&(T.dem.backfillBorder(O.dem,j,X),T.neighboringTiles&&T.neighboringTiles[le]&&(T.neighboringTiles[le].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,p,w,T){for(const O in this._tiles){let j=this._tiles[O];if(T[O]||!j.hasData()||j.tileID.overscaledZ<=p||j.tileID.overscaledZ>w)continue;let X=j.tileID;for(;j&&j.tileID.overscaledZ>p+1;){const le=j.tileID.scaledTo(j.tileID.overscaledZ-1);j=this._tiles[le.key],j&&j.hasData()&&(X=le)}let te=X;for(;te.overscaledZ>p;)if(te=te.scaledTo(te.overscaledZ-1),l[te.key]||l[te.canonical.key]){T[X.key]=X;break}}}findLoadedParent(l,p){if(l.key in this._loadedParentTiles){const w=this._loadedParentTiles[l.key];return w&&w.tileID.overscaledZ>=p?w:null}for(let w=l.overscaledZ-1;w>=p;w--){const T=l.scaledTo(w),O=this._getLoadedTile(T);if(O)return O}}findLoadedSibling(l){return this._getLoadedTile(l)}_getLoadedTile(l){const p=this._tiles[l.key];return p&&p.hasData()?p:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const p=Math.ceil(l.width/this._source.tileSize)+1,w=Math.ceil(l.height/this._source.tileSize)+1,T=Math.floor(p*w*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,T):T;this._cache.setMaxSize(O)}handleWrapJump(l){const p=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,p){const w={};for(const T in this._tiles){const O=this._tiles[T];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+p),w[O.tileID.key]=O}this._tiles=w;for(const T in this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(const T in this._tiles)this._setTileReloadTimer(T,this._tiles[T])}}_updateCoveredAndRetainedTiles(l,p,w,T,O,j){const X={},te={},le=Object.keys(l),ge=b.now();for(const Se of le){const be=l[Se],Le=this._tiles[Se];if(!Le||Le.fadeEndTime!==0&&Le.fadeEndTime<=ge)continue;const Ge=this.findLoadedParent(be,p),lt=this.findLoadedSibling(be),st=Ge||lt||null;st&&(this._addTile(st.tileID),X[st.tileID.key]=st.tileID),te[Se]=be}this._retainLoadedChildren(te,T,w,l);for(const Se in X)l[Se]||(this._coveredTiles[Se]=!0,l[Se]=X[Se]);if(j){const Se={},be={};for(const Le of O)this._tiles[Le.key].hasData()?Se[Le.key]=Le:be[Le.key]=Le;for(const Le in be){const Ge=be[Le].children(this._source.maxzoom);this._tiles[Ge[0].key]&&this._tiles[Ge[1].key]&&this._tiles[Ge[2].key]&&this._tiles[Ge[3].key]&&(Se[Ge[0].key]=l[Ge[0].key]=Ge[0],Se[Ge[1].key]=l[Ge[1].key]=Ge[1],Se[Ge[2].key]=l[Ge[2].key]=Ge[2],Se[Ge[3].key]=l[Ge[3].key]=Ge[3],delete be[Le])}for(const Le in be){const Ge=be[Le],lt=this.findLoadedParent(Ge,this._source.minzoom),st=this.findLoadedSibling(Ge),ut=lt||st||null;if(ut){Se[ut.tileID.key]=l[ut.tileID.key]=ut.tileID;for(const _t in Se)Se[_t].isChildOf(ut.tileID)&&delete Se[_t]}}for(const Le in this._tiles)Se[Le]||(this._coveredTiles[Le]=!0)}}update(l,p){if(!this._sourceLoaded||this._paused)return;let w;this.transform=l,this.terrain=p,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=l.getVisibleUnwrappedCoordinates(this._source.tileID).map((ge=>new o.Z(ge.canonical.z,ge.wrap,ge.canonical.z,ge.canonical.x,ge.canonical.y))):(w=jt(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(w=w.filter((ge=>this._source.hasTile(ge))))):w=[];const T=Zt(l,this._source),O=Math.max(T-Xt.maxOverzooming,this._source.minzoom),j=Math.max(T+Xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const ge={};for(const Se of w)if(Se.canonical.z>this._source.minzoom){const be=Se.scaledTo(Se.canonical.z-1);ge[be.key]=be;const Le=Se.scaledTo(Math.max(this._source.minzoom,Math.min(Se.canonical.z,5)));ge[Le.key]=Le}w=w.concat(Object.values(ge))}const X=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,X&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const te=this._updateRetainedTiles(w,T);Lr(this._source.type)&&this._updateCoveredAndRetainedTiles(te,O,j,T,w,p);for(const ge in te)this._tiles[ge].clearFadeHold();const le=o.al(this._tiles,te);for(const ge of le){const Se=this._tiles[ge];Se.hasSymbolBuckets&&!Se.holdingForFade()?Se.setHoldDuration(this.map._fadeDuration):Se.hasSymbolBuckets&&!Se.symbolFadeFinished()||this._removeTile(ge)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,p){var w;const T={},O={},j=Math.max(p-Xt.maxOverzooming,this._source.minzoom),X=Math.max(p+Xt.maxUnderzooming,this._source.minzoom),te={};for(const le of l){const ge=this._addTile(le);T[le.key]=le,ge.hasData()||p<this._source.maxzoom&&(te[le.key]=le)}this._retainLoadedChildren(te,p,X,T);for(const le of l){let ge=this._tiles[le.key];if(ge.hasData())continue;if(p+1>this._source.maxzoom){const be=le.children(this._source.maxzoom)[0],Le=this.getTile(be);if(Le&&Le.hasData()){T[be.key]=be;continue}}else{const be=le.children(this._source.maxzoom);if(T[be[0].key]&&T[be[1].key]&&T[be[2].key]&&T[be[3].key])continue}let Se=ge.wasRequested();for(let be=le.overscaledZ-1;be>=j;--be){const Le=le.scaledTo(be);if(O[Le.key])break;if(O[Le.key]=!0,ge=this.getTile(Le),!ge&&Se&&(ge=this._addTile(Le)),ge){const Ge=ge.hasData();if((Ge||!(!((w=this.map)===null||w===void 0)&&w.cancelPendingTileRequestsWhileZooming)||Se)&&(T[Le.key]=Le),Se=ge.wasRequested(),Ge)break}}}return T}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const p=[];let w,T=this._tiles[l].tileID;for(;T.overscaledZ>0;){if(T.key in this._loadedParentTiles){w=this._loadedParentTiles[T.key];break}p.push(T.key);const O=T.scaledTo(T.overscaledZ-1);if(w=this._getLoadedTile(O),w)break;T=O}for(const O of p)this._loadedParentTiles[O]=w}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const l in this._tiles){const p=this._tiles[l].tileID,w=this._getLoadedTile(p);this._loadedSiblingTiles[p.key]=w}}_addTile(l){let p=this._tiles[l.key];if(p)return p;p=this._cache.getAndRemove(l),p&&(this._setTileReloadTimer(l.key,p),p.tileID=l,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,p)));const w=p;return p||(p=new or(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(p,l.key,p.state)),p.uses++,this._tiles[l.key]=p,w||this._source.fire(new o.l("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(l,p){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const w=p.getExpiryTimeout();w&&(this._timers[l]=setTimeout((()=>{this._reloadTile(l,"expired"),delete this._timers[l]}),w))}refreshTiles(l){for(const p in this._tiles)(this._isIdRenderable(p)||this._tiles[p].state=="errored")&&l.some((w=>w.equals(this._tiles[p].tileID.canonical)))&&this._reloadTile(p,"expired")}_removeTile(l){const p=this._tiles[l];p&&(p.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}_dataHandler(l){const p=l.sourceDataType;l.dataType==="source"&&p==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&p==="content"&&(this.reload(l.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,p,w){const T=[],O=this.transform;if(!O)return T;const j=O.getCoveringTilesDetailsProvider().allowWorldCopies(),X=w?O.getCameraQueryGeometry(l):l,te=Le=>O.screenPointToMercatorCoordinate(Le,this.terrain),le=this.transformBbox(l,te,!j),ge=this.transformBbox(X,te,!j),Se=this.getIds(),be=o.a1.fromPoints(ge);for(let Le=0;Le<Se.length;Le++){const Ge=this._tiles[Se[Le]];if(Ge.holdingForFade())continue;const lt=j?[Ge.tileID]:[Ge.tileID.unwrapTo(-1),Ge.tileID.unwrapTo(0)],st=Math.pow(2,O.zoom-Ge.tileID.overscaledZ),ut=p*Ge.queryPadding*o.$/Ge.tileSize/st;for(const _t of lt){const Dt=be.map((kt=>_t.getTilePoint(new o.a0(kt.x,kt.y))));if(Dt.expandBy(ut),Dt.intersects(St)){const kt=le.map(($t=>_t.getTilePoint($t))),zt=ge.map(($t=>_t.getTilePoint($t)));T.push({tile:Ge,tileID:j?_t:_t.unwrapTo(0),queryGeometry:kt,cameraQueryGeometry:zt,scale:st})}}}return T}transformBbox(l,p,w){let T=l.map(p);if(w){const O=o.a1.fromPoints(l);O.shrinkBy(.001*Math.min(O.width(),O.height()));const j=O.map(p);o.a1.fromPoints(T).covers(j)||(T=T.map((X=>X.x>.5?new o.a0(X.x-1,X.y,X.z):X)))}return T}getVisibleCoordinates(l){const p=this.getRenderableIds(l).map((w=>this._tiles[w].tileID));return this.transform&&this.transform.populateCache(p),p}hasTransition(){if(this._source.hasTransition())return!0;if(Lr(this._source.type)){const l=b.now();for(const p in this._tiles)if(this._tiles[p].fadeEndTime>=l)return!0}return!1}setFeatureState(l,p,w){this._state.updateState(l=l||"_geojsonTileLayer",p,w)}removeFeatureState(l,p,w){this._state.removeFeatureState(l=l||"_geojsonTileLayer",p,w)}getFeatureState(l,p){return this._state.getState(l=l||"_geojsonTileLayer",p)}setDependencies(l,p,w){const T=this._tiles[l];T&&T.setDependencies(p,w)}reloadTilesForDependencies(l,p){for(const w in this._tiles)this._tiles[w].hasDependency(l,p)&&this._reloadTile(w,"reloading");this._cache.filter((w=>!w.hasDependency(l,p)))}}function Ct(R,l){const p=Math.abs(2*R.wrap)-+(R.wrap<0),w=Math.abs(2*l.wrap)-+(l.wrap<0);return R.overscaledZ-l.overscaledZ||w-p||l.canonical.y-R.canonical.y||l.canonical.x-R.canonical.x}function Lr(R){return R==="raster"||R==="image"||R==="video"}Xt.maxOverzooming=10,Xt.maxUnderzooming=3;class qt{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ag(l,0,1);let p=1,w=this._distances[p];const T=l*this.paddedLength+this.padding;for(;w<T&&p<this._distances.length;)w=this._distances[++p];const O=p-1,j=this._distances[O],X=w-j,te=X>0?(T-j)/X:0;return this.points[O].mult(1-te).add(this.points[p].mult(te))}}function Zr(R,l){let p=!0;return R==="always"||R!=="never"&&l!=="never"||(p=!1),p}class jr{constructor(l,p,w){const T=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(l/w),this.yCellCount=Math.ceil(p/w);for(let j=0;j<this.xCellCount*this.yCellCount;j++)T.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,w,T,O){this._forEachCell(p,w,T,O,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(w),this.bboxes.push(T),this.bboxes.push(O)}insertCircle(l,p,w,T){this._forEachCell(p-T,w-T,p+T,w+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(w),this.circles.push(T)}_insertBoxCell(l,p,w,T,O,j){this.boxCells[O].push(j)}_insertCircleCell(l,p,w,T,O,j){this.circleCells[O].push(j)}_query(l,p,w,T,O,j,X){if(w<0||l>this.width||T<0||p>this.height)return[];const te=[];if(l<=0&&p<=0&&this.width<=w&&this.height<=T){if(O)return[{key:null,x1:l,y1:p,x2:w,y2:T}];for(let le=0;le<this.boxKeys.length;le++)te.push({key:this.boxKeys[le],x1:this.bboxes[4*le],y1:this.bboxes[4*le+1],x2:this.bboxes[4*le+2],y2:this.bboxes[4*le+3]});for(let le=0;le<this.circleKeys.length;le++){const ge=this.circles[3*le],Se=this.circles[3*le+1],be=this.circles[3*le+2];te.push({key:this.circleKeys[le],x1:ge-be,y1:Se-be,x2:ge+be,y2:Se+be})}}else this._forEachCell(l,p,w,T,this._queryCell,te,{hitTest:O,overlapMode:j,seenUids:{box:{},circle:{}}},X);return te}query(l,p,w,T){return this._query(l,p,w,T,!1,null)}hitTest(l,p,w,T,O,j){return this._query(l,p,w,T,!0,O,j).length>0}hitTestCircle(l,p,w,T,O){const j=l-w,X=l+w,te=p-w,le=p+w;if(X<0||j>this.width||le<0||te>this.height)return!1;const ge=[];return this._forEachCell(j,te,X,le,this._queryCellCircle,ge,{hitTest:!0,overlapMode:T,circle:{x:l,y:p,radius:w},seenUids:{box:{},circle:{}}},O),ge.length>0}_queryCell(l,p,w,T,O,j,X,te){const{seenUids:le,hitTest:ge,overlapMode:Se}=X,be=this.boxCells[O];if(be!==null){const Ge=this.bboxes;for(const lt of be)if(!le.box[lt]){le.box[lt]=!0;const st=4*lt,ut=this.boxKeys[lt];if(l<=Ge[st+2]&&p<=Ge[st+3]&&w>=Ge[st+0]&&T>=Ge[st+1]&&(!te||te(ut))&&(!ge||!Zr(Se,ut.overlapMode))&&(j.push({key:ut,x1:Ge[st],y1:Ge[st+1],x2:Ge[st+2],y2:Ge[st+3]}),ge))return!0}}const Le=this.circleCells[O];if(Le!==null){const Ge=this.circles;for(const lt of Le)if(!le.circle[lt]){le.circle[lt]=!0;const st=3*lt,ut=this.circleKeys[lt];if(this._circleAndRectCollide(Ge[st],Ge[st+1],Ge[st+2],l,p,w,T)&&(!te||te(ut))&&(!ge||!Zr(Se,ut.overlapMode))){const _t=Ge[st],Dt=Ge[st+1],kt=Ge[st+2];if(j.push({key:ut,x1:_t-kt,y1:Dt-kt,x2:_t+kt,y2:Dt+kt}),ge)return!0}}}return!1}_queryCellCircle(l,p,w,T,O,j,X,te){const{circle:le,seenUids:ge,overlapMode:Se}=X,be=this.boxCells[O];if(be!==null){const Ge=this.bboxes;for(const lt of be)if(!ge.box[lt]){ge.box[lt]=!0;const st=4*lt,ut=this.boxKeys[lt];if(this._circleAndRectCollide(le.x,le.y,le.radius,Ge[st+0],Ge[st+1],Ge[st+2],Ge[st+3])&&(!te||te(ut))&&!Zr(Se,ut.overlapMode))return j.push(!0),!0}}const Le=this.circleCells[O];if(Le!==null){const Ge=this.circles;for(const lt of Le)if(!ge.circle[lt]){ge.circle[lt]=!0;const st=3*lt,ut=this.circleKeys[lt];if(this._circlesCollide(Ge[st],Ge[st+1],Ge[st+2],le.x,le.y,le.radius)&&(!te||te(ut))&&!Zr(Se,ut.overlapMode))return j.push(!0),!0}}}_forEachCell(l,p,w,T,O,j,X,te){const le=this._convertToXCellCoord(l),ge=this._convertToYCellCoord(p),Se=this._convertToXCellCoord(w),be=this._convertToYCellCoord(T);for(let Le=le;Le<=Se;Le++)for(let Ge=ge;Ge<=be;Ge++)if(O.call(this,l,p,w,T,this.xCellCount*Ge+Le,j,X,te))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,w,T,O,j){const X=T-l,te=O-p,le=w+j;return le*le>X*X+te*te}_circleAndRectCollide(l,p,w,T,O,j,X){const te=(j-T)/2,le=Math.abs(l-(T+te));if(le>te+w)return!1;const ge=(X-O)/2,Se=Math.abs(p-(O+ge));if(Se>ge+w)return!1;if(le<=te||Se<=ge)return!0;const be=le-te,Le=Se-ge;return be*be+Le*Le<=w*w}}function vn(R,l,p){const w=o.L();if(!R){const{vecSouth:Se,vecEast:be}=Ue(l),Le=h();Le[0]=be[0],Le[1]=be[1],Le[2]=Se[0],Le[3]=Se[1],T=Le,(ge=(j=(O=Le)[0])*(le=O[3])-(te=O[2])*(X=O[1]))&&(T[0]=le*(ge=1/ge),T[1]=-X*ge,T[2]=-te*ge,T[3]=j*ge),w[0]=Le[0],w[1]=Le[1],w[4]=Le[2],w[5]=Le[3]}var T,O,j,X,te,le,ge;return o.N(w,w,[1/p,1/p,1]),w}function Ce(R,l,p,w){if(R){const T=o.L();if(!l){const{vecSouth:O,vecEast:j}=Ue(p);T[0]=j[0],T[1]=j[1],T[4]=O[0],T[5]=O[1]}return o.N(T,T,[w,w,1]),T}return p.pixelsToClipSpaceMatrix}function Ue(R){const l=Math.cos(R.rollInRadians),p=Math.sin(R.rollInRadians),w=Math.cos(R.pitchInRadians),T=Math.cos(R.bearingInRadians),O=Math.sin(R.bearingInRadians),j=o.aq();j[0]=-T*w*p-O*l,j[1]=-O*w*p+T*l;const X=o.ar(j);X<1e-9?o.as(j):o.at(j,j,1/X);const te=o.aq();te[0]=T*w*l-O*p,te[1]=O*w*l+T*p;const le=o.ar(te);return le<1e-9?o.as(te):o.at(te,te,1/le),{vecEast:te,vecSouth:j}}function ft(R,l,p,w){let T;w?(T=[R,l,w(R,l),1],o.av(T,T,p)):(T=[R,l,0,1],_a(T,T,p));const O=T[3];return{point:new o.P(T[0]/O,T[1]/O),signedDistanceFromCamera:O,isOccluded:!1}}function Mt(R,l){return .5+R/l*.5}function xr(R,l){return R.x>=-l[0]&&R.x<=l[0]&&R.y>=-l[1]&&R.y<=l[1]}function Kr(R,l,p,w,T,O,j,X,te,le,ge,Se,be){const Le=p?R.textSizeData:R.iconSizeData,Ge=o.am(Le,l.transform.zoom),lt=[256/l.width*2+1,256/l.height*2+1],st=p?R.text.dynamicLayoutVertexArray:R.icon.dynamicLayoutVertexArray;st.clear();const ut=R.lineVertexArray,_t=p?R.text.placedSymbolArray:R.icon.placedSymbolArray,Dt=l.transform.width/l.transform.height;let kt=!1;for(let zt=0;zt<_t.length;zt++){const $t=_t.get(zt);if($t.hidden||$t.writingMode===o.an.vertical&&!kt){oo($t.numGlyphs,st);continue}kt=!1;const It=new o.P($t.anchorX,$t.anchorY),Kt={getElevation:be,pitchedLabelPlaneMatrix:w,lineVertexArray:ut,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:It,unwrappedTileID:te,width:le,height:ge,translation:Se},Er=Fn($t.anchorX,$t.anchorY,Kt);if(!xr(Er.point,lt)){oo($t.numGlyphs,st);continue}const vr=Mt(l.transform.cameraToCenterDistance,Er.signedDistanceFromCamera),_r=o.ao(Le,Ge,$t),Ar=O?_r*l.transform.getPitchedTextCorrection($t.anchorX,$t.anchorY,te)/vr:_r*vr,gn=ti({projectionContext:Kt,pitchedLabelPlaneMatrixInverse:T,symbol:$t,fontSize:Ar,flip:!1,keepUpright:j,glyphOffsetArray:R.glyphOffsetArray,dynamicLayoutVertexArray:st,aspectRatio:Dt,rotateToLine:X});kt=gn.useVertical,(gn.notEnoughRoom||kt||gn.needsFlipping&&ti({projectionContext:Kt,pitchedLabelPlaneMatrixInverse:T,symbol:$t,fontSize:Ar,flip:!0,keepUpright:j,glyphOffsetArray:R.glyphOffsetArray,dynamicLayoutVertexArray:st,aspectRatio:Dt,rotateToLine:X}).notEnoughRoom)&&oo($t.numGlyphs,st)}p?R.text.dynamicLayoutVertexBuffer.updateData(st):R.icon.dynamicLayoutVertexBuffer.updateData(st)}function Rr(R,l,p,w,T,O,j,X){const te=O.glyphStartIndex+O.numGlyphs,le=O.lineStartIndex,ge=O.lineStartIndex+O.lineLength,Se=l.getoffsetX(O.glyphStartIndex),be=l.getoffsetX(te-1),Le=ua(R*Se,p,w,T,O.segment,le,ge,X,j);if(!Le)return null;const Ge=ua(R*be,p,w,T,O.segment,le,ge,X,j);return Ge?X.projectionCache.anyProjectionOccluded?null:{first:Le,last:Ge}:null}function di(R,l,p,w){return R===o.an.horizontal&&Math.abs(p.y-l.y)>Math.abs(p.x-l.x)*w?{useVertical:!0}:(R===o.an.vertical?l.y<p.y:l.x>p.x)?{needsFlipping:!0}:null}function ti(R){const{projectionContext:l,pitchedLabelPlaneMatrixInverse:p,symbol:w,fontSize:T,flip:O,keepUpright:j,glyphOffsetArray:X,dynamicLayoutVertexArray:te,aspectRatio:le,rotateToLine:ge}=R,Se=T/24,be=w.lineOffsetX*Se,Le=w.lineOffsetY*Se;let Ge;if(w.numGlyphs>1){const lt=w.glyphStartIndex+w.numGlyphs,st=w.lineStartIndex,ut=w.lineStartIndex+w.lineLength,_t=Rr(Se,X,be,Le,O,w,ge,l);if(!_t)return{notEnoughRoom:!0};const Dt=_n(_t.first.point.x,_t.first.point.y,l,p),kt=_n(_t.last.point.x,_t.last.point.y,l,p);if(j&&!O){const zt=di(w.writingMode,Dt,kt,le);if(zt)return zt}Ge=[_t.first];for(let zt=w.glyphStartIndex+1;zt<lt-1;zt++){const $t=ua(Se*X.getoffsetX(zt),be,Le,O,w.segment,st,ut,l,ge);if(!$t)return{notEnoughRoom:!0};Ge.push($t)}Ge.push(_t.last)}else{if(j&&!O){const st=Xr(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,ut=w.lineStartIndex+w.segment+1,_t=new o.P(l.lineVertexArray.getx(ut),l.lineVertexArray.gety(ut)),Dt=Xr(_t.x,_t.y,l),kt=Dt.signedDistanceFromCamera>0?Dt.point:bi(l.tileAnchorPoint,_t,st,1,l),zt=_n(st.x,st.y,l,p),$t=_n(kt.x,kt.y,l,p),It=di(w.writingMode,zt,$t,le);if(It)return It}const lt=ua(Se*X.getoffsetX(w.glyphStartIndex),be,Le,O,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,l,ge);if(!lt||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ge=[lt]}for(const lt of Ge)o.au(te,lt.point,lt.angle);return{}}function bi(R,l,p,w,T){const O=R.add(R.sub(l)._unit()),j=Xr(O.x,O.y,T).point,X=p.sub(j);return p.add(X._mult(w/X.mag()))}function Ui(R,l,p){const w=l.projectionCache;if(w.projections[R])return w.projections[R];const T=new o.P(l.lineVertexArray.getx(R),l.lineVertexArray.gety(R)),O=Xr(T.x,T.y,l);if(O.signedDistanceFromCamera>0)return w.projections[R]=O.point,w.anyProjectionOccluded=w.anyProjectionOccluded||O.isOccluded,O.point;const j=R-p.direction;return bi(p.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(j),l.lineVertexArray.gety(j)),T,p.previousVertex,p.absOffsetX-p.distanceFromAnchor+1,l)}function Xr(R,l,p){const w=R+p.translation[0],T=l+p.translation[1];let O;return p.pitchWithMap?(O=ft(w,T,p.pitchedLabelPlaneMatrix,p.getElevation),O.isOccluded=!1):(O=p.transform.projectTileCoordinates(w,T,p.unwrappedTileID,p.getElevation),O.point.x=(.5*O.point.x+.5)*p.width,O.point.y=(.5*-O.point.y+.5)*p.height),O}function _n(R,l,p,w){if(p.pitchWithMap){const T=[R,l,0,1];return o.av(T,T,w),p.transform.projectTileCoordinates(T[0]/T[3],T[1]/T[3],p.unwrappedTileID,p.getElevation).point}return{x:R/p.width*2-1,y:l/p.height*2-1}}function Fn(R,l,p){return p.transform.projectTileCoordinates(R,l,p.unwrappedTileID,p.getElevation)}function na(R,l,p){return R._unit()._perp()._mult(l*p)}function Ca(R,l,p,w,T,O,j,X,te){if(X.projectionCache.offsets[R])return X.projectionCache.offsets[R];const le=p.add(l);if(R+te.direction<w||R+te.direction>=T)return X.projectionCache.offsets[R]=le,le;const ge=Ui(R+te.direction,X,te),Se=na(ge.sub(p),j,te.direction),be=p.add(Se),Le=ge.add(Se);return X.projectionCache.offsets[R]=o.aw(O,le,be,Le)||le,X.projectionCache.offsets[R]}function ua(R,l,p,w,T,O,j,X,te){const le=w?R-l:R+l;let ge=le>0?1:-1,Se=0;w&&(ge*=-1,Se=Math.PI),ge<0&&(Se+=Math.PI);let be,Le=ge>0?O+T:O+T+1;X.projectionCache.cachedAnchorPoint?be=X.projectionCache.cachedAnchorPoint:(be=Xr(X.tileAnchorPoint.x,X.tileAnchorPoint.y,X).point,X.projectionCache.cachedAnchorPoint=be);let Ge,lt,st=be,ut=be,_t=0,Dt=0;const kt=Math.abs(le),zt=[];let $t;for(;_t+Dt<=kt;){if(Le+=ge,Le<O||Le>=j)return null;_t+=Dt,ut=st,lt=Ge;const Er={absOffsetX:kt,direction:ge,distanceFromAnchor:_t,previousVertex:ut};if(st=Ui(Le,X,Er),p===0)zt.push(ut),$t=st.sub(ut);else{let vr;const _r=st.sub(ut);vr=_r.mag()===0?na(Ui(Le+ge,X,Er).sub(st),p,ge):na(_r,p,ge),lt||(lt=ut.add(vr)),Ge=Ca(Le,vr,st,O,j,lt,p,X,Er),zt.push(lt),$t=Ge.sub(lt)}Dt=$t.mag()}const It=$t._mult((kt-_t)/Dt)._add(lt||ut),Kt=Se+Math.atan2(st.y-ut.y,st.x-ut.x);return zt.push(It),{point:It,angle:te?Kt:0,path:zt}}const Mn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function oo(R,l){for(let p=0;p<R;p++){const w=l.length;l.resize(w+4),l.float32.set(Mn,3*w)}}function _a(R,l,p){const w=l[0],T=l[1];return R[0]=p[0]*w+p[4]*T+p[12],R[1]=p[1]*w+p[5]*T+p[13],R[3]=p[3]*w+p[7]*T+p[15],R}const Hi=100;class Ya{constructor(l,p=new jr(l.width+200,l.height+200,25),w=new jr(l.width+200,l.height+200,25)){this.transform=l,this.grid=p,this.ignoredGrid=w,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Hi,this.screenBottomBoundary=l.height+Hi,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,p,w,T,O,j,X,te,le,ge,Se,be){const Le=this.projectAndGetPerspectiveRatio(l.anchorPointX+te[0],l.anchorPointY+te[1],O,ge,be),Ge=w*Le.perspectiveRatio;let lt;if(j||X)lt=this._projectCollisionBox(l,Ge,T,O,j,X,te,Le,ge,Se,be);else{const $t=Le.x+(Se?Se.x*Ge:0),It=Le.y+(Se?Se.y*Ge:0);lt={allPointsOccluded:!1,box:[$t+l.x1*Ge,It+l.y1*Ge,$t+l.x2*Ge,It+l.y2*Ge]}}const[st,ut,_t,Dt]=lt.box,kt=j?lt.allPointsOccluded:Le.isOccluded;let zt=kt;return zt||(zt=Le.perspectiveRatio<this.perspectiveRatioCutoff),zt||(zt=!this.isInsideGrid(st,ut,_t,Dt)),zt||p!=="always"&&this.grid.hitTest(st,ut,_t,Dt,p,le)?{box:[st,ut,_t,Dt],placeable:!1,offscreen:!1,occluded:kt}:{box:[st,ut,_t,Dt],placeable:!0,offscreen:this.isOffscreen(st,ut,_t,Dt),occluded:kt}}placeCollisionCircles(l,p,w,T,O,j,X,te,le,ge,Se,be,Le,Ge){const lt=[],st=new o.P(p.anchorX,p.anchorY),ut=this.getPerspectiveRatio(st.x,st.y,j,Ge),_t=(le?O*this.transform.getPitchedTextCorrection(p.anchorX,p.anchorY,j)/ut:O*ut)/o.aA,Dt={getElevation:Ge,pitchedLabelPlaneMatrix:X,lineVertexArray:w,pitchWithMap:le,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:st,unwrappedTileID:j,width:this.transform.width,height:this.transform.height,translation:Le},kt=Rr(_t,T,p.lineOffsetX*_t,p.lineOffsetY*_t,!1,p,!1,Dt);let zt=!1,$t=!1,It=!0;if(kt){const Kt=.5*Se*ut+be,Er=new o.P(-100,-100),vr=new o.P(this.screenRightBoundary,this.screenBottomBoundary),_r=new qt,Ar=kt.first,gn=kt.last;let dn=[];for(let Mi=Ar.path.length-1;Mi>=1;Mi--)dn.push(Ar.path[Mi]);for(let Mi=1;Mi<gn.path.length;Mi++)dn.push(gn.path[Mi]);const Yr=2.5*Kt;if(le){const Mi=this.projectPathToScreenSpace(dn,Dt);dn=Mi.some((Ji=>Ji.signedDistanceFromCamera<=0))?[]:Mi.map((Ji=>Ji.point))}let Nn=[];if(dn.length>0){const Mi=dn[0].clone(),Ji=dn[0].clone();for(let Ha=1;Ha<dn.length;Ha++)Mi.x=Math.min(Mi.x,dn[Ha].x),Mi.y=Math.min(Mi.y,dn[Ha].y),Ji.x=Math.max(Ji.x,dn[Ha].x),Ji.y=Math.max(Ji.y,dn[Ha].y);Nn=Mi.x>=Er.x&&Ji.x<=vr.x&&Mi.y>=Er.y&&Ji.y<=vr.y?[dn]:Ji.x<Er.x||Mi.x>vr.x||Ji.y<Er.y||Mi.y>vr.y?[]:o.ax([dn],Er.x,Er.y,vr.x,vr.y)}for(const Mi of Nn){_r.reset(Mi,.25*Kt);let Ji=0;Ji=_r.length<=.5*Kt?1:Math.ceil(_r.paddedLength/Yr)+1;for(let Ha=0;Ha<Ji;Ha++){const fa=Ha/Math.max(Ji-1,1),da=_r.lerp(fa),oa=da.x+Hi,aa=da.y+Hi;lt.push(oa,aa,Kt,0);const ma=oa-Kt,ps=aa-Kt,Gi=oa+Kt,Is=aa+Kt;if(It=It&&this.isOffscreen(ma,ps,Gi,Is),$t=$t||this.isInsideGrid(ma,ps,Gi,Is),l!=="always"&&this.grid.hitTestCircle(oa,aa,Kt,l,ge)&&(zt=!0,!te))return{circles:[],offscreen:!1,collisionDetected:zt}}}}return{circles:!te&&zt||!$t||ut<this.perspectiveRatioCutoff?[]:lt,offscreen:It,collisionDetected:zt}}projectPathToScreenSpace(l,p){const w=(function(T,O){const j=o.L();return o.ap(j,O.pitchedLabelPlaneMatrix),T.map((X=>{const te=ft(X.x,X.y,j,O.getElevation),le=O.transform.projectTileCoordinates(te.point.x,te.point.y,O.unwrappedTileID,O.getElevation);return le.point.x=(.5*le.point.x+.5)*O.width,le.point.y=(.5*-le.point.y+.5)*O.height,le}))})(l,p);return(function(T){let O=0,j=0,X=0,te=0;for(let le=0;le<T.length;le++)T[le].isOccluded?(X=le+1,te=0):(te++,te>j&&(j=te,O=X));return T.slice(O,O+j)})(w)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[],w=new o.a1;for(const Se of l){const be=new o.P(Se.x+Hi,Se.y+Hi);w.extend(be),p.push(be)}const{minX:T,minY:O,maxX:j,maxY:X}=w,te=this.grid.query(T,O,j,X).concat(this.ignoredGrid.query(T,O,j,X)),le={},ge={};for(const Se of te){const be=Se.key;if(le[be.bucketInstanceId]===void 0&&(le[be.bucketInstanceId]={}),le[be.bucketInstanceId][be.featureIndex])continue;const Le=[new o.P(Se.x1,Se.y1),new o.P(Se.x2,Se.y1),new o.P(Se.x2,Se.y2),new o.P(Se.x1,Se.y2)];o.ay(p,Le)&&(le[be.bucketInstanceId][be.featureIndex]=!0,ge[be.bucketInstanceId]===void 0&&(ge[be.bucketInstanceId]=[]),ge[be.bucketInstanceId].push(be.featureIndex))}return ge}insertCollisionBox(l,p,w,T,O,j){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:T,featureIndex:O,collisionGroupID:j,overlapMode:p},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,w,T,O,j){const X=w?this.ignoredGrid:this.grid,te={bucketInstanceId:T,featureIndex:O,collisionGroupID:j,overlapMode:p};for(let le=0;le<l.length;le+=4)X.insertCircle(te,l[le],l[le+1],l[le+2])}projectAndGetPerspectiveRatio(l,p,w,T,O){if(O){let j;T?(j=[l,p,T(l,p),1],o.av(j,j,O)):(j=[l,p,0,1],_a(j,j,O));const X=j[3];return{x:(j[0]/X+1)/2*this.transform.width+Hi,y:(-j[1]/X+1)/2*this.transform.height+Hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/X*.5,isOccluded:!1,signedDistanceFromCamera:X}}{const j=this.transform.projectTileCoordinates(l,p,w,T);return{x:(j.point.x+1)/2*this.transform.width+Hi,y:(1-j.point.y)/2*this.transform.height+Hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/j.signedDistanceFromCamera*.5,isOccluded:j.isOccluded,signedDistanceFromCamera:j.signedDistanceFromCamera}}}getPerspectiveRatio(l,p,w,T){const O=this.transform.projectTileCoordinates(l,p,w,T);return .5+this.transform.cameraToCenterDistance/O.signedDistanceFromCamera*.5}isOffscreen(l,p,w,T){return w<Hi||l>=this.screenRightBoundary||T<Hi||p>this.screenBottomBoundary}isInsideGrid(l,p,w,T){return w>=0&&l<this.gridRightBoundary&&T>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=o.af([]);return o.M(l,l,[-100,-100,0]),l}_projectCollisionBox(l,p,w,T,O,j,X,te,le,ge,Se){let be=1,Le=0,Ge=0,lt=1;const st=l.anchorPointX+X[0],ut=l.anchorPointY+X[1];if(j&&!O){const dn=this.projectAndGetPerspectiveRatio(st+1,ut,T,le,Se),Yr=dn.x-te.x,Nn=Math.atan((dn.y-te.y)/Yr)+(Yr<0?Math.PI:0),Mi=Math.sin(Nn),Ji=Math.cos(Nn);be=Ji,Le=Mi,Ge=-Mi,lt=Ji}else if(!j&&O){const dn=Ue(this.transform);be=dn.vecEast[0],Le=dn.vecEast[1],Ge=dn.vecSouth[0],lt=dn.vecSouth[1]}let _t=te.x,Dt=te.y,kt=p;O&&(_t=st,Dt=ut,kt=Math.pow(2,-(this.transform.zoom-w.overscaledZ)),kt*=this.transform.getPitchedTextCorrection(st,ut,T),ge||(kt*=o.ag(.5+te.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),ge&&(_t+=be*ge.x*kt+Ge*ge.y*kt,Dt+=Le*ge.x*kt+lt*ge.y*kt);const zt=l.x1*kt,$t=l.x2*kt,It=(zt+$t)/2,Kt=l.y1*kt,Er=l.y2*kt,vr=(Kt+Er)/2,_r=[{offsetX:zt,offsetY:Kt},{offsetX:It,offsetY:Kt},{offsetX:$t,offsetY:Kt},{offsetX:$t,offsetY:vr},{offsetX:$t,offsetY:Er},{offsetX:It,offsetY:Er},{offsetX:zt,offsetY:Er},{offsetX:zt,offsetY:vr}];let Ar=[];for(const{offsetX:dn,offsetY:Yr}of _r)Ar.push(new o.P(_t+be*dn+Ge*Yr,Dt+Le*dn+lt*Yr));let gn=!1;if(O){const dn=Ar.map((Yr=>this.projectAndGetPerspectiveRatio(Yr.x,Yr.y,T,le,Se)));gn=dn.some((Yr=>!Yr.isOccluded)),Ar=dn.map((Yr=>new o.P(Yr.x,Yr.y)))}else gn=!0;return{box:o.az(Ar),allPointsOccluded:!gn}}}class Xs{constructor(l,p,w,T){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):T&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class ki{constructor(l,p,w,T,O){this.text=new Xs(l?l.text:null,p,w,O),this.icon=new Xs(l?l.icon:null,p,T,O)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bl{constructor(l,p,w){this.text=l,this.icon=p,this.skipFade=w}}class zo{constructor(l,p,w,T,O){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=w,this.bucketIndex=T,this.tileID=O}}class xi{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:w=>w.collisionGroupID===p}}return this.collisionGroups[l]}}function So(R,l,p,w,T){const{horizontalAlign:O,verticalAlign:j}=o.aG(R);return new o.P(-(O-.5)*l+w[0]*T,-(j-.5)*p+w[1]*T)}class Fs{constructor(l,p,w,T,O){this.transform=l.clone(),this.terrain=p,this.collisionIndex=new Ya(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new xi(T),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=O,O&&(O.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const p=this.terrain;return p?(w,T)=>p.getElevation(l,w,T):null}getBucketParts(l,p,w,T){const O=w.getBucket(p),j=w.latestFeatureIndex;if(!O||!j||p.id!==O.layerIds[0])return;const X=w.collisionBoxArray,te=O.layers[0].layout,le=O.layers[0].paint,ge=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),Se=w.tileSize/o.$,be=w.tileID.toUnwrapped(),Le=te.get("text-rotation-alignment")==="map",Ge=o.aB(w,1,this.transform.zoom),lt=o.aC(this.collisionIndex.transform,w,le.get("text-translate"),le.get("text-translate-anchor")),st=o.aC(this.collisionIndex.transform,w,le.get("icon-translate"),le.get("icon-translate-anchor")),ut=vn(Le,this.transform,Ge);this.retainedQueryData[O.bucketInstanceId]=new zo(O.bucketInstanceId,j,O.sourceLayerIndex,O.index,w.tileID);const _t={bucket:O,layout:te,translationText:lt,translationIcon:st,unwrappedTileID:be,pitchedLabelPlaneMatrix:ut,scale:ge,textPixelRatio:Se,holdingForFade:w.holdingForFade(),collisionBoxArray:X,partiallyEvaluatedTextSize:o.am(O.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(O.sourceID)};if(T)for(const Dt of O.sortKeyRanges){const{sortKey:kt,symbolInstanceStart:zt,symbolInstanceEnd:$t}=Dt;l.push({sortKey:kt,symbolInstanceStart:zt,symbolInstanceEnd:$t,parameters:_t})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:O.symbolInstances.length,parameters:_t})}attemptAnchorPlacement(l,p,w,T,O,j,X,te,le,ge,Se,be,Le,Ge,lt,st,ut,_t,Dt,kt){const zt=o.aD[l.textAnchor],$t=[l.textOffset0,l.textOffset1],It=So(zt,w,T,$t,O),Kt=this.collisionIndex.placeCollisionBox(p,be,te,le,ge,X,j,st,Se.predicate,Dt,It,kt);if((!_t||this.collisionIndex.placeCollisionBox(_t,be,te,le,ge,X,j,ut,Se.predicate,Dt,It,kt).placeable)&&Kt.placeable){let Er;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Le.crossTileID]&&this.prevPlacement.placements[Le.crossTileID]&&this.prevPlacement.placements[Le.crossTileID].text&&(Er=this.prevPlacement.variableOffsets[Le.crossTileID].anchor),Le.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Le.crossTileID]={textOffset:$t,width:w,height:T,anchor:zt,textBoxScale:O,prevAnchor:Er},this.markUsedJustification(Ge,zt,Le,lt),Ge.allowVerticalPlacement&&(this.markUsedOrientation(Ge,lt,Le),this.placedOrientations[Le.crossTileID]=lt),{shift:It,placedGlyphBoxes:Kt}}}placeLayerBucketPart(l,p,w){const{bucket:T,layout:O,translationText:j,translationIcon:X,unwrappedTileID:te,pitchedLabelPlaneMatrix:le,textPixelRatio:ge,holdingForFade:Se,collisionBoxArray:be,partiallyEvaluatedTextSize:Le,collisionGroup:Ge}=l.parameters,lt=O.get("text-optional"),st=O.get("icon-optional"),ut=o.aE(O,"text-overlap","text-allow-overlap"),_t=ut==="always",Dt=o.aE(O,"icon-overlap","icon-allow-overlap"),kt=Dt==="always",zt=O.get("text-rotation-alignment")==="map",$t=O.get("text-pitch-alignment")==="map",It=O.get("icon-text-fit")!=="none",Kt=O.get("symbol-z-order")==="viewport-y",Er=_t&&(kt||!T.hasIconData()||st),vr=kt&&(_t||!T.hasTextData()||lt);!T.collisionArrays&&be&&T.deserializeCollisionBoxes(be);const _r=this.retainedQueryData[T.bucketInstanceId].tileID,Ar=this._getTerrainElevationFunc(_r),gn=this.transform.getFastPathSimpleProjectionMatrix(_r),dn=(Yr,Nn,Mi)=>{var Ji,Ha;if(p[Yr.crossTileID])return;if(Se)return void(this.placements[Yr.crossTileID]=new bl(!1,!1,!1));let fa=!1,da=!1,oa=!0,aa=null,ma={box:null,placeable:!1,offscreen:null,occluded:!1},ps={placeable:!1},Gi=null,Is=null,gs=null,yc=0,Af=0,If=0;Nn.textFeatureIndex?yc=Nn.textFeatureIndex:Yr.useRuntimeCollisionCircles&&(yc=Yr.featureIndex),Nn.verticalTextFeatureIndex&&(Af=Nn.verticalTextFeatureIndex);const uh=Nn.textBox;if(uh){const Ru=es=>{let go=o.an.horizontal;if(T.allowVerticalPlacement&&!es&&this.prevPlacement){const cu=this.prevPlacement.placedOrientations[Yr.crossTileID];cu&&(this.placedOrientations[Yr.crossTileID]=cu,go=cu,this.markUsedOrientation(T,go,Yr))}return go},zc=(es,go)=>{if(T.allowVerticalPlacement&&Yr.numVerticalGlyphVertices>0&&Nn.verticalTextBox){for(const cu of T.writingModes)if(cu===o.an.vertical?(ma=go(),ps=ma):ma=es(),ma&&ma.placeable)break}else ma=es()},Pf=Yr.textAnchorOffsetStartIndex,bd=Yr.textAnchorOffsetEndIndex;if(bd===Pf){const es=(go,cu)=>{const zs=this.collisionIndex.placeCollisionBox(go,ut,ge,_r,te,$t,zt,j,Ge.predicate,Ar,void 0,gn);return zs&&zs.placeable&&(this.markUsedOrientation(T,cu,Yr),this.placedOrientations[Yr.crossTileID]=cu),zs};zc((()=>es(uh,o.an.horizontal)),(()=>{const go=Nn.verticalTextBox;return T.allowVerticalPlacement&&Yr.numVerticalGlyphVertices>0&&go?es(go,o.an.vertical):{box:null,offscreen:null}})),Ru(ma&&ma.placeable)}else{let es=o.aD[(Ha=(Ji=this.prevPlacement)===null||Ji===void 0?void 0:Ji.variableOffsets[Yr.crossTileID])===null||Ha===void 0?void 0:Ha.anchor];const go=(zs,bx,cC)=>{const G0=zs.x2-zs.x1,bg=zs.y2-zs.y1,gp=Yr.textBoxScale,Uh=It&&Dt==="never"?bx:null;let Il=null,Vh=ut==="never"?1:2,X0="never";es&&Vh++;for(let kf=0;kf<Vh;kf++){for(let Y0=Pf;Y0<bd;Y0++){const Z0=T.textAnchorOffsets.get(Y0);if(es&&Z0.textAnchor!==es)continue;const xg=this.attemptAnchorPlacement(Z0,zs,G0,bg,gp,zt,$t,ge,_r,te,Ge,X0,Yr,T,cC,j,X,Uh,Ar);if(xg&&(Il=xg.placedGlyphBoxes,Il&&Il.placeable))return fa=!0,aa=xg.shift,Il}es?es=null:X0=ut}return w&&!Il&&(Il={box:this.collisionIndex.placeCollisionBox(uh,"always",ge,_r,te,$t,zt,j,Ge.predicate,Ar,void 0,gn).box,offscreen:!1,placeable:!1,occluded:!1}),Il};zc((()=>go(uh,Nn.iconBox,o.an.horizontal)),(()=>{const zs=Nn.verticalTextBox;return T.allowVerticalPlacement&&(!ma||!ma.placeable)&&Yr.numVerticalGlyphVertices>0&&zs?go(zs,Nn.verticalIconBox,o.an.vertical):{box:null,occluded:!0,offscreen:null}})),ma&&(fa=ma.placeable,oa=ma.offscreen);const cu=Ru(ma&&ma.placeable);if(!fa&&this.prevPlacement){const zs=this.prevPlacement.variableOffsets[Yr.crossTileID];zs&&(this.variableOffsets[Yr.crossTileID]=zs,this.markUsedJustification(T,zs.anchor,Yr,cu))}}}if(Gi=ma,fa=Gi&&Gi.placeable,oa=Gi&&Gi.offscreen,Yr.useRuntimeCollisionCircles){const Ru=T.text.placedSymbolArray.get(Yr.centerJustifiedTextSymbolIndex),zc=o.ao(T.textSizeData,Le,Ru),Pf=O.get("text-padding");Is=this.collisionIndex.placeCollisionCircles(ut,Ru,T.lineVertexArray,T.glyphOffsetArray,zc,te,le,w,$t,Ge.predicate,Yr.collisionCircleDiameter,Pf,j,Ar),Is.circles.length&&Is.collisionDetected&&!w&&o.w("Collisions detected, but collision boxes are not shown"),fa=_t||Is.circles.length>0&&!Is.collisionDetected,oa=oa&&Is.offscreen}if(Nn.iconFeatureIndex&&(If=Nn.iconFeatureIndex),Nn.iconBox){const Ru=zc=>this.collisionIndex.placeCollisionBox(zc,Dt,ge,_r,te,$t,zt,X,Ge.predicate,Ar,It&&aa?aa:void 0,gn);ps&&ps.placeable&&Nn.verticalIconBox?(gs=Ru(Nn.verticalIconBox),da=gs.placeable):(gs=Ru(Nn.iconBox),da=gs.placeable),oa=oa&&gs.offscreen}const vg=lt||Yr.numHorizontalGlyphVertices===0&&Yr.numVerticalGlyphVertices===0,_g=st||Yr.numIconVertices===0;vg||_g?_g?vg||(da=da&&fa):fa=da&&fa:da=fa=da&&fa;const pp=da&&gs.placeable;if(fa&&Gi.placeable&&this.collisionIndex.insertCollisionBox(Gi.box,ut,O.get("text-ignore-placement"),T.bucketInstanceId,ps&&ps.placeable&&Af?Af:yc,Ge.ID),pp&&this.collisionIndex.insertCollisionBox(gs.box,Dt,O.get("icon-ignore-placement"),T.bucketInstanceId,If,Ge.ID),Is&&fa&&this.collisionIndex.insertCollisionCircles(Is.circles,ut,O.get("text-ignore-placement"),T.bucketInstanceId,yc,Ge.ID),w&&this.storeCollisionData(T.bucketInstanceId,Mi,Nn,Gi,gs,Is),Yr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(T.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Yr.crossTileID]=new bl((fa||Er)&&!Gi?.occluded,(da||vr)&&!gs?.occluded,oa||T.justReloaded),p[Yr.crossTileID]=!0};if(Kt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Yr=T.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Nn=Yr.length-1;Nn>=0;--Nn){const Mi=Yr[Nn];dn(T.symbolInstances.get(Mi),T.collisionArrays[Mi],Mi)}}else for(let Yr=l.symbolInstanceStart;Yr<l.symbolInstanceEnd;Yr++)dn(T.symbolInstances.get(Yr),T.collisionArrays[Yr],Yr);T.justReloaded=!1}storeCollisionData(l,p,w,T,O,j){if(w.textBox||w.iconBox){let X,te;this.collisionBoxArrays.has(l)?X=this.collisionBoxArrays.get(l):(X=new Map,this.collisionBoxArrays.set(l,X)),X.has(p)?te=X.get(p):(te={text:null,icon:null},X.set(p,te)),w.textBox&&(te.text=T.box),w.iconBox&&(te.icon=O.box)}if(j){let X=this.collisionCircleArrays[l];X===void 0&&(X=this.collisionCircleArrays[l]=[]);for(let te=0;te<j.circles.length;te+=4)X.push(j.circles[te+0]-Hi),X.push(j.circles[te+1]-Hi),X.push(j.circles[te+2]),X.push(j.collisionDetected?1:0)}}markUsedJustification(l,p,w,T){let O;O=T===o.an.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[o.aF(p)];const j=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const X of j)X>=0&&(l.text.placedSymbolArray.get(X).crossTileID=O>=0&&X!==O?0:w.crossTileID)}markUsedOrientation(l,p,w){const T=p===o.an.horizontal||p===o.an.horizontalOnly?p:0,O=p===o.an.vertical?p:0,j=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const X of j)l.text.placedSymbolArray.get(X).placedOrientation=T;w.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=O)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let w=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const T=p?p.symbolFadeChange(l):1,O=p?p.opacities:{},j=p?p.variableOffsets:{},X=p?p.placedOrientations:{};for(const te in this.placements){const le=this.placements[te],ge=O[te];ge?(this.opacities[te]=new ki(ge,T,le.text,le.icon),w=w||le.text!==ge.text.placed||le.icon!==ge.icon.placed):(this.opacities[te]=new ki(null,T,le.text,le.icon,le.skipFade),w=w||le.text||le.icon)}for(const te in O){const le=O[te];if(!this.opacities[te]){const ge=new ki(le,T,!1,!1);ge.isHidden()||(this.opacities[te]=ge,w=w||le.text.placed||le.icon.placed)}}for(const te in j)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=j[te]);for(const te in X)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=X[te]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const w={};for(const T of p){const O=T.getBucket(l);O&&T.latestFeatureIndex&&l.id===O.layerIds[0]&&this.updateBucketOpacities(O,T.tileID,w,T.collisionBoxArray)}}updateBucketOpacities(l,p,w,T){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const O=l.layers[0],j=O.layout,X=new ki(null,0,!1,!1,!0),te=j.get("text-allow-overlap"),le=j.get("icon-allow-overlap"),ge=O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=j.get("text-rotation-alignment")==="map",be=j.get("text-pitch-alignment")==="map",Le=j.get("icon-text-fit")!=="none",Ge=new ki(null,0,te&&(le||!l.hasIconData()||j.get("icon-optional")),le&&(te||!l.hasTextData()||j.get("text-optional")),!0);!l.collisionArrays&&T&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(T);const lt=(ut,_t,Dt)=>{for(let kt=0;kt<_t/4;kt++)ut.opacityVertexArray.emplaceBack(Dt);ut.hasVisibleVertices=ut.hasVisibleVertices||Dt!==Eo},st=this.collisionBoxArrays.get(l.bucketInstanceId);for(let ut=0;ut<l.symbolInstances.length;ut++){const _t=l.symbolInstances.get(ut),{numHorizontalGlyphVertices:Dt,numVerticalGlyphVertices:kt,crossTileID:zt}=_t;let $t=this.opacities[zt];w[zt]?$t=X:$t||($t=Ge,this.opacities[zt]=$t),w[zt]=!0;const It=_t.numIconVertices>0,Kt=this.placedOrientations[_t.crossTileID],Er=Kt===o.an.vertical,vr=Kt===o.an.horizontal||Kt===o.an.horizontalOnly;if(Dt>0||kt>0){const Ar=Ka($t.text);lt(l.text,Dt,Er?Eo:Ar),lt(l.text,kt,vr?Eo:Ar);const gn=$t.text.isHidden();[_t.rightJustifiedTextSymbolIndex,_t.centerJustifiedTextSymbolIndex,_t.leftJustifiedTextSymbolIndex].forEach((Nn=>{Nn>=0&&(l.text.placedSymbolArray.get(Nn).hidden=gn||Er?1:0)})),_t.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(_t.verticalPlacedTextSymbolIndex).hidden=gn||vr?1:0);const dn=this.variableOffsets[_t.crossTileID];dn&&this.markUsedJustification(l,dn.anchor,_t,Kt);const Yr=this.placedOrientations[_t.crossTileID];Yr&&(this.markUsedJustification(l,"left",_t,Yr),this.markUsedOrientation(l,Yr,_t))}if(It){const Ar=Ka($t.icon),gn=!(Le&&_t.verticalPlacedIconSymbolIndex&&Er);_t.placedIconSymbolIndex>=0&&(lt(l.icon,_t.numIconVertices,gn?Ar:Eo),l.icon.placedSymbolArray.get(_t.placedIconSymbolIndex).hidden=$t.icon.isHidden()),_t.verticalPlacedIconSymbolIndex>=0&&(lt(l.icon,_t.numVerticalIconVertices,gn?Eo:Ar),l.icon.placedSymbolArray.get(_t.verticalPlacedIconSymbolIndex).hidden=$t.icon.isHidden())}const _r=st&&st.has(ut)?st.get(ut):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const Ar=l.collisionArrays[ut];if(Ar){let gn=new o.P(0,0);if(Ar.textBox||Ar.verticalTextBox){let dn=!0;if(ge){const Yr=this.variableOffsets[zt];Yr?(gn=So(Yr.anchor,Yr.width,Yr.height,Yr.textOffset,Yr.textBoxScale),Se&&gn._rotate(be?-this.transform.bearingInRadians:this.transform.bearingInRadians)):dn=!1}if(Ar.textBox||Ar.verticalTextBox){let Yr;Ar.textBox&&(Yr=Er),Ar.verticalTextBox&&(Yr=vr),Mo(l.textCollisionBox.collisionVertexArray,$t.text.placed,!dn||Yr,_r.text,gn.x,gn.y)}}if(Ar.iconBox||Ar.verticalIconBox){const dn=!!(!vr&&Ar.verticalIconBox);let Yr;Ar.iconBox&&(Yr=dn),Ar.verticalIconBox&&(Yr=!dn),Mo(l.iconCollisionBox.collisionVertexArray,$t.icon.placed,Yr,_r.icon,Le?gn.x:0,Le?gn.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const w=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*w>l}setStale(){this.stale=!0}}function Mo(R,l,p,w,T,O){w&&w.length!==0||(w=[0,0,0,0]);const j=w[0]-Hi,X=w[1]-Hi,te=w[2]-Hi,le=w[3]-Hi;R.emplaceBack(l?1:0,p?1:0,T||0,O||0,j,X),R.emplaceBack(l?1:0,p?1:0,T||0,O||0,te,X),R.emplaceBack(l?1:0,p?1:0,T||0,O||0,te,le),R.emplaceBack(l?1:0,p?1:0,T||0,O||0,j,le)}const so=Math.pow(2,25),xl=Math.pow(2,24),Za=Math.pow(2,17),Lc=Math.pow(2,16),cc=Math.pow(2,9),Yo=Math.pow(2,8),Bs=Math.pow(2,1);function Ka(R){if(R.opacity===0&&!R.placed)return 0;if(R.opacity===1&&R.placed)return 4294967295;const l=R.placed?1:0,p=Math.floor(127*R.opacity);return p*so+l*xl+p*Za+l*Lc+p*cc+l*Yo+p*Bs+l}const Eo=0;class Va{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,p,w,T,O){const j=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(j,T,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,O())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,j.sort(((X,te)=>X.sortKey-te.sortKey)));this._currentPartIndex<j.length;)if(p.placeLayerBucketPart(j[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,O())return!0;return!1}}class wl{constructor(l,p,w,T,O,j,X,te){this.placement=new Fs(l,p,j,X,te),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=T,this._showCollisionBoxes=O,this._done=!1}isDone(){return this._done}continuePlacement(l,p,w){const T=b.now(),O=()=>!this._forceFullPlacement&&b.now()-T>2;for(;this._currentPlacementIndex>=0;){const j=p[l[this._currentPlacementIndex]],X=this.placement.collisionIndex.transform.zoom;if(j.type==="symbol"&&(!j.minzoom||j.minzoom<=X)&&(!j.maxzoom||j.maxzoom>X)){if(this._inProgressLayer||(this._inProgressLayer=new Va(j)),this._inProgressLayer.continuePlacement(w[j.source],this.placement,this._showCollisionBoxes,j,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const xu=512/o.$/2;class wu{constructor(l,p,w){this.tileID=l,this.bucketInstanceId=w,this._symbolsByKey={};const T=new Map;for(let O=0;O<p.length;O++){const j=p.get(O),X=j.key,te=T.get(X);te?te.push(j):T.set(X,[j])}for(const[O,j]of T){const X={positions:j.map((te=>({x:Math.floor(te.anchorX*xu),y:Math.floor(te.anchorY*xu)}))),crossTileIDs:j.map((te=>te.crossTileID))};if(X.positions.length>128){const te=new o.aH(X.positions.length,16,Uint16Array);for(const{x:le,y:ge}of X.positions)te.add(le,ge);te.finish(),delete X.positions,X.index=te}this._symbolsByKey[O]=X}}getScaledCoordinates(l,p){const{x:w,y:T,z:O}=this.tileID.canonical,{x:j,y:X,z:te}=p.canonical,le=xu/Math.pow(2,te-O),ge=(X*o.$+l.anchorY)*le,Se=T*o.$*xu;return{x:Math.floor((j*o.$+l.anchorX)*le-w*o.$*xu),y:Math.floor(ge-Se)}}findMatches(l,p,w){const T=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let O=0;O<l.length;O++){const j=l.get(O);if(j.crossTileID)continue;const X=this._symbolsByKey[j.key];if(!X)continue;const te=this.getScaledCoordinates(j,p);if(X.index){const le=X.index.range(te.x-T,te.y-T,te.x+T,te.y+T).sort();for(const ge of le){const Se=X.crossTileIDs[ge];if(!w[Se]){w[Se]=!0,j.crossTileID=Se;break}}}else if(X.positions)for(let le=0;le<X.positions.length;le++){const ge=X.positions[le],Se=X.crossTileIDs[le];if(Math.abs(ge.x-te.x)<=T&&Math.abs(ge.y-te.y)<=T&&!w[Se]){w[Se]=!0,j.crossTileID=Se;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:l})=>l))}}class K{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class pe{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const w in this.indexes){const T=this.indexes[w],O={};for(const j in T){const X=T[j];X.tileID=X.tileID.unwrapTo(X.tileID.wrap+p),O[X.tileID.key]=X}this.indexes[w]=O}this.lng=l}addBucket(l,p,w){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let O=0;O<p.symbolInstances.length;O++)p.symbolInstances.get(O).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const T=this.usedCrossTileIDs[l.overscaledZ];for(const O in this.indexes){const j=this.indexes[O];if(Number(O)>l.overscaledZ)for(const X in j){const te=j[X];te.tileID.isChildOf(l)&&te.findMatches(p.symbolInstances,l,T)}else{const X=j[l.scaledTo(Number(O)).key];X&&X.findMatches(p.symbolInstances,l,T)}}for(let O=0;O<p.symbolInstances.length;O++){const j=p.symbolInstances.get(O);j.crossTileID||(j.crossTileID=w.generate(),T[j.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new wu(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const w of p.getCrossTileIDsLists())for(const T of w)delete this.usedCrossTileIDs[l][T]}removeStaleBuckets(l){let p=!1;for(const w in this.indexes){const T=this.indexes[w];for(const O in T)l[T[O].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,T[O]),delete T[O],p=!0)}return p}}class Ye{constructor(){this.layerIndexes={},this.crossTileIDs=new K,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,w){let T=this.layerIndexes[l.id];T===void 0&&(T=this.layerIndexes[l.id]=new pe);let O=!1;const j={};T.handleWrapJump(w);for(const X of p){const te=X.getBucket(l);te&&l.id===te.layerIds[0]&&(te.bucketInstanceId||(te.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(X.tileID,te,this.crossTileIDs)&&(O=!0),j[te.bucketInstanceId]=!0)}return T.removeStaleBuckets(j)&&(O=!0),O}pruneUnusedLayers(l){const p={};l.forEach((w=>{p[w]=!0}));for(const w in this.layerIndexes)p[w]||delete this.layerIndexes[w]}}var Et="void main() {fragColor=vec4(1.0);}";const Ut={prelude:Nt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Nt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Nt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Nt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Nt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Nt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Nt(Et,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Nt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Nt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Nt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Nt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Nt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Nt(Et,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Nt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Nt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Nt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Nt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Nt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Nt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Nt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Nt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Nt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Nt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Nt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Nt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Nt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Nt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Nt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Nt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Nt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Nt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Nt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Nt(R,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=l.match(/in ([\w]+) ([\w]+)/g),T=R.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),j=O?O.concat(T):T,X={};return{fragmentSource:R=R.replace(p,((te,le,ge,Se,be)=>(X[be]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_${be}
in ${ge} ${Se} ${be};
#else
uniform ${ge} ${Se} u_${be};
#endif
`:`
#ifdef HAS_UNIFORM_u_${be}
    ${ge} ${Se} ${be} = u_${be};
#endif
`))),vertexSource:l=l.replace(p,((te,le,ge,Se,be)=>{const Le=Se==="float"?"vec2":"vec4",Ge=be.match(/color/)?"color":Le;return X[be]?le==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
in ${ge} ${Le} a_${be};
out ${ge} ${Se} ${be};
#else
uniform ${ge} ${Se} u_${be};
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = a_${be};
#else
    ${ge} ${Se} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${be} = unpack_mix_${Ge}(a_${be}, u_${be}_t);
#else
    ${ge} ${Se} ${be} = u_${be};
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_${be}
uniform lowp float u_${be}_t;
in ${ge} ${Le} a_${be};
#else
uniform ${ge} ${Se} u_${be};
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${be}
    ${ge} ${Se} ${be} = a_${be};
#else
    ${ge} ${Se} ${be} = u_${be};
#endif
`:`
#ifndef HAS_UNIFORM_u_${be}
    ${ge} ${Se} ${be} = unpack_mix_${Ge}(a_${be}, u_${be}_t);
#else
    ${ge} ${Se} ${be} = u_${be};
#endif
`})),staticAttributes:w,staticUniforms:j}}class Qt{constructor(l,p,w){this.vertexBuffer=l,this.indexBuffer=p,this.segments=w}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Gr=o.aI([{name:"a_pos",type:"Int16",components:2}]);const on="#define PROJECTION_MERCATOR",en="mercator";class hn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return en}get shaderDefine(){return on}get shaderPreludeCode(){return Ut.projectionMercator}get vertexShaderPreludeCode(){return Ut.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,p,w,T,O){if(this._cachedMesh)return this._cachedMesh;const j=new o.aK;j.emplaceBack(0,0),j.emplaceBack(o.$,0),j.emplaceBack(0,o.$),j.emplaceBack(o.$,o.$);const X=l.createVertexBuffer(j,Gr.members),te=o.aL.simpleSegment(0,0,4,2),le=new o.aM;le.emplaceBack(1,0,2),le.emplaceBack(1,2,3);const ge=l.createIndexBuffer(le);return this._cachedMesh=new Qt(X,ge,te),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class nn{constructor(l=0,p=0,w=0,T=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(w)||w<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=w,this.right=T}interpolate(l,p,w){return p.top!=null&&l.top!=null&&(this.top=o.C.number(l.top,p.top,w)),p.bottom!=null&&l.bottom!=null&&(this.bottom=o.C.number(l.bottom,p.bottom,w)),p.left!=null&&l.left!=null&&(this.left=o.C.number(l.left,p.left,w)),p.right!=null&&l.right!=null&&(this.right=o.C.number(l.right,p.right,w)),this}getCenter(l,p){const w=o.ag((this.left+l-this.right)/2,0,l),T=o.ag((this.top+p-this.bottom)/2,0,p);return new o.P(w,T)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new nn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Xn(R,l){if(!R.renderWorldCopies||R.lngRange)return;const p=l.lng-R.center.lng;l.lng+=p>180?-360:p<-180?360:0}function En(R){return Math.max(0,Math.floor(R))}class $n{constructor(l,p,w,T,O,j){this._callbacks=l,this._tileSize=512,this._renderWorldCopies=j===void 0||!!j,this._minZoom=p||0,this._maxZoom=w||22,this._minPitch=T??0,this._maxPitch=O??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=En(this._zoom),this._scale=o.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new nn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,p,w){this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=En(this._zoom),this._scale=o.ae(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new nn(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!w&&l.autoCalculateNearFarZ,p&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){const p=o.aN(l,-180,180)*Math.PI/180;var w,T,O,j,X,te,le,ge,Se;this._bearingInRadians!==p&&(this._unmodified=!1,this._bearingInRadians=p,this._calcMatrices(),this._rotationMatrix=h(),w=this._rotationMatrix,O=-this._bearingInRadians,j=(T=this._rotationMatrix)[0],X=T[1],te=T[2],le=T[3],ge=Math.sin(O),Se=Math.cos(O),w[0]=j*Se+te*ge,w[1]=X*Se+le*ge,w[2]=j*-ge+te*Se,w[3]=X*-ge+le*Se)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){const p=o.ag(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==p&&(this._unmodified=!1,this._pitchInRadians=p,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){const p=l/180*Math.PI;this._rollInRadians!==p&&(this._unmodified=!1,this._rollInRadians=p,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aO(this._fovInRadians)}setFov(l){l=o.ag(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=o.ad(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){const p=this.getConstrained(this._center,l).zoom;this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this._tileZoom=Math.max(0,Math.floor(p)),this._scale=o.ae(p),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,p){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=p,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,w){this._unmodified=!1,this._edgeInsets.interpolate(l,p,w),this._constrain(),this._calcMatrices()}resize(l,p,w=!0){this._width=l,this._height=p,w&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Lt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,o.ah])}getConstrained(l,p){return this._callbacks.getConstrained(l,p)}getCameraQueryGeometry(l,p){if(p.length===1)return[p[0],l];{const{minX:w,minY:T,maxX:O,maxY:j}=o.a1.fromPoints(p).extend(l);return[new o.P(w,T),new o.P(O,T),new o.P(O,j),new o.P(w,j),new o.P(w,T)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:p,zoom:w}=this.getConstrained(this.center,this.zoom);this.setCenter(p),this.setZoom(w),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=o.af(new Float64Array(16));o.N(l,l,[this._width/2,-this._height/2,1]),o.M(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=o.af(new Float64Array(16)),o.N(l,l,[1,-1,1]),o.M(l,l,[-1,-1,0]),o.N(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,p,w,T){const O=w!==void 0?w:this.bearing,j=T=T!==void 0?T:this.pitch,X=o.a0.fromLngLat(l,p),te=-Math.cos(o.ad(j)),le=Math.sin(o.ad(j)),ge=le*Math.sin(o.ad(O)),Se=-le*Math.cos(o.ad(O));let be=this.elevation;const Le=p-be;let Ge;te*Le>=0||Math.abs(te)<.1?(Ge=1e4,be=p+Ge*te):Ge=-Le/te;let lt,st,ut=o.aP(1,X.y),_t=0;do{if(_t+=1,_t>10)break;st=Ge/ut,lt=new o.a0(X.x+ge*st,X.y+Se*st),ut=1/lt.meterInMercatorCoordinateUnits()}while(Math.abs(Ge-st*ut)>1e-12);return{center:lt.toLngLat(),elevation:be,zoom:o.aj(this.height/2/Math.tan(this.fovInRadians/2)/st/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;const p=o.ai(1,this.center.lat)*this.worldSize,w=this.cameraToCenterDistance/p,T=o.a0.fromLngLat(this.center,this.elevation),O=rt(this.center,this.elevation,this.pitch,this.bearing,w);this._elevation=l;const j=this.calculateCenterFromCameraLngLatAlt(O.toLngLat(),o.aP(O.z,T.y),this.bearing,this.pitch);this._elevation=j.elevation,this._center=j.center,this.setZoom(j.zoom)}getCameraPoint(){const l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const l=o.ai(1,this.center.lat)*this.worldSize;return rt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];const p=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/p,l.canonical.y/p,1/p/o.$,1/p/o.$]}}class Ln{constructor(l,p){this.min=l,this.max=p,this.center=o.aQ([],o.aR([],this.min,this.max),.5)}quadrant(l){const p=[l%2==0,l<2],w=o.aS(this.min),T=o.aS(this.max);for(let O=0;O<p.length;O++)w[O]=p[O]?this.min[O]:this.center[O],T[O]=p[O]?this.center[O]:this.max[O];return T[2]=this.max[2],new Ln(w,T)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let p=!0;for(let w=0;w<l.planes.length;w++){const T=this.intersectsPlane(l.planes[w]);if(T===0)return 0;T===1&&(p=!1)}return p?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let p=l[3],w=l[3];for(let T=0;T<3;T++)l[T]>0?(p+=l[T]*this.min[T],w+=l[T]*this.max[T]):(w+=l[T]*this.min[T],p+=l[T]*this.max[T]);return p>=0?2:w<0?0:1}}class $r{distanceToTile2d(l,p,w,T){const O=T.distanceX([l,p]),j=T.distanceY([l,p]);return Math.hypot(O,j)}getWrap(l,p,w){return w}getTileBoundingVolume(l,p,w,T){var O,j;let X=w,te=w;if(T?.terrain){const ge=new o.Z(l.z,p,l.z,l.x,l.y),Se=T.terrain.getMinMaxElevation(ge);X=(O=Se.minElevation)!==null&&O!==void 0?O:w,te=(j=Se.maxElevation)!==null&&j!==void 0?j:w}const le=1<<l.z;return new Ln([p+l.x/le,l.y/le,X],[p+(l.x+1)/le,(l.y+1)/le,te])}allowVariableZoom(l,p){const w=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,T=o.ag(78.5-w/2,0,60);return!!p.terrain||l.pitch>T}allowWorldCopies(){return!0}prepareNextFrame(){}}class xn{constructor(l,p,w){this.points=l,this.planes=p,this.aabb=w}static fromInvProjectionMatrix(l,p=1,w=0,T,O){const j=O?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],X=Math.pow(2,w),te=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((be=>(function(Le,Ge,lt,st){const ut=o.av([],Le,Ge),_t=1/ut[3]/lt*st;return o.aX(ut,ut,[_t,_t,1/ut[3],_t])})(be,l,p,X)));T&&(function(be,Le,Ge,lt){const st=lt?4:0,ut=lt?0:4;let _t=0;const Dt=[],kt=[];for(let It=0;It<4;It++){const Kt=o.aT([],be[It+ut],be[It+st]),Er=o.aY(Kt);o.aQ(Kt,Kt,1/Er),Dt.push(Er),kt.push(Kt)}for(let It=0;It<4;It++){const Kt=o.aZ(be[It+st],kt[It],Ge);_t=Kt!==null&&Kt>=0?Math.max(_t,Kt):Math.max(_t,Dt[It])}const zt=(function(It,Kt){const Er=o.aT([],It[Kt[0]],It[Kt[1]]),vr=o.aT([],It[Kt[2]],It[Kt[1]]),_r=[0,0,0,0];return o.aU(_r,o.aV([],Er,vr)),_r[3]=-o.aW(_r,It[Kt[0]]),_r})(be,Le),$t=(function(It,Kt){const Er=o.a_(It),vr=o.a$([],It,1/Er),_r=o.aT([],Kt,o.aQ([],vr,o.aW(Kt,vr))),Ar=o.a_(_r);if(Ar>0){const gn=Math.sqrt(1-vr[3]*vr[3]),dn=o.aQ([],vr,-vr[3]),Yr=o.aR([],dn,o.aQ([],_r,gn/Ar));return o.b0(Kt,Yr)}return null})(Ge,zt);if($t!==null){const It=$t/o.aW(kt[0],zt);_t=Math.min(_t,It)}for(let It=0;It<4;It++){const Kt=Math.min(_t,Dt[It]);be[It+ut]=[be[It+st][0]+kt[It][0]*Kt,be[It+st][1]+kt[It][1]*Kt,be[It+st][2]+kt[It][2]*Kt,1]}})(te,j[0],T,O);const le=j.map((be=>{const Le=o.aT([],te[be[0]],te[be[1]]),Ge=o.aT([],te[be[2]],te[be[1]]),lt=o.aU([],o.aV([],Le,Ge)),st=-o.aW(lt,te[be[1]]);return lt.concat(st)})),ge=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Se=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const be of te)for(let Le=0;Le<3;Le++)ge[Le]=Math.min(ge[Le],be[Le]),Se[Le]=Math.max(Se[Le],be[Le]);return new xn(te,le,new Ln(ge,Se))}}class si{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,w){return this._helper.interpolatePadding(l,p,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p,w=!0){this._helper.resize(l,p,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,p){}constructor(l,p,w,T,O){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new $n({calcMatrices:()=>{this._calcMatrices()},getConstrained:(j,X)=>this.getConstrained(j,X)},l,p,w,T,O),this._coveringTilesDetailsProvider=new $r}clone(){const l=new si;return l.apply(this),l}apply(l,p,w){this._helper.apply(l,p,w)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){const p=[new o.b1(0,l)];if(this._helper._renderWorldCopies){const w=this.screenPointToMercatorCoordinate(new o.P(0,0)),T=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),O=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),j=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),X=Math.floor(Math.min(w.x,T.x,O.x,j.x)),te=Math.floor(Math.max(w.x,T.x,O.x,j.x)),le=1;for(let ge=X-le;ge<=te+le;ge++)ge!==0&&p.push(new o.b1(ge,l))}return p}getCameraFrustum(){return xn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){const p=this.screenPointToLocation(this.centerPoint,l),w=l?l.getElevationForLngLatZoom(p,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(w)}setLocationAtPoint(l,p){const w=o.ai(this.elevation,this.center.lat),T=this.screenPointToMercatorCoordinateAtZ(p,w),O=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,w),j=o.a0.fromLngLat(l),X=new o.a0(j.x-(T.x-O.x),j.y-(T.y-O.y));this.setCenter(X?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,p){return p?this.coordinatePoint(o.a0.fromLngLat(l),p.getElevationForLngLatZoom(l,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a0.fromLngLat(l))}screenPointToLocation(l,p){var w;return(w=this.screenPointToMercatorCoordinate(l,p))===null||w===void 0?void 0:w.toLngLat()}screenPointToMercatorCoordinate(l,p){if(p){const w=p.pointCoordinate(l);if(w!=null)return w}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,p){const w=p||0,T=[l.x,l.y,0,1],O=[l.x,l.y,1,1];o.av(T,T,this._pixelMatrixInverse),o.av(O,O,this._pixelMatrixInverse);const j=T[3],X=O[3],te=T[1]/j,le=O[1]/X,ge=T[2]/j,Se=O[2]/X,be=ge===Se?0:(w-ge)/(Se-ge);return new o.a0(o.C.number(T[0]/j,O[0]/X,be)/this.worldSize,o.C.number(te,le,be)/this.worldSize,w)}coordinatePoint(l,p=0,w=this._pixelMatrix){const T=[l.x*this.worldSize,l.y*this.worldSize,p,1];return o.av(T,T,w),new o.P(T[0]/T[3],T[1]/T[3])}getBounds(){const l=Math.max(0,this._helper._height/2-Be(this));return new Lt().extend(this.screenPointToLocation(new o.P(0,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(l,p){return p?p.pointCoordinate(l)!=null:l.y>this.height/2-Be(this)}calculatePosMatrix(l,p=!1,w){var T;const O=(T=l.key)!==null&&T!==void 0?T:o.b2(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),j=p?this._alignedPosMatrixCache:this._posMatrixCache;if(j.has(O)){const le=j.get(O);return w?le.f32:le.f64}const X=Ne(l,this.worldSize);o.O(X,p?this._alignedProjMatrix:this._viewProjMatrix,X);const te={f64:X,f32:new Float32Array(X)};return j.set(O,te),w?te.f32:te.f64}calculateFogMatrix(l){const p=l.key,w=this._fogMatrixCacheF32;if(w.has(p))return w.get(p);const T=Ne(l,this.worldSize);return o.O(T,this._fogMatrix,T),w.set(p,new Float32Array(T)),w.get(p)}getConstrained(l,p){p=o.ag(+p,this.minZoom,this.maxZoom);const w={center:new o.S(l.lng,l.lat),zoom:p};let T=this._helper._lngRange;this._helper._renderWorldCopies||T!==null||(T=[-179.9999999999,180-1e-10]);const O=this.tileSize*o.ae(w.zoom);let j=0,X=O,te=0,le=O,ge=0,Se=0;const{x:be,y:Le}=this.size;if(this._helper._latRange){const Dt=this._helper._latRange;j=o.U(Dt[1])*O,X=o.U(Dt[0])*O,X-j<Le&&(ge=Le/(X-j))}T&&(te=o.aN(o.V(T[0])*O,0,O),le=o.aN(o.V(T[1])*O,0,O),le<te&&(le+=O),le-te<be&&(Se=be/(le-te)));const{x:Ge,y:lt}=Tt(O,l);let st,ut;const _t=Math.max(Se||0,ge||0);if(_t){const Dt=new o.P(Se?(le+te)/2:Ge,ge?(X+j)/2:lt);return w.center=Oe(O,Dt).wrap(),w.zoom+=o.aj(_t),w}if(this._helper._latRange){const Dt=Le/2;lt-Dt<j&&(ut=j+Dt),lt+Dt>X&&(ut=X-Dt)}if(T){const Dt=(te+le)/2;let kt=Ge;this._helper._renderWorldCopies&&(kt=o.aN(Ge,Dt-O/2,Dt+O/2));const zt=be/2;kt-zt<te&&(st=te+zt),kt+zt>le&&(st=le-zt)}if(st!==void 0||ut!==void 0){const Dt=new o.P(st??Ge,ut??lt);w.center=Oe(O,Dt).wrap()}return w}calculateCenterFromCameraLngLatAlt(l,p,w,T){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,w,T)}_calculateNearFarZIfNeeded(l,p,w){if(!this._helper.autoCalculateNearFarZ)return;const T=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),O=l-T*this._helper._pixelPerMeter/Math.cos(p),j=T<0?O:l,X=Math.PI/2+this.pitchInRadians,te=o.ad(this.fov)*(Math.abs(Math.cos(o.ad(this.roll)))*this.height+Math.abs(Math.sin(o.ad(this.roll)))*this.width)/this.height*(.5+w.y/this.height),le=Math.sin(te)*j/Math.sin(o.ag(Math.PI-X-te,.01,Math.PI-.01)),ge=Be(this),Se=Math.atan(ge/this._helper.cameraToCenterDistance),be=o.ad(.75),Le=Se>be?2*Se*(.5+w.y/(2*ge)):be,Ge=Math.sin(Le)*j/Math.sin(o.ag(Math.PI-X-Le,.01,Math.PI-.01)),lt=Math.min(le,Ge);this._helper._farZ=1.01*(Math.cos(Math.PI/2-p)*lt+j),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const l=this.centerOffset,p=Tt(this.worldSize,this.center),w=p.x,T=p.y;this._helper._pixelPerMeter=o.ai(1,this.center.lat)*this.worldSize;const O=o.ad(Math.min(this.pitch,Gt)),j=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(O));let X;this._calculateNearFarZIfNeeded(j,O,l),X=new Float64Array(16),o.b3(X,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.ap(this._invProjMatrix,X),X[8]=2*-l.x/this._helper._width,X[9]=2*l.y/this._helper._height,this._projectionMatrix=o.b4(X),o.N(X,X,[1,-1,1]),o.M(X,X,[0,0,-this._helper.cameraToCenterDistance]),o.b5(X,X,-this.rollInRadians),o.b6(X,X,this.pitchInRadians),o.b5(X,X,-this.bearingInRadians),o.M(X,X,[-w,-T,0]),this._mercatorMatrix=o.N([],X,[this.worldSize,this.worldSize,this.worldSize]),o.N(X,X,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,X),o.M(X,X,[0,0,-this.elevation]),this._viewProjMatrix=X,this._invViewProjMatrix=o.ap([],X);const te=[0,0,-1,1];o.av(te,te,this._invViewProjMatrix),this._cameraPosition=[te[0]/te[3],te[1]/te[3],te[2]/te[3]],this._fogMatrix=new Float64Array(16),o.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,j,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-w,-T,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,X);const le=this._helper._width%2/2,ge=this._helper._height%2/2,Se=Math.cos(this.bearingInRadians),be=Math.sin(-this.bearingInRadians),Le=w-Math.round(w)+Se*le+be*ge,Ge=T-Math.round(T)+Se*ge+be*le,lt=new Float64Array(X);if(o.M(lt,lt,[Le>.5?Le-1:Le,Ge>.5?Ge-1:Ge,0]),this._alignedProjMatrix=lt,X=o.ap(new Float64Array(16),this._pixelMatrix),!X)throw new Error("failed to invert matrix");this._pixelMatrixInverse=X,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const l=this.screenPointToMercatorCoordinate(new o.P(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.av(p,p,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const l=o.ai(1,this.center.lat)*this.worldSize;return rt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,p){const w=o.a0.fromLngLat(l),T=[w.x*this.worldSize,w.y*this.worldSize,p,1];return o.av(T,T,this._viewProjMatrix),T[2]/T[3]}getProjectionData(l){const{overscaledTileID:p,aligned:w,applyTerrainMatrix:T}=l,O=this._helper.getMercatorTileCoordinates(p),j=p?this.calculatePosMatrix(p,w,!0):null;let X;return X=p&&p.terrainRttPosMatrix32f&&T?p.terrainRttPosMatrix32f:j||o.b7(),{mainMatrix:X,tileMercatorCoords:O,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:X}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,p,w){return 1}transformLightDirection(l){return o.aS(l)}getRayDirectionFromPixel(l){throw new Error("Not implemented.")}projectTileCoordinates(l,p,w,T){const O=this.calculatePosMatrix(w);let j;T?(j=[l,p,T(l,p),1],o.av(j,j,O)):(j=[l,p,0,1],_a(j,j,O));const X=j[3];return{point:new o.P(j[0]/X,j[1]/X),signedDistanceFromCamera:X,isOccluded:!1}}populateCache(l){for(const p of l)this.calculatePosMatrix(p)}getMatrixForModel(l,p){const w=o.a0.fromLngLat(l,p),T=w.meterInMercatorCoordinateUnits(),O=o.b8();return o.M(O,O,[w.x,w.y,w.z]),o.b5(O,O,Math.PI),o.b6(O,O,Math.PI/2),o.N(O,O,[-T,T,T]),O}getProjectionDataForCustomLayer(l=!0){const p=new o.Z(0,0,0,0,0),w=this.getProjectionData({overscaledTileID:p,applyGlobeMatrix:l}),T=Ne(p,this.worldSize);o.O(T,this._viewProjMatrix,T),w.tileMercatorCoords=[0,0,1,1];const O=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],j=o.b9();return o.N(j,T,O),w.fallbackMatrix=j,w.mainMatrix=j,w}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function Li(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function wi(R){if(R.useSlerp)if(R.k<1){const l=o.ba(R.startEulerAngles.roll,R.startEulerAngles.pitch,R.startEulerAngles.bearing),p=o.ba(R.endEulerAngles.roll,R.endEulerAngles.pitch,R.endEulerAngles.bearing),w=new Float64Array(4);o.bb(w,l,p,R.k);const T=o.bc(w);R.tr.setRoll(T.roll),R.tr.setPitch(T.pitch),R.tr.setBearing(T.bearing)}else R.tr.setRoll(R.endEulerAngles.roll),R.tr.setPitch(R.endEulerAngles.pitch),R.tr.setBearing(R.endEulerAngles.bearing);else R.tr.setRoll(o.C.number(R.startEulerAngles.roll,R.endEulerAngles.roll,R.k)),R.tr.setPitch(o.C.number(R.startEulerAngles.pitch,R.endEulerAngles.pitch,R.k)),R.tr.setBearing(o.C.number(R.startEulerAngles.bearing,R.endEulerAngles.bearing,R.k))}function Vi(R,l,p,w,T){const O=T.padding,j=Tt(T.worldSize,p.getNorthWest()),X=Tt(T.worldSize,p.getNorthEast()),te=Tt(T.worldSize,p.getSouthEast()),le=Tt(T.worldSize,p.getSouthWest()),ge=o.ad(-w),Se=j.rotate(ge),be=X.rotate(ge),Le=te.rotate(ge),Ge=le.rotate(ge),lt=new o.P(Math.max(Se.x,be.x,Ge.x,Le.x),Math.max(Se.y,be.y,Ge.y,Le.y)),st=new o.P(Math.min(Se.x,be.x,Ge.x,Le.x),Math.min(Se.y,be.y,Ge.y,Le.y)),ut=lt.sub(st),_t=(T.width-(O.left+O.right+l.left+l.right))/ut.x,Dt=(T.height-(O.top+O.bottom+l.top+l.bottom))/ut.y;if(Dt<0||_t<0)return void Li();const kt=Math.min(o.aj(T.scale*Math.min(_t,Dt)),R.maxZoom),zt=o.P.convert(R.offset),$t=new o.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(o.ad(w)),It=zt.add($t).mult(T.scale/o.ae(kt));return{center:Oe(T.worldSize,j.add(te).div(2).sub(It)),zoom:kt,bearing:w}}class Bi{get useGlobeControls(){return!1}handlePanInertia(l,p){return{easingOffset:l,easingCenter:p.center}}handleMapControlsRollPitchBearingZoom(l,p){l.bearingDelta&&p.setBearing(p.bearing+l.bearingDelta),l.pitchDelta&&p.setPitch(p.pitch+l.pitchDelta),l.rollDelta&&p.setRoll(p.roll+l.rollDelta),l.zoomDelta&&p.setZoom(p.zoom+l.zoomDelta)}handleMapControlsPan(l,p,w){l.around.distSqr(p.centerPoint)<.01||p.setLocationAtPoint(w,l.around)}cameraForBoxAndBearing(l,p,w,T,O){return Vi(l,p,w,T,O)}handleJumpToCenterZoom(l,p){l.zoom!==(p.zoom!==void 0?+p.zoom:l.zoom)&&l.setZoom(+p.zoom),p.center!==void 0&&l.setCenter(o.S.convert(p.center))}handleEaseTo(l,p){const w=l.zoom,T=l.padding,O={roll:l.roll,pitch:l.pitch,bearing:l.bearing},j={roll:p.roll===void 0?l.roll:p.roll,pitch:p.pitch===void 0?l.pitch:p.pitch,bearing:p.bearing===void 0?l.bearing:p.bearing},X=p.zoom!==void 0,te=!l.isPaddingEqual(p.padding);let le=!1;const ge=X?+p.zoom:l.zoom;let Se=l.centerPoint.add(p.offsetAsPoint);const be=l.screenPointToLocation(Se),{center:Le,zoom:Ge}=l.getConstrained(o.S.convert(p.center||be),ge??w);Xn(l,Le);const lt=Tt(l.worldSize,be),st=Tt(l.worldSize,Le).sub(lt),ut=o.ae(Ge-w);return le=Ge!==w,{easeFunc:_t=>{if(le&&l.setZoom(o.C.number(w,Ge,_t)),o.bd(O,j)||wi({startEulerAngles:O,endEulerAngles:j,tr:l,k:_t,useSlerp:O.roll!=j.roll}),te&&(l.interpolatePadding(T,p.padding,_t),Se=l.centerPoint.add(p.offsetAsPoint)),p.around)l.setLocationAtPoint(p.around,p.aroundPoint);else{const Dt=o.ae(l.zoom-w),kt=Ge>w?Math.min(2,ut):Math.max(.5,ut),zt=Math.pow(kt,1-_t),$t=Oe(l.worldSize,lt.add(st.mult(_t*zt)).mult(Dt));l.setLocationAtPoint(l.renderWorldCopies?$t.wrap():$t,Se)}},isZooming:le,elevationCenter:Le}}handleFlyTo(l,p){const w=p.zoom!==void 0,T=l.zoom,O=l.getConstrained(o.S.convert(p.center||p.locationAtOffset),w?+p.zoom:T),j=O.center,X=O.zoom;Xn(l,j);const te=Tt(l.worldSize,p.locationAtOffset),le=Tt(l.worldSize,j).sub(te),ge=le.mag(),Se=o.ae(X-T);let be;if(p.minZoom!==void 0){const Le=Math.min(+p.minZoom,T,X),Ge=l.getConstrained(j,Le).zoom;be=o.ae(Ge-T)}return{easeFunc:(Le,Ge,lt,st)=>{l.setZoom(Le===1?X:T+o.aj(Ge));const ut=Le===1?j:Oe(l.worldSize,te.add(le.mult(lt)).mult(Ge));l.setLocationAtPoint(l.renderWorldCopies?ut.wrap():ut,st)},scaleOfZoom:Se,targetCenter:j,scaleOfMinZoom:be,pixelPathLength:ge}}}class Pn{constructor(l,p,w){this.blendFunction=l,this.blendColor=p,this.mask=w}}Pn.Replace=[1,0],Pn.disabled=new Pn(Pn.Replace,o.be.transparent,[!1,!1,!1,!1]),Pn.unblended=new Pn(Pn.Replace,o.be.transparent,[!0,!0,!0,!0]),Pn.alphaBlended=new Pn([1,771],o.be.transparent,[!0,!0,!0,!0]);const $a=2305;class ii{constructor(l,p,w){this.enable=l,this.mode=p,this.frontFace=w}}ii.disabled=new ii(!1,1029,$a),ii.backCCW=new ii(!0,1029,$a),ii.frontCCW=new ii(!0,1028,$a);class Wn{constructor(l,p,w){this.func=l,this.mask=p,this.range=w}}Wn.ReadOnly=!1,Wn.ReadWrite=!0,Wn.disabled=new Wn(519,Wn.ReadOnly,[0,1]);const ws=7680;class In{constructor(l,p,w,T,O,j){this.test=l,this.ref=p,this.mask=w,this.fail=T,this.depthFail=O,this.pass=j}}In.disabled=new In({func:519,mask:0},0,0,ws,ws,ws);const Sl=new WeakMap;function Na(R){var l;if(Sl.has(R))return Sl.get(R);{const p=(l=R.getParameter(R.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Sl.set(R,p),p}}class Ys{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;const p=l.context,w=p.gl;this._texFormat=w.RGBA,this._texType=w.UNSIGNED_BYTE;const T=new o.aK;T.emplaceBack(-1,-1),T.emplaceBack(2,-1),T.emplaceBack(-1,2);const O=new o.aM;O.emplaceBack(0,1,2),this._fullscreenTriangle=new Qt(p.createVertexBuffer(T,Gr.members),p.createIndexBuffer(O),o.aL.simpleSegment(0,0,T.length,O.length)),this._resultBuffer=new Uint8Array(4),p.activeTexture.set(w.TEXTURE1);const j=w.createTexture();w.bindTexture(w.TEXTURE_2D,j),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texImage2D(w.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=p.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(j),Na(w)&&(this._pbo=w.createBuffer(),w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.bufferData(w.PIXEL_PACK_BUFFER,4,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null))}destroy(){const l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,p){const w=this._updateCount;return this._readbackQueue?w>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():w>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,p),this._updateCount++,this._measuredError}_bindFramebuffer(){const l=this._cachedRenderContext.context,p=l.gl;l.activeTexture.set(p.TEXTURE1),p.bindTexture(p.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,p){const w=this._cachedRenderContext.context,T=w.gl;if(this._bindFramebuffer(),w.viewport.set([0,0,this._texWidth,this._texHeight]),w.clear({color:o.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(w,T.TRIANGLES,Wn.disabled,In.disabled,Pn.unblended,ii.disabled,((O,j)=>({u_input:O,u_output_expected:j}))(l,p),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Na(T)){T.bindBuffer(T.PIXEL_PACK_BUFFER,this._pbo),T.readBuffer(T.COLOR_ATTACHMENT0),T.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),T.bindBuffer(T.PIXEL_PACK_BUFFER,null);const O=T.fenceSync(T.SYNC_GPU_COMMANDS_COMPLETE,0);T.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:O}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Na(l)){const p=l.clientWaitSync(this._readbackQueue.sync,0,0);if(p===l.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(p===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ys._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let p=0;return p+=l[0]/256,p+=l[1]/65536,p+=l[2]/16777216,l[3]<127&&(p=-p),p/128}}const lo=o.$/128;function iu(R,l){const p=R.granularity!==void 0?Math.max(R.granularity,1):1,w=p+(R.generateBorders?2:0),T=p+(R.extendToNorthPole||R.generateBorders?1:0)+(R.extendToSouthPole||R.generateBorders?1:0),O=w+1,j=T+1,X=R.generateBorders?-1:0,te=R.generateBorders||R.extendToNorthPole?-1:0,le=p+(R.generateBorders?1:0),ge=p+(R.generateBorders||R.extendToSouthPole?1:0),Se=O*j,be=w*T*6,Le=O*j>65536;if(Le&&l==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ge=Le||l==="32bit",lt=new Int16Array(2*Se);let st=0;for(let Dt=te;Dt<=ge;Dt++)for(let kt=X;kt<=le;kt++){let zt=kt/p*o.$;kt===-1&&(zt=-64),kt===p+1&&(zt=o.$+lo);let $t=Dt/p*o.$;Dt===-1&&($t=R.extendToNorthPole?o.bg:-64),Dt===p+1&&($t=R.extendToSouthPole?o.bh:o.$+lo),lt[st++]=zt,lt[st++]=$t}const ut=Ge?new Uint32Array(be):new Uint16Array(be);let _t=0;for(let Dt=0;Dt<T;Dt++)for(let kt=0;kt<w;kt++){const zt=kt+1+Dt*O,$t=kt+(Dt+1)*O,It=kt+1+(Dt+1)*O;ut[_t++]=kt+Dt*O,ut[_t++]=$t,ut[_t++]=zt,ut[_t++]=zt,ut[_t++]=$t,ut[_t++]=It}return{vertices:lt.buffer.slice(0),indices:ut.buffer.slice(0),uses32bitIndices:Ge}}const os=new o.aJ({fill:new o.bi(128,2),line:new o.bi(512,0),tile:new o.bi(128,32),stencil:new o.bi(128,1),circle:3});class ss{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ut.projectionGlobe}get vertexShaderPreludeCode(){return Ut.projectionMercator.vertexSource}get subdivisionGranularity(){return os}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new Ys(l));const p=o.U(this._errorQueryLatitudeDegrees),w=2*Math.atan(Math.exp(Math.PI-p*Math.PI*2))-.5*Math.PI,T=this._errorMeasurement.updateErrorLoop(p,w),O=b.now();T!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=T,this._errorMeasurementLastChangeTime=O);const j=Math.min(Math.max((O-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bk(j))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?"b":""}${l.extendToNorthPole?"n":""}${l.extendToSouthPole?"s":""}`}getMeshFromTileID(l,p,w,T,O){const j=(O==="stencil"?os.stencil:os.tile).getGranularityForZoomLevel(p.z);return this._getMesh(l,{granularity:j,generateBorders:w,extendToNorthPole:p.y===0&&T,extendToSouthPole:p.y===(1<<p.z)-1&&T})}_getMesh(l,p){const w=this._getMeshKey(p);if(w in this._tileMeshCache)return this._tileMeshCache[w];const T=(function(O,j){const X=iu(j,"16bit"),te=o.aK.deserialize({arrayBuffer:X.vertices,length:X.vertices.byteLength/2/2}),le=o.aM.deserialize({arrayBuffer:X.indices,length:X.indices.byteLength/2/3});return new Qt(O.createVertexBuffer(te,Gr.members),O.createIndexBuffer(le),o.aL.simpleSegment(0,0,te.length,le.length))})(l,p);return this._tileMeshCache[w]=T,T}recalculate(l){}hasTransition(){const l=b.now();let p=!1;return p=p||(l-this._errorMeasurementLastChangeTime)/1e3<.7,p=p||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,p}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}const zl=new o.r({type:new o.D(o.v.projection.type)});class Zs extends o.E{constructor(l){super(),this._transitionable=new o.t(zl),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new hn,this._verticalPerspectiveProjection=new ss}get transitionState(){const l=this.properties.get("type");if(typeof l=="string"&&l==="mercator")return 0;if(typeof l=="string"&&l==="vertical-perspective")return 1;if(l instanceof o.bl){if(l.from==="vertical-perspective"&&l.to==="mercator")return 1-l.transition;if(l.from==="mercator"&&l.to==="vertical-perspective")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,p,w,T,O){return this.currentProjection.getMeshFromTileID(l,p,w,T,O)}setProjection(l){this._transitionable.setValue("type",l?.type||"mercator")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function Ja(R){const l=La(R.worldSize,R.center.lat);return 2*Math.PI*l}function uo(R,l,p,w,T){const O=1/(1<<T),j=l/o.$*O+w*O,X=o.bn((R/o.$*O+p*O)*Math.PI*2+Math.PI,2*Math.PI),te=2*Math.atan(Math.exp(Math.PI-j*Math.PI*2))-.5*Math.PI,le=Math.cos(te),ge=new Float64Array(3);return ge[0]=Math.sin(X)*le,ge[1]=Math.sin(te),ge[2]=Math.cos(X)*le,ge}function sa(R){return(function(l,p){const w=Math.cos(p),T=new Float64Array(3);return T[0]=Math.sin(l)*w,T[1]=Math.sin(p),T[2]=Math.cos(l)*w,T})(R.lng*Math.PI/180,R.lat*Math.PI/180)}function La(R,l){return R/(2*Math.PI)/Math.cos(l*Math.PI/180)}function se(R){const l=Math.asin(R[1])/Math.PI*180,p=Math.sqrt(R[0]*R[0]+R[2]*R[2]);if(p>1e-6){const w=R[0]/p,T=Math.acos(R[2]/p),O=(w>0?T:-T)/Math.PI*180;return new o.S(o.aN(O,-180,180),l)}return new o.S(0,l)}function qe(R){return Math.cos(R*Math.PI/180)}function dt(R,l){const p=qe(R),w=qe(l);return o.aj(w/p)}function Vt(R,l){const p=R.rotate(l.bearingInRadians),w=l.zoom+dt(l.center.lat,0),T=o.bj(1/qe(l.center.lat),1/qe(Math.min(Math.abs(l.center.lat),60)),o.bm(w,7,3,0,1)),O=360/Ja({worldSize:l.worldSize,center:{lat:l.center.lat}});return new o.S(l.center.lng-p.x*O*T,o.ag(l.center.lat+p.y*O,-85.051129,o.ah))}function sr(R){const l=.5*R,p=Math.sin(l),w=Math.cos(l);return Math.log(p+w)-Math.log(w-p)}function Vr(R,l,p,w){const T=R.lat+p*w;if(Math.abs(p)>1){const O=(Math.sign(R.lat+p)!==Math.sign(R.lat)?-Math.abs(R.lat):Math.abs(R.lat))*Math.PI/180,j=Math.abs(R.lat+p)*Math.PI/180,X=sr(O+w*(j-O)),te=sr(O),le=sr(j);return new o.S(R.lng+l*((X-te)/(le-te)),T)}return new o.S(R.lng+l*w,T)}class rn{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;const l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,p,w,T){const O=`${l.z}_${l.x}_${l.y}_${T?.terrain?"t":""}`,j=this._cache.get(O);if(j)return j;const X=this._cachePrevious.get(O);if(X)return this._cache.set(O,X),X;const te=this._boundingVolumeFactory(l,p,w,T);return this._cache.set(O,te),this._hadAnyChanges=!0,te}}class kn{constructor(l,p,w,T){this.min=w,this.max=T,this.points=l,this.planes=p}static fromAabb(l,p){const w=[];for(let T=0;T<8;T++)w.push([1&~T?l[0]:p[0],(T>>1&1)==1?p[1]:l[1],(T>>2&1)==1?p[2]:l[2]]);return new kn(w,[[-1,0,0,p[0]],[1,0,0,-l[0]],[0,-1,0,p[1]],[0,1,0,-l[1]],[0,0,-1,p[2]],[0,0,1,-l[2]]],l,p)}static fromCenterSizeAngles(l,p,w){const T=o.bq([],w[0],w[1],w[2]),O=o.br([],[p[0],0,0],T),j=o.br([],[0,p[1],0],T),X=o.br([],[0,0,p[2]],T),te=[...l],le=[...l];for(let Se=0;Se<8;Se++)for(let be=0;be<3;be++){const Le=l[be]+O[be]*(1&~Se?-1:1)+j[be]*((Se>>1&1)==1?1:-1)+X[be]*((Se>>2&1)==1?1:-1);te[be]=Math.min(te[be],Le),le[be]=Math.max(le[be],Le)}const ge=[];for(let Se=0;Se<8;Se++){const be=[...l];o.aR(be,be,o.aQ([],O,1&~Se?-1:1)),o.aR(be,be,o.aQ([],j,(Se>>1&1)==1?1:-1)),o.aR(be,be,o.aQ([],X,(Se>>2&1)==1?1:-1)),ge.push(be)}return new kn(ge,[[...O,-o.aW(O,ge[0])],[...j,-o.aW(j,ge[0])],[...X,-o.aW(X,ge[0])],[-O[0],-O[1],-O[2],-o.aW(O,ge[7])],[-j[0],-j[1],-j[2],-o.aW(j,ge[7])],[-X[0],-X[1],-X[2],-o.aW(X,ge[7])]],te,le)}intersectsFrustum(l){let p=!0;const w=this.points.length,T=this.planes.length,O=l.planes.length,j=l.points.length;for(let X=0;X<O;X++){const te=l.planes[X];let le=0;for(let ge=0;ge<w;ge++){const Se=this.points[ge];te[0]*Se[0]+te[1]*Se[1]+te[2]*Se[2]+te[3]>=0&&le++}if(le===0)return 0;le<w&&(p=!1)}if(p)return 2;for(let X=0;X<T;X++){const te=this.planes[X];let le=0;for(let ge=0;ge<j;ge++){const Se=l.points[ge];te[0]*Se[0]+te[1]*Se[1]+te[2]*Se[2]+te[3]>=0&&le++}if(le===0)return 0}return 1}intersectsPlane(l){const p=this.points.length;let w=0;for(let T=0;T<p;T++){const O=this.points[T];l[0]*O[0]+l[1]*O[1]+l[2]*O[2]+l[3]>=0&&w++}return w===p?2:w===0?0:1}}function Vn(R,l,p){const w=R-l;return w<0?-w:Math.max(0,w-p)}function ci(R,l,p,w,T){const O=R-p;let j;return j=O<0?Math.min(-O,1+O-T):O>1?Math.min(Math.max(O-T,0),1-O):0,Math.max(j,Vn(l,w,T))}class Ti{constructor(){this._boundingVolumeCache=new rn(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,p,w,T){const O=1<<w.z,j=1/O,X=w.x/O,te=w.y/O;let le=2;return le=Math.min(le,ci(l,p,X,te,j)),le=Math.min(le,ci(l,p,X+.5,-te-j,j)),le=Math.min(le,ci(l,p,X+.5,2-te-j,j)),le}getWrap(l,p,w){const T=1<<p.z,O=1/T,j=p.x/T,X=Vn(l.x,j,O),te=Vn(l.x,j-1,O),le=Vn(l.x,j+1,O),ge=Math.min(X,te,le);return ge===le?1:ge===te?-1:0}allowVariableZoom(l,p){return Zt(l,p)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,p,w,T){return this._boundingVolumeCache.getTileBoundingVolume(l,p,w,T)}_computeTileBoundingVolume(l,p,w,T){var O,j;let X=w,te=w;if(T?.terrain){const le=new o.Z(l.z,p,l.z,l.x,l.y),ge=T.terrain.getMinMaxElevation(le);X=(O=ge.minElevation)!==null&&O!==void 0?O:w,te=(j=ge.maxElevation)!==null&&j!==void 0?j:w}if(X/=o.bt,te/=o.bt,X+=1,te+=1,l.z<=0)return kn.fromAabb([-te,-te,-te],[te,te,te]);if(l.z===1)return kn.fromAabb([l.x===0?-te:0,l.y===0?0:-te,-te],[l.x===0?0:te,l.y===0?te:0,te]);{const le=[uo(0,0,l.x,l.y,l.z),uo(o.$,0,l.x,l.y,l.z),uo(o.$,o.$,l.x,l.y,l.z),uo(0,o.$,l.x,l.y,l.z)],ge=[];for(const _r of le)ge.push(o.aQ([],_r,te));if(te!==X)for(const _r of le)ge.push(o.aQ([],_r,X));l.y===0&&ge.push([0,1,0]),l.y===(1<<l.z)-1&&ge.push([0,-1,0]);const Se=[1,1,1],be=[-1,-1,-1];for(const _r of ge)for(let Ar=0;Ar<3;Ar++)Se[Ar]=Math.min(Se[Ar],_r[Ar]),be[Ar]=Math.max(be[Ar],_r[Ar]);const Le=uo(o.$/2,o.$/2,l.x,l.y,l.z),Ge=o.aV([],[0,1,0],Le);o.aU(Ge,Ge);const lt=o.aV([],Le,Ge);o.aU(lt,lt);const st=o.aV([],le[2],le[1]);o.aU(st,st);const ut=o.aV([],le[0],le[3]);o.aU(ut,ut),ge.push(o.aQ([],Le,te)),l.y>=(1<<l.z)/2&&ge.push(o.aQ([],uo(o.$/2,0,l.x,l.y,l.z),te)),l.y<(1<<l.z)/2&&ge.push(o.aQ([],uo(o.$/2,o.$,l.x,l.y,l.z),te));const _t=li(Le,ge),Dt=li(lt,ge),kt=[-Le[0],-Le[1],-Le[2],_t.max],zt=[Le[0],Le[1],Le[2],-_t.min],$t=[-lt[0],-lt[1],-lt[2],Dt.max],It=[lt[0],lt[1],lt[2],-Dt.min],Kt=[...st,0],Er=[...ut,0],vr=[];return l.y===0?vr.push(o.bs(Er,Kt,kt),o.bs(Er,Kt,zt)):vr.push(o.bs($t,Kt,kt),o.bs($t,Kt,zt),o.bs($t,Er,kt),o.bs($t,Er,zt)),l.y===(1<<l.z)-1?vr.push(o.bs(Er,Kt,kt),o.bs(Er,Kt,zt)):vr.push(o.bs(It,Kt,kt),o.bs(It,Kt,zt),o.bs(It,Er,kt),o.bs(It,Er,zt)),new kn(vr,[kt,zt,$t,It,Kt,Er],Se,be)}}}function li(R,l){let p=1/0,w=-1/0;for(const T of l){const O=o.aW(R,T);p=Math.min(p,O),w=Math.max(w,O)}return{min:p,max:w}}class $i{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,w){return this._helper.interpolatePadding(l,p,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p){this._helper.resize(l,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(){this._cachedClippingPlane=o.bu(),this._projectionMatrix=o.b8(),this._globeViewProjMatrix32f=o.b7(),this._globeViewProjMatrixNoCorrection=o.b8(),this._globeViewProjMatrixNoCorrectionInverted=o.b8(),this._globeProjMatrixInverted=o.b8(),this._cameraPosition=o.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new $n({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,p)=>this.getConstrained(l,p)}),this._coveringTilesDetailsProvider=new Ti}clone(){const l=new $i;return l.apply(this),l}apply(l,p){this._globeLatitudeErrorCorrectionRadians=p||0,this._helper.apply(l)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const l=o.bo();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){const{overscaledTileID:p,applyGlobeMatrix:w}=l,T=this._helper.getMercatorTileCoordinates(p);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:T,clippingPlane:this._cachedClippingPlane,projectionTransition:w?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){const p=this.pitchInRadians,w=this.cameraToCenterDistance/l,T=Math.sin(p)*w,O=Math.cos(p)*w+1,j=1/Math.sqrt(T*T+O*O)*1;let X=-T,te=O;const le=Math.sqrt(X*X+te*te);X/=le,te/=le;const ge=[0,X,te];o.bv(ge,ge,[0,0,0],-this.bearingInRadians),o.bw(ge,ge,[0,0,0],-1*this.center.lat*Math.PI/180),o.bx(ge,ge,[0,0,0],this.center.lng*Math.PI/180);const Se=1/o.aY(ge);return o.aQ(ge,ge,Se),[...ge,-j*Se]}isLocationOccluded(l){return!this.isSurfacePointVisible(sa(l))}transformLightDirection(l){const p=this._helper._center.lng*Math.PI/180,w=this._helper._center.lat*Math.PI/180,T=Math.cos(w),O=[Math.sin(p)*T,Math.sin(w),Math.cos(p)*T],j=[O[2],0,-O[0]],X=[0,0,0];o.aV(X,j,O),o.aU(j,j),o.aU(X,X);const te=[0,0,0];return o.aU(te,[j[0]*l[0]+X[0]*l[1]+O[0]*l[2],j[1]*l[0]+X[1]*l[1]+O[1]*l[2],j[2]*l[0]+X[2]*l[1]+O[2]*l[2]]),te}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,p,w){const T=(function(X,te,le){const ge=1/(1<<le.z);return new o.a0(X/o.$*ge+le.x*ge,te/o.$*ge+le.y*ge)})(l,p,w.canonical),O=(j=T.y,[o.bn(T.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-j*Math.PI*2))-.5*Math.PI]);var j;return this.getCircleRadiusCorrection()/Math.cos(O[1])}projectTileCoordinates(l,p,w,T){const O=w.canonical,j=uo(l,p,O.x,O.y,O.z),X=1+(T?T(l,p):0)/o.bt,te=[j[0]*X,j[1]*X,j[2]*X,1];o.av(te,te,this._globeViewProjMatrixNoCorrection);const le=this._cachedClippingPlane,ge=le[0]*j[0]+le[1]*j[1]+le[2]*j[2]+le[3]<0;return{point:new o.P(te[0]/te[3],te[1]/te[3]),signedDistanceFromCamera:te[3],isOccluded:ge}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const l=La(this.worldSize,this.center.lat),p=o.b9(),w=o.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),o.b3(p,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const T=this.centerOffset;p[8]=2*-T.x/this._helper._width,p[9]=2*T.y/this._helper._height,this._projectionMatrix=o.b4(p),this._globeProjMatrixInverted=o.b9(),o.ap(this._globeProjMatrixInverted,p),o.M(p,p,[0,0,-this.cameraToCenterDistance]),o.b5(p,p,this.rollInRadians),o.b6(p,p,-this.pitchInRadians),o.b5(p,p,this.bearingInRadians),o.M(p,p,[0,0,-l]);const O=o.bo();O[0]=l,O[1]=l,O[2]=l,o.b6(w,p,this.center.lat*Math.PI/180),o.by(w,w,-this.center.lng*Math.PI/180),o.N(w,w,O),this._globeViewProjMatrixNoCorrection=w,o.b6(p,p,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.by(p,p,-this.center.lng*Math.PI/180),o.N(p,p,O),this._globeViewProjMatrix32f=new Float32Array(p),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),o.ap(this._globeViewProjMatrixNoCorrectionInverted,w);const j=o.bo();this._cameraPosition=o.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/l,o.bv(this._cameraPosition,this._cameraPosition,j,-this.rollInRadians),o.bw(this._cameraPosition,this._cameraPosition,j,this.pitchInRadians),o.bv(this._cameraPosition,this._cameraPosition,j,-this.bearingInRadians),o.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bw(this._cameraPosition,this._cameraPosition,j,-this.center.lat*Math.PI/180),o.bx(this._cameraPosition,this._cameraPosition,j,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);const X=o.b4(this._globeViewProjMatrixNoCorrectionInverted);o.N(X,X,[1,1,-1]),this._cachedFrustum=xn.fromInvProjectionMatrix(X,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){o.w("calculateFogMatrix is not supported on globe projection.");const p=o.b9();return o.af(p),p}getVisibleUnwrappedCoordinates(l){return[new o.b1(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,p){if(!this._globeViewProjMatrixNoCorrection)return 1;const w=sa(l);o.aQ(w,w,1+p/o.bt);const T=o.bu();return o.av(T,[w[0],w[1],w[2],1],this._globeViewProjMatrixNoCorrection),T[2]/T[3]}populateCache(l){}getBounds(){const l=.5*this.width,p=.5*this.height,w=[new o.P(0,0),new o.P(l,0),new o.P(this.width,0),new o.P(this.width,p),new o.P(this.width,this.height),new o.P(l,this.height),new o.P(0,this.height),new o.P(0,p)],T=[];for(const Se of w)T.push(this.unprojectScreenPoint(Se));let O=0,j=0,X=0,te=0;const le=this.center;for(const Se of T){const be=o.bz(le.lng,Se.lng),Le=o.bz(le.lat,Se.lat);be<j&&(j=be),be>O&&(O=be),Le<te&&(te=Le),Le>X&&(X=Le)}const ge=[le.lng+j,le.lat+te,le.lng+O,le.lat+X];return this.isSurfacePointOnScreen([0,1,0])&&(ge[3]=90,ge[0]=-180,ge[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(ge[1]=-90,ge[0]=-180,ge[2]=180),new Lt(ge)}getConstrained(l,p){const w=o.ag(l.lat,-85.051129,o.ah),T=o.ag(+p,this.minZoom+dt(0,w),this.maxZoom);return{center:new o.S(l.lng,w),zoom:T}}calculateCenterFromCameraLngLatAlt(l,p,w,T){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,w,T)}setLocationAtPoint(l,p){const w=sa(this.unprojectScreenPoint(p)),T=sa(l),O=o.bo();o.bA(O);const j=o.bo();o.bx(j,w,O,-this.center.lng*Math.PI/180),o.bw(j,j,O,this.center.lat*Math.PI/180);const X=T[0]*T[0]+T[2]*T[2],te=j[0]*j[0];if(X<te)return;const le=Math.sqrt(X-te),ge=-le,Se=o.bB(T[0],T[2],j[0],le),be=o.bB(T[0],T[2],j[0],ge),Le=o.bo();o.bx(Le,T,O,-Se);const Ge=o.bB(Le[1],Le[2],j[1],j[2]),lt=o.bo();o.bx(lt,T,O,-be);const st=o.bB(lt[1],lt[2],j[1],j[2]),ut=.5*Math.PI,_t=Ge>=-ut&&Ge<=ut,Dt=st>=-ut&&st<=ut;let kt,zt;if(_t&&Dt){const Er=this.center.lng*Math.PI/180,vr=this.center.lat*Math.PI/180;o.bC(Se,Er)+o.bC(Ge,vr)<o.bC(be,Er)+o.bC(st,vr)?(kt=Se,zt=Ge):(kt=be,zt=st)}else if(_t)kt=Se,zt=Ge;else{if(!Dt)return;kt=be,zt=st}const $t=kt/Math.PI*180,It=zt/Math.PI*180,Kt=this.center.lat;this.setCenter(new o.S($t,o.ag(It,-90,90))),this.setZoom(this.zoom+dt(Kt,this.center.lat))}locationToScreenPoint(l,p){const w=sa(l);if(p){const T=p.getElevationForLngLatZoom(l,this._helper._tileZoom);o.aQ(w,w,1+T/o.bt)}return this._projectSurfacePointToScreen(w)}_projectSurfacePointToScreen(l){const p=o.bu();return o.av(p,[...l,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],new o.P((.5*p[0]+.5)*this.width,(.5*-p[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,p){if(p){const w=p.pointCoordinate(l);if(w)return w}return o.a0.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,p){var w;return(w=this.screenPointToMercatorCoordinate(l,p))===null||w===void 0?void 0:w.toLngLat()}isPointOnMapSurface(l,p){const w=this._cameraPosition,T=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(w,T)}getRayDirectionFromPixel(l){const p=o.bu();p[0]=l.x/this.width*2-1,p[1]=-1*(l.y/this.height*2-1),p[2]=1,p[3]=1,o.av(p,p,this._globeViewProjMatrixNoCorrectionInverted),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3];const w=o.bo();w[0]=p[0]-this._cameraPosition[0],w[1]=p[1]-this._cameraPosition[1],w[2]=p[2]-this._cameraPosition[2];const T=o.bo();return o.aU(T,w),T}isSurfacePointVisible(l){const p=this._cachedClippingPlane;return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]+p[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;const p=o.bu();return o.av(p,[...l,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[0]>-1&&p[0]<1&&p[1]>-1&&p[1]<1&&p[2]>-1&&p[2]<1}rayPlanetIntersection(l,p){const w=o.aW(l,p),T=o.bo(),O=o.bo();o.aQ(O,p,w),o.aT(T,l,O);const j=1-o.aW(T,T);if(j<0)return null;const X=o.aW(l,l)-1,te=-w+(w<0?1:-1)*Math.sqrt(j),le=X/te,ge=te;return{tMin:Math.min(le,ge),tMax:Math.max(le,ge)}}unprojectScreenPoint(l){const p=this._cameraPosition,w=this.getRayDirectionFromPixel(l),T=this.rayPlanetIntersection(p,w);if(T){const ge=o.bo();o.aR(ge,p,[w[0]*T.tMin,w[1]*T.tMin,w[2]*T.tMin]);const Se=o.bo();return o.aU(Se,ge),se(Se)}const O=this._cachedClippingPlane,j=O[0]*w[0]+O[1]*w[1]+O[2]*w[2],X=-o.b0(O,p)/j,te=o.bo();if(X>0)o.aR(te,p,[w[0]*X,w[1]*X,w[2]*X]);else{const ge=o.bo();o.aR(ge,p,[2*w[0],2*w[1],2*w[2]]);const Se=o.b0(this._cachedClippingPlane,ge);o.aT(te,ge,[this._cachedClippingPlane[0]*Se,this._cachedClippingPlane[1]*Se,this._cachedClippingPlane[2]*Se])}const le=(function(ge){const Se=o.bo();return Se[0]=ge[0]*-ge[3],Se[1]=ge[1]*-ge[3],Se[2]=ge[2]*-ge[3],{center:Se,radius:Math.sqrt(1-ge[3]*ge[3])}})(O);return se((function(ge,Se,be){const Le=o.bo();o.aT(Le,be,ge);const Ge=o.bo();return o.bp(Ge,ge,Le,Se/o.a_(Le)),Ge})(le.center,le.radius,te))}getMatrixForModel(l,p){const w=o.S.convert(l),T=1/o.bt,O=o.b8();return o.by(O,O,w.lng/180*Math.PI),o.b6(O,O,-w.lat/180*Math.PI),o.M(O,O,[0,0,1+p/o.bt]),o.b6(O,O,.5*Math.PI),o.N(O,O,[T,T,T]),O}getProjectionDataForCustomLayer(l=!0){const p=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:l});return p.tileMercatorCoords=[0,0,1,1],p}getFastPathSimpleProjectionMatrix(l){}}class Si{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,p,w){return this._helper.interpolatePadding(l,p,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,p,w=!0){this._helper.resize(l,p,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,p){this._helper.overrideNearFarZ(l,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,p){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=p,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new $n({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,p)=>this.getConstrained(l,p)}),this._globeness=1,this._mercatorTransform=new si,this._verticalPerspectiveTransform=new $i}clone(){const l=new Si;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this),l}apply(l){this._helper.apply(l),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){const p=this._mercatorTransform.getProjectionData(l),w=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?w.mainMatrix:p.mainMatrix,clippingPlane:w.clippingPlane,tileMercatorCoords:w.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:p.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return o.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,p,w){const T=this._mercatorTransform.getPitchedTextCorrection(l,p,w),O=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,p,w);return o.bj(T,O,this._globeness)}projectTileCoordinates(l,p,w,T){return this.currentTransform.projectTileCoordinates(l,p,w,T)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,p){return this.currentTransform.lngLatToCameraDepth(l,p)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}getConstrained(l,p){return this.currentTransform.getConstrained(l,p)}calculateCenterFromCameraLngLatAlt(l,p,w,T){return this._helper.calculateCenterFromCameraLngLatAlt(l,p,w,T)}setLocationAtPoint(l,p){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,p),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(l,p),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(l,p){return this.currentTransform.locationToScreenPoint(l,p)}screenPointToMercatorCoordinate(l,p){return this.currentTransform.screenPointToMercatorCoordinate(l,p)}screenPointToLocation(l,p){return this.currentTransform.screenPointToLocation(l,p)}isPointOnMapSurface(l,p){return this.currentTransform.isPointOnMapSurface(l,p)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,p){return this.currentTransform.getMatrixForModel(l,p)}getProjectionDataForCustomLayer(l=!0){const p=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return p;const w=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return w.fallbackMatrix=p.mainMatrix,w}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class Ii{get useGlobeControls(){return!0}handlePanInertia(l,p){const w=Vt(l,p);return Math.abs(w.lng-p.center.lng)>180&&(w.lng=p.center.lng+179.5*Math.sign(w.lng-p.center.lng)),{easingCenter:w,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,p){const w=l.around,T=p.screenPointToLocation(w);l.bearingDelta&&p.setBearing(p.bearing+l.bearingDelta),l.pitchDelta&&p.setPitch(p.pitch+l.pitchDelta),l.rollDelta&&p.setRoll(p.roll+l.rollDelta);const O=p.zoom;l.zoomDelta&&p.setZoom(p.zoom+l.zoomDelta);const j=p.zoom-O;if(j===0)return;const X=o.bz(p.center.lng,T.lng),te=X/(Math.abs(X/180)+1),le=o.bz(p.center.lat,T.lat),ge=p.getRayDirectionFromPixel(w),Se=p.cameraPosition,be=-1*o.aW(Se,ge),Le=o.bo();o.aR(Le,Se,[ge[0]*be,ge[1]*be,ge[2]*be]);const Ge=o.aY(Le)-1,lt=Math.exp(.5*-Math.max(Ge-.3,0)),st=La(p.worldSize,p.center.lat)/Math.min(p.width,p.height),ut=o.bm(st,.9,.5,1,.25),_t=(1-o.ae(-j))*Math.min(lt,ut),Dt=p.center.lat,kt=p.zoom,zt=new o.S(p.center.lng+te*_t,o.ag(p.center.lat+le*_t,-85.051129,o.ah));p.setLocationAtPoint(T,w);const $t=p.center,It=o.bm(Math.abs(X),45,85,0,1),Kt=o.bm(st,.75,.35,0,1),Er=Math.pow(Math.max(It,Kt),.25),vr=o.bz($t.lng,zt.lng),_r=o.bz($t.lat,zt.lat);p.setCenter(new o.S($t.lng+vr*Er,$t.lat+_r*Er).wrap()),p.setZoom(kt+dt(Dt,p.center.lat))}handleMapControlsPan(l,p,w){if(!l.panDelta)return;const T=p.center.lat,O=p.zoom;p.setCenter(Vt(l.panDelta,p).wrap()),p.setZoom(O+dt(T,p.center.lat))}cameraForBoxAndBearing(l,p,w,T,O){const j=Vi(l,p,w,T,O),X=p.left/O.width*2-1,te=(O.width-p.right)/O.width*2-1,le=p.top/O.height*-2+1,ge=(O.height-p.bottom)/O.height*-2+1,Se=o.bz(w.getWest(),w.getEast())<0,be=Se?w.getEast():w.getWest(),Le=Se?w.getWest():w.getEast(),Ge=Math.max(w.getNorth(),w.getSouth()),lt=Math.min(w.getNorth(),w.getSouth()),st=be+.5*o.bz(be,Le),ut=Ge+.5*o.bz(Ge,lt),_t=O.clone();_t.setCenter(j.center),_t.setBearing(j.bearing),_t.setPitch(0),_t.setRoll(0),_t.setZoom(j.zoom);const Dt=_t.modelViewProjectionMatrix,kt=[sa(w.getNorthWest()),sa(w.getNorthEast()),sa(w.getSouthWest()),sa(w.getSouthEast()),sa(new o.S(Le,ut)),sa(new o.S(be,ut)),sa(new o.S(st,Ge)),sa(new o.S(st,lt))],zt=sa(j.center);let $t=Number.POSITIVE_INFINITY;for(const It of kt)X<0&&($t=Ii.getLesserNonNegativeNonNull($t,Ii.solveVectorScale(It,zt,Dt,"x",X))),te>0&&($t=Ii.getLesserNonNegativeNonNull($t,Ii.solveVectorScale(It,zt,Dt,"x",te))),le>0&&($t=Ii.getLesserNonNegativeNonNull($t,Ii.solveVectorScale(It,zt,Dt,"y",le))),ge<0&&($t=Ii.getLesserNonNegativeNonNull($t,Ii.solveVectorScale(It,zt,Dt,"y",ge)));if(Number.isFinite($t)&&$t!==0)return j.zoom=_t.zoom+o.aj($t),j;Li()}handleJumpToCenterZoom(l,p){const w=l.center.lat,T=l.getConstrained(p.center?o.S.convert(p.center):l.center,l.zoom).center;l.setCenter(T.wrap());const O=p.zoom!==void 0?+p.zoom:l.zoom+dt(w,T.lat);l.zoom!==O&&l.setZoom(O)}handleEaseTo(l,p){const w=l.zoom,T=l.center,O=l.padding,j={roll:l.roll,pitch:l.pitch,bearing:l.bearing},X={roll:p.roll===void 0?l.roll:p.roll,pitch:p.pitch===void 0?l.pitch:p.pitch,bearing:p.bearing===void 0?l.bearing:p.bearing},te=p.zoom!==void 0,le=!l.isPaddingEqual(p.padding);let ge=!1;const Se=p.center?o.S.convert(p.center):T,be=l.getConstrained(Se,w).center;Xn(l,be);const Le=l.clone();Le.setCenter(be),Le.setZoom(te?+p.zoom:w+dt(T.lat,Se.lat)),Le.setBearing(p.bearing);const Ge=new o.P(o.ag(l.centerPoint.x+p.offsetAsPoint.x,0,l.width),o.ag(l.centerPoint.y+p.offsetAsPoint.y,0,l.height));Le.setLocationAtPoint(be,Ge);const lt=(p.offset&&p.offsetAsPoint.mag())>0?Le.center:be,st=te?+p.zoom:w+dt(T.lat,lt.lat),ut=w+dt(T.lat,0),_t=st+dt(lt.lat,0),Dt=o.bz(T.lng,lt.lng),kt=o.bz(T.lat,lt.lat),zt=o.ae(_t-ut);return ge=st!==w,{easeFunc:$t=>{if(o.bd(j,X)||wi({startEulerAngles:j,endEulerAngles:X,tr:l,k:$t,useSlerp:j.roll!=X.roll}),le&&l.interpolatePadding(O,p.padding,$t),p.around)o.w("Easing around a point is not supported under globe projection."),l.setLocationAtPoint(p.around,p.aroundPoint);else{const It=_t>ut?Math.min(2,zt):Math.max(.5,zt),Kt=Math.pow(It,1-$t),Er=Vr(T,Dt,kt,$t*Kt);l.setCenter(Er.wrap())}if(ge){const It=o.C.number(ut,_t,$t)+dt(0,l.center.lat);l.setZoom(It)}},isZooming:ge,elevationCenter:lt}}handleFlyTo(l,p){const w=p.zoom!==void 0,T=l.center,O=l.zoom,j=l.padding,X=!l.isPaddingEqual(p.padding),te=l.getConstrained(o.S.convert(p.center||p.locationAtOffset),O).center,le=w?+p.zoom:l.zoom+dt(l.center.lat,te.lat),ge=l.clone();ge.setCenter(te),ge.setZoom(le),ge.setBearing(p.bearing);const Se=new o.P(o.ag(l.centerPoint.x+p.offsetAsPoint.x,0,l.width),o.ag(l.centerPoint.y+p.offsetAsPoint.y,0,l.height));ge.setLocationAtPoint(te,Se);const be=ge.center;Xn(l,be);const Le=(function(kt,zt,$t){const It=sa(zt),Kt=sa($t),Er=o.aW(It,Kt),vr=Math.acos(Er),_r=Ja(kt);return vr/(2*Math.PI)*_r})(l,T,be),Ge=O+dt(T.lat,0),lt=le+dt(be.lat,0),st=o.ae(lt-Ge);let ut;if(typeof p.minZoom=="number"){const kt=+p.minZoom+dt(be.lat,0),zt=Math.min(kt,Ge,lt)+dt(0,be.lat),$t=l.getConstrained(be,zt).zoom+dt(be.lat,0);ut=o.ae($t-Ge)}const _t=o.bz(T.lng,be.lng),Dt=o.bz(T.lat,be.lat);return{easeFunc:(kt,zt,$t,It)=>{const Kt=Vr(T,_t,Dt,$t);X&&l.interpolatePadding(j,p.padding,kt);const Er=kt===1?be:Kt;l.setCenter(Er.wrap());const vr=Ge+o.aj(zt);l.setZoom(kt===1?le:vr+dt(0,Er.lat))},scaleOfZoom:st,targetCenter:be,scaleOfMinZoom:ut,pixelPathLength:Le}}static solveVectorScale(l,p,w,T,O){const j=T==="x"?[w[0],w[4],w[8],w[12]]:[w[1],w[5],w[9],w[13]],X=[w[3],w[7],w[11],w[15]],te=l[0]*j[0]+l[1]*j[1]+l[2]*j[2],le=l[0]*X[0]+l[1]*X[1]+l[2]*X[2],ge=p[0]*j[0]+p[1]*j[1]+p[2]*j[2],Se=p[0]*X[0]+p[1]*X[1]+p[2]*X[2];return ge+O*le===te+O*Se||X[3]*(te-ge)+j[3]*(Se-le)+te*Se==ge*le?null:(ge+j[3]-O*Se-O*X[3])/(ge-te-O*Se+O*le)}static getLesserNonNegativeNonNull(l,p){return p!==null&&p>=0&&p<l?p:l}}class Aa{constructor(l){this._globe=l,this._mercatorCameraHelper=new Bi,this._verticalPerspectiveCameraHelper=new Ii}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,p){return this.currentHelper.handlePanInertia(l,p)}handleMapControlsRollPitchBearingZoom(l,p){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,p)}handleMapControlsPan(l,p,w){this.currentHelper.handleMapControlsPan(l,p,w)}cameraForBoxAndBearing(l,p,w,T,O){return this.currentHelper.cameraForBoxAndBearing(l,p,w,T,O)}handleJumpToCenterZoom(l,p){this.currentHelper.handleJumpToCenterZoom(l,p)}handleEaseTo(l,p){return this.currentHelper.handleEaseTo(l,p)}handleFlyTo(l,p){return this.currentHelper.handleFlyTo(l,p)}}const ca=(R,l)=>o.y(R,l&&l.filter((p=>p.identifier!=="source.canvas"))),ba=o.bD();class Ss extends o.E{constructor(l,p={}){super(),this._rtlPluginLoaded=()=>{for(const w in this.sourceCaches){const T=this.sourceCaches[w].getSource().type;T!=="vector"&&T!=="geojson"||this.sourceCaches[w].reload()}},this.map=l,this.dispatcher=new Re(Me(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",((w,T)=>this.getGlyphs(w,T))),this.dispatcher.registerMessageHandler("GI",((w,T)=>this.getImages(w,T))),this.imageManager=new G,this.imageManager.setEventedParent(this),this.glyphManager=new ne(l._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Ee(256,512),this.crossTileSymbolIndex=new Ye,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bF()),Nr().on(Pr,this._rtlPluginLoaded),this.on("data",(w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const T=this.sourceCaches[w.sourceId];if(!T)return;const O=T.getSource();if(O&&O.vectorLayerIds)for(const j in this._layers){const X=this._layers[j];X.source===O.id&&this._validateLayer(X)}}))}setGlobalStateProperty(l,p){var w,T,O;this._checkLoaded();const j=p===null?(O=(T=(w=this.stylesheet.state)===null||w===void 0?void 0:w[l])===null||T===void 0?void 0:T.default)!==null&&O!==void 0?O:null:p;if(o.bG(j,this._globalState[l]))return this;this._globalState[l]=j;const X=this._findGlobalStateAffectedSources([l]);for(const te in this.sourceCaches)X.has(te)&&(this._reloadSource(te),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();const p=[];for(const T in l)!o.bG(this._globalState[T],l[T].default)&&(p.push(T),this._globalState[T]=l[T].default);const w=this._findGlobalStateAffectedSources(p);for(const T in this.sourceCaches)w.has(T)&&(this._reloadSource(T),this._changed=!0)}_findGlobalStateAffectedSources(l){if(l.length===0)return new Set;const p=new Set;for(const w in this._layers){const T=this._layers[w],O=T.getLayoutAffectingGlobalStateRefs();for(const j of l)O.has(j)&&p.add(T.source)}return p}loadURL(l,p={},w){this.fire(new o.l("dataloading",{dataType:"style"})),p.validate=typeof p.validate!="boolean"||p.validate;const T=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const O=this._loadStyleRequest;o.j(T,this._loadStyleRequest).then((j=>{this._loadStyleRequest=null,this._load(j.data,p,w)})).catch((j=>{this._loadStyleRequest=null,j&&!O.signal.aborted&&this.fire(new o.k(j))}))}loadJSON(l,p={},w){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,p.validate=p.validate!==!1,this._load(l,p,w)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(ba,{validate:!1})}_load(l,p,w){var T,O,j;const X=p.transformStyle?p.transformStyle(w,l):l;if(!p.validate||!ca(this,o.z(X))){this._loaded=!0,this.stylesheet=X;for(const te in X.sources)this.addSource(te,X.sources[te],{validate:!1});X.sprite?this._loadSprite(X.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(X.glyphs),this._createLayers(),this.light=new de(this.stylesheet.light),this._setProjectionInternal(((T=this.stylesheet.projection)===null||T===void 0?void 0:T.type)||"mercator"),this.sky=new me(this.stylesheet.sky),this.map.setTerrain((O=this.stylesheet.terrain)!==null&&O!==void 0?O:null),this.setGlobalState((j=this.stylesheet.state)!==null&&j!==void 0?j:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){const l=o.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map((p=>p.id)),this._layers={},this._serializedLayers=null;for(const p of l){const w=o.bI(p);w.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=w}}_loadSprite(l,p=!1,w=void 0){let T;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(O,j,X,te){return o._(this,void 0,void 0,(function*(){const le=B(O),ge=X>1?"@2x":"",Se={},be={};for(const{id:Le,url:Ge}of le){const lt=j.transformRequest(q(Ge,ge,".json"),"SpriteJSON");Se[Le]=o.j(lt,te);const st=j.transformRequest(q(Ge,ge,".png"),"SpriteImage");be[Le]=M.getImage(st,te)}return yield Promise.all([...Object.values(Se),...Object.values(be)]),(function(Le,Ge){return o._(this,void 0,void 0,(function*(){const lt={};for(const st in Le){lt[st]={};const ut=b.getImageCanvasContext((yield Ge[st]).data),_t=(yield Le[st]).data;for(const Dt in _t){const{width:kt,height:zt,x:$t,y:It,sdf:Kt,pixelRatio:Er,stretchX:vr,stretchY:_r,content:Ar,textFitWidth:gn,textFitHeight:dn}=_t[Dt];lt[st][Dt]={data:null,pixelRatio:Er,sdf:Kt,stretchX:vr,stretchY:_r,content:Ar,textFitWidth:gn,textFitHeight:dn,spriteData:{width:kt,height:zt,x:$t,y:It,context:ut}}}}return lt}))})(Se,be)}))})(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((O=>{if(this._spriteRequest=null,O)for(const j in O){this._spritesImagesIds[j]=[];const X=this._spritesImagesIds[j]?this._spritesImagesIds[j].filter((te=>!(te in O))):[];for(const te of X)this.imageManager.removeImage(te),this._changedImages[te]=!0;for(const te in O[j]){const le=j==="default"?te:`${j}:${te}`;this._spritesImagesIds[j].push(le),le in this.imageManager.images?this.imageManager.updateImage(le,O[j][te],!1):this.imageManager.addImage(le,O[j][te]),p&&(this._changedImages[le]=!0)}}})).catch((O=>{this._spriteRequest=null,T=O,this.fire(new o.k(T))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),p&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),w&&w(T)}))}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(l){const p=this.sourceCaches[l.source];if(!p)return;const w=l.sourceLayer;if(!w)return;const T=p.getSource();(T.type==="geojson"||T.vectorLayerIds&&T.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.k(new Error(`Source layer "${w}" does not exist on source "${T.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,p=!1){const w=this._serializedAllLayers();if(!l||l.length===0)return Object.values(p?o.bJ(w):w);const T=[];for(const O of l)if(w[O]){const j=p?o.bJ(w[O]):w[O];T.push(j)}return T}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const p=Object.keys(this._layers);for(const w of p){const T=this._layers[w];T.type!=="custom"&&(l[w]=T.serialize())}return l}hasTransitions(){var l,p,w;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((p=this.sky)===null||p===void 0)&&p.hasTransition()||!((w=this.projection)===null||w===void 0)&&w.hasTransition())return!0;for(const T in this.sourceCaches)if(this.sourceCaches[T].hasTransition())return!0;for(const T in this._layers)if(this._layers[T].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const p=this._changed;if(p){const T=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);(T.length||O.length)&&this._updateWorkerLayers(T,O);for(const j in this._updatedSources){const X=this._updatedSources[j];if(X==="reload")this._reloadSource(j);else{if(X!=="clear")throw new Error(`Invalid action ${X}`);this._clearSource(j)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const j in this._updatedPaintProps)this._layers[j].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const w={};for(const T in this.sourceCaches){const O=this.sourceCaches[T];w[T]=O.used,O.used=!1}for(const T of this._order){const O=this._layers[T];O.recalculate(l,this._availableImages),!O.isHidden(l.zoom)&&O.source&&(this.sourceCaches[O.source].used=!0)}for(const T in w){const O=this.sourceCaches[T];!!w[T]!=!!O.used&&O.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:T}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,p&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,p={}){var w;this._checkLoaded();const T=this.serialize();if(l=p.transformStyle?p.transformStyle(T,l):l,((w=p.validate)===null||w===void 0||w)&&ca(this,o.z(l)))return!1;(l=o.bJ(l)).layers=o.bH(l.layers);const O=o.bK(T,l),j=this._getOperationsToPerform(O);if(j.unimplemented.length>0)throw new Error(`Unimplemented: ${j.unimplemented.join(", ")}.`);if(j.operations.length===0)return!1;for(const X of j.operations)X();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const p=[],w=[];for(const T of l)switch(T.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":p.push((()=>this.addLayer.apply(this,T.args)));break;case"removeLayer":p.push((()=>this.removeLayer.apply(this,T.args)));break;case"setPaintProperty":p.push((()=>this.setPaintProperty.apply(this,T.args)));break;case"setLayoutProperty":p.push((()=>this.setLayoutProperty.apply(this,T.args)));break;case"setFilter":p.push((()=>this.setFilter.apply(this,T.args)));break;case"addSource":p.push((()=>this.addSource.apply(this,T.args)));break;case"removeSource":p.push((()=>this.removeSource.apply(this,T.args)));break;case"setLayerZoomRange":p.push((()=>this.setLayerZoomRange.apply(this,T.args)));break;case"setLight":p.push((()=>this.setLight.apply(this,T.args)));break;case"setGeoJSONSourceData":p.push((()=>this.setGeoJSONSourceData.apply(this,T.args)));break;case"setGlyphs":p.push((()=>this.setGlyphs.apply(this,T.args)));break;case"setSprite":p.push((()=>this.setSprite.apply(this,T.args)));break;case"setTerrain":p.push((()=>this.map.setTerrain.apply(this,T.args)));break;case"setSky":p.push((()=>this.setSky.apply(this,T.args)));break;case"setProjection":this.setProjection.apply(this,T.args);break;case"setGlobalState":p.push((()=>this.setGlobalState.apply(this,T.args)));break;case"setTransition":p.push((()=>{}));break;default:w.push(T.command)}return{operations:p,unimplemented:w}}addImage(l,p){if(this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,p),this._afterImageUpdated(l)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,p,w={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(o.z.source,`sources.${l}`,p,null,w))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const T=this.sourceCaches[l]=new Xt(l,p,this.dispatcher);T.style=this,T.setEventedParent(this,(()=>({isSourceLoaded:T.loaded(),source:T.serialize(),sourceId:l}))),T.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===l)return this.fire(new o.k(new Error(`Source "${l}" cannot be removed while layer "${w}" is using it.`)));const p=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],p.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,p){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const w=this.sourceCaches[l].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(p),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,p,w={}){this._checkLoaded();const T=l.id;if(this.getLayer(T))return void this.fire(new o.k(new Error(`Layer "${T}" already exists on this map.`)));let O;if(l.type==="custom"){if(ca(this,o.bL(l)))return;O=o.bI(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(T,l.source),l=o.bJ(l),l=o.e(l,{source:T})),this._validate(o.z.layer,`layers.${T}`,l,{arrayIndex:-1},w))return;O=o.bI(l),this._validateLayer(O),O.setEventedParent(this,{layer:{id:T}})}const j=p?this._order.indexOf(p):this._order.length;if(p&&j===-1)this.fire(new o.k(new Error(`Cannot add layer "${T}" before non-existing layer "${p}".`)));else{if(this._order.splice(j,0,T),this._layerOrderChanged=!0,this._layers[T]=O,this._removedLayers[T]&&O.source&&O.type!=="custom"){const X=this._removedLayers[T];delete this._removedLayers[T],X.type!==O.type?this._updatedSources[O.source]="clear":(this._updatedSources[O.source]="reload",this.sourceCaches[O.source].pause())}this._updateLayer(O),O.onAdd&&O.onAdd(this.map)}}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const w=this._order.indexOf(l);this._order.splice(w,1);const T=p?this._order.indexOf(p):this._order.length;p&&T===-1?this.fire(new o.k(new Error(`Cannot move layer "${l}" before non-existing layer "${p}".`))):(this._order.splice(T,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${l}".`)));p.setEventedParent(null);const w=this._order.indexOf(l);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,p,w){this._checkLoaded();const T=this.getLayer(l);T?T.minzoom===p&&T.maxzoom===w||(p!=null&&(T.minzoom=p),w!=null&&(T.maxzoom=w),this._updateLayer(T)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,p,w={}){this._checkLoaded();const T=this.getLayer(l);if(T){if(!o.bG(T.filter,p))return p==null?(T.setFilter(void 0),void this._updateLayer(T)):void(this._validate(o.z.filter,`layers.${T.id}.filter`,p,null,w)||(T.setFilter(o.bJ(p)),this._updateLayer(T)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.bJ(this.getLayer(l).filter)}setLayoutProperty(l,p,w,T={}){this._checkLoaded();const O=this.getLayer(l);O?o.bG(O.getLayoutProperty(p),w)||(O.setLayoutProperty(p,w,T),this._updateLayer(O)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,p){const w=this.getLayer(l);if(w)return w.getLayoutProperty(p);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,p,w,T={}){this._checkLoaded();const O=this.getLayer(l);O?o.bG(O.getPaintProperty(p),w)||(O.setPaintProperty(p,w,T)&&this._updateLayer(O),this._changed=!0,this._updatedPaintProps[l]=!0,this._serializedLayers=null):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,p){return this.getLayer(l).getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const w=l.source,T=l.sourceLayer,O=this.sourceCaches[w];if(O===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const j=O.getSource().type;j==="geojson"&&T?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||T?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),O.setFeatureState(T,l.id,p)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,p){this._checkLoaded();const w=l.source,T=this.sourceCaches[w];if(T===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const O=T.getSource().type,j=O==="vector"?l.sourceLayer:void 0;O!=="vector"||j?p&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):T.removeFeatureState(j,l.id,p):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const p=l.source,w=l.sourceLayer,T=this.sourceCaches[p];if(T!==void 0)return T.getSource().type!=="vector"||w?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),T.getFeatureState(w,l.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.bM(this.sourceCaches,(O=>O.serialize())),p=this._serializeByIds(this._order,!0),w=this.map.getTerrain()||void 0,T=this.stylesheet;return o.bN({version:T.version,name:T.name,metadata:T.metadata,light:T.light,sky:T.sky,center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch,sprite:T.sprite,glyphs:T.glyphs,transition:T.transition,projection:T.projection,sources:l,layers:p,terrain:w},(O=>O!==void 0))}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const p=j=>this._layers[j].type==="fill-extrusion",w={},T=[];for(let j=this._order.length-1;j>=0;j--){const X=this._order[j];if(p(X)){w[X]=j;for(const te of l){const le=te[X];if(le)for(const ge of le)T.push(ge)}}}T.sort(((j,X)=>X.intersectionZ-j.intersectionZ));const O=[];for(let j=this._order.length-1;j>=0;j--){const X=this._order[j];if(p(X))for(let te=T.length-1;te>=0;te--){const le=T[te].feature;if(w[le.layer.id]<j)break;O.push(le),T.pop()}else for(const te of l){const le=te[X];if(le)for(const ge of le)O.push(ge.feature)}}return O}queryRenderedFeatures(l,p,w){p&&p.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",p.filter,null,p);const T={};if(p&&p.layers){if(!(Array.isArray(p.layers)||p.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const le of p.layers){const ge=this._layers[le];if(!ge)return this.fire(new o.k(new Error(`The layer '${le}' does not exist in the map's style and cannot be queried for features.`))),[];T[ge.source]=!0}}const O=[];p.availableImages=this._availableImages;const j=this._serializedAllLayers(),X=p.layers instanceof Set?p.layers:Array.isArray(p.layers)?new Set(p.layers):null,te=Object.assign(Object.assign({},p),{layers:X});for(const le in this.sourceCaches)p.layers&&!T[le]||O.push(tt(this.sourceCaches[le],this._layers,j,l,te,w,this.map.terrain?(ge,Se,be)=>this.map.terrain.getElevation(ge,Se,be):void 0));return this.placement&&O.push((function(le,ge,Se,be,Le,Ge,lt){const st={},ut=Ge.queryRenderedSymbols(be),_t=[];for(const Dt of Object.keys(ut).map(Number))_t.push(lt[Dt]);_t.sort(Ze);for(const Dt of _t){const kt=Dt.featureIndex.lookupSymbolFeatures(ut[Dt.bucketInstanceId],ge,Dt.bucketIndex,Dt.sourceLayerIndex,Le.filter,Le.layers,Le.availableImages,le);for(const zt in kt){const $t=st[zt]=st[zt]||[],It=kt[zt];It.sort(((Kt,Er)=>{const vr=Dt.featureSortOrder;if(vr){const _r=vr.indexOf(Kt.featureIndex);return vr.indexOf(Er.featureIndex)-_r}return Er.featureIndex-Kt.featureIndex}));for(const Kt of It)$t.push(Kt)}}return(function(Dt,kt,zt){for(const $t in Dt)for(const It of Dt[$t])Qe(It,zt[kt[$t].source]);return Dt})(st,le,Se)})(this._layers,j,this.sourceCaches,l,te,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(O)}querySourceFeatures(l,p){p&&p.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",p.filter,null,p);const w=this.sourceCaches[l];return w?(function(T,O){const j=T.getRenderableIds().map((le=>T.getTileByID(le))),X=[],te={};for(let le=0;le<j.length;le++){const ge=j[le],Se=ge.tileID.canonical.key;te[Se]||(te[Se]=!0,ge.querySourceFeatures(X,O))}return X})(w,p):[]}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const w=this.light.getLight();let T=!1;for(const j in l)if(!o.bG(l[j],w[j])){T=!0;break}if(!T)return;const O={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,p),this.light.updateTransitions(O)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,p={}){this._checkLoaded();const w=this.getSky();let T=!1;if(!l&&!w)return;if(l&&!w)T=!0;else if(!l&&w)T=!0;else for(const j in l)if(!o.bG(l[j],w[j])){T=!0;break}if(!T)return;const O={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,p),this.sky.updateTransitions(O)}_setProjectionInternal(l){const p=(function(w){if(Array.isArray(w)){const T=new Zs({type:w});return{projection:T,transform:new Si,cameraHelper:new Aa(T)}}switch(w){case"mercator":return{projection:new hn,transform:new si,cameraHelper:new Bi};case"globe":{const T=new Zs({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:T,transform:new Si,cameraHelper:new Aa(T)}}case"vertical-perspective":return{projection:new ss,transform:new $i,cameraHelper:new Ii};default:return o.w(`Unknown projection name: ${w}. Falling back to mercator projection.`),{projection:new hn,transform:new si,cameraHelper:new Bi}}})(l);this.projection=p.projection,this.map.migrateProjection(p.transform,p.cameraHelper);for(const w in this.sourceCaches)this.sourceCaches[w].reload()}_validate(l,p,w,T,O={}){return(!O||O.validate!==!1)&&ca(this,l.call(o.z,o.e({key:p,style:this.serialize(),value:w,styleSpec:o.v},T)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Nr().off(Pr,this._rtlPluginLoaded);for(const p in this._layers)this._layers[p].setEventedParent(null);for(const p in this.sourceCaches){const w=this.sourceCaches[p];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const p in this.sourceCaches)this.sourceCaches[p].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,p,w,T,O=!1){let j=!1,X=!1;const te={};for(const le of this._order){const ge=this._layers[le];if(ge.type!=="symbol")continue;if(!te[ge.source]){const be=this.sourceCaches[ge.source];te[ge.source]=be.getRenderableIds(!0).map((Le=>be.getTileByID(Le))).sort(((Le,Ge)=>Ge.tileID.overscaledZ-Le.tileID.overscaledZ||(Le.tileID.isLessThan(Ge.tileID)?-1:1)))}const Se=this.crossTileSymbolIndex.addLayer(ge,te[ge.source],l.center.lng);j=j||Se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((O=O||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(b.now(),l.zoom))&&(this.pauseablePlacement=new wl(l,this.map.terrain,this._order,O,p,w,T,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,te),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(b.now()),X=!0),j&&this.pauseablePlacement.placement.setStale()),X||j)for(const le of this._order){const ge=this._layers[le];ge.type==="symbol"&&this.placement.updateLayerOpacities(ge,te[ge.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(b.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p){return o._(this,void 0,void 0,(function*(){const w=yield this.imageManager.getImages(p.icons);this._updateTilesForChangedImages();const T=this.sourceCaches[p.source];return T&&T.setDependencies(p.tileID.key,p.type,p.icons),w}))}getGlyphs(l,p){return o._(this,void 0,void 0,(function*(){const w=yield this.glyphManager.getGlyphs(p.stacks),T=this.sourceCaches[p.source];return T&&T.setDependencies(p.tileID.key,p.type,[""]),w}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,p={}){this._checkLoaded(),l&&this._validate(o.z.glyphs,"glyphs",l,null,p)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,p,w={},T){this._checkLoaded();const O=[{id:l,url:p}],j=[...B(this.stylesheet.sprite),...O];this._validate(o.z.sprite,"sprite",j,null,w)||(this.stylesheet.sprite=j,this._loadSprite(O,!0,T))}removeSprite(l){this._checkLoaded();const p=B(this.stylesheet.sprite);if(p.find((w=>w.id===l))){if(this._spritesImagesIds[l])for(const w of this._spritesImagesIds[l])this.imageManager.removeImage(w),this._changedImages[w]=!0;p.splice(p.findIndex((w=>w.id===l)),1),this.stylesheet.sprite=p.length>0?p:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return B(this.stylesheet.sprite)}setSprite(l,p={},w){this._checkLoaded(),l&&this._validate(o.z.sprite,"sprite",l,null,p)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,w):(this._unloadSprite(),w&&w(null)))}}var Ks=o.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Su{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,p,w,T,O,j,X,te,le){this.context=l;let ge=this.boundPaintVertexBuffers.length!==T.length;for(let Se=0;!ge&&Se<T.length;Se++)this.boundPaintVertexBuffers[Se]!==T[Se]&&(ge=!0);!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==w||ge||this.boundIndexBuffer!==O||this.boundVertexOffset!==j||this.boundDynamicVertexBuffer!==X||this.boundDynamicVertexBuffer2!==te||this.boundDynamicVertexBuffer3!==le?this.freshBind(p,w,T,O,j,X,te,le):(l.bindVertexArray.set(this.vao),X&&X.bind(),O&&O.dynamicDraw&&O.bind(),te&&te.bind(),le&&le.bind())}freshBind(l,p,w,T,O,j,X,te){const le=l.numAttributes,ge=this.context,Se=ge.gl;this.vao&&this.destroy(),this.vao=ge.createVertexArray(),ge.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=T,this.boundVertexOffset=O,this.boundDynamicVertexBuffer=j,this.boundDynamicVertexBuffer2=X,this.boundDynamicVertexBuffer3=te,p.enableAttributes(Se,l);for(const be of w)be.enableAttributes(Se,l);j&&j.enableAttributes(Se,l),X&&X.enableAttributes(Se,l),te&&te.enableAttributes(Se,l),p.bind(),p.setVertexAttribPointers(Se,l,O);for(const be of w)be.bind(),be.setVertexAttribPointers(Se,l,O);j&&(j.bind(),j.setVertexAttribPointers(Se,l,O)),T&&T.bind(),X&&(X.bind(),X.setVertexAttribPointers(Se,l,O)),te&&(te.bind(),te.setVertexAttribPointers(Se,l,O)),ge.currentNumAttributes=le}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Es=(R,l,p,w,T)=>({u_texture:0,u_ele_delta:R,u_fog_matrix:l,u_fog_color:p?p.properties.get("fog-color"):o.be.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:T?0:p?p.calculateFogBlendOpacity(w):0,u_horizon_color:p?p.properties.get("horizon-color"):o.be.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1,u_is_globe_mode:T?1:0}),Eu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function xa(R){const l=[];for(let p=0;p<R.length;p++){if(R[p]===null)continue;const w=R[p].split(" ");l.push(w.pop())}return l}class Js{constructor(l,p,w,T,O,j,X,te,le=[]){const ge=l.gl;this.program=ge.createProgram();const Se=xa(p.staticAttributes),be=w?w.getBinderAttributes():[],Le=Se.concat(be),Ge=Ut.prelude.staticUniforms?xa(Ut.prelude.staticUniforms):[],lt=X.staticUniforms?xa(X.staticUniforms):[],st=p.staticUniforms?xa(p.staticUniforms):[],ut=w?w.getBinderUniforms():[],_t=Ge.concat(lt).concat(st).concat(ut),Dt=[];for(const vr of _t)Dt.indexOf(vr)<0&&Dt.push(vr);const kt=w?w.defines():[];Na(ge)&&kt.unshift("#version 300 es"),O&&kt.push("#define OVERDRAW_INSPECTOR;"),j&&kt.push("#define TERRAIN3D;"),te&&kt.push(te),le&&kt.push(...le);let zt=kt.concat(Ut.prelude.fragmentSource,X.fragmentSource,p.fragmentSource).join(`
`),$t=kt.concat(Ut.prelude.vertexSource,X.vertexSource,p.vertexSource).join(`
`);Na(ge)||(zt=(function(vr){return vr.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(zt),$t=(function(vr){return vr.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})($t));const It=ge.createShader(ge.FRAGMENT_SHADER);if(ge.isContextLost())return void(this.failedToCreate=!0);if(ge.shaderSource(It,zt),ge.compileShader(It),!ge.getShaderParameter(It,ge.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${ge.getShaderInfoLog(It)}`);ge.attachShader(this.program,It);const Kt=ge.createShader(ge.VERTEX_SHADER);if(ge.isContextLost())return void(this.failedToCreate=!0);if(ge.shaderSource(Kt,$t),ge.compileShader(Kt),!ge.getShaderParameter(Kt,ge.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${ge.getShaderInfoLog(Kt)}`);ge.attachShader(this.program,Kt),this.attributes={};const Er={};this.numAttributes=Le.length;for(let vr=0;vr<this.numAttributes;vr++)Le[vr]&&(ge.bindAttribLocation(this.program,vr,Le[vr]),this.attributes[Le[vr]]=vr);if(ge.linkProgram(this.program),!ge.getProgramParameter(this.program,ge.LINK_STATUS))throw new Error(`Program failed to link: ${ge.getProgramInfoLog(this.program)}`);ge.deleteShader(Kt),ge.deleteShader(It);for(let vr=0;vr<Dt.length;vr++){const _r=Dt[vr];if(_r&&!Er[_r]){const Ar=ge.getUniformLocation(this.program,_r);Ar&&(Er[_r]=Ar)}}this.fixedUniforms=T(l,Er),this.terrainUniforms=((vr,_r)=>({u_depth:new o.bO(vr,_r.u_depth),u_terrain:new o.bO(vr,_r.u_terrain),u_terrain_dim:new o.bf(vr,_r.u_terrain_dim),u_terrain_matrix:new o.bQ(vr,_r.u_terrain_matrix),u_terrain_unpack:new o.bR(vr,_r.u_terrain_unpack),u_terrain_exaggeration:new o.bf(vr,_r.u_terrain_exaggeration)}))(l,Er),this.projectionUniforms=((vr,_r)=>({u_projection_matrix:new o.bQ(vr,_r.u_projection_matrix),u_projection_tile_mercator_coords:new o.bR(vr,_r.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bR(vr,_r.u_projection_clipping_plane),u_projection_transition:new o.bf(vr,_r.u_projection_transition),u_projection_fallback_matrix:new o.bQ(vr,_r.u_projection_fallback_matrix)}))(l,Er),this.binderUniforms=w?w.getUniforms(l,Er):[]}draw(l,p,w,T,O,j,X,te,le,ge,Se,be,Le,Ge,lt,st,ut,_t,Dt){const kt=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(w),l.setStencilMode(T),l.setColorMode(O),l.setCullFace(j),te){l.activeTexture.set(kt.TEXTURE2),kt.bindTexture(kt.TEXTURE_2D,te.depthTexture),l.activeTexture.set(kt.TEXTURE3),kt.bindTexture(kt.TEXTURE_2D,te.texture);for(const $t in this.terrainUniforms)this.terrainUniforms[$t].set(te[$t])}if(le)for(const $t in le)this.projectionUniforms[Eu[$t]].set(le[$t]);if(X)for(const $t in this.fixedUniforms)this.fixedUniforms[$t].set(X[$t]);st&&st.setUniforms(l,this.binderUniforms,Ge,{zoom:lt});let zt=0;switch(p){case kt.LINES:zt=2;break;case kt.TRIANGLES:zt=3;break;case kt.LINE_STRIP:zt=1}for(const $t of Le.get()){const It=$t.vaos||($t.vaos={});(It[ge]||(It[ge]=new Su)).bind(l,this,Se,st?st.getPaintVertexBuffers():[],be,$t.vertexOffset,ut,_t,Dt),kt.drawElements(p,$t.primitiveLength*zt,kt.UNSIGNED_SHORT,$t.primitiveOffset*zt*2)}}}function au(R,l,p){const w=1/o.aB(p,1,l.transform.tileZoom),T=Math.pow(2,p.tileID.overscaledZ),O=p.tileSize*Math.pow(2,l.transform.tileZoom)/T,j=O*(p.tileID.canonical.x+p.tileID.wrap*T),X=O*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[w,R.fromScale,R.toScale],u_fade:R.t,u_pixel_coord_upper:[j>>16,X>>16],u_pixel_coord_lower:[65535&j,65535&X]}}const Ts=(R,l,p,w)=>{const T=R.style.light,O=T.properties.get("position"),j=[O.x,O.y,O.z],X=o.bU();T.properties.get("anchor")==="viewport"&&o.bV(X,R.transform.bearingInRadians),o.bW(j,j,X);const te=R.transform.transformLightDirection(j),le=T.properties.get("color");return{u_lightpos:j,u_lightpos_globe:te,u_lightintensity:T.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+l,u_opacity:p,u_fill_translate:w}},Da=(R,l,p,w,T,O,j)=>o.e(Ts(R,l,p,w),au(O,R,j),{u_height_factor:-Math.pow(2,T.overscaledZ)/j.tileSize/8}),To=(R,l,p,w)=>o.e(au(l,R,p),{u_fill_translate:w}),ha=(R,l)=>({u_world:R,u_fill_translate:l}),Qs=(R,l,p,w,T)=>o.e(To(R,l,p,T),{u_world:w}),jl=(R,l,p,w,T)=>{const O=R.transform;let j,X,te=0;if(p.paint.get("circle-pitch-alignment")==="map"){const le=o.aB(l,1,O.zoom);j=!0,X=[le,le],te=le/(o.$*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*T}else j=!1,X=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+j,u_device_pixel_ratio:R.pixelRatio,u_extrude_scale:X,u_globe_extrude_scale:te,u_translate:w}},wa=R=>({u_pixel_extrude_scale:[1/R.width,1/R.height]}),Tu=R=>({u_viewport_size:[R.width,R.height]}),Ul=(R,l=1)=>({u_color:R,u_overlay:0,u_overlay_scale:l}),el=(R,l,p,w)=>{const T=o.aB(R,1,l)/(o.$*Math.pow(2,R.tileID.overscaledZ))*2*Math.PI*w;return{u_extrude_scale:o.aB(R,1,l),u_intensity:p,u_globe_extrude_scale:T}},Qa=(R,l,p,w)=>{const T=o.L();o.bX(T,0,R.width,R.height,0,0,1);const O=R.context.gl;return{u_matrix:T,u_world:[O.drawingBufferWidth,O.drawingBufferHeight],u_image:p,u_color_ramp:w,u_opacity:l.paint.get("heatmap-opacity")}},Ro=(R,l,p)=>{const w=p.paint.get("hillshade-accent-color");let T;switch(p.paint.get("hillshade-method")){case"basic":T=4;break;case"combined":T=1;break;case"igor":T=2;break;case"multidirectional":T=3;break;default:T=0}const O=p.getIlluminationProperties();for(let j=0;j<O.directionRadians.length;j++)p.paint.get("hillshade-illumination-anchor")==="viewport"&&(O.directionRadians[j]+=R.transform.bearingInRadians);return{u_image:0,u_latrange:fc(0,l.tileID),u_exaggeration:p.paint.get("hillshade-exaggeration"),u_altitudes:O.altitudeRadians,u_azimuths:O.directionRadians,u_accent:w,u_method:T,u_highlights:O.highlightColor,u_shadows:O.shadowColor}},hc=(R,l)=>{const p=l.stride,w=o.L();return o.bX(w,0,o.$,-8192,0,0,1),o.M(w,w,[0,-8192,0]),{u_matrix:w,u_image:1,u_dimension:[p,p],u_zoom:R.overscaledZ,u_unpack:l.getUnpackVector()}};function fc(R,l){const p=Math.pow(2,l.canonical.z),w=l.canonical.y;return[new o.a0(0,w/p).toLngLat().lat,new o.a0(0,(w+1)/p).toLngLat().lat]}const Vl=(R,l)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:R.paint.get("color-relief-opacity")}),$l=(R,l,p,w)=>{const T=R.transform;return{u_translation:ql(R,l,p),u_ratio:w/o.aB(l,1,T.zoom),u_device_pixel_ratio:R.pixelRatio,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Co=(R,l,p,w,T)=>o.e($l(R,l,p,w),{u_image:0,u_image_height:T}),co=(R,l,p,w,T)=>{const O=R.transform,j=Ao(l,O);return{u_translation:ql(R,l,p),u_texsize:l.imageAtlasTexture.size,u_ratio:w/o.aB(l,1,O.zoom),u_device_pixel_ratio:R.pixelRatio,u_image:0,u_scale:[j,T.fromScale,T.toScale],u_fade:T.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},Cu=(R,l,p,w,T,O)=>{const j=R.lineAtlas,X=Ao(l,R.transform),te=p.layout.get("line-cap")==="round",le=j.getDash(T.from,te),ge=j.getDash(T.to,te),Se=le.width*O.fromScale,be=ge.width*O.toScale;return o.e($l(R,l,p,w),{u_patternscale_a:[X/Se,-le.height/2],u_patternscale_b:[X/be,-ge.height/2],u_sdfgamma:j.width/(256*Math.min(Se,be)*R.pixelRatio)/2,u_image:0,u_tex_y_a:le.y,u_tex_y_b:ge.y,u_mix:O.t})};function Ao(R,l){return 1/o.aB(R,1,l.tileZoom)}function ql(R,l,p){return o.aC(R.transform,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const jo=(R,l,p,w,T)=>{return{u_tl_parent:R,u_scale_parent:l,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(j=w.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(O=w.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:El(w.paint.get("raster-hue-rotate")),u_coords_top:[T[0].x,T[0].y,T[1].x,T[1].y],u_coords_bottom:[T[3].x,T[3].y,T[2].x,T[2].y]};var O,j};function El(R){R*=Math.PI/180;const l=Math.sin(R),p=Math.cos(R);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const Ia=(R,l,p,w,T,O,j,X,te,le,ge,Se,be)=>{const Le=j.transform;return{u_is_size_zoom_constant:+(R==="constant"||R==="source"),u_is_size_feature_constant:+(R==="constant"||R==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Le.cameraToCenterDistance,u_pitch:Le.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:Le.width/Le.height,u_fade_change:j.options.fadeDuration?j.symbolFadeChange:1,u_label_plane_matrix:X,u_coord_matrix:te,u_is_text:+ge,u_pitch_with_map:+w,u_is_along_line:T,u_is_variable_anchor:O,u_texsize:Se,u_texture:0,u_translation:le,u_pitched_scale:be}},tl=(R,l,p,w,T,O,j,X,te,le,ge,Se,be,Le)=>{const Ge=j.transform;return o.e(Ia(R,l,p,w,T,O,j,X,te,le,ge,Se,Le),{u_gamma_scale:w?Math.cos(Ge.pitch*Math.PI/180)*Ge.cameraToCenterDistance:1,u_device_pixel_ratio:j.pixelRatio,u_is_halo:1})},rl=(R,l,p,w,T,O,j,X,te,le,ge,Se,be)=>o.e(tl(R,l,p,w,T,O,j,X,te,le,!0,ge,0,be),{u_texsize_icon:Se,u_texture_icon:1}),ls=(R,l)=>({u_opacity:R,u_color:l}),ou=(R,l,p,w,T)=>o.e((function(O,j,X,te){const le=X.imageManager.getPattern(O.from.toString()),ge=X.imageManager.getPattern(O.to.toString()),{width:Se,height:be}=X.imageManager.getPixelSize(),Le=Math.pow(2,te.tileID.overscaledZ),Ge=te.tileSize*Math.pow(2,X.transform.tileZoom)/Le,lt=Ge*(te.tileID.canonical.x+te.tileID.wrap*Le),st=Ge*te.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:ge.tl,u_pattern_br_b:ge.br,u_texsize:[Se,be],u_mix:j.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:ge.displaySize,u_scale_a:j.fromScale,u_scale_b:j.toScale,u_tile_units_to_pixels:1/o.aB(te,1,X.transform.tileZoom),u_pixel_coord_upper:[lt>>16,st>>16],u_pixel_coord_lower:[65535&lt,65535&st]}})(p,T,l,w),{u_opacity:R}),Yu=(R,l)=>{},nl={fillExtrusion:(R,l)=>({u_lightpos:new o.bS(R,l.u_lightpos),u_lightpos_globe:new o.bS(R,l.u_lightpos_globe),u_lightintensity:new o.bf(R,l.u_lightintensity),u_lightcolor:new o.bS(R,l.u_lightcolor),u_vertical_gradient:new o.bf(R,l.u_vertical_gradient),u_opacity:new o.bf(R,l.u_opacity),u_fill_translate:new o.bT(R,l.u_fill_translate)}),fillExtrusionPattern:(R,l)=>({u_lightpos:new o.bS(R,l.u_lightpos),u_lightpos_globe:new o.bS(R,l.u_lightpos_globe),u_lightintensity:new o.bf(R,l.u_lightintensity),u_lightcolor:new o.bS(R,l.u_lightcolor),u_vertical_gradient:new o.bf(R,l.u_vertical_gradient),u_height_factor:new o.bf(R,l.u_height_factor),u_opacity:new o.bf(R,l.u_opacity),u_fill_translate:new o.bT(R,l.u_fill_translate),u_image:new o.bO(R,l.u_image),u_texsize:new o.bT(R,l.u_texsize),u_pixel_coord_upper:new o.bT(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(R,l.u_pixel_coord_lower),u_scale:new o.bS(R,l.u_scale),u_fade:new o.bf(R,l.u_fade)}),fill:(R,l)=>({u_fill_translate:new o.bT(R,l.u_fill_translate)}),fillPattern:(R,l)=>({u_image:new o.bO(R,l.u_image),u_texsize:new o.bT(R,l.u_texsize),u_pixel_coord_upper:new o.bT(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(R,l.u_pixel_coord_lower),u_scale:new o.bS(R,l.u_scale),u_fade:new o.bf(R,l.u_fade),u_fill_translate:new o.bT(R,l.u_fill_translate)}),fillOutline:(R,l)=>({u_world:new o.bT(R,l.u_world),u_fill_translate:new o.bT(R,l.u_fill_translate)}),fillOutlinePattern:(R,l)=>({u_world:new o.bT(R,l.u_world),u_image:new o.bO(R,l.u_image),u_texsize:new o.bT(R,l.u_texsize),u_pixel_coord_upper:new o.bT(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(R,l.u_pixel_coord_lower),u_scale:new o.bS(R,l.u_scale),u_fade:new o.bf(R,l.u_fade),u_fill_translate:new o.bT(R,l.u_fill_translate)}),circle:(R,l)=>({u_camera_to_center_distance:new o.bf(R,l.u_camera_to_center_distance),u_scale_with_map:new o.bO(R,l.u_scale_with_map),u_pitch_with_map:new o.bO(R,l.u_pitch_with_map),u_extrude_scale:new o.bT(R,l.u_extrude_scale),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_globe_extrude_scale:new o.bf(R,l.u_globe_extrude_scale),u_translate:new o.bT(R,l.u_translate)}),collisionBox:(R,l)=>({u_pixel_extrude_scale:new o.bT(R,l.u_pixel_extrude_scale)}),collisionCircle:(R,l)=>({u_viewport_size:new o.bT(R,l.u_viewport_size)}),debug:(R,l)=>({u_color:new o.bP(R,l.u_color),u_overlay:new o.bO(R,l.u_overlay),u_overlay_scale:new o.bf(R,l.u_overlay_scale)}),depth:Yu,clippingMask:Yu,heatmap:(R,l)=>({u_extrude_scale:new o.bf(R,l.u_extrude_scale),u_intensity:new o.bf(R,l.u_intensity),u_globe_extrude_scale:new o.bf(R,l.u_globe_extrude_scale)}),heatmapTexture:(R,l)=>({u_matrix:new o.bQ(R,l.u_matrix),u_world:new o.bT(R,l.u_world),u_image:new o.bO(R,l.u_image),u_color_ramp:new o.bO(R,l.u_color_ramp),u_opacity:new o.bf(R,l.u_opacity)}),hillshade:(R,l)=>({u_image:new o.bO(R,l.u_image),u_latrange:new o.bT(R,l.u_latrange),u_exaggeration:new o.bf(R,l.u_exaggeration),u_altitudes:new o.bZ(R,l.u_altitudes),u_azimuths:new o.bZ(R,l.u_azimuths),u_accent:new o.bP(R,l.u_accent),u_method:new o.bO(R,l.u_method),u_shadows:new o.bY(R,l.u_shadows),u_highlights:new o.bY(R,l.u_highlights)}),hillshadePrepare:(R,l)=>({u_matrix:new o.bQ(R,l.u_matrix),u_image:new o.bO(R,l.u_image),u_dimension:new o.bT(R,l.u_dimension),u_zoom:new o.bf(R,l.u_zoom),u_unpack:new o.bR(R,l.u_unpack)}),colorRelief:(R,l)=>({u_image:new o.bO(R,l.u_image),u_unpack:new o.bR(R,l.u_unpack),u_dimension:new o.bT(R,l.u_dimension),u_elevation_stops:new o.bO(R,l.u_elevation_stops),u_color_stops:new o.bO(R,l.u_color_stops),u_opacity:new o.bf(R,l.u_opacity)}),line:(R,l)=>({u_translation:new o.bT(R,l.u_translation),u_ratio:new o.bf(R,l.u_ratio),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bT(R,l.u_units_to_pixels)}),lineGradient:(R,l)=>({u_translation:new o.bT(R,l.u_translation),u_ratio:new o.bf(R,l.u_ratio),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bT(R,l.u_units_to_pixels),u_image:new o.bO(R,l.u_image),u_image_height:new o.bf(R,l.u_image_height)}),linePattern:(R,l)=>({u_translation:new o.bT(R,l.u_translation),u_texsize:new o.bT(R,l.u_texsize),u_ratio:new o.bf(R,l.u_ratio),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_image:new o.bO(R,l.u_image),u_units_to_pixels:new o.bT(R,l.u_units_to_pixels),u_scale:new o.bS(R,l.u_scale),u_fade:new o.bf(R,l.u_fade)}),lineSDF:(R,l)=>({u_translation:new o.bT(R,l.u_translation),u_ratio:new o.bf(R,l.u_ratio),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bT(R,l.u_units_to_pixels),u_patternscale_a:new o.bT(R,l.u_patternscale_a),u_patternscale_b:new o.bT(R,l.u_patternscale_b),u_sdfgamma:new o.bf(R,l.u_sdfgamma),u_image:new o.bO(R,l.u_image),u_tex_y_a:new o.bf(R,l.u_tex_y_a),u_tex_y_b:new o.bf(R,l.u_tex_y_b),u_mix:new o.bf(R,l.u_mix)}),raster:(R,l)=>({u_tl_parent:new o.bT(R,l.u_tl_parent),u_scale_parent:new o.bf(R,l.u_scale_parent),u_buffer_scale:new o.bf(R,l.u_buffer_scale),u_fade_t:new o.bf(R,l.u_fade_t),u_opacity:new o.bf(R,l.u_opacity),u_image0:new o.bO(R,l.u_image0),u_image1:new o.bO(R,l.u_image1),u_brightness_low:new o.bf(R,l.u_brightness_low),u_brightness_high:new o.bf(R,l.u_brightness_high),u_saturation_factor:new o.bf(R,l.u_saturation_factor),u_contrast_factor:new o.bf(R,l.u_contrast_factor),u_spin_weights:new o.bS(R,l.u_spin_weights),u_coords_top:new o.bR(R,l.u_coords_top),u_coords_bottom:new o.bR(R,l.u_coords_bottom)}),symbolIcon:(R,l)=>({u_is_size_zoom_constant:new o.bO(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(R,l.u_is_size_feature_constant),u_size_t:new o.bf(R,l.u_size_t),u_size:new o.bf(R,l.u_size),u_camera_to_center_distance:new o.bf(R,l.u_camera_to_center_distance),u_pitch:new o.bf(R,l.u_pitch),u_rotate_symbol:new o.bO(R,l.u_rotate_symbol),u_aspect_ratio:new o.bf(R,l.u_aspect_ratio),u_fade_change:new o.bf(R,l.u_fade_change),u_label_plane_matrix:new o.bQ(R,l.u_label_plane_matrix),u_coord_matrix:new o.bQ(R,l.u_coord_matrix),u_is_text:new o.bO(R,l.u_is_text),u_pitch_with_map:new o.bO(R,l.u_pitch_with_map),u_is_along_line:new o.bO(R,l.u_is_along_line),u_is_variable_anchor:new o.bO(R,l.u_is_variable_anchor),u_texsize:new o.bT(R,l.u_texsize),u_texture:new o.bO(R,l.u_texture),u_translation:new o.bT(R,l.u_translation),u_pitched_scale:new o.bf(R,l.u_pitched_scale)}),symbolSDF:(R,l)=>({u_is_size_zoom_constant:new o.bO(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(R,l.u_is_size_feature_constant),u_size_t:new o.bf(R,l.u_size_t),u_size:new o.bf(R,l.u_size),u_camera_to_center_distance:new o.bf(R,l.u_camera_to_center_distance),u_pitch:new o.bf(R,l.u_pitch),u_rotate_symbol:new o.bO(R,l.u_rotate_symbol),u_aspect_ratio:new o.bf(R,l.u_aspect_ratio),u_fade_change:new o.bf(R,l.u_fade_change),u_label_plane_matrix:new o.bQ(R,l.u_label_plane_matrix),u_coord_matrix:new o.bQ(R,l.u_coord_matrix),u_is_text:new o.bO(R,l.u_is_text),u_pitch_with_map:new o.bO(R,l.u_pitch_with_map),u_is_along_line:new o.bO(R,l.u_is_along_line),u_is_variable_anchor:new o.bO(R,l.u_is_variable_anchor),u_texsize:new o.bT(R,l.u_texsize),u_texture:new o.bO(R,l.u_texture),u_gamma_scale:new o.bf(R,l.u_gamma_scale),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_is_halo:new o.bO(R,l.u_is_halo),u_translation:new o.bT(R,l.u_translation),u_pitched_scale:new o.bf(R,l.u_pitched_scale)}),symbolTextAndIcon:(R,l)=>({u_is_size_zoom_constant:new o.bO(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(R,l.u_is_size_feature_constant),u_size_t:new o.bf(R,l.u_size_t),u_size:new o.bf(R,l.u_size),u_camera_to_center_distance:new o.bf(R,l.u_camera_to_center_distance),u_pitch:new o.bf(R,l.u_pitch),u_rotate_symbol:new o.bO(R,l.u_rotate_symbol),u_aspect_ratio:new o.bf(R,l.u_aspect_ratio),u_fade_change:new o.bf(R,l.u_fade_change),u_label_plane_matrix:new o.bQ(R,l.u_label_plane_matrix),u_coord_matrix:new o.bQ(R,l.u_coord_matrix),u_is_text:new o.bO(R,l.u_is_text),u_pitch_with_map:new o.bO(R,l.u_pitch_with_map),u_is_along_line:new o.bO(R,l.u_is_along_line),u_is_variable_anchor:new o.bO(R,l.u_is_variable_anchor),u_texsize:new o.bT(R,l.u_texsize),u_texsize_icon:new o.bT(R,l.u_texsize_icon),u_texture:new o.bO(R,l.u_texture),u_texture_icon:new o.bO(R,l.u_texture_icon),u_gamma_scale:new o.bf(R,l.u_gamma_scale),u_device_pixel_ratio:new o.bf(R,l.u_device_pixel_ratio),u_is_halo:new o.bO(R,l.u_is_halo),u_translation:new o.bT(R,l.u_translation),u_pitched_scale:new o.bf(R,l.u_pitched_scale)}),background:(R,l)=>({u_opacity:new o.bf(R,l.u_opacity),u_color:new o.bP(R,l.u_color)}),backgroundPattern:(R,l)=>({u_opacity:new o.bf(R,l.u_opacity),u_image:new o.bO(R,l.u_image),u_pattern_tl_a:new o.bT(R,l.u_pattern_tl_a),u_pattern_br_a:new o.bT(R,l.u_pattern_br_a),u_pattern_tl_b:new o.bT(R,l.u_pattern_tl_b),u_pattern_br_b:new o.bT(R,l.u_pattern_br_b),u_texsize:new o.bT(R,l.u_texsize),u_mix:new o.bf(R,l.u_mix),u_pattern_size_a:new o.bT(R,l.u_pattern_size_a),u_pattern_size_b:new o.bT(R,l.u_pattern_size_b),u_scale_a:new o.bf(R,l.u_scale_a),u_scale_b:new o.bf(R,l.u_scale_b),u_pixel_coord_upper:new o.bT(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(R,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bf(R,l.u_tile_units_to_pixels)}),terrain:(R,l)=>({u_texture:new o.bO(R,l.u_texture),u_ele_delta:new o.bf(R,l.u_ele_delta),u_fog_matrix:new o.bQ(R,l.u_fog_matrix),u_fog_color:new o.bP(R,l.u_fog_color),u_fog_ground_blend:new o.bf(R,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bf(R,l.u_fog_ground_blend_opacity),u_horizon_color:new o.bP(R,l.u_horizon_color),u_horizon_fog_blend:new o.bf(R,l.u_horizon_fog_blend),u_is_globe_mode:new o.bf(R,l.u_is_globe_mode)}),terrainDepth:(R,l)=>({u_ele_delta:new o.bf(R,l.u_ele_delta)}),terrainCoords:(R,l)=>({u_texture:new o.bO(R,l.u_texture),u_terrain_coords_id:new o.bf(R,l.u_terrain_coords_id),u_ele_delta:new o.bf(R,l.u_ele_delta)}),projectionErrorMeasurement:(R,l)=>({u_input:new o.bf(R,l.u_input),u_output_expected:new o.bf(R,l.u_output_expected)}),atmosphere:(R,l)=>({u_sun_pos:new o.bS(R,l.u_sun_pos),u_atmosphere_blend:new o.bf(R,l.u_atmosphere_blend),u_globe_position:new o.bS(R,l.u_globe_position),u_globe_radius:new o.bf(R,l.u_globe_radius),u_inv_proj_matrix:new o.bQ(R,l.u_inv_proj_matrix)}),sky:(R,l)=>({u_sky_color:new o.bP(R,l.u_sky_color),u_horizon_color:new o.bP(R,l.u_horizon_color),u_horizon:new o.bT(R,l.u_horizon),u_horizon_normal:new o.bT(R,l.u_horizon_normal),u_sky_horizon_blend:new o.bf(R,l.u_sky_horizon_blend),u_sky_blend:new o.bf(R,l.u_sky_blend)})};class su{constructor(l,p,w){this.context=l;const T=l.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Au={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tr{constructor(l,p,w,T){this.length=p.length,this.attributes=w,this.itemSize=p.bytesPerElement,this.dynamicDraw=T,this.context=l;const O=l.gl;this.buffer=O.createBuffer(),l.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let w=0;w<this.attributes.length;w++){const T=p.attributes[this.attributes[w].name];T!==void 0&&l.enableVertexAttribArray(T)}}setVertexAttribPointers(l,p,w){for(let T=0;T<this.attributes.length;T++){const O=this.attributes[T],j=p.attributes[O.name];j!==void 0&&l.vertexAttribPointer(j,O.components,l[Au[O.type]],!1,this.itemSize,O.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ur{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mn extends ur{getDefault(){return o.be.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Tn extends ur{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class yi extends ur{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Rn extends ur{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class A extends ur{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class y extends ur{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class _ extends ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class I extends ur{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class U extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class re extends ur{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ye extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class ke extends ur{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ke extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class yt extends ur{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class rr extends ur{getDefault(){return o.be.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class gr extends ur{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Wr extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class wn extends ur{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Un extends ur{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class Kn extends ur{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class jn extends ur{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Bn extends ur{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class zi extends ur{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Ri extends ur{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ho extends ur{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class fo extends ur{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Zo extends ur{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ko extends ur{getDefault(){return null}set(l){var p;if(l===this.current&&!this.dirty)return;const w=this.gl;Na(w)?w.bindVertexArray(l):(p=w.getExtension("OES_vertex_array_object"))===null||p===void 0||p.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Hl extends ur{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class lu extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class il extends ur{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Cs extends ur{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class dc extends Cs{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class As extends Cs{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class qa extends Cs{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}const us="Framebuffer is not complete";class Zu{constructor(l,p,w,T,O){this.context=l,this.width=p,this.height=w;const j=l.gl,X=this.framebuffer=j.createFramebuffer();if(this.colorAttachment=new dc(l,X),T)this.depthAttachment=O?new qa(l,X):new As(l,X);else if(O)throw new Error("Stencil cannot be set without depth");if(j.checkFramebufferStatus(j.FRAMEBUFFER)!==j.FRAMEBUFFER_COMPLETE)throw new Error(us)}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const w=this.depthAttachment.get();w&&l.deleteRenderbuffer(w)}l.deleteFramebuffer(this.framebuffer)}}class Ci{constructor(l){var p,w;if(this.gl=l,this.clearColor=new mn(this),this.clearDepth=new Tn(this),this.clearStencil=new yi(this),this.colorMask=new Rn(this),this.depthMask=new A(this),this.stencilMask=new y(this),this.stencilFunc=new _(this),this.stencilOp=new I(this),this.stencilTest=new U(this),this.depthRange=new re(this),this.depthTest=new ye(this),this.depthFunc=new ke(this),this.blend=new Ke(this),this.blendFunc=new yt(this),this.blendColor=new rr(this),this.blendEquation=new gr(this),this.cullFace=new Wr(this),this.cullFaceSide=new wn(this),this.frontFace=new Un(this),this.program=new Kn(this),this.activeTexture=new jn(this),this.viewport=new Bn(this),this.bindFramebuffer=new zi(this),this.bindRenderbuffer=new Ri(this),this.bindTexture=new ho(this),this.bindVertexBuffer=new fo(this),this.bindElementBuffer=new Zo(this),this.bindVertexArray=new Ko(this),this.pixelStoreUnpack=new Hl(this),this.pixelStoreUnpackPremultiplyAlpha=new lu(this),this.pixelStoreUnpackFlipY=new il(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Na(l)){this.HALF_FLOAT=l.HALF_FLOAT;const T=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(p=l.RGBA16F)!==null&&p!==void 0?p:T?.RGBA16F_EXT,this.RGB16F=(w=l.RGB16F)!==null&&w!==void 0?w:T?.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const T=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=T?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new su(this,l,p)}createVertexBuffer(l,p,w){return new tr(this,l,p,w)}createRenderbuffer(l,p,w){const T=this.gl,O=T.createRenderbuffer();return this.bindRenderbuffer.set(O),T.renderbufferStorage(T.RENDERBUFFER,l,p,w),this.bindRenderbuffer.set(null),O}createFramebuffer(l,p,w,T){return new Zu(this,l,p,w,T)}clear({color:l,depth:p,stencil:w}){const T=this.gl;let O=0;l&&(O|=T.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(O|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),w!==void 0&&(O|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),T.clear(O)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.bG(l.blendFunction,Pn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Na(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var p;return Na(this.gl)?this.gl.deleteVertexArray(l):(p=this.gl.getExtension("OES_vertex_array_object"))===null||p===void 0?void 0:p.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let uu;function pc(R,l,p,w,T){const O=R.context,j=R.transform,X=O.gl,te=R.useProgram("collisionBox"),le=[];let ge=0,Se=0;for(let ut=0;ut<w.length;ut++){const _t=w[ut],Dt=l.getTile(_t).getBucket(p);if(!Dt)continue;const kt=T?Dt.textCollisionBox:Dt.iconCollisionBox,zt=Dt.collisionCircleArray;zt.length>0&&(le.push({circleArray:zt,circleOffset:Se,coord:_t}),ge+=zt.length/4,Se=ge),kt&&te.draw(O,X.LINES,Wn.disabled,In.disabled,R.colorModeForRenderPass(),ii.disabled,wa(R.transform),R.style.map.terrain&&R.style.map.terrain.getTerrainData(_t),j.getProjectionData({overscaledTileID:_t,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),p.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,null,R.transform.zoom,null,null,kt.collisionVertexBuffer)}if(!T||!le.length)return;const be=R.useProgram("collisionCircle"),Le=new o.b_;Le.resize(4*ge),Le._trim();let Ge=0;for(const ut of le)for(let _t=0;_t<ut.circleArray.length/4;_t++){const Dt=4*_t,kt=ut.circleArray[Dt+0],zt=ut.circleArray[Dt+1],$t=ut.circleArray[Dt+2],It=ut.circleArray[Dt+3];Le.emplace(Ge++,kt,zt,$t,It,0),Le.emplace(Ge++,kt,zt,$t,It,1),Le.emplace(Ge++,kt,zt,$t,It,2),Le.emplace(Ge++,kt,zt,$t,It,3)}(!uu||uu.length<2*ge)&&(uu=(function(ut){const _t=2*ut,Dt=new o.c0;Dt.resize(_t),Dt._trim();for(let kt=0;kt<_t;kt++){const zt=6*kt;Dt.uint16[zt+0]=4*kt+0,Dt.uint16[zt+1]=4*kt+1,Dt.uint16[zt+2]=4*kt+2,Dt.uint16[zt+3]=4*kt+2,Dt.uint16[zt+4]=4*kt+3,Dt.uint16[zt+5]=4*kt+0}return Dt})(ge));const lt=O.createIndexBuffer(uu,!0),st=O.createVertexBuffer(Le,o.b$.members,!0);for(const ut of le){const _t=Tu(R.transform);be.draw(O,X.TRIANGLES,Wn.disabled,In.disabled,R.colorModeForRenderPass(),ii.disabled,_t,R.style.map.terrain&&R.style.map.terrain.getTerrainData(ut.coord),null,p.id,st,lt,o.aL.simpleSegment(0,2*ut.circleOffset,ut.circleArray.length,ut.circleArray.length/2),null,R.transform.zoom,null,null,null)}st.destroy(),lt.destroy()}const hd=o.af(new Float32Array(16));function Fh(R,l,p,w,T,O){const{horizontalAlign:j,verticalAlign:X}=o.aG(R);return new o.P((-(j-.5)*l/T+w[0])*O,(-(X-.5)*p/T+w[1])*O)}function ey(R,l,p,w,T,O){const j=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let X=w.mult(O);p||(X=X.rotate(-T));const te=j.add(X);return ft(te.x,te.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(p){const X=Xr(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(R),te=Math.atan(X.y/X.x)+(X.x<0?Math.PI:0);return R.add(w.rotate(te))}return R.add(w)}function pg(R,l,p,w,T,O,j,X,te,le,ge,Se){const be=R.text.placedSymbolArray,Le=R.text.dynamicLayoutVertexArray,Ge=R.icon.dynamicLayoutVertexArray,lt={};Le.clear();for(let st=0;st<be.length;st++){const ut=be.get(st),_t=ut.hidden||!ut.crossTileID||R.allowVerticalPlacement&&!ut.placedOrientation?null:w[ut.crossTileID];if(_t){const Dt=new o.P(ut.anchorX,ut.anchorY),kt={getElevation:Se,width:T.width,height:T.height,pitchedLabelPlaneMatrix:O,pitchWithMap:p,transform:T,tileAnchorPoint:Dt,translation:le,unwrappedTileID:ge},zt=p?Fn(Dt.x,Dt.y,kt):Xr(Dt.x,Dt.y,kt),$t=Mt(T.cameraToCenterDistance,zt.signedDistanceFromCamera);let It=o.ao(R.textSizeData,X,ut)*$t/o.aA;p&&(It*=R.tilePixelRatio/j);const{width:Kt,height:Er,anchor:vr,textOffset:_r,textBoxScale:Ar}=_t,gn=Fh(vr,Kt,Er,_r,Ar,It),dn=T.getPitchedTextCorrection(Dt.x+le[0],Dt.y+le[1],ge),Yr=ey(zt.point,kt,l,gn,-T.bearingInRadians,dn),Nn=R.allowVerticalPlacement&&ut.placedOrientation===o.an.vertical?Math.PI/2:0;for(let Mi=0;Mi<ut.numGlyphs;Mi++)o.au(Le,Yr,Nn);te&&ut.associatedIconIndex>=0&&(lt[ut.associatedIconIndex]={shiftedAnchor:Yr,angle:Nn})}else oo(ut.numGlyphs,Le)}if(te){Ge.clear();const st=R.icon.placedSymbolArray;for(let ut=0;ut<st.length;ut++){const _t=st.get(ut);if(_t.hidden)oo(_t.numGlyphs,Ge);else{const Dt=lt[ut];if(Dt)for(let kt=0;kt<_t.numGlyphs;kt++)o.au(Ge,Dt.shiftedAnchor,Dt.angle);else oo(_t.numGlyphs,Ge)}}R.icon.dynamicLayoutVertexBuffer.updateData(Ge)}R.text.dynamicLayoutVertexBuffer.updateData(Le)}function op(R,l,p){return p.iconsInText&&l?"symbolTextAndIcon":R?"symbolSDF":"symbolIcon"}function fd(R,l,p,w,T,O,j,X,te,le,ge,Se,be){const Le=R.context,Ge=Le.gl,lt=R.transform,st=X==="map",ut=te==="map",_t=X!=="viewport"&&p.layout.get("symbol-placement")!=="point",Dt=st&&!ut&&!_t,kt=!p.layout.get("symbol-sort-key").isConstant();let zt=!1;const $t=R.getDepthModeForSublayer(0,Wn.ReadOnly),It=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Kt=[],Er=lt.getCircleRadiusCorrection();for(const vr of w){const _r=l.getTile(vr),Ar=_r.getBucket(p);if(!Ar)continue;const gn=T?Ar.text:Ar.icon;if(!gn||!gn.segments.get().length||!gn.hasVisibleVertices)continue;const dn=gn.programConfigurations.get(p.id),Yr=T||Ar.sdfIcons,Nn=T?Ar.textSizeData:Ar.iconSizeData,Mi=ut||lt.pitch!==0,Ji=R.useProgram(op(Yr,T,Ar),dn),Ha=o.am(Nn,lt.zoom),fa=R.style.map.terrain&&R.style.map.terrain.getTerrainData(vr);let da,oa,aa,ma,ps=[0,0],Gi=null;if(T)oa=_r.glyphAtlasTexture,aa=Ge.LINEAR,da=_r.glyphAtlasTexture.size,Ar.iconsInText&&(ps=_r.imageAtlasTexture.size,Gi=_r.imageAtlasTexture,ma=Mi||R.options.rotating||R.options.zooming||Nn.kind==="composite"||Nn.kind==="camera"?Ge.LINEAR:Ge.NEAREST);else{const es=p.layout.get("icon-size").constantOr(0)!==1||Ar.iconsNeedLinear;oa=_r.imageAtlasTexture,aa=Yr||R.options.rotating||R.options.zooming||es||Mi?Ge.LINEAR:Ge.NEAREST,da=_r.imageAtlasTexture.size}const Is=o.aB(_r,1,R.transform.zoom),gs=vn(st,R.transform,Is),yc=o.L();o.ap(yc,gs);const Af=Ce(ut,st,R.transform,Is),If=o.aC(lt,_r,O,j),uh=lt.getProjectionData({overscaledTileID:vr,applyGlobeMatrix:!be,applyTerrainMatrix:!0}),vg=It&&Ar.hasTextData(),_g=p.layout.get("icon-text-fit")!=="none"&&vg&&Ar.hasIconData();if(_t){const es=R.style.map.terrain?(cu,zs)=>R.style.map.terrain.getElevation(vr,cu,zs):null,go=p.layout.get("text-rotation-alignment")==="map";Kr(Ar,R,T,gs,yc,ut,le,go,vr.toUnwrapped(),lt.width,lt.height,If,es)}const pp=T&&It||_g,Ru=_t||pp?hd:ut?gs:R.transform.clipSpaceToPixelsMatrix,zc=Yr&&p.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Pf;Pf=Yr?Ar.iconsInText?rl(Nn.kind,Ha,Dt,ut,_t,pp,R,Ru,Af,If,da,ps,Er):tl(Nn.kind,Ha,Dt,ut,_t,pp,R,Ru,Af,If,T,da,0,Er):Ia(Nn.kind,Ha,Dt,ut,_t,pp,R,Ru,Af,If,T,da,Er);const bd={program:Ji,buffers:gn,uniformValues:Pf,projectionData:uh,atlasTexture:oa,atlasTextureIcon:Gi,atlasInterpolation:aa,atlasInterpolationIcon:ma,isSDF:Yr,hasHalo:zc};if(kt&&Ar.canOverlap){zt=!0;const es=gn.segments.get();for(const go of es)Kt.push({segments:new o.aL([go]),sortKey:go.sortKey,state:bd,terrainData:fa})}else Kt.push({segments:gn.segments,sortKey:0,state:bd,terrainData:fa})}zt&&Kt.sort(((vr,_r)=>vr.sortKey-_r.sortKey));for(const vr of Kt){const _r=vr.state;if(Le.activeTexture.set(Ge.TEXTURE0),_r.atlasTexture.bind(_r.atlasInterpolation,Ge.CLAMP_TO_EDGE),_r.atlasTextureIcon&&(Le.activeTexture.set(Ge.TEXTURE1),_r.atlasTextureIcon&&_r.atlasTextureIcon.bind(_r.atlasInterpolationIcon,Ge.CLAMP_TO_EDGE)),_r.isSDF){const Ar=_r.uniformValues;_r.hasHalo&&(Ar.u_is_halo=1,_f(_r.buffers,vr.segments,p,R,_r.program,$t,ge,Se,Ar,_r.projectionData,vr.terrainData)),Ar.u_is_halo=0}_f(_r.buffers,vr.segments,p,R,_r.program,$t,ge,Se,_r.uniformValues,_r.projectionData,vr.terrainData)}}function _f(R,l,p,w,T,O,j,X,te,le,ge){const Se=w.context;T.draw(Se,Se.gl.TRIANGLES,O,j,X,ii.backCCW,te,ge,le,p.id,R.layoutVertexBuffer,R.indexBuffer,l,p.paint,w.transform.zoom,R.programConfigurations.get(p.id),R.dynamicLayoutVertexBuffer,R.opacityVertexBuffer)}function sp(R,l,p,w,T){const O=R.context,j=O.gl,X=In.disabled,te=new Pn([j.ONE,j.ONE],o.be.transparent,[!0,!0,!0,!0]),le=l.getBucket(p);if(!le)return;const ge=w.key;let Se=p.heatmapFbos.get(ge);Se||(Se=bf(O,l.tileSize,l.tileSize),p.heatmapFbos.set(ge,Se)),O.bindFramebuffer.set(Se.framebuffer),O.viewport.set([0,0,l.tileSize,l.tileSize]),O.clear({color:o.be.transparent});const be=le.programConfigurations.get(p.id),Le=R.useProgram("heatmap",be,!T),Ge=R.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),lt=R.style.map.terrain.getTerrainData(w);Le.draw(O,j.TRIANGLES,Wn.disabled,X,te,ii.disabled,el(l,R.transform.zoom,p.paint.get("heatmap-intensity"),1),lt,Ge,p.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,p.paint,R.transform.zoom,be)}function lp(R,l,p,w,T){const O=R.context,j=O.gl,X=R.transform;O.setColorMode(R.colorModeForRenderPass());const te=up(O,l),le=p.key,ge=l.heatmapFbos.get(le);if(!ge)return;O.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ge.colorAttachment.get()),O.activeTexture.set(j.TEXTURE1),te.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Se=X.getProjectionData({overscaledTileID:p,applyTerrainMatrix:T,applyGlobeMatrix:!w});R.useProgram("heatmapTexture").draw(O,j.TRIANGLES,Wn.disabled,In.disabled,R.colorModeForRenderPass(),ii.disabled,Qa(R,l,0,1),null,Se,l.id,R.rasterBoundsBuffer,R.quadTriangleIndexBuffer,R.rasterBoundsSegments,l.paint,X.zoom),ge.destroy(),l.heatmapFbos.delete(le)}function bf(R,l,p){var w,T;const O=R.gl,j=O.createTexture();O.bindTexture(O.TEXTURE_2D,j),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR);const X=(w=R.HALF_FLOAT)!==null&&w!==void 0?w:O.UNSIGNED_BYTE,te=(T=R.RGBA16F)!==null&&T!==void 0?T:O.RGBA;O.texImage2D(O.TEXTURE_2D,0,te,l,p,0,O.RGBA,X,null);const le=R.createFramebuffer(l,p,!1,!1);return le.colorAttachment.set(j),le}function up(R,l){return l.colorRampTexture||(l.colorRampTexture=new o.T(R,l.colorRamp,R.gl.RGBA)),l.colorRampTexture}function gg(R,l,p,w,T){if(!p||!w||!w.imageAtlas)return;const O=w.imageAtlas.patternPositions;let j=O[p.to.toString()],X=O[p.from.toString()];if(!j&&X&&(j=X),!X&&j&&(X=j),!j||!X){const te=T.getPaintProperty(l);j=O[te],X=O[te]}j&&X&&R.setConstantPatternPositions(j,X)}function dd(R,l,p,w,T,O,j,X){const te=R.context.gl,le="fill-pattern",ge=p.paint.get(le),Se=ge&&ge.constantOr(1),be=p.getCrossfadeParameters();let Le,Ge,lt,st,ut;const _t=R.transform,Dt=p.paint.get("fill-translate"),kt=p.paint.get("fill-translate-anchor");j?(Ge=Se&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Le=te.LINES):(Ge=Se?"fillPattern":"fill",Le=te.TRIANGLES);const zt=ge.constantOr(null);for(const $t of w){const It=l.getTile($t);if(Se&&!It.patternsLoaded())continue;const Kt=It.getBucket(p);if(!Kt)continue;const Er=Kt.programConfigurations.get(p.id),vr=R.useProgram(Ge,Er),_r=R.style.map.terrain&&R.style.map.terrain.getTerrainData($t);Se&&(R.context.activeTexture.set(te.TEXTURE0),It.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Er.updatePaintBuffers(be)),gg(Er,le,zt,It,p);const Ar=_t.getProjectionData({overscaledTileID:$t,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),gn=o.aC(_t,It,Dt,kt);if(j){st=Kt.indexBuffer2,ut=Kt.segments2;const Yr=[te.drawingBufferWidth,te.drawingBufferHeight];lt=Ge==="fillOutlinePattern"&&Se?Qs(R,be,It,Yr,gn):ha(Yr,gn)}else st=Kt.indexBuffer,ut=Kt.segments,lt=Se?To(R,be,It,gn):{u_fill_translate:gn};const dn=R.stencilModeForClipping($t);vr.draw(R.context,Le,T,dn,O,ii.backCCW,lt,_r,Ar,p.id,Kt.layoutVertexBuffer,st,ut,p.paint,R.transform.zoom,Er)}}function xf(R,l,p,w,T,O,j,X){const te=R.context,le=te.gl,ge="fill-extrusion-pattern",Se=p.paint.get(ge),be=Se.constantOr(1),Le=p.getCrossfadeParameters(),Ge=p.paint.get("fill-extrusion-opacity"),lt=Se.constantOr(null),st=R.transform;for(const ut of w){const _t=l.getTile(ut),Dt=_t.getBucket(p);if(!Dt)continue;const kt=R.style.map.terrain&&R.style.map.terrain.getTerrainData(ut),zt=Dt.programConfigurations.get(p.id),$t=R.useProgram(be?"fillExtrusionPattern":"fillExtrusion",zt);be&&(R.context.activeTexture.set(le.TEXTURE0),_t.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),zt.updatePaintBuffers(Le));const It=st.getProjectionData({overscaledTileID:ut,applyGlobeMatrix:!X,applyTerrainMatrix:!0});gg(zt,ge,lt,_t,p);const Kt=o.aC(st,_t,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Er=p.paint.get("fill-extrusion-vertical-gradient"),vr=be?Da(R,Er,Ge,Kt,ut,Le,_t):Ts(R,Er,Ge,Kt);$t.draw(te,te.gl.TRIANGLES,T,O,j,ii.backCCW,vr,kt,It,p.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,p.paint,R.transform.zoom,zt,R.style.map.terrain&&Dt.centroidVertexBuffer)}}function wf(R,l,p,w,T,O,j,X,te){var le;const ge=R.style.projection,Se=R.context,be=R.transform,Le=Se.gl,Ge=[`#define NUM_ILLUMINATION_SOURCES ${p.paint.get("hillshade-highlight-color").values.length}`],lt=R.useProgram("hillshade",null,!1,Ge),st=!R.options.moving;for(const ut of w){const _t=l.getTile(ut),Dt=_t.fbo;if(!Dt)continue;const kt=ge.getMeshFromTileID(Se,ut.canonical,X,!0,"raster"),zt=(le=R.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(ut);Se.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_2D,Dt.colorAttachment.get());const $t=be.getProjectionData({overscaledTileID:ut,aligned:st,applyGlobeMatrix:!te,applyTerrainMatrix:!0});lt.draw(Se,Le.TRIANGLES,O,T[ut.overscaledZ],j,ii.backCCW,Ro(R,_t,p),zt,$t,p.id,kt.vertexBuffer,kt.indexBuffer,kt.segments)}}function Bh(R,l,p,w,T,O,j,X,te){var le;const ge=R.style.projection,Se=R.context,be=R.transform,Le=Se.gl,Ge=R.useProgram("colorRelief"),lt=!R.options.moving;let st=!0;for(const ut of w){const _t=l.getTile(ut),Dt=_t.dem;if(st){const Er=Le.getParameter(Le.MAX_TEXTURE_SIZE),{elevationTexture:vr,colorTexture:_r}=p.getColorRampTextures(Se,Er,Dt.getUnpackVector());Se.activeTexture.set(Le.TEXTURE1),vr.bind(Le.NEAREST,Le.CLAMP_TO_EDGE),Se.activeTexture.set(Le.TEXTURE4),_r.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),st=!1}if(!Dt||!Dt.data)continue;const kt=Dt.stride,zt=Dt.getPixels();if(Se.activeTexture.set(Le.TEXTURE0),Se.pixelStoreUnpackPremultiplyAlpha.set(!1),_t.demTexture=_t.demTexture||R.getTileTexture(kt),_t.demTexture){const Er=_t.demTexture;Er.update(zt,{premultiply:!1}),Er.bind(Le.LINEAR,Le.CLAMP_TO_EDGE)}else _t.demTexture=new o.T(Se,zt,Le.RGBA,{premultiply:!1}),_t.demTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);const $t=ge.getMeshFromTileID(Se,ut.canonical,X,!0,"raster"),It=(le=R.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(ut),Kt=be.getProjectionData({overscaledTileID:ut,aligned:lt,applyGlobeMatrix:!te,applyTerrainMatrix:!0});Ge.draw(Se,Le.TRIANGLES,O,T[ut.overscaledZ],j,ii.backCCW,Vl(p,_t.dem),It,Kt,p.id,$t.vertexBuffer,$t.indexBuffer,$t.segments)}}const pd=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function Iu(R,l,p,w,T,O,j,X,te=!1,le=!1){const ge=w[w.length-1].overscaledZ,Se=R.context,be=Se.gl,Le=R.useProgram("raster"),Ge=R.transform,lt=R.style.projection,st=R.colorModeForRenderPass(),ut=!R.options.moving;for(const _t of w){const Dt=R.getDepthModeForSublayer(_t.overscaledZ-ge,p.paint.get("raster-opacity")===1?Wn.ReadWrite:Wn.ReadOnly,be.LESS),kt=l.getTile(_t);kt.registerFadeDuration(p.paint.get("raster-fade-duration"));const zt=l.findLoadedParent(_t,0),$t=l.findLoadedSibling(_t),It=W0(kt,zt||$t||null,l,p,R.transform,R.style.map.terrain);let Kt,Er;const vr=p.paint.get("raster-resampling")==="nearest"?be.NEAREST:be.LINEAR;Se.activeTexture.set(be.TEXTURE0),kt.texture.bind(vr,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),Se.activeTexture.set(be.TEXTURE1),zt?(zt.texture.bind(vr,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),Kt=Math.pow(2,zt.tileID.overscaledZ-kt.tileID.overscaledZ),Er=[kt.tileID.canonical.x*Kt%1,kt.tileID.canonical.y*Kt%1]):kt.texture.bind(vr,be.CLAMP_TO_EDGE,be.LINEAR_MIPMAP_NEAREST),kt.texture.useMipmap&&Se.extTextureFilterAnisotropic&&R.transform.pitch>20&&be.texParameterf(be.TEXTURE_2D,Se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Se.extTextureFilterAnisotropicMax);const _r=R.style.map.terrain&&R.style.map.terrain.getTerrainData(_t),Ar=Ge.getProjectionData({overscaledTileID:_t,aligned:ut,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),gn=jo(Er||[0,0],Kt||1,It,p,X),dn=lt.getMeshFromTileID(Se,_t.canonical,O,j,"raster");Le.draw(Se,be.TRIANGLES,Dt,T?T[_t.overscaledZ]:In.disabled,st,te?ii.frontCCW:ii.backCCW,gn,_r,Ar,p.id,dn.vertexBuffer,dn.indexBuffer,dn.segments)}}function W0(R,l,p,w,T,O){const j=w.paint.get("raster-fade-duration");if(!O&&j>0){const X=b.now(),te=(X-R.timeAdded)/j,le=l?(X-l.timeAdded)/j:-1,ge=p.getSource(),Se=Zt(T,{tileSize:ge.tileSize,roundZoom:ge.roundZoom}),be=!l||Math.abs(l.tileID.overscaledZ-Se)>Math.abs(R.tileID.overscaledZ-Se),Le=be&&R.refreshedUponExpiration?1:o.ag(be?te:1-le,0,1);return R.refreshedUponExpiration&&te>=1&&(R.refreshedUponExpiration=!1),l?{opacity:1,mix:1-Le}:{opacity:Le,mix:0}}return{opacity:1,mix:0}}const ty=new o.be(1,0,0,1),gd=new o.be(0,1,0,1),mg=new o.be(0,0,1,1),ry=new o.be(1,0,1,1),ny=new o.be(0,1,1,1);function md(R,l,p,w){Wl(R,0,l+p/2,R.transform.width,p,w)}function Ku(R,l,p,w){Wl(R,l-p/2,0,p,R.transform.height,w)}function Wl(R,l,p,w,T,O){const j=R.context,X=j.gl;X.enable(X.SCISSOR_TEST),X.scissor(l*R.pixelRatio,p*R.pixelRatio,w*R.pixelRatio,T*R.pixelRatio),j.clear({color:O}),X.disable(X.SCISSOR_TEST)}function gc(R,l,p){const w=R.context,T=w.gl,O=R.useProgram("debug"),j=Wn.disabled,X=In.disabled,te=R.colorModeForRenderPass(),le="$debug",ge=R.style.map.terrain&&R.style.map.terrain.getTerrainData(p);w.activeTexture.set(T.TEXTURE0);const Se=l.getTileByID(p.key).latestRawTileData,be=Math.floor((Se&&Se.byteLength||0)/1024),Le=l.getTile(p).tileSize,Ge=512/Math.min(Le,512)*(p.overscaledZ/R.transform.zoom)*.5;let lt=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(lt+=` => ${p.overscaledZ}`),(function(ut,_t){ut.initDebugOverlayCanvas();const Dt=ut.debugOverlayCanvas,kt=ut.context.gl,zt=ut.debugOverlayCanvas.getContext("2d");zt.clearRect(0,0,Dt.width,Dt.height),zt.shadowColor="white",zt.shadowBlur=2,zt.lineWidth=1.5,zt.strokeStyle="white",zt.textBaseline="top",zt.font="bold 36px Open Sans, sans-serif",zt.fillText(_t,5,5),zt.strokeText(_t,5,5),ut.debugOverlayTexture.update(Dt),ut.debugOverlayTexture.bind(kt.LINEAR,kt.CLAMP_TO_EDGE)})(R,`${lt} ${be}kB`);const st=R.transform.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!0,applyTerrainMatrix:!0});O.draw(w,T.TRIANGLES,j,X,Pn.alphaBlended,ii.disabled,Ul(o.be.transparent,Ge),null,st,le,R.debugBuffer,R.quadTriangleIndexBuffer,R.debugSegments),O.draw(w,T.LINE_STRIP,j,X,te,ii.disabled,Ul(o.be.red),ge,st,le,R.debugBuffer,R.tileBorderIndexBuffer,R.debugSegments)}function Io(R,l,p,w){const{isRenderingGlobe:T}=w,O=R.context,j=O.gl,X=R.transform,te=R.colorModeForRenderPass(),le=R.getDepthModeFor3D(),ge=R.useProgram("terrain");O.bindFramebuffer.set(null),O.viewport.set([0,0,R.width,R.height]);for(const Se of p){const be=l.getTerrainMesh(Se.tileID),Le=R.renderToTexture.getTexture(Se),Ge=l.getTerrainData(Se.tileID);O.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Le.texture);const lt=l.getMeshFrameDelta(X.zoom),st=X.calculateFogMatrix(Se.tileID.toUnwrapped()),ut=Es(lt,st,R.style.sky,X.pitch,T),_t=X.getProjectionData({overscaledTileID:Se.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ge.draw(O,j.TRIANGLES,le,In.disabled,te,ii.backCCW,ut,Ge,_t,"terrain",be.vertexBuffer,be.indexBuffer,be.segments)}}function Dc(R,l){if(!l.mesh){const p=new o.aK;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(1,1),p.emplaceBack(-1,1);const w=new o.aM;w.emplaceBack(0,1,2),w.emplaceBack(0,2,3),l.mesh=new Qt(R.createVertexBuffer(p,Gr.members),R.createIndexBuffer(w),o.aL.simpleSegment(0,0,p.length,w.length))}return l.mesh}class cs{constructor(l,p){this.context=new Ci(l),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Xt.maxUnderzooming+Xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ye}resize(l,p,w){if(this.width=Math.floor(l*w),this.height=Math.floor(p*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const T of this.style._order)this.style._layers[T].resize()}setup(){const l=this.context,p=new o.aK;p.emplaceBack(0,0),p.emplaceBack(o.$,0),p.emplaceBack(0,o.$),p.emplaceBack(o.$,o.$),this.tileExtentBuffer=l.createVertexBuffer(p,Gr.members),this.tileExtentSegments=o.aL.simpleSegment(0,0,4,2);const w=new o.aK;w.emplaceBack(0,0),w.emplaceBack(o.$,0),w.emplaceBack(0,o.$),w.emplaceBack(o.$,o.$),this.debugBuffer=l.createVertexBuffer(w,Gr.members),this.debugSegments=o.aL.simpleSegment(0,0,4,5);const T=new o.c5;T.emplaceBack(0,0,0,0),T.emplaceBack(o.$,0,o.$,0),T.emplaceBack(0,o.$,0,o.$),T.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=l.createVertexBuffer(T,Ks.members),this.rasterBoundsSegments=o.aL.simpleSegment(0,0,4,2);const O=new o.aK;O.emplaceBack(0,0),O.emplaceBack(o.$,0),O.emplaceBack(0,o.$),O.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(O,Gr.members),this.rasterBoundsSegmentsPosOnly=o.aL.simpleSegment(0,0,4,5);const j=new o.aK;j.emplaceBack(0,0),j.emplaceBack(1,0),j.emplaceBack(0,1),j.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(j,Gr.members),this.viewportSegments=o.aL.simpleSegment(0,0,4,2);const X=new o.c6;X.emplaceBack(0),X.emplaceBack(1),X.emplaceBack(3),X.emplaceBack(2),X.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(X);const te=new o.aM;te.emplaceBack(1,0,2),te.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(te);const le=this.context.gl;this.stencilClearMode=new In({func:le.ALWAYS,mask:0},0,255,le.ZERO,le.ZERO,le.ZERO),this.tileExtentMesh=new Qt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=o.L();o.bX(w,0,this.width,this.height,0,0,1),o.N(w,w,[p.drawingBufferWidth,p.drawingBufferHeight,0]);const T={mainMatrix:w,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w};this.useProgram("clippingMask",null,!0).draw(l,p.TRIANGLES,Wn.disabled,this.stencilClearMode,Pn.disabled,ii.disabled,null,null,T,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,p,w){if(this.currentStencilSource===l.source||!l.isTileClipped()||!p||!p.length)return;this.currentStencilSource=l.source,this.nextStencilID+p.length>256&&this.clearStencil();const T=this.context;T.setColorMode(Pn.disabled),T.setDepthMode(Wn.disabled);const O={};for(const j of p)O[j.key]=this.nextStencilID++;this._renderTileMasks(O,p,w,!0),this._renderTileMasks(O,p,w,!1),this._tileClippingMaskIDs=O}_renderTileMasks(l,p,w,T){const O=this.context,j=O.gl,X=this.style.projection,te=this.transform,le=this.useProgram("clippingMask");for(const ge of p){const Se=l[ge.key],be=this.style.map.terrain&&this.style.map.terrain.getTerrainData(ge),Le=X.getMeshFromTileID(this.context,ge.canonical,T,!0,"stencil"),Ge=te.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!w,applyTerrainMatrix:!0});le.draw(O,j.TRIANGLES,Wn.disabled,new In({func:j.ALWAYS,mask:0},Se,255,j.KEEP,j.KEEP,j.REPLACE),Pn.disabled,w?ii.disabled:ii.backCCW,null,be,Ge,"$clipping",Le.vertexBuffer,Le.indexBuffer,Le.segments)}}_renderTilesDepthBuffer(){const l=this.context,p=l.gl,w=this.style.projection,T=this.transform,O=this.useProgram("depth"),j=this.getDepthModeFor3D(),X=jt(T,{tileSize:T.tileSize});for(const te of X){const le=this.style.map.terrain&&this.style.map.terrain.getTerrainData(te),ge=w.getMeshFromTileID(this.context,te.canonical,!0,!0,"raster"),Se=T.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!0,applyTerrainMatrix:!0});O.draw(l,p.TRIANGLES,j,In.disabled,Pn.disabled,ii.backCCW,null,le,Se,"$clipping",ge.vertexBuffer,ge.indexBuffer,ge.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new In({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){const p=this.context.gl;return new In({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){const p=this.context.gl,w=l.sort(((j,X)=>X.overscaledZ-j.overscaledZ)),T=w[w.length-1].overscaledZ,O=w[0].overscaledZ-T+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();const j={};for(let X=0;X<O;X++)j[X+T]=new In({func:p.GEQUAL,mask:255},X+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=O,[j,w]}return[{[T]:In.disabled},w]}stencilConfigForOverlapTwoPass(l){const p=this.context.gl,w=l.sort(((j,X)=>X.overscaledZ-j.overscaledZ)),T=w[w.length-1].overscaledZ,O=w[0].overscaledZ-T+1;if(this.clearStencil(),O>1){const j={},X={};for(let te=0;te<O;te++)j[te+T]=new In({func:p.GREATER,mask:255},O+1+te,255,p.KEEP,p.KEEP,p.REPLACE),X[te+T]=new In({func:p.GREATER,mask:255},1+te,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID=2*O+1,[j,X,w]}return this.nextStencilID=3,[{[T]:new In({func:p.GREATER,mask:255},2,255,p.KEEP,p.KEEP,p.REPLACE)},{[T]:new In({func:p.GREATER,mask:255},1,255,p.KEEP,p.KEEP,p.REPLACE)},w]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new Pn([l.CONSTANT_COLOR,l.ONE],new o.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Pn.unblended:Pn.alphaBlended}getDepthModeForSublayer(l,p,w){if(!this.opaquePassEnabledForLayer())return Wn.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Wn(w||this.context.gl.LEQUAL,p,[T,T])}getDepthModeFor3D(){return new Wn(this.context.gl.LEQUAL,Wn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){var w,T;this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(b.now()),this.imageManager.beginFrame();const O=this.style._order,j=this.style.sourceCaches,X={},te={},le={},ge={isRenderingToTexture:!1,isRenderingGlobe:((w=l.projection)===null||w===void 0?void 0:w.transitionState)>0};for(const be in j){const Le=j[be];Le.used&&Le.prepare(this.context),X[be]=Le.getVisibleCoordinates(!1),te[be]=X[be].slice().reverse(),le[be]=Le.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let be=0;be<O.length;be++)if(this.style._layers[O[be]].is3D()){this.opaquePassCutoff=be;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const be of O){const Le=this.style._layers[be];if(!Le.hasOffscreenPass()||Le.isHidden(this.transform.zoom))continue;const Ge=te[Le.source];(Le.type==="custom"||Ge.length)&&this.renderLayer(this,j[Le.source],Le,Ge,ge)}if((T=this.style.projection)===null||T===void 0||T.updateGPUdependent({context:this.context,useProgram:be=>this.useProgram(be)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?o.be.black:o.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(be,Le){const Ge=be.context,lt=Ge.gl,st=(($t,It,Kt)=>{const Er=Math.cos(It.rollInRadians),vr=Math.sin(It.rollInRadians),_r=Be(It),Ar=It.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:$t.properties.get("sky-color"),u_horizon_color:$t.properties.get("horizon-color"),u_horizon:[(It.width/2-_r*vr)*Kt,(It.height/2+_r*Er)*Kt],u_horizon_normal:[-vr,Er],u_sky_horizon_blend:$t.properties.get("sky-horizon-blend")*It.height/2*Kt,u_sky_blend:Ar}})(Le,be.style.map.transform,be.pixelRatio),ut=new Wn(lt.LEQUAL,Wn.ReadWrite,[0,1]),_t=In.disabled,Dt=be.colorModeForRenderPass(),kt=be.useProgram("sky"),zt=Dc(Ge,Le);kt.draw(Ge,lt.TRIANGLES,ut,_t,Dt,ii.disabled,st,null,void 0,"sky",zt.vertexBuffer,zt.indexBuffer,zt.segments)})(this,this.style.sky),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const be=this.style._layers[O[this.currentLayer]],Le=j[be.source],Ge=X[be.source];this._renderTileClippingMasks(be,Ge,!1),this.renderLayer(this,Le,be,Ge,ge)}this.renderPass="translucent";let Se=!1;for(this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const be=this.style._layers[O[this.currentLayer]],Le=j[be.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(be,ge))continue;this.opaquePassEnabledForLayer()||Se||(Se=!0,ge.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ge=(be.type==="symbol"?le:te)[be.source];this._renderTileClippingMasks(be,X[be.source],!!this.renderToTexture),this.renderLayer(this,Le,be,Ge,ge)}if(ge.isRenderingGlobe&&(function(be,Le,Ge){const lt=be.context,st=lt.gl,ut=be.useProgram("atmosphere"),_t=new Wn(st.LEQUAL,Wn.ReadOnly,[0,1]),Dt=be.transform,kt=(function(Ar,gn){const dn=Ar.properties.get("position"),Yr=[-dn.x,-dn.y,-dn.z],Nn=o.af(new Float64Array(16));return Ar.properties.get("anchor")==="map"&&(o.b5(Nn,Nn,gn.rollInRadians),o.b6(Nn,Nn,-gn.pitchInRadians),o.b5(Nn,Nn,gn.bearingInRadians),o.b6(Nn,Nn,gn.center.lat*Math.PI/180),o.by(Nn,Nn,-gn.center.lng*Math.PI/180)),o.c4(Yr,Yr,Nn),Yr})(Ge,be.transform),zt=Dt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),$t=Le.properties.get("atmosphere-blend")*zt.projectionTransition;if($t===0)return;const It=La(Dt.worldSize,Dt.center.lat),Kt=Dt.inverseProjectionMatrix,Er=new Float64Array(4);Er[3]=1,o.av(Er,Er,Dt.modelViewProjectionMatrix),Er[0]/=Er[3],Er[1]/=Er[3],Er[2]/=Er[3],Er[3]=1,o.av(Er,Er,Kt),Er[0]/=Er[3],Er[1]/=Er[3],Er[2]/=Er[3],Er[3]=1;const vr=((Ar,gn,dn,Yr,Nn)=>({u_sun_pos:Ar,u_atmosphere_blend:gn,u_globe_position:dn,u_globe_radius:Yr,u_inv_proj_matrix:Nn}))(kt,$t,[Er[0],Er[1],Er[2]],It,Kt),_r=Dc(lt,Le);ut.draw(lt,st.TRIANGLES,_t,In.disabled,Pn.alphaBlended,ii.disabled,vr,null,null,"atmosphere",_r.vertexBuffer,_r.indexBuffer,_r.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const be=(function(Le,Ge){let lt=null;const st=Object.values(Le._layers).flatMap((kt=>kt.source&&!kt.isHidden(Ge)?[Le.sourceCaches[kt.source]]:[])),ut=st.filter((kt=>kt.getSource().type==="vector")),_t=st.filter((kt=>kt.getSource().type!=="vector")),Dt=kt=>{(!lt||lt.getSource().maxzoom<kt.getSource().maxzoom)&&(lt=kt)};return ut.forEach((kt=>Dt(kt))),lt||_t.forEach((kt=>Dt(kt))),lt})(this.style,this.transform.zoom);be&&(function(Le,Ge,lt){for(let st=0;st<lt.length;st++)gc(Le,Ge,lt[st])})(this,be,be.getVisibleCoordinates())}this.options.showPadding&&(function(be){const Le=be.transform.padding;md(be,be.transform.height-(Le.top||0),3,ty),md(be,Le.bottom||0,3,gd),Ku(be,Le.left||0,3,mg),Ku(be,be.transform.width-(Le.right||0),3,ry);const Ge=be.transform.centerPoint;(function(lt,st,ut,_t){Wl(lt,st-1,ut-10,2,20,_t),Wl(lt,st-10,ut-1,20,2,_t)})(be,Ge.x,be.transform.height-Ge.y,ny)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const p=this.terrainFacilitator.matrix,w=this.transform.modelViewProjectionMatrix;let T=this.terrainFacilitator.dirty;T||(T=l?!o.c7(p,w):!o.c8(p,w)),T||(T=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),T&&(o.c9(p,w),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(O,j){const X=O.context,te=X.gl,le=O.transform,ge=Pn.unblended,Se=new Wn(te.LEQUAL,Wn.ReadWrite,[0,1]),be=j.sourceCache.getRenderableTiles(),Le=O.useProgram("terrainDepth");X.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),X.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),X.clear({color:o.be.transparent,depth:1});for(const Ge of be){const lt=j.getTerrainMesh(Ge.tileID),st=j.getTerrainData(Ge.tileID),ut=le.getProjectionData({overscaledTileID:Ge.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),_t={u_ele_delta:j.getMeshFrameDelta(le.zoom)};Le.draw(X,te.TRIANGLES,Se,In.disabled,ge,ii.backCCW,_t,st,ut,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments)}X.bindFramebuffer.set(null),X.viewport.set([0,0,O.width,O.height])})(this,this.style.map.terrain),(function(O,j){const X=O.context,te=X.gl,le=O.transform,ge=Pn.unblended,Se=new Wn(te.LEQUAL,Wn.ReadWrite,[0,1]),be=j.getCoordsTexture(),Le=j.sourceCache.getRenderableTiles(),Ge=O.useProgram("terrainCoords");X.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),X.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),X.clear({color:o.be.transparent,depth:1}),j.coordsIndex=[];for(const lt of Le){const st=j.getTerrainMesh(lt.tileID),ut=j.getTerrainData(lt.tileID);X.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,be.texture);const _t={u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(le.zoom)},Dt=le.getProjectionData({overscaledTileID:lt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ge.draw(X,te.TRIANGLES,Se,In.disabled,ge,ii.backCCW,_t,ut,Dt,"terrain",st.vertexBuffer,st.indexBuffer,st.segments),j.coordsIndex.push(lt.tileID.key)}X.bindFramebuffer.set(null),X.viewport.set([0,0,O.width,O.height])})(this,this.style.map.terrain))}renderLayer(l,p,w,T,O){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(T||[]).length)&&(this.id=w.id,o.ca(w)?(function(j,X,te,le,ge,Se){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:be}=Se,Le=In.disabled,Ge=j.colorModeForRenderPass();(te._unevaluatedLayout.hasValue("text-variable-anchor")||te._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(lt,st,ut,_t,Dt,kt,zt,$t,It){const Kt=st.transform,Er=st.style.map.terrain,vr=Dt==="map",_r=kt==="map";for(const Ar of lt){const gn=_t.getTile(Ar),dn=gn.getBucket(ut);if(!dn||!dn.text||!dn.text.segments.get().length)continue;const Yr=o.am(dn.textSizeData,Kt.zoom),Nn=o.aB(gn,1,st.transform.zoom),Mi=vn(vr,st.transform,Nn),Ji=ut.layout.get("icon-text-fit")!=="none"&&dn.hasIconData();if(Yr){const Ha=Math.pow(2,Kt.zoom-gn.tileID.overscaledZ),fa=Er?(da,oa)=>Er.getElevation(Ar,da,oa):null;pg(dn,vr,_r,It,Kt,Mi,Ha,Yr,Ji,o.aC(Kt,gn,zt,$t),Ar.toUnwrapped(),fa)}}})(le,j,te,X,te.layout.get("text-rotation-alignment"),te.layout.get("text-pitch-alignment"),te.paint.get("text-translate"),te.paint.get("text-translate-anchor"),ge),te.paint.get("icon-opacity").constantOr(1)!==0&&fd(j,X,te,le,!1,te.paint.get("icon-translate"),te.paint.get("icon-translate-anchor"),te.layout.get("icon-rotation-alignment"),te.layout.get("icon-pitch-alignment"),te.layout.get("icon-keep-upright"),Le,Ge,be),te.paint.get("text-opacity").constantOr(1)!==0&&fd(j,X,te,le,!0,te.paint.get("text-translate"),te.paint.get("text-translate-anchor"),te.layout.get("text-rotation-alignment"),te.layout.get("text-pitch-alignment"),te.layout.get("text-keep-upright"),Le,Ge,be),X.map.showCollisionBoxes&&(pc(j,X,te,le,!0),pc(j,X,te,le,!1))})(l,p,w,T,this.style.placement.variableOffsets,O):o.cb(w)?(function(j,X,te,le,ge){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:Se}=ge,be=te.paint.get("circle-opacity"),Le=te.paint.get("circle-stroke-width"),Ge=te.paint.get("circle-stroke-opacity"),lt=!te.layout.get("circle-sort-key").isConstant();if(be.constantOr(1)===0&&(Le.constantOr(1)===0||Ge.constantOr(1)===0))return;const st=j.context,ut=st.gl,_t=j.transform,Dt=j.getDepthModeForSublayer(0,Wn.ReadOnly),kt=In.disabled,zt=j.colorModeForRenderPass(),$t=[],It=_t.getCircleRadiusCorrection();for(let Kt=0;Kt<le.length;Kt++){const Er=le[Kt],vr=X.getTile(Er),_r=vr.getBucket(te);if(!_r)continue;const Ar=te.paint.get("circle-translate"),gn=te.paint.get("circle-translate-anchor"),dn=o.aC(_t,vr,Ar,gn),Yr=_r.programConfigurations.get(te.id),Nn=j.useProgram("circle",Yr),Mi=_r.layoutVertexBuffer,Ji=_r.indexBuffer,Ha=j.style.map.terrain&&j.style.map.terrain.getTerrainData(Er),fa={programConfiguration:Yr,program:Nn,layoutVertexBuffer:Mi,indexBuffer:Ji,uniformValues:jl(j,vr,te,dn,It),terrainData:Ha,projectionData:_t.getProjectionData({overscaledTileID:Er,applyGlobeMatrix:!Se,applyTerrainMatrix:!0})};if(lt){const da=_r.segments.get();for(const oa of da)$t.push({segments:new o.aL([oa]),sortKey:oa.sortKey,state:fa})}else $t.push({segments:_r.segments,sortKey:0,state:fa})}lt&&$t.sort(((Kt,Er)=>Kt.sortKey-Er.sortKey));for(const Kt of $t){const{programConfiguration:Er,program:vr,layoutVertexBuffer:_r,indexBuffer:Ar,uniformValues:gn,terrainData:dn,projectionData:Yr}=Kt.state;vr.draw(st,ut.TRIANGLES,Dt,kt,zt,ii.backCCW,gn,dn,Yr,te.id,_r,Ar,Kt.segments,te.paint,j.transform.zoom,Er)}})(l,p,w,T,O):o.cc(w)?(function(j,X,te,le,ge){if(te.paint.get("heatmap-opacity")===0)return;const Se=j.context,{isRenderingToTexture:be,isRenderingGlobe:Le}=ge;if(j.style.map.terrain){for(const Ge of le){const lt=X.getTile(Ge);X.hasRenderableParent(Ge)||(j.renderPass==="offscreen"?sp(j,lt,te,Ge,Le):j.renderPass==="translucent"&&lp(j,te,Ge,be,Le))}Se.viewport.set([0,0,j.width,j.height])}else j.renderPass==="offscreen"?(function(Ge,lt,st,ut){const _t=Ge.context,Dt=_t.gl,kt=Ge.transform,zt=In.disabled,$t=new Pn([Dt.ONE,Dt.ONE],o.be.transparent,[!0,!0,!0,!0]);(function(It,Kt,Er){const vr=It.gl;It.activeTexture.set(vr.TEXTURE1),It.viewport.set([0,0,Kt.width/4,Kt.height/4]);let _r=Er.heatmapFbos.get(o.c1);_r?(vr.bindTexture(vr.TEXTURE_2D,_r.colorAttachment.get()),It.bindFramebuffer.set(_r.framebuffer)):(_r=bf(It,Kt.width/4,Kt.height/4),Er.heatmapFbos.set(o.c1,_r))})(_t,Ge,st),_t.clear({color:o.be.transparent});for(let It=0;It<ut.length;It++){const Kt=ut[It];if(lt.hasRenderableParent(Kt))continue;const Er=lt.getTile(Kt),vr=Er.getBucket(st);if(!vr)continue;const _r=vr.programConfigurations.get(st.id),Ar=Ge.useProgram("heatmap",_r),gn=kt.getProjectionData({overscaledTileID:Kt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),dn=kt.getCircleRadiusCorrection();Ar.draw(_t,Dt.TRIANGLES,Wn.disabled,zt,$t,ii.backCCW,el(Er,kt.zoom,st.paint.get("heatmap-intensity"),dn),null,gn,st.id,vr.layoutVertexBuffer,vr.indexBuffer,vr.segments,st.paint,kt.zoom,_r)}_t.viewport.set([0,0,Ge.width,Ge.height])})(j,X,te,le):j.renderPass==="translucent"&&(function(Ge,lt){const st=Ge.context,ut=st.gl;st.setColorMode(Ge.colorModeForRenderPass());const _t=lt.heatmapFbos.get(o.c1);_t&&(st.activeTexture.set(ut.TEXTURE0),ut.bindTexture(ut.TEXTURE_2D,_t.colorAttachment.get()),st.activeTexture.set(ut.TEXTURE1),up(st,lt).bind(ut.LINEAR,ut.CLAMP_TO_EDGE),Ge.useProgram("heatmapTexture").draw(st,ut.TRIANGLES,Wn.disabled,In.disabled,Ge.colorModeForRenderPass(),ii.disabled,Qa(Ge,lt,0,1),null,null,lt.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments,lt.paint,Ge.transform.zoom))})(j,te)})(l,p,w,T,O):o.cd(w)?(function(j,X,te,le,ge){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:Se}=ge,be=te.paint.get("line-opacity"),Le=te.paint.get("line-width");if(be.constantOr(1)===0||Le.constantOr(1)===0)return;const Ge=j.getDepthModeForSublayer(0,Wn.ReadOnly),lt=j.colorModeForRenderPass(),st=te.paint.get("line-dasharray"),ut=te.paint.get("line-pattern"),_t=ut.constantOr(1),Dt=te.paint.get("line-gradient"),kt=te.getCrossfadeParameters(),zt=_t?"linePattern":st?"lineSDF":Dt?"lineGradient":"line",$t=j.context,It=$t.gl,Kt=j.transform;let Er=!0;for(const vr of le){const _r=X.getTile(vr);if(_t&&!_r.patternsLoaded())continue;const Ar=_r.getBucket(te);if(!Ar)continue;const gn=Ar.programConfigurations.get(te.id),dn=j.context.program.get(),Yr=j.useProgram(zt,gn),Nn=Er||Yr.program!==dn,Mi=j.style.map.terrain&&j.style.map.terrain.getTerrainData(vr),Ji=ut.constantOr(null);if(Ji&&_r.imageAtlas){const aa=_r.imageAtlas,ma=aa.patternPositions[Ji.to.toString()],ps=aa.patternPositions[Ji.from.toString()];ma&&ps&&gn.setConstantPatternPositions(ma,ps)}const Ha=Kt.getProjectionData({overscaledTileID:vr,applyGlobeMatrix:!Se,applyTerrainMatrix:!0}),fa=Kt.getPixelScale(),da=_t?co(j,_r,te,fa,kt):st?Cu(j,_r,te,fa,st,kt):Dt?Co(j,_r,te,fa,Ar.lineClipsArray.length):$l(j,_r,te,fa);if(_t)$t.activeTexture.set(It.TEXTURE0),_r.imageAtlasTexture.bind(It.LINEAR,It.CLAMP_TO_EDGE),gn.updatePaintBuffers(kt);else if(st&&(Nn||j.lineAtlas.dirty))$t.activeTexture.set(It.TEXTURE0),j.lineAtlas.bind($t);else if(Dt){const aa=Ar.gradients[te.id];let ma=aa.texture;if(te.gradientVersion!==aa.version){let ps=256;if(te.stepInterpolant){const Gi=X.getSource().maxzoom,Is=vr.canonical.z===Gi?Math.ceil(1<<j.transform.maxZoom-vr.canonical.z):1;ps=o.ag(o.c2(Ar.maxLineLength/o.$*1024*Is),256,$t.maxTextureSize)}aa.gradient=o.c3({expression:te.gradientExpression(),evaluationKey:"lineProgress",resolution:ps,image:aa.gradient||void 0,clips:Ar.lineClipsArray}),aa.texture?aa.texture.update(aa.gradient):aa.texture=new o.T($t,aa.gradient,It.RGBA),aa.version=te.gradientVersion,ma=aa.texture}$t.activeTexture.set(It.TEXTURE0),ma.bind(te.stepInterpolant?It.NEAREST:It.LINEAR,It.CLAMP_TO_EDGE)}const oa=j.stencilModeForClipping(vr);Yr.draw($t,It.TRIANGLES,Ge,oa,lt,ii.disabled,da,Mi,Ha,te.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,te.paint,j.transform.zoom,gn,Ar.layoutVertexBuffer2),Er=!1}})(l,p,w,T,O):o.ce(w)?(function(j,X,te,le,ge){const Se=te.paint.get("fill-color"),be=te.paint.get("fill-opacity");if(be.constantOr(1)===0)return;const{isRenderingToTexture:Le}=ge,Ge=j.colorModeForRenderPass(),lt=te.paint.get("fill-pattern"),st=j.opaquePassEnabledForLayer()&&!lt.constantOr(1)&&Se.constantOr(o.be.transparent).a===1&&be.constantOr(0)===1?"opaque":"translucent";if(j.renderPass===st){const ut=j.getDepthModeForSublayer(1,j.renderPass==="opaque"?Wn.ReadWrite:Wn.ReadOnly);dd(j,X,te,le,ut,Ge,!1,Le)}if(j.renderPass==="translucent"&&te.paint.get("fill-antialias")){const ut=j.getDepthModeForSublayer(te.getPaintProperty("fill-outline-color")?2:0,Wn.ReadOnly);dd(j,X,te,le,ut,Ge,!0,Le)}})(l,p,w,T,O):o.cf(w)?(function(j,X,te,le,ge){const Se=te.paint.get("fill-extrusion-opacity");if(Se===0)return;const{isRenderingToTexture:be}=ge;if(j.renderPass==="translucent"){const Le=new Wn(j.context.gl.LEQUAL,Wn.ReadWrite,j.depthRangeFor3D);if(Se!==1||te.paint.get("fill-extrusion-pattern").constantOr(1))xf(j,X,te,le,Le,In.disabled,Pn.disabled,be),xf(j,X,te,le,Le,j.stencilModeFor3D(),j.colorModeForRenderPass(),be);else{const Ge=j.colorModeForRenderPass();xf(j,X,te,le,Le,In.disabled,Ge,be)}}})(l,p,w,T,O):o.cg(w)?(function(j,X,te,le,ge){if(j.renderPass!=="offscreen"&&j.renderPass!=="translucent")return;const{isRenderingToTexture:Se}=ge,be=j.context,Le=j.style.projection.useSubdivision,Ge=j.getDepthModeForSublayer(0,Wn.ReadOnly),lt=j.colorModeForRenderPass();if(j.renderPass==="offscreen")(function(st,ut,_t,Dt,kt,zt,$t){const It=st.context,Kt=It.gl;for(const Er of _t){const vr=ut.getTile(Er),_r=vr.dem;if(!_r||!_r.data||!vr.needsHillshadePrepare)continue;const Ar=_r.dim,gn=_r.stride,dn=_r.getPixels();if(It.activeTexture.set(Kt.TEXTURE1),It.pixelStoreUnpackPremultiplyAlpha.set(!1),vr.demTexture=vr.demTexture||st.getTileTexture(gn),vr.demTexture){const Nn=vr.demTexture;Nn.update(dn,{premultiply:!1}),Nn.bind(Kt.NEAREST,Kt.CLAMP_TO_EDGE)}else vr.demTexture=new o.T(It,dn,Kt.RGBA,{premultiply:!1}),vr.demTexture.bind(Kt.NEAREST,Kt.CLAMP_TO_EDGE);It.activeTexture.set(Kt.TEXTURE0);let Yr=vr.fbo;if(!Yr){const Nn=new o.T(It,{width:Ar,height:Ar,data:null},Kt.RGBA);Nn.bind(Kt.LINEAR,Kt.CLAMP_TO_EDGE),Yr=vr.fbo=It.createFramebuffer(Ar,Ar,!0,!1),Yr.colorAttachment.set(Nn.texture)}It.bindFramebuffer.set(Yr.framebuffer),It.viewport.set([0,0,Ar,Ar]),st.useProgram("hillshadePrepare").draw(It,Kt.TRIANGLES,kt,zt,$t,ii.disabled,hc(vr.tileID,_r),null,null,Dt.id,st.rasterBoundsBuffer,st.quadTriangleIndexBuffer,st.rasterBoundsSegments),vr.needsHillshadePrepare=!1}})(j,X,le,te,Ge,In.disabled,lt),be.viewport.set([0,0,j.width,j.height]);else if(j.renderPass==="translucent")if(Le){const[st,ut,_t]=j.stencilConfigForOverlapTwoPass(le);wf(j,X,te,_t,st,Ge,lt,!1,Se),wf(j,X,te,_t,ut,Ge,lt,!0,Se)}else{const[st,ut]=j.getStencilConfigForOverlapAndUpdateStencilID(le);wf(j,X,te,ut,st,Ge,lt,!1,Se)}})(l,p,w,T,O):o.ch(w)?(function(j,X,te,le,ge){if(j.renderPass!=="translucent"||!le.length)return;const{isRenderingToTexture:Se}=ge,be=j.style.projection.useSubdivision,Le=j.getDepthModeForSublayer(0,Wn.ReadOnly),Ge=j.colorModeForRenderPass();if(be){const[lt,st,ut]=j.stencilConfigForOverlapTwoPass(le);Bh(j,X,te,ut,lt,Le,Ge,!1,Se),Bh(j,X,te,ut,st,Le,Ge,!0,Se)}else{const[lt,st]=j.getStencilConfigForOverlapAndUpdateStencilID(le);Bh(j,X,te,st,lt,Le,Ge,!1,Se)}})(l,p,w,T,O):o.ci(w)?(function(j,X,te,le,ge){if(j.renderPass!=="translucent"||te.paint.get("raster-opacity")===0||!le.length)return;const{isRenderingToTexture:Se}=ge,be=X.getSource(),Le=j.style.projection.useSubdivision;if(be instanceof mt)Iu(j,X,te,le,null,!1,!1,be.tileCoords,be.flippedWindingOrder,Se);else if(Le){const[Ge,lt,st]=j.stencilConfigForOverlapTwoPass(le);Iu(j,X,te,st,Ge,!1,!0,pd,!1,Se),Iu(j,X,te,st,lt,!0,!0,pd,!1,Se)}else{const[Ge,lt]=j.getStencilConfigForOverlapAndUpdateStencilID(le);Iu(j,X,te,lt,Ge,!1,!0,pd,!1,Se)}})(l,p,w,T,O):o.cj(w)?(function(j,X,te,le,ge){const Se=te.paint.get("background-color"),be=te.paint.get("background-opacity");if(be===0)return;const{isRenderingToTexture:Le}=ge,Ge=j.context,lt=Ge.gl,st=j.style.projection,ut=j.transform,_t=ut.tileSize,Dt=te.paint.get("background-pattern");if(j.isPatternMissing(Dt))return;const kt=!Dt&&Se.a===1&&be===1&&j.opaquePassEnabledForLayer()?"opaque":"translucent";if(j.renderPass!==kt)return;const zt=In.disabled,$t=j.getDepthModeForSublayer(0,kt==="opaque"?Wn.ReadWrite:Wn.ReadOnly),It=j.colorModeForRenderPass(),Kt=j.useProgram(Dt?"backgroundPattern":"background"),Er=le||jt(ut,{tileSize:_t,terrain:j.style.map.terrain});Dt&&(Ge.activeTexture.set(lt.TEXTURE0),j.imageManager.bind(j.context));const vr=te.getCrossfadeParameters();for(const _r of Er){const Ar=ut.getProjectionData({overscaledTileID:_r,applyGlobeMatrix:!Le,applyTerrainMatrix:!0}),gn=Dt?ou(be,j,Dt,{tileID:_r,tileSize:_t},vr):ls(be,Se),dn=j.style.map.terrain&&j.style.map.terrain.getTerrainData(_r),Yr=st.getMeshFromTileID(Ge,_r.canonical,!1,!0,"raster");Kt.draw(Ge,lt.TRIANGLES,$t,zt,It,ii.backCCW,gn,dn,Ar,te.id,Yr.vertexBuffer,Yr.indexBuffer,Yr.segments)}})(l,0,w,T,O):o.ck(w)&&(function(j,X,te,le){const{isRenderingGlobe:ge}=le,Se=j.context,be=te.implementation,Le=j.style.projection,Ge=j.transform,lt=Ge.getProjectionDataForCustomLayer(ge),st={farZ:Ge.farZ,nearZ:Ge.nearZ,fov:Ge.fov*Math.PI/180,modelViewProjectionMatrix:Ge.modelViewProjectionMatrix,projectionMatrix:Ge.projectionMatrix,shaderData:{variantName:Le.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Le.shaderPreludeCode.vertexSource}`,define:Le.shaderDefine},defaultProjectionData:lt},ut=be.renderingMode?be.renderingMode:"2d";if(j.renderPass==="offscreen"){const _t=be.prerender;_t&&(j.setCustomLayerDefaults(),Se.setColorMode(j.colorModeForRenderPass()),_t.call(be,Se.gl,st),Se.setDirty(),j.setBaseState())}else if(j.renderPass==="translucent"){j.setCustomLayerDefaults(),Se.setColorMode(j.colorModeForRenderPass()),Se.setStencilMode(In.disabled);const _t=ut==="3d"?j.getDepthModeFor3D():j.getDepthModeForSublayer(0,Wn.ReadOnly);Se.setDepthMode(_t),be.render(Se.gl,st),Se.setDirty(),j.setBaseState(),Se.bindFramebuffer.set(null)}})(l,0,w,O))}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const p=this.imageManager.getPattern(l.from.toString()),w=this.imageManager.getPattern(l.to.toString());return!p||!w}useProgram(l,p,w=!1,T=[]){this.cache=this.cache||{};const O=!!this.style.map.terrain,j=this.style.projection,X=w?Ut.projectionMercator:j.shaderPreludeCode,te=w?on:j.shaderDefine,le=l+(p?p.cacheKey:"")+`/${w?en:j.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(O?"/terrain":"")+(T?`/${T.join("/")}`:"");return this.cache[le]||(this.cache[le]=new Js(this.context,Ut[l],p,nl[l],this._showOverdrawInspector,O,X,te,T)),this.cache[le]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:p}=this.context.gl;return this.width!==l||this.height!==p}}function Tl(R,l){let p,w=!1,T=null,O=null;const j=()=>{T=null,w&&(R.apply(O,p),T=setTimeout(j,l),w=!1)};return(...X)=>(w=!0,O=this,p=X,T||j(),T)}class yd{constructor(l){this._getCurrentHash=()=>{const p=window.location.hash.replace("#","");if(this._hashName){let w;return p.split("&").map((T=>T.split("="))).forEach((T=>{T[0]===this._hashName&&(w=T)})),(w&&w[1]||"").split("/")}return p.split("/")},this._onHashChange=()=>{const p=this._getCurrentHash();if(!this._isValidHash(p))return!1;const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(p[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:w,pitch:+(p[4]||0)}),!0},this._updateHashUnthrottled=()=>{const p=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,p)},this._removeHash=()=>{const p=this._getCurrentHash();if(p.length===0)return;const w=p.join("/");let T=w;T.split("&").length>0&&(T=T.split("&")[0]),this._hashName&&(T=`${this._hashName}=${w}`);let O=window.location.hash.replace(T,"");O.startsWith("#&")?O=O.slice(0,1)+O.slice(2):O==="#"&&(O="");let j=window.location.href.replace(/(#.+)?$/,O);j=j.replace("&&","&"),window.history.replaceState(window.history.state,null,j)},this._updateHash=Tl(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const p=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,T=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),O=Math.pow(10,T),j=Math.round(p.lng*O)/O,X=Math.round(p.lat*O)/O,te=this._map.getBearing(),le=this._map.getPitch();let ge="";if(ge+=l?`/${j}/${X}/${w}`:`${w}/${X}/${j}`,(te||le)&&(ge+="/"+Math.round(10*te)/10),le&&(ge+=`/${Math.round(le)}`),this._hashName){const Se=this._hashName;let be=!1;const Le=window.location.hash.slice(1).split("&").map((Ge=>{const lt=Ge.split("=")[0];return lt===Se?(be=!0,`${lt}=${ge}`):Ge})).filter((Ge=>Ge));return be||Le.push(`${Se}=${ge}`),`#${Le.join("&")}`}return`#${ge}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new o.S(+l[2],+l[1])}catch{return!1}const p=+l[0],w=+(l[3]||0),T=+(l[4]||0);return p>=this._map.getMinZoom()&&p<=this._map.getMaxZoom()&&w>=-180&&w<=180&&T>=this._map.getMinPitch()&&T<=this._map.getMaxPitch()}}const Sf={linearity:.3,easing:o.cl(0,0,.3,1)},zh=o.e({deceleration:2500,maxSpeed:1400},Sf),cp=o.e({deceleration:20,maxSpeed:1400},Sf),Ef=o.e({deceleration:1e3,maxSpeed:360},Sf),hp=o.e({deceleration:1e3,maxSpeed:90},Sf),iy=o.e({deceleration:1e3,maxSpeed:360},Sf);class vd{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:b.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=b.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:O}of this._inertiaBuffer)p.zoom+=O.zoomDelta||0,p.bearing+=O.bearingDelta||0,p.pitch+=O.pitchDelta||0,p.roll+=O.rollDelta||0,O.panDelta&&p.pan._add(O.panDelta),O.around&&(p.around=O.around),O.pinchAround&&(p.pinchAround=O.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(p.pan.mag()){const O=mc(p.pan.mag(),w,o.e({},zh,l||{})),j=p.pan.mult(O.amount/p.pan.mag()),X=this._map.cameraHelper.handlePanInertia(j,this._map.transform);T.center=X.easingCenter,T.offset=X.easingOffset,Fc(T,O)}if(p.zoom){const O=mc(p.zoom,w,cp);T.zoom=this._map.transform.zoom+O.amount,Fc(T,O)}if(p.bearing){const O=mc(p.bearing,w,Ef);T.bearing=this._map.transform.bearing+o.ag(O.amount,-179,179),Fc(T,O)}if(p.pitch){const O=mc(p.pitch,w,hp);T.pitch=this._map.transform.pitch+O.amount,Fc(T,O)}if(p.roll){const O=mc(p.roll,w,iy);T.roll=this._map.transform.roll+o.ag(O.amount,-179,179),Fc(T,O)}if(T.zoom||T.bearing){const O=p.pinchAround===void 0?p.around:p.pinchAround;T.around=O?this._map.unproject(O):this._map.getCenter()}return this.clear(),o.e(T,{noMoveStart:!0})}}function Fc(R,l){(!R.duration||R.duration<l.duration)&&(R.duration=l.duration,R.easing=l.easing)}function mc(R,l,p){const{maxSpeed:w,linearity:T,deceleration:O}=p,j=o.ag(R*T/(l/1e3),-w,w),X=Math.abs(j)/(O*T);return{easing:p.easing,duration:1e3*X,amount:j*(X/2)}}class al extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,w,T={}){w=w instanceof MouseEvent?w:new MouseEvent(l,w);const O=v.mousePos(p.getCanvas(),w),j=p.unproject(O);super(l,o.e({point:O,lngLat:j,originalEvent:w},T)),this._defaultPrevented=!1,this.target=p}}class Ju extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,w){const T=l==="touchend"?w.changedTouches:w.touches,O=v.touchPos(p.getCanvasContainer(),T),j=O.map((te=>p.unproject(te))),X=O.reduce(((te,le,ge,Se)=>te.add(le.div(Se.length))),new o.P(0,0));super(l,{points:O,point:X,lngLats:j,lngLat:p.unproject(X),originalEvent:w}),this._defaultPrevented=!1}}class fp extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,w){super(l,{originalEvent:w}),this._defaultPrevented=!1}}class ay{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new fp(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new al(l.type,this._map,l))}mouseup(l){this._map.fire(new al(l.type,this._map,l))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new al(l.type,this._map,l))}dblclick(l){return this._firePreventable(new al(l.type,this._map,l))}mouseover(l){this._map.fire(new al(l.type,this._map,l))}mouseout(l){this._map.fire(new al(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ju(l.type,this._map,l))}touchmove(l){this._map.fire(new Ju(l.type,this._map,l))}touchend(l){this._map.fire(new Ju(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ju(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oy{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new al(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new al("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new al(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tf{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(o.P.convert(l),this._map.terrain)}}class yg{constructor(l,p){this._map=l,this._tr=new Tf(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(v.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const w=p;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const T=this._startPos;this._lastPos=w,this._box||(this._box=v.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const O=Math.min(T.x,w.x),j=Math.max(T.x,w.x),X=Math.min(T.y,w.y),te=Math.max(T.y,w.y);v.setTransform(this._box,`translate(${O}px,${X}px)`),this._box.style.width=j-O+"px",this._box.style.height=te-X+"px"}mouseupWindow(l,p){if(!this._active||l.button!==0)return;const w=this._startPos,T=p;if(this.reset(),v.suppressClick(),w.x!==T.x||w.y!==T.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:l})),{cameraAnimation:O=>O.fitScreenCoordinates(w,T,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(v.remove(this._box),this._box=null),v.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new o.l(l,{originalEvent:p}))}}function dp(R,l){if(R.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${R.length}, points ${l.length}`);const p={};for(let w=0;w<R.length;w++)p[R[w].identifier]=l[w];return p}class sy{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,p,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),w.length===this.numTouches&&(this.centroid=(function(T){const O=new o.P(0,0);for(const j of T)O._add(j);return O.div(T.length)})(p),this.touches=dp(w,p)))}touchmove(l,p,w){if(this.aborted||!this.centroid)return;const T=dp(w,p);for(const O in this.touches){const j=T[O];(!j||j.dist(this.touches[O])>30)&&(this.aborted=!0)}}touchend(l,p,w){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class _d{constructor(l){this.singleTap=new sy(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,p,w){this.singleTap.touchstart(l,p,w)}touchmove(l,p,w){this.singleTap.touchmove(l,p,w)}touchend(l,p,w){const T=this.singleTap.touchend(l,p,w);if(T){const O=l.timeStamp-this.lastTime<500,j=!this.lastTap||this.lastTap.dist(T)<30;if(O&&j||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class jh{constructor(l){this._tr=new Tf(l),this._zoomIn=new _d({numTouches:1,numTaps:2}),this._zoomOut=new _d({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,w){this._zoomIn.touchstart(l,p,w),this._zoomOut.touchstart(l,p,w)}touchmove(l,p,w){this._zoomIn.touchmove(l,p,w),this._zoomOut.touchmove(l,p,w)}touchend(l,p,w){const T=this._zoomIn.touchend(l,p,w),O=this._zoomOut.touchend(l,p,w),j=this._tr;return T?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:X=>X.easeTo({duration:300,zoom:j.zoom+1,around:j.unproject(T)},{originalEvent:l})}):O?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:X=>X.easeTo({duration:300,zoom:j.zoom-1,around:j.unproject(O)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cf{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const p=this._moveFunction(...l);if(p.bearingDelta||p.pitchDelta||p.rollDelta||p.around||p.panDelta)return this._active=!0,p}dragStart(l,p){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(p)?p[0]:p,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,p){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const T=Array.isArray(p)?p[0]:p;return!this._moved&&T.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=T,this._move(w,T))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&v.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Pu=0,ku=2,V={[Pu]:1,[ku]:2};class Y{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const p=v.mouseButton(l);this._eventButton=p}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!(function(p,w){const T=V[w];return p.buttons===void 0||(p.buttons&T)!==T})(l,this._eventButton)}isValidEndEvent(l){return v.mouseButton(l)===this._eventButton}}class fe{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class Te{constructor(l=new Y({checkCorrectEvent:()=>!0}),p=new fe){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=p}_executeRelevantHandler(l,p,w){return l instanceof MouseEvent?p(l):typeof TouchEvent<"u"&&l instanceof TouchEvent?w(l):void 0}startMove(l){this._executeRelevantHandler(l,(p=>this.mouseMoveStateManager.startMove(p)),(p=>this.oneFingerTouchMoveStateManager.startMove(p)))}endMove(l){this._executeRelevantHandler(l,(p=>this.mouseMoveStateManager.endMove(p)),(p=>this.oneFingerTouchMoveStateManager.endMove(p)))}isValidStartEvent(l){return this._executeRelevantHandler(l,(p=>this.mouseMoveStateManager.isValidStartEvent(p)),(p=>this.oneFingerTouchMoveStateManager.isValidStartEvent(p)))}isValidMoveEvent(l){return this._executeRelevantHandler(l,(p=>this.mouseMoveStateManager.isValidMoveEvent(p)),(p=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(p)))}isValidEndEvent(l){return this._executeRelevantHandler(l,(p=>this.mouseMoveStateManager.isValidEndEvent(p)),(p=>this.oneFingerTouchMoveStateManager.isValidEndEvent(p)))}}const We=R=>{R.mousedown=R.dragStart,R.mousemoveWindow=R.dragMove,R.mouseup=R.dragEnd,R.contextmenu=l=>{l.preventDefault()}};class Je{constructor(l,p){this._clickTolerance=l.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,p,w){return this._calculateTransform(l,p,w)}touchmove(l,p,w){if(this._active){if(!this._shouldBePrevented(w.length))return l.preventDefault(),this._calculateTransform(l,p,w);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,p,w){this._calculateTransform(l,p,w),this._active&&this._shouldBePrevented(w.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,w){w.length>0&&(this._active=!0);const T=dp(w,p),O=new o.P(0,0),j=new o.P(0,0);let X=0;for(const le in T){const ge=T[le],Se=this._touches[le];Se&&(O._add(ge),j._add(ge.sub(Se)),X++,T[le]=ge)}if(this._touches=T,this._shouldBePrevented(X)||!j.mag())return;const te=j.div(X);return this._sum._add(te),this._sum.mag()<this._clickTolerance?void 0:{around:O.div(X),panDelta:te}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class et{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,p,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,w){if(!this._firstTwoTouches)return;l.preventDefault();const[T,O]=this._firstTwoTouches,j=it(w,p,T),X=it(w,p,O);if(!j||!X)return;const te=this._aroundCenter?null:j.add(X).div(2);return this._move([j,X],te,l)}touchend(l,p,w){if(!this._firstTwoTouches)return;const[T,O]=this._firstTwoTouches,j=it(w,p,T),X=it(w,p,O);j&&X||(this._active&&v.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function it(R,l,p){for(let w=0;w<R.length;w++)if(R[w].identifier===p)return l[w]}function ct(R,l){return Math.log(R/l)/Math.LN2}class bt extends et{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const w=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(ct(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ct(this._distance,w),pinchAround:p}}}function xt(R,l){return 180*R.angleWith(l)/Math.PI}class kr extends et{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p,w){const T=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xt(this._vector,T),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,w=xt(l,this._startVector);return Math.abs(w)<p}}function wt(R){return Math.abs(R.y)>Math.abs(R.x)}class ir extends et{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,p,w){super.touchstart(l,p,w),this._currentTouchCount=w.length}_start(l){this._lastPoints=l,wt(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,w){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const T=l[0].sub(this._lastPoints[0]),O=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(T,O,w.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(T.y+O.y)/2*-.5}):void 0}gestureBeginsVertically(l,p,w){if(this._valid!==void 0)return this._valid;const T=l.mag()>=2,O=p.mag()>=2;if(!T&&!O)return;if(!T||!O)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const j=l.y>0==p.y>0;return wt(l)&&wt(p)&&j}}const dr={panStep:100,bearingStep:15,pitchStep:10};class Ur{constructor(l){this._tr=new Tf(l);const p=dr;this._panStep=p.panStep,this._bearingStep=p.bearingStep,this._pitchStep=p.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,w=0,T=0,O=0,j=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?w=-1:(l.preventDefault(),O=-1);break;case 39:l.shiftKey?w=1:(l.preventDefault(),O=1);break;case 38:l.shiftKey?T=1:(l.preventDefault(),j=-1);break;case 40:l.shiftKey?T=-1:(l.preventDefault(),j=1);break;default:return}return this._rotationDisabled&&(w=0,T=0),{cameraAnimation:X=>{const te=this._tr;X.easeTo({duration:300,easeId:"keyboardHandler",easing:Cr,zoom:p?Math.round(te.zoom)+p*(l.shiftKey?2:1):te.zoom,bearing:te.bearing+w*this._bearingStep,pitch:te.pitch+T*this._pitchStep,offset:[-O*this._panStep,-j*this._panStep],center:te.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Cr(R){return R*(2-R)}const wr=4.000244140625,qr=1/450;class fn{constructor(l,p){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=l,this._tr=new Tf(l),this._triggerRenderFrame=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=qr}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let p=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const w=b.now(),T=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,p!==0&&p%wr==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(T*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=v.mousePos(this._map.getCanvas(),l),w=this._tr;this._aroundPoint=this._aroundCenter?w.transform.locationToScreenPoint(o.S.convert(w.center)):p,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const X=l.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=X),typeof this._targetZoom=="number"&&(this._targetZoom+=X)}if(this._delta!==0){const X=this._type==="wheel"&&Math.abs(this._delta)>wr?this._wheelZoomRate:this._defaultZoomRate;let te=2/(1+Math.exp(-Math.abs(this._delta*X)));this._delta<0&&te!==0&&(te=1/te);const le=typeof this._targetZoom!="number"?l.scale:o.ae(this._targetZoom);this._targetZoom=l.getConstrained(l.getCameraLngLat(),o.aj(le*te)).zoom,this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom!="number"?l.zoom:this._targetZoom,w=this._startZoom,T=this._easing;let O,j=!1;if(this._type==="wheel"&&w&&T){const X=b.now()-this._lastWheelEventTime,te=Math.min((X+5)/200,1),le=T(te);O=o.C.number(w,p,le),te<1?this._frameId||(this._frameId=!0):j=!0}else O=p,j=!0;return this._active=!0,j&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=O,{noInertia:!0,needsRenderFrame:!j,zoomDelta:O-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=o.cn;if(this._prevEase){const w=this._prevEase,T=(b.now()-w.start)/w.duration,O=w.easing(T+.01)-w.easing(T),j=.27/Math.sqrt(O*O+1e-4)*.01,X=Math.sqrt(.0729-j*j);p=o.cl(j,X,.25,1)}return this._prevEase={start:b.now(),duration:l,easing:p},p}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class an{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ri{constructor(l){this._tr=new Tf(l),this.reset()}reset(){this._active=!1}dblclick(l,p){return l.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gn{constructor(){this._tap=new _d({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,p,w){if(!this._swipePoint)if(this._tapTime){const T=p[0],O=l.timeStamp-this._tapTime<500,j=this._tapPoint.dist(T)<30;O&&j?w.length>0&&(this._swipePoint=T,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(l,p,w)}touchmove(l,p,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const T=p[0],O=T.y-this._swipePoint.y;return this._swipePoint=T,l.preventDefault(),this._active=!0,{zoomDelta:O/128}}}else this._tap.touchmove(l,p,w)}touchend(l,p,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const T=this._tap.touchend(l,p,w);T&&(this._tapTime=l.timeStamp,this._tapPoint=T)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oi{constructor(l,p,w){this._el=l,this._mousePan=p,this._touchPan=w}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yn{constructor(l,p,w,T){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=p,this._mousePitch=w,this._mouseRoll=T}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Zi{constructor(l,p,w,T){this._el=l,this._touchZoom=p,this._touchRotate=w,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Jo{constructor(l,p){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=p,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=v.create("div","maplibregl-cooperative-gesture-screen",l);let p=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(p=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const w=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),T=document.createElement("div");T.className="maplibregl-desktop-message",T.textContent=p,this._container.appendChild(T);const O=document.createElement("div");O.className="maplibregl-mobile-message",O.textContent=w,this._container.appendChild(O),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(v.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,p){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:l,originalEvent:p})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Pi=R=>R.zoom||R.drag||R.roll||R.pitch||R.rotate;class Jn extends o.l{}function Cn(R){return R.panDelta&&R.panDelta.mag()||R.zoomDelta||R.bearingDelta||R.pitchDelta||R.rollDelta}class Pa{constructor(l,p){this.handleWindowEvent=T=>{this.handleEvent(T,`${T.type}Window`)},this.handleEvent=(T,O)=>{if(T.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const j=T.type==="renderFrame"?void 0:T,X={needsRenderFrame:!1},te={},le={};for(const{handlerName:be,handler:Le,allowed:Ge}of this._handlers){if(!Le.isEnabled())continue;let lt;if(this._blockedByActive(le,Ge,be))Le.reset();else if(Le[O||T.type]){if(o.co(T,O||T.type)){const st=v.mousePos(this._map.getCanvas(),T);lt=Le[O||T.type](T,st)}else if(o.cp(T,O||T.type)){const st=this._getMapTouches(T.touches),ut=v.touchPos(this._map.getCanvas(),st);lt=Le[O||T.type](T,ut,st)}else o.cq(O||T.type)||(lt=Le[O||T.type](T));this.mergeHandlerResult(X,te,lt,be,j),lt&&lt.needsRenderFrame&&this._triggerRenderFrame()}(lt||Le.isActive())&&(le[be]=Le)}const ge={};for(const be in this._previousActiveHandlers)le[be]||(ge[be]=j);this._previousActiveHandlers=le,(Object.keys(ge).length||Cn(X))&&(this._changes.push([X,te,ge]),this._triggerRenderFrame()),(Object.keys(le).length||Cn(X))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Se}=X;Se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Se(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vd(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[T,O,j]of this._listeners)v.addEventListener(T,O,T===document?this.handleWindowEvent:this.handleEvent,j)}destroy(){for(const[l,p,w]of this._listeners)v.removeEventListener(l,p,l===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(l){const p=this._map,w=p.getCanvasContainer();this._add("mapEvent",new ay(p,l));const T=p.boxZoom=new yg(p,l);this._add("boxZoom",T),l.interactive&&l.boxZoom&&T.enable();const O=p.cooperativeGestures=new Jo(p,l.cooperativeGestures);this._add("cooperativeGestures",O),l.cooperativeGestures&&O.enable();const j=new jh(p),X=new ri(p);p.doubleClickZoom=new an(X,j),this._add("tapZoom",j),this._add("clickZoom",X),l.interactive&&l.doubleClickZoom&&p.doubleClickZoom.enable();const te=new Gn;this._add("tapDragZoom",te);const le=p.touchPitch=new ir(p);this._add("touchPitch",le),l.interactive&&l.touchPitch&&p.touchPitch.enable(l.touchPitch);const ge=()=>p.project(p.getCenter()),Se=(function({enable:kt,clickTolerance:zt,aroundCenter:$t=!0,minPixelCenterThreshold:It=100,rotateDegreesPerPixelMoved:Kt=.8},Er){const vr=new Y({checkCorrectEvent:_r=>v.mouseButton(_r)===0&&_r.ctrlKey||v.mouseButton(_r)===2&&!_r.ctrlKey});return new Cf({clickTolerance:zt,move:(_r,Ar)=>{const gn=Er();if($t&&Math.abs(gn.y-_r.y)>It)return{bearingDelta:o.cm(new o.P(_r.x,Ar.y),Ar,gn)};let dn=(Ar.x-_r.x)*Kt;return $t&&Ar.y<gn.y&&(dn=-dn),{bearingDelta:dn}},moveStateManager:vr,enable:kt,assignEvents:We})})(l,ge),be=(function({enable:kt,clickTolerance:zt,pitchDegreesPerPixelMoved:$t=-.5}){const It=new Y({checkCorrectEvent:Kt=>v.mouseButton(Kt)===0&&Kt.ctrlKey||v.mouseButton(Kt)===2});return new Cf({clickTolerance:zt,move:(Kt,Er)=>({pitchDelta:(Er.y-Kt.y)*$t}),moveStateManager:It,enable:kt,assignEvents:We})})(l),Le=(function({enable:kt,clickTolerance:zt,rollDegreesPerPixelMoved:$t=.3},It){const Kt=new Y({checkCorrectEvent:Er=>v.mouseButton(Er)===2&&Er.ctrlKey});return new Cf({clickTolerance:zt,move:(Er,vr)=>{const _r=It();let Ar=(vr.x-Er.x)*$t;return vr.y<_r.y&&(Ar=-Ar),{rollDelta:Ar}},moveStateManager:Kt,enable:kt,assignEvents:We})})(l,ge);p.dragRotate=new Yn(l,Se,be,Le),this._add("mouseRotate",Se,["mousePitch"]),this._add("mousePitch",be,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Le,["mousePitch"]),l.interactive&&l.dragRotate&&p.dragRotate.enable();const Ge=(function({enable:kt,clickTolerance:zt}){const $t=new Y({checkCorrectEvent:It=>v.mouseButton(It)===0&&!It.ctrlKey});return new Cf({clickTolerance:zt,move:(It,Kt)=>({around:Kt,panDelta:Kt.sub(It)}),activateOnStart:!0,moveStateManager:$t,enable:kt,assignEvents:We})})(l),lt=new Je(l,p);p.dragPan=new Oi(w,Ge,lt),this._add("mousePan",Ge),this._add("touchPan",lt,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&p.dragPan.enable(l.dragPan);const st=new kr,ut=new bt;p.touchZoomRotate=new Zi(w,ut,st,te),this._add("touchRotate",st,["touchPan","touchZoom"]),this._add("touchZoom",ut,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&p.touchZoomRotate.enable(l.touchZoomRotate);const _t=p.scrollZoom=new fn(p,(()=>this._triggerRenderFrame()));this._add("scrollZoom",_t,["mousePan"]),l.interactive&&l.scrollZoom&&p.scrollZoom.enable(l.scrollZoom);const Dt=p.keyboard=new Ur(p);this._add("keyboard",Dt),l.interactive&&l.keyboard&&p.keyboard.enable(),this._add("blockableMapEvent",new oy(p))}_add(l,p,w){this._handlers.push({handlerName:l,handler:p,allowed:w}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Pi(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,p,w){for(const T in l)if(T!==w&&(!p||p.indexOf(T)<0))return!0;return!1}_getMapTouches(l){const p=[];for(const w of l)this._el.contains(w.target)&&p.push(w);return p}mergeHandlerResult(l,p,w,T,O){if(!w)return;o.e(l,w);const j={handlerName:T,originalEvent:w.originalEvent||O};w.zoomDelta!==void 0&&(p.zoom=j),w.panDelta!==void 0&&(p.drag=j),w.rollDelta!==void 0&&(p.roll=j),w.pitchDelta!==void 0&&(p.pitch=j),w.bearingDelta!==void 0&&(p.rotate=j)}_applyChanges(){const l={},p={},w={};for(const[T,O,j]of this._changes)T.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(T.panDelta)),T.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+T.pitchDelta),T.rollDelta&&(l.rollDelta=(l.rollDelta||0)+T.rollDelta),T.around!==void 0&&(l.around=T.around),T.pinchAround!==void 0&&(l.pinchAround=T.pinchAround),T.noInertia&&(l.noInertia=T.noInertia),o.e(p,O),o.e(w,j);this._updateMapTransform(l,p,w),this._changes=[]}_updateMapTransform(l,p,w){const T=this._map,O=T._getTransformForUpdate(),j=T.terrain;if(!(Cn(l)||j&&this._terrainMovement))return this._fireEvents(p,w,!0);T._stop(!0);let{panDelta:X,zoomDelta:te,bearingDelta:le,pitchDelta:ge,rollDelta:Se,around:be,pinchAround:Le}=l;Le!==void 0&&(be=Le),be=be||T.transform.centerPoint,j&&!O.isPointOnMapSurface(be)&&(be=O.centerPoint);const Ge={panDelta:X,zoomDelta:te,rollDelta:Se,pitchDelta:ge,bearingDelta:le,around:be};this._map.cameraHelper.useGlobeControls&&!O.isPointOnMapSurface(be)&&(be=O.centerPoint);const lt=be.distSqr(O.centerPoint)<.01?O.center:O.screenPointToLocation(X?be.sub(X):be);j?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ge,O),this._terrainMovement||!p.drag&&!p.zoom?p.drag&&this._terrainMovement?O.setCenter(O.screenPointToLocation(O.centerPoint.sub(X))):this._map.cameraHelper.handleMapControlsPan(Ge,O,lt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Ge,O,lt))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ge,O),this._map.cameraHelper.handleMapControlsPan(Ge,O,lt)),T._applyUpdatedTransform(O),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,w,!0)}_fireEvents(l,p,w){const T=Pi(this._eventsInProgress),O=Pi(l),j={};for(const Se in l){const{originalEvent:be}=l[Se];this._eventsInProgress[Se]||(j[`${Se}start`]=be),this._eventsInProgress[Se]=l[Se]}!T&&O&&this._fireEvent("movestart",O.originalEvent);for(const Se in j)this._fireEvent(Se,j[Se]);O&&this._fireEvent("move",O.originalEvent);for(const Se in l){const{originalEvent:be}=l[Se];this._fireEvent(Se,be)}const X={};let te;for(const Se in this._eventsInProgress){const{handlerName:be,originalEvent:Le}=this._eventsInProgress[Se];this._handlersById[be].isActive()||(delete this._eventsInProgress[Se],te=p[be]||Le,X[`${Se}end`]=te)}for(const Se in X)this._fireEvent(Se,X[Se]);const le=Pi(this._eventsInProgress),ge=(T||O)&&!le;if(ge&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Se=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Se.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Se)}if(w&&ge){this._updatingCamera=!0;const Se=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=Le=>Le!==0&&-this._bearingSnap<Le&&Le<this._bearingSnap;!Se||!Se.essential&&b.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:te})),be(this._map.getBearing())&&this._map.resetNorth()):(be(Se.bearing||this._map.getBearing())&&(Se.bearing=0),Se.freezeElevation=!0,this._map.easeTo(Se,{originalEvent:te})),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new o.l(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((l=>{delete this._frameId,this.handleEvent(new Jn("renderFrame",{timeStamp:l})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class qn extends o.E{constructor(l,p,w){super(),this._renderFrameCallback=()=>{const T=Math.min((b.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(T)),T<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=w.bearingSnap,this.cameraHelper=p,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(l,p){l.apply(this.transform),this.transform=l,this.cameraHelper=p}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,p){return this.jumpTo({elevation:l},p),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,p,w){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},p),w)}panTo(l,p,w){return this.easeTo(o.e({center:l},p),w)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,w){return this.easeTo(o.e({zoom:l},p),w)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,p){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new o.l("movestart",p)).fire(new o.l("move",p)).fire(new o.l("moveend",p))),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,w){return this.easeTo(o.e({bearing:l},p),w)}resetNorth(l,p){return this.rotateTo(0,o.e({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}getRoll(){return this.transform.roll}setRoll(l,p){return this.jumpTo({roll:l},p),this}cameraForBounds(l,p){l=Lt.convert(l).adjustAntiMeridian();const w=p&&p.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),w,p)}_cameraForBoxAndBearing(l,p,w,T){const O={top:0,bottom:0,right:0,left:0};if(typeof(T=o.e({padding:O,offset:[0,0],maxZoom:this.transform.maxZoom},T)).padding=="number"){const le=T.padding;T.padding={top:le,bottom:le,right:le,left:le}}const j=o.e(O,T.padding);T.padding=j;const X=this.transform,te=new Lt(l,p);return this.cameraHelper.cameraForBoxAndBearing(T,j,te,w,X)}fitBounds(l,p,w){return this._fitInternal(this.cameraForBounds(l,p),p,w)}fitScreenCoordinates(l,p,w,T,O){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(l)),this.transform.screenPointToLocation(o.P.convert(p)),w,T),T,O)}_fitInternal(l,p,w){return l?(delete(p=o.e(l,p)).padding,p.linear?this.easeTo(p,w):this.flyTo(p,w)):this}jumpTo(l,p){this.stop();const w=this._getTransformForUpdate();let T=!1,O=!1,j=!1;const X=w.zoom;this.cameraHelper.handleJumpToCenterZoom(w,l);const te=w.zoom!==X;return"elevation"in l&&w.elevation!==+l.elevation&&w.setElevation(+l.elevation),"bearing"in l&&w.bearing!==+l.bearing&&(T=!0,w.setBearing(+l.bearing)),"pitch"in l&&w.pitch!==+l.pitch&&(O=!0,w.setPitch(+l.pitch)),"roll"in l&&w.roll!==+l.roll&&(j=!0,w.setRoll(+l.roll)),l.padding==null||w.isPaddingEqual(l.padding)||w.setPadding(l.padding),this._applyUpdatedTransform(w),this.fire(new o.l("movestart",p)).fire(new o.l("move",p)),te&&this.fire(new o.l("zoomstart",p)).fire(new o.l("zoom",p)).fire(new o.l("zoomend",p)),T&&this.fire(new o.l("rotatestart",p)).fire(new o.l("rotate",p)).fire(new o.l("rotateend",p)),O&&this.fire(new o.l("pitchstart",p)).fire(new o.l("pitch",p)).fire(new o.l("pitchend",p)),j&&this.fire(new o.l("rollstart",p)).fire(new o.l("roll",p)).fire(new o.l("rollend",p)),this.fire(new o.l("moveend",p))}calculateCameraOptionsFromTo(l,p,w,T=0){const O=o.a0.fromLngLat(l,p),j=o.a0.fromLngLat(w,T),X=j.x-O.x,te=j.y-O.y,le=j.z-O.z,ge=Math.hypot(X,te,le);if(ge===0)throw new Error("Can't calculate camera options with same From and To");const Se=Math.hypot(X,te),be=o.aj(this.transform.cameraToCenterDistance/ge/this.transform.tileSize),Le=180*Math.atan2(X,-te)/Math.PI;let Ge=180*Math.acos(Se/ge)/Math.PI;return Ge=le<0?90-Ge:90+Ge,{center:j.toLngLat(),elevation:T,zoom:be,pitch:Ge,bearing:Le}}calculateCameraOptionsFromCameraLngLatAltRotation(l,p,w,T,O){const j=this.transform.calculateCenterFromCameraLngLatAlt(l,p,w,T);return{center:j.center,elevation:j.elevation,zoom:j.zoom,bearing:w,pitch:T,roll:O}}easeTo(l,p){this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.cn},l)).animate===!1||!l.essential&&b.prefersReducedMotion)&&(l.duration=0);const w=this._getTransformForUpdate(),T=this.getBearing(),O=w.pitch,j=w.roll,X="bearing"in l?this._normalizeBearing(l.bearing,T):T,te="pitch"in l?+l.pitch:O,le="roll"in l?this._normalizeBearing(l.roll,j):j,ge="padding"in l?l.padding:w.padding,Se=o.P.convert(l.offset);let be,Le;l.around&&(be=o.S.convert(l.around),Le=w.locationToScreenPoint(be));const Ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},lt=this.cameraHelper.handleEaseTo(w,{bearing:X,pitch:te,roll:le,padding:ge,around:be,aroundPoint:Le,offsetAsPoint:Se,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||T!==X,this._pitching=this._pitching||te!==O,this._rolling=this._rolling||le!==j,this._padding=!w.isPaddingEqual(ge),this._zooming=this._zooming||lt.isZooming,this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,Ge),this.terrain&&this._prepareElevation(lt.elevationCenter),this._ease((st=>{lt.easeFunc(st),this.terrain&&!l.freezeElevation&&this._updateElevation(st),this._applyUpdatedTransform(w),this._fireMoveEvents(p)}),(st=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p,st)}),l),this}_prepareEase(l,p,w={}){this._moving=!0,p||w.moving||this.fire(new o.l("movestart",l)),this._zooming&&!w.zooming&&this.fire(new o.l("zoomstart",l)),this._rotating&&!w.rotating&&this.fire(new o.l("rotatestart",l)),this._pitching&&!w.pitching&&this.fire(new o.l("pitchstart",l)),this._rolling&&!w.rolling&&this.fire(new o.l("rollstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const p=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&p!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(w-(p-(w*l+this._elevationStart))/(1-l)),this._elevationTarget=p}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};const p=l.getCameraLngLat(),w=l.getCameraAltitude(),T=this.terrain?this.terrain.getElevationForLngLatZoom(p,l.zoom):0;if(w<T){const O=this.calculateCameraOptionsFromTo(p,T,l.center,l.elevation);return{pitch:O.pitch,zoom:O.zoom}}return{}}_applyUpdatedTransform(l){const p=[];if(p.push((T=>this._elevateCameraIfInsideTerrain(T))),this.transformCameraUpdate&&p.push((T=>this.transformCameraUpdate(T))),!p.length)return;const w=l.clone();for(const T of p){const O=w.clone(),{center:j,zoom:X,roll:te,pitch:le,bearing:ge,elevation:Se}=T(O);j&&O.setCenter(j),Se!==void 0&&O.setElevation(Se),X!==void 0&&O.setZoom(X),te!==void 0&&O.setRoll(te),le!==void 0&&O.setPitch(le),ge!==void 0&&O.setBearing(ge),w.apply(O)}this.transform.apply(w)}_fireMoveEvents(l){this.fire(new o.l("move",l)),this._zooming&&this.fire(new o.l("zoom",l)),this._rotating&&this.fire(new o.l("rotate",l)),this._pitching&&this.fire(new o.l("pitch",l)),this._rolling&&this.fire(new o.l("roll",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId;const w=this._zooming,T=this._rotating,O=this._pitching,j=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,w&&this.fire(new o.l("zoomend",l)),T&&this.fire(new o.l("rotateend",l)),O&&this.fire(new o.l("pitchend",l)),j&&this.fire(new o.l("rollend",l)),this.fire(new o.l("moveend",l))}flyTo(l,p){if(!l.essential&&b.prefersReducedMotion){const Ar=o.Q(l,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ar,p)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cn},l);const w=this._getTransformForUpdate(),T=w.bearing,O=w.pitch,j=w.roll,X=w.padding,te="bearing"in l?this._normalizeBearing(l.bearing,T):T,le="pitch"in l?+l.pitch:O,ge="roll"in l?this._normalizeBearing(l.roll,j):j,Se="padding"in l?l.padding:w.padding,be=o.P.convert(l.offset);let Le=w.centerPoint.add(be);const Ge=w.screenPointToLocation(Le),lt=this.cameraHelper.handleFlyTo(w,{bearing:te,pitch:le,roll:ge,padding:Se,locationAtOffset:Ge,offsetAsPoint:be,center:l.center,minZoom:l.minZoom,zoom:l.zoom});let st=l.curve;const ut=Math.max(w.width,w.height),_t=ut/lt.scaleOfZoom,Dt=lt.pixelPathLength;typeof lt.scaleOfMinZoom=="number"&&(st=Math.sqrt(ut/lt.scaleOfMinZoom/Dt*2));const kt=st*st;function zt(Ar){const gn=(_t*_t-ut*ut+(Ar?-1:1)*kt*kt*Dt*Dt)/(2*(Ar?_t:ut)*kt*Dt);return Math.log(Math.sqrt(gn*gn+1)-gn)}function $t(Ar){return(Math.exp(Ar)-Math.exp(-Ar))/2}function It(Ar){return(Math.exp(Ar)+Math.exp(-Ar))/2}const Kt=zt(!1);let Er=function(Ar){return It(Kt)/It(Kt+st*Ar)},vr=function(Ar){return ut*((It(Kt)*($t(gn=Kt+st*Ar)/It(gn))-$t(Kt))/kt)/Dt;var gn},_r=(zt(!0)-Kt)/st;if(Math.abs(Dt)<2e-6||!isFinite(_r)){if(Math.abs(ut-_t)<1e-6)return this.easeTo(l,p);const Ar=_t<ut?-1:1;_r=Math.abs(Math.log(_t/ut))/st,vr=()=>0,Er=gn=>Math.exp(Ar*st*gn)}return l.duration="duration"in l?+l.duration:1e3*_r/("screenSpeed"in l?+l.screenSpeed/st:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=T!==te,this._pitching=le!==O,this._rolling=ge!==j,this._padding=!w.isPaddingEqual(Se),this._prepareEase(p,!1),this.terrain&&this._prepareElevation(lt.targetCenter),this._ease((Ar=>{const gn=Ar*_r,dn=1/Er(gn),Yr=vr(gn);this._rotating&&w.setBearing(o.C.number(T,te,Ar)),this._pitching&&w.setPitch(o.C.number(O,le,Ar)),this._rolling&&w.setRoll(o.C.number(j,ge,Ar)),this._padding&&(w.interpolatePadding(X,Se,Ar),Le=w.centerPoint.add(be)),lt.easeFunc(Ar,dn,Yr,Le),this.terrain&&!l.freezeElevation&&this._updateElevation(Ar),this._applyUpdatedTransform(w),this._fireMoveEvents(p)}),(()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p)}),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){var w;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const T=this._onEaseEnd;delete this._onEaseEnd,T.call(this,p)}return l||(w=this.handlers)===null||w===void 0||w.stop(!1),this}_ease(l,p,w){w.animate===!1||w.duration===0?(l(1),p()):(this._easeStart=b.now(),this._easeOptions=w,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,p){l=o.aN(l,-180,180);const w=Math.abs(l-p);return Math.abs(l-360-p)<w&&(l-=360),Math.abs(l+360-p)<w&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(l),this.transform.tileZoom):null}}const Wi={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ka{constructor(l=Wi){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=p=>{!p||p.sourceDataType!=="metadata"&&p.sourceDataType!=="visibility"&&p.dataType!=="style"&&p.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=v.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=v.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=v.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){v.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const w=this._map._getUIString(`AttributionControl.${p}`);l.title=w,l.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map((T=>typeof T!="string"?"":T))):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const p=this._map.style.sourceCaches;for(const T in p){const O=p[T];if(O.used||O.usedForTerrain){const j=O.getSource();j.attribution&&l.indexOf(j.attribution)<0&&l.push(j.attribution)}}l=l.filter((T=>String(T).trim())),l.sort(((T,O)=>T.length-O.length)),l=l.filter(((T,O)=>{for(let j=O+1;j<l.length;j++)if(l[j].indexOf(T)>=0)return!1;return!0}));const w=l.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,l.length?(this._innerContainer.innerHTML=v.sanitize(w),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class hs{constructor(l={}){this._updateCompact=()=>{const p=this._container.children;if(p.length){const w=p[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=v.create("div","maplibregl-ctrl");const p=v.create("a","maplibregl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){v.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ol{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,w=p?this._queue.concat(p):this._queue;for(const T of w)if(T.id===l)return void(T.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const w of p)if(!w.cancelled&&(w.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Po=o.aI([{name:"a_pos3d",type:"Int16",components:3}]);class sl extends o.E{constructor(l){super(),this._lastTilesetChange=b.now(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,p){this.sourceCache.update(l,p),this._renderableTilesKeys=[];const w={};for(const T of jt(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))w[T.key]=!0,this._renderableTilesKeys.push(T.key),this._tiles[T.key]||(T.terrainRttPosMatrix32f=new Float64Array(16),o.bX(T.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[T.key]=new or(T,this.tileSize),this._lastTilesetChange=b.now());for(const T in this._tiles)w[T]||delete this._tiles[T]}freeRtt(l){for(const p in this._tiles){const w=this._tiles[p];(!l||w.tileID.equals(l)||w.tileID.isChildOf(l)||l.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((l=>this.getTileByID(l)))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,p){return p?this._getTerrainCoordsForTileRanges(l,p):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){const p={};for(const w of this._renderableTilesKeys){const T=this._tiles[w].tileID,O=l.clone(),j=o.b9();if(T.canonical.equals(l.canonical))o.bX(j,0,o.$,o.$,0,0,1);else if(T.canonical.isChildOf(l.canonical)){const X=T.canonical.z-l.canonical.z,te=T.canonical.x-(T.canonical.x>>X<<X),le=T.canonical.y-(T.canonical.y>>X<<X),ge=o.$>>X;o.bX(j,0,ge,ge,0,0,1),o.M(j,j,[-te*ge,-le*ge,0])}else{if(!l.canonical.isChildOf(T.canonical))continue;{const X=l.canonical.z-T.canonical.z,te=l.canonical.x-(l.canonical.x>>X<<X),le=l.canonical.y-(l.canonical.y>>X<<X),ge=o.$>>X;o.bX(j,0,o.$,o.$,0,0,1),o.M(j,j,[te*ge,le*ge,0]),o.N(j,j,[1/2**X,1/2**X,0])}}O.terrainRttPosMatrix32f=new Float32Array(j),p[w]=O}return p}_getTerrainCoordsForTileRanges(l,p){const w={};for(const T of this._renderableTilesKeys){const O=this._tiles[T].tileID;if(!this._isWithinTileRanges(O,p))continue;const j=l.clone(),X=o.b9();if(O.canonical.z===l.canonical.z){const te=l.canonical.x-O.canonical.x,le=l.canonical.y-O.canonical.y;o.bX(X,0,o.$,o.$,0,0,1),o.M(X,X,[te*o.$,le*o.$,0])}else if(O.canonical.z>l.canonical.z){const te=O.canonical.z-l.canonical.z,le=O.canonical.x-(O.canonical.x>>te<<te),ge=O.canonical.y-(O.canonical.y>>te<<te),Se=l.canonical.x-(O.canonical.x>>te),be=l.canonical.y-(O.canonical.y>>te),Le=o.$>>te;o.bX(X,0,Le,Le,0,0,1),o.M(X,X,[-le*Le+Se*o.$,-ge*Le+be*o.$,0])}else{const te=l.canonical.z-O.canonical.z,le=l.canonical.x-(l.canonical.x>>te<<te),ge=l.canonical.y-(l.canonical.y>>te<<te),Se=(l.canonical.x>>te)-O.canonical.x,be=(l.canonical.y>>te)-O.canonical.y,Le=o.$<<te;o.bX(X,0,Le,Le,0,0,1),o.M(X,X,[le*o.$+Se*Le,ge*o.$+be*Le,0])}j.terrainRttPosMatrix32f=new Float32Array(X),w[T]=j}return w}getSourceTile(l,p){const w=this.sourceCache._source;let T=l.overscaledZ-this.deltaZoom;if(T>w.maxzoom&&(T=w.maxzoom),T<w.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(T).key);let O=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!O||!O.dem)&&p)for(;T>=w.minzoom&&(!O||!O.dem);)O=this.sourceCache.getTileByID(l.scaledTo(T--).key);return O}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,p){return p[l.canonical.z]&&l.canonical.x>=p[l.canonical.z].minTileX&&l.canonical.x<=p[l.canonical.z].maxTileX&&l.canonical.y>=p[l.canonical.z].minTileY&&l.canonical.y<=p[l.canonical.z].maxTileY}}class po{constructor(l,p,w){this._meshCache={},this.painter=l,this.sourceCache=new sl(p),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,p,w,T=o.$){var O;if(!(p>=0&&p<T&&w>=0&&w<T))return 0;const j=this.getTerrainData(l),X=(O=j.tile)===null||O===void 0?void 0:O.dem;if(!X)return 0;const te=o.cr([],[p/T*o.$,w/T*o.$],j.u_terrain_matrix),le=[te[0]*X.dim,te[1]*X.dim],ge=Math.floor(le[0]),Se=Math.floor(le[1]),be=le[0]-ge,Le=le[1]-Se;return X.get(ge,Se)*(1-be)*(1-Le)+X.get(ge+1,Se)*be*(1-Le)+X.get(ge,Se+1)*(1-be)*Le+X.get(ge+1,Se+1)*be*Le}getElevationForLngLatZoom(l,p){if(!o.cs(p,l.wrap()))return 0;const{tileID:w,mercatorX:T,mercatorY:O}=this._getOverscaledTileIDFromLngLatZoom(l,p);return this.getElevation(w,T%o.$,O%o.$,o.$)}getElevation(l,p,w,T=o.$){return this.getDEMElevation(l,p,w,T)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const T=this.painter.context,O=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(T,O,T.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(T,new o.R({width:1,height:1}),T.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(T.gl.NEAREST,T.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.af([])}const p=this.sourceCache.getSourceTile(l,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const T=this.painter.context;p.demTexture=this.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new o.T(T,p.dem.getPixels(),T.gl.RGBA,{premultiply:!1}),p.demTexture.bind(T.gl.NEAREST,T.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const w=p&&p+p.tileID.key+l.key;if(w&&!this._demMatrixCache[w]){const T=this.sourceCache.sourceCache._source.maxzoom;let O=l.canonical.z-p.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=T?O=l.canonical.z-T:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const j=l.canonical.x-(l.canonical.x>>O<<O),X=l.canonical.y-(l.canonical.y>>O<<O),te=o.ct(new Float64Array(16),[1/(o.$<<O),1/(o.$<<O),0]);o.M(te,te,[j*o.$,X*o.$,0]),this._demMatrixCache[l.key]={matrix:te,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getFramebuffer(l){const p=this.painter,w=p.width/devicePixelRatio,T=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===T||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(p.context,{width:w,height:T,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(p.context,{width:w,height:T,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(w,T,!0,!1),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,w,T))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let O=0,j=0;O<this._coordsTextureSize;O++)for(let X=0;X<this._coordsTextureSize;X++,j+=4)p[j+0]=255&X,p[j+1]=255&O,p[j+2]=X>>8<<4|O>>8,p[j+3]=0;const w=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),T=new o.T(l,w,l.gl.RGBA,{premultiply:!1});return T.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=T,T}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const p=new Uint8Array(4),w=this.painter.context,T=w.gl,O=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),j=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),X=Math.round(this.painter.height/devicePixelRatio);w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),T.readPixels(O,X-j-1,1,1,T.RGBA,T.UNSIGNED_BYTE,p),w.bindFramebuffer.set(null);const te=p[0]+(p[2]>>4<<8),le=p[1]+((15&p[2])<<8),ge=this.coordsIndex[255-p[3]],Se=ge&&this.sourceCache.getTileByID(ge);if(!Se)return null;const be=this._coordsTextureSize,Le=(1<<Se.tileID.canonical.z)*be;return new o.a0((Se.tileID.canonical.x*be+te)/Le+Se.tileID.wrap,(Se.tileID.canonical.y*be+le)/Le,this.getElevation(Se.tileID,te,le,be))}depthAtPoint(l){const p=new Uint8Array(4),w=this.painter.context,T=w.gl;return w.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),T.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,T.RGBA,T.UNSIGNED_BYTE,p),w.bindFramebuffer.set(null),(p[0]/16777216+p[1]/65536+p[2]/256+p[3])/256}getTerrainMesh(l){var p;const w=((p=this.painter.style.projection)===null||p===void 0?void 0:p.transitionState)>0,T=w&&l.canonical.y===0,O=w&&l.canonical.y===(1<<l.canonical.z)-1,j=`m_${T?"n":""}_${O?"s":""}`;if(this._meshCache[j])return this._meshCache[j];const X=this.painter.context,te=new o.cu,le=new o.aM,ge=this.meshSize,Se=o.$/ge,be=ge*ge;for(let It=0;It<=ge;It++)for(let Kt=0;Kt<=ge;Kt++)te.emplaceBack(Kt*Se,It*Se,0);for(let It=0;It<be;It+=ge+1)for(let Kt=0;Kt<ge;Kt++)le.emplaceBack(Kt+It,ge+Kt+It+1,ge+Kt+It+2),le.emplaceBack(Kt+It,ge+Kt+It+2,Kt+It+1);const Le=te.length,Ge=Le+(ge+1),lt=(ge+1)*ge,st=T?o.bg:0,ut=T?0:1,_t=O?o.bh:o.$,Dt=O?0:1;for(let It=0;It<=ge;It++)te.emplaceBack(It*Se,st,ut);for(let It=0;It<=ge;It++)te.emplaceBack(It*Se,_t,Dt);for(let It=0;It<ge;It++)le.emplaceBack(lt+It,Ge+It,Ge+It+1),le.emplaceBack(lt+It,Ge+It+1,lt+It+1),le.emplaceBack(0+It,Le+It+1,Le+It),le.emplaceBack(0+It,0+It+1,Le+It+1);const kt=te.length,zt=kt+2*(ge+1);for(const It of[0,1])for(let Kt=0;Kt<=ge;Kt++)for(const Er of[0,1])te.emplaceBack(It*o.$,Kt*Se,Er);for(let It=0;It<2*ge;It+=2)le.emplaceBack(kt+It,kt+It+1,kt+It+3),le.emplaceBack(kt+It,kt+It+3,kt+It+2),le.emplaceBack(zt+It,zt+It+3,zt+It+1),le.emplaceBack(zt+It,zt+It+2,zt+It+3);const $t=new Qt(X.createVertexBuffer(te,Po.members),X.createIndexBuffer(le),o.aL.simpleSegment(0,0,te.length,le.length));return this._meshCache[j]=$t,$t}getMeshFrameDelta(l){return 2*Math.PI*o.bt/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,p){var w;const{tileID:T}=this._getOverscaledTileIDFromLngLatZoom(l,p);return(w=this.getMinMaxElevation(T).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(l){const p=this.getTerrainData(l).tile,w={minElevation:null,maxElevation:null};return p&&p.dem&&(w.minElevation=p.dem.min*this.exaggeration,w.maxElevation=p.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(l,p){const w=o.a0.fromLngLat(l.wrap()),T=(1<<p)*o.$,O=w.x*T,j=w.y*T,X=Math.floor(O/o.$),te=Math.floor(j/o.$);return{tileID:new o.Z(p,0,p,X,te),mercatorX:O,mercatorY:j}}}class Oo{constructor(l,p,w){this._context=l,this._size=p,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const p=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),p.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),p.colorAttachment.set(w.texture),{id:l,fbo:p,texture:w,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((p=>l.id!==p)),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const p of this._recentlyUsed)if(!this._objects[p].inUse)return this._objects[p];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((l=>!l.inUse))===!1}}const sn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Sn{constructor(l,p){this.painter=l,this.terrain=p,this.pool=new Oo(l.context,30,p.sourceCache.tileSize*p.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,p){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter((w=>!l._layers[w].isHidden(p))),this._coordsAscending={};for(const w in l.sourceCaches){this._coordsAscending[w]={};const T=l.sourceCaches[w].getVisibleCoordinates(),O=l.sourceCaches[w].getSource(),j=O instanceof mt?O.terrainTileRanges:null;for(const X of T){const te=this.terrain.sourceCache.getTerrainCoords(X,j);for(const le in te)this._coordsAscending[w][le]||(this._coordsAscending[w][le]=[]),this._coordsAscending[w][le].push(te[le])}}this._coordsAscendingStr={};for(const w of l._order){const T=l._layers[w],O=T.source;if(sn[T.type]&&!this._coordsAscendingStr[O]){this._coordsAscendingStr[O]={};for(const j in this._coordsAscending[O])this._coordsAscendingStr[O][j]=this._coordsAscending[O][j].map((X=>X.key)).sort().join()}}for(const w of this._renderableTiles)for(const T in this._coordsAscendingStr){const O=this._coordsAscendingStr[T][w.tileID.key];O&&O!==w.rttCoords[T]&&(w.rtt=[])}}renderLayer(l,p){if(l.isHidden(this.painter.transform.zoom))return!1;const w=Object.assign(Object.assign({},p),{isRenderingToTexture:!0}),T=l.type,O=this.painter,j=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(sn[T]&&(this._prevType&&sn[this._prevType]||this._stacks.push([]),this._prevType=T,this._stacks[this._stacks.length-1].push(l.id),!j))return!0;if(sn[this._prevType]||sn[T]&&j){this._prevType=T;const X=this._stacks.length-1,te=this._stacks[X]||[];for(const le of this._renderableTiles){if(this.pool.isFull()&&(Io(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(le),le.rtt[X]){const Se=this.pool.getObjectForId(le.rtt[X].id);if(Se.stamp===le.rtt[X].stamp){this.pool.useObject(Se);continue}}const ge=this.pool.getOrCreateFreeObject();this.pool.useObject(ge),this.pool.stampObject(ge),le.rtt[X]={id:ge.id,stamp:ge.stamp},O.context.bindFramebuffer.set(ge.fbo.framebuffer),O.context.clear({color:o.be.transparent,stencil:0}),O.currentStencilSource=void 0;for(let Se=0;Se<te.length;Se++){const be=O.style._layers[te[Se]],Le=be.source?this._coordsAscending[be.source][le.tileID.key]:[le.tileID];O.context.viewport.set([0,0,ge.fbo.width,ge.fbo.height]),O._renderTileClippingMasks(be,Le,!0),O.renderLayer(O,O.style.sourceCaches[be.source],be,Le,w),be.source&&(le.rttCoords[be.source]=this._coordsAscendingStr[be.source][le.tileID.key])}}return Io(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects(),sn[T]}return!1}}const eo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ga=u,Uo={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Wi,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},to={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class No{constructor(l,p,w=!1){this.mousedown=O=>{this.startMove(O,v.mousePos(this.element,O)),v.addEventListener(window,"mousemove",this.mousemove),v.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=O=>{this.move(O,v.mousePos(this.element,O))},this.mouseup=O=>{this._rotatePitchHanlder.dragEnd(O),this.offTemp()},this.touchstart=O=>{O.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=v.touchPos(this.element,O.targetTouches)[0],this.startMove(O,this._startPos),v.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.addEventListener(window,"touchend",this.touchend))},this.touchmove=O=>{O.targetTouches.length!==1?this.reset():(this._lastPos=v.touchPos(this.element,O.targetTouches)[0],this.move(O,this._lastPos))},this.touchend=O=>{O.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=p;const T=new Te;this._rotatePitchHanlder=new Cf({clickTolerance:3,move:(O,j)=>{const X=p.getBoundingClientRect(),te=new o.P((X.bottom-X.top)/2,(X.right-X.left)/2);return{bearingDelta:o.cm(new o.P(O.x,j.y),j,te),pitchDelta:w?-.5*(j.y-O.y):void 0}},moveStateManager:T,enable:!0,assignEvents:()=>{}}),this.map=l,v.addEventListener(p,"mousedown",this.mousedown),v.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),v.addEventListener(p,"touchcancel",this.reset)}startMove(l,p){this._rotatePitchHanlder.dragStart(l,p),v.disableDrag()}move(l,p){const w=this.map,{bearingDelta:T,pitchDelta:O}=this._rotatePitchHanlder.dragMove(l,p)||{};T&&w.setBearing(w.getBearing()+T),O&&w.setPitch(w.getPitch()+O)}off(){const l=this.element;v.removeEventListener(l,"mousedown",this.mousedown),v.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),v.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.removeEventListener(window,"touchend",this.touchend),v.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){v.enableDrag(),v.removeEventListener(window,"mousemove",this.mousemove),v.removeEventListener(window,"mouseup",this.mouseup),v.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.removeEventListener(window,"touchend",this.touchend)}}let Sa;function Ma(R,l,p,w=!1){if(w||!p.getCoveringTilesDetailsProvider().allowWorldCopies())return R?.wrap();const T=new o.S(R.lng,R.lat);if(R=new o.S(R.lng,R.lat),l){const O=new o.S(R.lng-360,R.lat),j=new o.S(R.lng+360,R.lat),X=p.locationToScreenPoint(R).distSqr(l);p.locationToScreenPoint(O).distSqr(l)<X?R=O:p.locationToScreenPoint(j).distSqr(l)<X&&(R=j)}for(;Math.abs(R.lng-p.center.lng)>180;){const O=p.locationToScreenPoint(R);if(O.x>=0&&O.y>=0&&O.x<=p.width&&O.y<=p.height)break;R.lng>p.center.lng?R.lng-=360:R.lng+=360}return R.lng!==T.lng&&p.isPointOnMapSurface(p.locationToScreenPoint(R))?R:T}const ro={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ia(R,l,p){const w=R.classList;for(const T in ro)w.remove(`maplibregl-${p}-anchor-${T}`);w.add(`maplibregl-${p}-anchor-${l}`)}class Ki extends o.E{constructor(l){if(super(),this._onKeyPress=p=>{const w=p.code,T=p.charCode||p.keyCode;w!=="Space"&&w!=="Enter"&&T!==32&&T!==13||this.togglePopup()},this._onMapClick=p=>{const w=p.originalEvent.target,T=this._element;this._popup&&(w===T||T.contains(w))&&this.togglePopup()},this._update=p=>{if(!this._map)return;const w=this._map.loaded()&&!this._map.isMoving();(p?.type==="terrain"||p?.type==="render"&&!w)&&this._map.once("render",this._update),this._lngLat=Ma(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let T="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?T=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(T=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let O="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?O="rotateX(0deg)":this._pitchAlignment==="map"&&(O=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||p&&p.type!=="moveend"||(this._pos=this._pos.round()),v.setTransform(this._element,`${ro[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${O} ${T}`),b.frameAsync(new AbortController).then((()=>{this._updateOpacity(p&&p.type==="moveend")})).catch((()=>{}))},this._onMove=p=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=p=>{this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l?.opacity,l?.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=v.create("div");const p=v.createNS("http://www.w3.org/2000/svg","svg"),w=41,T=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${w}px`),p.setAttributeNS(null,"width",`${T}px`),p.setAttributeNS(null,"viewBox",`0 0 ${T} ${w}`);const O=v.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"stroke","none"),O.setAttributeNS(null,"stroke-width","1"),O.setAttributeNS(null,"fill","none"),O.setAttributeNS(null,"fill-rule","evenodd");const j=v.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");const X=v.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(3.0, 29.0)"),X.setAttributeNS(null,"fill","#000000");const te=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ut of te){const _t=v.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",ut.rx),_t.setAttributeNS(null,"ry",ut.ry),X.appendChild(_t)}const le=v.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const ge=v.createNS("http://www.w3.org/2000/svg","path");ge.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(ge);const Se=v.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"opacity","0.25"),Se.setAttributeNS(null,"fill","#000000");const be=v.createNS("http://www.w3.org/2000/svg","path");be.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Se.appendChild(be);const Le=v.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Le.setAttributeNS(null,"fill","#FFFFFF");const Ge=v.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");const lt=v.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");const st=v.createNS("http://www.w3.org/2000/svg","circle");st.setAttributeNS(null,"fill","#FFFFFF"),st.setAttributeNS(null,"cx","5.5"),st.setAttributeNS(null,"cy","5.5"),st.setAttributeNS(null,"r","5.4999962"),Ge.appendChild(lt),Ge.appendChild(st),j.appendChild(X),j.appendChild(le),j.appendChild(Se),j.appendChild(Le),j.appendChild(Ge),p.appendChild(j),p.setAttributeNS(null,"height",w*this._scale+"px"),p.setAttributeNS(null,"width",T*this._scale+"px"),this._element.appendChild(p),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(p=>{p.preventDefault()})),this._element.addEventListener("mousedown",(p=>{p.preventDefault()})),ia(this._element,this._anchor,"marker"),l&&l.className)for(const p of l.className.split(" "))this._element.classList.add(p);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),l.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),v.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.S.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const T=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var p,w;const T=(p=this._map)===null||p===void 0?void 0:p.terrain,O=this._map.transform.isLocationOccluded(this._lngLat);if(!T||O){const Le=O?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Le&&(this._element.style.opacity=Le))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const j=this._map,X=j.terrain.depthAtPoint(this._pos),te=j.terrain.getElevationForLngLatZoom(this._lngLat,j.transform.tileZoom);if(j.transform.lngLatToCameraDepth(this._lngLat,te)-X<.006)return void(this._element.style.opacity=this._opacity);const le=-this._offset.y/j.transform.pixelsPerMeter,ge=Math.sin(j.getPitch()*Math.PI/180)*le,Se=j.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),be=j.transform.lngLatToCameraDepth(this._lngLat,te+ge)-Se>.006;!((w=this._popup)===null||w===void 0)&&w.isOpen()&&be&&this._popup.remove(),this._element.style.opacity=be?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,p){return(this._opacity===void 0||l===void 0&&p===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),p!==void 0&&(this._opacityWhenCovered=p),this._map&&this._updateOpacity(!0),this}}const Gl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Qo=0,Vo=!1;const Cl={maxWidth:100,unit:"metric"};function Ea(R,l,p){const w=p&&p.maxWidth||100,T=R._container.clientHeight/2,O=R._container.clientWidth/2,j=R.unproject([O-w/2,T]),X=R.unproject([O+w/2,T]),te=Math.round(R.project(X).x-R.project(j).x),le=Math.min(w,te,R._container.clientWidth),ge=j.distanceTo(X);if(p&&p.unit==="imperial"){const Se=3.2808*ge;Se>5280?fs(l,le,Se/5280,R._getUIString("ScaleControl.Miles")):fs(l,le,Se,R._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?fs(l,le,ge/1852,R._getUIString("ScaleControl.NauticalMiles")):ge>=1e3?fs(l,le,ge/1e3,R._getUIString("ScaleControl.Kilometers")):fs(l,le,ge,R._getUIString("ScaleControl.Meters"))}function fs(R,l,p,w){const T=(function(O){const j=Math.pow(10,`${Math.floor(O)}`.length-1);let X=O/j;return X=X>=10?10:X>=5?5:X>=3?3:X>=2?2:X>=1?1:(function(te){const le=Math.pow(10,Math.ceil(-Math.log(te)/Math.LN10));return Math.round(te*le)/le})(X),j*X})(p);R.style.width=l*(T/p)+"px",R.innerHTML=`${T}&nbsp;${w}`}const Al={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Bc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mu(R){if(R){if(typeof R=="number"){const l=Math.round(Math.abs(R)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,R),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-R),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(R,0),right:new o.P(-R,0)}}if(R instanceof o.P||Array.isArray(R)){const l=o.P.convert(R);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(R.center||[0,0]),top:o.P.convert(R.top||[0,0]),"top-left":o.P.convert(R["top-left"]||[0,0]),"top-right":o.P.convert(R["top-right"]||[0,0]),bottom:o.P.convert(R.bottom||[0,0]),"bottom-left":o.P.convert(R["bottom-left"]||[0,0]),"bottom-right":o.P.convert(R["bottom-right"]||[0,0]),left:o.P.convert(R.left||[0,0]),right:o.P.convert(R.right||[0,0])}}return Mu(new o.P(0,0))}const ds=u;s.AJAXError=o.cy,s.Event=o.l,s.Evented=o.E,s.LngLat=o.S,s.MercatorCoordinate=o.a0,s.Point=o.P,s.addProtocol=o.cz,s.config=o.a,s.removeProtocol=o.cA,s.AttributionControl=ka,s.BoxZoomHandler=yg,s.CanvasSource=Tr,s.CooperativeGesturesHandler=Jo,s.DoubleClickZoomHandler=an,s.DragPanHandler=Oi,s.DragRotateHandler=Yn,s.EdgeInsets=nn,s.FullscreenControl=class extends o.E{constructor(R={}){super(),this._onFullscreenChange=()=>{var l;let p=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=p?.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)p=p.shadowRoot.fullscreenElement;p===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,R&&R.container&&(R.container instanceof HTMLElement?this._container=R.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(R){return this._map=R,this._container||(this._container=this._map.getContainer()),this._controlContainer=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){v.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const R=this._fullscreenButton=v.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);v.create("span","maplibregl-ctrl-icon",R).setAttribute("aria-hidden","true"),R.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const R=this._getTitle();this._fullscreenButton.setAttribute("aria-label",R),this._fullscreenButton.title=R}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=yr,s.GeolocateControl=class extends o.E{constructor(R){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",l)),this._finish()}},this._updateCamera=l=>{const p=new o.S(l.coords.longitude,l.coords.latitude),w=l.coords.accuracy,T=this._map.getBearing(),O=o.e({bearing:T},this.options.fitBoundsOptions),j=Lt.fromLngLat(p,w);this._map.fitBounds(j,O,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const p=new o.S(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Vo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this._geolocateButton=v.create("button","maplibregl-ctrl-geolocate",this._container),v.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=v.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ki({element:this._dotElement}),this._circleElement=v.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ki({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(p=>{p.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p.originalEvent&&p.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Gl,R)}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(l=!1){if(Sa!==void 0&&!l)return Sa;if(window.navigator.permissions===void 0)return Sa=!!window.navigator.geolocation,Sa;try{Sa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Sa=!!window.navigator.geolocation}return Sa}))})().then((l=>this._finishSetupUI(l))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),v.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Qo=0,Vo=!1}_isOutOfMapMaxBounds(R){const l=this._map.getMaxBounds(),p=R.coords;return l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const R=this._map.getBounds(),l=R.getSouthEast(),p=R.getNorthEast(),w=l.distanceTo(p),T=Math.ceil(this._accuracy/(w/this._map._container.clientHeight)*2);this._circleElement.style.width=`${T}px`,this._circleElement.style.height=`${T}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Qo--,Vo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let R;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Qo++,Qo>1?(R={maximumAge:6e5,timeout:0},Vo=!0):(R=this.options.positionOptions,Vo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,R)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var R;const l=(R=this._map.getProjection())===null||R===void 0?void 0:R.type;this._map.setProjection(l!=="mercator"&&l?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var R;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((R=this._map.getProjection())===null||R===void 0?void 0:R.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=v.create("button","maplibregl-ctrl-globe",this._container),v.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){v.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=yd,s.ImageSource=mt,s.KeyboardHandler=Ur,s.LngLatBounds=Lt,s.LogoControl=hs,s.Map=class extends qn{constructor(R){var l,p;o.cv.mark(o.cw.create);const w=Object.assign(Object.assign(Object.assign({},Uo),R),{canvasContextAttributes:Object.assign(Object.assign({},Uo.canvasContextAttributes),R.canvasContextAttributes)});if(w.minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const T=new si,O=new Bi;if(w.minZoom!==void 0&&T.setMinZoom(w.minZoom),w.maxZoom!==void 0&&T.setMaxZoom(w.maxZoom),w.minPitch!==void 0&&T.setMinPitch(w.minPitch),w.maxPitch!==void 0&&T.setMaxPitch(w.maxPitch),w.renderWorldCopies!==void 0&&T.setRenderWorldCopies(w.renderWorldCopies),super(T,O,{bearingSnap:w.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ol,this._controls=[],this._mapId=o.a6(),this._contextLost=X=>{X.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:X}))},this._contextRestored=X=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:X}))},this._onMapScroll=X=>{if(X.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},w.canvasContextAttributes),this._trackResize=w.trackResize===!0,this._bearingSnap=w.bearingSnap,this._centerClampedToGround=w.centerClampedToGround,this._refreshExpiredTiles=w.refreshExpiredTiles===!0,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions===!0,this._collectResourceTiming=w.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},eo),w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this.transformCameraUpdate=w.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=w.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=M.addThrottleControl((()=>this.isMoving())),this._requestManager=new z(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let X=!1;const te=Tl((le=>{this._trackResize&&!this._removed&&(this.resize(le),this.redraw())}),50);this._resizeObserver=new ResizeObserver((le=>{X?te(le):X=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Pa(this,w),this._hash=w.hash&&new yd(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,roll:w.roll}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0}))));const j=typeof w.style=="string"||((p=(l=w.style)===null||l===void 0?void 0:l.projection)===null||p===void 0?void 0:p.type)!=="globe";this.resize(null,j),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new ka(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new hs,w.logoPosition),this.on("style.load",(()=>{if(j||this._resizeTransform(),this.transform.unmodified){const X=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(X)}})),this.on("data",(X=>{this._update(X.dataType==="style"),this.fire(new o.l(`${X.dataType}data`,X))})),this.on("dataloading",(X=>{this.fire(new o.l(`${X.dataType}dataloading`,X))})),this.on("dataabort",(X=>{this.fire(new o.l("sourcedataabort",X))}))}_getMapId(){return this._mapId}setGlobalStateProperty(R,l){return this.style.setGlobalStateProperty(R,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(R,l){if(l===void 0&&(l=R.getDefaultPosition?R.getDefaultPosition():"top-right"),!R||!R.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=R.onAdd(this);this._controls.push(R);const w=this._controlPositions[l];return l.indexOf("bottom")!==-1?w.insertBefore(p,w.firstChild):w.appendChild(p),this}removeControl(R){if(!R||!R.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(R);return l>-1&&this._controls.splice(l,1),R.onRemove(this),this}hasControl(R){return this._controls.indexOf(R)>-1}calculateCameraOptionsFromTo(R,l,p,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLatZoom(p,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(R,l,p,w)}resize(R,l=!0){const[p,w]=this._containerDimensions(),T=this._getClampedPixelRatio(p,w);if(this._resizeCanvas(p,w,T),this.painter.resize(p,w,T),this.painter.overLimit()){const j=this.painter.context.gl;this._maxCanvasSize=[j.drawingBufferWidth,j.drawingBufferHeight];const X=this._getClampedPixelRatio(p,w);this._resizeCanvas(p,w,X),this.painter.resize(p,w,X)}this._resizeTransform(l);const O=!this._moving;return O&&(this.stop(),this.fire(new o.l("movestart",R)).fire(new o.l("move",R))),this.fire(new o.l("resize",R)),O&&this.fire(new o.l("moveend",R)),this}_resizeTransform(R=!0){var l;const[p,w]=this._containerDimensions();this.transform.resize(p,w,R),(l=this._requestedCameraState)===null||l===void 0||l.resize(p,w,R)}_getClampedPixelRatio(R,l){const{0:p,1:w}=this._maxCanvasSize,T=this.getPixelRatio(),O=R*T,j=l*T;return Math.min(O>p?p/O:1,j>w?w/j:1)*T}getPixelRatio(){var R;return(R=this._overridePixelRatio)!==null&&R!==void 0?R:devicePixelRatio}setPixelRatio(R){this._overridePixelRatio=R,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(R){return this.transform.setMaxBounds(Lt.convert(R)),this._update()}setMinZoom(R){if((R=R??-2)>=-2&&R<=this.transform.maxZoom)return this.transform.setMinZoom(R),this._update(),this.getZoom()<R&&this.setZoom(R),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(R){if((R=R??22)>=this.transform.minZoom)return this.transform.setMaxZoom(R),this._update(),this.getZoom()>R&&this.setZoom(R),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(R){if((R=R??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(R>=0&&R<=this.transform.maxPitch)return this.transform.setMinPitch(R),this._update(),this.getPitch()<R&&this.setPitch(R),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(R){if((R=R??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(R>=this.transform.minPitch)return this.transform.setMaxPitch(R),this._update(),this.getPitch()>R&&this.setPitch(R),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(R){return this.transform.setRenderWorldCopies(R),this._update()}project(R){return this.transform.locationToScreenPoint(o.S.convert(R),this.style&&this.terrain)}unproject(R){return this.transform.screenPointToLocation(o.P.convert(R),this.terrain)}isMoving(){var R;return this._moving||((R=this.handlers)===null||R===void 0?void 0:R.isMoving())}isZooming(){var R;return this._zooming||((R=this.handlers)===null||R===void 0?void 0:R.isZooming())}isRotating(){var R;return this._rotating||((R=this.handlers)===null||R===void 0?void 0:R.isRotating())}_createDelegatedListener(R,l,p){if(R==="mouseenter"||R==="mouseover"){let w=!1;return{layers:l,listener:p,delegates:{mousemove:O=>{const j=l.filter((te=>this.getLayer(te))),X=j.length!==0?this.queryRenderedFeatures(O.point,{layers:j}):[];X.length?w||(w=!0,p.call(this,new al(R,this,O.originalEvent,{features:X}))):w=!1},mouseout:()=>{w=!1}}}}if(R==="mouseleave"||R==="mouseout"){let w=!1;return{layers:l,listener:p,delegates:{mousemove:j=>{const X=l.filter((te=>this.getLayer(te)));(X.length!==0?this.queryRenderedFeatures(j.point,{layers:X}):[]).length?w=!0:w&&(w=!1,p.call(this,new al(R,this,j.originalEvent)))},mouseout:j=>{w&&(w=!1,p.call(this,new al(R,this,j.originalEvent)))}}}}{const w=T=>{const O=l.filter((X=>this.getLayer(X))),j=O.length!==0?this.queryRenderedFeatures(T.point,{layers:O}):[];j.length&&(T.features=j,p.call(this,T),delete T.features)};return{layers:l,listener:p,delegates:{[R]:w}}}}_saveDelegatedListener(R,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[R]=this._delegatedListeners[R]||[],this._delegatedListeners[R].push(l)}_removeDelegatedListener(R,l,p){if(!this._delegatedListeners||!this._delegatedListeners[R])return;const w=this._delegatedListeners[R];for(let T=0;T<w.length;T++){const O=w[T];if(O.listener===p&&O.layers.length===l.length&&O.layers.every((j=>l.includes(j)))){for(const j in O.delegates)this.off(j,O.delegates[j]);return void w.splice(T,1)}}}on(R,l,p){if(p===void 0)return super.on(R,l);const w=typeof l=="string"?[l]:l,T=this._createDelegatedListener(R,w,p);this._saveDelegatedListener(R,T);for(const O in T.delegates)this.on(O,T.delegates[O]);return{unsubscribe:()=>{this._removeDelegatedListener(R,w,p)}}}once(R,l,p){if(p===void 0)return super.once(R,l);const w=typeof l=="string"?[l]:l,T=this._createDelegatedListener(R,w,p);for(const O in T.delegates){const j=T.delegates[O];T.delegates[O]=(...X)=>{this._removeDelegatedListener(R,w,p),j(...X)}}this._saveDelegatedListener(R,T);for(const O in T.delegates)this.once(O,T.delegates[O]);return this}off(R,l,p){return p===void 0?super.off(R,l):(this._removeDelegatedListener(R,typeof l=="string"?[l]:l,p),this)}queryRenderedFeatures(R,l){if(!this.style)return[];let p;const w=R instanceof o.P||Array.isArray(R),T=w?R:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(w?{}:R)||{},T instanceof o.P||typeof T[0]=="number")p=[o.P.convert(T)];else{const O=o.P.convert(T[0]),j=o.P.convert(T[1]);p=[O,new o.P(j.x,O.y),j,new o.P(O.x,j.y),O]}return this.style.queryRenderedFeatures(p,l,this.transform)}querySourceFeatures(R,l){return this.style.querySourceFeatures(R,l)}setStyle(R,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&R?(this._diffStyle(R,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(R,l))}setTransformRequest(R){return this._requestManager.setTransformRequest(R),this}_getUIString(R){const l=this._locale[R];if(l==null)throw new Error(`Missing UI string '${R}'`);return l}_updateStyle(R,l){var p,w;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(R,l)));const T=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!R)),R?(this.style=new Ss(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof R=="string"?this.style.loadURL(R,l,T):this.style.loadJSON(R,l,T),this):((w=(p=this.style)===null||p===void 0?void 0:p.projection)===null||w===void 0||w.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ss(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(R,l){if(typeof R=="string"){const p=this._requestManager.transformRequest(R,"Style");o.j(p,new AbortController).then((w=>{this._updateDiff(w.data,l)})).catch((w=>{w&&this.fire(new o.k(w))}))}else typeof R=="object"&&this._updateDiff(R,l)}_updateDiff(R,l){try{this.style.setState(R,l)&&this._update(!0)}catch(p){o.w(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(R,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(R,l){return this._lazyInitEmptyStyle(),this.style.addSource(R,l),this._update(!0)}isSourceLoaded(R){const l=this.style&&this.style.sourceCaches[R];if(l!==void 0)return l.loaded();this.fire(new o.k(new Error(`There is no source with ID '${R}'`)))}setTerrain(R){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),R){const l=this.style.sourceCaches[R.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${R.source}`);this.terrain===null&&l.reload();for(const p in this.style._layers){const w=this.style._layers[p];w.type==="hillshade"&&w.source===R.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),w.type==="color-relief"&&w.source===R.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new po(this.painter,l,R),this.painter.renderToTexture=new Sn(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=p=>{var w;p.dataType==="style"?this.terrain.sourceCache.freeRtt():p.dataType==="source"&&p.tile&&(p.sourceId!==R.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((w=p.source)===null||w===void 0?void 0:w.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(p.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:R})),this}getTerrain(){var R,l;return(l=(R=this.terrain)===null||R===void 0?void 0:R.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const R=this.style&&this.style.sourceCaches;for(const l in R){const p=R[l]._tiles;for(const w in p){const T=p[w];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}removeSource(R){return this.style.removeSource(R),this._update(!0)}getSource(R){return this.style.getSource(R)}setSourceTileLodParams(R,l,p){if(p){const w=this.getSource(p);if(!w)throw new Error(`There is no source with ID "${p}", cannot set LOD parameters`);w.calculateTileZoom=Bt(Math.max(1,R),Math.max(1,l))}else for(const w in this.style.sourceCaches)this.style.sourceCaches[w].getSource().calculateTileZoom=Bt(Math.max(1,R),Math.max(1,l));return this._update(!0),this}refreshTiles(R,l){const p=this.style.sourceCaches[R];if(!p)throw new Error(`There is no source cache with ID "${R}", cannot refresh tile`);l===void 0?p.reload(!0):p.refreshTiles(l.map((w=>new o.a3(w.z,w.x,w.y))))}addImage(R,l,p={}){const{pixelRatio:w=1,sdf:T=!1,stretchX:O,stretchY:j,content:X,textFitWidth:te,textFitHeight:le}=p;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:ge,height:Se,data:be}=l,Le=l;return this.style.addImage(R,{data:new o.R({width:ge,height:Se},new Uint8Array(be)),pixelRatio:w,stretchX:O,stretchY:j,content:X,textFitWidth:te,textFitHeight:le,sdf:T,version:0,userImage:Le}),Le.onAdd&&Le.onAdd(this,R),this}}{const{width:ge,height:Se,data:be}=b.getImageData(l);this.style.addImage(R,{data:new o.R({width:ge,height:Se},be),pixelRatio:w,stretchX:O,stretchY:j,content:X,textFitWidth:te,textFitHeight:le,sdf:T,version:0})}}updateImage(R,l){const p=this.style.getImage(R);if(!p)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=l instanceof HTMLImageElement||o.b(l)?b.getImageData(l):l,{width:T,height:O,data:j}=w;if(T===void 0||O===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(T!==p.data.width||O!==p.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const X=!(l instanceof HTMLImageElement||o.b(l));return p.data.replace(j,X),this.style.updateImage(R,p),this}getImage(R){return this.style.getImage(R)}hasImage(R){return R?!!this.style.getImage(R):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(R){this.style.removeImage(R)}loadImage(R){return M.getImage(this._requestManager.transformRequest(R,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(R,l){return this._lazyInitEmptyStyle(),this.style.addLayer(R,l),this._update(!0)}moveLayer(R,l){return this.style.moveLayer(R,l),this._update(!0)}removeLayer(R){return this.style.removeLayer(R),this._update(!0)}getLayer(R){return this.style.getLayer(R)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(R,l,p){return this.style.setLayerZoomRange(R,l,p),this._update(!0)}setFilter(R,l,p={}){return this.style.setFilter(R,l,p),this._update(!0)}getFilter(R){return this.style.getFilter(R)}setPaintProperty(R,l,p,w={}){return this.style.setPaintProperty(R,l,p,w),this._update(!0)}getPaintProperty(R,l){return this.style.getPaintProperty(R,l)}setLayoutProperty(R,l,p,w={}){return this.style.setLayoutProperty(R,l,p,w),this._update(!0)}getLayoutProperty(R,l){return this.style.getLayoutProperty(R,l)}setGlyphs(R,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(R,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(R,l,p={}){return this._lazyInitEmptyStyle(),this.style.addSprite(R,l,p,(w=>{w||this._update(!0)})),this}removeSprite(R){return this._lazyInitEmptyStyle(),this.style.removeSprite(R),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(R,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(R,l,(p=>{p||this._update(!0)})),this}setLight(R,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(R,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(R,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(R,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(R,l){return this.style.setFeatureState(R,l),this._update()}removeFeatureState(R,l){return this.style.removeFeatureState(R,l),this._update()}getFeatureState(R){return this.style.getFeatureState(R)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let R=0,l=0;return this._container&&(R=this._container.clientWidth||400,l=this._container.clientHeight||300),[R,l]}_setupContainer(){const R=this._container;R.classList.add("maplibregl-map");const l=this._canvasContainer=v.create("div","maplibregl-canvas-container",R);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=v.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const p=this._containerDimensions(),w=this._getClampedPixelRatio(p[0],p[1]);this._resizeCanvas(p[0],p[1],w);const T=this._controlContainer=v.create("div","maplibregl-control-container",R),O=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((j=>{O[j]=v.create("div",`maplibregl-ctrl-${j} `,T)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(R,l,p){this._canvas.width=Math.floor(p*R),this._canvas.height=Math.floor(p*l),this._canvas.style.width=`${R}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const R=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let l=null;this._canvas.addEventListener("webglcontextcreationerror",(w=>{l={requestedAttributes:R},w&&(l.statusMessage=w.statusMessage,l.type=w.type)}),{once:!0});let p=null;if(p=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,R):this._canvas.getContext("webgl2",R)||this._canvas.getContext("webgl",R),!p){const w="Failed to initialize WebGL";throw l?(l.message=w,new Error(JSON.stringify(l))):new Error(w)}this.painter=new cs(p,this.transform),S.testSupport(p)}migrateProjection(R,l){super.migrateProjection(R,l),this.painter.transform=R,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(R){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||R,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(R){return this._update(),this._renderTaskQueue.add(R)}_cancelRenderFrame(R){this._renderTaskQueue.remove(R)}_render(R){var l,p,w,T,O;const j=this._idleTriggered?this._fadeDuration:0,X=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(R),this._removed)return;let te=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Se=this.transform.zoom,be=b.now();this.style.zoomHistory.update(Se,be);const Le=new o.F(Se,{now:be,fadeDuration:j,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Ge=Le.crossFadingFactor();Ge===1&&Ge===this._crossFadingFactor||(te=!0,this._crossFadingFactor=Ge),this.style.update(Le)}const le=((p=this.style.projection)===null||p===void 0?void 0:p.transitionState)>0!==X;(w=this.style.projection)===null||w===void 0||w.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((T=this.style.projection)===null||T===void 0?void 0:T.transitionState,(O=this.style.projection)===null||O===void 0?void 0:O.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||le)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,j,this._crossSourceCollisions,le),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:j,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cv.mark(o.cw.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||te)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const ge=this._sourcesDirty||this._styleDirty||this._placementDirty;return ge||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||ge||(this._fullyLoaded=!0,o.cv.mark(o.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var R;this._hash&&this._hash.remove();for(const p of this._controls)p.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),M.removeThrottleControl(this._imageQueueHandle),(R=this._resizeObserver)===null||R===void 0||R.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l?.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),v.remove(this._canvasContainer),v.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cv.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,b.frame(this._frameRequest,(R=>{o.cv.frame(R),this._frameRequest=null;try{this._render(R)}catch(l){if(!o.cx(l)&&!(function(p){return p.message===us})(l))throw l}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(R){this._showTileBoundaries!==R&&(this._showTileBoundaries=R,this._update())}get showPadding(){return!!this._showPadding}set showPadding(R){this._showPadding!==R&&(this._showPadding=R,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(R){this._showCollisionBoxes!==R&&(this._showCollisionBoxes=R,R?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(R){this._showOverdrawInspector!==R&&(this._showOverdrawInspector=R,this._update())}get repaint(){return!!this._repaint}set repaint(R){this._repaint!==R&&(this._repaint=R,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(R){this._vertices=R,this._update()}get version(){return ga}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(R){return this._lazyInitEmptyStyle(),this.style.setProjection(R),this._update(!0)}},s.MapMouseEvent=al,s.MapTouchEvent=Ju,s.MapWheelEvent=fp,s.Marker=Ki,s.NavigationControl=class{constructor(R){this._updateZoomButtons=()=>{const l=this._map.getZoom(),p=l===this._map.getMaxZoom(),w=l===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,p)=>{const w=this._map._getUIString(`NavigationControl.${p}`);l.title=w,l.setAttribute("aria-label",w)},this.options=o.e({},to,R),this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(l=>this._map.zoomIn({},{originalEvent:l}))),v.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(l=>this._map.zoomOut({},{originalEvent:l}))),v.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})})),this._compassIcon=v.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(R){return this._map=R,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new No(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){v.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(R,l){const p=v.create("button",R,this._container);return p.type="button",p.addEventListener("click",l),p}},s.Popup=class extends o.E{constructor(R){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&v.remove(this._content),this._container&&(v.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=v.create("div","maplibregl-popup",this._map.getContainer()),this._tip=v.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const j of this.options.className.split(" "))this._container.classList.add(j);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Ma(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;const p=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let w=this.options.anchor;const T=Mu(this.options.offset);if(!w){const j=this._container.offsetWidth,X=this._container.offsetHeight;let te;te=p.y+T.bottom.y<X?["top"]:p.y>this._map.transform.height-X?["bottom"]:[],p.x<j/2?te.push("left"):p.x>this._map.transform.width-j/2&&te.push("right"),w=te.length===0?"bottom":te.join("-")}let O=p.add(T[w]);this.options.subpixelPositioning||(O=O.round()),v.setTransform(this._container,`${ro[w]} translate(${O.x}px,${O.y}px)`),ia(this._container,w,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Al),R)}addTo(R){return this._map&&this.remove(),this._map=R,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(R){return this._lngLat=o.S.convert(R),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(R){return this.setDOMContent(document.createTextNode(R))}setHTML(R){const l=document.createDocumentFragment(),p=document.createElement("body");let w;for(p.innerHTML=R;w=p.firstChild,w;)l.appendChild(w);return this.setDOMContent(l)}getMaxWidth(){var R;return(R=this._container)===null||R===void 0?void 0:R.style.maxWidth}setMaxWidth(R){return this.options.maxWidth=R,this._update(),this}setDOMContent(R){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=v.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(R),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(R){return this._container&&this._container.classList.add(R),this}removeClassName(R){return this._container&&this._container.classList.remove(R),this}setOffset(R){return this.options.offset=R,this._update(),this}toggleClassName(R){if(this._container)return this._container.classList.toggle(R)}setSubpixelPositioning(R){this.options.subpixelPositioning=R}_createCloseButton(){this.options.closeButton&&(this._closeButton=v.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const R=this._container.querySelector(Bc);R&&R.focus()}},s.RasterDEMTileSource=Yt,s.RasterTileSource=nr,s.ScaleControl=class{constructor(R){this._onMove=()=>{Ea(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Ea(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Cl),R)}getDefaultPosition(){return"bottom-left"}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-scale",R.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){v.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=fn,s.Style=Ss,s.TerrainControl=class{constructor(R){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=R}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=v.create("button","maplibregl-ctrl-terrain",this._container),v.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){v.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=ir,s.TwoFingersTouchRotateHandler=kr,s.TwoFingersTouchZoomHandler=bt,s.TwoFingersTouchZoomRotateHandler=Zi,s.VectorTileSource=Ve,s.VideoSource=br,s.addSourceType=(R,l)=>o._(void 0,void 0,void 0,(function*(){if(Mr(R))throw new Error(`A source type called "${R}" already exists.`);((p,w)=>{mr[p]=w})(R,l)})),s.clearPrewarmedResources=function(){const R=xe;R&&(R.isPreloaded()&&R.numActive()===1?(R.release(we),xe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=iu,s.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return Nr().getRTLTextPluginStatus()},s.getVersion=function(){return ds},s.getWorkerCount=function(){return Ae.workerCount},s.getWorkerUrl=function(){return o.a.WORKER_URL},s.importScriptInWorkers=function(R){return He().broadcast("IS",R)},s.prewarm=function(){Me().acquire(we)},s.setMaxParallelImageRequests=function(R){o.a.MAX_PARALLEL_IMAGE_REQUESTS=R},s.setRTLTextPlugin=function(R,l){return Nr().setRTLTextPlugin(R,l)},s.setWorkerCount=function(R){Ae.workerCount=R},s.setWorkerUrl=function(R){o.a.WORKER_URL=R}}));var a=r;return a}))})(aw)),aw.exports}var ME=xie();const pP=ad(ME);class wie{registeredElements;baseLayers;firstSymbolLayer;eventHandlers;wrapper;initRegisteredElements;addNativeMaplibreFunctionsAndProps;map;style;styleJson;addSource;addControl;on;cleanup;constructor(e){const r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[],addsource:[],addlayer:[]},this.wrapper={on:(o,u,h,f)=>{if(!r.eventHandlers[o])return;typeof h=="string"&&(f=h,h={}),r.eventHandlers[o].push({handler:u,options:h});const d=[o,u];f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].wrapperEvents.push(d))},off:(o,u)=>{r.eventHandlers[o]&&(r.eventHandlers[o]=r.eventHandlers[o].filter(h=>Object.is(h.handler,u)?!1:h))},fire:(o,u)=>{if(!r.eventHandlers[o])return;const h=u||window,f=new Event(o);r.eventHandlers[o].forEach(function(d){d.handler.call(h,f,r,u)})},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:o=>{if(o)return{id:o.id,type:o.type,visible:o.visibility!=="none",baseLayer:r.baseLayers.indexOf(o.id)!==-1}},buildLayerObjects:()=>r.map.style._order.map(o=>r.wrapper.buildLayerObject(r.map.style._layers[o])).filter(o=>typeof o<"u"),refreshLayerState:()=>{r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:()=>typeof r.map.getCenter=="function"?{center:(({lng:o,lat:u})=>({lng:o,lat:u}))(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},refreshViewport:()=>{r.wrapper.viewportState=r.wrapper.getViewport()}},this.cancelled=!1,this.initRegisteredElements=(o,u)=>{(typeof r.registeredElements[o]>"u"||typeof u<"u"&&u)&&(r.registeredElements[o]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=(o,u,h)=>r.map.style?(h&&typeof h=="string"&&typeof o.id<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].layers.push(o.id),o?.source&&typeof o?.source!="string"&&r.registeredElements[h].sources.push(o.id)),r.map.addLayer(o,u),r.wrapper.fire("addlayer",{layer_id:o.id}),this):this,this.addSource=(o,u,h)=>r.map.style?(h&&typeof h=="string"&&typeof o<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].sources.push(o)),r.map.addSource(o,u),r.wrapper.fire("addsource",{source_id:o}),this):this,this.addImage=(o,u,h,f)=>r.map.style?typeof h=="string"&&typeof f>"u"?r.addImage(o,u,void 0,h):(f&&typeof f=="string"&&typeof o<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].images.push(o)),r.map.addImage(o,u,h),this):this,this.on=(o,u,h,f)=>{if(typeof h=="string"&&typeof u=="function")return r.on.call(r,o,void 0,u,h);let d=[o,u,h];return u||(d=[o,h]),f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].events.push(d)),r.map.on(...d),this},this.addControl=(o,u,h)=>(h&&typeof h=="string"&&(r.initRegisteredElements(h),r.registeredElements[h].controls.push(o)),r.map.addControl(o,u),this),this.cleanup=o=>{r.map.style&&typeof r.registeredElements[o]<"u"&&(r.registeredElements[o].layers.forEach(u=>{r.map.style.getLayer(u)&&r.map.style.removeLayer(u)}),r.registeredElements[o].sources.forEach(u=>{r.map.style.getSource(u)&&r.map.style.removeSource(u)}),r.registeredElements[o].images.forEach(u=>{r.map.hasImage(u)&&r.map.style.removeImage(u)}),r.registeredElements[o].events.forEach(u=>{r.map.off(...u)}),r.registeredElements[o].controls.forEach(u=>{r.map.removeControl(u)}),r.registeredElements[o].wrapperEvents.forEach(u=>{r.wrapper.off(...u)}),r.initRegisteredElements(o,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach(o=>{this[o]=(...u)=>(r.map&&r.map.style&&typeof r.map.style[o]=="function"&&r.map.style[o](...u),r.map._update?r.map._update(!0):void 0)}),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach(o=>{this[o]=(...u)=>r.map&&r.map.style?r.map.style[o](...u):!1}),this.addNativeMaplibreFunctionsAndProps=()=>{Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach(o=>{typeof this[o]>"u"&&(this[o]=(...u)=>r.map[o](...u))}),Object.keys(this.map).forEach(o=>{typeof this[o]>"u"&&(this[o]=r.map[o])})},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach(o=>{this[o]=(...u)=>{if(typeof r.map[o]=="function")return r.map[o].call(r.map,...u)}}),(async()=>{typeof e.mapOptions.style=="string"&&e.mapOptions.style.indexOf("mapbox://")===-1&&await fetch(e.mapOptions.style).then(o=>{if(o.ok)return o.json();throw new Error("error loading map style.json")}).then(o=>{o.layers.forEach(u=>{r.baseLayers.push(u.id),!r.firstSymbolLayer&&u.type==="symbol"&&(r.firstSymbolLayer=u.id)}),r.styleJson=o,e.mapOptions.style=o}).catch(o=>{console.log(o)}),r.map=new ME.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",()=>{r.addNativeMaplibreFunctionsAndProps()}),r.map.on("move",()=>{r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")}),r.map.on("idle",()=>{r.wrapper.refreshLayerState()}),r.map.on("data",()=>{r.wrapper.refreshLayerState()}),typeof e.onReady=="function"&&e.onReady(r.map,r)})()}}function Hd(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const nf="$$material";function Uw(){return Uw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Uw.apply(null,arguments)}function Sie(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Eie(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Tie=(function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Eie(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=Sie(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t})(),Vu="-ms-",Vw="-moz-",Ba="-webkit-",dW="comm",wR="rule",SR="decl",Cie="@import",pW="@keyframes",Aie="@layer",Iie=Math.abs,RE=String.fromCharCode,Pie=Object.assign;function kie(t,e){return gu(t,0)^45?(((e<<2^gu(t,0))<<2^gu(t,1))<<2^gu(t,2))<<2^gu(t,3):0}function gW(t){return t.trim()}function Mie(t,e){return(t=e.exec(t))?t[0]:t}function za(t,e,r){return t.replace(e,r)}function gP(t,e){return t.indexOf(e)}function gu(t,e){return t.charCodeAt(e)|0}function q1(t,e,r){return t.slice(e,r)}function jf(t){return t.length}function ER(t){return t.length}function Bx(t,e){return e.push(t),t}function Rie(t,e){return t.map(e).join("")}var OE=1,Xv=1,mW=0,Ic=0,ml=0,T0="";function NE(t,e,r,n,i,a,s){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:OE,column:Xv,length:s,return:""}}function d_(t,e){return Pie(NE("",null,null,"",null,null,0),t,{length:-t.length},e)}function Oie(){return ml}function Nie(){return ml=Ic>0?gu(T0,--Ic):0,Xv--,ml===10&&(Xv=1,OE--),ml}function eh(){return ml=Ic<mW?gu(T0,Ic++):0,Xv++,ml===10&&(Xv=1,OE++),ml}function Xf(){return gu(T0,Ic)}function ow(){return Ic}function Lb(t,e){return q1(T0,t,e)}function H1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function yW(t){return OE=Xv=1,mW=jf(T0=t),Ic=0,[]}function vW(t){return T0="",t}function sw(t){return gW(Lb(Ic-1,mP(t===91?t+2:t===40?t+1:t)))}function Lie(t){for(;(ml=Xf())&&ml<33;)eh();return H1(t)>2||H1(ml)>3?"":" "}function Die(t,e){for(;--e&&eh()&&!(ml<48||ml>102||ml>57&&ml<65||ml>70&&ml<97););return Lb(t,ow()+(e<6&&Xf()==32&&eh()==32))}function mP(t){for(;eh();)switch(ml){case t:return Ic;case 34:case 39:t!==34&&t!==39&&mP(ml);break;case 40:t===41&&mP(t);break;case 92:eh();break}return Ic}function Fie(t,e){for(;eh()&&t+ml!==57;)if(t+ml===84&&Xf()===47)break;return"/*"+Lb(e,Ic-1)+"*"+RE(t===47?t:eh())}function Bie(t){for(;!H1(Xf());)eh();return Lb(t,Ic)}function zie(t){return vW(lw("",null,null,null,[""],t=yW(t),0,[0],t))}function lw(t,e,r,n,i,a,s,o,u){for(var h=0,f=0,d=s,b=0,v=0,S=0,E=1,P=1,k=1,L=0,N="",M=i,z=a,B=n,q=N;P;)switch(S=L,L=eh()){case 40:if(S!=108&&gu(q,d-1)==58){gP(q+=za(sw(L),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:q+=sw(L);break;case 9:case 10:case 13:case 32:q+=Lie(S);break;case 92:q+=Die(ow()-1,7);continue;case 47:switch(Xf()){case 42:case 47:Bx(jie(Fie(eh(),ow()),e,r),u);break;default:q+="/"}break;case 123*E:o[h++]=jf(q)*k;case 125*E:case 59:case 0:switch(L){case 0:case 125:P=0;case 59+f:k==-1&&(q=za(q,/\f/g,"")),v>0&&jf(q)-d&&Bx(v>32?nF(q+";",n,r,d-1):nF(za(q," ","")+";",n,r,d-2),u);break;case 59:q+=";";default:if(Bx(B=rF(q,e,r,h,f,i,o,N,M=[],z=[],d),a),L===123)if(f===0)lw(q,e,B,B,M,a,d,o,z);else switch(b===99&&gu(q,3)===110?100:b){case 100:case 108:case 109:case 115:lw(t,B,B,n&&Bx(rF(t,B,B,0,0,i,o,N,i,M=[],d),z),i,z,d,o,n?M:z);break;default:lw(q,B,B,B,[""],z,0,o,z)}}h=f=v=0,E=k=1,N=q="",d=s;break;case 58:d=1+jf(q),v=S;default:if(E<1){if(L==123)--E;else if(L==125&&E++==0&&Nie()==125)continue}switch(q+=RE(L),L*E){case 38:k=f>0?1:(q+="\f",-1);break;case 44:o[h++]=(jf(q)-1)*k,k=1;break;case 64:Xf()===45&&(q+=sw(eh())),b=Xf(),f=d=jf(N=q+=Bie(ow())),L++;break;case 45:S===45&&jf(q)==2&&(E=0)}}return a}function rF(t,e,r,n,i,a,s,o,u,h,f){for(var d=i-1,b=i===0?a:[""],v=ER(b),S=0,E=0,P=0;S<n;++S)for(var k=0,L=q1(t,d+1,d=Iie(E=s[S])),N=t;k<v;++k)(N=gW(E>0?b[k]+" "+L:za(L,/&\f/g,b[k])))&&(u[P++]=N);return NE(t,e,r,i===0?wR:o,u,h,f)}function jie(t,e,r){return NE(t,e,r,dW,RE(Oie()),q1(t,2,-2),0)}function nF(t,e,r,n){return NE(t,e,r,SR,q1(t,0,n),q1(t,n+1,-1),n)}function Lv(t,e){for(var r="",n=ER(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Uie(t,e,r,n){switch(t.type){case Aie:if(t.children.length)break;case Cie:case SR:return t.return=t.return||t.value;case dW:return"";case pW:return t.return=t.value+"{"+Lv(t.children,n)+"}";case wR:t.value=t.props.join(",")}return jf(r=Lv(t.children,n))?t.return=t.value+"{"+r+"}":""}function Vie(t){var e=ER(t);return function(r,n,i,a){for(var s="",o=0;o<e;o++)s+=t[o](r,n,i,a)||"";return s}}function $ie(t){return function(e){e.root||(e=e.return)&&t(e)}}function _W(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var qie=function(e,r,n){for(var i=0,a=0;i=a,a=Xf(),i===38&&a===12&&(r[n]=1),!H1(a);)eh();return Lb(e,Ic)},Hie=function(e,r){var n=-1,i=44;do switch(H1(i)){case 0:i===38&&Xf()===12&&(r[n]=1),e[n]+=qie(Ic-1,r,n);break;case 2:e[n]+=sw(i);break;case 4:if(i===44){e[++n]=Xf()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=RE(i)}while(i=eh());return e},Wie=function(e,r){return vW(Hie(yW(e),r))},iF=new WeakMap,Gie=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!iF.get(n))&&!i){iF.set(e,!0);for(var a=[],s=Wie(r,a),o=n.props,u=0,h=0;u<s.length;u++)for(var f=0;f<o.length;f++,h++)e.props[h]=a[u]?s[u].replace(/&\f/g,o[f]):o[f]+" "+s[u]}}},Xie=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function bW(t,e){switch(kie(t,e)){case 5103:return Ba+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ba+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ba+t+Vw+t+Vu+t+t;case 6828:case 4268:return Ba+t+Vu+t+t;case 6165:return Ba+t+Vu+"flex-"+t+t;case 5187:return Ba+t+za(t,/(\w+).+(:[^]+)/,Ba+"box-$1$2"+Vu+"flex-$1$2")+t;case 5443:return Ba+t+Vu+"flex-item-"+za(t,/flex-|-self/,"")+t;case 4675:return Ba+t+Vu+"flex-line-pack"+za(t,/align-content|flex-|-self/,"")+t;case 5548:return Ba+t+Vu+za(t,"shrink","negative")+t;case 5292:return Ba+t+Vu+za(t,"basis","preferred-size")+t;case 6060:return Ba+"box-"+za(t,"-grow","")+Ba+t+Vu+za(t,"grow","positive")+t;case 4554:return Ba+za(t,/([^-])(transform)/g,"$1"+Ba+"$2")+t;case 6187:return za(za(za(t,/(zoom-|grab)/,Ba+"$1"),/(image-set)/,Ba+"$1"),t,"")+t;case 5495:case 3959:return za(t,/(image-set\([^]*)/,Ba+"$1$`$1");case 4968:return za(za(t,/(.+:)(flex-)?(.*)/,Ba+"box-pack:$3"+Vu+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ba+t+t;case 4095:case 3583:case 4068:case 2532:return za(t,/(.+)-inline(.+)/,Ba+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(jf(t)-1-e>6)switch(gu(t,e+1)){case 109:if(gu(t,e+4)!==45)break;case 102:return za(t,/(.+:)(.+)-([^]+)/,"$1"+Ba+"$2-$3$1"+Vw+(gu(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~gP(t,"stretch")?bW(za(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(gu(t,e+1)!==115)break;case 6444:switch(gu(t,jf(t)-3-(~gP(t,"!important")&&10))){case 107:return za(t,":",":"+Ba)+t;case 101:return za(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ba+(gu(t,14)===45?"inline-":"")+"box$3$1"+Ba+"$2$3$1"+Vu+"$2box$3")+t}break;case 5936:switch(gu(t,e+11)){case 114:return Ba+t+Vu+za(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ba+t+Vu+za(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ba+t+Vu+za(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ba+t+Vu+t+t}return t}var Yie=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case SR:e.return=bW(e.value,e.length);break;case pW:return Lv([d_(e,{value:za(e.value,"@","@"+Ba)})],i);case wR:if(e.length)return Rie(e.props,function(a){switch(Mie(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Lv([d_(e,{props:[za(a,/:(read-\w+)/,":"+Vw+"$1")]})],i);case"::placeholder":return Lv([d_(e,{props:[za(a,/:(plac\w+)/,":"+Ba+"input-$1")]}),d_(e,{props:[za(a,/:(plac\w+)/,":"+Vw+"$1")]}),d_(e,{props:[za(a,/:(plac\w+)/,Vu+"input-$1")]})],i)}return""})}},Zie=[Yie],Kie=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(E){var P=E.getAttribute("data-emotion");P.indexOf(" ")!==-1&&(document.head.appendChild(E),E.setAttribute("data-s",""))})}var i=e.stylisPlugins||Zie,a={},s,o=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(E){for(var P=E.getAttribute("data-emotion").split(" "),k=1;k<P.length;k++)a[P[k]]=!0;o.push(E)});var u,h=[Gie,Xie];{var f,d=[Uie,$ie(function(E){f.insert(E)})],b=Vie(h.concat(i,d)),v=function(P){return Lv(zie(P),b)};u=function(P,k,L,N){f=L,v(P?P+"{"+k.styles+"}":k.styles),N&&(S.inserted[k.name]=!0)}}var S={key:r,sheet:new Tie({key:r,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:u};return S.sheet.hydrate(o),S},t3={exports:{}},Wa={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aF;function Jie(){if(aF)return Wa;aF=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,h=t?Symbol.for("react.concurrent_mode"):60111,f=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,v=t?Symbol.for("react.memo"):60115,S=t?Symbol.for("react.lazy"):60116,E=t?Symbol.for("react.block"):60121,P=t?Symbol.for("react.fundamental"):60117,k=t?Symbol.for("react.responder"):60118,L=t?Symbol.for("react.scope"):60119;function N(z){if(typeof z=="object"&&z!==null){var B=z.$$typeof;switch(B){case e:switch(z=z.type,z){case u:case h:case n:case a:case i:case d:return z;default:switch(z=z&&z.$$typeof,z){case o:case f:case S:case v:case s:return z;default:return B}}case r:return B}}}function M(z){return N(z)===h}return Wa.AsyncMode=u,Wa.ConcurrentMode=h,Wa.ContextConsumer=o,Wa.ContextProvider=s,Wa.Element=e,Wa.ForwardRef=f,Wa.Fragment=n,Wa.Lazy=S,Wa.Memo=v,Wa.Portal=r,Wa.Profiler=a,Wa.StrictMode=i,Wa.Suspense=d,Wa.isAsyncMode=function(z){return M(z)||N(z)===u},Wa.isConcurrentMode=M,Wa.isContextConsumer=function(z){return N(z)===o},Wa.isContextProvider=function(z){return N(z)===s},Wa.isElement=function(z){return typeof z=="object"&&z!==null&&z.$$typeof===e},Wa.isForwardRef=function(z){return N(z)===f},Wa.isFragment=function(z){return N(z)===n},Wa.isLazy=function(z){return N(z)===S},Wa.isMemo=function(z){return N(z)===v},Wa.isPortal=function(z){return N(z)===r},Wa.isProfiler=function(z){return N(z)===a},Wa.isStrictMode=function(z){return N(z)===i},Wa.isSuspense=function(z){return N(z)===d},Wa.isValidElementType=function(z){return typeof z=="string"||typeof z=="function"||z===n||z===h||z===a||z===i||z===d||z===b||typeof z=="object"&&z!==null&&(z.$$typeof===S||z.$$typeof===v||z.$$typeof===s||z.$$typeof===o||z.$$typeof===f||z.$$typeof===P||z.$$typeof===k||z.$$typeof===L||z.$$typeof===E)},Wa.typeOf=N,Wa}var oF;function Qie(){return oF||(oF=1,t3.exports=Jie()),t3.exports}var r3,sF;function eae(){if(sF)return r3;sF=1;var t=Qie(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function s(S){return t.isMemo(S)?i:a[S.$$typeof]||e}var o=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,b=Object.prototype;function v(S,E,P){if(typeof E!="string"){if(b){var k=d(E);k&&k!==b&&v(S,k,P)}var L=u(E);h&&(L=L.concat(h(E)));for(var N=s(S),M=s(E),z=0;z<L.length;++z){var B=L[z];if(!r[B]&&!(P&&P[B])&&!(M&&M[B])&&!(N&&N[B])){var q=f(E,B);try{o(S,B,q)}catch{}}}}return S}return r3=v,r3}eae();var tae=!0;function xW(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var TR=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||tae===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},CR=function(e,r,n){TR(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function rae(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var nae={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},iae=/[A-Z]|^ms/g,aae=/_EMO_([^_]+?)_([^]*?)_EMO_/g,wW=function(e){return e.charCodeAt(1)===45},lF=function(e){return e!=null&&typeof e!="boolean"},n3=_W(function(t){return wW(t)?t:t.replace(iae,"-$&").toLowerCase()}),uF=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(aae,function(n,i,a){return Uf={name:i,styles:a,next:Uf},i})}return nae[e]!==1&&!wW(e)&&typeof r=="number"&&r!==0?r+"px":r};function W1(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return Uf={name:i.name,styles:i.styles,next:Uf},i.name;var a=r;if(a.styles!==void 0){var s=a.next;if(s!==void 0)for(;s!==void 0;)Uf={name:s.name,styles:s.styles,next:Uf},s=s.next;var o=a.styles+";";return o}return oae(t,e,r)}case"function":{if(t!==void 0){var u=Uf,h=r(t);return Uf=u,W1(t,e,h)}break}}var f=r;if(e==null)return f;var d=e[f];return d!==void 0?d:f}function oae(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=W1(t,e,r[i])+";";else for(var a in r){var s=r[a];if(typeof s!="object"){var o=s;e!=null&&e[o]!==void 0?n+=a+"{"+e[o]+"}":lF(o)&&(n+=n3(a)+":"+uF(a,o)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(e==null||e[s[0]]===void 0))for(var u=0;u<s.length;u++)lF(s[u])&&(n+=n3(a)+":"+uF(a,s[u])+";");else{var h=W1(t,e,s);switch(a){case"animation":case"animationName":{n+=n3(a)+":"+h+";";break}default:n+=a+"{"+h+"}"}}}return n}var cF=/label:\s*([^\s;{]+)\s*(;|$)/g,Uf;function Db(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";Uf=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=W1(r,e,a);else{var s=a;i+=s[0]}for(var o=1;o<t.length;o++)if(i+=W1(r,e,t[o]),n){var u=a;i+=u[o]}cF.lastIndex=0;for(var h="",f;(f=cF.exec(i))!==null;)h+="-"+f[1];var d=rae(i)+h;return{name:d,styles:i,next:Uf}}var sae=function(e){return e()},SW=jw.useInsertionEffect?jw.useInsertionEffect:!1,EW=SW||sae,hF=SW||ee.useLayoutEffect,TW=ee.createContext(typeof HTMLElement<"u"?Kie({key:"css"}):null);TW.Provider;var AR=function(e){return ee.forwardRef(function(r,n){var i=ee.useContext(TW);return e(r,i,n)})},Fb=ee.createContext({}),IR={}.hasOwnProperty,yP="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",lae=function(e,r){var n={};for(var i in r)IR.call(r,i)&&(n[i]=r[i]);return n[yP]=e,n},uae=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return TR(r,n,i),EW(function(){return CR(r,n,i)}),null},cae=AR(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[yP],a=[n],s="";typeof t.className=="string"?s=xW(e.registered,a,t.className):t.className!=null&&(s=t.className+" ");var o=Db(a,void 0,ee.useContext(Fb));s+=e.key+"-"+o.name;var u={};for(var h in t)IR.call(t,h)&&h!=="css"&&h!==yP&&(u[h]=t[h]);return u.className=s,r&&(u.ref=r),ee.createElement(ee.Fragment,null,ee.createElement(uae,{cache:e,serialized:o,isStringTag:typeof i=="string"}),ee.createElement(i,u))}),hae=cae,fF=function(e,r){var n=arguments;if(r==null||!IR.call(r,"css"))return ee.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=hae,a[1]=lae(e,r);for(var s=2;s<i;s++)a[s]=n[s];return ee.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(fF||(fF={}));var CW=AR(function(t,e){var r=t.styles,n=Db([r],void 0,ee.useContext(Fb)),i=ee.useRef();return hF(function(){var a=e.key+"-global",s=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,u=document.querySelector('style[data-emotion="'+a+" "+n.name+'"]');return e.sheet.tags.length&&(s.before=e.sheet.tags[0]),u!==null&&(o=!0,u.setAttribute("data-emotion",a),s.hydrate([u])),i.current=[s,o],function(){s.flush()}},[e]),hF(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(n.next!==void 0&&CR(e,n.next,!0),s.tags.length){var u=s.tags[s.tags.length-1].nextElementSibling;s.before=u,s.flush()}e.insert("",n,s,!1)},[e,n.name]),null});function PR(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Db(e)}function Bb(){var t=PR.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var fae=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dae=_W(function(t){return fae.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),pae=dae,gae=function(e){return e!=="theme"},dF=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?pae:gae},pF=function(e,r,n){var i;if(r){var a=r.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(s){return e.__emotion_forwardProp(s)&&a(s)}:a}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},mae=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return TR(r,n,i),EW(function(){return CR(r,n,i)}),null},yae=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,a,s;r!==void 0&&(a=r.label,s=r.target);var o=pF(e,r,n),u=o||dF(i),h=!u("as");return function(){var f=arguments,d=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&d.push("label:"+a+";"),f[0]==null||f[0].raw===void 0)d.push.apply(d,f);else{var b=f[0];d.push(b[0]);for(var v=f.length,S=1;S<v;S++)d.push(f[S],b[S])}var E=AR(function(P,k,L){var N=h&&P.as||i,M="",z=[],B=P;if(P.theme==null){B={};for(var q in P)B[q]=P[q];B.theme=ee.useContext(Fb)}typeof P.className=="string"?M=xW(k.registered,z,P.className):P.className!=null&&(M=P.className+" ");var W=Db(d.concat(z),k.registered,B);M+=k.key+"-"+W.name,s!==void 0&&(M+=" "+s);var G=h&&o===void 0?dF(N):u,ie={};for(var J in P)h&&J==="as"||G(J)&&(ie[J]=P[J]);return ie.className=M,L&&(ie.ref=L),ee.createElement(ee.Fragment,null,ee.createElement(mae,{cache:k,serialized:W,isStringTag:typeof N=="string"}),ee.createElement(N,ie))});return E.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",E.defaultProps=e.defaultProps,E.__emotion_real=E,E.__emotion_base=i,E.__emotion_styles=d,E.__emotion_forwardProp=o,Object.defineProperty(E,"toString",{value:function(){return"."+s}}),E.withComponent=function(P,k){var L=t(P,Uw({},r,k,{shouldForwardProp:pF(E,k,!0)}));return L.apply(void 0,d)},E}},vae=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],vP=yae.bind(null);vae.forEach(function(t){vP[t]=vP(t)});var i3={exports:{}},a3,gF;function _ae(){if(gF)return a3;gF=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return a3=t,a3}var o3,mF;function bae(){if(mF)return o3;mF=1;var t=_ae();function e(){}function r(){}return r.resetWarningCache=e,o3=function(){function n(s,o,u,h,f,d){if(d!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},o3}var yF;function xae(){return yF||(yF=1,i3.exports=bae()()),i3.exports}var wae=xae();const On=ad(wae);function Sae(t){return t==null||Object.keys(t).length===0}function AW(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(Sae(i)?r:i):e;return Z.jsx(CW,{styles:n})}function IW(t,e){return vP(t,e)}function Eae(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const vF=[];function $p(t){return vF[0]=t,Db(vF)}var s3={exports:{}},yo={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _F;function Tae(){if(_F)return yo;_F=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function S(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case r:case i:case n:case u:case h:case b:return E;default:switch(E=E&&E.$$typeof,E){case s:case o:case d:case f:return E;case a:return E;default:return P}}case e:return P}}}return yo.ContextConsumer=a,yo.ContextProvider=s,yo.Element=t,yo.ForwardRef=o,yo.Fragment=r,yo.Lazy=d,yo.Memo=f,yo.Portal=e,yo.Profiler=i,yo.StrictMode=n,yo.Suspense=u,yo.SuspenseList=h,yo.isContextConsumer=function(E){return S(E)===a},yo.isContextProvider=function(E){return S(E)===s},yo.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},yo.isForwardRef=function(E){return S(E)===o},yo.isFragment=function(E){return S(E)===r},yo.isLazy=function(E){return S(E)===d},yo.isMemo=function(E){return S(E)===f},yo.isPortal=function(E){return S(E)===e},yo.isProfiler=function(E){return S(E)===i},yo.isStrictMode=function(E){return S(E)===n},yo.isSuspense=function(E){return S(E)===u},yo.isSuspenseList=function(E){return S(E)===h},yo.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===r||E===i||E===n||E===u||E===h||typeof E=="object"&&E!==null&&(E.$$typeof===d||E.$$typeof===f||E.$$typeof===s||E.$$typeof===a||E.$$typeof===o||E.$$typeof===v||E.getModuleId!==void 0)},yo.typeOf=S,yo}var bF;function Cae(){return bF||(bF=1,s3.exports=Tae()),s3.exports}var PW=Cae();function Vf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function kW(t){if(ee.isValidElement(t)||PW.isValidElementType(t)||!Vf(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=kW(t[r])}),e}function Wu(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return Vf(t)&&Vf(e)&&Object.keys(e).forEach(i=>{ee.isValidElement(e[i])||PW.isValidElementType(e[i])?n[i]=e[i]:Vf(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&Vf(t[i])?n[i]=Wu(t[i],e[i],r):r.clone?n[i]=Vf(e[i])?kW(e[i]):e[i]:n[i]=e[i]}),n}const Aae=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function Iae(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,a=Aae(e),s=Object.keys(a);function o(b){return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r})`}function u(b){return`@media (max-width:${(typeof e[b]=="number"?e[b]:b)-n/100}${r})`}function h(b,v){const S=s.indexOf(v);return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r}) and (max-width:${(S!==-1&&typeof e[s[S]]=="number"?e[s[S]]:v)-n/100}${r})`}function f(b){return s.indexOf(b)+1<s.length?h(b,s[s.indexOf(b)+1]):o(b)}function d(b){const v=s.indexOf(b);return v===0?o(s[1]):v===s.length-1?u(s[v]):h(b,s[s.indexOf(b)+1]).replace("@media","@media not all and")}return{keys:s,values:a,up:o,down:u,between:h,only:f,not:d,unit:r,...i}}function xF(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{const a=/min-width:\s*([0-9.]+)/;return+(n.match(a)?.[1]||0)-+(i.match(a)?.[1]||0)});return r.length?r.reduce((n,i)=>{const a=e[i];return delete n[i],n[i]=a,n},{...e}):e}function Pae(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function kae(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,a=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(a)}function Mae(t){const e=(a,s)=>a.replace("@media",s?`@container ${s}`:"@container");function r(a,s){a.up=(...o)=>e(t.breakpoints.up(...o),s),a.down=(...o)=>e(t.breakpoints.down(...o),s),a.between=(...o)=>e(t.breakpoints.between(...o),s),a.only=(...o)=>e(t.breakpoints.only(...o),s),a.not=(...o)=>{const u=e(t.breakpoints.not(...o),s);return u.includes("not all and")?u.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):u}}const n={},i=a=>(r(n,a),n);return r(i),{...t,containerQueries:i}}const Rae={borderRadius:4};function v1(t,e){return e?Wu(t,e,{clone:!1}):t}const LE={xs:0,sm:600,md:900,lg:1200,xl:1536},wF={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${LE[t]}px)`},Oae={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:LE[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function Wd(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const a=n.breakpoints||wF;return e.reduce((s,o,u)=>(s[a.up(a.keys[u])]=r(e[u]),s),{})}if(typeof e=="object"){const a=n.breakpoints||wF;return Object.keys(e).reduce((s,o)=>{if(Pae(a.keys,o)){const u=kae(n.containerQueries?n:Oae,o);u&&(s[u]=r(e[o],o))}else if(Object.keys(a.values||LE).includes(o)){const u=a.up(o);s[u]=r(e[o],o)}else{const u=o;s[u]=e[u]}return s},{})}return r(e)}function Nae(t={}){return t.keys?.reduce((r,n)=>{const i=t.up(n);return r[i]={},r},{})||{}}function SF(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function pn(t){if(typeof t!="string")throw new Error(Hd(7));return t.charAt(0).toUpperCase()+t.slice(1)}function DE(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function $w(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=DE(t,r)||n,e&&(i=e(i,n,t)),i}function Gs(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,a=s=>{if(s[e]==null)return null;const o=s[e],u=s.theme,h=DE(u,n)||{};return Wd(s,o,d=>{let b=$w(h,i,d);return d===b&&typeof d=="string"&&(b=$w(h,i,`${e}${d==="default"?"":pn(d)}`,d)),r===!1?b:{[r]:b}})};return a.propTypes={},a.filterProps=[e],a}function Lae(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Dae={m:"margin",p:"padding"},Fae={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},EF={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Bae=Lae(t=>{if(t.length>2)if(EF[t])t=EF[t];else return[t];const[e,r]=t.split(""),n=Dae[e],i=Fae[r]||"";return Array.isArray(i)?i.map(a=>n+a):[n+i]}),kR=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],MR=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...kR,...MR];function zb(t,e,r,n){const i=DE(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const s=Math.abs(a),o=i[s];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function RR(t){return zb(t,"spacing",8)}function jb(t,e){return typeof e=="string"||e==null?e:t(e)}function zae(t,e){return r=>t.reduce((n,i)=>(n[i]=jb(e,r),n),{})}function jae(t,e,r,n){if(!e.includes(r))return null;const i=Bae(r),a=zae(i,n),s=t[r];return Wd(t,s,a)}function MW(t,e){const r=RR(t.theme);return Object.keys(t).map(n=>jae(t,e,n,r)).reduce(v1,{})}function Rs(t){return MW(t,kR)}Rs.propTypes={};Rs.filterProps=kR;function Os(t){return MW(t,MR)}Os.propTypes={};Os.filterProps=MR;function RW(t=8,e=RR({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(a=>{const s=e(a);return typeof s=="number"?`${s}px`:s}).join(" ");return r.mui=!0,r}function FE(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(a=>{n[a]=i}),n),{}),r=n=>Object.keys(n).reduce((i,a)=>e[a]?v1(i,e[a](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function gh(t){return typeof t!="number"?t:`${t}px solid`}function Nh(t,e){return Gs({prop:t,themeKey:"borders",transform:e})}const Uae=Nh("border",gh),Vae=Nh("borderTop",gh),$ae=Nh("borderRight",gh),qae=Nh("borderBottom",gh),Hae=Nh("borderLeft",gh),Wae=Nh("borderColor"),Gae=Nh("borderTopColor"),Xae=Nh("borderRightColor"),Yae=Nh("borderBottomColor"),Zae=Nh("borderLeftColor"),Kae=Nh("outline",gh),Jae=Nh("outlineColor"),BE=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=zb(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:jb(e,n)});return Wd(t,t.borderRadius,r)}return null};BE.propTypes={};BE.filterProps=["borderRadius"];FE(Uae,Vae,$ae,qae,Hae,Wae,Gae,Xae,Yae,Zae,BE,Kae,Jae);const zE=t=>{if(t.gap!==void 0&&t.gap!==null){const e=zb(t.theme,"spacing",8),r=n=>({gap:jb(e,n)});return Wd(t,t.gap,r)}return null};zE.propTypes={};zE.filterProps=["gap"];const jE=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=zb(t.theme,"spacing",8),r=n=>({columnGap:jb(e,n)});return Wd(t,t.columnGap,r)}return null};jE.propTypes={};jE.filterProps=["columnGap"];const UE=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=zb(t.theme,"spacing",8),r=n=>({rowGap:jb(e,n)});return Wd(t,t.rowGap,r)}return null};UE.propTypes={};UE.filterProps=["rowGap"];const Qae=Gs({prop:"gridColumn"}),eoe=Gs({prop:"gridRow"}),toe=Gs({prop:"gridAutoFlow"}),roe=Gs({prop:"gridAutoColumns"}),noe=Gs({prop:"gridAutoRows"}),ioe=Gs({prop:"gridTemplateColumns"}),aoe=Gs({prop:"gridTemplateRows"}),ooe=Gs({prop:"gridTemplateAreas"}),soe=Gs({prop:"gridArea"});FE(zE,jE,UE,Qae,eoe,toe,roe,noe,ioe,aoe,ooe,soe);function Dv(t,e){return e==="grey"?e:t}const loe=Gs({prop:"color",themeKey:"palette",transform:Dv}),uoe=Gs({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Dv}),coe=Gs({prop:"backgroundColor",themeKey:"palette",transform:Dv});FE(loe,uoe,coe);function Zc(t){return t<=1&&t!==0?`${t*100}%`:t}const hoe=Gs({prop:"width",transform:Zc}),OR=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const n=t.theme?.breakpoints?.values?.[r]||LE[r];return n?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:Zc(r)}};return Wd(t,t.maxWidth,e)}return null};OR.filterProps=["maxWidth"];const foe=Gs({prop:"minWidth",transform:Zc}),doe=Gs({prop:"height",transform:Zc}),poe=Gs({prop:"maxHeight",transform:Zc}),goe=Gs({prop:"minHeight",transform:Zc});Gs({prop:"size",cssProperty:"width",transform:Zc});Gs({prop:"size",cssProperty:"height",transform:Zc});const moe=Gs({prop:"boxSizing"});FE(hoe,OR,foe,doe,poe,goe,moe);const Ub={border:{themeKey:"borders",transform:gh},borderTop:{themeKey:"borders",transform:gh},borderRight:{themeKey:"borders",transform:gh},borderBottom:{themeKey:"borders",transform:gh},borderLeft:{themeKey:"borders",transform:gh},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:gh},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:BE},color:{themeKey:"palette",transform:Dv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Dv},backgroundColor:{themeKey:"palette",transform:Dv},p:{style:Os},pt:{style:Os},pr:{style:Os},pb:{style:Os},pl:{style:Os},px:{style:Os},py:{style:Os},padding:{style:Os},paddingTop:{style:Os},paddingRight:{style:Os},paddingBottom:{style:Os},paddingLeft:{style:Os},paddingX:{style:Os},paddingY:{style:Os},paddingInline:{style:Os},paddingInlineStart:{style:Os},paddingInlineEnd:{style:Os},paddingBlock:{style:Os},paddingBlockStart:{style:Os},paddingBlockEnd:{style:Os},m:{style:Rs},mt:{style:Rs},mr:{style:Rs},mb:{style:Rs},ml:{style:Rs},mx:{style:Rs},my:{style:Rs},margin:{style:Rs},marginTop:{style:Rs},marginRight:{style:Rs},marginBottom:{style:Rs},marginLeft:{style:Rs},marginX:{style:Rs},marginY:{style:Rs},marginInline:{style:Rs},marginInlineStart:{style:Rs},marginInlineEnd:{style:Rs},marginBlock:{style:Rs},marginBlockStart:{style:Rs},marginBlockEnd:{style:Rs},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:zE},rowGap:{style:UE},columnGap:{style:jE},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Zc},maxWidth:{style:OR},minWidth:{transform:Zc},height:{transform:Zc},maxHeight:{transform:Zc},minHeight:{transform:Zc},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function yoe(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function voe(t,e){return typeof t=="function"?t(e):t}function _oe(){function t(r,n,i,a){const s={[r]:n,theme:i},o=a[r];if(!o)return{[r]:n};const{cssProperty:u=r,themeKey:h,transform:f,style:d}=o;if(n==null)return null;if(h==="typography"&&n==="inherit")return{[r]:n};const b=DE(i,h)||{};return d?d(s):Wd(s,n,S=>{let E=$w(b,f,S);return S===E&&typeof S=="string"&&(E=$w(b,f,`${r}${S==="default"?"":pn(S)}`,S)),u===!1?E:{[u]:E}})}function e(r){const{sx:n,theme:i={},nested:a}=r||{};if(!n)return null;const s=i.unstable_sxConfig??Ub;function o(u){let h=u;if(typeof u=="function")h=u(i);else if(typeof u!="object")return u;if(!h)return null;const f=Nae(i.breakpoints),d=Object.keys(f);let b=f;return Object.keys(h).forEach(v=>{const S=voe(h[v],i);if(S!=null)if(typeof S=="object")if(s[v])b=v1(b,t(v,S,i,s));else{const E=Wd({theme:i},S,P=>({[v]:P}));yoe(E,S)?b[v]=e({sx:S,theme:i,nested:!0}):b=v1(b,E)}else b=v1(b,t(v,S,i,s))}),!a&&i.modularCssLayers?{"@layer sx":xF(i,SF(d,b))}:xF(i,SF(d,b))}return Array.isArray(n)?n.map(o):o(n)}return e}const Zp=_oe();Zp.filterProps=["sx"];function boe(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let n=r.getColorSchemeSelector(t);return n==="&"?e:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:e})}return r.palette.mode===t?e:{}}function VE(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:a={},...s}=t,o=Iae(r),u=RW(i);let h=Wu({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:u,shape:{...Rae,...a}},s);return h=Mae(h),h.applyStyles=boe,h=e.reduce((f,d)=>Wu(f,d),h),h.unstable_sxConfig={...Ub,...s?.unstable_sxConfig},h.unstable_sx=function(d){return Zp({sx:d,theme:this})},h}function xoe(t){return Object.keys(t).length===0}function $E(t=null){const e=ee.useContext(Fb);return!e||xoe(e)?t:e}const woe=VE();function Vb(t=woe){return $E(t)}function l3(t){const e=$p(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function OW({styles:t,themeId:e,defaultTheme:r={}}){const n=Vb(r),i=e&&n[e]||n;let a=typeof t=="function"?t(i):t;return i.modularCssLayers&&(Array.isArray(a)?a=a.map(s=>l3(typeof s=="function"?s(i):s)):a=l3(a)),Z.jsx(AW,{styles:a})}const Soe=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??Ub;return Object.keys(t).forEach(n=>{r[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function NR(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=Soe(r);let a;return Array.isArray(e)?a=[n,...e]:typeof e=="function"?a=(...s)=>{const o=e(...s);return Vf(o)?{...n,...o}:n}:a={...n,...e},{...i,sx:a}}const TF=t=>t,Eoe=()=>{let t=TF;return{configure(e){t=e},generate(e){return t(e)},reset(){t=TF}}},LR=Eoe();function NW(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=NW(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function An(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=NW(t))&&(n&&(n+=" "),n+=e);return n}function LW(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,a=IW("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Zp);return ee.forwardRef(function(u,h){const f=Vb(r),{className:d,component:b="div",...v}=NR(u);return Z.jsx(a,{as:b,ref:h,className:An(d,i?i(n):n),theme:e&&f[e]||f,...v})})}const Toe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function pi(t,e,r="Mui"){const n=Toe[e];return n?`${r}-${n}`:`${LR.generate(t)}-${e}`}function fi(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=pi(t,i,r)}),n}const Coe=fi("MuiBox",["root"]),Wy=LW({defaultClassName:Coe.root,generateClassName:LR.generate});function DW(t){const{variants:e,...r}=t,n={variants:e,style:$p(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=$p(i.style))}),n}const Aoe=VE();function u3(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Yg(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function Ioe(t){return t?(e,r)=>r[t]:null}function Poe(t,e,r){t.theme=Moe(t.theme)?r:t.theme[e]||t.theme}function uw(t,e,r){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(i=>uw(t,i,r));if(Array.isArray(n?.variants)){let i;if(n.isProcessed)i=r?Yg(n.style,r):n.style;else{const{variants:a,...s}=n;i=r?Yg($p(s),r):s}return FW(t,n.variants,[i],r)}return n?.isProcessed?r?Yg($p(n.style),r):n.style:r?Yg($p(n),r):n}function FW(t,e,r=[],n=void 0){let i;e:for(let a=0;a<e.length;a+=1){const s=e[a];if(typeof s.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!s.props(i))continue}else for(const o in s.props)if(t[o]!==s.props[o]&&t.ownerState?.[o]!==s.props[o])continue e;typeof s.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},r.push(n?Yg($p(s.style(i)),n):s.style(i))):r.push(n?Yg($p(s.style),n):s.style)}return r}function BW(t={}){const{themeId:e,defaultTheme:r=Aoe,rootShouldForwardProp:n=u3,slotShouldForwardProp:i=u3}=t;function a(o){Poe(o,e,r)}return(o,u={})=>{Eae(o,B=>B.filter(q=>q!==Zp));const{name:h,slot:f,skipVariantsResolver:d,skipSx:b,overridesResolver:v=Ioe(Ooe(f)),...S}=u,E=h&&h.startsWith("Mui")||f?"components":"custom",P=d!==void 0?d:f&&f!=="Root"&&f!=="root"||!1,k=b||!1;let L=u3;f==="Root"||f==="root"?L=n:f?L=i:Roe(o)&&(L=void 0);const N=IW(o,{shouldForwardProp:L,label:koe(),...S}),M=B=>{if(B.__emotion_real===B)return B;if(typeof B=="function")return function(W){return uw(W,B,W.theme.modularCssLayers?E:void 0)};if(Vf(B)){const q=DW(B);return function(G){return q.variants?uw(G,q,G.theme.modularCssLayers?E:void 0):G.theme.modularCssLayers?Yg(q.style,E):q.style}}return B},z=(...B)=>{const q=[],W=B.map(M),G=[];if(q.push(a),h&&v&&G.push(function(ne){const ue=ne.theme.components?.[h]?.styleOverrides;if(!ue)return null;const de={};for(const Pe in ue)de[Pe]=uw(ne,ue[Pe],ne.theme.modularCssLayers?"theme":void 0);return v(ne,de)}),h&&!P&&G.push(function(ne){const ue=ne.theme?.components?.[h]?.variants;return ue?FW(ne,ue,[],ne.theme.modularCssLayers?"theme":void 0):null}),k||G.push(Zp),Array.isArray(W[0])){const H=W.shift(),ne=new Array(q.length).fill(""),ae=new Array(G.length).fill("");let ue;ue=[...ne,...H,...ae],ue.raw=[...ne,...H.raw,...ae],q.unshift(ue)}const ie=[...q,...W,...G],J=N(...ie);return o.muiName&&(J.muiName=o.muiName),J};return N.withConfig&&(z.withConfig=N.withConfig),z}}function koe(t,e){return void 0}function Moe(t){for(const e in t)return!1;return!0}function Roe(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Ooe(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const Fm=BW();function G1(t,e,r=!1){const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=i;if(a==="components"||a==="slots")n[a]={...t[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const s=t[a],o=e[a];if(!o)n[a]=s||{};else if(!s)n[a]=o;else{n[a]={...o};for(const u in s)if(Object.prototype.hasOwnProperty.call(s,u)){const h=u;n[a][h]=G1(s[h],o[h],r)}}}else a==="className"&&r&&e.className?n.className=An(t?.className,e?.className):a==="style"&&r&&e.style?n.style={...t?.style,...e?.style}:n[a]===void 0&&(n[a]=t[a])}return n}function zW(t){const{theme:e,name:r,props:n}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?n:G1(e.components[r].defaultProps,n)}function Noe({props:t,name:e,defaultTheme:r,themeId:n}){let i=Vb(r);return n&&(i=i[n]||i),zW({theme:i,name:e,props:t})}const vu=typeof window<"u"?ee.useLayoutEffect:ee.useEffect;function Loe(t,e,r,n,i){const[a,s]=ee.useState(()=>i&&r?r(t).matches:n?n(t).matches:e);return vu(()=>{if(!r)return;const o=r(t),u=()=>{s(o.matches)};return u(),o.addEventListener("change",u),()=>{o.removeEventListener("change",u)}},[t,r]),a}const Doe={...jw},jW=Doe.useSyncExternalStore;function Foe(t,e,r,n,i){const a=ee.useCallback(()=>e,[e]),s=ee.useMemo(()=>{if(i&&r)return()=>r(t).matches;if(n!==null){const{matches:f}=n(t);return()=>f}return a},[a,t,n,i,r]),[o,u]=ee.useMemo(()=>{if(r===null)return[a,()=>()=>{}];const f=r(t);return[()=>f.matches,d=>(f.addEventListener("change",d),()=>{f.removeEventListener("change",d)})]},[a,r,t]);return jW(u,o,s)}function UW(t={}){const{themeId:e}=t;return function(n,i={}){let a=$E();a&&e&&(a=a[e]||a);const s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:u=s?window.matchMedia:null,ssrMatchMedia:h=null,noSsr:f=!1}=zW({name:"MuiUseMediaQuery",props:i,theme:a});let d=typeof n=="function"?n(a):n;return d=d.replace(/^@media( ?)/m,""),d.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(jW!==void 0?Foe:Loe)(d,o,u,h,f)}}UW();function Gy(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function DR(t,e=0,r=1){return Gy(t,e,r)}function Boe(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Kp(t){if(t.type)return t;if(t.charAt(0)==="#")return Kp(Boe(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(Hd(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(Hd(10,i))}else n=n.split(",");return n=n.map(a=>parseFloat(a)),{type:r,values:n,colorSpace:i}}const zoe=t=>{const e=Kp(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},H_=(t,e)=>{try{return zoe(t)}catch{return t}};function qE(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,a)=>a<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function VW(t){t=Kp(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,a=n*Math.min(i,1-i),s=(h,f=(h+r/30)%12)=>i-a*Math.max(Math.min(f-3,9-f,1),-1);let o="rgb";const u=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return t.type==="hsla"&&(o+="a",u.push(e[3])),qE({type:o,values:u})}function _P(t){t=Kp(t);let e=t.type==="hsl"||t.type==="hsla"?Kp(VW(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function joe(t,e){const r=_P(t),n=_P(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function qw(t,e){return t=Kp(t),e=DR(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,qE(t)}function kg(t,e,r){try{return qw(t,e)}catch{return t}}function HE(t,e){if(t=Kp(t),e=DR(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return qE(t)}function no(t,e,r){try{return HE(t,e)}catch{return t}}function WE(t,e){if(t=Kp(t),e=DR(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return qE(t)}function io(t,e,r){try{return WE(t,e)}catch{return t}}function bP(t,e=.15){return _P(t)>.5?HE(t,e):WE(t,e)}function zx(t,e,r){try{return bP(t,e)}catch{return t}}const $W=ee.createContext(null);function FR(){return ee.useContext($W)}const Uoe=typeof Symbol=="function"&&Symbol.for,Voe=Uoe?Symbol.for("mui.nested"):"__THEME_NESTED__";function $oe(t,e){return typeof e=="function"?e(t):{...t,...e}}function qoe(t){const{children:e,theme:r}=t,n=FR(),i=ee.useMemo(()=>{const a=n===null?{...r}:$oe(n,r);return a!=null&&(a[Voe]=n!==null),a},[r,n]);return Z.jsx($W.Provider,{value:i,children:e})}const qW=ee.createContext();function Hoe({value:t,...e}){return Z.jsx(qW.Provider,{value:t??!0,...e})}const $b=()=>ee.useContext(qW)??!1,HW=ee.createContext(void 0);function Woe({value:t,children:e}){return Z.jsx(HW.Provider,{value:t,children:e})}function Goe(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?G1(i.defaultProps,n,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?G1(i,n,e.components.mergeClassNameAndStyle):n}function Xoe({props:t,name:e}){const r=ee.useContext(HW);return Goe({props:t,name:e,theme:{components:r}})}let CF=0;function Yoe(t){const[e,r]=ee.useState(t),n=t||e;return ee.useEffect(()=>{e==null&&(CF+=1,r(`mui-${CF}`))},[e]),n}const Zoe={...jw},AF=Zoe.useId;function og(t){if(AF!==void 0){const e=AF();return t??e}return Yoe(t)}function Koe(t){const e=$E(),r=og()||"",{modularCssLayers:n}=t;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||e!==null?i="":typeof n=="string"?i=n.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,vu(()=>{const a=document.querySelector("head");if(!a)return;const s=a.firstChild;if(i){if(s&&s.hasAttribute?.("data-mui-layer-order")&&s.getAttribute("data-mui-layer-order")===r)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",r),o.textContent=i,a.prepend(o)}else a.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[i,r]),i?Z.jsx(OW,{styles:i}):null}const IF={};function PF(t,e,r,n=!1){return ee.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const a=r(i),s=t?{...e,[t]:a}:a;return n?()=>s:s}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function WW(t){const{children:e,theme:r,themeId:n}=t,i=$E(IF),a=FR()||IF,s=PF(n,i,r),o=PF(n,a,r,!0),u=(n?s[n]:s).direction==="rtl",h=Koe(s);return Z.jsx(qoe,{theme:o,children:Z.jsx(Fb.Provider,{value:s,children:Z.jsx(Hoe,{value:u,children:Z.jsxs(Woe,{value:n?s[n].components:s.components,children:[h,e]})})})})}const kF={theme:void 0};function Joe(t){let e,r;return function(i){let a=e;return(a===void 0||i.theme!==r)&&(kF.theme=i.theme,a=DW(t(kF)),e=a,r=i.theme),a}}const BR="mode",zR="color-scheme",Qoe="data-color-scheme";function ese(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=BR,colorSchemeStorageKey:a=zR,attribute:s=Qoe,colorSchemeNode:o="document.documentElement",nonce:u}=t||{};let h="",f=s;if(s==="class"&&(f=".%s"),s==="data"&&(f="[data-%s]"),f.startsWith(".")){const b=f.substring(1);h+=`${o}.classList.remove('${b}'.replace('%s', light), '${b}'.replace('%s', dark));
      ${o}.classList.add('${b}'.replace('%s', colorScheme));`}const d=f.match(/\[([^[\]]+)\]/);if(d){const[b,v]=d[1].split("=");v||(h+=`${o}.removeAttribute('${b}'.replace('%s', light));
      ${o}.removeAttribute('${b}'.replace('%s', dark));`),h+=`
      ${o}.setAttribute('${b}'.replace('%s', colorScheme), ${v?`${v}.replace('%s', colorScheme)`:'""'});`}else h+=`${o}.setAttribute('${f}', colorScheme);`;return Z.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?u:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${a}-dark') || '${n}';
  const light = localStorage.getItem('${a}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${h}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function tse(){}const rse=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return tse;const n=i=>{const a=i.newValue;i.key===t&&r(a)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function c3(){}function MF(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function GW(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function nse(t){return GW(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function ise(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:a=BR,colorSchemeStorageKey:s=zR,storageWindow:o=typeof window>"u"?void 0:window,storageManager:u=rse,noSsr:h=!1}=t,f=i.join(","),d=i.length>1,b=ee.useMemo(()=>u?.({key:a,storageWindow:o}),[u,a,o]),v=ee.useMemo(()=>u?.({key:`${s}-light`,storageWindow:o}),[u,s,o]),S=ee.useMemo(()=>u?.({key:`${s}-dark`,storageWindow:o}),[u,s,o]),[E,P]=ee.useState(()=>{const W=b?.get(e)||e,G=v?.get(r)||r,ie=S?.get(n)||n;return{mode:W,systemMode:MF(W),lightColorScheme:G,darkColorScheme:ie}}),[k,L]=ee.useState(h||!d);ee.useEffect(()=>{L(!0)},[]);const N=nse(E),M=ee.useCallback(W=>{P(G=>{if(W===G.mode)return G;const ie=W??e;return b?.set(ie),{...G,mode:ie,systemMode:MF(ie)}})},[b,e]),z=ee.useCallback(W=>{W?typeof W=="string"?W&&!f.includes(W)?console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`):P(G=>{const ie={...G};return GW(G,J=>{J==="light"&&(v?.set(W),ie.lightColorScheme=W),J==="dark"&&(S?.set(W),ie.darkColorScheme=W)}),ie}):P(G=>{const ie={...G},J=W.light===null?r:W.light,H=W.dark===null?n:W.dark;return J&&(f.includes(J)?(ie.lightColorScheme=J,v?.set(J)):console.error(`\`${J}\` does not exist in \`theme.colorSchemes\`.`)),H&&(f.includes(H)?(ie.darkColorScheme=H,S?.set(H)):console.error(`\`${H}\` does not exist in \`theme.colorSchemes\`.`)),ie}):P(G=>(v?.set(r),S?.set(n),{...G,lightColorScheme:r,darkColorScheme:n}))},[f,v,S,r,n]),B=ee.useCallback(W=>{E.mode==="system"&&P(G=>{const ie=W?.matches?"dark":"light";return G.systemMode===ie?G:{...G,systemMode:ie}})},[E.mode]),q=ee.useRef(B);return q.current=B,ee.useEffect(()=>{if(typeof window.matchMedia!="function"||!d)return;const W=(...ie)=>q.current(...ie),G=window.matchMedia("(prefers-color-scheme: dark)");return G.addListener(W),W(G),()=>{G.removeListener(W)}},[d]),ee.useEffect(()=>{if(d){const W=b?.subscribe(J=>{(!J||["light","dark","system"].includes(J))&&M(J||e)})||c3,G=v?.subscribe(J=>{(!J||f.match(J))&&z({light:J})})||c3,ie=S?.subscribe(J=>{(!J||f.match(J))&&z({dark:J})})||c3;return()=>{W(),G(),ie()}}},[z,M,f,e,o,d,b,v,S]),{...E,mode:k?E.mode:void 0,systemMode:k?E.systemMode:void 0,colorScheme:k?N:void 0,setMode:M,setColorScheme:z}}const ase="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function ose(t){const{themeId:e,theme:r={},modeStorageKey:n=BR,colorSchemeStorageKey:i=zR,disableTransitionOnChange:a=!1,defaultColorScheme:s,resolveTheme:o}=t,u={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},h=ee.createContext(void 0),f=()=>ee.useContext(h)||u,d={},b={};function v(k){const{children:L,theme:N,modeStorageKey:M=n,colorSchemeStorageKey:z=i,disableTransitionOnChange:B=a,storageManager:q,storageWindow:W=typeof window>"u"?void 0:window,documentNode:G=typeof document>"u"?void 0:document,colorSchemeNode:ie=typeof document>"u"?void 0:document.documentElement,disableNestedContext:J=!1,disableStyleSheetGeneration:H=!1,defaultMode:ne="system",forceThemeRerender:ae=!1,noSsr:ue}=k,de=ee.useRef(!1),Pe=FR(),me=ee.useContext(h),Ee=!!me&&!J,we=ee.useMemo(()=>N||(typeof r=="function"?r():r),[N]),Ae=we[e],ce=Ae||we,{colorSchemes:xe=d,components:_e=b,cssVarPrefix:Me}=ce,Re=Object.keys(xe).filter(fr=>!!xe[fr]).join(","),He=ee.useMemo(()=>Re.split(","),[Re]),Fe=typeof s=="string"?s:s.light,tt=typeof s=="string"?s:s.dark,Ze=xe[Fe]&&xe[tt]?ne:xe[ce.defaultColorScheme]?.palette?.mode||ce.palette?.mode,{mode:Qe,setMode:Ie,systemMode:Lt,lightColorScheme:at,darkColorScheme:Ve,colorScheme:nr,setColorScheme:Yt}=ise({supportedColorSchemes:He,defaultLightColorScheme:Fe,defaultDarkColorScheme:tt,modeStorageKey:M,colorSchemeStorageKey:z,defaultMode:Ze,storageManager:q,storageWindow:W,noSsr:ue});let yr=Qe,mt=nr;Ee&&(yr=me.mode,mt=me.colorScheme);let br=mt||ce.defaultColorScheme;ce.vars&&!ae&&(br=ce.defaultColorScheme);const Tr=ee.useMemo(()=>{const fr=ce.generateThemeVars?.()||ce.vars,Nr={...ce,components:_e,colorSchemes:xe,cssVarPrefix:Me,vars:fr};if(typeof Nr.generateSpacing=="function"&&(Nr.spacing=Nr.generateSpacing()),br){const or=xe[br];or&&typeof or=="object"&&Object.keys(or).forEach(Dr=>{or[Dr]&&typeof or[Dr]=="object"?Nr[Dr]={...Nr[Dr],...or[Dr]}:Nr[Dr]=or[Dr]})}return o?o(Nr):Nr},[ce,br,_e,xe,Me]),mr=ce.colorSchemeSelector;vu(()=>{if(mt&&ie&&mr&&mr!=="media"){const fr=mr;let Nr=mr;if(fr==="class"&&(Nr=".%s"),fr==="data"&&(Nr="[data-%s]"),fr?.startsWith("data-")&&!fr.includes("%s")&&(Nr=`[${fr}="%s"]`),Nr.startsWith("."))ie.classList.remove(...He.map(or=>Nr.substring(1).replace("%s",or))),ie.classList.add(Nr.substring(1).replace("%s",mt));else{const or=Nr.replace("%s",mt).match(/\[([^\]]+)\]/);if(or){const[Dr,er]=or[1].split("=");er||He.forEach(Gt=>{ie.removeAttribute(Dr.replace(mt,Gt))}),ie.setAttribute(Dr,er?er.replace(/"|'/g,""):"")}else ie.setAttribute(Nr,mt)}}},[mt,mr,ie,He]),ee.useEffect(()=>{let fr;if(B&&de.current&&G){const Nr=G.createElement("style");Nr.appendChild(G.createTextNode(ase)),G.head.appendChild(Nr),window.getComputedStyle(G.body),fr=setTimeout(()=>{G.head.removeChild(Nr)},1)}return()=>{clearTimeout(fr)}},[mt,B,G]),ee.useEffect(()=>(de.current=!0,()=>{de.current=!1}),[]);const Mr=ee.useMemo(()=>({allColorSchemes:He,colorScheme:mt,darkColorScheme:Ve,lightColorScheme:at,mode:yr,setColorScheme:Yt,setMode:Ie,systemMode:Lt}),[He,mt,Ve,at,yr,Yt,Ie,Lt,Tr.colorSchemeSelector]);let Pr=!0;(H||ce.cssVariables===!1||Ee&&Pe?.cssVarPrefix===Me)&&(Pr=!1);const ar=Z.jsxs(ee.Fragment,{children:[Z.jsx(WW,{themeId:Ae?e:void 0,theme:Tr,children:L}),Pr&&Z.jsx(AW,{styles:Tr.generateStyleSheets?.()||[]})]});return Ee?ar:Z.jsx(h.Provider,{value:Mr,children:ar})}const S=typeof s=="string"?s:s.light,E=typeof s=="string"?s:s.dark;return{CssVarsProvider:v,useColorScheme:f,getInitColorSchemeScript:k=>ese({colorSchemeStorageKey:i,defaultLightColorScheme:S,defaultDarkColorScheme:E,modeStorageKey:n,...k})}}function sse(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const RF=(t,e,r,n=[])=>{let i=t;e.forEach((a,s)=>{s===e.length-1?Array.isArray(i)?i[Number(a)]=r:i&&typeof i=="object"&&(i[a]=r):i&&typeof i=="object"&&(i[a]||(i[a]=n.includes(a)?[]:{}),i=i[a])})},lse=(t,e,r)=>{function n(i,a=[],s=[]){Object.entries(i).forEach(([o,u])=>{(!r||r&&!r([...a,o]))&&u!=null&&(typeof u=="object"&&Object.keys(u).length>0?n(u,[...a,o],Array.isArray(u)?[...s,o]:s):e([...a,o],u,s))})}n(t)},use=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function h3(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},a={},s={};return lse(t,(o,u,h)=>{if((typeof u=="string"||typeof u=="number")&&(!n||!n(o,u))){const f=`--${r?`${r}-`:""}${o.join("-")}`,d=use(o,u);Object.assign(i,{[f]:d}),RF(a,o,`var(${f})`,h),RF(s,o,`var(${f}, ${d})`,h)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:s}}function cse(t,e={}){const{getSelector:r=k,disableCssColorScheme:n,colorSchemeSelector:i,enableContrastVars:a}=e,{colorSchemes:s={},components:o,defaultColorScheme:u="light",...h}=t,{vars:f,css:d,varsWithDefaults:b}=h3(h,e);let v=b;const S={},{[u]:E,...P}=s;if(Object.entries(P||{}).forEach(([M,z])=>{const{vars:B,css:q,varsWithDefaults:W}=h3(z,e);v=Wu(v,W),S[M]={css:q,vars:B}}),E){const{css:M,vars:z,varsWithDefaults:B}=h3(E,e);v=Wu(v,B),S[u]={css:M,vars:z}}function k(M,z){let B=i;if(i==="class"&&(B=".%s"),i==="data"&&(B="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(B=`[${i}="%s"]`),M){if(B==="media")return t.defaultColorScheme===M?":root":{[`@media (prefers-color-scheme: ${s[M]?.palette?.mode||M})`]:{":root":z}};if(B)return t.defaultColorScheme===M?`:root, ${B.replace("%s",String(M))}`:B.replace("%s",String(M))}return":root"}return{vars:v,generateThemeVars:()=>{let M={...f};return Object.entries(S).forEach(([,{vars:z}])=>{M=Wu(M,z)}),M},generateStyleSheets:()=>{const M=[],z=t.defaultColorScheme||"light";function B(G,ie){Object.keys(ie).length&&M.push(typeof G=="string"?{[G]:{...ie}}:G)}B(r(void 0,{...d}),d);const{[z]:q,...W}=S;if(q){const{css:G}=q,ie=s[z]?.palette?.mode,J=!n&&ie?{colorScheme:ie,...G}:{...G};B(r(z,{...J}),J)}return Object.entries(W).forEach(([G,{css:ie}])=>{const J=s[G]?.palette?.mode,H=!n&&J?{colorScheme:J,...ie}:{...ie};B(r(G,{...H}),H)}),a&&M.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),M}}}function hse(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function gi(t,e,r=void 0){const n={};for(const i in t){const a=t[i];let s="",o=!0;for(let u=0;u<a.length;u+=1){const h=a[u];h&&(s+=(o===!0?"":" ")+e(h),o=!1,r&&r[h]&&(s+=" "+r[h]))}n[i]=s}return n}function _1(t,e){return ee.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const fse=(t,e)=>t.filter(r=>e.includes(r)),C0=(t,e,r)=>{const n=t.keys[0];Array.isArray(e)?e.forEach((i,a)=>{r((s,o)=>{a<=t.keys.length-1&&(a===0?Object.assign(s,o):s[t.up(t.keys[a])]=o)},i)}):e&&typeof e=="object"?(Object.keys(e).length>t.keys.length?t.keys:fse(t.keys,Object.keys(e))).forEach(a=>{if(t.keys.includes(a)){const s=e[a];s!==void 0&&r((o,u)=>{n===a?Object.assign(o,u):o[t.up(a)]=u},s)}}):(typeof e=="number"||typeof e=="string")&&r((i,a)=>{Object.assign(i,a)},e)};function Hw(t){return`--Grid-${t}Spacing`}function GE(t){return`--Grid-parent-${t}Spacing`}const OF="--Grid-columns",Fv="--Grid-parent-columns",dse=({theme:t,ownerState:e})=>{const r={};return C0(t.breakpoints,e.size,(n,i)=>{let a={};i==="grow"&&(a={flexBasis:0,flexGrow:1,maxWidth:"100%"}),i==="auto"&&(a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof i=="number"&&(a={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${i} / var(${Fv}) - (var(${Fv}) - ${i}) * (var(${GE("column")}) / var(${Fv})))`}),n(r,a)}),r},pse=({theme:t,ownerState:e})=>{const r={};return C0(t.breakpoints,e.offset,(n,i)=>{let a={};i==="auto"&&(a={marginLeft:"auto"}),typeof i=="number"&&(a={marginLeft:i===0?"0px":`calc(100% * ${i} / var(${Fv}) + var(${GE("column")}) * ${i} / var(${Fv}))`}),n(r,a)}),r},gse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={[OF]:12};return C0(t.breakpoints,e.columns,(n,i)=>{const a=i??12;n(r,{[OF]:a,"> *":{[Fv]:a}})}),r},mse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return C0(t.breakpoints,e.rowSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[Hw("row")]:a,"> *":{[GE("row")]:a}})}),r},yse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return C0(t.breakpoints,e.columnSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[Hw("column")]:a,"> *":{[GE("column")]:a}})}),r},vse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return C0(t.breakpoints,e.direction,(n,i)=>{n(r,{flexDirection:i})}),r},_se=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${Hw("row")}) var(${Hw("column")})`}}),bse=t=>{const e=[];return Object.entries(t).forEach(([r,n])=>{n!==!1&&n!==void 0&&e.push(`grid-${r}-${String(n)}`)}),e},xse=(t,e="xs")=>{function r(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(r(t))return[`spacing-${e}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const n=[];return Object.entries(t).forEach(([i,a])=>{r(a)&&n.push(`spacing-${i}-${String(a)}`)}),n}return[]},wse=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([e,r])=>`direction-${e}-${r}`):[`direction-xs-${String(t)}`];function Sse(t,e){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,e.keys.forEach(r=>{t[r]!==void 0&&delete t[r]})}const Ese=VE(),Tse=Fm("div",{name:"MuiGrid",slot:"Root"});function Cse(t){return Noe({props:t,name:"MuiGrid",defaultTheme:Ese})}function Ase(t={}){const{createStyledComponent:e=Tse,useThemeProps:r=Cse,useTheme:n=Vb,componentName:i="MuiGrid"}=t,a=(h,f)=>{const{container:d,direction:b,spacing:v,wrap:S,size:E}=h,P={root:["root",d&&"container",S!=="wrap"&&`wrap-xs-${String(S)}`,...wse(b),...bse(E),...d?xse(v,f.breakpoints.keys[0]):[]]};return gi(P,k=>pi(i,k),{})};function s(h,f,d=()=>!0){const b={};return h===null||(Array.isArray(h)?h.forEach((v,S)=>{v!==null&&d(v)&&f.keys[S]&&(b[f.keys[S]]=v)}):typeof h=="object"?Object.keys(h).forEach(v=>{const S=h[v];S!=null&&d(S)&&(b[v]=S)}):b[f.keys[0]]=h),b}const o=e(gse,yse,mse,dse,vse,_se,pse),u=ee.forwardRef(function(f,d){const b=n(),v=r(f),S=NR(v);Sse(S,b.breakpoints);const{className:E,children:P,columns:k=12,container:L=!1,component:N="div",direction:M="row",wrap:z="wrap",size:B={},offset:q={},spacing:W=0,rowSpacing:G=W,columnSpacing:ie=W,unstable_level:J=0,...H}=S,ne=s(B,b.breakpoints,Ae=>Ae!==!1),ae=s(q,b.breakpoints),ue=f.columns??(J?void 0:k),de=f.spacing??(J?void 0:W),Pe=f.rowSpacing??f.spacing??(J?void 0:G),me=f.columnSpacing??f.spacing??(J?void 0:ie),Ee={...S,level:J,columns:ue,container:L,direction:M,wrap:z,spacing:de,rowSpacing:Pe,columnSpacing:me,size:ne,offset:ae},we=a(Ee,b);return Z.jsx(o,{ref:d,as:N,ownerState:Ee,className:An(we.root,E),...H,children:ee.Children.map(P,Ae=>ee.isValidElement(Ae)&&_1(Ae,["Grid"])&&L&&Ae.props.container?ee.cloneElement(Ae,{unstable_level:Ae.props?.unstable_level??J+1}):Ae)})});return u.muiName="Grid",u}const X1={black:"#000",white:"#fff"},Ise={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},xy={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},wy={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},p_={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Sy={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Ey={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Ty={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function XW(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:X1.white,default:X1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const YW=XW();function ZW(){return{text:{primary:X1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:X1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const xP=ZW();function NF(t,e,r,n){const i=n.light||n,a=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=WE(t.main,i):e==="dark"&&(t.dark=HE(t.main,a)))}function LF(t,e,r,n,i){const a=i.light||i,s=i.dark||i*1.5;e[r]||(e.hasOwnProperty(n)?e[r]=e[n]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(a*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(s*100).toFixed(0)}%)`))}function Pse(t="light"){return t==="dark"?{main:Sy[200],light:Sy[50],dark:Sy[400]}:{main:Sy[700],light:Sy[400],dark:Sy[800]}}function kse(t="light"){return t==="dark"?{main:xy[200],light:xy[50],dark:xy[400]}:{main:xy[500],light:xy[300],dark:xy[700]}}function Mse(t="light"){return t==="dark"?{main:wy[500],light:wy[300],dark:wy[700]}:{main:wy[700],light:wy[400],dark:wy[800]}}function Rse(t="light"){return t==="dark"?{main:Ey[400],light:Ey[300],dark:Ey[700]}:{main:Ey[700],light:Ey[500],dark:Ey[900]}}function Ose(t="light"){return t==="dark"?{main:Ty[400],light:Ty[300],dark:Ty[700]}:{main:Ty[800],light:Ty[500],dark:Ty[900]}}function Nse(t="light"){return t==="dark"?{main:p_[400],light:p_[300],dark:p_[700]}:{main:"#ed6c02",light:p_[500],dark:p_[900]}}function Lse(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function jR(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,colorSpace:i,...a}=t,s=t.primary||Pse(e),o=t.secondary||kse(e),u=t.error||Mse(e),h=t.info||Rse(e),f=t.success||Ose(e),d=t.warning||Nse(e);function b(P){return i?Lse(P):joe(P,xP.text.primary)>=r?xP.text.primary:YW.text.primary}const v=({color:P,name:k,mainShade:L=500,lightShade:N=300,darkShade:M=700})=>{if(P={...P},!P.main&&P[L]&&(P.main=P[L]),!P.hasOwnProperty("main"))throw new Error(Hd(11,k?` (${k})`:"",L));if(typeof P.main!="string")throw new Error(Hd(12,k?` (${k})`:"",JSON.stringify(P.main)));return i?(LF(i,P,"light",N,n),LF(i,P,"dark",M,n)):(NF(P,"light",N,n),NF(P,"dark",M,n)),P.contrastText||(P.contrastText=b(P.main)),P};let S;return e==="light"?S=XW():e==="dark"&&(S=ZW()),Wu({common:{...X1},mode:e,primary:v({color:s,name:"primary"}),secondary:v({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:u,name:"error"}),warning:v({color:d,name:"warning"}),info:v({color:h,name:"info"}),success:v({color:f,name:"success"}),grey:Ise,contrastThreshold:r,getContrastText:b,augmentColor:v,tonalOffset:n,...S},a)}function Dse(t){const e={};return Object.entries(t).forEach(n=>{const[i,a]=n;typeof a=="object"&&(e[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),e}function Fse(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Bse(t){return Math.round(t*1e5)/1e5}const DF={textTransform:"uppercase"},FF='"Roboto", "Helvetica", "Arial", sans-serif';function KW(t,e){const{fontFamily:r=FF,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:o=700,htmlFontSize:u=16,allVariants:h,pxToRem:f,...d}=typeof e=="function"?e(t):e,b=n/14,v=f||(P=>`${P/u*b}rem`),S=(P,k,L,N,M)=>({fontFamily:r,fontWeight:P,fontSize:v(k),lineHeight:L,...r===FF?{letterSpacing:`${Bse(N/k)}em`}:{},...M,...h}),E={h1:S(i,96,1.167,-1.5),h2:S(i,60,1.2,-.5),h3:S(a,48,1.167,0),h4:S(a,34,1.235,.25),h5:S(a,24,1.334,0),h6:S(s,20,1.6,.15),subtitle1:S(a,16,1.75,.15),subtitle2:S(s,14,1.57,.1),body1:S(a,16,1.5,.15),body2:S(a,14,1.43,.15),button:S(s,14,1.75,.4,DF),caption:S(a,12,1.66,.4),overline:S(a,12,2.66,1,DF),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Wu({htmlFontSize:u,pxToRem:v,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:o,...E},d,{clone:!1})}const zse=.2,jse=.14,Use=.12;function ts(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${zse})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${jse})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Use})`].join(",")}const Vse=["none",ts(0,2,1,-1,0,1,1,0,0,1,3,0),ts(0,3,1,-2,0,2,2,0,0,1,5,0),ts(0,3,3,-2,0,3,4,0,0,1,8,0),ts(0,2,4,-1,0,4,5,0,0,1,10,0),ts(0,3,5,-1,0,5,8,0,0,1,14,0),ts(0,3,5,-1,0,6,10,0,0,1,18,0),ts(0,4,5,-2,0,7,10,1,0,2,16,1),ts(0,5,5,-3,0,8,10,1,0,3,14,2),ts(0,5,6,-3,0,9,12,1,0,3,16,2),ts(0,6,6,-3,0,10,14,1,0,4,18,3),ts(0,6,7,-4,0,11,15,1,0,4,20,3),ts(0,7,8,-4,0,12,17,2,0,5,22,4),ts(0,7,8,-4,0,13,19,2,0,5,24,4),ts(0,7,9,-4,0,14,21,2,0,5,26,4),ts(0,8,9,-5,0,15,22,2,0,6,28,5),ts(0,8,10,-5,0,16,24,2,0,6,30,5),ts(0,8,11,-5,0,17,26,2,0,6,32,5),ts(0,9,11,-5,0,18,28,2,0,7,34,6),ts(0,9,12,-6,0,19,29,2,0,7,36,6),ts(0,10,13,-6,0,20,31,3,0,8,38,7),ts(0,10,13,-6,0,21,33,3,0,8,40,7),ts(0,10,14,-6,0,22,35,3,0,8,42,7),ts(0,11,14,-7,0,23,36,3,0,9,44,8),ts(0,11,15,-7,0,24,38,3,0,9,46,8)],$se={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},JW={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function BF(t){return`${Math.round(t)}ms`}function qse(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Hse(t){const e={...$se,...t.easing},r={...JW,...t.duration};return{getAutoHeightDuration:qse,create:(i=["all"],a={})=>{const{duration:s=r.standard,easing:o=e.easeInOut,delay:u=0,...h}=a;return(Array.isArray(i)?i:[i]).map(f=>`${f} ${typeof s=="string"?s:BF(s)} ${o} ${typeof u=="string"?u:BF(u)}`).join(",")},...t,easing:e,duration:r}}const Wse={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Gse(t){return Vf(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function QW(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let a=0;a<i.length;a++){const[s,o]=i[a];!Gse(o)||s.startsWith("unstable_")?delete n[s]:Vf(o)&&(n[s]={...o},r(n[s]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function zF(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const Xse=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let n=0;n<e.length;n+=1)r+=+e[n];return r};function Yse(t){Object.assign(t,{alpha(e,r){const n=this||t;return n.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:qw(e,Xse(r))},lighten(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${zF(r)})`:WE(e,r)},darken(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${zF(r)})`:HE(e,r)}})}function wP(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:a={},transitions:s={},typography:o={},shape:u,colorSpace:h,...f}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Hd(20));const d=jR({...a,colorSpace:h}),b=VE(t);let v=Wu(b,{mixins:Fse(b.breakpoints,n),palette:d,shadows:Vse.slice(),typography:KW(d,o),transitions:Hse(s),zIndex:{...Wse}});return v=Wu(v,f),v=e.reduce((S,E)=>Wu(S,E),v),v.unstable_sxConfig={...Ub,...f?.unstable_sxConfig},v.unstable_sx=function(E){return Zp({sx:E,theme:this})},v.toRuntimeSource=QW,Yse(v),v}function SP(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const Zse=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=SP(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function eG(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function tG(t){return t==="dark"?Zse:[]}function Kse(t){const{palette:e={mode:"light"},opacity:r,overlays:n,colorSpace:i,...a}=t,s=jR({...e,colorSpace:i});return{palette:s,opacity:{...eG(s.mode),...r},overlays:n||tG(s.mode),...a}}function Jse(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const Qse=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],ele=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const s={};return Qse(t.cssVarPrefix).forEach(o=>{s[o]=r[o],delete r[o]}),a==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:s}}:a?{[a.replace("%s",e)]:s,[`${n}, ${a.replace("%s",e)}`]:r}:{[n]:{...r,...s}}}if(a&&a!=="media")return`${n}, ${a.replace("%s",String(e))}`}else if(e){if(a==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(a)return a.replace("%s",String(e))}return n};function tle(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Hr(t,e,r){!t[e]&&r&&(t[e]=r)}function W_(t){return typeof t!="string"||!t.startsWith("hsl")?t:VW(t)}function Sd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=H_(W_(t[e])))}function rle(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Rf=t=>{try{return t()}catch{}},nle=(t="mui")=>sse(t);function f3(t,e,r,n,i){if(!r)return;r=r===!0?{}:r;const a=i==="dark"?"dark":"light";if(!n){e[i]=Kse({...r,palette:{mode:a,...r?.palette},colorSpace:t});return}const{palette:s,...o}=wP({...n,palette:{mode:a,...r?.palette},colorSpace:t});return e[i]={...r,palette:s,opacity:{...eG(a),...r?.opacity},overlays:r?.overlays||tG(a)},o}function ile(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",nativeColor:s=!1,shouldSkipGeneratingVar:o=Jse,colorSchemeSelector:u=r.light&&r.dark?"media":void 0,rootSelector:h=":root",...f}=t,d=Object.keys(r)[0],b=n||(r.light&&d!=="light"?"light":d),v=nle(a),{[b]:S,light:E,dark:P,...k}=r,L={...k};let N=S;if((b==="dark"&&!("dark"in r)||b==="light"&&!("light"in r))&&(N=!0),!N)throw new Error(Hd(21,b));let M;s&&(M="oklch");const z=f3(M,L,N,f,b);E&&!L.light&&f3(M,L,E,void 0,"light"),P&&!L.dark&&f3(M,L,P,void 0,"dark");let B={defaultColorScheme:b,...z,cssVarPrefix:a,colorSchemeSelector:u,rootSelector:h,getCssVar:v,colorSchemes:L,font:{...Dse(z.typography),...z.font},spacing:rle(f.spacing)};Object.keys(B.colorSchemes).forEach(J=>{const H=B.colorSchemes[J].palette,ne=ue=>{const de=ue.split("-"),Pe=de[1],me=de[2];return v(ue,H[Pe][me])};H.mode==="light"&&(Hr(H.common,"background","#fff"),Hr(H.common,"onBackground","#000")),H.mode==="dark"&&(Hr(H.common,"background","#000"),Hr(H.common,"onBackground","#fff"));function ae(ue,de,Pe){if(M){let me;return ue===kg&&(me=`transparent ${((1-Pe)*100).toFixed(0)}%`),ue===no&&(me=`#000 ${(Pe*100).toFixed(0)}%`),ue===io&&(me=`#fff ${(Pe*100).toFixed(0)}%`),`color-mix(in ${M}, ${de}, ${me})`}return ue(de,Pe)}if(tle(H,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),H.mode==="light"){Hr(H.Alert,"errorColor",ae(no,H.error.light,.6)),Hr(H.Alert,"infoColor",ae(no,H.info.light,.6)),Hr(H.Alert,"successColor",ae(no,H.success.light,.6)),Hr(H.Alert,"warningColor",ae(no,H.warning.light,.6)),Hr(H.Alert,"errorFilledBg",ne("palette-error-main")),Hr(H.Alert,"infoFilledBg",ne("palette-info-main")),Hr(H.Alert,"successFilledBg",ne("palette-success-main")),Hr(H.Alert,"warningFilledBg",ne("palette-warning-main")),Hr(H.Alert,"errorFilledColor",Rf(()=>H.getContrastText(H.error.main))),Hr(H.Alert,"infoFilledColor",Rf(()=>H.getContrastText(H.info.main))),Hr(H.Alert,"successFilledColor",Rf(()=>H.getContrastText(H.success.main))),Hr(H.Alert,"warningFilledColor",Rf(()=>H.getContrastText(H.warning.main))),Hr(H.Alert,"errorStandardBg",ae(io,H.error.light,.9)),Hr(H.Alert,"infoStandardBg",ae(io,H.info.light,.9)),Hr(H.Alert,"successStandardBg",ae(io,H.success.light,.9)),Hr(H.Alert,"warningStandardBg",ae(io,H.warning.light,.9)),Hr(H.Alert,"errorIconColor",ne("palette-error-main")),Hr(H.Alert,"infoIconColor",ne("palette-info-main")),Hr(H.Alert,"successIconColor",ne("palette-success-main")),Hr(H.Alert,"warningIconColor",ne("palette-warning-main")),Hr(H.AppBar,"defaultBg",ne("palette-grey-100")),Hr(H.Avatar,"defaultBg",ne("palette-grey-400")),Hr(H.Button,"inheritContainedBg",ne("palette-grey-300")),Hr(H.Button,"inheritContainedHoverBg",ne("palette-grey-A100")),Hr(H.Chip,"defaultBorder",ne("palette-grey-400")),Hr(H.Chip,"defaultAvatarColor",ne("palette-grey-700")),Hr(H.Chip,"defaultIconColor",ne("palette-grey-700")),Hr(H.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Hr(H.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Hr(H.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Hr(H.LinearProgress,"primaryBg",ae(io,H.primary.main,.62)),Hr(H.LinearProgress,"secondaryBg",ae(io,H.secondary.main,.62)),Hr(H.LinearProgress,"errorBg",ae(io,H.error.main,.62)),Hr(H.LinearProgress,"infoBg",ae(io,H.info.main,.62)),Hr(H.LinearProgress,"successBg",ae(io,H.success.main,.62)),Hr(H.LinearProgress,"warningBg",ae(io,H.warning.main,.62)),Hr(H.Skeleton,"bg",M?ae(kg,H.text.primary,.11):`rgba(${ne("palette-text-primaryChannel")} / 0.11)`),Hr(H.Slider,"primaryTrack",ae(io,H.primary.main,.62)),Hr(H.Slider,"secondaryTrack",ae(io,H.secondary.main,.62)),Hr(H.Slider,"errorTrack",ae(io,H.error.main,.62)),Hr(H.Slider,"infoTrack",ae(io,H.info.main,.62)),Hr(H.Slider,"successTrack",ae(io,H.success.main,.62)),Hr(H.Slider,"warningTrack",ae(io,H.warning.main,.62));const ue=M?ae(no,H.background.default,.6825):zx(H.background.default,.8);Hr(H.SnackbarContent,"bg",ue),Hr(H.SnackbarContent,"color",Rf(()=>M?xP.text.primary:H.getContrastText(ue))),Hr(H.SpeedDialAction,"fabHoverBg",zx(H.background.paper,.15)),Hr(H.StepConnector,"border",ne("palette-grey-400")),Hr(H.StepContent,"border",ne("palette-grey-400")),Hr(H.Switch,"defaultColor",ne("palette-common-white")),Hr(H.Switch,"defaultDisabledColor",ne("palette-grey-100")),Hr(H.Switch,"primaryDisabledColor",ae(io,H.primary.main,.62)),Hr(H.Switch,"secondaryDisabledColor",ae(io,H.secondary.main,.62)),Hr(H.Switch,"errorDisabledColor",ae(io,H.error.main,.62)),Hr(H.Switch,"infoDisabledColor",ae(io,H.info.main,.62)),Hr(H.Switch,"successDisabledColor",ae(io,H.success.main,.62)),Hr(H.Switch,"warningDisabledColor",ae(io,H.warning.main,.62)),Hr(H.TableCell,"border",ae(io,ae(kg,H.divider,1),.88)),Hr(H.Tooltip,"bg",ae(kg,H.grey[700],.92))}if(H.mode==="dark"){Hr(H.Alert,"errorColor",ae(io,H.error.light,.6)),Hr(H.Alert,"infoColor",ae(io,H.info.light,.6)),Hr(H.Alert,"successColor",ae(io,H.success.light,.6)),Hr(H.Alert,"warningColor",ae(io,H.warning.light,.6)),Hr(H.Alert,"errorFilledBg",ne("palette-error-dark")),Hr(H.Alert,"infoFilledBg",ne("palette-info-dark")),Hr(H.Alert,"successFilledBg",ne("palette-success-dark")),Hr(H.Alert,"warningFilledBg",ne("palette-warning-dark")),Hr(H.Alert,"errorFilledColor",Rf(()=>H.getContrastText(H.error.dark))),Hr(H.Alert,"infoFilledColor",Rf(()=>H.getContrastText(H.info.dark))),Hr(H.Alert,"successFilledColor",Rf(()=>H.getContrastText(H.success.dark))),Hr(H.Alert,"warningFilledColor",Rf(()=>H.getContrastText(H.warning.dark))),Hr(H.Alert,"errorStandardBg",ae(no,H.error.light,.9)),Hr(H.Alert,"infoStandardBg",ae(no,H.info.light,.9)),Hr(H.Alert,"successStandardBg",ae(no,H.success.light,.9)),Hr(H.Alert,"warningStandardBg",ae(no,H.warning.light,.9)),Hr(H.Alert,"errorIconColor",ne("palette-error-main")),Hr(H.Alert,"infoIconColor",ne("palette-info-main")),Hr(H.Alert,"successIconColor",ne("palette-success-main")),Hr(H.Alert,"warningIconColor",ne("palette-warning-main")),Hr(H.AppBar,"defaultBg",ne("palette-grey-900")),Hr(H.AppBar,"darkBg",ne("palette-background-paper")),Hr(H.AppBar,"darkColor",ne("palette-text-primary")),Hr(H.Avatar,"defaultBg",ne("palette-grey-600")),Hr(H.Button,"inheritContainedBg",ne("palette-grey-800")),Hr(H.Button,"inheritContainedHoverBg",ne("palette-grey-700")),Hr(H.Chip,"defaultBorder",ne("palette-grey-700")),Hr(H.Chip,"defaultAvatarColor",ne("palette-grey-300")),Hr(H.Chip,"defaultIconColor",ne("palette-grey-300")),Hr(H.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Hr(H.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Hr(H.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Hr(H.LinearProgress,"primaryBg",ae(no,H.primary.main,.5)),Hr(H.LinearProgress,"secondaryBg",ae(no,H.secondary.main,.5)),Hr(H.LinearProgress,"errorBg",ae(no,H.error.main,.5)),Hr(H.LinearProgress,"infoBg",ae(no,H.info.main,.5)),Hr(H.LinearProgress,"successBg",ae(no,H.success.main,.5)),Hr(H.LinearProgress,"warningBg",ae(no,H.warning.main,.5)),Hr(H.Skeleton,"bg",M?ae(kg,H.text.primary,.13):`rgba(${ne("palette-text-primaryChannel")} / 0.13)`),Hr(H.Slider,"primaryTrack",ae(no,H.primary.main,.5)),Hr(H.Slider,"secondaryTrack",ae(no,H.secondary.main,.5)),Hr(H.Slider,"errorTrack",ae(no,H.error.main,.5)),Hr(H.Slider,"infoTrack",ae(no,H.info.main,.5)),Hr(H.Slider,"successTrack",ae(no,H.success.main,.5)),Hr(H.Slider,"warningTrack",ae(no,H.warning.main,.5));const ue=M?ae(io,H.background.default,.985):zx(H.background.default,.98);Hr(H.SnackbarContent,"bg",ue),Hr(H.SnackbarContent,"color",Rf(()=>M?YW.text.primary:H.getContrastText(ue))),Hr(H.SpeedDialAction,"fabHoverBg",zx(H.background.paper,.15)),Hr(H.StepConnector,"border",ne("palette-grey-600")),Hr(H.StepContent,"border",ne("palette-grey-600")),Hr(H.Switch,"defaultColor",ne("palette-grey-300")),Hr(H.Switch,"defaultDisabledColor",ne("palette-grey-600")),Hr(H.Switch,"primaryDisabledColor",ae(no,H.primary.main,.55)),Hr(H.Switch,"secondaryDisabledColor",ae(no,H.secondary.main,.55)),Hr(H.Switch,"errorDisabledColor",ae(no,H.error.main,.55)),Hr(H.Switch,"infoDisabledColor",ae(no,H.info.main,.55)),Hr(H.Switch,"successDisabledColor",ae(no,H.success.main,.55)),Hr(H.Switch,"warningDisabledColor",ae(no,H.warning.main,.55)),Hr(H.TableCell,"border",ae(no,ae(kg,H.divider,1),.68)),Hr(H.Tooltip,"bg",ae(kg,H.grey[700],.92))}Sd(H.background,"default"),Sd(H.background,"paper"),Sd(H.common,"background"),Sd(H.common,"onBackground"),Sd(H,"divider"),Object.keys(H).forEach(ue=>{const de=H[ue];ue!=="tonalOffset"&&de&&typeof de=="object"&&(de.main&&Hr(H[ue],"mainChannel",H_(W_(de.main))),de.light&&Hr(H[ue],"lightChannel",H_(W_(de.light))),de.dark&&Hr(H[ue],"darkChannel",H_(W_(de.dark))),de.contrastText&&Hr(H[ue],"contrastTextChannel",H_(W_(de.contrastText))),ue==="text"&&(Sd(H[ue],"primary"),Sd(H[ue],"secondary")),ue==="action"&&(de.active&&Sd(H[ue],"active"),de.selected&&Sd(H[ue],"selected")))})}),B=e.reduce((J,H)=>Wu(J,H),B);const q={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:ele(B),enableContrastVars:s},{vars:W,generateThemeVars:G,generateStyleSheets:ie}=cse(B,q);return B.vars=W,Object.entries(B.colorSchemes[B.defaultColorScheme]).forEach(([J,H])=>{B[J]=H}),B.generateThemeVars=G,B.generateStyleSheets=ie,B.generateSpacing=function(){return RW(f.spacing,RR(this))},B.getColorSchemeSelector=hse(u),B.spacing=B.generateSpacing(),B.shouldSkipGeneratingVar=o,B.unstable_sxConfig={...Ub,...f?.unstable_sxConfig},B.unstable_sx=function(H){return Zp({sx:H,theme:this})},B.toRuntimeSource=QW,B}function jF(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:jR({...r===!0?{}:r.palette,mode:e})})}function A0(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:a=r?.mode,...s}=t,o=a||"light",u=i?.[o],h={...i,...r?{[o]:{...typeof u!="boolean"&&u,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return wP(t,...e);let f=r;"palette"in t||h[o]&&(h[o]!==!0?f=h[o].palette:o==="dark"&&(f={mode:"dark"}));const d=wP({...t,palette:f},...e);return d.defaultColorScheme=o,d.colorSchemes=h,d.palette.mode==="light"&&(d.colorSchemes.light={...h.light!==!0&&h.light,palette:d.palette},jF(d,"dark",h.dark)),d.palette.mode==="dark"&&(d.colorSchemes.dark={...h.dark!==!0&&h.dark,palette:d.palette},jF(d,"light",h.light)),d}return!r&&!("light"in h)&&o==="light"&&(h.light=!0),ile({...s,colorSchemes:h,defaultColorScheme:o,...typeof n!="boolean"&&n},...e)}const UR=A0();function kc(){const t=Vb(UR);return t[nf]||t}function XE(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const _l=t=>XE(t)&&t!=="classes",Br=BW({themeId:nf,defaultTheme:UR,rootShouldForwardProp:_l});function ale({theme:t,...e}){const r=nf in t?t[nf]:void 0;return Z.jsx(WW,{...e,themeId:r?nf:void 0,theme:r||t})}const jx={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:ole}=ose({themeId:nf,theme:()=>A0({cssVariables:!0}),colorSchemeStorageKey:jx.colorSchemeStorageKey,modeStorageKey:jx.modeStorageKey,defaultColorScheme:{light:jx.defaultLightColorScheme,dark:jx.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:KW(t.palette,t.typography)};return e.unstable_sx=function(n){return Zp({sx:n,theme:this})},e}}),sle=ole;function rG({theme:t,...e}){const r=ee.useMemo(()=>{if(typeof t=="function")return t;const n=nf in t?t[nf]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?Z.jsx(ale,{theme:r,...e}):Z.jsx(sle,{theme:t,...e})}const lle=A0({palette:{mode:"light"}}),ule=A0({palette:{mode:"dark"}}),cle=t=>({...t==="light"?lle:ule,palette:{mode:t,...t==="dark"?{primary:{main:"#009EE0"},secondary:{main:"#747577"},background:{paper:"#313131"},text:{primary:"#FFF",contrast:"#000"},topToolbar:{barColor:"#000"},navigation:{buttonColor:"#fff",navColor:"#313131",navHover:"#747577"},GPS:{GPSActiveColor:"#fff",GPSInactiveColor:"#fff",GPSActiveBackgroundColor:"#747577"},compass:{compColor:"#313131",compHover:"#747577",compStroke:"#d3dce1",compNorth:"#cf003f",compSouth:"#d3dcf0"}}:{primary:{main:"#009EE0"},secondary:{main:"#747577"},text:{primary:"#000",contrast:"#fff"},topToolbar:{barColor:"#fff"},navigation:{buttonColor:"#747577",navColor:"#fff",navHover:"#f5f5f5"},GPS:{GPSActiveColor:"#009EE0",GPSInactiveColor:"#747577",GPSActiveBackgroundColor:"#fff"},compass:{compColor:"#fff",compHover:"#f5f5f5",compStroke:"#009ee0",compNorth:"#cf003f",compSouth:"#d3dcf0"}}}}),nG=t=>{const e=cle(t&&["light","dark"].includes(t)?t:"light");return A0(e,{components:{MuiTypography:{styleOverrides:{root:{}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:e.palette.topToolbar.barColor}}},MuiButton:{variants:[{props:{variant:"navtools"},style:{minWidth:"20px",minHeight:"20px",fontWeight:600,[e.breakpoints.down("md")]:{width:"50px",height:"50px",fontSize:"1.4em"},[e.breakpoints.up("md")]:{width:"30px",height:"30px",fontSize:"1.2em"},color:e.palette.text.primary,backgroundColor:e.palette.navigation.navColor,borderRadius:"23%",margin:"0.15px",marginTop:"4px",":hover":{backgroundColor:e.palette.navigation.navHover}}}]},MuiListItemText:{styleOverrides:{primary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.9rem"}:{},secondary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.7rem"}:{}}}}})};try{MapcomponentsTheme.displayName="MapcomponentsTheme",MapcomponentsTheme.__docgenInfo={description:"",displayName:"MapcomponentsTheme",props:{}}}catch{}const Gu={source_openmaptiles_url:"https://wms.wheregroup.com/tileserver/tile/world-0-14.json",sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",sourceOptions_tiles:["https://wms.wheregroup.com/tileserver/tile/world-0-14/{z}/{x}/{y}.pbf"]},du=[];for(let t=0;t<256;++t)du.push((t+256).toString(16).slice(1));function hle(t,e=0){return(du[t[e+0]]+du[t[e+1]]+du[t[e+2]]+du[t[e+3]]+"-"+du[t[e+4]]+du[t[e+5]]+"-"+du[t[e+6]]+du[t[e+7]]+"-"+du[t[e+8]]+du[t[e+9]]+"-"+du[t[e+10]]+du[t[e+11]]+du[t[e+12]]+du[t[e+13]]+du[t[e+14]]+du[t[e+15]]).toLowerCase()}let d3;const fle=new Uint8Array(16);function dle(){if(!d3){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d3=crypto.getRandomValues.bind(crypto)}return d3(fle)}const ple=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),UF={randomUUID:ple};function Ec(t,e,r){if(UF.randomUUID&&!t)return UF.randomUUID();t=t||{};const n=t.random??t.rng?.()??dle();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,hle(n)}const VR=ht.createContext({});function EP(t){const[e,r]=ht.useState([]),[n,i]=ht.useState([]),[a,s]=ht.useState([]),[o,u]=ht.useState(Gu.sourceOptions_tiles[0]),h=ee.useMemo(()=>({layerId:"openmaptiles",sourceOptions:{type:"vector",tiles:[o]}}),[o]),f=E=>{if(!E)return;const P=[],k=[];E.layers.forEach((L,N)=>{L.type==="symbol"?k.push(L):(N===0&&(L.id=E.name||"background"),P.push(L))}),i(P),s(k)};ee.useEffect(()=>{if(e.filter(E=>!E?.id).length){const E=[...e];E.forEach(P=>{P?.id||(P.id=Ec())}),r(E)}},[e]);const d=ee.useCallback((E,P)=>{const k=e?.filter?.(L=>L.id===E);if(k.length>0){const L=[...e],N=k[0],M=e.indexOf(N),z=P(M);z>=0&&z<=e.length-1&&(L.splice(M,1),L.splice(z,0,N),r(L))}},[e]),b=ee.useCallback(E=>{d(E,P=>P+1)},[d]),v=ee.useCallback(E=>{d(E,P=>P-1)},[d]),S={layers:e,setLayers:r,backgroundLayers:n,setBackgroundLayers:i,symbolLayers:a,setSymbolLayers:s,updateStyle:f,vtLayerConfig:h,tileUrl:o,setTileUrl:u,moveUp:v,moveDown:b,moveLayer:d};return Z.jsx(VR.Provider,{value:S,children:t.children})}try{EP.displayName="LayerContextProvider",EP.__docgenInfo={description:"",displayName:"LayerContextProvider",props:{}}}catch{}const sg=ht.createContext({}),TP=({children:t})=>{const[e,r]=ee.useState(void 0),[n,i]=ee.useState([]),a=ee.useRef([]),s=ee.useRef({}),o=f=>{if(f){typeof s.current[f]<"u"&&delete s.current[f];const d=a.current.indexOf(f);d>-1&&a.current.splice(d,1),i([...a.current]),a.current.length===0&&e&&r(void 0)}else o("anonymous_map")},h={map:e,setMap:f=>{if(r(f),n.length===0){const d="anonymous_map";i([...n,d]),s.current[d]=f}},maps:s.current,mapIds:n,registerMap:(f,d)=>{f&&d&&(s.current[f]=d,a.current.push(f),i([...a.current]),(!e||e?.cancelled===!0)&&r(d))},removeMap:o,mapExists:f=>f&&Object.keys(s.current).indexOf(f)===-1?!1:!(!f&&!e),getMap:f=>f&&n.indexOf(f)!==-1?s.current[f]:!f&&e?e:null};return Z.jsx(sg.Provider,{value:h,children:Z.jsx(EP,{children:Z.jsx(rG,{theme:nG("light"),children:t})})})};try{TP.displayName="MapComponentsProvider",TP.__docgenInfo={description:`MapComponentsProvider must be imported and wrapped around component where at least one of its child nodes requires access to a MapLibre-gl or openlayers instance that is registered in this mapContext.
MapComponentsProvider must be used one level higher than the first use of MapContext.

MapComponentsProvider requires at least one use of the MapLibreMap component somewhere down the component tree that will create the MapLibre-gl object and set the reference at MapContext.map. For MapLibre maps it is a good idea to provide a mapId attribute to the MapLibreMap Component even if you are only using a single map instance at start. It will make a later transition to using multiple instances within the same project much easier.`,displayName:"MapComponentsProvider",props:{}}}catch{}const iG={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",layers:[{id:"_background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},aG=t=>{const e=ee.useRef(null),r=ee.useRef(null),n=ee.useContext(sg),i=ee.useRef(t.mapId),a=ee.useRef(!1),s=ee.useRef(t.options?.style);return ee.useEffect(()=>{const o=i.current;return()=>{a.current=!1,n.removeMap(o),e.current&&(e.current.map?.remove?.(),e.current.cancelled=!0,e.current=null)}},[]),ee.useEffect(()=>{a.current||r.current&&(a.current=!0,e.current=new wie({mapOptions:{style:"",...t.options,...t?.options?.style?{}:{style:iG?.options?.style},container:r.current},onReady:(o,u)=>{o.once("load",()=>{u?.cancelled?o.remove():(window._map=o,t.mapId?n.registerMap(t.mapId,u):n.setMap(u))})}}))},[t.options,t.mapId]),ee.useEffect(()=>{e.current?.map&&t?.options?.style&&s.current!==t.options.style&&(s.current=t.options.style,e.current.map.setStyle(t.options.style))},[t?.options?.style]),Z.jsx("div",{ref:r,className:"mapContainer",style:t.style})};aG.defaultProps=iG;function YE(t){const e=ee.useContext(sg),r=ee.useRef(!1),n=ee.useRef(null),[i,a]=ee.useState(),s=ee.useRef(void 0),[o,u]=ee.useState([]),h=ee.useRef(""),f=ee.useRef(Ec()),d=ee.useCallback(v=>!t?.filter?.includeBaseLayers&&v?.baseLayer?!1:typeof t.filter?.matchLayerIds<"u"?t.filter.matchLayerIds instanceof RegExp?t.filter.matchLayerIds.test(v.id):v.id.includes(t.filter.matchLayerIds):!0,[t.filter]),b=ee.useCallback(()=>{if(!n.current)return;const v=n.current.wrapper.layerState.filter(d),S=JSON.stringify(v);h.current!==S&&(h.current=S,u(v))},[d]);return ee.useEffect(()=>{const v=f.current;return()=>{n.current&&(n.current.cleanup(v),n.current=null),r.current=!1}},[]),ee.useEffect(()=>{if(!(!e.mapExists(t.mapId)||r.current)){if(r.current=!0,n.current=e.getMap(t.mapId),!n.current){r.current=!1;return}t?.watch?.viewport&&(a(n.current.wrapper.viewportState),n.current.wrapper.on("viewportchange",()=>{s.current!==n.current?.wrapper.viewportStateString&&a(n.current?.wrapper.viewportState)},f.current)),t?.watch?.layers&&(b(),n.current.wrapper.on("layerchange",b,{includeBaseLayers:t?.filter?.includeBaseLayers,matchLayerIds:t?.filter?.matchLayerIds},f.current))}},[e.mapIds,e,t.mapId,b,t]),{layers:o,viewport:i}}YE.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}};function pa(t){const e=ee.useContext(sg),[r,n]=ee.useState({map:void 0,ready:!1}),i=YE({mapId:t?.mapId,watch:{viewport:!1,layers:!!t?.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),a=ee.useRef(null),s=ee.useRef(Ec()),o=()=>{a.current&&a.current.cleanup(s.current)};return ee.useEffect(()=>()=>{o(),a.current=null},[]),ee.useEffect(()=>{if(a.current&&a.current.cancelled===!0&&(a.current=null,n({map:void 0,ready:!1})),!(a.current||!e.mapExists(t?.mapId))){if(t?.waitForLayer){let u=!1;if(i?.layers?.forEach(h=>{h.id===t?.waitForLayer&&(u=!0)}),!u)return}a.current=e.getMap(t?.mapId),n({map:a.current,ready:!0})}},[e.mapIds,i.layers,e,t]),{map:r.map,mapIsReady:r.ready,componentId:s.current,layers:i.layers,cleanup:o}}function CP(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}function gle(t){return Z.jsx(OW,{...t,defaultTheme:UR,themeId:nf})}function mle(t){return function(r){return Z.jsx(gle,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function yle(){return NR}const ui=Joe;function _i(t){return Xoe(t)}function vle(t){return pi("MuiSvgIcon",t)}fi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _le=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${pn(e)}`,`fontSize${pn(r)}`]};return gi(i,vle,n)},ble=Br("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${pn(r.color)}`],e[`fontSize${pn(r.fontSize)}`]]}})(ui(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),AP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:s="inherit",component:o="svg",fontSize:u="medium",htmlColor:h,inheritViewBox:f=!1,titleAccess:d,viewBox:b="0 0 24 24",...v}=n,S=ee.isValidElement(i)&&i.type==="svg",E={...n,color:s,component:o,fontSize:u,instanceFontSize:e.fontSize,inheritViewBox:f,viewBox:b,hasSvgAsChild:S},P={};f||(P.viewBox=b);const k=_le(E);return Z.jsxs(ble,{as:o,className:An(k.root,a),focusable:"false",color:h,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:r,...P,...v,...S&&i.props,ownerState:E,children:[S?i.props.children:i,d?Z.jsx("title",{children:d}):null]})});AP.muiName="SvgIcon";function Yi(t,e){function r(n,i){return Z.jsx(AP,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=AP.muiName,ee.memo(ee.forwardRef(r))}function $R(t,e=166){let r;function n(...i){const a=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(a,e)}return n.clear=()=>{clearTimeout(r)},n}function is(t){return t&&t.ownerDocument||document}function lc(t){return is(t).defaultView||window}function VF(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function pm(t){const{controlled:e,default:r,name:n,state:i="value"}=t,{current:a}=ee.useRef(e!==void 0),[s,o]=ee.useState(r),u=a?e:s,h=ee.useCallback(f=>{a||o(f)},[]);return[u,h]}function tu(t){const e=ee.useRef(t);return vu(()=>{e.current=t}),ee.useRef((...r)=>(0,e.current)(...r)).current}function Bo(...t){const e=ee.useRef(void 0),r=ee.useCallback(n=>{const i=t.map(a=>{if(a==null)return null;if(typeof a=="function"){const s=a,o=s(n);return typeof o=="function"?o:()=>{s(null)}}return a.current=n,()=>{a.current=null}});return()=>{i.forEach(a=>a?.())}},t);return ee.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function xle(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function Y1(t,e){if(!t)return e;function r(s,o){const u={};return Object.keys(o).forEach(h=>{xle(h,o[h])&&typeof s[h]=="function"&&(u[h]=(...f)=>{s[h](...f),o[h](...f)})}),u}if(typeof t=="function"||typeof e=="function")return s=>{const o=typeof e=="function"?e(s):e,u=typeof t=="function"?t({...s,...o}):t,h=An(s?.className,o?.className,u?.className),f=r(u,o);return{...o,...u,...f,...!!h&&{className:h},...o?.style&&u?.style&&{style:{...o.style,...u.style}},...o?.sx&&u?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(u.sx)?u.sx:[u.sx]]}}};const n=e,i=r(t,n),a=An(n?.className,t?.className);return{...e,...t,...i,...!!a&&{className:a},...n?.style&&t?.style&&{style:{...n.style,...t.style}},...n?.sx&&t?.sx&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function oG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function IP(t,e){return IP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},IP(t,e)}function sG(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,IP(t,e)}const $F={disabled:!1},Ww=ht.createContext(null);var wle=function(e){return e.scrollTop},G_="unmounted",Bg="exited",zg="entering",Xy="entered",PP="exiting",Lh=(function(t){sG(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=i,o=s&&!s.isMounting?n.enter:n.appear,u;return a.appearStatus=null,n.in?o?(u=Bg,a.appearStatus=zg):u=Xy:n.unmountOnExit||n.mountOnEnter?u=G_:u=Bg,a.state={status:u},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var s=i.in;return s&&a.status===G_?{status:Bg}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==zg&&s!==Xy&&(a=zg):(s===zg||s===Xy)&&(a=PP)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,s,o;return a=s=o=i,i!=null&&typeof i!="number"&&(a=i.exit,s=i.enter,o=i.appear!==void 0?i.appear:s),{exit:a,enter:s,appear:o}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===zg){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:q_.findDOMNode(this);s&&wle(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bg&&this.setState({status:G_})},r.performEnter=function(i){var a=this,s=this.props.enter,o=this.context?this.context.isMounting:i,u=this.props.nodeRef?[o]:[q_.findDOMNode(this),o],h=u[0],f=u[1],d=this.getTimeouts(),b=o?d.appear:d.enter;if(!i&&!s||$F.disabled){this.safeSetState({status:Xy},function(){a.props.onEntered(h)});return}this.props.onEnter(h,f),this.safeSetState({status:zg},function(){a.props.onEntering(h,f),a.onTransitionEnd(b,function(){a.safeSetState({status:Xy},function(){a.props.onEntered(h,f)})})})},r.performExit=function(){var i=this,a=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:q_.findDOMNode(this);if(!a||$F.disabled){this.safeSetState({status:Bg},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:PP},function(){i.props.onExiting(o),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:Bg},function(){i.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,a.nextCallback=null,i(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(i,a){this.setNextCallback(a);var s=this.props.nodeRef?this.props.nodeRef.current:q_.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],h=u[0],f=u[1];this.props.addEndListener(h,f)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===G_)return null;var a=this.props,s=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var o=oG(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ht.createElement(Ww.Provider,{value:null},typeof s=="function"?s(i,o):ht.cloneElement(ht.Children.only(s),o))},e})(ht.Component);Lh.contextType=Ww;Lh.propTypes={};function Cy(){}Lh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Cy,onEntering:Cy,onEntered:Cy,onExit:Cy,onExiting:Cy,onExited:Cy};Lh.UNMOUNTED=G_;Lh.EXITED=Bg;Lh.ENTERING=zg;Lh.ENTERED=Xy;Lh.EXITING=PP;function Sle(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qR(t,e){var r=function(a){return e&&ee.isValidElement(a)?e(a):a},n=Object.create(null);return t&&ee.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function Ele(t,e){t=t||{},e=e||{};function r(f){return f in e?e[f]:t[f]}var n=Object.create(null),i=[];for(var a in t)a in e?i.length&&(n[a]=i,i=[]):i.push(a);var s,o={};for(var u in e){if(n[u])for(s=0;s<n[u].length;s++){var h=n[u][s];o[n[u][s]]=r(h)}o[u]=r(u)}for(s=0;s<i.length;s++)o[i[s]]=r(i[s]);return o}function Zg(t,e,r){return r[e]!=null?r[e]:t.props[e]}function Tle(t,e){return qR(t.children,function(r){return ee.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Zg(r,"appear",t),enter:Zg(r,"enter",t),exit:Zg(r,"exit",t)})})}function Cle(t,e,r){var n=qR(t.children),i=Ele(e,n);return Object.keys(i).forEach(function(a){var s=i[a];if(ee.isValidElement(s)){var o=a in e,u=a in n,h=e[a],f=ee.isValidElement(h)&&!h.props.in;u&&(!o||f)?i[a]=ee.cloneElement(s,{onExited:r.bind(null,s),in:!0,exit:Zg(s,"exit",t),enter:Zg(s,"enter",t)}):!u&&o&&!f?i[a]=ee.cloneElement(s,{in:!1}):u&&o&&ee.isValidElement(h)&&(i[a]=ee.cloneElement(s,{onExited:r.bind(null,s),in:h.props.in,exit:Zg(s,"exit",t),enter:Zg(s,"enter",t)}))}}),i}var Ale=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Ile={component:"div",childFactory:function(e){return e}},HR=(function(t){sG(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=a.handleExited.bind(Sle(a));return a.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},a}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var s=a.children,o=a.handleExited,u=a.firstRender;return{children:u?Tle(i,o):Cle(i,s,o),firstRender:!1}},r.handleExited=function(i,a){var s=qR(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(o){var u=Uw({},o.children);return delete u[i.key],{children:u}}))},r.render=function(){var i=this.props,a=i.component,s=i.childFactory,o=oG(i,["component","childFactory"]),u=this.state.contextValue,h=Ale(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,a===null?ht.createElement(Ww.Provider,{value:u},h):ht.createElement(Ww.Provider,{value:u},ht.createElement(a,o,h))},e})(ht.Component);HR.propTypes={};HR.defaultProps=Ile;const qF={};function lG(t,e){const r=ee.useRef(qF);return r.current===qF&&(r.current=t(e)),r}const Ple=[];function kle(t){ee.useEffect(t,Ple)}class ZE{static create(){return new ZE}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function Lp(){const t=lG(ZE.create).current;return kle(t.disposeEffect),t}const WR=t=>t.scrollTop;function Gd(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function Mle(t){return pi("MuiCollapse",t)}fi("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Rle=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return gi(n,Mle,r)},Ole=Br("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})(ui(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Nle=Br("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Lle=Br("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),kP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCollapse"}),{addEndListener:i,children:a,className:s,collapsedSize:o="0px",component:u,easing:h,in:f,onEnter:d,onEntered:b,onEntering:v,onExit:S,onExited:E,onExiting:P,orientation:k="vertical",style:L,timeout:N=JW.standard,TransitionComponent:M=Lh,...z}=n,B={...n,orientation:k,collapsedSize:o},q=Rle(B),W=kc(),G=Lp(),ie=ee.useRef(null),J=ee.useRef(),H=typeof o=="number"?`${o}px`:o,ne=k==="horizontal",ae=ne?"width":"height",ue=ee.useRef(null),de=Bo(r,ue),Pe=Re=>He=>{if(Re){const Fe=ue.current;He===void 0?Re(Fe):Re(Fe,He)}},me=()=>ie.current?ie.current[ne?"clientWidth":"clientHeight"]:0,Ee=Pe((Re,He)=>{ie.current&&ne&&(ie.current.style.position="absolute"),Re.style[ae]=H,d&&d(Re,He)}),we=Pe((Re,He)=>{const Fe=me();ie.current&&ne&&(ie.current.style.position="");const{duration:tt,easing:Ze}=Gd({style:L,timeout:N,easing:h},{mode:"enter"});if(N==="auto"){const Qe=W.transitions.getAutoHeightDuration(Fe);Re.style.transitionDuration=`${Qe}ms`,J.current=Qe}else Re.style.transitionDuration=typeof tt=="string"?tt:`${tt}ms`;Re.style[ae]=`${Fe}px`,Re.style.transitionTimingFunction=Ze,v&&v(Re,He)}),Ae=Pe((Re,He)=>{Re.style[ae]="auto",b&&b(Re,He)}),ce=Pe(Re=>{Re.style[ae]=`${me()}px`,S&&S(Re)}),xe=Pe(E),_e=Pe(Re=>{const He=me(),{duration:Fe,easing:tt}=Gd({style:L,timeout:N,easing:h},{mode:"exit"});if(N==="auto"){const Ze=W.transitions.getAutoHeightDuration(He);Re.style.transitionDuration=`${Ze}ms`,J.current=Ze}else Re.style.transitionDuration=typeof Fe=="string"?Fe:`${Fe}ms`;Re.style[ae]=H,Re.style.transitionTimingFunction=tt,P&&P(Re)}),Me=Re=>{N==="auto"&&G.start(J.current||0,Re),i&&i(ue.current,Re)};return Z.jsx(M,{in:f,onEnter:Ee,onEntered:Ae,onEntering:we,onExit:ce,onExited:xe,onExiting:_e,addEndListener:Me,nodeRef:ue,timeout:N==="auto"?null:N,...z,children:(Re,{ownerState:He,...Fe})=>Z.jsx(Ole,{as:u,className:An(q.root,s,{entered:q.entered,exited:!f&&H==="0px"&&q.hidden}[Re]),style:{[ne?"minWidth":"minHeight"]:H,...L},ref:de,ownerState:{...B,state:Re},...Fe,children:Z.jsx(Nle,{ownerState:{...B,state:Re},className:q.wrapper,ref:ie,children:Z.jsx(Lle,{ownerState:{...B,state:Re},className:q.wrapperInner,children:a})})})})});kP&&(kP.muiSupportAuto=!0);function Dle(t){return pi("MuiPaper",t)}fi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Fle=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,a={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return gi(a,Dle,i)},Ble=Br("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(ui(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Eh=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiPaper"}),i=kc(),{className:a,component:s="div",elevation:o=1,square:u=!1,variant:h="elevation",...f}=n,d={...n,component:s,elevation:o,square:u,variant:h},b=Fle(d);return Z.jsx(Ble,{as:s,ownerState:d,className:An(b.root,a),ref:r,...f,style:{...h==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[o],...i.vars&&{"--Paper-overlay":i.vars.overlays?.[o]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${qw("#fff",SP(o))}, ${qw("#fff",SP(o))})`}},...f.style}})}),uG=ee.createContext({});function Yf(t){return typeof t=="string"}function cG(t,e,r){return t===void 0||Yf(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function hG(t,e,r){return typeof t=="function"?t(e,r):t}function rm(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function HF(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function fG(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:a}=t;if(!e){const v=An(r?.className,a,i?.className,n?.className),S={...r?.style,...i?.style,...n?.style},E={...r,...i,...n};return v.length>0&&(E.className=v),Object.keys(S).length>0&&(E.style=S),{props:E,internalRef:void 0}}const s=rm({...i,...n}),o=HF(n),u=HF(i),h=e(s),f=An(h?.className,r?.className,a,i?.className,n?.className),d={...h?.style,...r?.style,...i?.style,...n?.style},b={...h,...r,...u,...o};return f.length>0&&(b.className=f),Object.keys(d).length>0&&(b.style=d),{props:b,internalRef:h.ref}}function Ei(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:s,shouldForwardComponentProp:o=!1,...u}=e,{component:h,slots:f={[t]:void 0},slotProps:d={[t]:void 0},...b}=a,v=f[t]||n,S=hG(d[t],i),{props:{component:E,...P},internalRef:k}=fG({className:r,...u,externalForwardedProps:t==="root"?b:void 0,externalSlotProps:S}),L=Bo(k,S?.ref,e.ref),N=t==="root"?E||h:E,M=cG(v,{...t==="root"&&!h&&!f[t]&&s,...t!=="root"&&!f[t]&&s,...P,...N&&!o&&{as:N},...N&&o&&{component:N},ref:L},i);return[v,M]}function zle(t){return pi("MuiAccordion",t)}const Ux=fi("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),jle=t=>{const{classes:e,square:r,expanded:n,disabled:i,disableGutters:a}=t;return gi({root:["root",!r&&"rounded",n&&"expanded",i&&"disabled",!a&&"gutters"],heading:["heading"],region:["region"]},zle,e)},Ule=Br(Eh,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Ux.region}`]:e.region},e.root,!r.square&&e.rounded,!r.disableGutters&&e.gutters]}})(ui(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${Ux.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${Ux.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),ui(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${Ux.expanded}`]:{margin:"16px 0"}}}]}))),Vle=Br("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),$le=Br("div",{name:"MuiAccordion",slot:"Region"})({}),qle=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAccordion"}),{children:i,className:a,defaultExpanded:s=!1,disabled:o=!1,disableGutters:u=!1,expanded:h,onChange:f,square:d=!1,slots:b={},slotProps:v={},TransitionComponent:S,TransitionProps:E,...P}=n,[k,L]=pm({controlled:h,default:s,name:"Accordion",state:"expanded"}),N=ee.useCallback(we=>{L(!k),f&&f(we,!k)},[k,f,L]),[M,...z]=ee.Children.toArray(i),B=ee.useMemo(()=>({expanded:k,disabled:o,disableGutters:u,toggle:N}),[k,o,u,N]),q={...n,square:d,disabled:o,disableGutters:u,expanded:k},W=jle(q),G={transition:S,...b},ie={transition:E,...v},J={slots:G,slotProps:ie},[H,ne]=Ei("root",{elementType:Ule,externalForwardedProps:{...J,...P},className:An(W.root,a),shouldForwardComponentProp:!0,ownerState:q,ref:r,additionalProps:{square:d}}),[ae,ue]=Ei("heading",{elementType:Vle,externalForwardedProps:J,className:W.heading,ownerState:q}),[de,Pe]=Ei("transition",{elementType:kP,externalForwardedProps:J,ownerState:q}),[me,Ee]=Ei("region",{elementType:$le,externalForwardedProps:J,ownerState:q,className:W.region,additionalProps:{"aria-labelledby":M.props.id,id:M.props["aria-controls"],role:"region"}});return Z.jsxs(H,{...ne,children:[Z.jsx(ae,{...ue,children:Z.jsx(uG.Provider,{value:B,children:M})}),Z.jsx(de,{in:k,timeout:"auto",...Pe,children:Z.jsx(me,{...Ee,children:z})})]})});function Yv(t){try{return t.matches(":focus-visible")}catch{}return!1}class Gw{static create(){return new Gw}static use(){const e=lG(Gw.create).current,[r,n]=ee.useState(!1);return e.shouldMount=r,e.setShouldMount=n,ee.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=Wle(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function Hle(){return Gw.use()}function Wle(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function Gle(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:a,rippleSize:s,in:o,onExited:u,timeout:h}=t,[f,d]=ee.useState(!1),b=An(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),v={width:s,height:s,top:-(s/2)+a,left:-(s/2)+i},S=An(r.child,f&&r.childLeaving,n&&r.childPulsate);return!o&&!f&&d(!0),ee.useEffect(()=>{if(!o&&u!=null){const E=setTimeout(u,h);return()=>{clearTimeout(E)}}},[u,o,h]),Z.jsx("span",{className:b,style:v,children:Z.jsx("span",{className:S})})}const dh=fi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),MP=550,Xle=80,Yle=Bb`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Zle=Bb`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Kle=Bb`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Jle=Br("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Qle=Br(Gle,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${dh.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Yle};
    animation-duration: ${MP}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${dh.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${dh.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${dh.childLeaving} {
    opacity: 0;
    animation-name: ${Zle};
    animation-duration: ${MP}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${dh.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Kle};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,eue=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:s,...o}=n,[u,h]=ee.useState([]),f=ee.useRef(0),d=ee.useRef(null);ee.useEffect(()=>{d.current&&(d.current(),d.current=null)},[u]);const b=ee.useRef(!1),v=Lp(),S=ee.useRef(null),E=ee.useRef(null),P=ee.useCallback(M=>{const{pulsate:z,rippleX:B,rippleY:q,rippleSize:W,cb:G}=M;h(ie=>[...ie,Z.jsx(Qle,{classes:{ripple:An(a.ripple,dh.ripple),rippleVisible:An(a.rippleVisible,dh.rippleVisible),ripplePulsate:An(a.ripplePulsate,dh.ripplePulsate),child:An(a.child,dh.child),childLeaving:An(a.childLeaving,dh.childLeaving),childPulsate:An(a.childPulsate,dh.childPulsate)},timeout:MP,pulsate:z,rippleX:B,rippleY:q,rippleSize:W},f.current)]),f.current+=1,d.current=G},[a]),k=ee.useCallback((M={},z={},B=()=>{})=>{const{pulsate:q=!1,center:W=i||z.pulsate,fakeElement:G=!1}=z;if(M?.type==="mousedown"&&b.current){b.current=!1;return}M?.type==="touchstart"&&(b.current=!0);const ie=G?null:E.current,J=ie?ie.getBoundingClientRect():{width:0,height:0,left:0,top:0};let H,ne,ae;if(W||M===void 0||M.clientX===0&&M.clientY===0||!M.clientX&&!M.touches)H=Math.round(J.width/2),ne=Math.round(J.height/2);else{const{clientX:ue,clientY:de}=M.touches&&M.touches.length>0?M.touches[0]:M;H=Math.round(ue-J.left),ne=Math.round(de-J.top)}if(W)ae=Math.sqrt((2*J.width**2+J.height**2)/3),ae%2===0&&(ae+=1);else{const ue=Math.max(Math.abs((ie?ie.clientWidth:0)-H),H)*2+2,de=Math.max(Math.abs((ie?ie.clientHeight:0)-ne),ne)*2+2;ae=Math.sqrt(ue**2+de**2)}M?.touches?S.current===null&&(S.current=()=>{P({pulsate:q,rippleX:H,rippleY:ne,rippleSize:ae,cb:B})},v.start(Xle,()=>{S.current&&(S.current(),S.current=null)})):P({pulsate:q,rippleX:H,rippleY:ne,rippleSize:ae,cb:B})},[i,P,v]),L=ee.useCallback(()=>{k({},{pulsate:!0})},[k]),N=ee.useCallback((M,z)=>{if(v.clear(),M?.type==="touchend"&&S.current){S.current(),S.current=null,v.start(0,()=>{N(M,z)});return}S.current=null,h(B=>B.length>0?B.slice(1):B),d.current=z},[v]);return ee.useImperativeHandle(r,()=>({pulsate:L,start:k,stop:N}),[L,k,N]),Z.jsx(Jle,{className:An(dh.root,a.root,s),ref:E,...o,children:Z.jsx(HR,{component:null,exit:!0,children:u})})});function tue(t){return pi("MuiButtonBase",t)}const rue=fi("MuiButtonBase",["root","disabled","focusVisible"]),nue=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,s=gi({root:["root",e&&"disabled",r&&"focusVisible"]},tue,i);return r&&n&&(s.root+=` ${n}`),s},iue=Br("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${rue.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),I0=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:s,className:o,component:u="button",disabled:h=!1,disableRipple:f=!1,disableTouchRipple:d=!1,focusRipple:b=!1,focusVisibleClassName:v,LinkComponent:S="a",onBlur:E,onClick:P,onContextMenu:k,onDragLeave:L,onFocus:N,onFocusVisible:M,onKeyDown:z,onKeyUp:B,onMouseDown:q,onMouseLeave:W,onMouseUp:G,onTouchEnd:ie,onTouchMove:J,onTouchStart:H,tabIndex:ne=0,TouchRippleProps:ae,touchRippleRef:ue,type:de,...Pe}=n,me=ee.useRef(null),Ee=Hle(),we=Bo(Ee.ref,ue),[Ae,ce]=ee.useState(!1);h&&Ae&&ce(!1),ee.useImperativeHandle(i,()=>({focusVisible:()=>{ce(!0),me.current.focus()}}),[]);const xe=Ee.shouldMount&&!f&&!h;ee.useEffect(()=>{Ae&&b&&!f&&Ee.pulsate()},[f,b,Ae,Ee]);const _e=Ed(Ee,"start",q,d),Me=Ed(Ee,"stop",k,d),Re=Ed(Ee,"stop",L,d),He=Ed(Ee,"stop",G,d),Fe=Ed(Ee,"stop",mr=>{Ae&&mr.preventDefault(),W&&W(mr)},d),tt=Ed(Ee,"start",H,d),Ze=Ed(Ee,"stop",ie,d),Qe=Ed(Ee,"stop",J,d),Ie=Ed(Ee,"stop",mr=>{Yv(mr.target)||ce(!1),E&&E(mr)},!1),Lt=tu(mr=>{me.current||(me.current=mr.currentTarget),Yv(mr.target)&&(ce(!0),M&&M(mr)),N&&N(mr)}),at=()=>{const mr=me.current;return u&&u!=="button"&&!(mr.tagName==="A"&&mr.href)},Ve=tu(mr=>{b&&!mr.repeat&&Ae&&mr.key===" "&&Ee.stop(mr,()=>{Ee.start(mr)}),mr.target===mr.currentTarget&&at()&&mr.key===" "&&mr.preventDefault(),z&&z(mr),mr.target===mr.currentTarget&&at()&&mr.key==="Enter"&&!h&&(mr.preventDefault(),P&&P(mr))}),nr=tu(mr=>{b&&mr.key===" "&&Ae&&!mr.defaultPrevented&&Ee.stop(mr,()=>{Ee.pulsate(mr)}),B&&B(mr),P&&mr.target===mr.currentTarget&&at()&&mr.key===" "&&!mr.defaultPrevented&&P(mr)});let Yt=u;Yt==="button"&&(Pe.href||Pe.to)&&(Yt=S);const yr={};Yt==="button"?(yr.type=de===void 0?"button":de,yr.disabled=h):(!Pe.href&&!Pe.to&&(yr.role="button"),h&&(yr["aria-disabled"]=h));const mt=Bo(r,me),br={...n,centerRipple:a,component:u,disabled:h,disableRipple:f,disableTouchRipple:d,focusRipple:b,tabIndex:ne,focusVisible:Ae},Tr=nue(br);return Z.jsxs(iue,{as:Yt,className:An(Tr.root,o),ownerState:br,onBlur:Ie,onClick:P,onContextMenu:Me,onFocus:Lt,onKeyDown:Ve,onKeyUp:nr,onMouseDown:_e,onMouseLeave:Fe,onMouseUp:He,onDragLeave:Re,onTouchEnd:Ze,onTouchMove:Qe,onTouchStart:tt,ref:mt,tabIndex:h?-1:ne,type:de,...yr,...Pe,children:[s,xe?Z.jsx(eue,{ref:we,center:a,...ae}):null]})});function Ed(t,e,r,n=!1){return tu(i=>(r&&r(i),n||t[e](i),!0))}function aue(t){return pi("MuiAccordionSummary",t)}const yv=fi("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),oue=t=>{const{classes:e,expanded:r,disabled:n,disableGutters:i}=t;return gi({root:["root",r&&"expanded",n&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},aue,e)},sue=Br(I0,{name:"MuiAccordionSummary",slot:"Root"})(ui(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${yv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${yv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${yv.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${yv.expanded}`]:{minHeight:64}}}]}})),lue=Br("span",{name:"MuiAccordionSummary",slot:"Content"})(ui(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${yv.expanded}`]:{margin:"20px 0"}}}]}))),uue=Br("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(ui(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${yv.expanded}`]:{transform:"rotate(180deg)"}}))),cue=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAccordionSummary"}),{children:i,className:a,expandIcon:s,focusVisibleClassName:o,onClick:u,slots:h,slotProps:f,...d}=n,{disabled:b=!1,disableGutters:v,expanded:S,toggle:E}=ee.useContext(uG),P=ie=>{E&&E(ie),u&&u(ie)},k={...n,expanded:S,disabled:b,disableGutters:v},L=oue(k),N={slots:h,slotProps:f},[M,z]=Ei("root",{ref:r,shouldForwardComponentProp:!0,className:An(L.root,a),elementType:sue,externalForwardedProps:{...N,...d},ownerState:k,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:b,"aria-expanded":S,focusVisibleClassName:An(L.focusVisible,o)},getSlotProps:ie=>({...ie,onClick:J=>{ie.onClick?.(J),P(J)}})}),[B,q]=Ei("content",{className:L.content,elementType:lue,externalForwardedProps:N,ownerState:k}),[W,G]=Ei("expandIconWrapper",{className:L.expandIconWrapper,elementType:uue,externalForwardedProps:N,ownerState:k});return Z.jsxs(M,{...z,children:[Z.jsx(B,{...q,children:i}),s&&Z.jsx(W,{...G,children:s})]})});function hue(t){return typeof t.main=="string"}function fue(t,e=[]){if(!hue(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function Bl(t=[]){return([,e])=>e&&fue(e,t)}function due(t){return pi("MuiCircularProgress",t)}fi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const bp=44,RP=Bb`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,OP=Bb`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,pue=typeof RP!="string"?PR`
        animation: ${RP} 1.4s linear infinite;
      `:null,gue=typeof OP!="string"?PR`
        animation: ${OP} 1.4s ease-in-out infinite;
      `:null,mue=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,a={root:["root",r,`color${pn(n)}`],svg:["svg"],circle:["circle",`circle${pn(r)}`,i&&"circleDisableShrink"]};return gi(a,due,e)},yue=Br("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${pn(r.color)}`]]}})(ui(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:pue||{animation:`${RP} 1.4s linear infinite`}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),vue=Br("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),_ue=Br("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${pn(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(ui(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:gue||{animation:`${OP} 1.4s ease-in-out infinite`}}]}))),KE=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:s=!1,size:o=40,style:u,thickness:h=3.6,value:f=0,variant:d="indeterminate",...b}=n,v={...n,color:a,disableShrink:s,size:o,thickness:h,value:f,variant:d},S=mue(v),E={},P={},k={};if(d==="determinate"){const L=2*Math.PI*((bp-h)/2);E.strokeDasharray=L.toFixed(3),k["aria-valuenow"]=Math.round(f),E.strokeDashoffset=`${((100-f)/100*L).toFixed(3)}px`,P.transform="rotate(-90deg)"}return Z.jsx(yue,{className:An(S.root,i),style:{width:o,height:o,...P,...u},ownerState:v,ref:r,role:"progressbar",...k,...b,children:Z.jsx(vue,{className:S.svg,ownerState:v,viewBox:`${bp/2} ${bp/2} ${bp} ${bp}`,children:Z.jsx(_ue,{className:S.circle,style:E,ownerState:v,cx:bp,cy:bp,r:(bp-h)/2,fill:"none",strokeWidth:h})})})});function bue(t){return pi("MuiIconButton",t)}const WF=fi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),xue=t=>{const{classes:e,disabled:r,color:n,edge:i,size:a,loading:s}=t,o={root:["root",s&&"loading",r&&"disabled",n!=="default"&&`color${pn(n)}`,i&&`edge${pn(i)}`,`size${pn(a)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return gi(o,bue,e)},wue=Br(I0,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${pn(r.color)}`],r.edge&&e[`edge${pn(r.edge)}`],e[`size${pn(r.size)}`]]}})(ui(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ui(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${WF.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${WF.loading}`]:{color:"transparent"}}))),Sue=Br("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),th=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:s,color:o="default",disabled:u=!1,disableFocusRipple:h=!1,size:f="medium",id:d,loading:b=null,loadingIndicator:v,...S}=n,E=og(d),P=v??Z.jsx(KE,{"aria-labelledby":E,color:"inherit",size:16}),k={...n,edge:i,color:o,disabled:u,disableFocusRipple:h,loading:b,loadingIndicator:P,size:f},L=xue(k);return Z.jsxs(wue,{id:b?E:d,className:An(L.root,s),centerRipple:!0,focusRipple:!h,disabled:u||b,ref:r,...S,ownerState:k,children:[typeof b=="boolean"&&Z.jsx("span",{className:L.loadingWrapper,style:{display:"contents"},children:Z.jsx(Sue,{className:L.loadingIndicator,ownerState:k,children:b&&P})}),a]})});function Eue(t){return pi("MuiTypography",t)}const GF=fi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),Tue={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Cue=yle(),Aue=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:s}=t,o={root:["root",a,t.align!=="inherit"&&`align${pn(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return gi(o,Eue,s)},Iue=Br("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${pn(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(ui(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${pn(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),XF={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},bs=ee.forwardRef(function(e,r){const{color:n,...i}=_i({props:e,name:"MuiTypography"}),a=!Tue[n],s=Cue({...i,...a&&{color:n}}),{align:o="inherit",className:u,component:h,gutterBottom:f=!1,noWrap:d=!1,paragraph:b=!1,variant:v="body1",variantMapping:S=XF,...E}=s,P={...s,align:o,color:n,className:u,component:h,gutterBottom:f,noWrap:d,paragraph:b,variant:v,variantMapping:S},k=h||(b?"p":S[v]||XF[v])||"span",L=Aue(P);return Z.jsx(Iue,{as:k,ref:r,className:An(L.root,u),...E,ownerState:P,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...E.style}})});function Pue(t){return pi("MuiAppBar",t)}fi("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const kue=t=>{const{color:e,position:r,classes:n}=t,i={root:["root",`color${pn(e)}`,`position${pn(r)}`]};return gi(i,Pue,n)},YF=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,Mue=Br(Eh,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${pn(r.position)}`],e[`color${pn(r.color)}`]]}})(ui(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(Bl(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?YF(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?YF(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),Rue=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAppBar"}),{className:i,color:a="primary",enableColorOnDark:s=!1,position:o="fixed",...u}=n,h={...n,color:a,position:o,enableColorOnDark:s},f=kue(h);return Z.jsx(Mue,{square:!0,component:"header",ownerState:h,elevation:4,className:An(f.root,i,o==="fixed"&&"mui-fixed"),ref:r,...u})});var Tc="top",Th="bottom",Ch="right",Cc="left",GR="auto",qb=[Tc,Th,Ch,Cc],Zv="start",Z1="end",Oue="clippingParents",dG="viewport",g_="popper",Nue="reference",ZF=qb.reduce(function(t,e){return t.concat([e+"-"+Zv,e+"-"+Z1])},[]),pG=[].concat(qb,[GR]).reduce(function(t,e){return t.concat([e,e+"-"+Zv,e+"-"+Z1])},[]),Lue="beforeRead",Due="read",Fue="afterRead",Bue="beforeMain",zue="main",jue="afterMain",Uue="beforeWrite",Vue="write",$ue="afterWrite",que=[Lue,Due,Fue,Bue,zue,jue,Uue,Vue,$ue];function ed(t){return t?(t.nodeName||"").toLowerCase():null}function rh(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function gm(t){var e=rh(t).Element;return t instanceof e||t instanceof Element}function vh(t){var e=rh(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function XR(t){if(typeof ShadowRoot>"u")return!1;var e=rh(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Hue(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!vh(a)||!ed(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function Wue(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(u,h){return u[h]="",u},{});!vh(i)||!ed(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(u){i.removeAttribute(u)}))})}}const Gue={name:"applyStyles",enabled:!0,phase:"write",fn:Hue,effect:Wue,requires:["computeStyles"]};function Zf(t){return t.split("-")[0]}var nm=Math.max,Xw=Math.min,Kv=Math.round;function NP(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function gG(){return!/^((?!chrome|android).)*safari/i.test(NP())}function Jv(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&vh(t)&&(i=t.offsetWidth>0&&Kv(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Kv(n.height)/t.offsetHeight||1);var s=gm(t)?rh(t):window,o=s.visualViewport,u=!gG()&&r,h=(n.left+(u&&o?o.offsetLeft:0))/i,f=(n.top+(u&&o?o.offsetTop:0))/a,d=n.width/i,b=n.height/a;return{width:d,height:b,top:f,right:h+d,bottom:f+b,left:h,x:h,y:f}}function YR(t){var e=Jv(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function mG(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&XR(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Xd(t){return rh(t).getComputedStyle(t)}function Xue(t){return["table","td","th"].indexOf(ed(t))>=0}function lg(t){return((gm(t)?t.ownerDocument:t.document)||window.document).documentElement}function JE(t){return ed(t)==="html"?t:t.assignedSlot||t.parentNode||(XR(t)?t.host:null)||lg(t)}function KF(t){return!vh(t)||Xd(t).position==="fixed"?null:t.offsetParent}function Yue(t){var e=/firefox/i.test(NP()),r=/Trident/i.test(NP());if(r&&vh(t)){var n=Xd(t);if(n.position==="fixed")return null}var i=JE(t);for(XR(i)&&(i=i.host);vh(i)&&["html","body"].indexOf(ed(i))<0;){var a=Xd(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Hb(t){for(var e=rh(t),r=KF(t);r&&Xue(r)&&Xd(r).position==="static";)r=KF(r);return r&&(ed(r)==="html"||ed(r)==="body"&&Xd(r).position==="static")?e:r||Yue(t)||e}function ZR(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function b1(t,e,r){return nm(t,Xw(e,r))}function Zue(t,e,r){var n=b1(t,e,r);return n>r?r:n}function yG(){return{top:0,right:0,bottom:0,left:0}}function vG(t){return Object.assign({},yG(),t)}function _G(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var Kue=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,vG(typeof e!="number"?e:_G(e,qb))};function Jue(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=Zf(r.placement),u=ZR(o),h=[Cc,Ch].indexOf(o)>=0,f=h?"height":"width";if(!(!a||!s)){var d=Kue(i.padding,r),b=YR(a),v=u==="y"?Tc:Cc,S=u==="y"?Th:Ch,E=r.rects.reference[f]+r.rects.reference[u]-s[u]-r.rects.popper[f],P=s[u]-r.rects.reference[u],k=Hb(a),L=k?u==="y"?k.clientHeight||0:k.clientWidth||0:0,N=E/2-P/2,M=d[v],z=L-b[f]-d[S],B=L/2-b[f]/2+N,q=b1(M,B,z),W=u;r.modifiersData[n]=(e={},e[W]=q,e.centerOffset=q-B,e)}}function Que(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||mG(e.elements.popper,i)&&(e.elements.arrow=i))}const ece={name:"arrow",enabled:!0,phase:"main",fn:Jue,effect:Que,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Qv(t){return t.split("-")[1]}var tce={top:"auto",right:"auto",bottom:"auto",left:"auto"};function rce(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:Kv(r*i)/i||0,y:Kv(n*i)/i||0}}function JF(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,u=t.gpuAcceleration,h=t.adaptive,f=t.roundOffsets,d=t.isFixed,b=s.x,v=b===void 0?0:b,S=s.y,E=S===void 0?0:S,P=typeof f=="function"?f({x:v,y:E}):{x:v,y:E};v=P.x,E=P.y;var k=s.hasOwnProperty("x"),L=s.hasOwnProperty("y"),N=Cc,M=Tc,z=window;if(h){var B=Hb(r),q="clientHeight",W="clientWidth";if(B===rh(r)&&(B=lg(r),Xd(B).position!=="static"&&o==="absolute"&&(q="scrollHeight",W="scrollWidth")),B=B,i===Tc||(i===Cc||i===Ch)&&a===Z1){M=Th;var G=d&&B===z&&z.visualViewport?z.visualViewport.height:B[q];E-=G-n.height,E*=u?1:-1}if(i===Cc||(i===Tc||i===Th)&&a===Z1){N=Ch;var ie=d&&B===z&&z.visualViewport?z.visualViewport.width:B[W];v-=ie-n.width,v*=u?1:-1}}var J=Object.assign({position:o},h&&tce),H=f===!0?rce({x:v,y:E},rh(r)):{x:v,y:E};if(v=H.x,E=H.y,u){var ne;return Object.assign({},J,(ne={},ne[M]=L?"0":"",ne[N]=k?"0":"",ne.transform=(z.devicePixelRatio||1)<=1?"translate("+v+"px, "+E+"px)":"translate3d("+v+"px, "+E+"px, 0)",ne))}return Object.assign({},J,(e={},e[M]=L?E+"px":"",e[N]=k?v+"px":"",e.transform="",e))}function nce(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,u=o===void 0?!0:o,h={placement:Zf(e.placement),variation:Qv(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,JF(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,JF(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ice={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:nce,data:{}};var Vx={passive:!0};function ace(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,u=rh(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(f){f.addEventListener("scroll",r.update,Vx)}),o&&u.addEventListener("resize",r.update,Vx),function(){a&&h.forEach(function(f){f.removeEventListener("scroll",r.update,Vx)}),o&&u.removeEventListener("resize",r.update,Vx)}}const oce={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:ace,data:{}};var sce={left:"right",right:"left",bottom:"top",top:"bottom"};function cw(t){return t.replace(/left|right|bottom|top/g,function(e){return sce[e]})}var lce={start:"end",end:"start"};function QF(t){return t.replace(/start|end/g,function(e){return lce[e]})}function KR(t){var e=rh(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function JR(t){return Jv(lg(t)).left+KR(t).scrollLeft}function uce(t,e){var r=rh(t),n=lg(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,u=0;if(i){a=i.width,s=i.height;var h=gG();(h||!h&&e==="fixed")&&(o=i.offsetLeft,u=i.offsetTop)}return{width:a,height:s,x:o+JR(t),y:u}}function cce(t){var e,r=lg(t),n=KR(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=nm(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=nm(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+JR(t),u=-n.scrollTop;return Xd(i||r).direction==="rtl"&&(o+=nm(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:u}}function QR(t){var e=Xd(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function bG(t){return["html","body","#document"].indexOf(ed(t))>=0?t.ownerDocument.body:vh(t)&&QR(t)?t:bG(JE(t))}function x1(t,e){var r;e===void 0&&(e=[]);var n=bG(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=rh(n),s=i?[a].concat(a.visualViewport||[],QR(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(x1(JE(s)))}function LP(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function hce(t,e){var r=Jv(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function e8(t,e,r){return e===dG?LP(uce(t,r)):gm(e)?hce(e,r):LP(cce(lg(t)))}function fce(t){var e=x1(JE(t)),r=["absolute","fixed"].indexOf(Xd(t).position)>=0,n=r&&vh(t)?Hb(t):t;return gm(n)?e.filter(function(i){return gm(i)&&mG(i,n)&&ed(i)!=="body"}):[]}function dce(t,e,r,n){var i=e==="clippingParents"?fce(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(u,h){var f=e8(t,h,n);return u.top=nm(f.top,u.top),u.right=Xw(f.right,u.right),u.bottom=Xw(f.bottom,u.bottom),u.left=nm(f.left,u.left),u},e8(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function xG(t){var e=t.reference,r=t.element,n=t.placement,i=n?Zf(n):null,a=n?Qv(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,u;switch(i){case Tc:u={x:s,y:e.y-r.height};break;case Th:u={x:s,y:e.y+e.height};break;case Ch:u={x:e.x+e.width,y:o};break;case Cc:u={x:e.x-r.width,y:o};break;default:u={x:e.x,y:e.y}}var h=i?ZR(i):null;if(h!=null){var f=h==="y"?"height":"width";switch(a){case Zv:u[h]=u[h]-(e[f]/2-r[f]/2);break;case Z1:u[h]=u[h]+(e[f]/2-r[f]/2);break}}return u}function K1(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,u=o===void 0?Oue:o,h=r.rootBoundary,f=h===void 0?dG:h,d=r.elementContext,b=d===void 0?g_:d,v=r.altBoundary,S=v===void 0?!1:v,E=r.padding,P=E===void 0?0:E,k=vG(typeof P!="number"?P:_G(P,qb)),L=b===g_?Nue:g_,N=t.rects.popper,M=t.elements[S?L:b],z=dce(gm(M)?M:M.contextElement||lg(t.elements.popper),u,f,s),B=Jv(t.elements.reference),q=xG({reference:B,element:N,placement:i}),W=LP(Object.assign({},N,q)),G=b===g_?W:B,ie={top:z.top-G.top+k.top,bottom:G.bottom-z.bottom+k.bottom,left:z.left-G.left+k.left,right:G.right-z.right+k.right},J=t.modifiersData.offset;if(b===g_&&J){var H=J[i];Object.keys(ie).forEach(function(ne){var ae=[Ch,Th].indexOf(ne)>=0?1:-1,ue=[Tc,Th].indexOf(ne)>=0?"y":"x";ie[ne]+=H[ue]*ae})}return ie}function pce(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,u=r.allowedAutoPlacements,h=u===void 0?pG:u,f=Qv(n),d=f?o?ZF:ZF.filter(function(S){return Qv(S)===f}):qb,b=d.filter(function(S){return h.indexOf(S)>=0});b.length===0&&(b=d);var v=b.reduce(function(S,E){return S[E]=K1(t,{placement:E,boundary:i,rootBoundary:a,padding:s})[Zf(E)],S},{});return Object.keys(v).sort(function(S,E){return v[S]-v[E]})}function gce(t){if(Zf(t)===GR)return[];var e=cw(t);return[QF(t),e,QF(e)]}function mce(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,u=r.fallbackPlacements,h=r.padding,f=r.boundary,d=r.rootBoundary,b=r.altBoundary,v=r.flipVariations,S=v===void 0?!0:v,E=r.allowedAutoPlacements,P=e.options.placement,k=Zf(P),L=k===P,N=u||(L||!S?[cw(P)]:gce(P)),M=[P].concat(N).reduce(function(_e,Me){return _e.concat(Zf(Me)===GR?pce(e,{placement:Me,boundary:f,rootBoundary:d,padding:h,flipVariations:S,allowedAutoPlacements:E}):Me)},[]),z=e.rects.reference,B=e.rects.popper,q=new Map,W=!0,G=M[0],ie=0;ie<M.length;ie++){var J=M[ie],H=Zf(J),ne=Qv(J)===Zv,ae=[Tc,Th].indexOf(H)>=0,ue=ae?"width":"height",de=K1(e,{placement:J,boundary:f,rootBoundary:d,altBoundary:b,padding:h}),Pe=ae?ne?Ch:Cc:ne?Th:Tc;z[ue]>B[ue]&&(Pe=cw(Pe));var me=cw(Pe),Ee=[];if(a&&Ee.push(de[H]<=0),o&&Ee.push(de[Pe]<=0,de[me]<=0),Ee.every(function(_e){return _e})){G=J,W=!1;break}q.set(J,Ee)}if(W)for(var we=S?3:1,Ae=function(Me){var Re=M.find(function(He){var Fe=q.get(He);if(Fe)return Fe.slice(0,Me).every(function(tt){return tt})});if(Re)return G=Re,"break"},ce=we;ce>0;ce--){var xe=Ae(ce);if(xe==="break")break}e.placement!==G&&(e.modifiersData[n]._skip=!0,e.placement=G,e.reset=!0)}}const yce={name:"flip",enabled:!0,phase:"main",fn:mce,requiresIfExists:["offset"],data:{_skip:!1}};function t8(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function r8(t){return[Tc,Ch,Th,Cc].some(function(e){return t[e]>=0})}function vce(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=K1(e,{elementContext:"reference"}),o=K1(e,{altBoundary:!0}),u=t8(s,n),h=t8(o,i,a),f=r8(u),d=r8(h);e.modifiersData[r]={referenceClippingOffsets:u,popperEscapeOffsets:h,isReferenceHidden:f,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":d})}const _ce={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:vce};function bce(t,e,r){var n=Zf(t),i=[Cc,Tc].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Cc,Ch].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function xce(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=pG.reduce(function(f,d){return f[d]=bce(d,e.rects,a),f},{}),o=s[e.placement],u=o.x,h=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=h),e.modifiersData[n]=s}const wce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xce};function Sce(t){var e=t.state,r=t.name;e.modifiersData[r]=xG({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Ece={name:"popperOffsets",enabled:!0,phase:"read",fn:Sce,data:{}};function Tce(t){return t==="x"?"y":"x"}function Cce(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,u=r.boundary,h=r.rootBoundary,f=r.altBoundary,d=r.padding,b=r.tether,v=b===void 0?!0:b,S=r.tetherOffset,E=S===void 0?0:S,P=K1(e,{boundary:u,rootBoundary:h,padding:d,altBoundary:f}),k=Zf(e.placement),L=Qv(e.placement),N=!L,M=ZR(k),z=Tce(M),B=e.modifiersData.popperOffsets,q=e.rects.reference,W=e.rects.popper,G=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,ie=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),J=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,H={x:0,y:0};if(B){if(a){var ne,ae=M==="y"?Tc:Cc,ue=M==="y"?Th:Ch,de=M==="y"?"height":"width",Pe=B[M],me=Pe+P[ae],Ee=Pe-P[ue],we=v?-W[de]/2:0,Ae=L===Zv?q[de]:W[de],ce=L===Zv?-W[de]:-q[de],xe=e.elements.arrow,_e=v&&xe?YR(xe):{width:0,height:0},Me=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:yG(),Re=Me[ae],He=Me[ue],Fe=b1(0,q[de],_e[de]),tt=N?q[de]/2-we-Fe-Re-ie.mainAxis:Ae-Fe-Re-ie.mainAxis,Ze=N?-q[de]/2+we+Fe+He+ie.mainAxis:ce+Fe+He+ie.mainAxis,Qe=e.elements.arrow&&Hb(e.elements.arrow),Ie=Qe?M==="y"?Qe.clientTop||0:Qe.clientLeft||0:0,Lt=(ne=J?.[M])!=null?ne:0,at=Pe+tt-Lt-Ie,Ve=Pe+Ze-Lt,nr=b1(v?Xw(me,at):me,Pe,v?nm(Ee,Ve):Ee);B[M]=nr,H[M]=nr-Pe}if(o){var Yt,yr=M==="x"?Tc:Cc,mt=M==="x"?Th:Ch,br=B[z],Tr=z==="y"?"height":"width",mr=br+P[yr],Mr=br-P[mt],Pr=[Tc,Cc].indexOf(k)!==-1,ar=(Yt=J?.[z])!=null?Yt:0,fr=Pr?mr:br-q[Tr]-W[Tr]-ar+ie.altAxis,Nr=Pr?br+q[Tr]+W[Tr]-ar-ie.altAxis:Mr,or=v&&Pr?Zue(fr,br,Nr):b1(v?fr:mr,br,v?Nr:Mr);B[z]=or,H[z]=or-br}e.modifiersData[n]=H}}const Ace={name:"preventOverflow",enabled:!0,phase:"main",fn:Cce,requiresIfExists:["offset"]};function Ice(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Pce(t){return t===rh(t)||!vh(t)?KR(t):Ice(t)}function kce(t){var e=t.getBoundingClientRect(),r=Kv(e.width)/t.offsetWidth||1,n=Kv(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Mce(t,e,r){r===void 0&&(r=!1);var n=vh(e),i=vh(e)&&kce(e),a=lg(e),s=Jv(t,i,r),o={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!r)&&((ed(e)!=="body"||QR(a))&&(o=Pce(e)),vh(e)?(u=Jv(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):a&&(u.x=JR(a))),{x:s.left+o.scrollLeft-u.x,y:s.top+o.scrollTop-u.y,width:s.width,height:s.height}}function Rce(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var u=e.get(o);u&&i(u)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Oce(t){var e=Rce(t);return que.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Nce(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Lce(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var n8={placement:"bottom",modifiers:[],strategy:"absolute"};function i8(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Dce(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?n8:i;return function(o,u,h){h===void 0&&(h=a);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},n8,a),modifiersData:{},elements:{reference:o,popper:u},attributes:{},styles:{}},d=[],b=!1,v={state:f,setOptions:function(k){var L=typeof k=="function"?k(f.options):k;E(),f.options=Object.assign({},a,f.options,L),f.scrollParents={reference:gm(o)?x1(o):o.contextElement?x1(o.contextElement):[],popper:x1(u)};var N=Oce(Lce([].concat(n,f.options.modifiers)));return f.orderedModifiers=N.filter(function(M){return M.enabled}),S(),v.update()},forceUpdate:function(){if(!b){var k=f.elements,L=k.reference,N=k.popper;if(i8(L,N)){f.rects={reference:Mce(L,Hb(N),f.options.strategy==="fixed"),popper:YR(N)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(ie){return f.modifiersData[ie.name]=Object.assign({},ie.data)});for(var M=0;M<f.orderedModifiers.length;M++){if(f.reset===!0){f.reset=!1,M=-1;continue}var z=f.orderedModifiers[M],B=z.fn,q=z.options,W=q===void 0?{}:q,G=z.name;typeof B=="function"&&(f=B({state:f,options:W,name:G,instance:v})||f)}}}},update:Nce(function(){return new Promise(function(P){v.forceUpdate(),P(f)})}),destroy:function(){E(),b=!0}};if(!i8(o,u))return v;v.setOptions(h).then(function(P){!b&&h.onFirstUpdate&&h.onFirstUpdate(P)});function S(){f.orderedModifiers.forEach(function(P){var k=P.name,L=P.options,N=L===void 0?{}:L,M=P.effect;if(typeof M=="function"){var z=M({state:f,name:k,instance:v,options:N}),B=function(){};d.push(z||B)}})}function E(){d.forEach(function(P){return P()}),d=[]}return v}}var Fce=[oce,Ece,ice,Gue,wce,yce,Ace,ece,_ce],Bce=Dce({defaultModifiers:Fce});function Bf(t){const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...a}=t,s=i?{}:hG(r,n),{props:o,internalRef:u}=fG({...a,externalSlotProps:s}),h=Bo(u,s?.ref,t.additionalProps?.ref);return cG(e,{...o,ref:h},n)}function ug(t){return parseInt(ee.version,10)>=19?t?.props?.ref||null:t?.ref||null}function zce(t){return typeof t=="function"?t():t}const wG=ee.forwardRef(function(e,r){const{children:n,container:i,disablePortal:a=!1}=e,[s,o]=ee.useState(null),u=Bo(ee.isValidElement(n)?ug(n):null,r);if(vu(()=>{a||o(zce(i)||document.body)},[i,a]),vu(()=>{if(s&&!a)return VF(r,s),()=>{VF(r,null)}},[r,s,a]),a){if(ee.isValidElement(n)){const h={ref:u};return ee.cloneElement(n,h)}return n}return s&&Fd.createPortal(n,s)});function jce(t){return pi("MuiPopper",t)}fi("MuiPopper",["root"]);function Uce(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function DP(t){return typeof t=="function"?t():t}function Vce(t){return t.nodeType!==void 0}const $ce=t=>{const{classes:e}=t;return gi({root:["root"]},jce,e)},qce={},Hce=ee.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:a,disablePortal:s,modifiers:o,open:u,placement:h,popperOptions:f,popperRef:d,slotProps:b={},slots:v={},TransitionProps:S,ownerState:E,...P}=e,k=ee.useRef(null),L=Bo(k,r),N=ee.useRef(null),M=Bo(N,d),z=ee.useRef(M);vu(()=>{z.current=M},[M]),ee.useImperativeHandle(d,()=>N.current,[]);const B=Uce(h,a),[q,W]=ee.useState(B),[G,ie]=ee.useState(DP(n));ee.useEffect(()=>{N.current&&N.current.forceUpdate()}),ee.useEffect(()=>{n&&ie(DP(n))},[n]),vu(()=>{if(!G||!u)return;const ue=me=>{W(me.placement)};let de=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:me})=>{ue(me)}}];o!=null&&(de=de.concat(o)),f&&f.modifiers!=null&&(de=de.concat(f.modifiers));const Pe=Bce(G,k.current,{placement:B,...f,modifiers:de});return z.current(Pe),()=>{Pe.destroy(),z.current(null)}},[G,s,o,u,f,B]);const J={placement:q};S!==null&&(J.TransitionProps=S);const H=$ce(e),ne=v.root??"div",ae=Bf({elementType:ne,externalSlotProps:b.root,externalForwardedProps:P,additionalProps:{role:"tooltip",ref:L},ownerState:e,className:H.root});return Z.jsx(ne,{...ae,children:typeof i=="function"?i(J):i})}),Wce=ee.forwardRef(function(e,r){const{anchorEl:n,children:i,container:a,direction:s="ltr",disablePortal:o=!1,keepMounted:u=!1,modifiers:h,open:f,placement:d="bottom",popperOptions:b=qce,popperRef:v,style:S,transition:E=!1,slotProps:P={},slots:k={},...L}=e,[N,M]=ee.useState(!0),z=()=>{M(!1)},B=()=>{M(!0)};if(!u&&!f&&(!E||N))return null;let q;if(a)q=a;else if(n){const ie=DP(n);q=ie&&Vce(ie)?is(ie).body:is(null).body}const W=!f&&u&&(!E||N)?"none":void 0,G=E?{in:f,onEnter:z,onExited:B}:void 0;return Z.jsx(wG,{disablePortal:o,container:q,children:Z.jsx(Hce,{anchorEl:n,direction:s,disablePortal:o,modifiers:h,ref:r,open:E?!N:f,placement:d,popperOptions:b,popperRef:v,slotProps:P,slots:k,...L,style:{position:"fixed",top:0,left:0,display:W,...S},TransitionProps:G,children:i})})}),Gce=Br(Wce,{name:"MuiPopper",slot:"Root"})({}),SG=ee.forwardRef(function(e,r){const n=$b(),i=_i({props:e,name:"MuiPopper"}),{anchorEl:a,component:s,components:o,componentsProps:u,container:h,disablePortal:f,keepMounted:d,modifiers:b,open:v,placement:S,popperOptions:E,popperRef:P,transition:k,slots:L,slotProps:N,...M}=i,z=L?.root??o?.Root,B={anchorEl:a,container:h,disablePortal:f,keepMounted:d,modifiers:b,open:v,placement:S,popperOptions:E,popperRef:P,transition:k,...M};return Z.jsx(Gce,{as:s,direction:n?"rtl":"ltr",slots:{root:z},slotProps:N??u,...B,ref:r})});function $x(t){return parseInt(t,10)||0}const Xce={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Yce(t){for(const e in t)return!1;return!0}function a8(t){return Yce(t)||t.outerHeightStyle===0&&!t.overflowing}const Zce=ee.forwardRef(function(e,r){const{onChange:n,maxRows:i,minRows:a=1,style:s,value:o,...u}=e,{current:h}=ee.useRef(o!=null),f=ee.useRef(null),d=Bo(r,f),b=ee.useRef(null),v=ee.useRef(null),S=ee.useCallback(()=>{const N=f.current,M=v.current;if(!N||!M)return;const B=lc(N).getComputedStyle(N);if(B.width==="0px")return{outerHeightStyle:0,overflowing:!1};M.style.width=B.width,M.value=N.value||e.placeholder||"x",M.value.slice(-1)===`
`&&(M.value+=" ");const q=B.boxSizing,W=$x(B.paddingBottom)+$x(B.paddingTop),G=$x(B.borderBottomWidth)+$x(B.borderTopWidth),ie=M.scrollHeight;M.value="x";const J=M.scrollHeight;let H=ie;a&&(H=Math.max(Number(a)*J,H)),i&&(H=Math.min(Number(i)*J,H)),H=Math.max(H,J);const ne=H+(q==="border-box"?W+G:0),ae=Math.abs(H-ie)<=1;return{outerHeightStyle:ne,overflowing:ae}},[i,a,e.placeholder]),E=tu(()=>{const N=f.current,M=S();if(!N||!M||a8(M))return!1;const z=M.outerHeightStyle;return b.current!=null&&b.current!==z}),P=ee.useCallback(()=>{const N=f.current,M=S();if(!N||!M||a8(M))return;const z=M.outerHeightStyle;b.current!==z&&(b.current=z,N.style.height=`${z}px`),N.style.overflow=M.overflowing?"hidden":""},[S]),k=ee.useRef(-1);vu(()=>{const N=$R(P),M=f?.current;if(!M)return;const z=lc(M);z.addEventListener("resize",N);let B;return typeof ResizeObserver<"u"&&(B=new ResizeObserver(()=>{E()&&(B.unobserve(M),cancelAnimationFrame(k.current),P(),k.current=requestAnimationFrame(()=>{B.observe(M)}))}),B.observe(M)),()=>{N.clear(),cancelAnimationFrame(k.current),z.removeEventListener("resize",N),B&&B.disconnect()}},[S,P,E]),vu(()=>{P()});const L=N=>{h||P();const M=N.target,z=M.value.length,B=M.value.endsWith(`
`),q=M.selectionStart===z;B&&q&&M.setSelectionRange(z,z),n&&n(N)};return Z.jsxs(ee.Fragment,{children:[Z.jsx("textarea",{value:o,onChange:L,ref:d,rows:a,style:s,...u}),Z.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:v,tabIndex:-1,style:{...Xce.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function cg({props:t,states:e,muiFormControl:r}){return e.reduce((n,i)=>(n[i]=t[i],r&&typeof t[i]>"u"&&(n[i]=r[i]),n),{})}const eO=ee.createContext(void 0);function od(){return ee.useContext(eO)}function o8(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function Yw(t,e=!1){return t&&(o8(t.value)&&t.value!==""||e&&o8(t.defaultValue)&&t.defaultValue!=="")}function Kce(t){return t.startAdornment}function Jce(t){return pi("MuiInputBase",t)}const e0=fi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var s8;const QE=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${pn(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},eT=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},Qce=t=>{const{classes:e,color:r,disabled:n,error:i,endAdornment:a,focused:s,formControl:o,fullWidth:u,hiddenLabel:h,multiline:f,readOnly:d,size:b,startAdornment:v,type:S}=t,E={root:["root",`color${pn(r)}`,n&&"disabled",i&&"error",u&&"fullWidth",s&&"focused",o&&"formControl",b&&b!=="medium"&&`size${pn(b)}`,f&&"multiline",v&&"adornedStart",a&&"adornedEnd",h&&"hiddenLabel",d&&"readOnly"],input:["input",n&&"disabled",S==="search"&&"inputTypeSearch",f&&"inputMultiline",b==="small"&&"inputSizeSmall",h&&"inputHiddenLabel",v&&"inputAdornedStart",a&&"inputAdornedEnd",d&&"readOnly"]};return gi(E,Jce,e)},tT=Br("div",{name:"MuiInputBase",slot:"Root",overridesResolver:QE})(ui(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${e0.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),rT=Br("input",{name:"MuiInputBase",slot:"Input",overridesResolver:eT})(ui(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},n={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${e0.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${e0.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:a})=>!a.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:a})=>a.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),l8=mle({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),tO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:a,autoFocus:s,className:o,color:u,components:h={},componentsProps:f={},defaultValue:d,disabled:b,disableInjectingGlobalStyles:v,endAdornment:S,error:E,fullWidth:P=!1,id:k,inputComponent:L="input",inputProps:N={},inputRef:M,margin:z,maxRows:B,minRows:q,multiline:W=!1,name:G,onBlur:ie,onChange:J,onClick:H,onFocus:ne,onKeyDown:ae,onKeyUp:ue,placeholder:de,readOnly:Pe,renderSuffix:me,rows:Ee,size:we,slotProps:Ae={},slots:ce={},startAdornment:xe,type:_e="text",value:Me,...Re}=n,He=N.value!=null?N.value:Me,{current:Fe}=ee.useRef(He!=null),tt=ee.useRef(),Ze=ee.useCallback(Gt=>{},[]),Qe=Bo(tt,M,N.ref,Ze),[Ie,Lt]=ee.useState(!1),at=od(),Ve=cg({props:n,muiFormControl:at,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Ve.focused=at?at.focused:Ie,ee.useEffect(()=>{!at&&b&&Ie&&(Lt(!1),ie&&ie())},[at,b,Ie,ie]);const nr=at&&at.onFilled,Yt=at&&at.onEmpty,yr=ee.useCallback(Gt=>{Yw(Gt)?nr&&nr():Yt&&Yt()},[nr,Yt]);vu(()=>{Fe&&yr({value:He})},[He,yr,Fe]);const mt=Gt=>{ne&&ne(Gt),N.onFocus&&N.onFocus(Gt),at&&at.onFocus?at.onFocus(Gt):Lt(!0)},br=Gt=>{ie&&ie(Gt),N.onBlur&&N.onBlur(Gt),at&&at.onBlur?at.onBlur(Gt):Lt(!1)},Tr=(Gt,...Tt)=>{if(!Fe){const Oe=Gt.target||tt.current;if(Oe==null)throw new Error(Hd(1));yr({value:Oe.value})}N.onChange&&N.onChange(Gt,...Tt),J&&J(Gt,...Tt)};ee.useEffect(()=>{yr(tt.current)},[]);const mr=Gt=>{tt.current&&Gt.currentTarget===Gt.target&&tt.current.focus(),H&&H(Gt)};let Mr=L,Pr=N;W&&Mr==="input"&&(Ee?Pr={type:void 0,minRows:Ee,maxRows:Ee,...Pr}:Pr={type:void 0,maxRows:B,minRows:q,...Pr},Mr=Zce);const ar=Gt=>{yr(Gt.animationName==="mui-auto-fill-cancel"?tt.current:{value:"x"})};ee.useEffect(()=>{at&&at.setAdornedStart(!!xe)},[at,xe]);const fr={...n,color:Ve.color||"primary",disabled:Ve.disabled,endAdornment:S,error:Ve.error,focused:Ve.focused,formControl:at,fullWidth:P,hiddenLabel:Ve.hiddenLabel,multiline:W,size:Ve.size,startAdornment:xe,type:_e},Nr=Qce(fr),or=ce.root||h.Root||tT,Dr=Ae.root||f.root||{},er=ce.input||h.Input||rT;return Pr={...Pr,...Ae.input??f.input},Z.jsxs(ee.Fragment,{children:[!v&&typeof l8=="function"&&(s8||(s8=Z.jsx(l8,{}))),Z.jsxs(or,{...Dr,ref:r,onClick:mr,...Re,...!Yf(or)&&{ownerState:{...fr,...Dr.ownerState}},className:An(Nr.root,Dr.className,o,Pe&&"MuiInputBase-readOnly"),children:[xe,Z.jsx(eO.Provider,{value:null,children:Z.jsx(er,{"aria-invalid":Ve.error,"aria-describedby":i,autoComplete:a,autoFocus:s,defaultValue:d,disabled:Ve.disabled,id:k,onAnimationStart:ar,name:G,placeholder:de,readOnly:Pe,required:Ve.required,rows:Ee,value:He,onKeyDown:ae,onKeyUp:ue,type:_e,...Pr,...!Yf(er)&&{as:Mr,ownerState:{...fr,...Pr.ownerState}},ref:Qe,className:An(Nr.input,Pr.className,Pe&&"MuiInputBase-readOnly"),onBlur:br,onChange:Tr,onFocus:mt})}),S,me?me({...Ve,startAdornment:xe}):null]})]})});function ehe(t){return pi("MuiInput",t)}const m_={...e0,...fi("MuiInput",["root","underline","input"])};function the(t){return pi("MuiOutlinedInput",t)}const Of={...e0,...fi("MuiOutlinedInput",["root","notchedOutline","input"])};function rhe(t){return pi("MuiFilledInput",t)}const Mg={...e0,...fi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},nhe=Yi(Z.jsx("path",{d:"M7 10l5 5 5-5z"})),ihe=Yi(Z.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function ahe(t){return pi("MuiAvatar",t)}fi("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const ohe=t=>{const{classes:e,variant:r,colorDefault:n}=t;return gi({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},ahe,e)},she=Br("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})(ui(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),lhe=Br("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),uhe=Br(ihe,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function che({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,a]=ee.useState(!1);return ee.useEffect(()=>{if(!r&&!n)return;a(!1);let s=!0;const o=new Image;return o.onload=()=>{s&&a("loaded")},o.onerror=()=>{s&&a("error")},o.crossOrigin=t,o.referrerPolicy=e,o.src=r,n&&(o.srcset=n),()=>{s=!1}},[t,e,r,n]),i}const EG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAvatar"}),{alt:i,children:a,className:s,component:o="div",slots:u={},slotProps:h={},imgProps:f,sizes:d,src:b,srcSet:v,variant:S="circular",...E}=n;let P=null;const k={...n,component:o,variant:S},L=che({...f,...typeof h.img=="function"?h.img(k):h.img,src:b,srcSet:v}),N=b||v,M=N&&L!=="error";k.colorDefault=!M,delete k.ownerState;const z=ohe(k),[B,q]=Ei("root",{ref:r,className:An(z.root,s),elementType:she,externalForwardedProps:{slots:u,slotProps:h,component:o,...E},ownerState:k}),[W,G]=Ei("img",{className:z.img,elementType:lhe,externalForwardedProps:{slots:u,slotProps:{img:{...f,...h.img}}},additionalProps:{alt:i,src:b,srcSet:v,sizes:d},ownerState:k}),[ie,J]=Ei("fallback",{className:z.fallback,elementType:uhe,externalForwardedProps:{slots:u,slotProps:h},shouldForwardComponentProp:!0,ownerState:k});return M?P=Z.jsx(W,{...G}):a||a===0?P=a:N&&i?P=i[0]:P=Z.jsx(ie,{...J}),Z.jsx(B,{...q,children:P})}),hhe={entering:{opacity:1},entered:{opacity:1}},FP=ee.forwardRef(function(e,r){const n=kc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:o,easing:u,in:h,onEnter:f,onEntered:d,onEntering:b,onExit:v,onExited:S,onExiting:E,style:P,timeout:k=i,TransitionComponent:L=Lh,...N}=e,M=ee.useRef(null),z=Bo(M,ug(o),r),B=ae=>ue=>{if(ae){const de=M.current;ue===void 0?ae(de):ae(de,ue)}},q=B(b),W=B((ae,ue)=>{WR(ae);const de=Gd({style:P,timeout:k,easing:u},{mode:"enter"});ae.style.webkitTransition=n.transitions.create("opacity",de),ae.style.transition=n.transitions.create("opacity",de),f&&f(ae,ue)}),G=B(d),ie=B(E),J=B(ae=>{const ue=Gd({style:P,timeout:k,easing:u},{mode:"exit"});ae.style.webkitTransition=n.transitions.create("opacity",ue),ae.style.transition=n.transitions.create("opacity",ue),v&&v(ae)}),H=B(S),ne=ae=>{a&&a(M.current,ae)};return Z.jsx(L,{appear:s,in:h,nodeRef:M,onEnter:W,onEntered:G,onEntering:q,onExit:J,onExited:H,onExiting:ie,addEndListener:ne,timeout:k,...N,children:(ae,{ownerState:ue,...de})=>ee.cloneElement(o,{style:{opacity:0,visibility:ae==="exited"&&!h?"hidden":void 0,...hhe[ae],...P,...o.props.style},ref:z,...de})})});function fhe(t){return pi("MuiBackdrop",t)}fi("MuiBackdrop",["root","invisible"]);const dhe=t=>{const{classes:e,invisible:r}=t;return gi({root:["root",r&&"invisible"]},fhe,e)},phe=Br("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),TG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiBackdrop"}),{children:i,className:a,component:s="div",invisible:o=!1,open:u,components:h={},componentsProps:f={},slotProps:d={},slots:b={},TransitionComponent:v,transitionDuration:S,...E}=n,P={...n,component:s,invisible:o},k=dhe(P),L={transition:v,root:h.Root,...b},N={...f,...d},M={component:s,slots:L,slotProps:N},[z,B]=Ei("root",{elementType:phe,externalForwardedProps:M,className:An(k.root,a),ownerState:P}),[q,W]=Ei("transition",{elementType:FP,externalForwardedProps:M,ownerState:P});return Z.jsx(q,{in:u,timeout:S,...E,...W,children:Z.jsx(z,{"aria-hidden":!0,...B,classes:k,ref:r,children:i})})}),ghe=fi("MuiBox",["root"]),mhe=A0(),Ho=LW({themeId:nf,defaultTheme:mhe,defaultClassName:ghe.root,generateClassName:LR.generate});function yhe(t){return pi("MuiButton",t)}const Rg=fi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),CG=ee.createContext({}),AG=ee.createContext(void 0),vhe=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:a,loading:s,loadingPosition:o,classes:u}=t,h={root:["root",s&&"loading",a,`${a}${pn(e)}`,`size${pn(i)}`,`${a}Size${pn(i)}`,`color${pn(e)}`,r&&"disableElevation",n&&"fullWidth",s&&`loadingPosition${pn(o)}`],startIcon:["icon","startIcon",`iconSize${pn(i)}`],endIcon:["icon","endIcon",`iconSize${pn(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},f=gi(h,yhe,u);return{...u,...f}},IG=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],_he=Br(I0,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${pn(r.color)}`],e[`size${pn(r.size)}`],e[`${r.variant}Size${pn(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(ui(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Rg.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${Rg.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${Rg.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Rg.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(Bl()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Rg.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Rg.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${Rg.loading}`]:{color:"transparent"}}}]}})),bhe=Br("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${pn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...IG]})),xhe=Br("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${pn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...IG]})),whe=Br("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),u8=Br("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),ra=ee.forwardRef(function(e,r){const n=ee.useContext(CG),i=ee.useContext(AG),a=G1(n,e),s=_i({props:a,name:"MuiButton"}),{children:o,color:u="primary",component:h="button",className:f,disabled:d=!1,disableElevation:b=!1,disableFocusRipple:v=!1,endIcon:S,focusVisibleClassName:E,fullWidth:P=!1,id:k,loading:L=null,loadingIndicator:N,loadingPosition:M="center",size:z="medium",startIcon:B,type:q,variant:W="text",...G}=s,ie=og(k),J=N??Z.jsx(KE,{"aria-labelledby":ie,color:"inherit",size:16}),H={...s,color:u,component:h,disabled:d,disableElevation:b,disableFocusRipple:v,fullWidth:P,loading:L,loadingIndicator:J,loadingPosition:M,size:z,type:q,variant:W},ne=vhe(H),ae=(B||L&&M==="start")&&Z.jsx(bhe,{className:ne.startIcon,ownerState:H,children:B||Z.jsx(u8,{className:ne.loadingIconPlaceholder,ownerState:H})}),ue=(S||L&&M==="end")&&Z.jsx(xhe,{className:ne.endIcon,ownerState:H,children:S||Z.jsx(u8,{className:ne.loadingIconPlaceholder,ownerState:H})}),de=i||"",Pe=typeof L=="boolean"?Z.jsx("span",{className:ne.loadingWrapper,style:{display:"contents"},children:L&&Z.jsx(whe,{className:ne.loadingIndicator,ownerState:H,children:J})}):null;return Z.jsxs(_he,{ownerState:H,className:An(n.className,ne.root,f,de),component:h,disabled:d||L,focusRipple:!v,focusVisibleClassName:An(ne.focusVisible,E),ref:r,type:q,id:L?ie:k,...G,classes:ne,children:[ae,M!=="end"&&Pe,o,M==="end"&&Pe,ue]})});function She(t){return ee.Children.toArray(t).filter(e=>ee.isValidElement(e))}function Ehe(t){return pi("MuiButtonGroup",t)}const ta=fi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),The=(t,e)=>{const{ownerState:r}=t;return[{[`& .${ta.grouped}`]:e.grouped},{[`& .${ta.grouped}`]:e[`grouped${pn(r.orientation)}`]},{[`& .${ta.grouped}`]:e[`grouped${pn(r.variant)}`]},{[`& .${ta.grouped}`]:e[`grouped${pn(r.variant)}${pn(r.orientation)}`]},{[`& .${ta.grouped}`]:e[`grouped${pn(r.variant)}${pn(r.color)}`]},{[`& .${ta.firstButton}`]:e.firstButton},{[`& .${ta.lastButton}`]:e.lastButton},{[`& .${ta.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},Che=t=>{const{classes:e,color:r,disabled:n,disableElevation:i,fullWidth:a,orientation:s,variant:o}=t,u={root:["root",o,s,a&&"fullWidth",i&&"disableElevation",`color${pn(r)}`],grouped:["grouped",`grouped${pn(s)}`,`grouped${pn(o)}`,`grouped${pn(o)}${pn(s)}`,`grouped${pn(o)}${pn(r)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return gi(u,Ehe,e)},Ahe=Br("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:The})(ui(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${ta.lastButton},& .${ta.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ta.lastButton},& .${ta.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderRight:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ta.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderBottom:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ta.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(Bl()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderColor:t.alpha((t.vars||t).palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${ta.lastButton},& .${ta.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${ta.lastButton},& .${ta.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ta.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ta.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(Bl(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${ta.firstButton},& .${ta.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${ta.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),BP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiButtonGroup"}),{children:i,className:a,color:s="primary",component:o="div",disabled:u=!1,disableElevation:h=!1,disableFocusRipple:f=!1,disableRipple:d=!1,fullWidth:b=!1,orientation:v="horizontal",size:S="medium",variant:E="outlined",...P}=n,k={...n,color:s,component:o,disabled:u,disableElevation:h,disableFocusRipple:f,disableRipple:d,fullWidth:b,orientation:v,size:S,variant:E},L=Che(k),N=ee.useMemo(()=>({className:L.grouped,color:s,disabled:u,disableElevation:h,disableFocusRipple:f,disableRipple:d,fullWidth:b,size:S,variant:E}),[s,u,h,f,d,b,S,E,L.grouped]),M=She(i),z=M.length,B=q=>{const W=q===0,G=q===z-1;return W&&G?"":W?L.firstButton:G?L.lastButton:L.middleButton};return Z.jsx(Ahe,{as:o,role:"group",className:An(L.root,a),ref:r,ownerState:k,...P,children:Z.jsx(CG.Provider,{value:N,children:M.map((q,W)=>Z.jsx(AG.Provider,{value:B(W),children:q},W))})})});function Ihe(t){return pi("PrivateSwitchBase",t)}fi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Phe=t=>{const{classes:e,checked:r,disabled:n,edge:i}=t,a={root:["root",r&&"checked",n&&"disabled",i&&`edge${pn(i)}`],input:["input"]};return gi(a,Ihe,e)},khe=Br(I0,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),Mhe=Br("input",{name:"MuiSwitchBase",shouldForwardProp:_l})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),PG=ee.forwardRef(function(e,r){const{autoFocus:n,checked:i,checkedIcon:a,defaultChecked:s,disabled:o,disableFocusRipple:u=!1,edge:h=!1,icon:f,id:d,inputProps:b,inputRef:v,name:S,onBlur:E,onChange:P,onFocus:k,readOnly:L,required:N=!1,tabIndex:M,type:z,value:B,slots:q={},slotProps:W={},...G}=e,[ie,J]=pm({controlled:i,default:!!s,name:"SwitchBase",state:"checked"}),H=od(),ne=Me=>{k&&k(Me),H&&H.onFocus&&H.onFocus(Me)},ae=Me=>{E&&E(Me),H&&H.onBlur&&H.onBlur(Me)},ue=Me=>{if(Me.nativeEvent.defaultPrevented)return;const Re=Me.target.checked;J(Re),P&&P(Me,Re)};let de=o;H&&typeof de>"u"&&(de=H.disabled);const Pe=z==="checkbox"||z==="radio",me={...e,checked:ie,disabled:de,disableFocusRipple:u,edge:h},Ee=Phe(me),we={slots:q,slotProps:{input:b,...W}},[Ae,ce]=Ei("root",{ref:r,elementType:khe,className:Ee.root,shouldForwardComponentProp:!0,externalForwardedProps:{...we,component:"span",...G},getSlotProps:Me=>({...Me,onFocus:Re=>{Me.onFocus?.(Re),ne(Re)},onBlur:Re=>{Me.onBlur?.(Re),ae(Re)}}),ownerState:me,additionalProps:{centerRipple:!0,focusRipple:!u,disabled:de,role:void 0,tabIndex:null}}),[xe,_e]=Ei("input",{ref:v,elementType:Mhe,className:Ee.input,externalForwardedProps:we,getSlotProps:Me=>({...Me,onChange:Re=>{Me.onChange?.(Re),ue(Re)}}),ownerState:me,additionalProps:{autoFocus:n,checked:i,defaultChecked:s,disabled:de,id:Pe?d:void 0,name:S,readOnly:L,required:N,tabIndex:M,type:z,...z==="checkbox"&&B===void 0?{}:{value:B}}});return Z.jsxs(Ae,{...ce,children:[Z.jsx(xe,{..._e}),ie?a:f]})}),Rhe=Yi(Z.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Ohe=Yi(Z.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Nhe=Yi(Z.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Lhe(t){return pi("MuiCheckbox",t)}const p3=fi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Dhe=t=>{const{classes:e,indeterminate:r,color:n,size:i}=t,a={root:["root",r&&"indeterminate",`color${pn(n)}`,`size${pn(i)}`]},s=gi(a,Lhe,e);return{...e,...s}},Fhe=Br(PG,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${pn(r.size)}`],r.color!=="default"&&e[`color${pn(r.color)}`]]}})(ui(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{[`&.${p3.checked}, &.${p3.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${p3.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Bhe=Z.jsx(Ohe,{}),zhe=Z.jsx(Rhe,{}),jhe=Z.jsx(Nhe,{}),t0=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCheckbox"}),{checkedIcon:i=Bhe,color:a="primary",icon:s=zhe,indeterminate:o=!1,indeterminateIcon:u=jhe,inputProps:h,size:f="medium",disableRipple:d=!1,className:b,slots:v={},slotProps:S={},...E}=n,P=o?u:s,k=o?u:i,L={...n,disableRipple:d,color:a,indeterminate:o,size:f},N=Dhe(L),M=S.input??h,[z,B]=Ei("root",{ref:r,elementType:Fhe,className:An(N.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:v,slotProps:S,...E},ownerState:L,additionalProps:{type:"checkbox",icon:ee.cloneElement(P,{fontSize:P.props.fontSize??f}),checkedIcon:ee.cloneElement(k,{fontSize:k.props.fontSize??f}),disableRipple:d,slots:v,slotProps:{input:Y1(typeof M=="function"?M(L):M,{"data-indeterminate":o})}}});return Z.jsx(z,{...B,classes:N})});function c8(t){return t.substring(2).toLowerCase()}function Uhe(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function Vhe(t){const{children:e,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,s=ee.useRef(!1),o=ee.useRef(null),u=ee.useRef(!1),h=ee.useRef(!1);ee.useEffect(()=>(setTimeout(()=>{u.current=!0},0),()=>{u.current=!1}),[]);const f=Bo(ug(e),o),d=tu(S=>{const E=h.current;h.current=!1;const P=is(o.current);if(!u.current||!o.current||"clientX"in S&&Uhe(S,P))return;if(s.current){s.current=!1;return}let k;S.composedPath?k=S.composedPath().includes(o.current):k=!P.documentElement.contains(S.target)||o.current.contains(S.target),!k&&(r||!E)&&i(S)}),b=S=>E=>{h.current=!0;const P=e.props[S];P&&P(E)},v={ref:f};return a!==!1&&(v[a]=b(a)),ee.useEffect(()=>{if(a!==!1){const S=c8(a),E=is(o.current),P=()=>{s.current=!0};return E.addEventListener(S,d),E.addEventListener("touchmove",P),()=>{E.removeEventListener(S,d),E.removeEventListener("touchmove",P)}}},[d,a]),n!==!1&&(v[n]=b(n)),ee.useEffect(()=>{if(n!==!1){const S=c8(n),E=is(o.current);return E.addEventListener(S,d),()=>{E.removeEventListener(S,d)}}},[d,n]),ee.cloneElement(e,v)}function kG(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function $he(t){const e=is(t);return e.body===t?lc(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function w1(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function h8(t){return parseInt(lc(t).getComputedStyle(t).paddingRight,10)||0}function qhe(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function f8(t,e,r,n,i){const a=[e,r,...n];[].forEach.call(t.children,s=>{const o=!a.includes(s),u=!qhe(s);o&&u&&w1(s,i)})}function g3(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function Hhe(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if($he(n)){const s=kG(lc(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${h8(n)+s}px`;const o=is(n).querySelectorAll(".mui-fixed");[].forEach.call(o,u=>{r.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${h8(u)+s}px`})}let a;if(n.parentNode instanceof DocumentFragment)a=is(n).body;else{const s=n.parentElement,o=lc(n);a=s?.nodeName==="HTML"&&o.getComputedStyle(s).overflowY==="scroll"?s:n}r.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{r.forEach(({value:a,el:s,property:o})=>{a?s.style.setProperty(o,a):s.style.removeProperty(o)})}}function Whe(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class Ghe{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&w1(e.modalRef,!1);const i=Whe(r);f8(r,e.mount,e.modalRef,i,!0);const a=g3(this.containers,s=>s.container===r);return a!==-1?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=g3(this.containers,a=>a.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=Hhe(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=g3(this.containers,s=>s.modals.includes(e)),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(n,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&w1(e.modalRef,r),f8(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const s=a.modals[a.modals.length-1];s.modalRef&&w1(s.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Xhe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Yhe(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Zhe(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function Khe(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Zhe(t))}function Jhe(t){const e=[],r=[];return Array.from(t.querySelectorAll(Xhe)).forEach((n,i)=>{const a=Yhe(n);a===-1||!Khe(n)||(a===0?e.push(n):r.push({documentOrder:i,tabIndex:a,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function Qhe(){return!0}function efe(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:a=Jhe,isEnabled:s=Qhe,open:o}=t,u=ee.useRef(!1),h=ee.useRef(null),f=ee.useRef(null),d=ee.useRef(null),b=ee.useRef(null),v=ee.useRef(!1),S=ee.useRef(null),E=Bo(ug(e),S),P=ee.useRef(null);ee.useEffect(()=>{!o||!S.current||(v.current=!r)},[r,o]),ee.useEffect(()=>{if(!o||!S.current)return;const N=is(S.current);return S.current.contains(N.activeElement)||(S.current.hasAttribute("tabIndex")||S.current.setAttribute("tabIndex","-1"),v.current&&S.current.focus()),()=>{i||(d.current&&d.current.focus&&(u.current=!0,d.current.focus()),d.current=null)}},[o]),ee.useEffect(()=>{if(!o||!S.current)return;const N=is(S.current),M=q=>{P.current=q,!(n||!s()||q.key!=="Tab")&&N.activeElement===S.current&&q.shiftKey&&(u.current=!0,f.current&&f.current.focus())},z=()=>{const q=S.current;if(q===null)return;if(!N.hasFocus()||!s()||u.current){u.current=!1;return}if(q.contains(N.activeElement)||n&&N.activeElement!==h.current&&N.activeElement!==f.current)return;if(N.activeElement!==b.current)b.current=null;else if(b.current!==null)return;if(!v.current)return;let W=[];if((N.activeElement===h.current||N.activeElement===f.current)&&(W=a(S.current)),W.length>0){const G=!!(P.current?.shiftKey&&P.current?.key==="Tab"),ie=W[0],J=W[W.length-1];typeof ie!="string"&&typeof J!="string"&&(G?J.focus():ie.focus())}else q.focus()};N.addEventListener("focusin",z),N.addEventListener("keydown",M,!0);const B=setInterval(()=>{N.activeElement&&N.activeElement.tagName==="BODY"&&z()},50);return()=>{clearInterval(B),N.removeEventListener("focusin",z),N.removeEventListener("keydown",M,!0)}},[r,n,i,s,o,a]);const k=N=>{d.current===null&&(d.current=N.relatedTarget),v.current=!0,b.current=N.target;const M=e.props.onFocus;M&&M(N)},L=N=>{d.current===null&&(d.current=N.relatedTarget),v.current=!0};return Z.jsxs(ee.Fragment,{children:[Z.jsx("div",{tabIndex:o?0:-1,onFocus:L,ref:h,"data-testid":"sentinelStart"}),ee.cloneElement(e,{ref:E,onFocus:k}),Z.jsx("div",{tabIndex:o?0:-1,onFocus:L,ref:f,"data-testid":"sentinelEnd"})]})}function tfe(t){return typeof t=="function"?t():t}function rfe(t){return t?t.props.hasOwnProperty("in"):!1}const d8=()=>{},qx=new Ghe;function nfe(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:a,onTransitionExited:s,children:o,onClose:u,open:h,rootRef:f}=t,d=ee.useRef({}),b=ee.useRef(null),v=ee.useRef(null),S=Bo(v,f),[E,P]=ee.useState(!h),k=rfe(o);let L=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(L=!1);const N=()=>is(b.current),M=()=>(d.current.modalRef=v.current,d.current.mount=b.current,d.current),z=()=>{qx.mount(M(),{disableScrollLock:n}),v.current&&(v.current.scrollTop=0)},B=tu(()=>{const ue=tfe(e)||N().body;qx.add(M(),ue),v.current&&z()}),q=()=>qx.isTopModal(M()),W=tu(ue=>{b.current=ue,ue&&(h&&q()?z():v.current&&w1(v.current,L))}),G=ee.useCallback(()=>{qx.remove(M(),L)},[L]);ee.useEffect(()=>()=>{G()},[G]),ee.useEffect(()=>{h?B():(!k||!i)&&G()},[h,G,k,i,B]);const ie=ue=>de=>{ue.onKeyDown?.(de),!(de.key!=="Escape"||de.which===229||!q())&&(r||(de.stopPropagation(),u&&u(de,"escapeKeyDown")))},J=ue=>de=>{ue.onClick?.(de),de.target===de.currentTarget&&u&&u(de,"backdropClick")};return{getRootProps:(ue={})=>{const de=rm(t);delete de.onTransitionEnter,delete de.onTransitionExited;const Pe={...de,...ue};return{role:"presentation",...Pe,onKeyDown:ie(Pe),ref:S}},getBackdropProps:(ue={})=>{const de=ue;return{"aria-hidden":!0,...de,onClick:J(de),open:h}},getTransitionProps:()=>{const ue=()=>{P(!1),a&&a()},de=()=>{P(!0),s&&s(),i&&G()};return{onEnter:CP(ue,o?.props.onEnter??d8),onExited:CP(de,o?.props.onExited??d8)}},rootRef:S,portalRef:W,isTopModal:q,exited:E,hasTransition:k}}function ife(t){return pi("MuiModal",t)}fi("MuiModal",["root","hidden","backdrop"]);const afe=t=>{const{open:e,exited:r,classes:n}=t;return gi({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},ife,n)},ofe=Br("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(ui(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),sfe=Br(TG,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),rO=ee.forwardRef(function(e,r){const n=_i({name:"MuiModal",props:e}),{BackdropComponent:i=sfe,BackdropProps:a,classes:s,className:o,closeAfterTransition:u=!1,children:h,container:f,component:d,components:b={},componentsProps:v={},disableAutoFocus:S=!1,disableEnforceFocus:E=!1,disableEscapeKeyDown:P=!1,disablePortal:k=!1,disableRestoreFocus:L=!1,disableScrollLock:N=!1,hideBackdrop:M=!1,keepMounted:z=!1,onClose:B,onTransitionEnter:q,onTransitionExited:W,open:G,slotProps:ie={},slots:J={},theme:H,...ne}=n,ae={...n,closeAfterTransition:u,disableAutoFocus:S,disableEnforceFocus:E,disableEscapeKeyDown:P,disablePortal:k,disableRestoreFocus:L,disableScrollLock:N,hideBackdrop:M,keepMounted:z},{getRootProps:ue,getBackdropProps:de,getTransitionProps:Pe,portalRef:me,isTopModal:Ee,exited:we,hasTransition:Ae}=nfe({...ae,rootRef:r}),ce={...ae,exited:we},xe=afe(ce),_e={};if(h.props.tabIndex===void 0&&(_e.tabIndex="-1"),Ae){const{onEnter:Ze,onExited:Qe}=Pe();_e.onEnter=Ze,_e.onExited=Qe}const Me={slots:{root:b.Root,backdrop:b.Backdrop,...J},slotProps:{...v,...ie}},[Re,He]=Ei("root",{ref:r,elementType:ofe,externalForwardedProps:{...Me,...ne,component:d},getSlotProps:ue,ownerState:ce,className:An(o,xe?.root,!ce.open&&ce.exited&&xe?.hidden)}),[Fe,tt]=Ei("backdrop",{ref:a?.ref,elementType:i,externalForwardedProps:Me,shouldForwardComponentProp:!0,additionalProps:a,getSlotProps:Ze=>de({...Ze,onClick:Qe=>{Ze?.onClick&&Ze.onClick(Qe)}}),className:An(a?.className,xe?.backdrop),ownerState:ce});return!z&&!G&&(!Ae||we)?null:Z.jsx(wG,{ref:me,container:f,disablePortal:k,children:Z.jsxs(Re,{...He,children:[!M&&i?Z.jsx(Fe,{...tt}):null,Z.jsx(efe,{disableEnforceFocus:E,disableAutoFocus:S,disableRestoreFocus:L,isEnabled:Ee,open:G,children:ee.cloneElement(h,_e)})]})})});function lfe(t){return pi("MuiDialog",t)}const m3=fi("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),MG=ee.createContext({}),ufe=Br(TG,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),cfe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:a}=t,s={root:["root"],container:["container",`scroll${pn(r)}`],paper:["paper",`paperScroll${pn(r)}`,`paperWidth${pn(String(n))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return gi(s,lfe,e)},hfe=Br(rO,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),ffe=Br("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${pn(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),dfe=Br(Eh,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${pn(r.scroll)}`],e[`paperWidth${pn(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(ui(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${m3.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${m3.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${m3.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),nO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialog"}),i=kc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":o,"aria-modal":u=!0,BackdropComponent:h,BackdropProps:f,children:d,className:b,disableEscapeKeyDown:v=!1,fullScreen:S=!1,fullWidth:E=!1,maxWidth:P="sm",onClick:k,onClose:L,open:N,PaperComponent:M=Eh,PaperProps:z={},scroll:B="paper",slots:q={},slotProps:W={},TransitionComponent:G=FP,transitionDuration:ie=a,TransitionProps:J,...H}=n,ne={...n,disableEscapeKeyDown:v,fullScreen:S,fullWidth:E,maxWidth:P,scroll:B},ae=cfe(ne),ue=ee.useRef(),de=Lt=>{ue.current=Lt.target===Lt.currentTarget},Pe=Lt=>{k&&k(Lt),ue.current&&(ue.current=null,L&&L(Lt,"backdropClick"))},me=og(o),Ee=ee.useMemo(()=>({titleId:me}),[me]),we={transition:G,...q},Ae={transition:J,paper:z,backdrop:f,...W},ce={slots:we,slotProps:Ae},[xe,_e]=Ei("root",{elementType:hfe,shouldForwardComponentProp:!0,externalForwardedProps:ce,ownerState:ne,className:An(ae.root,b),ref:r}),[Me,Re]=Ei("backdrop",{elementType:ufe,shouldForwardComponentProp:!0,externalForwardedProps:ce,ownerState:ne}),[He,Fe]=Ei("paper",{elementType:dfe,shouldForwardComponentProp:!0,externalForwardedProps:ce,ownerState:ne,className:An(ae.paper,z.className)}),[tt,Ze]=Ei("container",{elementType:ffe,externalForwardedProps:ce,ownerState:ne,className:ae.container}),[Qe,Ie]=Ei("transition",{elementType:FP,externalForwardedProps:ce,ownerState:ne,additionalProps:{appear:!0,in:N,timeout:ie,role:"presentation"}});return Z.jsx(xe,{closeAfterTransition:!0,slots:{backdrop:Me},slotProps:{backdrop:{transitionDuration:ie,as:h,...Re}},disableEscapeKeyDown:v,onClose:L,open:N,onClick:Pe,..._e,...H,children:Z.jsx(Qe,{...Ie,children:Z.jsx(tt,{onMouseDown:de,...Ze,children:Z.jsx(He,{as:M,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":me,"aria-modal":u,...Fe,children:Z.jsx(MG.Provider,{value:Ee,children:d})})})})})});function pfe(t){return pi("MuiDialogActions",t)}fi("MuiDialogActions",["root","spacing"]);const gfe=t=>{const{classes:e,disableSpacing:r}=t;return gi({root:["root",!r&&"spacing"]},pfe,e)},mfe=Br("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Wb=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1,...s}=n,o={...n,disableSpacing:a},u=gfe(o);return Z.jsx(mfe,{className:An(u.root,i),ownerState:o,ref:r,...s})});function yfe(t){return pi("MuiDialogContent",t)}fi("MuiDialogContent",["root","dividers"]);function vfe(t){return pi("MuiDialogTitle",t)}const _fe=fi("MuiDialogTitle",["root"]),bfe=t=>{const{classes:e,dividers:r}=t;return gi({root:["root",r&&"dividers"]},yfe,e)},xfe=Br("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(ui(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${_fe.root} + &`]:{paddingTop:0}}}]}))),iO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogContent"}),{className:i,dividers:a=!1,...s}=n,o={...n,dividers:a},u=bfe(o);return Z.jsx(xfe,{className:An(u.root,i),ownerState:o,ref:r,...s})});function wfe(t){return pi("MuiDialogContentText",t)}fi("MuiDialogContentText",["root"]);const Sfe=t=>{const{classes:e}=t,n=gi({root:["root"]},wfe,e);return{...e,...n}},Efe=Br(bs,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),Tfe=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogContentText"}),{children:i,className:a,...s}=n,o=Sfe(s);return Z.jsx(Efe,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:s,className:An(o.root,a),...n,classes:o})}),Cfe=t=>{const{classes:e}=t;return gi({root:["root"]},vfe,e)},Afe=Br(bs,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Bm=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogTitle"}),{className:i,id:a,...s}=n,o=n,u=Cfe(o),{titleId:h=a}=ee.useContext(MG);return Z.jsx(Afe,{component:"h2",className:An(u.root,i),ownerState:o,ref:r,variant:"h6",id:a??h,...s})});function Ife(t){return pi("MuiDivider",t)}const p8=fi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Pfe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:a,orientation:s,textAlign:o,variant:u}=t;return gi({root:["root",e&&"absolute",u,a&&"light",s==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",o==="right"&&s!=="vertical"&&"textAlignRight",o==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},Ife,n)},kfe=Br("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(ui(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Mfe=Br("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(ui(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),zP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:s,orientation:o="horizontal",component:u=a||o==="vertical"?"div":"hr",flexItem:h=!1,light:f=!1,role:d=u!=="hr"?"separator":void 0,textAlign:b="center",variant:v="fullWidth",...S}=n,E={...n,absolute:i,component:u,flexItem:h,light:f,orientation:o,role:d,textAlign:b,variant:v},P=Pfe(E);return Z.jsx(kfe,{as:u,className:An(P.root,s),role:d,ref:r,ownerState:E,"aria-orientation":d==="separator"&&(u!=="hr"||o==="vertical")?o:void 0,...S,children:a?Z.jsx(Mfe,{className:P.wrapper,ownerState:E,children:a}):null})});zP&&(zP.muiSkipListHighlight=!0);function Rfe(t,e,r){const n=e.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),a=lc(e);let s;if(e.fakeTransform)s=e.fakeTransform;else{const h=a.getComputedStyle(e);s=h.getPropertyValue("-webkit-transform")||h.getPropertyValue("transform")}let o=0,u=0;if(s&&s!=="none"&&typeof s=="string"){const h=s.split("(")[1].split(")")[0].split(",");o=parseInt(h[4],10),u=parseInt(h[5],10)}return t==="left"?i?`translateX(${i.right+o-n.left}px)`:`translateX(${a.innerWidth+o-n.left}px)`:t==="right"?i?`translateX(-${n.right-i.left-o}px)`:`translateX(-${n.left+n.width-o}px)`:t==="up"?i?`translateY(${i.bottom+u-n.top}px)`:`translateY(${a.innerHeight+u-n.top}px)`:i?`translateY(-${n.top-i.top+n.height-u}px)`:`translateY(-${n.top+n.height-u}px)`}function Ofe(t){return typeof t=="function"?t():t}function Hx(t,e,r){const n=Ofe(r),i=Rfe(t,e,n);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Nfe=ee.forwardRef(function(e,r){const n=kc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:u,container:h,direction:f="down",easing:d=i,in:b,onEnter:v,onEntered:S,onEntering:E,onExit:P,onExited:k,onExiting:L,style:N,timeout:M=a,TransitionComponent:z=Lh,...B}=e,q=ee.useRef(null),W=Bo(ug(u),q,r),G=me=>Ee=>{me&&(Ee===void 0?me(q.current):me(q.current,Ee))},ie=G((me,Ee)=>{Hx(f,me,h),WR(me),v&&v(me,Ee)}),J=G((me,Ee)=>{const we=Gd({timeout:M,style:N,easing:d},{mode:"enter"});me.style.webkitTransition=n.transitions.create("-webkit-transform",{...we}),me.style.transition=n.transitions.create("transform",{...we}),me.style.webkitTransform="none",me.style.transform="none",E&&E(me,Ee)}),H=G(S),ne=G(L),ae=G(me=>{const Ee=Gd({timeout:M,style:N,easing:d},{mode:"exit"});me.style.webkitTransition=n.transitions.create("-webkit-transform",Ee),me.style.transition=n.transitions.create("transform",Ee),Hx(f,me,h),P&&P(me)}),ue=G(me=>{me.style.webkitTransition="",me.style.transition="",k&&k(me)}),de=me=>{s&&s(q.current,me)},Pe=ee.useCallback(()=>{q.current&&Hx(f,q.current,h)},[f,h]);return ee.useEffect(()=>{if(b||f==="down"||f==="right")return;const me=$R(()=>{q.current&&Hx(f,q.current,h)}),Ee=lc(q.current);return Ee.addEventListener("resize",me),()=>{me.clear(),Ee.removeEventListener("resize",me)}},[f,b,h]),ee.useEffect(()=>{b||Pe()},[b,Pe]),Z.jsx(z,{nodeRef:q,onEnter:ie,onEntered:H,onEntering:J,onExit:ae,onExited:ue,onExiting:ne,addEndListener:de,appear:o,in:b,timeout:M,...B,children:(me,{ownerState:Ee,...we})=>ee.cloneElement(u,{ref:W,style:{visibility:me==="exited"&&!b?"hidden":void 0,...N,...u.props.style},...we})})});function Lfe(t){return pi("MuiDrawer",t)}fi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const RG=(t,e)=>{const{ownerState:r}=t;return[e.root,(r.variant==="permanent"||r.variant==="persistent")&&e.docked,e.modal]},Dfe=t=>{const{classes:e,anchor:r,variant:n}=t,i={root:["root",`anchor${pn(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${pn(r)}`,n!=="temporary"&&`paperAnchorDocked${pn(r)}`]};return gi(i,Lfe,e)},Ffe=Br(rO,{name:"MuiDrawer",slot:"Root",overridesResolver:RG})(ui(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Bfe=Br("div",{shouldForwardProp:_l,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:RG})({flex:"0 0 auto"}),zfe=Br(Eh,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`paperAnchor${pn(r.anchor)}`],r.variant!=="temporary"&&e[`paperAnchorDocked${pn(r.anchor)}`]]}})(ui(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),OG={left:"right",right:"left",top:"down",bottom:"up"};function Vg(t){return["left","right"].includes(t)}function X_({direction:t},e){return t==="rtl"&&Vg(e)?OG[e]:e}const aO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDrawer"}),i=kc(),a=$b(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:o="left",BackdropProps:u,children:h,className:f,elevation:d=16,hideBackdrop:b=!1,ModalProps:{BackdropProps:v,...S}={},onClose:E,open:P=!1,PaperProps:k={},SlideProps:L,TransitionComponent:N,transitionDuration:M=s,variant:z="temporary",slots:B={},slotProps:q={},...W}=n,G=ee.useRef(!1);ee.useEffect(()=>{G.current=!0},[]);const ie=X_({direction:a?"rtl":"ltr"},o),H={...n,anchor:o,elevation:d,open:P,variant:z,...W},ne=Dfe(H),ae={slots:{transition:N,...B},slotProps:{paper:k,transition:L,...q,backdrop:Y1(q.backdrop||{...u,...v},{transitionDuration:M})}},[ue,de]=Ei("root",{ref:r,elementType:Ffe,className:An(ne.root,ne.modal,f),shouldForwardComponentProp:!0,ownerState:H,externalForwardedProps:{...ae,...W,...S},additionalProps:{open:P,onClose:E,hideBackdrop:b,slots:{backdrop:ae.slots.backdrop},slotProps:{backdrop:ae.slotProps.backdrop}}}),[Pe,me]=Ei("paper",{elementType:zfe,shouldForwardComponentProp:!0,className:An(ne.paper,k.className),ownerState:H,externalForwardedProps:ae,additionalProps:{elevation:z==="temporary"?d:0,square:!0,...z==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[Ee,we]=Ei("docked",{elementType:Bfe,ref:r,className:An(ne.root,ne.docked,f),ownerState:H,externalForwardedProps:ae,additionalProps:W}),[Ae,ce]=Ei("transition",{elementType:Nfe,ownerState:H,externalForwardedProps:ae,additionalProps:{in:P,direction:OG[ie],timeout:M,appear:G.current}}),xe=Z.jsx(Pe,{...me,children:h});if(z==="permanent")return Z.jsx(Ee,{...we,children:xe});const _e=Z.jsx(Ae,{...ce,children:xe});return z==="persistent"?Z.jsx(Ee,{...we,children:_e}):Z.jsx(ue,{...de,children:_e})}),jfe=t=>{const{classes:e,disableUnderline:r,startAdornment:n,endAdornment:i,size:a,hiddenLabel:s,multiline:o}=t,u={root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd",a==="small"&&`size${pn(a)}`,s&&"hiddenLabel",o&&"multiline"],input:["input"]},h=gi(u,rhe,e);return{...e,...h}},Ufe=Br(tT,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...QE(t,e),!r.disableUnderline&&e.underline]}})(ui(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n}},[`&.${Mg.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n},[`&.${Mg.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Mg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Mg.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Mg.disabled}, .${Mg.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Mg.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Bl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:o})=>s.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),Vfe=Br(rT,{name:"MuiFilledInput",slot:"Input",overridesResolver:eT})(ui(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),oO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFilledInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,hiddenLabel:u,inputComponent:h="input",multiline:f=!1,slotProps:d,slots:b={},type:v="text",...S}=n,E={...n,disableUnderline:i,fullWidth:o,inputComponent:h,multiline:f,type:v},P=jfe(n),k={root:{ownerState:E},input:{ownerState:E}},L=d??s?Wu(k,d??s):k,N=b.root??a.Root??Ufe,M=b.input??a.Input??Vfe;return Z.jsx(tO,{slots:{root:N,input:M},slotProps:L,fullWidth:o,inputComponent:h,multiline:f,ref:r,type:v,...S,classes:P})});oO.muiName="Input";function $fe(t){return pi("MuiFormControl",t)}fi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const qfe=t=>{const{classes:e,margin:r,fullWidth:n}=t,i={root:["root",r!=="none"&&`margin${pn(r)}`,n&&"fullWidth"]};return gi(i,$fe,e)},Hfe=Br("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${pn(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Kc=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormControl"}),{children:i,className:a,color:s="primary",component:o="div",disabled:u=!1,error:h=!1,focused:f,fullWidth:d=!1,hiddenLabel:b=!1,margin:v="none",required:S=!1,size:E="medium",variant:P="outlined",...k}=n,L={...n,color:s,component:o,disabled:u,error:h,fullWidth:d,hiddenLabel:b,margin:v,required:S,size:E,variant:P},N=qfe(L),[M,z]=ee.useState(()=>{let ue=!1;return i&&ee.Children.forEach(i,de=>{if(!_1(de,["Input","Select"]))return;const Pe=_1(de,["Select"])?de.props.input:de;Pe&&Kce(Pe.props)&&(ue=!0)}),ue}),[B,q]=ee.useState(()=>{let ue=!1;return i&&ee.Children.forEach(i,de=>{_1(de,["Input","Select"])&&(Yw(de.props,!0)||Yw(de.props.inputProps,!0))&&(ue=!0)}),ue}),[W,G]=ee.useState(!1);u&&W&&G(!1);const ie=f!==void 0&&!u?f:W;let J;ee.useRef(!1);const H=ee.useCallback(()=>{q(!0)},[]),ne=ee.useCallback(()=>{q(!1)},[]),ae=ee.useMemo(()=>({adornedStart:M,setAdornedStart:z,color:s,disabled:u,error:h,filled:B,focused:ie,fullWidth:d,hiddenLabel:b,size:E,onBlur:()=>{G(!1)},onFocus:()=>{G(!0)},onEmpty:ne,onFilled:H,registerEffect:J,required:S,variant:P}),[M,s,u,h,B,ie,d,b,J,ne,H,S,E,P]);return Z.jsx(eO.Provider,{value:ae,children:Z.jsx(Hfe,{as:o,ownerState:L,className:An(N.root,a),ref:r,...k,children:i})})});function Wfe(t){return pi("MuiFormControlLabel",t)}const Y_=fi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Gfe=t=>{const{classes:e,disabled:r,labelPlacement:n,error:i,required:a}=t,s={root:["root",r&&"disabled",`labelPlacement${pn(n)}`,i&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",i&&"error"]};return gi(s,Wfe,e)},Xfe=Br("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Y_.label}`]:e.label},e.root,e[`labelPlacement${pn(r.labelPlacement)}`]]}})(ui(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Y_.disabled}`]:{cursor:"default"},[`& .${Y_.label}`]:{[`&.${Y_.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),Yfe=Br("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(ui(({theme:t})=>({[`&.${Y_.error}`]:{color:(t.vars||t).palette.error.main}}))),jP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormControlLabel"}),{checked:i,className:a,componentsProps:s={},control:o,disabled:u,disableTypography:h,inputRef:f,label:d,labelPlacement:b="end",name:v,onChange:S,required:E,slots:P={},slotProps:k={},value:L,...N}=n,M=od(),z=u??o.props.disabled??M?.disabled,B=E??o.props.required,q={disabled:z,required:B};["checked","name","onChange","value","inputRef"].forEach(ue=>{typeof o.props[ue]>"u"&&typeof n[ue]<"u"&&(q[ue]=n[ue])});const W=cg({props:n,muiFormControl:M,states:["error"]}),G={...n,disabled:z,labelPlacement:b,required:B,error:W.error},ie=Gfe(G),J={slots:P,slotProps:{...s,...k}},[H,ne]=Ei("typography",{elementType:bs,externalForwardedProps:J,ownerState:G});let ae=d;return ae!=null&&ae.type!==bs&&!h&&(ae=Z.jsx(H,{component:"span",...ne,className:An(ie.label,ne?.className),children:ae})),Z.jsxs(Xfe,{className:An(ie.root,a),ownerState:G,ref:r,...N,children:[ee.cloneElement(o,q),B?Z.jsxs("div",{children:[ae,Z.jsxs(Yfe,{ownerState:G,"aria-hidden":!0,className:ie.asterisk,children:[" ","*"]})]}):ae]})});function Zfe(t){return pi("MuiFormGroup",t)}fi("MuiFormGroup",["root","row","error"]);const Kfe=t=>{const{classes:e,row:r,error:n}=t;return gi({root:["root",r&&"row",n&&"error"]},Zfe,e)},Jfe=Br("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),NG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormGroup"}),{className:i,row:a=!1,...s}=n,o=od(),u=cg({props:n,muiFormControl:o,states:["error"]}),h={...n,row:a,error:u.error},f=Kfe(h);return Z.jsx(Jfe,{className:An(f.root,i),ownerState:h,ref:r,...s})});function Qfe(t){return pi("MuiFormHelperText",t)}const g8=fi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var m8;const ede=t=>{const{classes:e,contained:r,size:n,disabled:i,error:a,filled:s,focused:o,required:u}=t,h={root:["root",i&&"disabled",a&&"error",n&&`size${pn(n)}`,r&&"contained",o&&"focused",s&&"filled",u&&"required"]};return gi(h,Qfe,e)},tde=Br("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${pn(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(ui(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${g8.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${g8.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),rde=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:s="p",disabled:o,error:u,filled:h,focused:f,margin:d,required:b,variant:v,...S}=n,E=od(),P=cg({props:n,muiFormControl:E,states:["variant","size","disabled","error","filled","focused","required"]}),k={...n,component:s,contained:P.variant==="filled"||P.variant==="outlined",variant:P.variant,size:P.size,disabled:P.disabled,error:P.error,filled:P.filled,focused:P.focused,required:P.required};delete k.ownerState;const L=ede(k);return Z.jsx(tde,{as:s,className:An(L.root,a),ref:r,...S,ownerState:k,children:i===" "?m8||(m8=Z.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):i})});function nde(t){return pi("MuiFormLabel",t)}const S1=fi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),ide=t=>{const{classes:e,color:r,focused:n,disabled:i,error:a,filled:s,required:o}=t,u={root:["root",`color${pn(r)}`,i&&"disabled",a&&"error",s&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]};return gi(u,nde,e)},ade=Br("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(ui(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{[`&.${S1.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${S1.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${S1.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),ode=Br("span",{name:"MuiFormLabel",slot:"Asterisk"})(ui(({theme:t})=>({[`&.${S1.error}`]:{color:(t.vars||t).palette.error.main}}))),LG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormLabel"}),{children:i,className:a,color:s,component:o="label",disabled:u,error:h,filled:f,focused:d,required:b,...v}=n,S=od(),E=cg({props:n,muiFormControl:S,states:["color","required","focused","disabled","error","filled"]}),P={...n,color:E.color||"primary",component:o,disabled:E.disabled,error:E.error,filled:E.filled,focused:E.focused,required:E.required},k=ide(P);return Z.jsxs(ade,{as:o,ownerState:P,className:An(k.root,a),ref:r,...v,children:[i,E.required&&Z.jsxs(ode,{ownerState:P,"aria-hidden":!0,className:k.asterisk,children:[" ","*"]})]})}),Bd=Ase({createStyledComponent:Br("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.container&&e.container]}}),componentName:"MuiGrid",useThemeProps:t=>_i({props:t,name:"MuiGrid"}),useTheme:kc});function UP(t){return`scale(${t}, ${t**2})`}const sde={entering:{opacity:1,transform:UP(1)},entered:{opacity:1,transform:"none"}},y3=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),J1=ee.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:a,easing:s,in:o,onEnter:u,onEntered:h,onEntering:f,onExit:d,onExited:b,onExiting:v,style:S,timeout:E="auto",TransitionComponent:P=Lh,...k}=e,L=Lp(),N=ee.useRef(),M=kc(),z=ee.useRef(null),B=Bo(z,ug(a),r),q=ue=>de=>{if(ue){const Pe=z.current;de===void 0?ue(Pe):ue(Pe,de)}},W=q(f),G=q((ue,de)=>{WR(ue);const{duration:Pe,delay:me,easing:Ee}=Gd({style:S,timeout:E,easing:s},{mode:"enter"});let we;E==="auto"?(we=M.transitions.getAutoHeightDuration(ue.clientHeight),N.current=we):we=Pe,ue.style.transition=[M.transitions.create("opacity",{duration:we,delay:me}),M.transitions.create("transform",{duration:y3?we:we*.666,delay:me,easing:Ee})].join(","),u&&u(ue,de)}),ie=q(h),J=q(v),H=q(ue=>{const{duration:de,delay:Pe,easing:me}=Gd({style:S,timeout:E,easing:s},{mode:"exit"});let Ee;E==="auto"?(Ee=M.transitions.getAutoHeightDuration(ue.clientHeight),N.current=Ee):Ee=de,ue.style.transition=[M.transitions.create("opacity",{duration:Ee,delay:Pe}),M.transitions.create("transform",{duration:y3?Ee:Ee*.666,delay:y3?Pe:Pe||Ee*.333,easing:me})].join(","),ue.style.opacity=0,ue.style.transform=UP(.75),d&&d(ue)}),ne=q(b),ae=ue=>{E==="auto"&&L.start(N.current||0,ue),n&&n(z.current,ue)};return Z.jsx(P,{appear:i,in:o,nodeRef:z,onEnter:G,onEntered:ie,onEntering:W,onExit:H,onExited:ne,onExiting:J,addEndListener:ae,timeout:E==="auto"?null:E,...k,children:(ue,{ownerState:de,...Pe})=>ee.cloneElement(a,{style:{opacity:0,transform:UP(.75),visibility:ue==="exited"&&!o?"hidden":void 0,...sde[ue],...S,...a.props.style},ref:B,...Pe})})});J1&&(J1.muiSupportAuto=!0);const lde=t=>{const{classes:e,disableUnderline:r}=t,i=gi({root:["root",!r&&"underline"],input:["input"]},ehe,e);return{...e,...i}},ude=Br(tT,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...QE(t,e),!r.disableUnderline&&e.underline]}})(ui(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${m_.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${m_.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${m_.disabled}, .${m_.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${m_.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Bl()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}))]}})),cde=Br(rT,{name:"MuiInput",slot:"Input",overridesResolver:eT})({}),sO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,inputComponent:u="input",multiline:h=!1,slotProps:f,slots:d={},type:b="text",...v}=n,S=lde(n),P={root:{ownerState:{disableUnderline:i}}},k=f??s?Wu(f??s,P):P,L=d.root??a.Root??ude,N=d.input??a.Input??cde;return Z.jsx(tO,{slots:{root:L,input:N},slotProps:k,fullWidth:o,inputComponent:u,multiline:h,ref:r,type:b,...v,classes:S})});sO.muiName="Input";function hde(t){return pi("MuiInputLabel",t)}fi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const fde=t=>{const{classes:e,formControl:r,size:n,shrink:i,disableAnimation:a,variant:s,required:o}=t,u={root:["root",r&&"formControl",!a&&"animated",i&&"shrink",n&&n!=="medium"&&`size${pn(n)}`,s],asterisk:[o&&"asterisk"]},h=gi(u,hde,e);return{...e,...h}},dde=Br(LG,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${S1.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(ui(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:n})=>e==="filled"&&r.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),qp=ee.forwardRef(function(e,r){const n=_i({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,margin:a,shrink:s,variant:o,className:u,...h}=n,f=od();let d=s;typeof d>"u"&&f&&(d=f.filled||f.focused||f.adornedStart);const b=cg({props:n,muiFormControl:f,states:["size","variant","required","focused"]}),v={...n,disableAnimation:i,formControl:f,shrink:d,size:b.size,variant:b.variant,required:b.required,focused:b.focused},S=fde(v);return Z.jsx(dde,{"data-shrink":d,ref:r,className:An(S.root,u),...h,ownerState:v,classes:S})}),_h=ee.createContext({});function pde(t){return pi("MuiList",t)}fi("MuiList",["root","padding","dense","subheader"]);const gde=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return gi({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},pde,e)},mde=Br("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),ff=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiList"}),{children:i,className:a,component:s="ul",dense:o=!1,disablePadding:u=!1,subheader:h,...f}=n,d=ee.useMemo(()=>({dense:o}),[o]),b={...n,component:s,dense:o,disablePadding:u},v=gde(b);return Z.jsx(_h.Provider,{value:d,children:Z.jsxs(mde,{as:s,className:An(v.root,a),ref:r,ownerState:b,...f,children:[h,i]})})});function yde(t){return pi("MuiListItem",t)}fi("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function vde(t){return pi("MuiListItemButton",t)}const Yy=fi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),_de=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters]},bde=t=>{const{alignItems:e,classes:r,dense:n,disabled:i,disableGutters:a,divider:s,selected:o}=t,h=gi({root:["root",n&&"dense",!a&&"gutters",s&&"divider",i&&"disabled",e==="flex-start"&&"alignItemsFlexStart",o&&"selected"]},vde,r);return{...r,...h}},xde=Br(I0,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:_de})(ui(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Yy.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Yy.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${Yy.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${Yy.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Yy.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),DG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:s="div",children:o,dense:u=!1,disableGutters:h=!1,divider:f=!1,focusVisibleClassName:d,selected:b=!1,className:v,...S}=n,E=ee.useContext(_h),P=ee.useMemo(()=>({dense:u||E.dense||!1,alignItems:i,disableGutters:h}),[i,E.dense,u,h]),k=ee.useRef(null);vu(()=>{a&&k.current&&k.current.focus()},[a]);const L={...n,alignItems:i,dense:P.dense,disableGutters:h,divider:f,selected:b},N=bde(L),M=Bo(k,r);return Z.jsx(_h.Provider,{value:P,children:Z.jsx(xde,{ref:M,href:S.href||S.to,component:(S.href||S.to)&&s==="div"?"button":s,focusVisibleClassName:An(N.focusVisible,d),ownerState:L,className:An(N.root,v),...S,classes:N,children:o})})});function wde(t){return pi("MuiListItemSecondaryAction",t)}fi("MuiListItemSecondaryAction",["root","disableGutters"]);const Sde=t=>{const{disableGutters:e,classes:r}=t;return gi({root:["root",e&&"disableGutters"]},wde,r)},Ede=Br("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),FG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...a}=n,s=ee.useContext(_h),o={...n,disableGutters:s.disableGutters},u=Sde(o);return Z.jsx(Ede,{className:An(u.root,i),ownerState:o,ref:r,...a})});FG.muiName="ListItemSecondaryAction";const Tde=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},Cde=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:a,divider:s,hasSecondaryAction:o}=t;return gi({root:["root",n&&"dense",!i&&"gutters",!a&&"padding",s&&"divider",e==="flex-start"&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},yde,r)},Ade=Br("div",{name:"MuiListItem",slot:"Root",overridesResolver:Tde})(ui(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Yy.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Ide=Br("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Ah=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItem"}),{alignItems:i="center",children:a,className:s,component:o,components:u={},componentsProps:h={},ContainerComponent:f="li",ContainerProps:{className:d,...b}={},dense:v=!1,disableGutters:S=!1,disablePadding:E=!1,divider:P=!1,secondaryAction:k,slotProps:L={},slots:N={},...M}=n,z=ee.useContext(_h),B=ee.useMemo(()=>({dense:v||z.dense||!1,alignItems:i,disableGutters:S}),[i,z.dense,v,S]),q=ee.useRef(null),W=ee.Children.toArray(a),G=W.length&&_1(W[W.length-1],["ListItemSecondaryAction"]),ie={...n,alignItems:i,dense:B.dense,disableGutters:S,disablePadding:E,divider:P,hasSecondaryAction:G},J=Cde(ie),H=Bo(q,r),ne=N.root||u.Root||Ade,ae=L.root||h.root||{},ue={className:An(J.root,ae.className,s),...M};let de=o||"li";return G?(de=!ue.component&&!o?"div":de,f==="li"&&(de==="li"?de="div":ue.component==="li"&&(ue.component="div")),Z.jsx(_h.Provider,{value:B,children:Z.jsxs(Ide,{as:f,className:An(J.container,d),ref:H,ownerState:ie,...b,children:[Z.jsx(ne,{...ae,...!Yf(ne)&&{as:de,ownerState:{...ie,...ae.ownerState}},...ue,children:W}),W.pop()]})})):Z.jsx(_h.Provider,{value:B,children:Z.jsxs(ne,{...ae,as:de,ref:H,...!Yf(ne)&&{ownerState:{...ie,...ae.ownerState}},...ue,children:[W,k&&Z.jsx(FG,{children:k})]})})});function Pde(t){return pi("MuiListItemAvatar",t)}fi("MuiListItemAvatar",["root","alignItemsFlexStart"]);const kde=t=>{const{alignItems:e,classes:r}=t;return gi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Pde,r)},Mde=Br("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),BG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemAvatar"}),{className:i,...a}=n,s=ee.useContext(_h),o={...n,alignItems:s.alignItems},u=kde(o);return Z.jsx(Mde,{className:An(u.root,i),ownerState:o,ref:r,...a})});function Rde(t){return pi("MuiListItemIcon",t)}const y8=fi("MuiListItemIcon",["root","alignItemsFlexStart"]),Ode=t=>{const{alignItems:e,classes:r}=t;return gi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Rde,r)},Nde=Br("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(ui(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Q1=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemIcon"}),{className:i,...a}=n,s=ee.useContext(_h),o={...n,alignItems:s.alignItems},u=Ode(o);return Z.jsx(Nde,{className:An(u.root,i),ownerState:o,ref:r,...a})});function Lde(t){return pi("MuiListItemText",t)}const vv=fi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Dde=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:a}=t;return gi({root:["root",r&&"inset",a&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Lde,e)},Fde=Br("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${vv.primary}`]:e.primary},{[`& .${vv.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${GF.root}:where(& .${vv.primary})`]:{display:"block"},[`.${GF.root}:where(& .${vv.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),mh=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemText"}),{children:i,className:a,disableTypography:s=!1,inset:o=!1,primary:u,primaryTypographyProps:h,secondary:f,secondaryTypographyProps:d,slots:b={},slotProps:v={},...S}=n,{dense:E}=ee.useContext(_h);let P=u??i,k=f;const L={...n,disableTypography:s,inset:o,primary:!!P,secondary:!!k,dense:E},N=Dde(L),M={slots:b,slotProps:{primary:h,secondary:d,...v}},[z,B]=Ei("root",{className:An(N.root,a),elementType:Fde,externalForwardedProps:{...M,...S},ownerState:L,ref:r}),[q,W]=Ei("primary",{className:N.primary,elementType:bs,externalForwardedProps:M,ownerState:L}),[G,ie]=Ei("secondary",{className:N.secondary,elementType:bs,externalForwardedProps:M,ownerState:L});return P!=null&&P.type!==bs&&!s&&(P=Z.jsx(q,{variant:E?"body2":"body1",component:W?.variant?void 0:"span",...W,children:P})),k!=null&&k.type!==bs&&!s&&(k=Z.jsx(G,{variant:"body2",color:"textSecondary",...ie,children:k})),Z.jsxs(z,{...B,children:[P,k]})});function v3(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function v8(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function zG(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function y_(t,e,r,n,i,a){let s=!1,o=i(t,e,e?r:!1);for(;o;){if(o===t.firstChild){if(s)return!1;s=!0}const u=n?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!zG(o,a)||u)o=i(t,o,r);else return o.focus(),!0}return!1}const Bde=ee.forwardRef(function(e,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:s,className:o,disabledItemsFocusable:u=!1,disableListWrap:h=!1,onKeyDown:f,variant:d="selectedMenu",...b}=e,v=ee.useRef(null),S=ee.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});vu(()=>{i&&v.current.focus()},[i]),ee.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(N,{direction:M})=>{const z=!v.current.style.width;if(N.clientHeight<v.current.clientHeight&&z){const B=`${kG(lc(N))}px`;v.current.style[M==="rtl"?"paddingLeft":"paddingRight"]=B,v.current.style.width=`calc(100% + ${B})`}return v.current}}),[]);const E=N=>{const M=v.current,z=N.key;if(N.ctrlKey||N.metaKey||N.altKey){f&&f(N);return}const q=is(M).activeElement;if(z==="ArrowDown")N.preventDefault(),y_(M,q,h,u,v3);else if(z==="ArrowUp")N.preventDefault(),y_(M,q,h,u,v8);else if(z==="Home")N.preventDefault(),y_(M,null,h,u,v3);else if(z==="End")N.preventDefault(),y_(M,null,h,u,v8);else if(z.length===1){const W=S.current,G=z.toLowerCase(),ie=performance.now();W.keys.length>0&&(ie-W.lastTime>500?(W.keys=[],W.repeating=!0,W.previousKeyMatched=!0):W.repeating&&G!==W.keys[0]&&(W.repeating=!1)),W.lastTime=ie,W.keys.push(G);const J=q&&!W.repeating&&zG(q,W);W.previousKeyMatched&&(J||y_(M,q,!1,u,v3,W))?N.preventDefault():W.previousKeyMatched=!1}f&&f(N)},P=Bo(v,r);let k=-1;ee.Children.forEach(s,(N,M)=>{if(!ee.isValidElement(N)){k===M&&(k+=1,k>=s.length&&(k=-1));return}N.props.disabled||(d==="selectedMenu"&&N.props.selected||k===-1)&&(k=M),k===M&&(N.props.disabled||N.props.muiSkipListHighlight||N.type.muiSkipListHighlight)&&(k+=1,k>=s.length&&(k=-1))});const L=ee.Children.map(s,(N,M)=>{if(M===k){const z={};return a&&(z.autoFocus=!0),N.props.tabIndex===void 0&&d==="selectedMenu"&&(z.tabIndex=0),ee.cloneElement(N,z)}return N});return Z.jsx(ff,{role:"menu",ref:P,className:o,onKeyDown:E,tabIndex:i?0:-1,...b,children:L})});function zde(t){return pi("MuiPopover",t)}fi("MuiPopover",["root","paper"]);function _8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function b8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function x8(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function Wx(t){return typeof t=="function"?t():t}const jde=t=>{const{classes:e}=t;return gi({root:["root"],paper:["paper"]},zde,e)},Ude=Br(rO,{name:"MuiPopover",slot:"Root"})({}),jG=Br(Eh,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Vde=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiPopover"}),{action:i,anchorEl:a,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:u="anchorEl",children:h,className:f,container:d,elevation:b=8,marginThreshold:v=16,open:S,PaperProps:E={},slots:P={},slotProps:k={},transformOrigin:L={vertical:"top",horizontal:"left"},TransitionComponent:N,transitionDuration:M="auto",TransitionProps:z={},disableScrollLock:B=!1,...q}=n,W=ee.useRef(),G={...n,anchorOrigin:s,anchorReference:u,elevation:b,marginThreshold:v,transformOrigin:L,TransitionComponent:N,transitionDuration:M,TransitionProps:z},ie=jde(G),J=ee.useCallback(()=>{if(u==="anchorPosition")return o;const Ze=Wx(a),Ie=(Ze&&Ze.nodeType===1?Ze:is(W.current).body).getBoundingClientRect();return{top:Ie.top+_8(Ie,s.vertical),left:Ie.left+b8(Ie,s.horizontal)}},[a,s.horizontal,s.vertical,o,u]),H=ee.useCallback(Ze=>({vertical:_8(Ze,L.vertical),horizontal:b8(Ze,L.horizontal)}),[L.horizontal,L.vertical]),ne=ee.useCallback(Ze=>{const Qe={width:Ze.offsetWidth,height:Ze.offsetHeight},Ie=H(Qe);if(u==="none")return{top:null,left:null,transformOrigin:x8(Ie)};const Lt=J();let at=Lt.top-Ie.vertical,Ve=Lt.left-Ie.horizontal;const nr=at+Qe.height,Yt=Ve+Qe.width,yr=lc(Wx(a)),mt=yr.innerHeight-v,br=yr.innerWidth-v;if(v!==null&&at<v){const Tr=at-v;at-=Tr,Ie.vertical+=Tr}else if(v!==null&&nr>mt){const Tr=nr-mt;at-=Tr,Ie.vertical+=Tr}if(v!==null&&Ve<v){const Tr=Ve-v;Ve-=Tr,Ie.horizontal+=Tr}else if(Yt>br){const Tr=Yt-br;Ve-=Tr,Ie.horizontal+=Tr}return{top:`${Math.round(at)}px`,left:`${Math.round(Ve)}px`,transformOrigin:x8(Ie)}},[a,u,J,H,v]),[ae,ue]=ee.useState(S),de=ee.useCallback(()=>{const Ze=W.current;if(!Ze)return;const Qe=ne(Ze);Qe.top!==null&&Ze.style.setProperty("top",Qe.top),Qe.left!==null&&(Ze.style.left=Qe.left),Ze.style.transformOrigin=Qe.transformOrigin,ue(!0)},[ne]);ee.useEffect(()=>(B&&window.addEventListener("scroll",de),()=>window.removeEventListener("scroll",de)),[a,B,de]);const Pe=()=>{de()},me=()=>{ue(!1)};ee.useEffect(()=>{S&&de()}),ee.useImperativeHandle(i,()=>S?{updatePosition:()=>{de()}}:null,[S,de]),ee.useEffect(()=>{if(!S)return;const Ze=$R(()=>{de()}),Qe=lc(Wx(a));return Qe.addEventListener("resize",Ze),()=>{Ze.clear(),Qe.removeEventListener("resize",Ze)}},[a,S,de]);let Ee=M;const we={slots:{transition:N,...P},slotProps:{transition:z,paper:E,...k}},[Ae,ce]=Ei("transition",{elementType:J1,externalForwardedProps:we,ownerState:G,getSlotProps:Ze=>({...Ze,onEntering:(Qe,Ie)=>{Ze.onEntering?.(Qe,Ie),Pe()},onExited:Qe=>{Ze.onExited?.(Qe),me()}}),additionalProps:{appear:!0,in:S}});M==="auto"&&!Ae.muiSupportAuto&&(Ee=void 0);const xe=d||(a?is(Wx(a)).body:void 0),[_e,{slots:Me,slotProps:Re,...He}]=Ei("root",{ref:r,elementType:Ude,externalForwardedProps:{...we,...q},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:P.backdrop},slotProps:{backdrop:Y1(typeof k.backdrop=="function"?k.backdrop(G):k.backdrop,{invisible:!0})},container:xe,open:S},ownerState:G,className:An(ie.root,f)}),[Fe,tt]=Ei("paper",{ref:W,className:ie.paper,elementType:jG,externalForwardedProps:we,shouldForwardComponentProp:!0,additionalProps:{elevation:b,style:ae?void 0:{opacity:0}},ownerState:G});return Z.jsx(_e,{...He,...!Yf(_e)&&{slots:Me,slotProps:Re,disableScrollLock:B},children:Z.jsx(Ae,{...ce,timeout:Ee,children:Z.jsx(Fe,{...tt,children:h})})})});function $de(t){return pi("MuiMenu",t)}fi("MuiMenu",["root","paper","list"]);const qde={vertical:"top",horizontal:"right"},Hde={vertical:"top",horizontal:"left"},Wde=t=>{const{classes:e}=t;return gi({root:["root"],paper:["paper"],list:["list"]},$de,e)},Gde=Br(Vde,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),Xde=Br(jG,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Yde=Br(Bde,{name:"MuiMenu",slot:"List"})({outline:0}),UG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:s,disableAutoFocusItem:o=!1,MenuListProps:u={},onClose:h,open:f,PaperProps:d={},PopoverClasses:b,transitionDuration:v="auto",TransitionProps:{onEntering:S,...E}={},variant:P="selectedMenu",slots:k={},slotProps:L={},...N}=n,M=$b(),z={...n,autoFocus:i,disableAutoFocusItem:o,MenuListProps:u,onEntering:S,PaperProps:d,transitionDuration:v,TransitionProps:E,variant:P},B=Wde(z),q=i&&!o&&f,W=ee.useRef(null),G=(Ee,we)=>{W.current&&W.current.adjustStyleForScrollbar(Ee,{direction:M?"rtl":"ltr"}),S&&S(Ee,we)},ie=Ee=>{Ee.key==="Tab"&&(Ee.preventDefault(),h&&h(Ee,"tabKeyDown"))};let J=-1;ee.Children.map(a,(Ee,we)=>{ee.isValidElement(Ee)&&(Ee.props.disabled||(P==="selectedMenu"&&Ee.props.selected||J===-1)&&(J=we))});const H={slots:k,slotProps:{list:u,transition:E,paper:d,...L}},ne=Bf({elementType:k.root,externalSlotProps:L.root,ownerState:z,className:[B.root,s]}),[ae,ue]=Ei("paper",{className:B.paper,elementType:Xde,externalForwardedProps:H,shouldForwardComponentProp:!0,ownerState:z}),[de,Pe]=Ei("list",{className:An(B.list,u.className),elementType:Yde,shouldForwardComponentProp:!0,externalForwardedProps:H,getSlotProps:Ee=>({...Ee,onKeyDown:we=>{ie(we),Ee.onKeyDown?.(we)}}),ownerState:z}),me=typeof H.slotProps.transition=="function"?H.slotProps.transition(z):H.slotProps.transition;return Z.jsx(Gde,{onClose:h,anchorOrigin:{vertical:"bottom",horizontal:M?"right":"left"},transformOrigin:M?qde:Hde,slots:{root:k.root,paper:ae,backdrop:k.backdrop,...k.transition&&{transition:k.transition}},slotProps:{root:ne,paper:ue,backdrop:typeof L.backdrop=="function"?L.backdrop(z):L.backdrop,transition:{...me,onEntering:(...Ee)=>{G(...Ee),me?.onEntering?.(...Ee)}}},open:f,ref:r,transitionDuration:v,ownerState:z,...N,classes:b,children:Z.jsx(de,{actions:W,autoFocus:i&&(J===-1||o),autoFocusItem:q,variant:P,...Pe,children:a})})});function Zde(t){return pi("MuiMenuItem",t)}const v_=fi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Kde=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},Jde=t=>{const{disabled:e,dense:r,divider:n,disableGutters:i,selected:a,classes:s}=t,u=gi({root:["root",r&&"dense",e&&"disabled",!i&&"gutters",n&&"divider",a&&"selected"]},Zde,s);return{...s,...u}},Qde=Br(I0,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Kde})(ui(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${v_.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${v_.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${v_.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${v_.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${v_.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${p8.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${p8.inset}`]:{marginLeft:52},[`& .${vv.root}`]:{marginTop:0,marginBottom:0},[`& .${vv.inset}`]:{paddingLeft:36},[`& .${y8.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${y8.root} svg`]:{fontSize:"1.25rem"}}}]}))),im=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:s=!1,divider:o=!1,disableGutters:u=!1,focusVisibleClassName:h,role:f="menuitem",tabIndex:d,className:b,...v}=n,S=ee.useContext(_h),E=ee.useMemo(()=>({dense:s||S.dense||!1,disableGutters:u}),[S.dense,s,u]),P=ee.useRef(null);vu(()=>{i&&P.current&&P.current.focus()},[i]);const k={...n,dense:E.dense,divider:o,disableGutters:u},L=Jde(n),N=Bo(P,r);let M;return n.disabled||(M=d!==void 0?d:-1),Z.jsx(_h.Provider,{value:E,children:Z.jsx(Qde,{ref:N,role:f,tabIndex:M,component:a,focusVisibleClassName:An(L.focusVisible,h),className:An(L.root,b),...v,ownerState:k,classes:L})})});function epe(t){return pi("MuiNativeSelect",t)}const lO=fi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),tpe=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${pn(r)}`,a&&"iconOpen",n&&"disabled"]};return gi(o,epe,e)},VG=Br("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${lO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),rpe=Br(VG,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:_l,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${lO.multiple}`]:e.multiple}]}})({}),$G=Br("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${lO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),npe=Br($G,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${pn(r.variant)}`],r.open&&e.iconOpen]}})({}),ipe=ee.forwardRef(function(e,r){const{className:n,disabled:i,error:a,IconComponent:s,inputRef:o,variant:u="standard",...h}=e,f={...e,disabled:i,variant:u,error:a},d=tpe(f);return Z.jsxs(ee.Fragment,{children:[Z.jsx(rpe,{ownerState:f,className:An(d.select,n),disabled:i,ref:o||r,...h}),e.multiple?null:Z.jsx(npe,{as:s,ownerState:f,className:d.icon})]})});function ape(t){const{children:e,defer:r=!1,fallback:n=null}=t,[i,a]=ee.useState(!1);return vu(()=>{r||a(!0)},[r]),ee.useEffect(()=>{r&&a(!0)},[r]),i?e:n}var w8;const ope=Br("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:_l})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),spe=Br("legend",{name:"MuiNotchedOutlined",shouldForwardProp:_l})(ui(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function lpe(t){const{children:e,classes:r,className:n,label:i,notched:a,...s}=t,o=i!=null&&i!=="",u={...t,notched:a,withLabel:o};return Z.jsx(ope,{"aria-hidden":!0,className:n,ownerState:u,...s,children:Z.jsx(spe,{ownerState:u,children:o?Z.jsx("span",{children:i}):w8||(w8=Z.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"}))})})}const upe=t=>{const{classes:e}=t,n=gi({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},the,e);return{...e,...n}},cpe=Br(tT,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:QE})(ui(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Of.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Of.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${Of.focused} .${Of.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(Bl()).map(([r])=>({props:{color:r},style:{[`&.${Of.focused} .${Of.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${Of.error} .${Of.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Of.disabled} .${Of.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:n})=>r.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),hpe=Br(lpe,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(ui(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),fpe=Br(rT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:eT})(ui(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),nT=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:a=!1,inputComponent:s="input",label:o,multiline:u=!1,notched:h,slots:f={},slotProps:d={},type:b="text",...v}=n,S=upe(n),E=od(),P=cg({props:n,muiFormControl:E,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),k={...n,color:P.color||"primary",disabled:P.disabled,error:P.error,focused:P.focused,formControl:E,fullWidth:a,hiddenLabel:P.hiddenLabel,multiline:u,size:P.size,type:b},L=f.root??i.Root??cpe,N=f.input??i.Input??fpe,[M,z]=Ei("notchedOutline",{elementType:hpe,className:S.notchedOutline,shouldForwardComponentProp:!0,ownerState:k,externalForwardedProps:{slots:f,slotProps:d},additionalProps:{label:o!=null&&o!==""&&P.required?Z.jsxs(ee.Fragment,{children:[o," ","*"]}):o}});return Z.jsx(tO,{slots:{root:L,input:N},slotProps:d,renderSuffix:B=>Z.jsx(M,{...z,notched:typeof h<"u"?h:!!(B.startAdornment||B.filled||B.focused)}),fullWidth:a,inputComponent:s,multiline:u,ref:r,type:b,...v,classes:{...S,notchedOutline:null}})});nT.muiName="Input";const dpe=Yi(Z.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),ppe=Yi(Z.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),gpe=Br("span",{name:"MuiRadioButtonIcon",shouldForwardProp:_l})({position:"relative",display:"flex"}),mpe=Br(dpe,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),ype=Br(ppe,{name:"MuiRadioButtonIcon"})(ui(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function qG(t){const{checked:e=!1,classes:r={},fontSize:n}=t,i={...t,checked:e};return Z.jsxs(gpe,{className:r.root,ownerState:i,children:[Z.jsx(mpe,{fontSize:n,className:r.background,ownerState:i}),Z.jsx(ype,{fontSize:n,className:r.dot,ownerState:i})]})}const HG=ee.createContext(void 0);function vpe(){return ee.useContext(HG)}function _pe(t){return pi("MuiRadio",t)}const S8=fi("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),bpe=t=>{const{classes:e,color:r,size:n}=t,i={root:["root",`color${pn(r)}`,n!=="medium"&&`size${pn(n)}`]};return{...e,...gi(i,_pe,e)}},xpe=Br(PG,{shouldForwardProp:t=>_l(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${pn(r.size)}`],e[`color${pn(r.color)}`]]}})(ui(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${S8.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${S8.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function wpe(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const Spe=Z.jsx(qG,{checked:!0}),Epe=Z.jsx(qG,{}),E8=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiRadio"}),{checked:i,checkedIcon:a=Spe,color:s="primary",icon:o=Epe,name:u,onChange:h,size:f="medium",className:d,disabled:b,disableRipple:v=!1,slots:S={},slotProps:E={},inputProps:P,...k}=n,L=od();let N=b;L&&typeof N>"u"&&(N=L.disabled),N??=!1;const M={...n,disabled:N,disableRipple:v,color:s,size:f},z=bpe(M),B=vpe();let q=i;const W=CP(h,B&&B.onChange);let G=u;B&&(typeof q>"u"&&(q=wpe(B.value,n.value)),typeof G>"u"&&(G=B.name));const ie=E.input??P,[J,H]=Ei("root",{ref:r,elementType:xpe,className:An(z.root,d),shouldForwardComponentProp:!0,externalForwardedProps:{slots:S,slotProps:E,...k},getSlotProps:ne=>({...ne,onChange:(ae,...ue)=>{ne.onChange?.(ae,...ue),W(ae,...ue)}}),ownerState:M,additionalProps:{type:"radio",icon:ee.cloneElement(o,{fontSize:o.props.fontSize??f}),checkedIcon:ee.cloneElement(a,{fontSize:a.props.fontSize??f}),disabled:N,name:G,checked:q,slots:S,slotProps:{input:typeof ie=="function"?ie(M):ie}}});return Z.jsx(J,{...H,classes:z})});function Tpe(t){return pi("MuiRadioGroup",t)}fi("MuiRadioGroup",["root","row","error"]);const Cpe=t=>{const{classes:e,row:r,error:n}=t;return gi({root:["root",r&&"row",n&&"error"]},Tpe,e)},Ape=ee.forwardRef(function(e,r){const{actions:n,children:i,className:a,defaultValue:s,name:o,onChange:u,value:h,...f}=e,d=ee.useRef(null),b=Cpe(e),[v,S]=pm({controlled:h,default:s,name:"RadioGroup"});ee.useImperativeHandle(n,()=>({focus:()=>{let L=d.current.querySelector("input:not(:disabled):checked");L||(L=d.current.querySelector("input:not(:disabled)")),L&&L.focus()}}),[]);const E=Bo(r,d),P=og(o),k=ee.useMemo(()=>({name:P,onChange(L){S(L.target.value),u&&u(L,L.target.value)},value:v}),[P,u,S,v]);return Z.jsx(HG.Provider,{value:k,children:Z.jsx(NG,{role:"radiogroup",ref:E,className:An(b.root,a),...f,children:i})})}),Ipe={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function WG(t){return pi("MuiSelect",t)}const __=fi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var T8;const Ppe=Br(VG,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${__.select}`]:e.select},{[`&.${__.select}`]:e[r.variant]},{[`&.${__.error}`]:e.error},{[`&.${__.multiple}`]:e.multiple}]}})({[`&.${__.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),kpe=Br($G,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${pn(r.variant)}`],r.open&&e.iconOpen]}})({}),Mpe=Br("input",{shouldForwardProp:t=>XE(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function C8(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Rpe(t){return t==null||typeof t=="string"&&!t.trim()}const Ope=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${pn(r)}`,a&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return gi(o,WG,e)},Npe=ee.forwardRef(function(e,r){const{"aria-describedby":n,"aria-label":i,autoFocus:a,autoWidth:s,children:o,className:u,defaultOpen:h,defaultValue:f,disabled:d,displayEmpty:b,error:v=!1,IconComponent:S,inputRef:E,labelId:P,MenuProps:k={},multiple:L,name:N,onBlur:M,onChange:z,onClose:B,onFocus:q,onOpen:W,open:G,readOnly:ie,renderValue:J,required:H,SelectDisplayProps:ne={},tabIndex:ae,type:ue,value:de,variant:Pe="standard",...me}=e,[Ee,we]=pm({controlled:de,default:f,name:"Select"}),[Ae,ce]=pm({controlled:G,default:h,name:"Select"}),xe=ee.useRef(null),_e=ee.useRef(null),[Me,Re]=ee.useState(null),{current:He}=ee.useRef(G!=null),[Fe,tt]=ee.useState(),Ze=Bo(r,E),Qe=ee.useCallback(Ne=>{_e.current=Ne,Ne&&Re(Ne)},[]),Ie=Me?.parentNode;ee.useImperativeHandle(Ze,()=>({focus:()=>{_e.current.focus()},node:xe.current,value:Ee}),[Ee]),ee.useEffect(()=>{h&&Ae&&Me&&!He&&(tt(s?null:Ie.clientWidth),_e.current.focus())},[Me,s]),ee.useEffect(()=>{a&&_e.current.focus()},[a]),ee.useEffect(()=>{if(!P)return;const Ne=is(_e.current).getElementById(P);if(Ne){const rt=()=>{getSelection().isCollapsed&&_e.current.focus()};return Ne.addEventListener("click",rt),()=>{Ne.removeEventListener("click",rt)}}},[P]);const Lt=(Ne,rt)=>{Ne?W&&W(rt):B&&B(rt),He||(tt(s?null:Ie.clientWidth),ce(Ne))},at=Ne=>{Ne.button===0&&(Ne.preventDefault(),_e.current.focus(),Lt(!0,Ne))},Ve=Ne=>{Lt(!1,Ne)},nr=ee.Children.toArray(o),Yt=Ne=>{const rt=nr.find(pt=>pt.props.value===Ne.target.value);rt!==void 0&&(we(rt.props.value),z&&z(Ne,rt))},yr=Ne=>rt=>{let pt;if(rt.currentTarget.hasAttribute("tabindex")){if(L){pt=Array.isArray(Ee)?Ee.slice():[];const Rt=Ee.indexOf(Ne.props.value);Rt===-1?pt.push(Ne.props.value):pt.splice(Rt,1)}else pt=Ne.props.value;if(Ne.props.onClick&&Ne.props.onClick(rt),Ee!==pt&&(we(pt),z)){const Rt=rt.nativeEvent||rt,Bt=new Rt.constructor(Rt.type,Rt);Object.defineProperty(Bt,"target",{writable:!0,value:{value:pt,name:N}}),z(Bt,Ne)}L||Lt(!1,rt)}},mt=Ne=>{ie||[" ","ArrowUp","ArrowDown","Enter"].includes(Ne.key)&&(Ne.preventDefault(),Lt(!0,Ne))},br=Me!==null&&Ae,Tr=Ne=>{!br&&M&&(Object.defineProperty(Ne,"target",{writable:!0,value:{value:Ee,name:N}}),M(Ne))};delete me["aria-invalid"];let mr,Mr;const Pr=[];let ar=!1;(Yw({value:Ee})||b)&&(J?mr=J(Ee):ar=!0);const fr=nr.map(Ne=>{if(!ee.isValidElement(Ne))return null;let rt;if(L){if(!Array.isArray(Ee))throw new Error(Hd(2));rt=Ee.some(pt=>C8(pt,Ne.props.value)),rt&&ar&&Pr.push(Ne.props.children)}else rt=C8(Ee,Ne.props.value),rt&&ar&&(Mr=Ne.props.children);return ee.cloneElement(Ne,{"aria-selected":rt?"true":"false",onClick:yr(Ne),onKeyUp:pt=>{pt.key===" "&&pt.preventDefault(),Ne.props.onKeyUp&&Ne.props.onKeyUp(pt)},role:"option",selected:rt,value:void 0,"data-value":Ne.props.value})});ar&&(L?Pr.length===0?mr=null:mr=Pr.reduce((Ne,rt,pt)=>(Ne.push(rt),pt<Pr.length-1&&Ne.push(", "),Ne),[]):mr=Mr);let Nr=Fe;!s&&He&&Me&&(Nr=Ie.clientWidth);let or;typeof ae<"u"?or=ae:or=d?null:0;const Dr=ne.id||(N?`mui-component-select-${N}`:void 0),er={...e,variant:Pe,value:Ee,open:br,error:v},Gt=Ope(er),Tt={...k.PaperProps,...typeof k.slotProps?.paper=="function"?k.slotProps.paper(er):k.slotProps?.paper},Oe={...k.MenuListProps,...typeof k.slotProps?.list=="function"?k.slotProps.list(er):k.slotProps?.list},Be=og();return Z.jsxs(ee.Fragment,{children:[Z.jsx(Ppe,{as:"div",ref:Qe,tabIndex:or,role:"combobox","aria-controls":br?Be:void 0,"aria-disabled":d?"true":void 0,"aria-expanded":br?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[P,Dr].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":H?"true":void 0,"aria-invalid":v?"true":void 0,onKeyDown:mt,onMouseDown:d||ie?null:at,onBlur:Tr,onFocus:q,...ne,ownerState:er,className:An(ne.className,Gt.select,u),id:Dr,children:Rpe(mr)?T8||(T8=Z.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):mr}),Z.jsx(Mpe,{"aria-invalid":v,value:Array.isArray(Ee)?Ee.join(","):Ee,name:N,ref:xe,"aria-hidden":!0,onChange:Yt,tabIndex:-1,disabled:d,className:Gt.nativeInput,autoFocus:a,required:H,...me,ownerState:er}),Z.jsx(kpe,{as:S,className:Gt.icon,ownerState:er}),Z.jsx(UG,{id:`menu-${N||""}`,anchorEl:Ie,open:br,onClose:Ve,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...k,slotProps:{...k.slotProps,list:{"aria-labelledby":P,role:"listbox","aria-multiselectable":L?"true":void 0,disableListWrap:!0,id:Be,...Oe},paper:{...Tt,style:{minWidth:Nr,...Tt!=null?Tt.style:null}}},children:fr})]})}),Lpe=t=>{const{classes:e}=t,n=gi({root:["root"]},WG,e);return{...e,...n}},uO={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>_l(t)&&t!=="variant"},Dpe=Br(sO,uO)(""),Fpe=Br(nT,uO)(""),Bpe=Br(oO,uO)(""),Hp=ee.forwardRef(function(e,r){const n=_i({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:s={},className:o,defaultOpen:u=!1,displayEmpty:h=!1,IconComponent:f=nhe,id:d,input:b,inputProps:v,label:S,labelId:E,MenuProps:P,multiple:k=!1,native:L=!1,onClose:N,onOpen:M,open:z,renderValue:B,SelectDisplayProps:q,variant:W="outlined",...G}=n,ie=L?ipe:Npe,J=od(),H=cg({props:n,muiFormControl:J,states:["variant","error"]}),ne=H.variant||W,ae={...n,variant:ne,classes:s},ue=Lpe(ae),{root:de,...Pe}=ue,me=b||{standard:Z.jsx(Dpe,{ownerState:ae}),outlined:Z.jsx(Fpe,{label:S,ownerState:ae}),filled:Z.jsx(Bpe,{ownerState:ae})}[ne],Ee=Bo(r,ug(me));return Z.jsx(ee.Fragment,{children:ee.cloneElement(me,{inputComponent:ie,inputProps:{children:a,error:H.error,IconComponent:f,variant:ne,type:void 0,multiple:k,...L?{id:d}:{autoWidth:i,defaultOpen:u,displayEmpty:h,labelId:E,MenuProps:P,onClose:N,onOpen:M,open:z,renderValue:B,SelectDisplayProps:{id:d,...q}},...v,classes:v?Wu(Pe,v.classes):Pe,...b?b.props.inputProps:{}},...(k&&L||h)&&ne==="outlined"?{notched:!0}:{},ref:Ee,className:An(me.props.className,o,ue.root),...!b&&{variant:ne},...G})})});Hp.muiName="Select";function zpe(t,e,r=(n,i)=>n===i){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}const jpe=2;function Ay(t,e,r,n,i){return r===1?Math.min(t+e,i):Math.max(t-e,n)}function GG(t,e){return t-e}function A8(t,e){const{index:r}=t.reduce((n,i,a)=>{const s=Math.abs(e-i);return n===null||s<n.distance||s===n.distance?{distance:s,index:a}:n},null)??{};return r}function Gx(t,e){if(e.current!==void 0&&t.changedTouches){const r=t;for(let n=0;n<r.changedTouches.length;n+=1){const i=r.changedTouches[n];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function Zw(t,e,r){return(t-e)*100/(r-e)}function Upe(t,e,r){return(r-e)*t+e}function Vpe(t){if(Math.abs(t)<1){const r=t.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function $pe(t,e,r){const n=Math.round((t-r)/e)*e+r;return Number(n.toFixed(Vpe(e)))}function I8({values:t,newValue:e,index:r}){const n=t.slice();return n[r]=e,n.sort(GG)}function Xx({sliderRef:t,activeIndex:e,setActive:r}){const n=is(t.current);(!t.current?.contains(n.activeElement)||Number(n?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),r&&r(e)}function Yx(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?zpe(t,e):!1}const qpe={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Hpe=t=>t;let Zx;function P8(){return Zx===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Zx=CSS.supports("touch-action","none"):Zx=!0),Zx}function Wpe(t){const{"aria-labelledby":e,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:o=100,min:u=0,name:h,onChange:f,onChangeCommitted:d,orientation:b="horizontal",rootRef:v,scale:S=Hpe,step:E=1,shiftStep:P=10,tabIndex:k,value:L}=t,N=ee.useRef(void 0),[M,z]=ee.useState(-1),[B,q]=ee.useState(-1),[W,G]=ee.useState(!1),ie=ee.useRef(0),J=ee.useRef(null),[H,ne]=pm({controlled:L,default:r??u,name:"Slider"}),ae=f&&((ar,fr,Nr)=>{const or=ar.nativeEvent||ar,Dr=new or.constructor(or.type,or);Object.defineProperty(Dr,"target",{writable:!0,value:{value:fr,name:h}}),J.current=fr,f(Dr,fr,Nr)}),ue=Array.isArray(H);let de=ue?H.slice().sort(GG):[H];de=de.map(ar=>ar==null?u:Gy(ar,u,o));const Pe=s===!0&&E!==null?[...Array(Math.floor((o-u)/E)+1)].map((ar,fr)=>({value:u+E*fr})):s||[],me=Pe.map(ar=>ar.value),[Ee,we]=ee.useState(-1),Ae=ee.useRef(null),ce=Bo(v,Ae),xe=ar=>fr=>{const Nr=Number(fr.currentTarget.getAttribute("data-index"));Yv(fr.target)&&we(Nr),q(Nr),ar?.onFocus?.(fr)},_e=ar=>fr=>{Yv(fr.target)||we(-1),q(-1),ar?.onBlur?.(fr)},Me=(ar,fr)=>{const Nr=Number(ar.currentTarget.getAttribute("data-index")),or=de[Nr],Dr=me.indexOf(or);let er=fr;if(Pe&&E==null){const Gt=me[me.length-1];er>=Gt?er=Gt:er<=me[0]?er=me[0]:er=er<or?me[Dr-1]:me[Dr+1]}if(er=Gy(er,u,o),ue){i&&(er=Gy(er,de[Nr-1]||-1/0,de[Nr+1]||1/0));const Gt=er;er=I8({values:de,newValue:er,index:Nr});let Tt=Nr;i||(Tt=er.indexOf(Gt)),Xx({sliderRef:Ae,activeIndex:Tt})}ne(er),we(Nr),ae&&!Yx(er,H)&&ae(ar,er,Nr),d&&d(ar,J.current??er)},Re=ar=>fr=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(fr.key)){fr.preventDefault();const Nr=Number(fr.currentTarget.getAttribute("data-index")),or=de[Nr];let Dr=null;if(E!=null){const er=fr.shiftKey?P:E;switch(fr.key){case"ArrowUp":Dr=Ay(or,er,1,u,o);break;case"ArrowRight":Dr=Ay(or,er,a?-1:1,u,o);break;case"ArrowDown":Dr=Ay(or,er,-1,u,o);break;case"ArrowLeft":Dr=Ay(or,er,a?1:-1,u,o);break;case"PageUp":Dr=Ay(or,P,1,u,o);break;case"PageDown":Dr=Ay(or,P,-1,u,o);break;case"Home":Dr=u;break;case"End":Dr=o;break}}else if(Pe){const er=me[me.length-1],Gt=me.indexOf(or),Tt=[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Oe=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Tt.includes(fr.key)?Gt===0?Dr=me[0]:Dr=me[Gt-1]:Oe.includes(fr.key)&&(Gt===me.length-1?Dr=er:Dr=me[Gt+1])}Dr!=null&&Me(fr,Dr)}ar?.onKeyDown?.(fr)};vu(()=>{n&&Ae.current.contains(document.activeElement)&&document.activeElement?.blur()},[n]),n&&M!==-1&&z(-1),n&&Ee!==-1&&we(-1);const He=ar=>fr=>{ar.onChange?.(fr),Me(fr,fr.target.valueAsNumber)},Fe=ee.useRef(void 0);let tt=b;a&&b==="horizontal"&&(tt+="-reverse");const Ze=({finger:ar,move:fr=!1})=>{const{current:Nr}=Ae,{width:or,height:Dr,bottom:er,left:Gt}=Nr.getBoundingClientRect();let Tt;tt.startsWith("vertical")?Tt=(er-ar.y)/Dr:Tt=(ar.x-Gt)/or,tt.includes("-reverse")&&(Tt=1-Tt);let Oe;if(Oe=Upe(Tt,u,o),E)Oe=$pe(Oe,E,u);else{const Ne=A8(me,Oe);Oe=me[Ne]}Oe=Gy(Oe,u,o);let Be=0;if(ue){fr?Be=Fe.current:Be=A8(de,Oe),i&&(Oe=Gy(Oe,de[Be-1]||-1/0,de[Be+1]||1/0));const Ne=Oe;Oe=I8({values:de,newValue:Oe,index:Be}),i&&fr||(Be=Oe.indexOf(Ne),Fe.current=Be)}return{newValue:Oe,activeIndex:Be}},Qe=tu(ar=>{const fr=Gx(ar,N);if(!fr)return;if(ie.current+=1,ar.type==="mousemove"&&ar.buttons===0){Ie(ar);return}const{newValue:Nr,activeIndex:or}=Ze({finger:fr,move:!0});Xx({sliderRef:Ae,activeIndex:or,setActive:z}),ne(Nr),!W&&ie.current>jpe&&G(!0),ae&&!Yx(Nr,H)&&ae(ar,Nr,or)}),Ie=tu(ar=>{const fr=Gx(ar,N);if(G(!1),!fr)return;const{newValue:Nr}=Ze({finger:fr,move:!0});z(-1),ar.type==="touchend"&&q(-1),d&&d(ar,J.current??Nr),N.current=void 0,at()}),Lt=tu(ar=>{if(n)return;P8()||ar.preventDefault();const fr=ar.changedTouches[0];fr!=null&&(N.current=fr.identifier);const Nr=Gx(ar,N);if(Nr!==!1){const{newValue:Dr,activeIndex:er}=Ze({finger:Nr});Xx({sliderRef:Ae,activeIndex:er,setActive:z}),ne(Dr),ae&&!Yx(Dr,H)&&ae(ar,Dr,er)}ie.current=0;const or=is(Ae.current);or.addEventListener("touchmove",Qe,{passive:!0}),or.addEventListener("touchend",Ie,{passive:!0})}),at=ee.useCallback(()=>{const ar=is(Ae.current);ar.removeEventListener("mousemove",Qe),ar.removeEventListener("mouseup",Ie),ar.removeEventListener("touchmove",Qe),ar.removeEventListener("touchend",Ie)},[Ie,Qe]);ee.useEffect(()=>{const{current:ar}=Ae;return ar.addEventListener("touchstart",Lt,{passive:P8()}),()=>{ar.removeEventListener("touchstart",Lt),at()}},[at,Lt]),ee.useEffect(()=>{n&&at()},[n,at]);const Ve=ar=>fr=>{if(ar.onMouseDown?.(fr),n||fr.defaultPrevented||fr.button!==0)return;fr.preventDefault();const Nr=Gx(fr,N);if(Nr!==!1){const{newValue:Dr,activeIndex:er}=Ze({finger:Nr});Xx({sliderRef:Ae,activeIndex:er,setActive:z}),ne(Dr),ae&&!Yx(Dr,H)&&ae(fr,Dr,er)}ie.current=0;const or=is(Ae.current);or.addEventListener("mousemove",Qe,{passive:!0}),or.addEventListener("mouseup",Ie)},nr=Zw(ue?de[0]:u,u,o),Yt=Zw(de[de.length-1],u,o)-nr,yr=(ar={})=>{const fr=rm(ar),Nr={onMouseDown:Ve(fr||{})},or={...fr,...Nr};return{...ar,ref:ce,...or}},mt=ar=>fr=>{ar.onMouseOver?.(fr);const Nr=Number(fr.currentTarget.getAttribute("data-index"));q(Nr)},br=ar=>fr=>{ar.onMouseLeave?.(fr),q(-1)},Tr=(ar={})=>{const fr=rm(ar),Nr={onMouseOver:mt(fr||{}),onMouseLeave:br(fr||{})};return{...ar,...fr,...Nr}},mr=ar=>({pointerEvents:M!==-1&&M!==ar?"none":void 0});let Mr;return b==="vertical"&&(Mr=a?"vertical-rl":"vertical-lr"),{active:M,axis:tt,axisProps:qpe,dragging:W,focusedThumbIndex:Ee,getHiddenInputProps:(ar={})=>{const fr=rm(ar),Nr={onChange:He(fr||{}),onFocus:xe(fr||{}),onBlur:_e(fr||{}),onKeyDown:Re(fr||{})},or={...fr,...Nr};return{tabIndex:k,"aria-labelledby":e,"aria-orientation":b,"aria-valuemax":S(o),"aria-valuemin":S(u),name:h,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:n,...ar,...or,style:{...Ipe,direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:Mr}}},getRootProps:yr,getThumbProps:Tr,marks:Pe,open:B,range:ue,rootRef:ce,trackLeap:Yt,trackOffset:nr,values:de,getThumbStyle:mr}}const Gpe=t=>!t||!Yf(t);function Xpe(t){return pi("MuiSlider",t)}const yh=fi("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Ype=t=>{const{open:e}=t;return{offset:An(e&&yh.valueLabelOpen),circle:yh.valueLabelCircle,label:yh.valueLabelLabel}};function Zpe(t){const{children:e,className:r,value:n}=t,i=Ype(t);return e?ee.cloneElement(e,{className:e.props.className},Z.jsxs(ee.Fragment,{children:[e.props.children,Z.jsx("span",{className:An(i.offset,r),"aria-hidden":!0,children:Z.jsx("span",{className:i.circle,children:Z.jsx("span",{className:i.label,children:n})})})]})):null}function k8(t){return t}const Kpe=Br("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${pn(r.color)}`],r.size!=="medium"&&e[`size${pn(r.size)}`],r.marked&&e.marked,r.orientation==="vertical"&&e.vertical,r.track==="inverted"&&e.trackInverted,r.track===!1&&e.trackFalse]}})(ui(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${yh.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${yh.dragging}`]:{[`& .${yh.thumb}, & .${yh.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),Jpe=Br("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),Qpe=Br("span",{name:"MuiSlider",slot:"Track"})(ui(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),ege=Br("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.thumb,e[`thumbColor${pn(r.color)}`],r.size!=="medium"&&e[`thumbSize${pn(r.size)}`]]}})(ui(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${yh.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(Bl()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${yh.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${yh.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),tge=Br(Zpe,{name:"MuiSlider",slot:"ValueLabel"})(ui(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${yh.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${yh.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),rge=Br("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>XE(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:r}=t;return[e.mark,r&&e.markActive]}})(ui(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),nge=Br("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>XE(t)&&t!=="markLabelActive"})(ui(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),ige=t=>{const{disabled:e,dragging:r,marked:n,orientation:i,track:a,classes:s,color:o,size:u}=t,h={root:["root",e&&"disabled",r&&"dragging",n&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",o&&`color${pn(o)}`,u&&`size${pn(u)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",u&&`thumbSize${pn(u)}`,o&&`thumbColor${pn(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return gi(h,Xpe,s)},age=({children:t})=>t,cO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSlider"}),i=$b(),{"aria-label":a,"aria-valuetext":s,"aria-labelledby":o,component:u="span",components:h={},componentsProps:f={},color:d="primary",classes:b,className:v,disableSwap:S=!1,disabled:E=!1,getAriaLabel:P,getAriaValueText:k,marks:L=!1,max:N=100,min:M=0,name:z,onChange:B,onChangeCommitted:q,orientation:W="horizontal",shiftStep:G=10,size:ie="medium",step:J=1,scale:H=k8,slotProps:ne,slots:ae,tabIndex:ue,track:de="normal",value:Pe,valueLabelDisplay:me="off",valueLabelFormat:Ee=k8,...we}=n,Ae={...n,isRtl:i,max:N,min:M,classes:b,disabled:E,disableSwap:S,orientation:W,marks:L,color:d,size:ie,step:J,shiftStep:G,scale:H,track:de,valueLabelDisplay:me,valueLabelFormat:Ee},{axisProps:ce,getRootProps:xe,getHiddenInputProps:_e,getThumbProps:Me,open:Re,active:He,axis:Fe,focusedThumbIndex:tt,range:Ze,dragging:Qe,marks:Ie,values:Lt,trackOffset:at,trackLeap:Ve,getThumbStyle:nr}=Wpe({...Ae,rootRef:r});Ae.marked=Ie.length>0&&Ie.some(jt=>jt.label),Ae.dragging=Qe,Ae.focusedThumbIndex=tt;const Yt=ige(Ae),yr=ae?.root??h.Root??Kpe,mt=ae?.rail??h.Rail??Jpe,br=ae?.track??h.Track??Qpe,Tr=ae?.thumb??h.Thumb??ege,mr=ae?.valueLabel??h.ValueLabel??tge,Mr=ae?.mark??h.Mark??rge,Pr=ae?.markLabel??h.MarkLabel??nge,ar=ae?.input??h.Input??"input",fr=ne?.root??f.root,Nr=ne?.rail??f.rail,or=ne?.track??f.track,Dr=ne?.thumb??f.thumb,er=ne?.valueLabel??f.valueLabel,Gt=ne?.mark??f.mark,Tt=ne?.markLabel??f.markLabel,Oe=ne?.input??f.input,Be=Bf({elementType:yr,getSlotProps:xe,externalSlotProps:fr,externalForwardedProps:we,additionalProps:{...Gpe(yr)&&{as:u}},ownerState:{...Ae,...fr?.ownerState},className:[Yt.root,v]}),Ne=Bf({elementType:mt,externalSlotProps:Nr,ownerState:Ae,className:Yt.rail}),rt=Bf({elementType:br,externalSlotProps:or,additionalProps:{style:{...ce[Fe].offset(at),...ce[Fe].leap(Ve)}},ownerState:{...Ae,...or?.ownerState},className:Yt.track}),pt=Bf({elementType:Tr,getSlotProps:Me,externalSlotProps:Dr,ownerState:{...Ae,...Dr?.ownerState},className:Yt.thumb}),Rt=Bf({elementType:mr,externalSlotProps:er,ownerState:{...Ae,...er?.ownerState},className:Yt.valueLabel}),Bt=Bf({elementType:Mr,externalSlotProps:Gt,ownerState:Ae,className:Yt.mark}),At=Bf({elementType:Pr,externalSlotProps:Tt,ownerState:Ae,className:Yt.markLabel}),Zt=Bf({elementType:ar,getSlotProps:_e,externalSlotProps:Oe,ownerState:Ae});return Z.jsxs(yr,{...Be,children:[Z.jsx(mt,{...Ne}),Z.jsx(br,{...rt}),Ie.filter(jt=>jt.value>=M&&jt.value<=N).map((jt,St)=>{const Xt=Zw(jt.value,M,N),Ct=ce[Fe].offset(Xt);let Lr;return de===!1?Lr=Lt.includes(jt.value):Lr=de==="normal"&&(Ze?jt.value>=Lt[0]&&jt.value<=Lt[Lt.length-1]:jt.value<=Lt[0])||de==="inverted"&&(Ze?jt.value<=Lt[0]||jt.value>=Lt[Lt.length-1]:jt.value>=Lt[0]),Z.jsxs(ee.Fragment,{children:[Z.jsx(Mr,{"data-index":St,...Bt,...!Yf(Mr)&&{markActive:Lr},style:{...Ct,...Bt.style},className:An(Bt.className,Lr&&Yt.markActive)}),jt.label!=null?Z.jsx(Pr,{"aria-hidden":!0,"data-index":St,...At,...!Yf(Pr)&&{markLabelActive:Lr},style:{...Ct,...At.style},className:An(Yt.markLabel,At.className,Lr&&Yt.markLabelActive),children:jt.label}):null]},St)}),Lt.map((jt,St)=>{const Xt=Zw(jt,M,N),Ct=ce[Fe].offset(Xt),Lr=me==="off"?age:mr;return Z.jsx(Lr,{...!Yf(Lr)&&{valueLabelFormat:Ee,valueLabelDisplay:me,value:typeof Ee=="function"?Ee(H(jt),St):Ee,index:St,open:Re===St||He===St||me==="on",disabled:E},...Rt,children:Z.jsx(Tr,{"data-index":St,...pt,className:An(Yt.thumb,pt.className,He===St&&Yt.active,tt===St&&Yt.focusVisible),style:{...Ct,...nr(St),...pt.style},children:Z.jsx(ar,{"data-index":St,"aria-label":P?P(St):a,"aria-valuenow":H(jt),"aria-labelledby":o,"aria-valuetext":k?k(H(jt),St):s,value:Lt[St],...Zt})})},St)})]})});function oge(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:n,open:i,resumeHideDuration:a}=t,s=Lp();ee.useEffect(()=>{if(!i)return;function k(L){L.defaultPrevented||L.key==="Escape"&&n?.(L,"escapeKeyDown")}return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}},[i,n]);const o=tu((k,L)=>{n?.(k,L)}),u=tu(k=>{!n||k==null||s.start(k,()=>{o(null,"timeout")})});ee.useEffect(()=>(i&&u(e),s.clear),[i,e,u,s]);const h=k=>{n?.(k,"clickaway")},f=s.clear,d=ee.useCallback(()=>{e!=null&&u(a??e*.5)},[e,a,u]),b=k=>L=>{const N=k.onBlur;N?.(L),d()},v=k=>L=>{const N=k.onFocus;N?.(L),f()},S=k=>L=>{const N=k.onMouseEnter;N?.(L),f()},E=k=>L=>{const N=k.onMouseLeave;N?.(L),d()};return ee.useEffect(()=>{if(!r&&i)return window.addEventListener("focus",d),window.addEventListener("blur",f),()=>{window.removeEventListener("focus",d),window.removeEventListener("blur",f)}},[r,i,d,f]),{getRootProps:(k={})=>{const L={...rm(t),...rm(k)};return{role:"presentation",...k,...L,onBlur:b(L),onFocus:v(L),onMouseEnter:S(L),onMouseLeave:E(L)}},onClickAway:h}}function sge(t){return pi("MuiSnackbarContent",t)}fi("MuiSnackbarContent",["root","message","action"]);const lge=t=>{const{classes:e}=t;return gi({root:["root"],action:["action"],message:["message"]},sge,e)},uge=Br(Eh,{name:"MuiSnackbarContent",slot:"Root"})(ui(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(bP(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:bP(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),cge=Br("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),hge=Br("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),fge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:s,role:o="alert",...u}=n,h=n,f=lge(h);return Z.jsxs(uge,{role:o,elevation:6,className:An(f.root,a),ownerState:h,ref:r,...u,children:[Z.jsx(cge,{className:f.message,ownerState:h,children:s}),i?Z.jsx(hge,{className:f.action,ownerState:h,children:i}):null]})});function dge(t){return pi("MuiSnackbar",t)}fi("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const pge=t=>{const{classes:e,anchorOrigin:r}=t,n={root:["root",`anchorOrigin${pn(r.vertical)}${pn(r.horizontal)}`]};return gi(n,dge,e)},gge=Br("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${pn(r.anchorOrigin.vertical)}${pn(r.anchorOrigin.horizontal)}`]]}})(ui(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),mge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSnackbar"}),i=kc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:s,anchorOrigin:{vertical:o,horizontal:u}={vertical:"bottom",horizontal:"left"},autoHideDuration:h=null,children:f,className:d,ClickAwayListenerProps:b,ContentProps:v,disableWindowBlurListener:S=!1,message:E,onBlur:P,onClose:k,onFocus:L,onMouseEnter:N,onMouseLeave:M,open:z,resumeHideDuration:B,slots:q={},slotProps:W={},TransitionComponent:G,transitionDuration:ie=a,TransitionProps:{onEnter:J,onExited:H,...ne}={},...ae}=n,ue={...n,anchorOrigin:{vertical:o,horizontal:u},autoHideDuration:h,disableWindowBlurListener:S,TransitionComponent:G,transitionDuration:ie},de=pge(ue),{getRootProps:Pe,onClickAway:me}=oge({...ue}),[Ee,we]=ee.useState(!0),Ae=Lt=>{we(!0),H&&H(Lt)},ce=(Lt,at)=>{we(!1),J&&J(Lt,at)},xe={slots:{transition:G,...q},slotProps:{content:v,clickAwayListener:b,transition:ne,...W}},[_e,Me]=Ei("root",{ref:r,className:[de.root,d],elementType:gge,getSlotProps:Pe,externalForwardedProps:{...xe,...ae},ownerState:ue}),[Re,{ownerState:He,...Fe}]=Ei("clickAwayListener",{elementType:Vhe,externalForwardedProps:xe,getSlotProps:Lt=>({onClickAway:(...at)=>{const Ve=at[0];Lt.onClickAway?.(...at),!Ve?.defaultMuiPrevented&&me(...at)}}),ownerState:ue}),[tt,Ze]=Ei("content",{elementType:fge,shouldForwardComponentProp:!0,externalForwardedProps:xe,additionalProps:{message:E,action:s},ownerState:ue}),[Qe,Ie]=Ei("transition",{elementType:J1,externalForwardedProps:xe,getSlotProps:Lt=>({onEnter:(...at)=>{Lt.onEnter?.(...at),ce(...at)},onExited:(...at)=>{Lt.onExited?.(...at),Ae(...at)}}),additionalProps:{appear:!0,in:z,timeout:ie,direction:o==="top"?"down":"up"},ownerState:ue});return!z&&Ee?null:Z.jsx(Re,{...Fe,...q.clickAwayListener&&{ownerState:He},children:Z.jsx(_e,{...Me,children:Z.jsx(Qe,{...Ie,children:f||Z.jsx(tt,{...Ze})})})})});function yge(t){return pi("MuiTooltip",t)}const Ns=fi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function vge(t){return Math.round(t*1e5)/1e5}const _ge=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:a}=t,s={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${pn(a.split("-")[0])}`],arrow:["arrow"]};return gi(s,yge,e)},bge=Br(SG,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(ui(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Ns.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Ns.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Ns.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Ns.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Ns.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Ns.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Ns.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Ns.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),xge=Br("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${pn(r.placement.split("-")[0])}`]]}})(ui(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Ns.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Ns.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Ns.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Ns.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${vge(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Ns.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Ns.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Ns.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Ns.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Ns.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Ns.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Ns.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Ns.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Ns.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Ns.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),wge=Br("span",{name:"MuiTooltip",slot:"Arrow"})(ui(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Kx=!1;const M8=new ZE;let b_={x:0,y:0};function Jx(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const Dp=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:a,classes:s,components:o={},componentsProps:u={},describeChild:h=!1,disableFocusListener:f=!1,disableHoverListener:d=!1,disableInteractive:b=!1,disableTouchListener:v=!1,enterDelay:S=100,enterNextDelay:E=0,enterTouchDelay:P=700,followCursor:k=!1,id:L,leaveDelay:N=0,leaveTouchDelay:M=1500,onClose:z,onOpen:B,open:q,placement:W="bottom",PopperComponent:G,PopperProps:ie={},slotProps:J={},slots:H={},title:ne,TransitionComponent:ae,TransitionProps:ue,...de}=n,Pe=ee.isValidElement(a)?a:Z.jsx("span",{children:a}),me=kc(),Ee=$b(),[we,Ae]=ee.useState(),[ce,xe]=ee.useState(null),_e=ee.useRef(!1),Me=b||k,Re=Lp(),He=Lp(),Fe=Lp(),tt=Lp(),[Ze,Qe]=pm({controlled:q,default:!1,name:"Tooltip",state:"open"});let Ie=Ze;const Lt=og(L),at=ee.useRef(),Ve=tu(()=>{at.current!==void 0&&(document.body.style.WebkitUserSelect=at.current,at.current=void 0),tt.clear()});ee.useEffect(()=>Ve,[Ve]);const nr=qt=>{M8.clear(),Kx=!0,Qe(!0),B&&!Ie&&B(qt)},Yt=tu(qt=>{M8.start(800+N,()=>{Kx=!1}),Qe(!1),z&&Ie&&z(qt),Re.start(me.transitions.duration.shortest,()=>{_e.current=!1})}),yr=qt=>{_e.current&&qt.type!=="touchstart"||(we&&we.removeAttribute("title"),He.clear(),Fe.clear(),S||Kx&&E?He.start(Kx?E:S,()=>{nr(qt)}):nr(qt))},mt=qt=>{He.clear(),Fe.start(N,()=>{Yt(qt)})},[,br]=ee.useState(!1),Tr=qt=>{Yv(qt.target)||(br(!1),mt(qt))},mr=qt=>{we||Ae(qt.currentTarget),Yv(qt.target)&&(br(!0),yr(qt))},Mr=qt=>{_e.current=!0;const Zr=Pe.props;Zr.onTouchStart&&Zr.onTouchStart(qt)},Pr=qt=>{Mr(qt),Fe.clear(),Re.clear(),Ve(),at.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",tt.start(P,()=>{document.body.style.WebkitUserSelect=at.current,yr(qt)})},ar=qt=>{Pe.props.onTouchEnd&&Pe.props.onTouchEnd(qt),Ve(),Fe.start(M,()=>{Yt(qt)})};ee.useEffect(()=>{if(!Ie)return;function qt(Zr){Zr.key==="Escape"&&Yt(Zr)}return document.addEventListener("keydown",qt),()=>{document.removeEventListener("keydown",qt)}},[Yt,Ie]);const fr=Bo(ug(Pe),Ae,r);!ne&&ne!==0&&(Ie=!1);const Nr=ee.useRef(),or=qt=>{const Zr=Pe.props;Zr.onMouseMove&&Zr.onMouseMove(qt),b_={x:qt.clientX,y:qt.clientY},Nr.current&&Nr.current.update()},Dr={},er=typeof ne=="string";h?(Dr.title=!Ie&&er&&!d?ne:null,Dr["aria-describedby"]=Ie?Lt:null):(Dr["aria-label"]=er?ne:null,Dr["aria-labelledby"]=Ie&&!er?Lt:null);const Gt={...Dr,...de,...Pe.props,className:An(de.className,Pe.props.className),onTouchStart:Mr,ref:fr,...k?{onMouseMove:or}:{}},Tt={};v||(Gt.onTouchStart=Pr,Gt.onTouchEnd=ar),d||(Gt.onMouseOver=Jx(yr,Gt.onMouseOver),Gt.onMouseLeave=Jx(mt,Gt.onMouseLeave),Me||(Tt.onMouseOver=yr,Tt.onMouseLeave=mt)),f||(Gt.onFocus=Jx(mr,Gt.onFocus),Gt.onBlur=Jx(Tr,Gt.onBlur),Me||(Tt.onFocus=mr,Tt.onBlur=Tr));const Oe={...n,isRtl:Ee,arrow:i,disableInteractive:Me,placement:W,PopperComponentProp:G,touch:_e.current},Be=typeof J.popper=="function"?J.popper(Oe):J.popper,Ne=ee.useMemo(()=>{let qt=[{name:"arrow",enabled:!!ce,options:{element:ce,padding:4}}];return ie.popperOptions?.modifiers&&(qt=qt.concat(ie.popperOptions.modifiers)),Be?.popperOptions?.modifiers&&(qt=qt.concat(Be.popperOptions.modifiers)),{...ie.popperOptions,...Be?.popperOptions,modifiers:qt}},[ce,ie.popperOptions,Be?.popperOptions]),rt=_ge(Oe),pt=typeof J.transition=="function"?J.transition(Oe):J.transition,Rt={slots:{popper:o.Popper,transition:o.Transition??ae,tooltip:o.Tooltip,arrow:o.Arrow,...H},slotProps:{arrow:J.arrow??u.arrow,popper:{...ie,...Be??u.popper},tooltip:J.tooltip??u.tooltip,transition:{...ue,...pt??u.transition}}},[Bt,At]=Ei("popper",{elementType:bge,externalForwardedProps:Rt,ownerState:Oe,className:An(rt.popper,ie?.className)}),[Zt,jt]=Ei("transition",{elementType:J1,externalForwardedProps:Rt,ownerState:Oe}),[St,Xt]=Ei("tooltip",{elementType:xge,className:rt.tooltip,externalForwardedProps:Rt,ownerState:Oe}),[Ct,Lr]=Ei("arrow",{elementType:wge,className:rt.arrow,externalForwardedProps:Rt,ownerState:Oe,ref:xe});return Z.jsxs(ee.Fragment,{children:[ee.cloneElement(Pe,Gt),Z.jsx(Bt,{as:G??SG,placement:W,anchorEl:k?{getBoundingClientRect:()=>({top:b_.y,left:b_.x,right:b_.x,bottom:b_.y,width:0,height:0})}:we,popperRef:Nr,open:we?Ie:!1,id:Lt,transition:!0,...Tt,...At,popperOptions:Ne,children:({TransitionProps:qt})=>Z.jsx(Zt,{timeout:me.transitions.duration.shorter,...qt,...jt,children:Z.jsxs(St,{...Xt,children:[ne,i?Z.jsx(Ct,{...Lr}):null]})})})]})}),Sge=Br("div",{name:"MuiSwipeArea",shouldForwardProp:_l})(ui(({theme:t})=>({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1,variants:[{props:{anchor:"left"},style:{right:"auto"}},{props:{anchor:"right"},style:{left:"auto",right:0}},{props:{anchor:"top"},style:{bottom:"auto",right:0}},{props:{anchor:"bottom"},style:{top:"auto",bottom:0,right:0}}]}))),Ege=ee.forwardRef(function(e,r){const{anchor:n,classes:i={},className:a,width:s,style:o,...u}=e,h=e;return Z.jsx(Sge,{className:An("PrivateSwipeArea-root",i.root,i[`anchor${pn(n)}`],a),ref:r,style:{[Vg(n)?"width":"height"]:s,...o},ownerState:h,...u})}),Qx=3,_3=20;let Td=null;function b3(t,e,r){return t==="right"?r.body.offsetWidth-e[0].pageX:e[0].pageX}function x3(t,e,r){return t==="bottom"?r.innerHeight-e[0].clientY:e[0].clientY}function x_(t,e){return t?e.clientWidth:e.clientHeight}function R8(t,e,r,n){return Math.min(Math.max(r?e-t:n+e-t,0),n)}function Tge(t,e){const r=[];for(;t&&t!==e.parentElement;){const n=lc(e).getComputedStyle(t);n.getPropertyValue("position")==="absolute"||n.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&r.push(t),t=t.parentElement}return r}function Cge({domTreeShapes:t,start:e,current:r,anchor:n}){const i={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(a=>{let s=r>=e;(n==="top"||n==="left")&&(s=!s);const o=n==="left"||n==="right"?"x":"y",u=Math.round(a[i.scrollPosition[o]]),h=u>0,f=u+a[i.clientLength[o]]<a[i.scrollLength[o]];return!!(s&&f||!s&&h)})}const Age=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),Ige=ee.forwardRef(function(e,r){const n=_i({name:"MuiSwipeableDrawer",props:e}),i=kc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:s="left",disableBackdropTransition:o=!1,disableDiscovery:u=!1,disableSwipeToOpen:h=Age,hideBackdrop:f,hysteresis:d=.52,allowSwipeInChildren:b=!1,minFlingVelocity:v=450,ModalProps:{BackdropProps:S,...E}={},onClose:P,onOpen:k,open:L=!1,PaperProps:N={},SwipeAreaProps:M,swipeAreaWidth:z=20,transitionDuration:B=a,variant:q="temporary",slots:W={},slotProps:G={},...ie}=n,[J,H]=ee.useState(!1),ne=ee.useRef({isSwiping:null}),ae=ee.useRef(),ue=ee.useRef(),de=ee.useRef(),Pe=Bo(N.ref,de),me=ee.useRef(!1),Ee=ee.useRef();vu(()=>{Ee.current=null},[L]);const we=ee.useCallback((He,Fe={})=>{const{mode:tt=null,changeTransition:Ze=!0}=Fe,Qe=X_(i,s),Ie=["right","bottom"].includes(Qe)?1:-1,Lt=Vg(s),at=Lt?`translate(${Ie*He}px, 0)`:`translate(0, ${Ie*He}px)`,Ve=de.current.style;Ve.webkitTransform=at,Ve.transform=at;let nr="";if(tt&&(nr=i.transitions.create("all",Gd({easing:void 0,style:void 0,timeout:B},{mode:tt}))),Ze&&(Ve.webkitTransition=nr,Ve.transition=nr),!o&&!f){const Yt=ue.current.style;Yt.opacity=1-He/x_(Lt,de.current),Ze&&(Yt.webkitTransition=nr,Yt.transition=nr)}},[s,o,f,i,B]),Ae=tu(He=>{if(!me.current)return;if(Td=null,me.current=!1,Fd.flushSync(()=>{H(!1)}),!ne.current.isSwiping){ne.current.isSwiping=null;return}ne.current.isSwiping=null;const Fe=X_(i,s),tt=Vg(s);let Ze;tt?Ze=b3(Fe,He.changedTouches,is(He.currentTarget)):Ze=x3(Fe,He.changedTouches,lc(He.currentTarget));const Qe=tt?ne.current.startX:ne.current.startY,Ie=x_(tt,de.current),Lt=R8(Ze,Qe,L,Ie),at=Lt/Ie;if(Math.abs(ne.current.velocity)>v&&(Ee.current=Math.abs((Ie-Lt)/ne.current.velocity)*1e3),L){ne.current.velocity>v||at>d?P():we(0,{mode:"exit"});return}ne.current.velocity<-v||1-at>d?k():we(x_(tt,de.current),{mode:"enter"})}),ce=(He=!1)=>{if(!J){(He||!(u&&b))&&Fd.flushSync(()=>{H(!0)});const Fe=Vg(s);!L&&de.current&&we(x_(Fe,de.current)+(u?15:-_3),{changeTransition:!1}),ne.current.velocity=0,ne.current.lastTime=null,ne.current.lastTranslate=null,ne.current.paperHit=!1,me.current=!0}},xe=tu(He=>{if(!de.current||!me.current||Td!==null&&Td!==ne.current)return;ce(!0);const Fe=X_(i,s),tt=Vg(s),Ze=b3(Fe,He.touches,is(He.currentTarget)),Qe=x3(Fe,He.touches,lc(He.currentTarget));if(L&&de.current.contains(He.target)&&Td===null){const nr=Tge(He.target,de.current);if(Cge({domTreeShapes:nr,start:tt?ne.current.startX:ne.current.startY,current:tt?Ze:Qe,anchor:s})){Td=!0;return}Td=ne.current}if(ne.current.isSwiping==null){const nr=Math.abs(Ze-ne.current.startX),Yt=Math.abs(Qe-ne.current.startY),yr=tt?nr>Yt&&nr>Qx:Yt>nr&&Yt>Qx;if(yr&&He.cancelable&&He.preventDefault(),yr===!0||(tt?Yt>Qx:nr>Qx)){if(ne.current.isSwiping=yr,!yr){Ae(He);return}ne.current.startX=Ze,ne.current.startY=Qe,!u&&!L&&(tt?ne.current.startX-=_3:ne.current.startY-=_3)}}if(!ne.current.isSwiping)return;const Ie=x_(tt,de.current);let Lt=tt?ne.current.startX:ne.current.startY;L&&!ne.current.paperHit&&(Lt=Math.min(Lt,Ie));const at=R8(tt?Ze:Qe,Lt,L,Ie);if(L)if(ne.current.paperHit)at===0&&(ne.current.startX=Ze,ne.current.startY=Qe);else if(tt?Ze<Ie:Qe<Ie)ne.current.paperHit=!0,ne.current.startX=Ze,ne.current.startY=Qe;else return;ne.current.lastTranslate===null&&(ne.current.lastTranslate=at,ne.current.lastTime=performance.now()+1);const Ve=(at-ne.current.lastTranslate)/(performance.now()-ne.current.lastTime)*1e3;ne.current.velocity=ne.current.velocity*.4+Ve*.6,ne.current.lastTranslate=at,ne.current.lastTime=performance.now(),He.cancelable&&He.preventDefault(),we(at)}),_e=tu(He=>{if(He.defaultPrevented||He.defaultMuiPrevented||L&&(f||!ue.current.contains(He.target))&&!de.current.contains(He.target))return;const Fe=X_(i,s),tt=Vg(s),Ze=b3(Fe,He.touches,is(He.currentTarget)),Qe=x3(Fe,He.touches,lc(He.currentTarget));if(!L){if(h||!(He.target===ae.current||de.current?.contains(He.target)&&(typeof b=="function"?b(He,ae.current,de.current):b)))return;if(tt){if(Ze>z)return}else if(Qe>z)return}He.defaultMuiPrevented=!0,Td=null,ne.current.startX=Ze,ne.current.startY=Qe,ce()});ee.useEffect(()=>{if(q==="temporary"){const He=is(de.current);return He.addEventListener("touchstart",_e),He.addEventListener("touchmove",xe,{passive:!L}),He.addEventListener("touchend",Ae),()=>{He.removeEventListener("touchstart",_e),He.removeEventListener("touchmove",xe,{passive:!L}),He.removeEventListener("touchend",Ae)}}},[q,L,_e,xe,Ae]),ee.useEffect(()=>()=>{Td===ne.current&&(Td=null)},[]),ee.useEffect(()=>{L||H(!1)},[L]);const[Me,Re]=Ei("swipeArea",{ref:ae,elementType:Ege,ownerState:n,externalForwardedProps:{slots:W,slotProps:{swipeArea:M,...G}},additionalProps:{width:z,anchor:s}});return Z.jsxs(ee.Fragment,{children:[Z.jsx(aO,{open:q==="temporary"&&J?!0:L,variant:q,ModalProps:{BackdropProps:{...S,ref:ue},...q==="temporary"&&{keepMounted:!0},...E},hideBackdrop:f,anchor:s,transitionDuration:Ee.current||B,onClose:P,ref:r,slots:W,slotProps:{...G,backdrop:Y1(G.backdrop??S,{ref:ue}),paper:Y1(G.paper??N,{style:{pointerEvents:q==="temporary"&&!L&&!b?"none":""},ref:Pe})},...ie}),!h&&q==="temporary"&&Z.jsx(ape,{children:Z.jsx(Me,{...Re})})]})});function Pge(t){return pi("MuiToolbar",t)}fi("MuiToolbar",["root","gutters","regular","dense"]);const kge=t=>{const{classes:e,disableGutters:r,variant:n}=t;return gi({root:["root",!r&&"gutters",n]},Pge,e)},Mge=Br("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(ui(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),Rge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiToolbar"}),{className:i,component:a="div",disableGutters:s=!1,variant:o="regular",...u}=n,h={...n,component:a,disableGutters:s,variant:o},f=kge(h);return Z.jsx(Mge,{as:a,className:An(f.root,i),ref:r,ownerState:h,...u})});function Oge(t){return pi("MuiTextField",t)}fi("MuiTextField",["root"]);const Nge={standard:sO,filled:oO,outlined:nT},Lge=t=>{const{classes:e}=t;return gi({root:["root"]},Oge,e)},Dge=Br(Kc,{name:"MuiTextField",slot:"Root"})({}),iT=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:s,className:o,color:u="primary",defaultValue:h,disabled:f=!1,error:d=!1,FormHelperTextProps:b,fullWidth:v=!1,helperText:S,id:E,InputLabelProps:P,inputProps:k,InputProps:L,inputRef:N,label:M,maxRows:z,minRows:B,multiline:q=!1,name:W,onBlur:G,onChange:ie,onFocus:J,placeholder:H,required:ne=!1,rows:ae,select:ue=!1,SelectProps:de,slots:Pe={},slotProps:me={},type:Ee,value:we,variant:Ae="outlined",...ce}=n,xe={...n,autoFocus:a,color:u,disabled:f,error:d,fullWidth:v,multiline:q,required:ne,select:ue,variant:Ae},_e=Lge(xe),Me=og(E),Re=S&&Me?`${Me}-helper-text`:void 0,He=M&&Me?`${Me}-label`:void 0,Fe=Nge[Ae],tt={slots:Pe,slotProps:{input:L,inputLabel:P,htmlInput:k,formHelperText:b,select:de,...me}},Ze={},Qe=tt.slotProps.inputLabel;Ae==="outlined"&&(Qe&&typeof Qe.shrink<"u"&&(Ze.notched=Qe.shrink),Ze.label=M),ue&&((!de||!de.native)&&(Ze.id=void 0),Ze["aria-describedby"]=void 0);const[Ie,Lt]=Ei("root",{elementType:Dge,shouldForwardComponentProp:!0,externalForwardedProps:{...tt,...ce},ownerState:xe,className:An(_e.root,o),ref:r,additionalProps:{disabled:f,error:d,fullWidth:v,required:ne,color:u,variant:Ae}}),[at,Ve]=Ei("input",{elementType:Fe,externalForwardedProps:tt,additionalProps:Ze,ownerState:xe}),[nr,Yt]=Ei("inputLabel",{elementType:qp,externalForwardedProps:tt,ownerState:xe}),[yr,mt]=Ei("htmlInput",{elementType:"input",externalForwardedProps:tt,ownerState:xe}),[br,Tr]=Ei("formHelperText",{elementType:rde,externalForwardedProps:tt,ownerState:xe}),[mr,Mr]=Ei("select",{elementType:Hp,externalForwardedProps:tt,ownerState:xe}),Pr=Z.jsx(at,{"aria-describedby":Re,autoComplete:i,autoFocus:a,defaultValue:h,fullWidth:v,multiline:q,name:W,rows:ae,maxRows:z,minRows:B,type:Ee,value:we,id:Me,inputRef:N,onBlur:G,onChange:ie,onFocus:J,placeholder:H,inputProps:mt,slots:{input:Pe.htmlInput?yr:void 0},...Ve});return Z.jsxs(Ie,{...Lt,children:[M!=null&&M!==""&&Z.jsx(nr,{htmlFor:Me,id:He,...Yt,children:M}),ue?Z.jsx(mr,{"aria-describedby":Re,id:Me,labelId:He,value:we,input:Pr,...Mr,children:s}):Pr,S&&Z.jsx(br,{id:Re,...Tr,children:S})]})}),Gb=UW({themeId:nf}),Fge=Yi(Z.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),VP=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(!1),i=()=>{navigator.geolocation.getCurrentPosition(a,s)},a=ee.useCallback(o=>{e.map?.map.setCenter?.([o.coords.longitude,o.coords.latitude])},[e.map]),s=()=>{console.log("Access of user location denied"),n(!0)};return Z.jsx(Z.Fragment,{children:Z.jsx(ra,{variant:"navtools",sx:o=>({zIndex:1002,color:r?t.offColor??o.palette.navigation.buttonColor:t.onColor??o.palette.navigation.buttonColor}),onClick:i,disabled:r,children:Z.jsx(Fge,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{VP.displayName="MlCenterPosition",VP.__docgenInfo={description:"Component template",displayName:"MlCenterPosition",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"CSS style object that is applied to the button component",name:"style",required:!1,type:{name:"SxProps<Theme> | undefined"}}}}}catch{}const O8=t=>{const e=pa({mapId:t.mapId});return console.log(e.componentId+" remove this log"),Z.jsx(Z.Fragment,{})};try{O8.displayName="MlComponentTemplate",O8.__docgenInfo={description:"Component description",displayName:"MlComponentTemplate",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Bge=Yi(Z.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}));function ao(t){"@babel/helpers - typeof";return ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ao(t)}var of=Uint8Array,Jc=Uint16Array,hO=Int32Array,fO=new of([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dO=new of([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),N8=new of([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),XG=function(t,e){for(var r=new Jc(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new hO(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},YG=XG(fO,2),zge=YG.b,$P=YG.r;zge[28]=258,$P[258]=28;var jge=XG(dO,0),L8=jge.r,qP=new Jc(32768);for(var Go=0;Go<32768;++Go){var xp=(Go&43690)>>1|(Go&21845)<<1;xp=(xp&52428)>>2|(xp&13107)<<2,xp=(xp&61680)>>4|(xp&3855)<<4,qP[Go]=((xp&65280)>>8|(xp&255)<<8)>>1}var E1=(function(t,e,r){for(var n=t.length,i=0,a=new Jc(e);i<n;++i)t[i]&&++a[t[i]-1];var s=new Jc(e);for(i=1;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new Jc(1<<e);var u=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],f=e-t[i],d=s[t[i]-1]++<<f,b=d|(1<<f)-1;d<=b;++d)o[qP[d]>>u]=h}else for(o=new Jc(n),i=0;i<n;++i)t[i]&&(o[i]=qP[s[t[i]-1]++]>>15-t[i]);return o}),mm=new of(288);for(var Go=0;Go<144;++Go)mm[Go]=8;for(var Go=144;Go<256;++Go)mm[Go]=9;for(var Go=256;Go<280;++Go)mm[Go]=7;for(var Go=280;Go<288;++Go)mm[Go]=8;var Kw=new of(32);for(var Go=0;Go<32;++Go)Kw[Go]=5;var Uge=E1(mm,9,0),Vge=E1(Kw,5,0),ZG=function(t){return(t+7)/8|0},$ge=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new of(t.subarray(e,r))},Cd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},w_=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},w3=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:JG,l:0};if(i==1){var s=new of(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(z,B){return z.f-B.f}),r.push({s:-1,f:25001});var o=r[0],u=r[1],h=0,f=1,d=2;for(r[0]={s:-1,f:o.f+u.f,l:o,r:u};f!=i-1;)o=r[r[h].f<r[d].f?h++:d++],u=r[h!=f&&r[h].f<r[d].f?h++:d++],r[f++]={s:-1,f:o.f+u.f,l:o,r:u};for(var b=a[0].s,n=1;n<i;++n)a[n].s>b&&(b=a[n].s);var v=new Jc(b+1),S=HP(r[f-1],v,0);if(S>e){var n=0,E=0,P=S-e,k=1<<P;for(a.sort(function(B,q){return v[q.s]-v[B.s]||B.f-q.f});n<i;++n){var L=a[n].s;if(v[L]>e)E+=k-(1<<S-v[L]),v[L]=e;else break}for(E>>=P;E>0;){var N=a[n].s;v[N]<e?E-=1<<e-v[N]++-1:++n}for(;n>=0&&E;--n){var M=a[n].s;v[M]==e&&(--v[M],++E)}S=e}return{t:new of(v),l:S}},HP=function(t,e,r){return t.s==-1?Math.max(HP(t.l,e,r+1),HP(t.r,e,r+1)):e[t.s]=r},D8=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Jc(++e),n=0,i=t[0],a=1,s=function(u){r[n++]=u},o=1;o<=e;++o)if(t[o]==i&&o!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[o]}return{c:r.subarray(0,n),n:e}},S_=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},KG=function(t,e,r){var n=r.length,i=ZG(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},F8=function(t,e,r,n,i,a,s,o,u,h,f){Cd(e,f++,r),++i[256];for(var d=w3(i,15),b=d.t,v=d.l,S=w3(a,15),E=S.t,P=S.l,k=D8(b),L=k.c,N=k.n,M=D8(E),z=M.c,B=M.n,q=new Jc(19),W=0;W<L.length;++W)++q[L[W]&31];for(var W=0;W<z.length;++W)++q[z[W]&31];for(var G=w3(q,7),ie=G.t,J=G.l,H=19;H>4&&!ie[N8[H-1]];--H);var ne=h+5<<3,ae=S_(i,mm)+S_(a,Kw)+s,ue=S_(i,b)+S_(a,E)+s+14+3*H+S_(q,ie)+2*q[16]+3*q[17]+7*q[18];if(u>=0&&ne<=ae&&ne<=ue)return KG(e,f,t.subarray(u,u+h));var de,Pe,me,Ee;if(Cd(e,f,1+(ue<ae)),f+=2,ue<ae){de=E1(b,v,0),Pe=b,me=E1(E,P,0),Ee=E;var we=E1(ie,J,0);Cd(e,f,N-257),Cd(e,f+5,B-1),Cd(e,f+10,H-4),f+=14;for(var W=0;W<H;++W)Cd(e,f+3*W,ie[N8[W]]);f+=3*H;for(var Ae=[L,z],ce=0;ce<2;++ce)for(var xe=Ae[ce],W=0;W<xe.length;++W){var _e=xe[W]&31;Cd(e,f,we[_e]),f+=ie[_e],_e>15&&(Cd(e,f,xe[W]>>5&127),f+=xe[W]>>12)}}else de=Uge,Pe=mm,me=Vge,Ee=Kw;for(var W=0;W<o;++W){var Me=n[W];if(Me>255){var _e=Me>>18&31;w_(e,f,de[_e+257]),f+=Pe[_e+257],_e>7&&(Cd(e,f,Me>>23&31),f+=fO[_e]);var Re=Me&31;w_(e,f,me[Re]),f+=Ee[Re],Re>3&&(w_(e,f,Me>>5&8191),f+=dO[Re])}else w_(e,f,de[Me]),f+=Pe[Me]}return w_(e,f,de[256]),f+Pe[256]},qge=new hO([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),JG=new of(0),Hge=function(t,e,r,n,i,a){var s=a.z||t.length,o=new of(n+s+5*(1+Math.ceil(s/7e3))+i),u=o.subarray(n,o.length-i),h=a.l,f=(a.r||0)&7;if(e){f&&(u[0]=a.r>>3);for(var d=qge[e-1],b=d>>13,v=d&8191,S=(1<<r)-1,E=a.p||new Jc(32768),P=a.h||new Jc(S+1),k=Math.ceil(r/3),L=2*k,N=function(at){return(t[at]^t[at+1]<<k^t[at+2]<<L)&S},M=new hO(25e3),z=new Jc(288),B=new Jc(32),q=0,W=0,G=a.i||0,ie=0,J=a.w||0,H=0;G+2<s;++G){var ne=N(G),ae=G&32767,ue=P[ne];if(E[ae]=ue,P[ne]=ae,J<=G){var de=s-G;if((q>7e3||ie>24576)&&(de>423||!h)){f=F8(t,u,0,M,z,B,W,ie,H,G-H,f),ie=q=W=0,H=G;for(var Pe=0;Pe<286;++Pe)z[Pe]=0;for(var Pe=0;Pe<30;++Pe)B[Pe]=0}var me=2,Ee=0,we=v,Ae=ae-ue&32767;if(de>2&&ne==N(G-Ae))for(var ce=Math.min(b,de)-1,xe=Math.min(32767,G),_e=Math.min(258,de);Ae<=xe&&--we&&ae!=ue;){if(t[G+me]==t[G+me-Ae]){for(var Me=0;Me<_e&&t[G+Me]==t[G+Me-Ae];++Me);if(Me>me){if(me=Me,Ee=Ae,Me>ce)break;for(var Re=Math.min(Ae,Me-2),He=0,Pe=0;Pe<Re;++Pe){var Fe=G-Ae+Pe&32767,tt=E[Fe],Ze=Fe-tt&32767;Ze>He&&(He=Ze,ue=Fe)}}}ae=ue,ue=E[ae],Ae+=ae-ue&32767}if(Ee){M[ie++]=268435456|$P[me]<<18|L8[Ee];var Qe=$P[me]&31,Ie=L8[Ee]&31;W+=fO[Qe]+dO[Ie],++z[257+Qe],++B[Ie],J=G+me,++q}else M[ie++]=t[G],++z[t[G]]}}for(G=Math.max(G,J);G<s;++G)M[ie++]=t[G],++z[t[G]];f=F8(t,u,h,M,z,B,W,ie,H,G-H,f),h||(a.r=f&7|u[f/8|0]<<3,f-=7,a.h=P,a.p=E,a.i=G,a.w=J)}else{for(var G=a.w||0;G<s+h;G+=65535){var Lt=G+65535;Lt>=s&&(u[f/8|0]=h,Lt=s),f=KG(u,f+1,t.subarray(G,Lt))}a.i=s}return $ge(o,0,n+ZG(f)+i)},QG=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},Wge=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new of(a.length+t.length);s.set(a),s.set(t,a.length),t=s,i.w=a.length}return Hge(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},eX=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Gge=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=QG();i.p(e.dictionary),eX(t,2,i.d())}};function WP(t,e){e||(e={});var r=QG();r.p(t);var n=Wge(t,e,e.dictionary?6:2,4);return Gge(n,e),eX(n,n.length-4,r.d()),n}var Xge=typeof TextDecoder<"u"&&new TextDecoder,Yge=0;try{Xge.decode(JG,{stream:!0}),Yge=1}catch{}function Zge(t){if(Array.isArray(t))return t}function Kge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,h=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(f){h=!0,i=f}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(h)throw i}}return o}}function B8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Jge(t,e){if(t){if(typeof t=="string")return B8(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B8(t,e):void 0}}function Qge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z8(t,e){return Zge(t)||Kge(t,e)||Jge(t,e)||Qge()}function j8(t,e="utf8"){return new TextDecoder(e).decode(t)}const eme=new TextEncoder;function tme(t){return eme.encode(t)}const rme=1024*8,nme=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),S3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class pO{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=rme,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof pO)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=S3[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===nme&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const u=new S3[r](o.buffer);return this.offset+=n,u.reverse(),u}const s=new S3[r](a);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return j8(this.readBytes(e))}decodeText(e=1,r="utf8"){return j8(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(tme(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function P0(t){let e=t.length;for(;--e>=0;)t[e]=0}const ime=3,ame=258,tX=29,ome=256,sme=ome+1+tX,rX=30,lme=512,ume=new Array((sme+2)*2);P0(ume);const cme=new Array(rX*2);P0(cme);const hme=new Array(lme);P0(hme);const fme=new Array(ame-ime+1);P0(fme);const dme=new Array(tX);P0(dme);const pme=new Array(rX);P0(pme);const gme=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var GP=gme;const mme=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},yme=new Uint32Array(mme()),vme=(t,e,r,n)=>{const i=yme,a=n+r;t^=-1;for(let s=n;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var Nf=vme,XP={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},nX={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _me=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var bme=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)_me(r,n)&&(t[n]=r[n])}}return t},xme=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let s=t[n];r.set(s,i),i+=s.length}return r},iX={assign:bme,flattenChunks:xme};let aX=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{aX=!1}const eb=new Uint8Array(256);for(let t=0;t<256;t++)eb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;eb[254]=eb[254]=1;var wme=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,s=t.length,o=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const Sme=(t,e)=>{if(e<65534&&t.subarray&&aX)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Eme=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){a[i++]=s;continue}let o=eb[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|t[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return Sme(a,i)},Tme=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+eb[t[r]]>e?r:e},YP={string2buf:wme,buf2string:Eme,utf8border:Tme};function Cme(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ame=Cme;const e2=16209,Ime=16191;var Pme=function(e,r){let n,i,a,s,o,u,h,f,d,b,v,S,E,P,k,L,N,M,z,B,q,W,G,ie;const J=e.state;n=e.next_in,G=e.input,i=n+(e.avail_in-5),a=e.next_out,ie=e.output,s=a-(r-e.avail_out),o=a+(e.avail_out-257),u=J.dmax,h=J.wsize,f=J.whave,d=J.wnext,b=J.window,v=J.hold,S=J.bits,E=J.lencode,P=J.distcode,k=(1<<J.lenbits)-1,L=(1<<J.distbits)-1;e:do{S<15&&(v+=G[n++]<<S,S+=8,v+=G[n++]<<S,S+=8),N=E[v&k];t:for(;;){if(M=N>>>24,v>>>=M,S-=M,M=N>>>16&255,M===0)ie[a++]=N&65535;else if(M&16){z=N&65535,M&=15,M&&(S<M&&(v+=G[n++]<<S,S+=8),z+=v&(1<<M)-1,v>>>=M,S-=M),S<15&&(v+=G[n++]<<S,S+=8,v+=G[n++]<<S,S+=8),N=P[v&L];r:for(;;){if(M=N>>>24,v>>>=M,S-=M,M=N>>>16&255,M&16){if(B=N&65535,M&=15,S<M&&(v+=G[n++]<<S,S+=8,S<M&&(v+=G[n++]<<S,S+=8)),B+=v&(1<<M)-1,B>u){e.msg="invalid distance too far back",J.mode=e2;break e}if(v>>>=M,S-=M,M=a-s,B>M){if(M=B-M,M>f&&J.sane){e.msg="invalid distance too far back",J.mode=e2;break e}if(q=0,W=b,d===0){if(q+=h-M,M<z){z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}}else if(d<M){if(q+=h+d-M,M-=d,M<z){z-=M;do ie[a++]=b[q++];while(--M);if(q=0,d<z){M=d,z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}}}else if(q+=d-M,M<z){z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}for(;z>2;)ie[a++]=W[q++],ie[a++]=W[q++],ie[a++]=W[q++],z-=3;z&&(ie[a++]=W[q++],z>1&&(ie[a++]=W[q++]))}else{q=a-B;do ie[a++]=ie[q++],ie[a++]=ie[q++],ie[a++]=ie[q++],z-=3;while(z>2);z&&(ie[a++]=ie[q++],z>1&&(ie[a++]=ie[q++]))}}else if((M&64)===0){N=P[(N&65535)+(v&(1<<M)-1)];continue r}else{e.msg="invalid distance code",J.mode=e2;break e}break}}else if((M&64)===0){N=E[(N&65535)+(v&(1<<M)-1)];continue t}else if(M&32){J.mode=Ime;break e}else{e.msg="invalid literal/length code",J.mode=e2;break e}break}}while(n<i&&a<o);z=S>>3,n-=z,S-=z<<3,v&=(1<<S)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<o?257+(o-a):257-(a-o),J.hold=v,J.bits=S};const Iy=15,U8=852,V8=592,$8=0,E3=1,q8=2,kme=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Mme=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Rme=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ome=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Nme=(t,e,r,n,i,a,s,o)=>{const u=o.bits;let h=0,f=0,d=0,b=0,v=0,S=0,E=0,P=0,k=0,L=0,N,M,z,B,q,W=null,G;const ie=new Uint16Array(Iy+1),J=new Uint16Array(Iy+1);let H=null,ne,ae,ue;for(h=0;h<=Iy;h++)ie[h]=0;for(f=0;f<n;f++)ie[e[r+f]]++;for(v=u,b=Iy;b>=1&&ie[b]===0;b--);if(v>b&&(v=b),b===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<b&&ie[d]===0;d++);for(v<d&&(v=d),P=1,h=1;h<=Iy;h++)if(P<<=1,P-=ie[h],P<0)return-1;if(P>0&&(t===$8||b!==1))return-1;for(J[1]=0,h=1;h<Iy;h++)J[h+1]=J[h]+ie[h];for(f=0;f<n;f++)e[r+f]!==0&&(s[J[e[r+f]]++]=f);if(t===$8?(W=H=s,G=20):t===E3?(W=kme,H=Mme,G=257):(W=Rme,H=Ome,G=0),L=0,f=0,h=d,q=a,S=v,E=0,z=-1,k=1<<v,B=k-1,t===E3&&k>U8||t===q8&&k>V8)return 1;for(;;){ne=h-E,s[f]+1<G?(ae=0,ue=s[f]):s[f]>=G?(ae=H[s[f]-G],ue=W[s[f]-G]):(ae=96,ue=0),N=1<<h-E,M=1<<S,d=M;do M-=N,i[q+(L>>E)+M]=ne<<24|ae<<16|ue|0;while(M!==0);for(N=1<<h-1;L&N;)N>>=1;if(N!==0?(L&=N-1,L+=N):L=0,f++,--ie[h]===0){if(h===b)break;h=e[r+s[f]]}if(h>v&&(L&B)!==z){for(E===0&&(E=v),q+=d,S=h-E,P=1<<S;S+E<b&&(P-=ie[S+E],!(P<=0));)S++,P<<=1;if(k+=1<<S,t===E3&&k>U8||t===q8&&k>V8)return 1;z=L&B,i[z]=v<<24|S<<16|q-a|0}}return L!==0&&(i[q+L]=h-E<<24|64<<16|0),o.bits=v,0};var T1=Nme;const Lme=0,oX=1,sX=2,{Z_FINISH:H8,Z_BLOCK:Dme,Z_TREES:t2,Z_OK:ym,Z_STREAM_END:Fme,Z_NEED_DICT:Bme,Z_STREAM_ERROR:Ih,Z_DATA_ERROR:lX,Z_MEM_ERROR:uX,Z_BUF_ERROR:zme,Z_DEFLATED:W8}=nX,aT=16180,G8=16181,X8=16182,Y8=16183,Z8=16184,K8=16185,J8=16186,Q8=16187,eB=16188,tB=16189,Jw=16190,Ad=16191,T3=16192,rB=16193,C3=16194,nB=16195,iB=16196,aB=16197,oB=16198,r2=16199,n2=16200,sB=16201,lB=16202,uB=16203,cB=16204,hB=16205,A3=16206,fB=16207,dB=16208,rs=16209,cX=16210,hX=16211,jme=852,Ume=592,Vme=15,$me=Vme,pB=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function qme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zm=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<aT||e.mode>hX?1:0},fX=t=>{if(zm(t))return Ih;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=aT,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(jme),e.distcode=e.distdyn=new Int32Array(Ume),e.sane=1,e.back=-1,ym},dX=t=>{if(zm(t))return Ih;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,fX(t)},pX=(t,e)=>{let r;if(zm(t))return Ih;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ih:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,dX(t))},gX=(t,e)=>{if(!t)return Ih;const r=new qme;t.state=r,r.strm=t,r.window=null,r.mode=aT;const n=pX(t,e);return n!==ym&&(t.state=null),n},Hme=t=>gX(t,$me);let gB=!0,I3,P3;const Wme=t=>{if(gB){I3=new Int32Array(512),P3=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(T1(oX,t.lens,0,288,I3,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;T1(sX,t.lens,0,32,P3,0,t.work,{bits:5}),gB=!1}t.lencode=I3,t.lenbits=9,t.distcode=P3,t.distbits=5},mX=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Gme=(t,e)=>{let r,n,i,a,s,o,u,h,f,d,b,v,S,E,P=0,k,L,N,M,z,B,q,W;const G=new Uint8Array(4);let ie,J;const H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zm(t)||!t.output||!t.input&&t.avail_in!==0)return Ih;r=t.state,r.mode===Ad&&(r.mode=T3),s=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,f=r.bits,d=o,b=u,W=ym;e:for(;;)switch(r.mode){case aT:if(r.wrap===0){r.mode=T3;break}for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&2&&h===35615){r.wbits===0&&(r.wbits=15),r.check=0,G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0),h=0,f=0,r.mode=G8;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=rs;break}if((h&15)!==W8){t.msg="unknown compression method",r.mode=rs;break}if(h>>>=4,f-=4,q=(h&15)+8,r.wbits===0&&(r.wbits=q),q>15||q>r.wbits){t.msg="invalid window size",r.mode=rs;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=h&512?tB:Ad,h=0,f=0;break;case G8:for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.flags=h,(r.flags&255)!==W8){t.msg="unknown compression method",r.mode=rs;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=rs;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0,r.mode=X8;case X8:for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.head&&(r.head.time=h),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,G[2]=h>>>16&255,G[3]=h>>>24&255,r.check=Nf(r.check,G,4,0)),h=0,f=0,r.mode=Y8;case Y8:for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0,r.mode=Z8;case Z8:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0}else r.head&&(r.head.extra=null);r.mode=K8;case K8:if(r.flags&1024&&(v=r.length,v>o&&(v=o),v&&(r.head&&(q=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+v),q)),r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,r.length-=v),r.length))break e;r.length=0,r.mode=J8;case J8:if(r.flags&2048){if(o===0)break e;v=0;do q=n[a+v++],r.head&&q&&r.length<65536&&(r.head.name+=String.fromCharCode(q));while(q&&v<o);if(r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,q)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Q8;case Q8:if(r.flags&4096){if(o===0)break e;v=0;do q=n[a+v++],r.head&&q&&r.length<65536&&(r.head.comment+=String.fromCharCode(q));while(q&&v<o);if(r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,q)break e}else r.head&&(r.head.comment=null);r.mode=eB;case eB:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&4&&h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=rs;break}h=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ad;break;case tB:for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}t.adler=r.check=pB(h),h=0,f=0,r.mode=Jw;case Jw:if(r.havedict===0)return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,Bme;t.adler=r.check=1,r.mode=Ad;case Ad:if(e===Dme||e===t2)break e;case T3:if(r.last){h>>>=f&7,f-=f&7,r.mode=A3;break}for(;f<3;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}switch(r.last=h&1,h>>>=1,f-=1,h&3){case 0:r.mode=rB;break;case 1:if(Wme(r),r.mode=r2,e===t2){h>>>=2,f-=2;break e}break;case 2:r.mode=iB;break;case 3:t.msg="invalid block type",r.mode=rs}h>>>=2,f-=2;break;case rB:for(h>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=rs;break}if(r.length=h&65535,h=0,f=0,r.mode=C3,e===t2)break e;case C3:r.mode=nB;case nB:if(v=r.length,v){if(v>o&&(v=o),v>u&&(v=u),v===0)break e;i.set(n.subarray(a,a+v),s),o-=v,a+=v,u-=v,s+=v,r.length-=v;break}r.mode=Ad;break;case iB:for(;f<14;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.nlen=(h&31)+257,h>>>=5,f-=5,r.ndist=(h&31)+1,h>>>=5,f-=5,r.ncode=(h&15)+4,h>>>=4,f-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=rs;break}r.have=0,r.mode=aB;case aB:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.lens[H[r.have++]]=h&7,h>>>=3,f-=3}for(;r.have<19;)r.lens[H[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ie={bits:r.lenbits},W=T1(Lme,r.lens,0,19,r.lencode,0,r.work,ie),r.lenbits=ie.bits,W){t.msg="invalid code lengths set",r.mode=rs;break}r.have=0,r.mode=oB;case oB:for(;r.have<r.nlen+r.ndist;){for(;P=r.lencode[h&(1<<r.lenbits)-1],k=P>>>24,L=P>>>16&255,N=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(N<16)h>>>=k,f-=k,r.lens[r.have++]=N;else{if(N===16){for(J=k+2;f<J;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(h>>>=k,f-=k,r.have===0){t.msg="invalid bit length repeat",r.mode=rs;break}q=r.lens[r.have-1],v=3+(h&3),h>>>=2,f-=2}else if(N===17){for(J=k+3;f<J;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=k,f-=k,q=0,v=3+(h&7),h>>>=3,f-=3}else{for(J=k+7;f<J;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=k,f-=k,q=0,v=11+(h&127),h>>>=7,f-=7}if(r.have+v>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=rs;break}for(;v--;)r.lens[r.have++]=q}}if(r.mode===rs)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=rs;break}if(r.lenbits=9,ie={bits:r.lenbits},W=T1(oX,r.lens,0,r.nlen,r.lencode,0,r.work,ie),r.lenbits=ie.bits,W){t.msg="invalid literal/lengths set",r.mode=rs;break}if(r.distbits=6,r.distcode=r.distdyn,ie={bits:r.distbits},W=T1(sX,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ie),r.distbits=ie.bits,W){t.msg="invalid distances set",r.mode=rs;break}if(r.mode=r2,e===t2)break e;case r2:r.mode=n2;case n2:if(o>=6&&u>=258){t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,Pme(t,b),s=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,f=r.bits,r.mode===Ad&&(r.back=-1);break}for(r.back=0;P=r.lencode[h&(1<<r.lenbits)-1],k=P>>>24,L=P>>>16&255,N=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(L&&(L&240)===0){for(M=k,z=L,B=N;P=r.lencode[B+((h&(1<<M+z)-1)>>M)],k=P>>>24,L=P>>>16&255,N=P&65535,!(M+k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=M,f-=M,r.back+=M}if(h>>>=k,f-=k,r.back+=k,r.length=N,L===0){r.mode=hB;break}if(L&32){r.back=-1,r.mode=Ad;break}if(L&64){t.msg="invalid literal/length code",r.mode=rs;break}r.extra=L&15,r.mode=sB;case sB:if(r.extra){for(J=r.extra;f<J;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=lB;case lB:for(;P=r.distcode[h&(1<<r.distbits)-1],k=P>>>24,L=P>>>16&255,N=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if((L&240)===0){for(M=k,z=L,B=N;P=r.distcode[B+((h&(1<<M+z)-1)>>M)],k=P>>>24,L=P>>>16&255,N=P&65535,!(M+k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=M,f-=M,r.back+=M}if(h>>>=k,f-=k,r.back+=k,L&64){t.msg="invalid distance code",r.mode=rs;break}r.offset=N,r.extra=L&15,r.mode=uB;case uB:if(r.extra){for(J=r.extra;f<J;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=rs;break}r.mode=cB;case cB:if(u===0)break e;if(v=b-u,r.offset>v){if(v=r.offset-v,v>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=rs;break}v>r.wnext?(v-=r.wnext,S=r.wsize-v):S=r.wnext-v,v>r.length&&(v=r.length),E=r.window}else E=i,S=s-r.offset,v=r.length;v>u&&(v=u),u-=v,r.length-=v;do i[s++]=E[S++];while(--v);r.length===0&&(r.mode=n2);break;case hB:if(u===0)break e;i[s++]=r.length,u--,r.mode=n2;break;case A3:if(r.wrap){for(;f<32;){if(o===0)break e;o--,h|=n[a++]<<f,f+=8}if(b-=u,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?Nf(r.check,i,b,s-b):GP(r.check,i,b,s-b)),b=u,r.wrap&4&&(r.flags?h:pB(h))!==r.check){t.msg="incorrect data check",r.mode=rs;break}h=0,f=0}r.mode=fB;case fB:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&4&&h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=rs;break}h=0,f=0}r.mode=dB;case dB:W=Fme;break e;case rs:W=lX;break e;case cX:return uX;case hX:default:return Ih}return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,(r.wsize||b!==t.avail_out&&r.mode<rs&&(r.mode<A3||e!==H8))&&mX(t,t.output,t.next_out,b-t.avail_out),d-=t.avail_in,b-=t.avail_out,t.total_in+=d,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?Nf(r.check,i,b,t.next_out-b):GP(r.check,i,b,t.next_out-b)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ad?128:0)+(r.mode===r2||r.mode===C3?256:0),(d===0&&b===0||e===H8)&&W===ym&&(W=zme),W},Xme=t=>{if(zm(t))return Ih;let e=t.state;return e.window&&(e.window=null),t.state=null,ym},Yme=(t,e)=>{if(zm(t))return Ih;const r=t.state;return(r.wrap&2)===0?Ih:(r.head=e,e.done=!1,ym)},Zme=(t,e)=>{const r=e.length;let n,i,a;return zm(t)||(n=t.state,n.wrap!==0&&n.mode!==Jw)?Ih:n.mode===Jw&&(i=1,i=GP(i,e,r,0),i!==n.check)?lX:(a=mX(t,e,r,r),a?(n.mode=cX,uX):(n.havedict=1,ym))};var Kme=dX,Jme=pX,Qme=fX,eye=Hme,tye=gX,rye=Gme,nye=Xme,iye=Yme,aye=Zme,oye="pako inflate (from Nodeca project)",Md={inflateReset:Kme,inflateReset2:Jme,inflateResetKeep:Qme,inflateInit:eye,inflateInit2:tye,inflate:rye,inflateEnd:nye,inflateGetHeader:iye,inflateSetDictionary:aye,inflateInfo:oye};function sye(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var lye=sye;const yX=Object.prototype.toString,{Z_NO_FLUSH:uye,Z_FINISH:cye,Z_OK:tb,Z_STREAM_END:k3,Z_NEED_DICT:M3,Z_STREAM_ERROR:hye,Z_DATA_ERROR:mB,Z_MEM_ERROR:fye}=nX;function Xb(t){this.options=iX.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ame,this.strm.avail_out=0;let r=Md.inflateInit2(this.strm,e.windowBits);if(r!==tb)throw new Error(XP[r]);if(this.header=new lye,Md.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=YP.string2buf(e.dictionary):yX.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Md.inflateSetDictionary(this.strm,e.dictionary),r!==tb)))throw new Error(XP[r])}Xb.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?cye:uye,yX.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Md.inflate(r,s),a===M3&&i&&(a=Md.inflateSetDictionary(r,i),a===tb?a=Md.inflate(r,s):a===mB&&(a=M3));r.avail_in>0&&a===k3&&r.state.wrap>0&&t[r.next_in]!==0;)Md.inflateReset(r),a=Md.inflate(r,s);switch(a){case hye:case mB:case M3:case fye:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===k3))if(this.options.to==="string"){let u=YP.utf8border(r.output,r.next_out),h=r.next_out-u,f=YP.buf2string(r.output,u);r.next_out=h,r.avail_out=n-h,h&&r.output.set(r.output.subarray(u,u+h),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===tb&&o===0)){if(a===k3)return a=Md.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Xb.prototype.onData=function(t){this.chunks.push(t)};Xb.prototype.onEnd=function(t){t===tb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=iX.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function dye(t,e){const r=new Xb(e);if(r.push(t),r.err)throw r.msg||XP[r.err];return r.result}var pye=Xb,gye=dye,mye={Inflate:pye,inflate:gye};const{Inflate:yye,inflate:vye}=mye;var yB=yye,_ye=vye;const vX=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;vX[t]=e}const vB=4294967295;function bye(t,e,r){let n=t;for(let i=0;i<r;i++)n=vX[(n^e[i])&255]^n>>>8;return n}function xye(t,e){return(bye(vB,t,e)^vB)>>>0}function _B(t,e,r){const n=t.readUint32(),i=xye(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function _X(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function bX(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function xX(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function wX(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function SX(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+wye(e[a-i],r[a],r[a-i])&255}}function wye(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r}function Sye(t,e,r,n,i,a){switch(t){case 0:_X(e,r,i);break;case 1:bX(e,r,i,a);break;case 2:xX(e,r,n,i);break;case 3:wX(e,r,n,i,a);break;case 4:SX(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Eye=new Uint16Array([255]),Tye=new Uint8Array(Eye.buffer),Cye=Tye[0]===255;function Aye(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,u=new Uint8Array(n*r*o);let h=0;for(let f=0;f<7;f++){const d=s[f],b=Math.ceil((r-d.x)/d.xStep),v=Math.ceil((n-d.y)/d.yStep);if(b<=0||v<=0)continue;const S=b*o,E=new Uint8Array(S);for(let P=0;P<v;P++){const k=e[h++],L=e.subarray(h,h+S);h+=S;const N=new Uint8Array(S);Sye(k,L,N,E,S,o),E.set(N);for(let M=0;M<b;M++){const z=d.x+M*d.xStep,B=d.y+P*d.yStep;if(!(z>=r||B>=n))for(let q=0;q<o;q++)u[(B*r+z)*o+q]=N[M*o+q]}}}if(a===16){const f=new Uint16Array(u.buffer);if(Cye)for(let d=0;d<f.length;d++)f[d]=Iye(f[d]);return f}else return u}function Iye(t){return(t&255)<<8|t>>8&255}const Pye=new Uint16Array([255]),kye=new Uint8Array(Pye.buffer),Mye=kye[0]===255,Rye=new Uint8Array(0);function bB(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),u=new Uint8Array(n*o);let h=Rye,f=0,d,b;for(let v=0;v<n;v++){switch(d=e.subarray(f+1,f+1+o),b=u.subarray(v*o,(v+1)*o),e[f]){case 0:_X(d,b,o);break;case 1:bX(d,b,o,s);break;case 2:xX(d,b,h,o);break;case 3:wX(d,b,h,o,s);break;case 4:SX(d,b,h,o,s);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}h=b,f+=o+1}if(a===16){const v=new Uint16Array(u.buffer);if(Mye)for(let S=0;S<v.length;S++)v[S]=Oye(v[S]);return v}else return u}function Oye(t){return(t&255)<<8|t>>8&255}const hw=Uint8Array.of(137,80,78,71,13,10,26,10);function xB(t){if(!Nye(t.readBytes(hw.length)))throw new Error("wrong PNG signature")}function Nye(t){if(t.length<hw.length)return!1;for(let e=0;e<hw.length;e++)if(t[e]!==hw[e])return!1;return!0}const Lye="tEXt",Dye=0,EX=new TextDecoder("latin1");function Fye(t){if(zye(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Bye=/^[\u0000-\u00FF]*$/;function zye(t){if(!Bye.test(t))throw new Error("invalid latin1 text")}function jye(t,e,r){const n=TX(e);t[n]=Uye(e,r-n.length-1)}function TX(t){for(t.mark();t.readByte()!==Dye;);const e=t.offset;t.reset();const r=EX.decode(t.readBytes(e-t.offset-1));return t.skip(1),Fye(r),r}function Uye(t,e){return EX.decode(t.readBytes(e))}const qc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},R3={UNKNOWN:-1,DEFLATE:0},wB={UNKNOWN:-1,ADAPTIVE:0},O3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},i2={NONE:0,BACKGROUND:1,PREVIOUS:2},N3={SOURCE:0,OVER:1};class Vye extends pO{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new yB,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=R3.UNKNOWN,this._filterMethod=wB.UNKNOWN,this._interlaceMethod=O3.UNKNOWN,this._colorType=qc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(xB(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(xB(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Lye:jye(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?_B(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?_B(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=$ye(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case qc.GREYSCALE:n=1;break;case qc.TRUECOLOUR:n=3;break;case qc.INDEXED_COLOUR:n=1;break;case qc.GREYSCALE_ALPHA:n=2;break;case qc.TRUECOLOUR_ALPHA:n=4;break;case qc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==R3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case qc.GREYSCALE:case qc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case qc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case qc.UNKNOWN:case qc.GREYSCALE_ALPHA:case qc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=TX(this),n=this.readUint8();if(n!==R3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:_ye(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=bB({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case i2.NONE:break;case i2.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const s=(i*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case i2.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,s)=>{const o=((a+r.yOffset)*this._png.width+r.xOffset+s)*this._png.channels,u=(a*r.width+s)*this._png.channels;return{index:o,frameIndex:u}};switch(r.blendOp){case N3.SOURCE:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:u}=i(a,s);for(let h=0;h<this._png.channels;h++)e.data[o+h]=r.data[u+h]}break;case N3.OVER:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:u}=i(a,s);for(let h=0;h<this._png.channels;h++){const f=r.data[u+this._png.channels-1]/n,d=h%(this._png.channels-1)===0?1:r.data[u+h],b=Math.floor(f*d+(1-f)*e.data[o+h]);e.data[o+h]+=b}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==wB.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===O3.NO_INTERLACE)this._png.data=bB({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===O3.ADAM7)this._png.data=Aye({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:i2.NONE,blendOp:N3.SOURCE,data:e}),this._inflator=new yB,this._writingDataChunks=!1}}function $ye(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var SB;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(SB||(SB={}));function qye(t,e){return new Vye(t,e).decode()}var Ni=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function L3(){Ni.console&&typeof Ni.console.log=="function"&&Ni.console.log.apply(Ni.console,arguments)}var ko={log:L3,warn:function(t){Ni.console&&(typeof Ni.console.warn=="function"?Ni.console.warn.apply(Ni.console,arguments):L3.call(null,arguments))},error:function(t){Ni.console&&(typeof Ni.console.error=="function"?Ni.console.error.apply(Ni.console,arguments):L3(t))}};function D3(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){jg(n.response,e,r)},n.onerror=function(){ko.error("could not download file")},n.send()}function EB(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function a2(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var jg=Ni.saveAs||((typeof window>"u"?"undefined":ao(window))!=="object"||window!==Ni?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ni.URL||Ni.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?EB(i.href)?D3(t,e,r):a2(i,i.target="_blank"):a2(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){a2(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(EB(t))D3(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){a2(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:ao(a)!=="object"&&(ko.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return D3(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Ni.HTMLElement)||Ni.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":ao(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(t)}else{var u=Ni.URL||Ni.webkitURL,h=u.createObjectURL(t);n?n.location=h:location.href=h,n=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function CX(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+o+u+h}}var fw=Ni.atob.bind(Ni),TB=Ni.btoa.bind(Ni);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function F3(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Nu(r,n,i,a,e[0],7,-680876936),a=Nu(a,r,n,i,e[1],12,-389564586),i=Nu(i,a,r,n,e[2],17,606105819),n=Nu(n,i,a,r,e[3],22,-1044525330),r=Nu(r,n,i,a,e[4],7,-176418897),a=Nu(a,r,n,i,e[5],12,1200080426),i=Nu(i,a,r,n,e[6],17,-1473231341),n=Nu(n,i,a,r,e[7],22,-45705983),r=Nu(r,n,i,a,e[8],7,1770035416),a=Nu(a,r,n,i,e[9],12,-1958414417),i=Nu(i,a,r,n,e[10],17,-42063),n=Nu(n,i,a,r,e[11],22,-1990404162),r=Nu(r,n,i,a,e[12],7,1804603682),a=Nu(a,r,n,i,e[13],12,-40341101),i=Nu(i,a,r,n,e[14],17,-1502002290),r=Lu(r,n=Nu(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Lu(a,r,n,i,e[6],9,-1069501632),i=Lu(i,a,r,n,e[11],14,643717713),n=Lu(n,i,a,r,e[0],20,-373897302),r=Lu(r,n,i,a,e[5],5,-701558691),a=Lu(a,r,n,i,e[10],9,38016083),i=Lu(i,a,r,n,e[15],14,-660478335),n=Lu(n,i,a,r,e[4],20,-405537848),r=Lu(r,n,i,a,e[9],5,568446438),a=Lu(a,r,n,i,e[14],9,-1019803690),i=Lu(i,a,r,n,e[3],14,-187363961),n=Lu(n,i,a,r,e[8],20,1163531501),r=Lu(r,n,i,a,e[13],5,-1444681467),a=Lu(a,r,n,i,e[2],9,-51403784),i=Lu(i,a,r,n,e[7],14,1735328473),r=Du(r,n=Lu(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=Du(a,r,n,i,e[8],11,-2022574463),i=Du(i,a,r,n,e[11],16,1839030562),n=Du(n,i,a,r,e[14],23,-35309556),r=Du(r,n,i,a,e[1],4,-1530992060),a=Du(a,r,n,i,e[4],11,1272893353),i=Du(i,a,r,n,e[7],16,-155497632),n=Du(n,i,a,r,e[10],23,-1094730640),r=Du(r,n,i,a,e[13],4,681279174),a=Du(a,r,n,i,e[0],11,-358537222),i=Du(i,a,r,n,e[3],16,-722521979),n=Du(n,i,a,r,e[6],23,76029189),r=Du(r,n,i,a,e[9],4,-640364487),a=Du(a,r,n,i,e[12],11,-421815835),i=Du(i,a,r,n,e[15],16,530742520),r=Fu(r,n=Du(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Fu(a,r,n,i,e[7],10,1126891415),i=Fu(i,a,r,n,e[14],15,-1416354905),n=Fu(n,i,a,r,e[5],21,-57434055),r=Fu(r,n,i,a,e[12],6,1700485571),a=Fu(a,r,n,i,e[3],10,-1894986606),i=Fu(i,a,r,n,e[10],15,-1051523),n=Fu(n,i,a,r,e[1],21,-2054922799),r=Fu(r,n,i,a,e[8],6,1873313359),a=Fu(a,r,n,i,e[15],10,-30611744),i=Fu(i,a,r,n,e[6],15,-1560198380),n=Fu(n,i,a,r,e[13],21,1309151649),r=Fu(r,n,i,a,e[4],6,-145523070),a=Fu(a,r,n,i,e[11],10,-1120210379),i=Fu(i,a,r,n,e[2],15,718787259),n=Fu(n,i,a,r,e[9],21,-343485551),t[0]=Fp(r,t[0]),t[1]=Fp(n,t[1]),t[2]=Fp(i,t[2]),t[3]=Fp(a,t[3])}function oT(t,e,r,n,i,a){return e=Fp(Fp(e,t),Fp(n,a)),Fp(e<<i|e>>>32-i,r)}function Nu(t,e,r,n,i,a,s){return oT(e&r|~e&n,t,e,i,a,s)}function Lu(t,e,r,n,i,a,s){return oT(e&n|r&~n,t,e,i,a,s)}function Du(t,e,r,n,i,a,s){return oT(e^r^n,t,e,i,a,s)}function Fu(t,e,r,n,i,a,s){return oT(r^(e|~n),t,e,i,a,s)}function AX(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)F3(n,Hye(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(F3(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,F3(n,i),n}function Hye(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var CB="0123456789abcdef".split("");function Wye(t){for(var e="",r=0;r<4;r++)e+=CB[t>>8*r+4&15]+CB[t>>8*r&15];return e}function Gye(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function ZP(t){return AX(t).map(Gye).join("")}var Xye=(function(t){for(var e=0;e<t.length;e++)t[e]=Wye(t[e]);return t.join("")})(AX("hello"))!="5d41402abc4b2a76b9719d911017c592";function Fp(t,e){if(Xye){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function KP(t,e){var r,n,i,a;if(t!==r){for(var s=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),o=[],u=0;u<256;u++)o[u]=u;var h=0;for(u=0;u<256;u++){var f=o[u];h=(h+f+s.charCodeAt(u))%256,o[u]=o[h],o[h]=f}r=t,n=o}else o=n;var d=e.length,b=0,v=0,S="";for(u=0;u<d;u++)v=(v+(f=o[b=(b+1)%256]))%256,o[b]=o[v],o[v]=f,s=o[(o[b]+o[v])%256],S+=String.fromCharCode(e.charCodeAt(u)^s);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var AB={print:4,modify:8,copy:16,"annot-forms":32};function Zy(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(o){if(AB.perm!==void 0)throw new Error("Invalid permission: "+o);i+=AB[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var a=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=ZP(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=KP(this.encryptionKey,this.padding)}function Ky(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function IB(t){if(ao(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var s=e[r][a];try{s[0].apply(t,n)}catch(o){Ni.console&&ko.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Qw(t){if(!(this instanceof Qw))return new Qw(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function IX(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function $g(t,e,r,n,i){if(!(this instanceof $g))return new $g(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,IX.call(this,n,i)}function _v(t,e,r,n,i){if(!(this instanceof _v))return new _v(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,IX.call(this,n,i)}function hi(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,u=16,h="S",f=null;ao(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),h=t.defaultPathOperation||"S"),s=t.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,b={},v={internal:{},__private__:{}};v.__private__.PubSub=IB;var S="1.3",E=v.__private__.getPdfVersion=function(){return S};v.__private__.setPdfVersion=function(se){S=se};var P={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return P};var k=v.__private__.getPageFormat=function(se){return P[se]};i=i||"a4";var L="compat",N="advanced",M=L;function z(){this.saveGraphicsState(),Ve(new jr(er,0,0,-er,0,sa()*er).toString()+" cm"),this.setFontSize(this.getFontSize()/er),h="n",M=N}function B(){this.restoreGraphicsState(),h="S",M=L}var q=v.__private__.combineFontStyleAndFontWeight=function(se,qe){if(se=="bold"&&qe=="normal"||se=="bold"&&qe==400||se=="normal"&&qe=="italic"||se=="bold"&&qe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return qe&&(se=qe==400||qe==="normal"?se==="italic"?"italic":"normal":qe!=700&&qe!=="bold"||se!=="normal"?(qe==700?"bold":qe)+""+se:"bold"),se};v.advancedAPI=function(se){var qe=M===L;return qe&&z.call(this),typeof se!="function"||(se(this),qe&&B.call(this)),this},v.compatAPI=function(se){var qe=M===N;return qe&&B.call(this),typeof se!="function"||(se(this),qe&&z.call(this)),this},v.isAdvancedAPI=function(){return M===N};var W,G=function(se){if(M!==N)throw new Error(se+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ie=v.roundToPrecision=v.__private__.roundToPrecision=function(se,qe){var dt=e||qe;if(isNaN(se)||isNaN(dt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return se.toFixed(dt).replace(/0+$/,"")};W=v.hpf=v.__private__.hpf=typeof u=="number"?function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(se,u)}:u==="smart"?function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(se,se>-1&&se<1?16:5)}:function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(se,16)};var J=v.f2=v.__private__.f2=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.f2");return ie(se,2)},H=v.__private__.f3=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.f3");return ie(se,3)},ne=v.scale=v.__private__.scale=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.scale");return M===L?se*er:M===N?se:void 0},ae=function(se){return ne((function(qe){return M===L?sa()-qe:M===N?qe:void 0})(se))};v.__private__.setPrecision=v.setPrecision=function(se){typeof parseInt(se,10)=="number"&&(e=parseInt(se,10))};var ue,de="00000000000000000000000000000000",Pe=v.__private__.getFileId=function(){return de},me=v.__private__.setFileId=function(se){return de=se!==void 0&&/^[a-fA-F0-9]{32}$/.test(se)?se.toUpperCase():de.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Va=new Zy(f.userPermissions,f.userPassword,f.ownerPassword,de)),de};v.setFileId=function(se){return me(se),this},v.getFileId=function(){return Pe()};var Ee=v.__private__.convertDateToPDFDate=function(se){var qe=se.getTimezoneOffset(),dt=qe<0?"+":"-",Vt=Math.floor(Math.abs(qe/60)),sr=Math.abs(qe%60),Vr=[dt,_e(Vt),"'",_e(sr),"'"].join("");return["D:",se.getFullYear(),_e(se.getMonth()+1),_e(se.getDate()),_e(se.getHours()),_e(se.getMinutes()),_e(se.getSeconds()),Vr].join("")},we=v.__private__.convertPDFDateToDate=function(se){var qe=parseInt(se.substr(2,4),10),dt=parseInt(se.substr(6,2),10)-1,Vt=parseInt(se.substr(8,2),10),sr=parseInt(se.substr(10,2),10),Vr=parseInt(se.substr(12,2),10),rn=parseInt(se.substr(14,2),10);return new Date(qe,dt,Vt,sr,Vr,rn,0)},Ae=v.__private__.setCreationDate=function(se){var qe;if(se===void 0&&(se=new Date),se instanceof Date)qe=Ee(se);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(se))throw new Error("Invalid argument passed to jsPDF.setCreationDate");qe=se}return ue=qe},ce=v.__private__.getCreationDate=function(se){var qe=ue;return se==="jsDate"&&(qe=we(ue)),qe};v.setCreationDate=function(se){return Ae(se),this},v.getCreationDate=function(se){return ce(se)};var xe,_e=v.__private__.padd2=function(se){return("0"+parseInt(se)).slice(-2)},Me=v.__private__.padd2Hex=function(se){return("00"+(se=se.toString())).substr(se.length)},Re=0,He=[],Fe=[],tt=0,Ze=[],Qe=[],Ie=!1,Lt=Fe;v.__private__.setCustomOutputDestination=function(se){Ie=!0,Lt=se};var at=function(se){Ie||(Lt=se)};v.__private__.resetCustomOutputDestination=function(){Ie=!1,Lt=Fe};var Ve=v.__private__.out=function(se){return se=se.toString(),tt+=se.length+1,Lt.push(se),Lt},nr=v.__private__.write=function(se){return Ve(arguments.length===1?se.toString():Array.prototype.join.call(arguments," "))},Yt=v.__private__.getArrayBuffer=function(se){for(var qe=se.length,dt=new ArrayBuffer(qe),Vt=new Uint8Array(dt);qe--;)Vt[qe]=se.charCodeAt(qe);return dt},yr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return yr};var mt=t.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(se){return mt=M===N?se/er:se,this};var br,Tr=v.__private__.getFontSize=v.getFontSize=function(){return M===L?mt:mt*er},mr=t.R2L||!1;v.__private__.setR2L=v.setR2L=function(se){return mr=se,this},v.__private__.getR2L=v.getR2L=function(){return mr};var Mr,Pr=v.__private__.setZoomMode=function(se){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(se))br=se;else if(isNaN(se)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(se)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+se+'" is not recognized.');br=se}else br=parseInt(se,10)};v.__private__.getZoomMode=function(){return br};var ar,fr=v.__private__.setPageMode=function(se){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(se)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+se+'" is not recognized.');Mr=se};v.__private__.getPageMode=function(){return Mr};var Nr=v.__private__.setLayoutMode=function(se){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(se)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+se+'" is not recognized.');ar=se};v.__private__.getLayoutMode=function(){return ar},v.__private__.setDisplayMode=v.setDisplayMode=function(se,qe,dt){return Pr(se),Nr(qe),fr(dt),this};var or={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(se){if(Object.keys(or).indexOf(se)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return or[se]},v.__private__.getDocumentProperties=function(){return or},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(se){for(var qe in or)or.hasOwnProperty(qe)&&se[qe]&&(or[qe]=se[qe]);return this},v.__private__.setDocumentProperty=function(se,qe){if(Object.keys(or).indexOf(se)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return or[se]=qe};var Dr,er,Gt,Tt,Oe,Be={},Ne={},rt=[],pt={},Rt={},Bt={},At={},Zt=null,jt=0,St=[],Xt=new IB(v),Ct=t.hotfixes||[],Lr={},qt={},Zr=[],jr=function se(qe,dt,Vt,sr,Vr,rn){if(!(this instanceof se))return new se(qe,dt,Vt,sr,Vr,rn);isNaN(qe)&&(qe=1),isNaN(dt)&&(dt=0),isNaN(Vt)&&(Vt=0),isNaN(sr)&&(sr=1),isNaN(Vr)&&(Vr=0),isNaN(rn)&&(rn=0),this._matrix=[qe,dt,Vt,sr,Vr,rn]};Object.defineProperty(jr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(se){this._matrix[0]=se}}),Object.defineProperty(jr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(se){this._matrix[1]=se}}),Object.defineProperty(jr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(se){this._matrix[2]=se}}),Object.defineProperty(jr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(se){this._matrix[3]=se}}),Object.defineProperty(jr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(se){this._matrix[4]=se}}),Object.defineProperty(jr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(se){this._matrix[5]=se}}),Object.defineProperty(jr.prototype,"a",{get:function(){return this._matrix[0]},set:function(se){this._matrix[0]=se}}),Object.defineProperty(jr.prototype,"b",{get:function(){return this._matrix[1]},set:function(se){this._matrix[1]=se}}),Object.defineProperty(jr.prototype,"c",{get:function(){return this._matrix[2]},set:function(se){this._matrix[2]=se}}),Object.defineProperty(jr.prototype,"d",{get:function(){return this._matrix[3]},set:function(se){this._matrix[3]=se}}),Object.defineProperty(jr.prototype,"e",{get:function(){return this._matrix[4]},set:function(se){this._matrix[4]=se}}),Object.defineProperty(jr.prototype,"f",{get:function(){return this._matrix[5]},set:function(se){this._matrix[5]=se}}),Object.defineProperty(jr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(jr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(jr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(jr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),jr.prototype.join=function(se){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(se)},jr.prototype.multiply=function(se){var qe=se.sx*this.sx+se.shy*this.shx,dt=se.sx*this.shy+se.shy*this.sy,Vt=se.shx*this.sx+se.sy*this.shx,sr=se.shx*this.shy+se.sy*this.sy,Vr=se.tx*this.sx+se.ty*this.shx+this.tx,rn=se.tx*this.shy+se.ty*this.sy+this.ty;return new jr(qe,dt,Vt,sr,Vr,rn)},jr.prototype.decompose=function(){var se=this.sx,qe=this.shy,dt=this.shx,Vt=this.sy,sr=this.tx,Vr=this.ty,rn=Math.sqrt(se*se+qe*qe),kn=(se/=rn)*dt+(qe/=rn)*Vt;dt-=se*kn,Vt-=qe*kn;var Vn=Math.sqrt(dt*dt+Vt*Vt);return kn/=Vn,se*(Vt/=Vn)<qe*(dt/=Vn)&&(se=-se,qe=-qe,kn=-kn,rn=-rn),{scale:new jr(rn,0,0,Vn,0,0),translate:new jr(1,0,0,1,sr,Vr),rotate:new jr(se,qe,-qe,se,0,0),skew:new jr(1,0,kn,1,0,0)}},jr.prototype.toString=function(se){return this.join(" ")},jr.prototype.inversed=function(){var se=this.sx,qe=this.shy,dt=this.shx,Vt=this.sy,sr=this.tx,Vr=this.ty,rn=1/(se*Vt-qe*dt),kn=Vt*rn,Vn=-qe*rn,ci=-dt*rn,Ti=se*rn;return new jr(kn,Vn,ci,Ti,-kn*sr-ci*Vr,-Vn*sr-Ti*Vr)},jr.prototype.applyToPoint=function(se){var qe=se.x*this.sx+se.y*this.shx+this.tx,dt=se.x*this.shy+se.y*this.sy+this.ty;return new iu(qe,dt)},jr.prototype.applyToRectangle=function(se){var qe=this.applyToPoint(se),dt=this.applyToPoint(new iu(se.x+se.w,se.y+se.h));return new os(qe.x,qe.y,dt.x-qe.x,dt.y-qe.y)},jr.prototype.clone=function(){var se=this.sx,qe=this.shy,dt=this.shx,Vt=this.sy,sr=this.tx,Vr=this.ty;return new jr(se,qe,dt,Vt,sr,Vr)},v.Matrix=jr;var vn=v.matrixMult=function(se,qe){return qe.multiply(se)},Ce=new jr(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=Ce;var Ue=function(se,qe){if(!Rt[se]){var dt=(qe instanceof $g?"Sh":"P")+(Object.keys(pt).length+1).toString(10);qe.id=dt,Rt[se]=dt,pt[dt]=qe,Xt.publish("addPattern",qe)}};v.ShadingPattern=$g,v.TilingPattern=_v,v.addShadingPattern=function(se,qe){return G("addShadingPattern()"),Ue(se,qe),this},v.beginTilingPattern=function(se){G("beginTilingPattern()"),zl(se.boundingBox[0],se.boundingBox[1],se.boundingBox[2]-se.boundingBox[0],se.boundingBox[3]-se.boundingBox[1],se.matrix)},v.endTilingPattern=function(se,qe){G("endTilingPattern()"),qe.stream=Qe[xe].join(`
`),Ue(se,qe),Xt.publish("endTilingPattern",qe),Zr.pop().restore()};var ft,Mt=v.__private__.newObject=function(){var se=xr();return Kr(se,!0),se},xr=v.__private__.newObjectDeferred=function(){return Re++,He[Re]=function(){return tt},Re},Kr=function(se,qe){return qe=typeof qe=="boolean"&&qe,He[se]=tt,qe&&Ve(se+" 0 obj"),se},Rr=v.__private__.newAdditionalObject=function(){var se={objId:xr(),content:""};return Ze.push(se),se},di=xr(),ti=xr(),bi=v.__private__.decodeColorString=function(se){var qe=se.split(" ");if(qe.length!==2||qe[1]!=="g"&&qe[1]!=="G")qe.length!==5||qe[4]!=="k"&&qe[4]!=="K"||(qe=[(1-qe[0])*(1-qe[3]),(1-qe[1])*(1-qe[3]),(1-qe[2])*(1-qe[3]),"r"]);else{var dt=parseFloat(qe[0]);qe=[dt,dt,dt,"r"]}for(var Vt="#",sr=0;sr<3;sr++)Vt+=("0"+Math.floor(255*parseFloat(qe[sr])).toString(16)).slice(-2);return Vt},Ui=v.__private__.encodeColorString=function(se){var qe;typeof se=="string"&&(se={ch1:se});var dt=se.ch1,Vt=se.ch2,sr=se.ch3,Vr=se.ch4,rn=se.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof dt=="string"&&dt.charAt(0)!=="#"){var kn=new CX(dt);if(kn.ok)dt=kn.toHex();else if(!/^\d*\.?\d*$/.test(dt))throw new Error('Invalid color "'+dt+'" passed to jsPDF.encodeColorString.')}if(typeof dt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(dt)&&(dt="#"+dt[1]+dt[1]+dt[2]+dt[2]+dt[3]+dt[3]),typeof dt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(dt)){var Vn=parseInt(dt.substr(1),16);dt=Vn>>16&255,Vt=Vn>>8&255,sr=255&Vn}if(Vt===void 0||Vr===void 0&&dt===Vt&&Vt===sr)qe=typeof dt=="string"?dt+" "+rn[0]:se.precision===2?J(dt/255)+" "+rn[0]:H(dt/255)+" "+rn[0];else if(Vr===void 0||ao(Vr)==="object"){if(Vr&&!isNaN(Vr.a)&&Vr.a===0)return["1.","1.","1.",rn[1]].join(" ");qe=typeof dt=="string"?[dt,Vt,sr,rn[1]].join(" "):se.precision===2?[J(dt/255),J(Vt/255),J(sr/255),rn[1]].join(" "):[H(dt/255),H(Vt/255),H(sr/255),rn[1]].join(" ")}else qe=typeof dt=="string"?[dt,Vt,sr,Vr,rn[2]].join(" "):se.precision===2?[J(dt),J(Vt),J(sr),J(Vr),rn[2]].join(" "):[H(dt),H(Vt),H(sr),H(Vr),rn[2]].join(" ");return qe},Xr=v.__private__.getFilters=function(){return s},_n=v.__private__.putStream=function(se){var qe=(se=se||{}).data||"",dt=se.filters||Xr(),Vt=se.alreadyAppliedFilters||[],sr=se.addLength1||!1,Vr=qe.length,rn=se.objectId,kn=function(Aa){return Aa};if(f!==null&&rn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(kn=Va.encryptor(rn,0));var Vn={};dt===!0&&(dt=["FlateEncode"]);var ci=se.additionalKeyValues||[],Ti=(Vn=hi.API.processDataByFilters!==void 0?hi.API.processDataByFilters(qe,dt):{data:qe,reverseChain:[]}).reverseChain+(Array.isArray(Vt)?Vt.join(" "):Vt.toString());if(Vn.data.length!==0&&(ci.push({key:"Length",value:Vn.data.length}),sr===!0&&ci.push({key:"Length1",value:Vr})),Ti.length!=0)if(Ti.split("/").length-1==1)ci.push({key:"Filter",value:Ti});else{ci.push({key:"Filter",value:"["+Ti+"]"});for(var li=0;li<ci.length;li+=1)if(ci[li].key==="DecodeParms"){for(var $i=[],Si=0;Si<Vn.reverseChain.split("/").length-1;Si+=1)$i.push("null");$i.push(ci[li].value),ci[li].value="["+$i.join(" ")+"]"}}Ve("<<");for(var Ii=0;Ii<ci.length;Ii++)Ve("/"+ci[Ii].key+" "+ci[Ii].value);Ve(">>"),Vn.data.length!==0&&(Ve("stream"),Ve(kn(Vn.data)),Ve("endstream"))},Fn=v.__private__.putPage=function(se){var qe=se.number,dt=se.data,Vt=se.objId,sr=se.contentsObjId;Kr(Vt,!0),Ve("<</Type /Page"),Ve("/Parent "+se.rootDictionaryObjId+" 0 R"),Ve("/Resources "+se.resourceDictionaryObjId+" 0 R"),Ve("/MediaBox ["+parseFloat(W(se.mediaBox.bottomLeftX))+" "+parseFloat(W(se.mediaBox.bottomLeftY))+" "+W(se.mediaBox.topRightX)+" "+W(se.mediaBox.topRightY)+"]"),se.cropBox!==null&&Ve("/CropBox ["+W(se.cropBox.bottomLeftX)+" "+W(se.cropBox.bottomLeftY)+" "+W(se.cropBox.topRightX)+" "+W(se.cropBox.topRightY)+"]"),se.bleedBox!==null&&Ve("/BleedBox ["+W(se.bleedBox.bottomLeftX)+" "+W(se.bleedBox.bottomLeftY)+" "+W(se.bleedBox.topRightX)+" "+W(se.bleedBox.topRightY)+"]"),se.trimBox!==null&&Ve("/TrimBox ["+W(se.trimBox.bottomLeftX)+" "+W(se.trimBox.bottomLeftY)+" "+W(se.trimBox.topRightX)+" "+W(se.trimBox.topRightY)+"]"),se.artBox!==null&&Ve("/ArtBox ["+W(se.artBox.bottomLeftX)+" "+W(se.artBox.bottomLeftY)+" "+W(se.artBox.topRightX)+" "+W(se.artBox.topRightY)+"]"),typeof se.userUnit=="number"&&se.userUnit!==1&&Ve("/UserUnit "+se.userUnit),Xt.publish("putPage",{objId:Vt,pageContext:St[qe],pageNumber:qe,page:dt}),Ve("/Contents "+sr+" 0 R"),Ve(">>"),Ve("endobj");var Vr=dt.join(`
`);return M===N&&(Vr+=`
Q`),Kr(sr,!0),_n({data:Vr,filters:Xr(),objectId:sr}),Ve("endobj"),Vt},na=v.__private__.putPages=function(){var se,qe,dt=[];for(se=1;se<=jt;se++)St[se].objId=xr(),St[se].contentsObjId=xr();for(se=1;se<=jt;se++)dt.push(Fn({number:se,data:Qe[se],objId:St[se].objId,contentsObjId:St[se].contentsObjId,mediaBox:St[se].mediaBox,cropBox:St[se].cropBox,bleedBox:St[se].bleedBox,trimBox:St[se].trimBox,artBox:St[se].artBox,userUnit:St[se].userUnit,rootDictionaryObjId:di,resourceDictionaryObjId:ti}));Kr(di,!0),Ve("<</Type /Pages");var Vt="/Kids [";for(qe=0;qe<jt;qe++)Vt+=dt[qe]+" 0 R ";Ve(Vt+"]"),Ve("/Count "+jt),Ve(">>"),Ve("endobj"),Xt.publish("postPutPages")},Ca=function(se){Xt.publish("putFont",{font:se,out:Ve,newObject:Mt,putStream:_n}),se.isAlreadyPutted!==!0&&(se.objectNumber=Mt(),Ve("<<"),Ve("/Type /Font"),Ve("/BaseFont /"+Ky(se.postScriptName)),Ve("/Subtype /Type1"),typeof se.encoding=="string"&&Ve("/Encoding /"+se.encoding),Ve("/FirstChar 32"),Ve("/LastChar 255"),Ve(">>"),Ve("endobj"))},ua=function(se){se.objectNumber=Mt();var qe=[];qe.push({key:"Type",value:"/XObject"}),qe.push({key:"Subtype",value:"/Form"}),qe.push({key:"BBox",value:"["+[W(se.x),W(se.y),W(se.x+se.width),W(se.y+se.height)].join(" ")+"]"}),qe.push({key:"Matrix",value:"["+se.matrix.toString()+"]"});var dt=se.pages[1].join(`
`);_n({data:dt,additionalKeyValues:qe,objectId:se.objectNumber}),Ve("endobj")},Mn=function(se,qe){qe||(qe=21);var dt=Mt(),Vt=(function(rn,kn){var Vn,ci=[],Ti=1/(kn-1);for(Vn=0;Vn<1;Vn+=Ti)ci.push(Vn);if(ci.push(1),rn[0].offset!=0){var li={offset:0,color:rn[0].color};rn.unshift(li)}if(rn[rn.length-1].offset!=1){var $i={offset:1,color:rn[rn.length-1].color};rn.push($i)}for(var Si="",Ii=0,Aa=0;Aa<ci.length;Aa++){for(Vn=ci[Aa];Vn>rn[Ii+1].offset;)Ii++;var ca=rn[Ii].offset,ba=(Vn-ca)/(rn[Ii+1].offset-ca),Ss=rn[Ii].color,Ks=rn[Ii+1].color;Si+=Me(Math.round((1-ba)*Ss[0]+ba*Ks[0]).toString(16))+Me(Math.round((1-ba)*Ss[1]+ba*Ks[1]).toString(16))+Me(Math.round((1-ba)*Ss[2]+ba*Ks[2]).toString(16))}return Si.trim()})(se.colors,qe),sr=[];sr.push({key:"FunctionType",value:"0"}),sr.push({key:"Domain",value:"[0.0 1.0]"}),sr.push({key:"Size",value:"["+qe+"]"}),sr.push({key:"BitsPerSample",value:"8"}),sr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),sr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_n({data:Vt,additionalKeyValues:sr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:dt}),Ve("endobj"),se.objectNumber=Mt(),Ve("<< /ShadingType "+se.type),Ve("/ColorSpace /DeviceRGB");var Vr="/Coords ["+W(parseFloat(se.coords[0]))+" "+W(parseFloat(se.coords[1]))+" ";se.type===2?Vr+=W(parseFloat(se.coords[2]))+" "+W(parseFloat(se.coords[3])):Vr+=W(parseFloat(se.coords[2]))+" "+W(parseFloat(se.coords[3]))+" "+W(parseFloat(se.coords[4]))+" "+W(parseFloat(se.coords[5])),Ve(Vr+="]"),se.matrix&&Ve("/Matrix ["+se.matrix.toString()+"]"),Ve("/Function "+dt+" 0 R"),Ve("/Extend [true true]"),Ve(">>"),Ve("endobj")},oo=function(se,qe){var dt=xr(),Vt=Mt();qe.push({resourcesOid:dt,objectOid:Vt}),se.objectNumber=Vt;var sr=[];sr.push({key:"Type",value:"/Pattern"}),sr.push({key:"PatternType",value:"1"}),sr.push({key:"PaintType",value:"1"}),sr.push({key:"TilingType",value:"1"}),sr.push({key:"BBox",value:"["+se.boundingBox.map(W).join(" ")+"]"}),sr.push({key:"XStep",value:W(se.xStep)}),sr.push({key:"YStep",value:W(se.yStep)}),sr.push({key:"Resources",value:dt+" 0 R"}),se.matrix&&sr.push({key:"Matrix",value:"["+se.matrix.toString()+"]"}),_n({data:se.stream,additionalKeyValues:sr,objectId:se.objectNumber}),Ve("endobj")},_a=function(se){for(var qe in se.objectNumber=Mt(),Ve("<<"),se)switch(qe){case"opacity":Ve("/ca "+J(se[qe]));break;case"stroke-opacity":Ve("/CA "+J(se[qe]))}Ve(">>"),Ve("endobj")},Hi=function(se){Kr(se.resourcesOid,!0),Ve("<<"),Ve("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var qe in Ve("/Font <<"),Be)Be.hasOwnProperty(qe)&&(d===!1||d===!0&&b.hasOwnProperty(qe))&&Ve("/"+qe+" "+Be[qe].objectNumber+" 0 R");Ve(">>")})(),(function(){if(Object.keys(pt).length>0){for(var qe in Ve("/Shading <<"),pt)pt.hasOwnProperty(qe)&&pt[qe]instanceof $g&&pt[qe].objectNumber>=0&&Ve("/"+qe+" "+pt[qe].objectNumber+" 0 R");Xt.publish("putShadingPatternDict"),Ve(">>")}})(),(function(qe){if(Object.keys(pt).length>0){for(var dt in Ve("/Pattern <<"),pt)pt.hasOwnProperty(dt)&&pt[dt]instanceof v.TilingPattern&&pt[dt].objectNumber>=0&&pt[dt].objectNumber<qe&&Ve("/"+dt+" "+pt[dt].objectNumber+" 0 R");Xt.publish("putTilingPatternDict"),Ve(">>")}})(se.objectOid),(function(){if(Object.keys(Bt).length>0){var qe;for(qe in Ve("/ExtGState <<"),Bt)Bt.hasOwnProperty(qe)&&Bt[qe].objectNumber>=0&&Ve("/"+qe+" "+Bt[qe].objectNumber+" 0 R");Xt.publish("putGStateDict"),Ve(">>")}})(),(function(){for(var qe in Ve("/XObject <<"),Lr)Lr.hasOwnProperty(qe)&&Lr[qe].objectNumber>=0&&Ve("/"+qe+" "+Lr[qe].objectNumber+" 0 R");Xt.publish("putXobjectDict"),Ve(">>")})(),Ve(">>"),Ve("endobj")},Ya=function(se){Ne[se.fontName]=Ne[se.fontName]||{},Ne[se.fontName][se.fontStyle]=se.id},Xs=function(se,qe,dt,Vt,sr){var Vr={id:"F"+(Object.keys(Be).length+1).toString(10),postScriptName:se,fontName:qe,fontStyle:dt,encoding:Vt,isStandardFont:sr||!1,metadata:{}};return Xt.publish("addFont",{font:Vr,instance:this}),Be[Vr.id]=Vr,Ya(Vr),Vr.id},ki=v.__private__.pdfEscape=v.pdfEscape=function(se,qe){return(function(dt,Vt){var sr,Vr,rn,kn,Vn,ci,Ti,li,$i;if(rn=(Vt=Vt||{}).sourceEncoding||"Unicode",Vn=Vt.outputEncoding,(Vt.autoencode||Vn)&&Be[Dr].metadata&&Be[Dr].metadata[rn]&&Be[Dr].metadata[rn].encoding&&(kn=Be[Dr].metadata[rn].encoding,!Vn&&Be[Dr].encoding&&(Vn=Be[Dr].encoding),!Vn&&kn.codePages&&(Vn=kn.codePages[0]),typeof Vn=="string"&&(Vn=kn[Vn]),Vn)){for(Ti=!1,ci=[],sr=0,Vr=dt.length;sr<Vr;sr++)(li=Vn[dt.charCodeAt(sr)])?ci.push(String.fromCharCode(li)):ci.push(dt[sr]),ci[sr].charCodeAt(0)>>8&&(Ti=!0);dt=ci.join("")}for(sr=dt.length;Ti===void 0&&sr!==0;)dt.charCodeAt(sr-1)>>8&&(Ti=!0),sr--;if(!Ti)return dt;for(ci=Vt.noBOM?[]:[254,255],sr=0,Vr=dt.length;sr<Vr;sr++){if(($i=(li=dt.charCodeAt(sr))>>8)>>8)throw new Error("Character at position "+sr+" of string '"+dt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ci.push($i),ci.push(li-($i<<8))}return String.fromCharCode.apply(void 0,ci)})(se,qe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bl=v.__private__.beginPage=function(se){Qe[++jt]=[],St[jt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(se[0]),topRightY:Number(se[1])}},So(jt),at(Qe[xe])},zo=function(se,qe){var dt,Vt,sr;switch(r=qe||r,typeof se=="string"&&(dt=k(se.toLowerCase()),Array.isArray(dt)&&(Vt=dt[0],sr=dt[1])),Array.isArray(se)&&(Vt=se[0]*er,sr=se[1]*er),isNaN(Vt)&&(Vt=i[0],sr=i[1]),(Vt>14400||sr>14400)&&(ko.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Vt=Math.min(14400,Vt),sr=Math.min(14400,sr)),i=[Vt,sr],r.substr(0,1)){case"l":sr>Vt&&(i=[sr,Vt]);break;case"p":Vt>sr&&(i=[sr,Vt])}bl(i),$r($n),Ve($a),Na!==0&&Ve(Na+" J"),Ys!==0&&Ve(Ys+" j"),Xt.publish("addPage",{pageNumber:jt})},xi=function(se){se>0&&se<=jt&&(Qe.splice(se,1),St.splice(se,1),jt--,xe>jt&&(xe=jt),this.setPage(xe))},So=function(se){se>0&&se<=jt&&(xe=se)},Fs=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return Qe.length-1},Mo=function(se,qe,dt){var Vt,sr=void 0;return dt=dt||{},se=se!==void 0?se:Be[Dr].fontName,qe=qe!==void 0?qe:Be[Dr].fontStyle,Vt=se.toLowerCase(),Ne[Vt]!==void 0&&Ne[Vt][qe]!==void 0?sr=Ne[Vt][qe]:Ne[se]!==void 0&&Ne[se][qe]!==void 0?sr=Ne[se][qe]:dt.disableWarning===!1&&ko.warn("Unable to look up font label for font '"+se+"', '"+qe+"'. Refer to getFontList() for available fonts."),sr||dt.noFallback||(sr=Ne.times[qe])==null&&(sr=Ne.times.normal),sr},so=v.__private__.putInfo=function(){var se=Mt(),qe=function(Vt){return Vt};for(var dt in f!==null&&(qe=Va.encryptor(se,0)),Ve("<<"),Ve("/Producer ("+ki(qe("jsPDF "+hi.version))+")"),or)or.hasOwnProperty(dt)&&or[dt]&&Ve("/"+dt.substr(0,1).toUpperCase()+dt.substr(1)+" ("+ki(qe(or[dt]))+")");Ve("/CreationDate ("+ki(qe(ue))+")"),Ve(">>"),Ve("endobj")},xl=v.__private__.putCatalog=function(se){var qe=(se=se||{}).rootDictionaryObjId||di;switch(Mt(),Ve("<<"),Ve("/Type /Catalog"),Ve("/Pages "+qe+" 0 R"),br||(br="fullwidth"),br){case"fullwidth":Ve("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ve("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ve("/OpenAction [3 0 R /Fit]");break;case"original":Ve("/OpenAction [3 0 R /XYZ null null 1]");break;default:var dt=""+br;dt.substr(dt.length-1)==="%"&&(br=parseInt(br)/100),typeof br=="number"&&Ve("/OpenAction [3 0 R /XYZ null null "+J(br)+"]")}switch(ar||(ar="continuous"),ar){case"continuous":Ve("/PageLayout /OneColumn");break;case"single":Ve("/PageLayout /SinglePage");break;case"two":case"twoleft":Ve("/PageLayout /TwoColumnLeft");break;case"tworight":Ve("/PageLayout /TwoColumnRight")}Mr&&Ve("/PageMode /"+Mr),Xt.publish("putCatalog"),Ve(">>"),Ve("endobj")},Za=v.__private__.putTrailer=function(){Ve("trailer"),Ve("<<"),Ve("/Size "+(Re+1)),Ve("/Root "+Re+" 0 R"),Ve("/Info "+(Re-1)+" 0 R"),f!==null&&Ve("/Encrypt "+Va.oid+" 0 R"),Ve("/ID [ <"+de+"> <"+de+"> ]"),Ve(">>")},Lc=v.__private__.putHeader=function(){Ve("%PDF-"+S),Ve("%ºß¬à")},cc=v.__private__.putXRef=function(){var se="0000000000";Ve("xref"),Ve("0 "+(Re+1)),Ve("0000000000 65535 f ");for(var qe=1;qe<=Re;qe++)typeof He[qe]=="function"?Ve((se+He[qe]()).slice(-10)+" 00000 n "):He[qe]!==void 0?Ve((se+He[qe]).slice(-10)+" 00000 n "):Ve("0000000000 00000 n ")},Yo=v.__private__.buildDocument=function(){var se;Re=0,tt=0,Fe=[],He=[],Ze=[],di=xr(),ti=xr(),at(Fe),Xt.publish("buildDocument"),Lc(),na(),(function(){Xt.publish("putAdditionalObjects");for(var dt=0;dt<Ze.length;dt++){var Vt=Ze[dt];Kr(Vt.objId,!0),Ve(Vt.content),Ve("endobj")}Xt.publish("postPutAdditionalObjects")})(),se=[],(function(){for(var dt in Be)Be.hasOwnProperty(dt)&&(d===!1||d===!0&&b.hasOwnProperty(dt))&&Ca(Be[dt])})(),(function(){var dt;for(dt in Bt)Bt.hasOwnProperty(dt)&&_a(Bt[dt])})(),(function(){for(var dt in Lr)Lr.hasOwnProperty(dt)&&ua(Lr[dt])})(),(function(dt){var Vt;for(Vt in pt)pt.hasOwnProperty(Vt)&&(pt[Vt]instanceof $g?Mn(pt[Vt]):pt[Vt]instanceof _v&&oo(pt[Vt],dt))})(se),Xt.publish("putResources"),se.forEach(Hi),Hi({resourcesOid:ti,objectOid:Number.MAX_SAFE_INTEGER}),Xt.publish("postPutResources"),f!==null&&(Va.oid=Mt(),Ve("<<"),Ve("/Filter /Standard"),Ve("/V "+Va.v),Ve("/R "+Va.r),Ve("/U <"+Va.toHexString(Va.U)+">"),Ve("/O <"+Va.toHexString(Va.O)+">"),Ve("/P "+Va.P),Ve(">>"),Ve("endobj")),so(),xl();var qe=tt;return cc(),Za(),Ve("startxref"),Ve(""+qe),Ve("%%EOF"),at(Qe[xe]),Fe.join(`
`)},Bs=v.__private__.getBlob=function(se){return new Blob([Yt(se)],{type:"application/pdf"})},Ka=v.output=v.__private__.output=(ft=function(se,qe){switch(typeof(qe=qe||{})=="string"?qe={filename:qe}:qe.filename=qe.filename||"generated.pdf",se){case void 0:return Yo();case"save":v.save(qe.filename);break;case"arraybuffer":return Yt(Yo());case"blob":return Bs(Yo());case"bloburi":case"bloburl":if(Ni.URL!==void 0&&typeof Ni.URL.createObjectURL=="function")return Ni.URL&&Ni.URL.createObjectURL(Bs(Yo()))||void 0;ko.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var dt="",Vt=Yo();try{dt=TB(Vt)}catch{dt=TB(unescape(encodeURIComponent(Vt)))}return"data:application/pdf;filename="+qe.filename+";base64,"+dt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ni)==="[object Window]"){var sr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Vr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';qe.pdfObjectUrl&&(sr=qe.pdfObjectUrl,Vr="");var rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+sr+'"'+Vr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(qe)+");<\/script></body></html>",kn=Ni.open();return kn!==null&&kn.document.write(rn),kn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ni)==="[object Window]"){var Vn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(qe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+qe.filename+'" width="500px" height="400px" /></body></html>',ci=Ni.open();if(ci!==null){ci.document.write(Vn);var Ti=this;ci.document.documentElement.querySelector("#pdfViewer").onload=function(){ci.document.title=qe.filename,ci.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ti.output("bloburl"))}}return ci}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ni)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var li='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",qe)+'"></iframe></body></html>',$i=Ni.open();if($i!==null&&($i.document.write(li),$i.document.title=qe.filename),$i||typeof safari>"u")return $i;break;case"datauri":case"dataurl":return Ni.document.location.href=this.output("datauristring",qe);default:return null}},ft.foo=function(){try{return ft.apply(this,arguments)}catch(dt){var se=dt.stack||"";~se.indexOf(" at ")&&(se=se.split(" at ")[1]);var qe="Error in function "+se.split(`
`)[0].split("<")[0]+": "+dt.message;if(!Ni.console)throw new Error(qe);Ni.console.error(qe,dt),Ni.alert&&alert(qe)}},ft.foo.bar=ft,ft.foo),Eo=function(se){return Array.isArray(Ct)===!0&&Ct.indexOf(se)>-1};switch(n){case"pt":er=1;break;case"mm":er=72/25.4;break;case"cm":er=72/2.54;break;case"in":er=72;break;case"px":er=Eo("px_scaling")==1?.75:96/72;break;case"pc":case"em":er=12;break;case"ex":er=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);er=n}var Va=null;Ae(),me();var wl=v.__private__.getPageInfo=v.getPageInfo=function(se){if(isNaN(se)||se%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[se].objId,pageNumber:se,pageContext:St[se]}},xu=v.__private__.getPageInfoByObjId=function(se){if(isNaN(se)||se%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var qe in St)if(St[qe].objId===se)break;return wl(qe)},wu=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:St[xe].objId,pageNumber:xe,pageContext:St[xe]}};v.addPage=function(){return zo.apply(this,arguments),this},v.setPage=function(){return So.apply(this,arguments),at.call(this,Qe[xe]),this},v.insertPage=function(se){return this.addPage(),this.movePage(xe,se),this},v.movePage=function(se,qe){var dt,Vt;if(se>qe){dt=Qe[se],Vt=St[se];for(var sr=se;sr>qe;sr--)Qe[sr]=Qe[sr-1],St[sr]=St[sr-1];Qe[qe]=dt,St[qe]=Vt,this.setPage(qe)}else if(se<qe){dt=Qe[se],Vt=St[se];for(var Vr=se;Vr<qe;Vr++)Qe[Vr]=Qe[Vr+1],St[Vr]=St[Vr+1];Qe[qe]=dt,St[qe]=Vt,this.setPage(qe)}return this},v.deletePage=function(){return xi.apply(this,arguments),this},v.__private__.text=v.text=function(se,qe,dt,Vt,sr){var Vr,rn,kn,Vn,ci,Ti,li,$i,Si,Ii=(Vt=Vt||{}).scope||this;if(typeof se=="number"&&typeof qe=="number"&&(typeof dt=="string"||Array.isArray(dt))){var Aa=dt;dt=qe,qe=se,se=Aa}if(arguments[3]instanceof jr==0?(kn=arguments[4],Vn=arguments[5],ao(li=arguments[3])==="object"&&li!==null||(typeof kn=="string"&&(Vn=kn,kn=null),typeof li=="string"&&(Vn=li,li=null),typeof li=="number"&&(kn=li,li=null),Vt={flags:li,angle:kn,align:Vn})):(G("The transform parameter of text() with a Matrix value"),Si=sr),isNaN(qe)||isNaN(dt)||se==null)throw new Error("Invalid arguments passed to jsPDF.text");if(se.length===0)return Ii;var ca,ba="",Ss=typeof Vt.lineHeightFactor=="number"?Vt.lineHeightFactor:En,Ks=Ii.internal.scaleFactor;function Su(Rn){return Rn=Rn.split("	").join(Array(Vt.TabLen||9).join(" ")),ki(Rn,li)}function Es(Rn){for(var A,y=Rn.concat(),_=[],I=y.length;I--;)typeof(A=y.shift())=="string"?_.push(A):Array.isArray(Rn)&&(A.length===1||A[1]===void 0&&A[2]===void 0)?_.push(A[0]):_.push([A[0],A[1],A[2]]);return _}function Eu(Rn,A){var y;if(typeof Rn=="string")y=A(Rn)[0];else if(Array.isArray(Rn)){for(var _,I,U=Rn.concat(),re=[],ye=U.length;ye--;)typeof(_=U.shift())=="string"?re.push(A(_)[0]):Array.isArray(_)&&typeof _[0]=="string"&&(I=A(_[0],_[1],_[2]),re.push([I[0],I[1],I[2]]));y=re}return y}var xa=!1,Js=!0;if(typeof se=="string")xa=!0;else if(Array.isArray(se)){var au=se.concat();rn=[];for(var Ts,Da=au.length;Da--;)(typeof(Ts=au.shift())!="string"||Array.isArray(Ts)&&typeof Ts[0]!="string")&&(Js=!1);xa=Js}if(xa===!1)throw new Error('Type of text must be string or Array. "'+se+'" is not recognized.');typeof se=="string"&&(se=se.match(/[\r?\n]/)?se.split(/\r\n|\r|\n/g):[se]);var To=mt/Ii.internal.scaleFactor,ha=To*(Ss-1);switch(Vt.baseline){case"bottom":dt-=ha;break;case"top":dt+=To-ha;break;case"hanging":dt+=To-2*ha;break;case"middle":dt+=To/2-ha}if((Ti=Vt.maxWidth||0)>0&&(typeof se=="string"?se=Ii.splitTextToSize(se,Ti):Object.prototype.toString.call(se)==="[object Array]"&&(se=se.reduce(function(Rn,A){return Rn.concat(Ii.splitTextToSize(A,Ti))},[]))),Vr={text:se,x:qe,y:dt,options:Vt,mutex:{pdfEscape:ki,activeFontKey:Dr,fonts:Be,activeFontSize:mt}},Xt.publish("preProcessText",Vr),se=Vr.text,kn=(Vt=Vr.options).angle,Si instanceof jr==0&&kn&&typeof kn=="number"){kn*=Math.PI/180,Vt.rotationDirection===0&&(kn=-kn),M===N&&(kn=-kn);var Qs=Math.cos(kn),jl=Math.sin(kn);Si=new jr(Qs,jl,-jl,Qs,0,0)}else kn&&kn instanceof jr&&(Si=kn);M!==N||Si||(Si=Ce),(ci=Vt.charSpace||In)!==void 0&&(ba+=W(ne(ci))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),($i=Vt.horizontalScale)!==void 0&&(ba+=W(100*$i)+` Tz
`),Vt.lang;var wa=-1,Tu=Vt.renderingMode!==void 0?Vt.renderingMode:Vt.stroke,Ul=Ii.internal.getCurrentPageInfo().pageContext;switch(Tu){case 0:case!1:case"fill":wa=0;break;case 1:case!0:case"stroke":wa=1;break;case 2:case"fillThenStroke":wa=2;break;case 3:case"invisible":wa=3;break;case 4:case"fillAndAddForClipping":wa=4;break;case 5:case"strokeAndAddPathForClipping":wa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":wa=6;break;case 7:case"addToPathForClipping":wa=7}var el=Ul.usedRenderingMode!==void 0?Ul.usedRenderingMode:-1;wa!==-1?ba+=wa+` Tr
`:el!==-1&&(ba+=`0 Tr
`),wa!==-1&&(Ul.usedRenderingMode=wa),Vn=Vt.align||"left";var Qa,Ro=mt*Ss,hc=Ii.internal.pageSize.getWidth(),fc=Be[Dr];ci=Vt.charSpace||In,Ti=Vt.maxWidth||0,li=Object.assign({autoencode:!0,noBOM:!0},Vt.flags);var Vl=[],$l=function(Rn){return Ii.getStringUnitWidth(Rn,{font:fc,charSpace:ci,fontSize:mt,doKerning:!1})*mt/Ks};if(Object.prototype.toString.call(se)==="[object Array]"){var Co;rn=Es(se),Vn!=="left"&&(Qa=rn.map($l));var co,Cu=0;if(Vn==="right"){qe-=Qa[0],se=[],Da=rn.length;for(var Ao=0;Ao<Da;Ao++)Ao===0?(co=wi(qe),Co=Vi(dt)):(co=ne(Cu-Qa[Ao]),Co=-Ro),se.push([rn[Ao],co,Co]),Cu=Qa[Ao]}else if(Vn==="center"){qe-=Qa[0]/2,se=[],Da=rn.length;for(var ql=0;ql<Da;ql++)ql===0?(co=wi(qe),Co=Vi(dt)):(co=ne((Cu-Qa[ql])/2),Co=-Ro),se.push([rn[ql],co,Co]),Cu=Qa[ql]}else if(Vn==="left"){se=[],Da=rn.length;for(var jo=0;jo<Da;jo++)se.push(rn[jo])}else if(Vn==="justify"&&fc.encoding==="Identity-H"){se=[],Da=rn.length,Ti=Ti!==0?Ti:hc;for(var El=0,Ia=0;Ia<Da;Ia++)if(Co=Ia===0?Vi(dt):-Ro,co=Ia===0?wi(qe):El,Ia<Da-1){var tl=ne((Ti-Qa[Ia])/(rn[Ia].split(" ").length-1)),rl=rn[Ia].split(" ");se.push([rl[0]+" ",co,Co]),El=0;for(var ls=1;ls<rl.length;ls++){var ou=($l(rl[ls-1]+" "+rl[ls])-$l(rl[ls]))*Ks+tl;ls==rl.length-1?se.push([rl[ls],ou,0]):se.push([rl[ls]+" ",ou,0]),El-=ou}}else se.push([rn[Ia],co,Co]);se.push(["",El,0])}else{if(Vn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(se=[],Da=rn.length,Ti=Ti!==0?Ti:hc,Ia=0;Ia<Da;Ia++)Co=Ia===0?Vi(dt):-Ro,co=Ia===0?wi(qe):0,Ia<Da-1?Vl.push(W(ne((Ti-Qa[Ia])/(rn[Ia].split(" ").length-1)))):Vl.push(0),se.push([rn[Ia],co,Co])}}(typeof Vt.R2L=="boolean"?Vt.R2L:mr)===!0&&(se=Eu(se,function(Rn,A,y){return[Rn.split("").reverse().join(""),A,y]})),Vr={text:se,x:qe,y:dt,options:Vt,mutex:{pdfEscape:ki,activeFontKey:Dr,fonts:Be,activeFontSize:mt}},Xt.publish("postProcessText",Vr),se=Vr.text,ca=Vr.mutex.isHex||!1;var Yu=Be[Dr].encoding;Yu!=="WinAnsiEncoding"&&Yu!=="StandardEncoding"||(se=Eu(se,function(Rn,A,y){return[Su(Rn),A,y]})),rn=Es(se),se=[];for(var nl,su,Au,tr=Array.isArray(rn[0])?1:0,ur="",mn=function(Rn,A,y){var _="";return y instanceof jr?(y=typeof Vt.angle=="number"?vn(y,new jr(1,0,0,1,Rn,A)):vn(new jr(1,0,0,1,Rn,A),y),M===N&&(y=vn(new jr(1,0,0,-1,0,0),y)),_=y.join(" ")+` Tm
`):_=W(Rn)+" "+W(A)+` Td
`,_},Tn=0;Tn<rn.length;Tn++){switch(ur="",tr){case 1:Au=(ca?"<":"(")+rn[Tn][0]+(ca?">":")"),nl=parseFloat(rn[Tn][1]),su=parseFloat(rn[Tn][2]);break;case 0:Au=(ca?"<":"(")+rn[Tn]+(ca?">":")"),nl=wi(qe),su=Vi(dt)}Vl!==void 0&&Vl[Tn]!==void 0&&(ur=Vl[Tn]+` Tw
`),Tn===0?se.push(ur+mn(nl,su,Si)+Au):tr===0?se.push(ur+Au):tr===1&&se.push(ur+mn(nl,su,Si)+Au)}se=tr===0?se.join(` Tj
T* `):se.join(` Tj
`),se+=` Tj
`;var yi=`BT
/`;return yi+=Dr+" "+mt+` Tf
`,yi+=W(mt*Ss)+` TL
`,yi+=Wn+`
`,yi+=ba,yi+=se,Ve(yi+="ET"),b[Dr]=!0,Ii};var K=v.__private__.clip=v.clip=function(se){return Ve(se==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return K("evenodd")},v.__private__.discardPath=v.discardPath=function(){return Ve("n"),this};var pe=v.__private__.isValidStyle=function(se){var qe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(se)!==-1&&(qe=!0),qe};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(se){return pe(se)&&(h=se),this};var Ye=v.__private__.getStyle=v.getStyle=function(se){var qe=h;switch(se){case"D":case"S":qe="S";break;case"F":qe="f";break;case"FD":case"DF":qe="B";break;case"f":case"f*":case"B":case"B*":qe=se}return qe},Et=v.close=function(){return Ve("h"),this};v.stroke=function(){return Ve("S"),this},v.fill=function(se){return Ut("f",se),this},v.fillEvenOdd=function(se){return Ut("f*",se),this},v.fillStroke=function(se){return Ut("B",se),this},v.fillStrokeEvenOdd=function(se){return Ut("B*",se),this};var Ut=function(se,qe){ao(qe)==="object"?Gr(qe,se):Ve(se)},Nt=function(se){se===null||M===N&&se===void 0||(se=Ye(se),Ve(se))};function Qt(se,qe,dt,Vt,sr){var Vr=new _v(qe||this.boundingBox,dt||this.xStep,Vt||this.yStep,this.gState,sr||this.matrix);Vr.stream=this.stream;var rn=se+"$$"+this.cloneIndex+++"$$";return Ue(rn,Vr),Vr}var Gr=function(se,qe){var dt=Rt[se.key],Vt=pt[dt];if(Vt instanceof $g)Ve("q"),Ve(on(qe)),Vt.gState&&v.setGState(Vt.gState),Ve(se.matrix.toString()+" cm"),Ve("/"+dt+" sh"),Ve("Q");else if(Vt instanceof _v){var sr=new jr(1,0,0,-1,0,sa());se.matrix&&(sr=sr.multiply(se.matrix||Ce),dt=Qt.call(Vt,se.key,se.boundingBox,se.xStep,se.yStep,sr).id),Ve("q"),Ve("/Pattern cs"),Ve("/"+dt+" scn"),Vt.gState&&v.setGState(Vt.gState),Ve(qe),Ve("Q")}},on=function(se){switch(se){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},en=v.moveTo=function(se,qe){return Ve(W(ne(se))+" "+W(ae(qe))+" m"),this},hn=v.lineTo=function(se,qe){return Ve(W(ne(se))+" "+W(ae(qe))+" l"),this},nn=v.curveTo=function(se,qe,dt,Vt,sr,Vr){return Ve([W(ne(se)),W(ae(qe)),W(ne(dt)),W(ae(Vt)),W(ne(sr)),W(ae(Vr)),"c"].join(" ")),this};v.__private__.line=v.line=function(se,qe,dt,Vt,sr){if(isNaN(se)||isNaN(qe)||isNaN(dt)||isNaN(Vt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.line");return M===L?this.lines([[dt-se,Vt-qe]],se,qe,[1,1],sr||"S"):this.lines([[dt-se,Vt-qe]],se,qe,[1,1]).stroke()},v.__private__.lines=v.lines=function(se,qe,dt,Vt,sr,Vr){var rn,kn,Vn,ci,Ti,li,$i,Si,Ii,Aa,ca,ba;if(typeof se=="number"&&(ba=dt,dt=qe,qe=se,se=ba),Vt=Vt||[1,1],Vr=Vr||!1,isNaN(qe)||isNaN(dt)||!Array.isArray(se)||!Array.isArray(Vt)||!pe(sr)||typeof Vr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(en(qe,dt),rn=Vt[0],kn=Vt[1],ci=se.length,Aa=qe,ca=dt,Vn=0;Vn<ci;Vn++)(Ti=se[Vn]).length===2?(Aa=Ti[0]*rn+Aa,ca=Ti[1]*kn+ca,hn(Aa,ca)):(li=Ti[0]*rn+Aa,$i=Ti[1]*kn+ca,Si=Ti[2]*rn+Aa,Ii=Ti[3]*kn+ca,Aa=Ti[4]*rn+Aa,ca=Ti[5]*kn+ca,nn(li,$i,Si,Ii,Aa,ca));return Vr&&Et(),Nt(sr),this},v.path=function(se){for(var qe=0;qe<se.length;qe++){var dt=se[qe],Vt=dt.c;switch(dt.op){case"m":en(Vt[0],Vt[1]);break;case"l":hn(Vt[0],Vt[1]);break;case"c":nn.apply(this,Vt);break;case"h":Et()}}return this},v.__private__.rect=v.rect=function(se,qe,dt,Vt,sr){if(isNaN(se)||isNaN(qe)||isNaN(dt)||isNaN(Vt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.rect");return M===L&&(Vt=-Vt),Ve([W(ne(se)),W(ae(qe)),W(ne(dt)),W(ne(Vt)),"re"].join(" ")),Nt(sr),this},v.__private__.triangle=v.triangle=function(se,qe,dt,Vt,sr,Vr,rn){if(isNaN(se)||isNaN(qe)||isNaN(dt)||isNaN(Vt)||isNaN(sr)||isNaN(Vr)||!pe(rn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[dt-se,Vt-qe],[sr-dt,Vr-Vt],[se-sr,qe-Vr]],se,qe,[1,1],rn,!0),this},v.__private__.roundedRect=v.roundedRect=function(se,qe,dt,Vt,sr,Vr,rn){if(isNaN(se)||isNaN(qe)||isNaN(dt)||isNaN(Vt)||isNaN(sr)||isNaN(Vr)||!pe(rn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var kn=4/3*(Math.SQRT2-1);return sr=Math.min(sr,.5*dt),Vr=Math.min(Vr,.5*Vt),this.lines([[dt-2*sr,0],[sr*kn,0,sr,Vr-Vr*kn,sr,Vr],[0,Vt-2*Vr],[0,Vr*kn,-sr*kn,Vr,-sr,Vr],[2*sr-dt,0],[-sr*kn,0,-sr,-Vr*kn,-sr,-Vr],[0,2*Vr-Vt],[0,-Vr*kn,sr*kn,-Vr,sr,-Vr]],se+sr,qe,[1,1],rn,!0),this},v.__private__.ellipse=v.ellipse=function(se,qe,dt,Vt,sr){if(isNaN(se)||isNaN(qe)||isNaN(dt)||isNaN(Vt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Vr=4/3*(Math.SQRT2-1)*dt,rn=4/3*(Math.SQRT2-1)*Vt;return en(se+dt,qe),nn(se+dt,qe-rn,se+Vr,qe-Vt,se,qe-Vt),nn(se-Vr,qe-Vt,se-dt,qe-rn,se-dt,qe),nn(se-dt,qe+rn,se-Vr,qe+Vt,se,qe+Vt),nn(se+Vr,qe+Vt,se+dt,qe+rn,se+dt,qe),Nt(sr),this},v.__private__.circle=v.circle=function(se,qe,dt,Vt){if(isNaN(se)||isNaN(qe)||isNaN(dt)||!pe(Vt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(se,qe,dt,dt,Vt)},v.setFont=function(se,qe,dt){return dt&&(qe=q(qe,dt)),Dr=Mo(se,qe,{disableWarning:!1}),this};var Xn=v.__private__.getFont=v.getFont=function(){return Be[Mo.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var se,qe,dt={};for(se in Ne)if(Ne.hasOwnProperty(se))for(qe in dt[se]=[],Ne[se])Ne[se].hasOwnProperty(qe)&&dt[se].push(qe);return dt},v.addFont=function(se,qe,dt,Vt,sr){var Vr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Vr.indexOf(arguments[3])!==-1?sr=arguments[3]:arguments[3]&&Vr.indexOf(arguments[3])==-1&&(dt=q(dt,Vt)),Xs.call(this,se,qe,dt,sr=sr||"Identity-H")};var En,$n=t.lineWidth||.200025,Ln=v.__private__.getLineWidth=v.getLineWidth=function(){return $n},$r=v.__private__.setLineWidth=v.setLineWidth=function(se){return $n=se,Ve(W(ne(se))+" w"),this};v.__private__.setLineDash=hi.API.setLineDash=hi.API.setLineDashPattern=function(se,qe){if(se=se||[],qe=qe||0,isNaN(qe)||!Array.isArray(se))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return se=se.map(function(dt){return W(ne(dt))}).join(" "),qe=W(ne(qe)),Ve("["+se+"] "+qe+" d"),this};var xn=v.__private__.getLineHeight=v.getLineHeight=function(){return mt*En};v.__private__.getLineHeight=v.getLineHeight=function(){return mt*En};var si=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(se){return typeof(se=se||1.15)=="number"&&(En=se),this},Li=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return En};si(t.lineHeight);var wi=v.__private__.getHorizontalCoordinate=function(se){return ne(se)},Vi=v.__private__.getVerticalCoordinate=function(se){return M===N?se:St[xe].mediaBox.topRightY-St[xe].mediaBox.bottomLeftY-ne(se)},Bi=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(se){return W(wi(se))},Pn=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(se){return W(Vi(se))},$a=t.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return bi($a)},v.__private__.setStrokeColor=v.setDrawColor=function(se,qe,dt,Vt){return $a=Ui({ch1:se,ch2:qe,ch3:dt,ch4:Vt,pdfColorType:"draw",precision:2}),Ve($a),this};var ii=t.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return bi(ii)},v.__private__.setFillColor=v.setFillColor=function(se,qe,dt,Vt){return ii=Ui({ch1:se,ch2:qe,ch3:dt,ch4:Vt,pdfColorType:"fill",precision:2}),Ve(ii),this};var Wn=t.textColor||"0 g",ws=v.__private__.getTextColor=v.getTextColor=function(){return bi(Wn)};v.__private__.setTextColor=v.setTextColor=function(se,qe,dt,Vt){return Wn=Ui({ch1:se,ch2:qe,ch3:dt,ch4:Vt,pdfColorType:"text",precision:3}),this};var In=t.charSpace,Sl=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(In||0)};v.__private__.setCharSpace=v.setCharSpace=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return In=se,this};var Na=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(se){var qe=v.CapJoinStyles[se];if(qe===void 0)throw new Error("Line cap style of '"+se+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Na=qe,Ve(qe+" J"),this};var Ys=0;v.__private__.setLineJoin=v.setLineJoin=function(se){var qe=v.CapJoinStyles[se];if(qe===void 0)throw new Error("Line join style of '"+se+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ys=qe,Ve(qe+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(se){if(se=se||0,isNaN(se))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ve(W(ne(se))+" M"),this},v.GState=Qw,v.setGState=function(se){(se=typeof se=="string"?Bt[At[se]]:lo(null,se)).equals(Zt)||(Ve("/"+se.id+" gs"),Zt=se)};var lo=function(se,qe){if(!se||!At[se]){var dt=!1;for(var Vt in Bt)if(Bt.hasOwnProperty(Vt)&&Bt[Vt].equals(qe)){dt=!0;break}if(dt)qe=Bt[Vt];else{var sr="GS"+(Object.keys(Bt).length+1).toString(10);Bt[sr]=qe,qe.id=sr}return se&&(At[se]=qe.id),Xt.publish("addGState",qe),qe}};v.addGState=function(se,qe){return lo(se,qe),this},v.saveGraphicsState=function(){return Ve("q"),rt.push({key:Dr,size:mt,color:Wn}),this},v.restoreGraphicsState=function(){Ve("Q");var se=rt.pop();return Dr=se.key,mt=se.size,Wn=se.color,Zt=null,this},v.setCurrentTransformationMatrix=function(se){return Ve(se.toString()+" cm"),this},v.comment=function(se){return Ve("#"+se),this};var iu=function(se,qe){var dt=se||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return dt},set:function(Vr){isNaN(Vr)||(dt=parseFloat(Vr))}});var Vt=qe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Vt},set:function(Vr){isNaN(Vr)||(Vt=parseFloat(Vr))}});var sr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return sr},set:function(Vr){sr=Vr.toString()}}),this},os=function(se,qe,dt,Vt){iu.call(this,se,qe),this.type="rect";var sr=dt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return sr},set:function(rn){isNaN(rn)||(sr=parseFloat(rn))}});var Vr=Vt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Vr},set:function(rn){isNaN(rn)||(Vr=parseFloat(rn))}}),this},ss=function(){this.page=jt,this.currentPage=xe,this.pages=Qe.slice(0),this.pagesContext=St.slice(0),this.x=Gt,this.y=Tt,this.matrix=Oe,this.width=Ja(xe),this.height=sa(xe),this.outputDestination=Lt,this.id="",this.objectNumber=-1};ss.prototype.restore=function(){jt=this.page,xe=this.currentPage,St=this.pagesContext,Qe=this.pages,Gt=this.x,Tt=this.y,Oe=this.matrix,uo(xe,this.width),La(xe,this.height),Lt=this.outputDestination};var zl=function(se,qe,dt,Vt,sr){Zr.push(new ss),jt=xe=0,Qe=[],Gt=se,Tt=qe,Oe=sr,bl([dt,Vt])};for(var Zs in v.beginFormObject=function(se,qe,dt,Vt,sr){return zl(se,qe,dt,Vt,sr),this},v.endFormObject=function(se){return(function(qe){if(qt[qe])Zr.pop().restore();else{var dt=new ss,Vt="Xo"+(Object.keys(Lr).length+1).toString(10);dt.id=Vt,qt[qe]=Vt,Lr[Vt]=dt,Xt.publish("addFormObject",dt),Zr.pop().restore()}})(se),this},v.doFormObject=function(se,qe){var dt=Lr[qt[se]];return Ve("q"),Ve(qe.toString()+" cm"),Ve("/"+dt.id+" Do"),Ve("Q"),this},v.getFormObject=function(se){var qe=Lr[qt[se]];return{x:qe.x,y:qe.y,width:qe.width,height:qe.height,matrix:qe.matrix}},v.save=function(se,qe){return se=se||"generated.pdf",(qe=qe||{}).returnPromise=qe.returnPromise||!1,qe.returnPromise===!1?(jg(Bs(Yo()),se),typeof jg.unload=="function"&&Ni.setTimeout&&setTimeout(jg.unload,911),this):new Promise(function(dt,Vt){try{var sr=jg(Bs(Yo()),se);typeof jg.unload=="function"&&Ni.setTimeout&&setTimeout(jg.unload,911),dt(sr)}catch(Vr){Vt(Vr.message)}})},hi.API)hi.API.hasOwnProperty(Zs)&&(Zs==="events"&&hi.API.events.length?(function(se,qe){var dt,Vt,sr;for(sr=qe.length-1;sr!==-1;sr--)dt=qe[sr][0],Vt=qe[sr][1],se.subscribe.apply(se,[dt].concat(typeof Vt=="function"?[Vt]:Vt))})(Xt,hi.API.events):v[Zs]=hi.API[Zs]);var Ja=v.getPageWidth=function(se){return(St[se=se||xe].mediaBox.topRightX-St[se].mediaBox.bottomLeftX)/er},uo=v.setPageWidth=function(se,qe){St[se].mediaBox.topRightX=qe*er+St[se].mediaBox.bottomLeftX},sa=v.getPageHeight=function(se){return(St[se=se||xe].mediaBox.topRightY-St[se].mediaBox.bottomLeftY)/er},La=v.setPageHeight=function(se,qe){St[se].mediaBox.topRightY=qe*er+St[se].mediaBox.bottomLeftY};return v.internal={pdfEscape:ki,getStyle:Ye,getFont:Xn,getFontSize:Tr,getCharSpace:Sl,getTextColor:ws,getLineHeight:xn,getLineHeightFactor:Li,getLineWidth:Ln,write:nr,getHorizontalCoordinate:wi,getVerticalCoordinate:Vi,getCoordinateString:Bi,getVerticalCoordinateString:Pn,collections:{},newObject:Mt,newAdditionalObject:Rr,newObjectDeferred:xr,newObjectDeferredBegin:Kr,getFilters:Xr,putStream:_n,events:Xt,scaleFactor:er,pageSize:{getWidth:function(){return Ja(xe)},setWidth:function(se){uo(xe,se)},getHeight:function(){return sa(xe)},setHeight:function(se){La(xe,se)}},encryptionOptions:f,encryption:Va,getEncryptor:function(se){return f!==null?Va.encryptor(se,0):function(qe){return qe}},output:Ka,getNumberOfPages:Fs,pages:Qe,out:Ve,f2:J,f3:H,getPageInfo:wl,getPageInfoByObjId:xu,getCurrentPageInfo:wu,getPDFVersion:E,Point:iu,Rectangle:os,Matrix:jr,hasHotfix:Eo},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return Ja(xe)},set:function(se){uo(xe,se)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return sa(xe)},set:function(se){La(xe,se)},enumerable:!0,configurable:!0}),(function(se){for(var qe=0,dt=yr.length;qe<dt;qe++){var Vt=Xs.call(this,se[qe][0],se[qe][1],se[qe][2],yr[qe][3],!0);d===!1&&(b[Vt]=!0);var sr=se[qe][0].split("-");Ya({id:Vt,fontName:sr[0],fontStyle:sr[1]||""})}Xt.publish("addFonts",{fonts:Be,dictionary:Ne})}).call(v,yr),Dr="F1",zo(i,r),Xt.publish("initialized"),v}Zy.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Zy.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Zy.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Zy.prototype.processOwnerPassword=function(t,e){return KP(ZP(e).substr(0,5),t)},Zy.prototype.encryptor=function(t,e){var r=ZP(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return KP(r,n)}},Qw.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ao(t)!==ao(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},hi.API={events:[]},hi.version="3.0.2";var Ls=hi.API,gO=1,jm=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Py=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ji=function(t){return t.toFixed(2)},wp=function(t){return t.toFixed(5)};Ls.__acroform__={};var Mc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},PB=function(t){return t*gO},Ff=function(t){var e=new kX,r=Qn.internal.getHeight(t)||0,n=Qn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(ji(n)),Number(ji(r))],e},Yye=Ls.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Zye=Ls.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Kye=Ls.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Vs=Ls.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Kye(t,e-1)},$s=Ls.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Yye(t,e-1)},qs=Ls.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Zye(t,e-1)},Jye=Ls.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],s=t[2],o=t[3],u={};return u.lowerLeft_X=r(i)||0,u.lowerLeft_Y=n(a+o)||0,u.upperRight_X=r(i+s)||0,u.upperRight_Y=n(a)||0,[Number(ji(u.lowerLeft_X)),Number(ji(u.lowerLeft_Y)),Number(ji(u.upperRight_X)),Number(ji(u.upperRight_Y))]},Qye=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=JP(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+ji(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Ff(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},JP=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(J){return J.split(`
`)}):i.map(function(J){return[J]});var a=r,s=Qn.internal.getHeight(t)||0;s=s<0?-s:s;var o=Qn.internal.getWidth(t)||0;o=o<0?-o:o;var u=function(J,H,ne){if(J+1<i.length){var ae=H+" "+i[J+1][0];return o2(ae,t,ne).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var h,f,d=o2("3",t,a).height,b=t.multiline?s-a:(s-d)/2,v=b+=2,S=0,E=0,P=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+o2(e,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var k="",L=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var M=!1;if(i[N].length!==1&&P!==i[N].length-1){if((d+2)*(L+2)+2>s)continue e;k+=i[N][P],M=!0,E=N,N--}else{k=(k+=i[N][P]+" ").substr(k.length-1)==" "?k.substr(0,k.length-1):k;var z=parseInt(N),B=u(z,k,a),q=N>=i.length-1;if(B&&!q){k+=" ",P=0;continue}if(B||q){if(q)E=z;else if(t.multiline&&(d+2)*(L+2)+2>s)continue e}else{if(!t.multiline||(d+2)*(L+2)+2>s)continue e;E=z}}for(var W="",G=S;G<=E;G++){var ie=i[G];if(t.multiline){if(G===E){W+=ie[P]+" ",P=(P+1)%ie.length;continue}if(G===S){W+=ie[ie.length-1]+" ";continue}}W+=ie[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,f=o2(W,t,a).width,t.textAlign){case"right":h=o-f-2;break;case"center":h=(o-f)/2;break;default:h=2}e+=ji(h)+" "+ji(v)+` Td
`,e+="("+jm(W)+`) Tj
`,e+=-ji(h)+` 0 Td
`,v=-(a+2),f=0,S=M?E:E+1,L++,k=""}break}return n.text=e,n.fontSize=a,n},o2=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},eve={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},tve=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},rve=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(df.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(eve)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");gO=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new MX,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&tve(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],u=[],h=o.Rect;if(o.Rect&&(o.Rect=Jye(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Qn.createDefaultAppearanceStream(o),ao(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=Qye(o);u.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var d="";for(var b in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(b)){var v=o.appearanceStreamContent[b];if(d+="/"+b+" ",d+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var s in v)if(v.hasOwnProperty(s)){var S=v[s];typeof S=="function"&&(S=S.call(i,o)),d+="/"+s+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=v)=="function"&&(S=S.call(i,o)),d+="/"+s+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);d+=">>"}u.push({key:"AP",value:`<<
`+d+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:o.objId}),i.internal.out("endobj")}a&&(function(E,P){for(var k in E)if(E.hasOwnProperty(k)){var L=k,N=E[k];P.internal.newObjectDeferredBegin(N.objId,!0),ao(N)==="object"&&typeof N.putStream=="function"&&N.putStream(),delete E[L]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},PX=Ls.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),ao(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+jm(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},B3=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+jm(n(t))+")"},qf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};qf.prototype.toString=function(){return this.objId+" 0 R"},qf.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},qf.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:PX(i,this.objId,this.scope)}):i instanceof qf?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var kX=function(){qf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Mc(kX,qf);var MX=function(){qf.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+jm(r(t))+")"}},set:function(r){t=r}})};Mc(MX,qf);var df=function t(){qf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute F supplied.');e=k}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Vs(e,3)},set:function(k){k?this.F=$s(e,3):this.F=qs(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute Ff supplied.');r=k}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(k){n=k!==void 0?k:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(k){n[0]=k}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(k){n[1]=k}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(k){n[2]=k}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(k){n[3]=k}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(k){switch(k){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=k;break;default:throw new Error('Invalid value "'+k+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof eS)return;a="FieldObject"+t.FieldNum++}var k=function(L){return L};return this.scope&&(k=this.scope.internal.getEncryptor(this.objId)),"("+jm(k(a))+")"},set:function(k){a=k.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(k){a=k}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(k){s=k}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(k){o=k}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(k){u=k}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/gO:h},set:function(k){h=k}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(k){f=k}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof eS||this instanceof am))return B3(d,this.objId,this.scope)},set:function(k){k=k.toString(),d=k}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Jl==0?B3(b,this.objId,this.scope):b},set:function(k){k=k.toString(),b=this instanceof Jl==0?k.substr(0,1)==="("?Py(k.substr(1,k.length-2)):Py(k):k}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Jl==1?Py(b.substr(1,b.length-1)):b},set:function(k){k=k.toString(),b=this instanceof Jl==1?"/"+k:k}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(k){this.V=k}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Jl==0?B3(v,this.objId,this.scope):v},set:function(k){k=k.toString(),v=this instanceof Jl==0?k.substr(0,1)==="("?Py(k.substr(1,k.length-2)):Py(k):k}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Jl==1?Py(v.substr(1,v.length-1)):v},set:function(k){k=k.toString(),v=this instanceof Jl==1?"/"+k:k}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,E=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return E},set:function(k){k=!!k,E=k}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(k){S=k}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,1)},set:function(k){k?this.Ff=$s(this.Ff,1):this.Ff=qs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,2)},set:function(k){k?this.Ff=$s(this.Ff,2):this.Ff=qs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,3)},set:function(k){k?this.Ff=$s(this.Ff,3):this.Ff=qs(this.Ff,3)}});var P=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(P!==null)return P},set:function(k){if([0,1,2].indexOf(k)===-1)throw new Error('Invalid value "'+k+'" for attribute Q supplied.');P=k}}),Object.defineProperty(this,"textAlign",{get:function(){var k;switch(P){case 0:default:k="left";break;case 1:k="center";break;case 2:k="right"}return k},configurable:!0,enumerable:!0,set:function(k){switch(k){case"right":case 2:P=2;break;case"center":case 1:P=1;break;default:P=0}}})};Mc(df,qf);var Bv=function(){df.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return PX(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,s,o){o||(o=1);for(var u,h=[];u=s.exec(a);)h.push(u[o]);return h})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,18)},set:function(r){r?this.Ff=$s(this.Ff,18):this.Ff=qs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=$s(this.Ff,19):this.Ff=qs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,20)},set:function(r){r?(this.Ff=$s(this.Ff,20),e.sort()):this.Ff=qs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,22)},set:function(r){r?this.Ff=$s(this.Ff,22):this.Ff=qs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,23)},set:function(r){r?this.Ff=$s(this.Ff,23):this.Ff=qs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,27)},set:function(r){r?this.Ff=$s(this.Ff,27):this.Ff=qs(this.Ff,27)}}),this.hasAppearanceStream=!1};Mc(Bv,df);var zv=function(){Bv.call(this),this.fontName="helvetica",this.combo=!1};Mc(zv,Bv);var jv=function(){zv.call(this),this.combo=!0};Mc(jv,zv);var dw=function(){jv.call(this),this.edit=!0};Mc(dw,jv);var Jl=function(){df.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,15)},set:function(r){r?this.Ff=$s(this.Ff,15):this.Ff=qs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,16)},set:function(r){r?this.Ff=$s(this.Ff,16):this.Ff=qs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,17)},set:function(r){r?this.Ff=$s(this.Ff,17):this.Ff=qs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,26)},set:function(r){r?this.Ff=$s(this.Ff,26):this.Ff=qs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+jm(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){ao(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Mc(Jl,df);var pw=function(){Jl.call(this),this.pushButton=!0};Mc(pw,Jl);var Uv=function(){Jl.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Mc(Uv,Jl);var eS=function(){var t,e;df.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+jm(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){ao(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Mc(eS,df),Uv.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Uv.prototype.createOption=function(t){var e=new eS;return e.Parent=this,e.optionName=t,this.Kids.push(e),nve.call(this.scope,e),e};var gw=function(){Jl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qn.CheckBox.createAppearanceStream()};Mc(gw,Jl);var am=function(){df.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,13)},set:function(e){e?this.Ff=$s(this.Ff,13):this.Ff=qs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,21)},set:function(e){e?this.Ff=$s(this.Ff,21):this.Ff=qs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,23)},set:function(e){e?this.Ff=$s(this.Ff,23):this.Ff=qs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,24)},set:function(e){e?this.Ff=$s(this.Ff,24):this.Ff=qs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,25)},set:function(e){e?this.Ff=$s(this.Ff,25):this.Ff=qs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,26)},set:function(e){e?this.Ff=$s(this.Ff,26):this.Ff=qs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Mc(am,df);var mw=function(){am.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Vs(this.Ff,14)},set:function(t){t?this.Ff=$s(this.Ff,14):this.Ff=qs(this.Ff,14)}}),this.password=!0};Mc(mw,am);var Qn={CheckBox:{createAppearanceStream:function(){return{N:{On:Qn.CheckBox.YesNormal},D:{On:Qn.CheckBox.YesPushDown,Off:Qn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=JP(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+ji(Qn.internal.getWidth(t))+" "+ji(Qn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ji(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Ff(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Qn.internal.getHeight(t),s=Qn.internal.getWidth(t),o=JP(t,t.caption);return i.push("1 g"),i.push("0 0 "+ji(s)+" "+ji(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+ji(s-1)+" "+ji(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+ji(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ji(Qn.internal.getWidth(t))+" "+ji(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Circle.YesNormal,e.D[t]=Qn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Ff(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Qn.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+wp(Qn.internal.getWidth(t)/2)+" "+wp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5)),s=Number((n*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+wp(Qn.internal.getWidth(t)/2)+" "+wp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+wp(Qn.internal.getWidth(t)/2)+" "+wp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+wp(Qn.internal.getWidth(t)/2)+" "+wp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Cross.YesNormal,e.D[t]=Qn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Ff(t);e.scope=t.scope;var r=[],n=Qn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+ji(Qn.internal.getWidth(t)-2)+" "+ji(Qn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(ji(n.x1.x)+" "+ji(n.x1.y)+" m"),r.push(ji(n.x2.x)+" "+ji(n.x2.y)+" l"),r.push(ji(n.x4.x)+" "+ji(n.x4.y)+" m"),r.push(ji(n.x3.x)+" "+ji(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=Qn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+ji(Qn.internal.getWidth(t))+" "+ji(Qn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ji(Qn.internal.getWidth(t)-2)+" "+ji(Qn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(ji(r.x1.x)+" "+ji(r.x1.y)+" m"),n.push(ji(r.x2.x)+" "+ji(r.x2.y)+" l"),n.push(ji(r.x4.x)+" "+ji(r.x4.y)+" m"),n.push(ji(r.x3.x)+" "+ji(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Ff(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ji(Qn.internal.getWidth(t))+" "+ji(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Qn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qn.internal.getWidth(t),r=Qn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Qn.internal.getWidth=function(t){var e=0;return ao(t)==="object"&&(e=PB(t.Rect[2])),e},Qn.internal.getHeight=function(t){var e=0;return ao(t)==="object"&&(e=PB(t.Rect[3])),e};var nve=Ls.addField=function(t){if(rve(this,t),!(t instanceof df))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ls.AcroFormChoiceField=Bv,Ls.AcroFormListBox=zv,Ls.AcroFormComboBox=jv,Ls.AcroFormEditBox=dw,Ls.AcroFormButton=Jl,Ls.AcroFormPushButton=pw,Ls.AcroFormRadioButton=Uv,Ls.AcroFormCheckBox=gw,Ls.AcroFormTextField=am,Ls.AcroFormPasswordField=mw,Ls.AcroFormAppearance=Qn,Ls.AcroForm={ChoiceField:Bv,ListBox:zv,ComboBox:jv,EditBox:dw,Button:Jl,PushButton:pw,RadioButton:Uv,CheckBox:gw,TextField:am,PasswordField:mw,Appearance:Qn},hi.AcroForm={ChoiceField:Bv,ListBox:zv,ComboBox:jv,EditBox:dw,Button:Jl,PushButton:pw,RadioButton:Uv,CheckBox:gw,TextField:am,PasswordField:mw,Appearance:Qn};hi.AcroForm;function RX(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(J,H){var ne,ae,ue,de,Pe,me=r;if((H=H||r)==="RGBA"||J.data!==void 0&&J.data instanceof Uint8ClampedArray&&"height"in J&&"width"in J)return"RGBA";if(B(J))for(Pe in n)for(ue=n[Pe],ne=0;ne<ue.length;ne+=1){for(de=!0,ae=0;ae<ue[ne].length;ae+=1)if(ue[ne][ae]!==void 0&&ue[ne][ae]!==J[ae]){de=!1;break}if(de===!0){me=Pe;break}}else for(Pe in n)for(ue=n[Pe],ne=0;ne<ue.length;ne+=1){for(de=!0,ae=0;ae<ue[ne].length;ae+=1)if(ue[ne][ae]!==void 0&&ue[ne][ae]!==J.charCodeAt(ae)){de=!1;break}if(de===!0){me=Pe;break}}return me===r&&H!==r&&(me=H),me},a=function J(H){for(var ne=this.internal.write,ae=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);H.objectId=this.internal.newObject();var de=[];if(de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Image"}),de.push({key:"Width",value:H.width}),de.push({key:"Height",value:H.height}),H.colorSpace===k.INDEXED?de.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(H.palette.length/3-1)+" "+("sMask"in H&&H.sMask!==void 0?H.objectId+2:H.objectId+1)+" 0 R]"}):(de.push({key:"ColorSpace",value:"/"+H.colorSpace}),H.colorSpace===k.DEVICE_CMYK&&de.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),de.push({key:"BitsPerComponent",value:H.bitsPerComponent}),"decodeParameters"in H&&H.decodeParameters!==void 0&&de.push({key:"DecodeParms",value:"<<"+H.decodeParameters+">>"}),"transparency"in H&&Array.isArray(H.transparency)){for(var Pe="",me=0,Ee=H.transparency.length;me<Ee;me++)Pe+=H.transparency[me]+" "+H.transparency[me]+" ";de.push({key:"Mask",value:"["+Pe+"]"})}H.sMask!==void 0&&de.push({key:"SMask",value:H.objectId+1+" 0 R"});var we=H.filter!==void 0?["/"+H.filter]:void 0;if(ae({data:H.data,additionalKeyValues:de,alreadyAppliedFilters:we,objectId:H.objectId}),ne("endobj"),"sMask"in H&&H.sMask!==void 0){var Ae=(H.predictor!=null?"/Predictor "+H.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+H.width,ce={width:H.width,height:H.height,colorSpace:"DeviceGray",bitsPerComponent:H.bitsPerComponent,decodeParameters:Ae,data:H.sMask};"filter"in H&&(ce.filter=H.filter),J.call(this,ce)}if(H.colorSpace===k.INDEXED){var xe=this.internal.newObject();ae({data:W(new Uint8Array(H.palette)),objectId:xe}),ne("endobj")}},s=function(){var J=this.internal.collections[e+"images"];for(var H in J)a.call(this,J[H])},o=function(){var J,H=this.internal.collections[e+"images"],ne=this.internal.write;for(var ae in H)ne("/I"+(J=H[ae]).index,J.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var J=this.internal.collections[e+"images"];return u.call(this),J},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(J){return typeof t["process"+J.toUpperCase()]=="function"},b=function(J){return ao(J)==="object"&&J.nodeType===1},v=function(J,H){if(J.nodeName==="IMG"&&J.hasAttribute("src")){var ne=""+J.getAttribute("src");if(ne.indexOf("data:image/")===0)return fw(unescape(ne).split("base64,").pop());var ae=t.loadFile(ne,!0);if(ae!==void 0)return ae}if(J.nodeName==="CANVAS"){if(J.width===0||J.height===0)throw new Error("Given canvas must have data. Canvas width: "+J.width+", height: "+J.height);var ue;switch(H){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;default:ue="image/jpeg"}return fw(J.toDataURL(ue,1).split("base64,").pop())}},S=function(J){var H=this.internal.collections[e+"images"];if(H){for(var ne in H)if(J===H[ne].alias)return H[ne]}},E=function(J,H,ne){return J||H||(J=-96,H=-96),J<0&&(J=-1*ne.width*72/J/this.internal.scaleFactor),H<0&&(H=-1*ne.height*72/H/this.internal.scaleFactor),J===0&&(J=H*ne.width/ne.height),H===0&&(H=J*ne.height/ne.width),[J,H]},P=function(J,H,ne,ae,ue,de){var Pe=E.call(this,ne,ae,ue),me=this.internal.getCoordinateString,Ee=this.internal.getVerticalCoordinateString,we=h.call(this);if(ne=Pe[0],ae=Pe[1],we[ue.index]=ue,de){de*=Math.PI/180;var Ae=Math.cos(de),ce=Math.sin(de),xe=function(Me){return Me.toFixed(4)},_e=[xe(Ae),xe(ce),xe(-1*ce),xe(Ae),0,0,"cm"]}this.internal.write("q"),de?(this.internal.write([1,"0","0",1,me(J),Ee(H+ae),"cm"].join(" ")),this.internal.write(_e.join(" ")),this.internal.write([me(ne),"0","0",me(ae),"0","0","cm"].join(" "))):this.internal.write([me(ne),"0","0",me(ae),me(J),Ee(H+ae),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},k=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var L=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(J){var H,ne,ae=0;if(typeof J=="string")for(ne=J.length,H=0;H<ne;H++)ae=(ae<<5)-ae+J.charCodeAt(H),ae|=0;else if(B(J))for(ne=J.byteLength/2,H=0;H<ne;H++)ae=(ae<<5)-ae+J[H],ae|=0;return ae},M=t.__addimage__.validateStringAsBase64=function(J){(J=J||"").toString().trim();var H=!0;return J.length===0&&(H=!1),J.length%4!=0&&(H=!1),/^[A-Za-z0-9+/]+$/.test(J.substr(0,J.length-2))===!1&&(H=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(J.substr(-2))===!1&&(H=!1),H},z=t.__addimage__.extractImageFromDataUrl=function(J){if(J==null||!(J=J.trim()).startsWith("data:"))return null;var H=J.indexOf(",");return H<0?null:J.substring(0,H).trim().endsWith("base64")?J.substring(H+1):null};t.__addimage__.isArrayBuffer=function(J){return J instanceof ArrayBuffer};var B=t.__addimage__.isArrayBufferView=function(J){return J instanceof Int8Array||J instanceof Uint8Array||J instanceof Uint8ClampedArray||J instanceof Int16Array||J instanceof Uint16Array||J instanceof Int32Array||J instanceof Uint32Array||J instanceof Float32Array||J instanceof Float64Array},q=t.__addimage__.binaryStringToUint8Array=function(J){for(var H=J.length,ne=new Uint8Array(H),ae=0;ae<H;ae++)ne[ae]=J.charCodeAt(ae);return ne},W=t.__addimage__.arrayBufferToBinaryString=function(J){for(var H="",ne=B(J)?J:new Uint8Array(J),ae=0;ae<ne.length;ae+=8192)H+=String.fromCharCode.apply(null,ne.subarray(ae,ae+8192));return H};t.addImage=function(){var J,H,ne,ae,ue,de,Pe,me,Ee;if(typeof arguments[1]=="number"?(H=r,ne=arguments[1],ae=arguments[2],ue=arguments[3],de=arguments[4],Pe=arguments[5],me=arguments[6],Ee=arguments[7]):(H=arguments[1],ne=arguments[2],ae=arguments[3],ue=arguments[4],de=arguments[5],Pe=arguments[6],me=arguments[7],Ee=arguments[8]),ao(J=arguments[0])==="object"&&!b(J)&&"imageData"in J){var we=J;J=we.imageData,H=we.format||H||r,ne=we.x||ne||0,ae=we.y||ae||0,ue=we.w||we.width||ue,de=we.h||we.height||de,Pe=we.alias||Pe,me=we.compression||me,Ee=we.rotation||we.angle||Ee}var Ae=this.internal.getFilters();if(me===void 0&&Ae.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(ne)||isNaN(ae))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var ce=G.call(this,J,H,Pe,me);return P.call(this,ne,ae,ue,de,ce,Ee),this};var G=function(J,H,ne,ae){var ue,de,Pe;if(typeof J=="string"&&i(J)===r){J=unescape(J);var me=ie(J,!1);(me!==""||(me=t.loadFile(J,!0))!==void 0)&&(J=me)}if(b(J)&&(J=v(J,H)),H=i(J,H),!d(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(((Pe=ne)==null||Pe.length===0)&&(ne=(function(Ee){return typeof Ee=="string"||B(Ee)?N(Ee):B(Ee.data)?N(Ee.data):null})(J)),(ue=S.call(this,ne))||(J instanceof Uint8Array||H==="RGBA"||(de=J,J=q(J)),ue=this["process"+H.toUpperCase()](J,f.call(this),ne,(function(Ee){return Ee&&typeof Ee=="string"&&(Ee=Ee.toUpperCase()),Ee in t.image_compression?Ee:L.NONE})(ae),de)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},ie=t.__addimage__.convertBase64ToBinaryString=function(J,H){H=typeof H!="boolean"||H;var ne,ae="";if(typeof J=="string"){var ue;ne=(ue=z(J))!==null&&ue!==void 0?ue:J;try{ae=fw(ne)}catch(de){if(H)throw M(ne)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+de.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ae};t.getImageProperties=function(J){var H,ne,ae="";if(b(J)&&(J=v(J)),typeof J=="string"&&i(J)===r&&((ae=ie(J,!1))===""&&(ae=t.loadFile(J)||""),J=ae),ne=i(J),!d(ne))throw new Error("addImage does not support files of type '"+ne+"', please ensure that a plugin for '"+ne+"' support is added.");if(J instanceof Uint8Array||(J=q(J)),!(H=this["process"+ne.toUpperCase()](J)))throw new Error("An unknown error occurred whilst processing the image");return H.fileType=ne,H}})(hi.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};hi.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,f=!1,d=0;d<h.length&&!f;d++)switch((n=h[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var b=0;b<h.length;b++){n=h[b];var v=this.internal.pdfEscape,S=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var E=this.internal.newAdditionalObject(),P=this.internal.newAdditionalObject(),k=this.internal.getEncryptor(E.objId),L=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+v(k(n.contents))+")",a+=" /Popup "+P.objId+" 0 R",a+=" /P "+u.objId+" 0 R",a+=" /T ("+v(k(L))+") >>",E.content=a;var N=E.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+N,n.open&&(a+=" /Open true"),a+=" >>",P.content=a,this.internal.write(E.objId,"0 R",P.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var M=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+v(S(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var z=this.annotations._nameMap[n.options.name];n.options.pageNumber=z.page,n.options.top=z.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+v(S(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var B=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(r),y:h(n),w:u(r+i),h:h(n+a)},options:s,type:"link"})},t.textWithLink=function(r,n,i,a){var s,o,u=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(h*f)}else o=u,s=h;return this.text(r,n,i,a),i+=.2*h,a.align==="center"&&(n-=u/2),a.align==="right"&&(n-=u),this.link(n,i-h,o,s,a),u},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(hi.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(E){return e[E.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(E){return typeof E=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(E)},o=t.__arabicParser__.isArabicEndLetter=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(E){return s(E)&&i.indexOf(E.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(E){var P=0,k=r,L="",N=0;for(P=0;P<E.length;P+=1)k[E.charCodeAt(P)]!==void 0?(N++,typeof(k=k[E.charCodeAt(P)])=="number"&&(L+=String.fromCharCode(k),k=r,N=0),P===E.length-1&&(k=r,L+=E.charAt(P-(N-1)),P-=N-1,N=0)):(k=r,L+=E.charAt(P-N),P-=N,N=0);return L};t.__arabicParser__.isArabicDiacritic=function(E){return E!==void 0&&n[E.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(E,P,k){return s(E)?a(E)===!1?-1:!h(E)||!s(P)&&!s(k)||!s(k)&&o(P)||o(E)&&!s(P)||o(E)&&u(P)||o(E)&&o(P)?0:f(E)&&s(P)&&!o(P)&&s(k)&&h(k)?3:o(E)||!s(k)?1:2:-1},v=function(E){var P=0,k=0,L=0,N="",M="",z="",B=(E=E||"").split("\\s+"),q=[];for(P=0;P<B.length;P+=1){for(q.push(""),k=0;k<B[P].length;k+=1)N=B[P][k],M=B[P][k-1],z=B[P][k+1],s(N)?(L=b(N,M,z),q[P]+=L!==-1?String.fromCharCode(e[N.charCodeAt(0)][L]):N):q[P]+=N;q[P]=d(q[P])}return q.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var E,P=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,k=[];if(Array.isArray(P)){var L=0;for(k=[],L=0;L<P.length;L+=1)Array.isArray(P[L])?k.push([v(P[L][0]),P[L][1],P[L][2]]):k.push([v(P[L])]);E=k}else E=v(P);return typeof arguments[0]=="string"?E:(arguments[0].text=E,arguments[0])};t.events.push(["preProcessText",S])})(hi.API),hi.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(hi.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(E){u=E}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(E){h=E}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(E){f=E}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(E){d=E}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(E){b=E}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(E){v=E}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(E){S=E}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,h){n.call(this);var f=(h=h||{}).fontSize||this.getFontSize(),d=h.font||this.getFont(),b=h.scaleFactor||this.internal.scaleFactor,v=0,S=0,E=0,P=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var k=h.maxWidth;k>0?typeof u=="string"?u=this.splitTextToSize(u,k):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(N,M){return N.concat(P.splitTextToSize(M,k))},[])):u=Array.isArray(u)?u:[u];for(var L=0;L<u.length;L++)v<(E=this.getStringUnitWidth(u[L],{font:d})*f)&&(v=E);return v!==0&&(S=u.length),{w:v/=b,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var u;u=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=d.top,v&&b&&(this.printHeaderRow(u.lineNumber,!0),u.y+=b[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-f,u.y+f,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+f,{align:"center",baseline:"top",maxWidth:u.width-f-f}):this.text(u.text,u.x+f,u.y+f,{align:"left",baseline:"top",maxWidth:u.width-f-f})),this.internal.__cell__.lastCell=u,this};t.table=function(u,h,f,d,b){if(n.call(this),!f)throw new Error("No data for PDF table.");var v,S,E,P,k=[],L=[],N=[],M={},z={},B=[],q=[],W=(b=b||{}).autoSize||!1,G=b.printHeaders!==!1,ie=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,J=b.margins||Object.assign({width:this.getPageWidth()},e),H=typeof b.padding=="number"?b.padding:3,ne=b.headerBackgroundColor||"#c8c8c8",ae=b.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=J,this.internal.__cell__.table_font_size=ie,this.internal.__cell__.padding=H,this.internal.__cell__.headerBackgroundColor=ne,this.internal.__cell__.headerTextColor=ae,this.setFontSize(ie),d==null)L=k=Object.keys(f[0]),N=k.map(function(){return"left"});else if(Array.isArray(d)&&ao(d[0])==="object")for(k=d.map(function(we){return we.name}),L=d.map(function(we){return we.prompt||we.name||""}),N=d.map(function(we){return we.align||"left"}),v=0;v<d.length;v+=1)z[d[v].name]=.7499990551181103*d[v].width;else Array.isArray(d)&&typeof d[0]=="string"&&(L=k=d,N=k.map(function(){return"left"}));if(W||Array.isArray(d)&&typeof d[0]=="string")for(v=0;v<k.length;v+=1){for(M[P=k[v]]=f.map(function(we){return we[P]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(L[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=M[P],this.setFont(void 0,"normal"),E=0;E<S.length;E+=1)B.push(this.getTextDimensions(S[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);z[P]=Math.max.apply(null,B)+H+H,B=[]}if(G){var ue={};for(v=0;v<k.length;v+=1)ue[k[v]]={},ue[k[v]].text=L[v],ue[k[v]].align=N[v];var de=o.call(this,ue,z);q=k.map(function(we){return new a(u,h,z[we],de,ue[we].text,void 0,ue[we].align)}),this.setTableHeaderRow(q),this.printHeaderRow(1,!1)}var Pe=d.reduce(function(we,Ae){return we[Ae.name]=Ae.align,we},{});for(v=0;v<f.length;v+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:v,data:f[v]},this);var me=o.call(this,f[v],z);for(E=0;E<k.length;E+=1){var Ee=f[v][k[E]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:v,col:E,data:Ee},this),s.call(this,new a(u,h,z[k[E]],me,Ee,v+2,Pe[k[E]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var o=function(u,h){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(u).map(function(v){var S=u[v];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,h[v]-f-f)},this).map(function(v){return this.getLineHeightFactor()*v.length*d/b+f+f},this).reduce(function(v,S){return Math.max(v,S)},0)};t.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){f=this.internal.__cell__.tableHeaderRow[v].clone(),h&&(f.y=this.internal.__cell__.margins.top||0,b.push(f)),f.lineNumber=u;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(S)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(hi.API);var OX={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},NX=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],QP=RX(NX),LX=[100,200,300,400,500,600,700,800,900],ive=RX(LX);function z3(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return OX[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof QP[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function kB(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var ave={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},MB={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function RB(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function OB(t){return t.trimLeft()}function ove(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function sve(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var s2,NB,LB,ky,l2,DB,FB,BB,j3=["times"];function zB(t,e,r,n){var i=4,a=UB;switch(n){case hi.API.image_compression.FAST:i=1,a=jB;break;case hi.API.image_compression.MEDIUM:i=6,a=VB;break;case hi.API.image_compression.SLOW:i=9,a=$B}t=(function(o,u,h,f){for(var d,b=o.length/u,v=new Uint8Array(o.length+b),S=[lve,jB,UB,VB,$B],E=0;E<b;E+=1){var P=E*u,k=o.subarray(P,P+u);if(f)v.set(f(k,h,d),P+E);else{for(var L=S.length,N=[],M=0;M<L;M+=1)N[M]=S[M](k,h,d);var z=cve(N.concat());v.set(N[z],P+E)}d=k}return v})(t,e,r,a);var s=WP(t,{level:i});return hi.API.__addimage__.arrayBufferToBinaryString(s)}function lve(t){var e=Array.apply([],t);return e.unshift(0),e}function jB(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function UB(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=t[a]-s+256&255}return i}function VB(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=t[a-e]||0,o=r&&r[a]||0;i[a+1]=t[a]+256-(s+o>>>1)&255}return i}function $B(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=uve(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-s+256&255}return i}function uve(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function cve(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function U3(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return DX(t,i)>>a&s}function qB(t,e,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,u=(e&o)<<s;(function(h,f,d){if(f+1<h.byteLength)h.setUint16(f,d,!1);else{var b=d>>8&255;h.setUint8(f,b)}})(t,a,DX(t,a)&~(o<<s)&65535|u)}function DX(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function hve(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=1<<1+(7&i);t[e++],t[e++];var o=null,u=null;a&&(o=e,u=s,e+=3*s);var h=!0,f=[],d=0,b=null,v=0,S=null;for(this.width=r,this.height=n;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,S=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((J=t[e++])>=0))throw Error("Invalid block size");if(J===0)break;e+=J}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var E=t[e++];d=t[e++]|t[e++]<<8,b=t[e++],1&E||(b=null),v=E>>2&7,e++;break;case 254:for(;;){if(!((J=t[e++])>=0))throw Error("Invalid block size");if(J===0)break;e+=J}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var P=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,L=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,M=t[e++],z=M>>6&1,B=1<<1+(7&M),q=o,W=u,G=!1;M>>7&&(G=!0,q=e,W=B,e+=3*B);var ie=e;for(e++;;){var J;if(!((J=t[e++])>=0))throw Error("Invalid block size");if(J===0)break;e+=J}f.push({x:P,y:k,width:L,height:N,has_local_palette:G,palette_offset:q,palette_size:W,data_offset:ie,data_length:e-ie,transparent_index:b,interlaced:!!z,delay:d,disposal:v});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(H){if(H<0||H>=f.length)throw new Error("Frame index out of range.");return f[H]},this.decodeAndBlitFrameBGRA=function(H,ne){var ae=this.frameInfo(H),ue=ae.width*ae.height,de=new Uint8Array(ue);HB(t,ae.data_offset,de,ue);var Pe=ae.palette_offset,me=ae.transparent_index;me===null&&(me=256);var Ee=ae.width,we=r-Ee,Ae=Ee,ce=4*(ae.y*r+ae.x),xe=4*((ae.y+ae.height)*r+ae.x),_e=ce,Me=4*we;ae.interlaced===!0&&(Me+=4*r*7);for(var Re=8,He=0,Fe=de.length;He<Fe;++He){var tt=de[He];if(Ae===0&&(Ae=Ee,(_e+=Me)>=xe&&(Me=4*we+4*r*(Re-1),_e=ce+(Ee+we)*(Re<<1),Re>>=1)),tt===me)_e+=4;else{var Ze=t[Pe+3*tt],Qe=t[Pe+3*tt+1],Ie=t[Pe+3*tt+2];ne[_e++]=Ie,ne[_e++]=Qe,ne[_e++]=Ze,ne[_e++]=255}--Ae}},this.decodeAndBlitFrameRGBA=function(H,ne){var ae=this.frameInfo(H),ue=ae.width*ae.height,de=new Uint8Array(ue);HB(t,ae.data_offset,de,ue);var Pe=ae.palette_offset,me=ae.transparent_index;me===null&&(me=256);var Ee=ae.width,we=r-Ee,Ae=Ee,ce=4*(ae.y*r+ae.x),xe=4*((ae.y+ae.height)*r+ae.x),_e=ce,Me=4*we;ae.interlaced===!0&&(Me+=4*r*7);for(var Re=8,He=0,Fe=de.length;He<Fe;++He){var tt=de[He];if(Ae===0&&(Ae=Ee,(_e+=Me)>=xe&&(Me=4*we+4*r*(Re-1),_e=ce+(Ee+we)*(Re<<1),Re>>=1)),tt===me)_e+=4;else{var Ze=t[Pe+3*tt],Qe=t[Pe+3*tt+1],Ie=t[Pe+3*tt+2];ne[_e++]=Ze,ne[_e++]=Qe,ne[_e++]=Ie,ne[_e++]=255}--Ae}}}function HB(t,e,r,n){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,u=i+1,h=(1<<u)-1,f=0,d=0,b=0,v=t[e++],S=new Int32Array(4096),E=null;;){for(;f<16&&v!==0;)d|=t[e++]<<f,f+=8,v===1?v=t[e++]:--v;if(f<u)break;var P=d&h;if(d>>=u,f-=u,P!==a){if(P===s)break;for(var k=P<o?P:E,L=0,N=k;N>a;)N=S[N]>>8,++L;var M=N;if(b+L+(k!==P?1:0)>n)return void ko.log("Warning, gif stream longer than expected.");r[b++]=M;var z=b+=L;for(k!==P&&(r[b++]=M),N=k;L--;)N=S[N],r[--z]=255&N,N>>=8;E!==null&&o<4096&&(S[o++]=E<<8|M,o>=h+1&&u<12&&(++u,h=h<<1|1)),E=P}else o=s+1,h=(1<<(u=i+1))-1,E=null}return b!==n&&ko.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function V3(t){var e,r,n,i,a,s=Math.floor,o=new Array(64),u=new Array(64),h=new Array(64),f=new Array(64),d=new Array(65535),b=new Array(65535),v=new Array(64),S=new Array(64),E=[],P=0,k=7,L=new Array(64),N=new Array(64),M=new Array(64),z=new Array(256),B=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],ie=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],J=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],H=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ne=[0,1,2,3,4,5,6,7,8,9,10,11],ae=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function de(ce,xe){for(var _e=0,Me=0,Re=new Array,He=1;He<=16;He++){for(var Fe=1;Fe<=ce[He];Fe++)Re[xe[Me]]=[],Re[xe[Me]][0]=_e,Re[xe[Me]][1]=He,Me++,_e++;_e*=2}return Re}function Pe(ce){for(var xe=ce[0],_e=ce[1]-1;_e>=0;)xe&1<<_e&&(P|=1<<k),_e--,--k<0&&(P==255?(me(255),me(0)):me(P),k=7,P=0)}function me(ce){E.push(ce)}function Ee(ce){me(ce>>8&255),me(255&ce)}function we(ce,xe,_e,Me,Re){for(var He,Fe=Re[0],tt=Re[240],Ze=(function(mt,br){var Tr,mr,Mr,Pr,ar,fr,Nr,or,Dr,er,Gt=0;for(Dr=0;Dr<8;++Dr){Tr=mt[Gt],mr=mt[Gt+1],Mr=mt[Gt+2],Pr=mt[Gt+3],ar=mt[Gt+4],fr=mt[Gt+5],Nr=mt[Gt+6];var Tt=Tr+(or=mt[Gt+7]),Oe=Tr-or,Be=mr+Nr,Ne=mr-Nr,rt=Mr+fr,pt=Mr-fr,Rt=Pr+ar,Bt=Pr-ar,At=Tt+Rt,Zt=Tt-Rt,jt=Be+rt,St=Be-rt;mt[Gt]=At+jt,mt[Gt+4]=At-jt;var Xt=.707106781*(St+Zt);mt[Gt+2]=Zt+Xt,mt[Gt+6]=Zt-Xt;var Ct=.382683433*((At=Bt+pt)-(St=Ne+Oe)),Lr=.5411961*At+Ct,qt=1.306562965*St+Ct,Zr=.707106781*(jt=pt+Ne),jr=Oe+Zr,vn=Oe-Zr;mt[Gt+5]=vn+Lr,mt[Gt+3]=vn-Lr,mt[Gt+1]=jr+qt,mt[Gt+7]=jr-qt,Gt+=8}for(Gt=0,Dr=0;Dr<8;++Dr){Tr=mt[Gt],mr=mt[Gt+8],Mr=mt[Gt+16],Pr=mt[Gt+24],ar=mt[Gt+32],fr=mt[Gt+40],Nr=mt[Gt+48];var Ce=Tr+(or=mt[Gt+56]),Ue=Tr-or,ft=mr+Nr,Mt=mr-Nr,xr=Mr+fr,Kr=Mr-fr,Rr=Pr+ar,di=Pr-ar,ti=Ce+Rr,bi=Ce-Rr,Ui=ft+xr,Xr=ft-xr;mt[Gt]=ti+Ui,mt[Gt+32]=ti-Ui;var _n=.707106781*(Xr+bi);mt[Gt+16]=bi+_n,mt[Gt+48]=bi-_n;var Fn=.382683433*((ti=di+Kr)-(Xr=Mt+Ue)),na=.5411961*ti+Fn,Ca=1.306562965*Xr+Fn,ua=.707106781*(Ui=Kr+Mt),Mn=Ue+ua,oo=Ue-ua;mt[Gt+40]=oo+na,mt[Gt+24]=oo-na,mt[Gt+8]=Mn+Ca,mt[Gt+56]=Mn-Ca,Gt++}for(Dr=0;Dr<64;++Dr)er=mt[Dr]*br[Dr],v[Dr]=er>0?er+.5|0:er-.5|0;return v})(ce,xe),Qe=0;Qe<64;++Qe)S[q[Qe]]=Ze[Qe];var Ie=S[0]-_e;_e=S[0],Ie==0?Pe(Me[0]):(Pe(Me[b[He=32767+Ie]]),Pe(d[He]));for(var Lt=63;Lt>0&&S[Lt]==0;)Lt--;if(Lt==0)return Pe(Fe),_e;for(var at,Ve=1;Ve<=Lt;){for(var nr=Ve;S[Ve]==0&&Ve<=Lt;)++Ve;var Yt=Ve-nr;if(Yt>=16){at=Yt>>4;for(var yr=1;yr<=at;++yr)Pe(tt);Yt&=15}He=32767+S[Ve],Pe(Re[(Yt<<4)+b[He]]),Pe(d[He]),Ve++}return Lt!=63&&Pe(Fe),_e}function Ae(ce){ce=Math.min(Math.max(ce,1),100),a!=ce&&((function(xe){for(var _e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Me=0;Me<64;Me++){var Re=s((_e[Me]*xe+50)/100);Re=Math.min(Math.max(Re,1),255),o[q[Me]]=Re}for(var He=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Fe=0;Fe<64;Fe++){var tt=s((He[Fe]*xe+50)/100);tt=Math.min(Math.max(tt,1),255),u[q[Fe]]=tt}for(var Ze=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Qe=0,Ie=0;Ie<8;Ie++)for(var Lt=0;Lt<8;Lt++)h[Qe]=1/(o[q[Qe]]*Ze[Ie]*Ze[Lt]*8),f[Qe]=1/(u[q[Qe]]*Ze[Ie]*Ze[Lt]*8),Qe++})(ce<50?Math.floor(5e3/ce):Math.floor(200-2*ce)),a=ce)}this.encode=function(ce,xe){xe&&Ae(xe),E=new Array,P=0,k=7,Ee(65496),Ee(65504),Ee(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),Ee(1),Ee(1),me(0),me(0),(function(){Ee(65499),Ee(132),me(0);for(var mr=0;mr<64;mr++)me(o[mr]);me(1);for(var Mr=0;Mr<64;Mr++)me(u[Mr])})(),(function(mr,Mr){Ee(65472),Ee(17),me(8),Ee(Mr),Ee(mr),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)})(ce.width,ce.height),(function(){Ee(65476),Ee(418),me(0);for(var mr=0;mr<16;mr++)me(W[mr+1]);for(var Mr=0;Mr<=11;Mr++)me(G[Mr]);me(16);for(var Pr=0;Pr<16;Pr++)me(ie[Pr+1]);for(var ar=0;ar<=161;ar++)me(J[ar]);me(1);for(var fr=0;fr<16;fr++)me(H[fr+1]);for(var Nr=0;Nr<=11;Nr++)me(ne[Nr]);me(17);for(var or=0;or<16;or++)me(ae[or+1]);for(var Dr=0;Dr<=161;Dr++)me(ue[Dr])})(),Ee(65498),Ee(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var _e=0,Me=0,Re=0;P=0,k=7,this.encode.displayName="_encode_";for(var He,Fe,tt,Ze,Qe,Ie,Lt,at,Ve,nr=ce.data,Yt=ce.width,yr=ce.height,mt=4*Yt,br=0;br<yr;){for(He=0;He<mt;){for(Qe=mt*br+He,Lt=-1,at=0,Ve=0;Ve<64;Ve++)Ie=Qe+(at=Ve>>3)*mt+(Lt=4*(7&Ve)),br+at>=yr&&(Ie-=mt*(br+1+at-yr)),He+Lt>=mt&&(Ie-=He+Lt-mt+4),Fe=nr[Ie++],tt=nr[Ie++],Ze=nr[Ie++],L[Ve]=(B[Fe]+B[tt+256|0]+B[Ze+512|0]>>16)-128,N[Ve]=(B[Fe+768|0]+B[tt+1024|0]+B[Ze+1280|0]>>16)-128,M[Ve]=(B[Fe+1280|0]+B[tt+1536|0]+B[Ze+1792|0]>>16)-128;_e=we(L,h,_e,e,n),Me=we(N,f,Me,r,i),Re=we(M,f,Re,r,i),He+=32}br+=8}if(k>=0){var Tr=[];Tr[1]=k+1,Tr[0]=(1<<k+1)-1,Pe(Tr)}return Ee(65497),new Uint8Array(E)},t=t||50,(function(){for(var ce=String.fromCharCode,xe=0;xe<256;xe++)z[xe]=ce(xe)})(),e=de(W,G),r=de(H,ne),n=de(ie,J),i=de(ae,ue),(function(){for(var ce=1,xe=2,_e=1;_e<=15;_e++){for(var Me=ce;Me<xe;Me++)b[32767+Me]=_e,d[32767+Me]=[],d[32767+Me][1]=_e,d[32767+Me][0]=Me;for(var Re=-(xe-1);Re<=-ce;Re++)b[32767+Re]=_e,d[32767+Re]=[],d[32767+Re][1]=_e,d[32767+Re][0]=xe-1+Re;ce<<=1,xe<<=1}})(),(function(){for(var ce=0;ce<256;ce++)B[ce]=19595*ce,B[ce+256|0]=38470*ce,B[ce+512|0]=7471*ce+32768,B[ce+768|0]=-11059*ce,B[ce+1024|0]=-21709*ce,B[ce+1280|0]=32768*ce+8421375,B[ce+1536|0]=-27439*ce,B[ce+1792|0]=-5329*ce})(),Ae(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Gh(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function WB(t){function e(G){if(!G)throw Error("assert :P")}function r(G,ie,J){for(var H=0;4>H;H++)if(G[ie+H]!=J.charCodeAt(H))return!0;return!1}function n(G,ie,J,H,ne){for(var ae=0;ae<ne;ae++)G[ie+ae]=J[H+ae]}function i(G,ie,J,H){for(var ne=0;ne<H;ne++)G[ie+ne]=J}function a(G){return new Int32Array(G)}function s(G,ie){for(var J=[],H=0;H<G;H++)J.push(new ie);return J}function o(G,ie){var J=[];return(function H(ne,ae,ue){for(var de=ue[ae],Pe=0;Pe<de&&(ne.push(ue.length>ae+1?[]:new ie),!(ue.length<ae+1));Pe++)H(ne[Pe],ae+1,ue)})(J,0,G),J}var u=function(){var G=this;function ie(V,Y){for(var fe=1<<Y-1>>>0;V&fe;)fe>>>=1;return fe?(V&fe-1)+fe:V}function J(V,Y,fe,Te,We){e(!(Te%fe));do V[Y+(Te-=fe)]=We;while(0<Te)}function H(V,Y,fe,Te,We){if(e(2328>=We),512>=We)var Je=a(512);else if((Je=a(We))==null)return 0;return(function(et,it,ct,bt,xt,kr){var wt,ir,dr=it,Ur=1<<ct,Cr=a(16),wr=a(16);for(e(xt!=0),e(bt!=null),e(et!=null),e(0<ct),ir=0;ir<xt;++ir){if(15<bt[ir])return 0;++Cr[bt[ir]]}if(Cr[0]==xt)return 0;for(wr[1]=0,wt=1;15>wt;++wt){if(Cr[wt]>1<<wt)return 0;wr[wt+1]=wr[wt]+Cr[wt]}for(ir=0;ir<xt;++ir)wt=bt[ir],0<bt[ir]&&(kr[wr[wt]++]=ir);if(wr[15]==1)return(bt=new ne).g=0,bt.value=kr[0],J(et,dr,1,Ur,bt),Ur;var qr,fn=-1,an=Ur-1,ri=0,Gn=1,Oi=1,Yn=1<<ct;for(ir=0,wt=1,xt=2;wt<=ct;++wt,xt<<=1){if(Gn+=Oi<<=1,0>(Oi-=Cr[wt]))return 0;for(;0<Cr[wt];--Cr[wt])(bt=new ne).g=wt,bt.value=kr[ir++],J(et,dr+ri,xt,Yn,bt),ri=ie(ri,wt)}for(wt=ct+1,xt=2;15>=wt;++wt,xt<<=1){if(Gn+=Oi<<=1,0>(Oi-=Cr[wt]))return 0;for(;0<Cr[wt];--Cr[wt]){if(bt=new ne,(ri&an)!=fn){for(dr+=Yn,qr=1<<(fn=wt)-ct;15>fn&&!(0>=(qr-=Cr[fn]));)++fn,qr<<=1;Ur+=Yn=1<<(qr=fn-ct),et[it+(fn=ri&an)].g=qr+ct,et[it+fn].value=dr-it-fn}bt.g=wt-ct,bt.value=kr[ir++],J(et,dr+(ri>>ct),xt,Yn,bt),ri=ie(ri,wt)}}return Gn!=2*wr[15]-1?0:Ur})(V,Y,fe,Te,We,Je)}function ne(){this.value=this.g=0}function ae(){this.value=this.g=0}function ue(){this.G=s(5,ne),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ao,ae)}function de(V,Y,fe,Te){e(V!=null),e(Y!=null),e(2147483648>Te),V.Ca=254,V.I=0,V.b=-8,V.Ka=0,V.oa=Y,V.pa=fe,V.Jd=Y,V.Yc=fe+Te,V.Zc=4<=Te?fe+Te-4+1:fe,Fe(V)}function Pe(V,Y){for(var fe=0;0<Y--;)fe|=Ze(V,128)<<Y;return fe}function me(V,Y){var fe=Pe(V,Y);return tt(V)?-fe:fe}function Ee(V,Y,fe,Te){var We,Je=0;for(e(V!=null),e(Y!=null),e(4294967288>Te),V.Sb=Te,V.Ra=0,V.u=0,V.h=0,4<Te&&(Te=4),We=0;We<Te;++We)Je+=Y[fe+We]<<8*We;V.Ra=Je,V.bb=Te,V.oa=Y,V.pa=fe}function we(V){for(;8<=V.u&&V.bb<V.Sb;)V.Ra>>>=8,V.Ra+=V.oa[V.pa+V.bb]<<El-8>>>0,++V.bb,V.u-=8;Me(V)&&(V.h=1,V.u=0)}function Ae(V,Y){if(e(0<=Y),!V.h&&Y<=jo){var fe=_e(V)&ql[Y];return V.u+=Y,we(V),fe}return V.h=1,V.u=0}function ce(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function xe(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function _e(V){return V.Ra>>>(V.u&El-1)>>>0}function Me(V){return e(V.bb<=V.Sb),V.h||V.bb==V.Sb&&V.u>El}function Re(V,Y){V.u=Y,V.h=Me(V)}function He(V){V.u>=Ia&&(e(V.u>=Ia),we(V))}function Fe(V){e(V!=null&&V.oa!=null),V.pa<V.Zc?(V.I=(V.oa[V.pa++]|V.I<<8)>>>0,V.b+=8):(e(V!=null&&V.oa!=null),V.pa<V.Yc?(V.b+=8,V.I=V.oa[V.pa++]|V.I<<8):V.Ka?V.b=0:(V.I<<=8,V.b+=8,V.Ka=1))}function tt(V){return Pe(V,1)}function Ze(V,Y){var fe=V.Ca;0>V.b&&Fe(V);var Te=V.b,We=fe*Y>>>8,Je=(V.I>>>Te>We)+0;for(Je?(fe-=We,V.I-=We+1<<Te>>>0):fe=We+1,Te=fe,We=0;256<=Te;)We+=8,Te>>=8;return Te=7^We+tl[Te],V.b-=Te,V.Ca=(fe<<Te)-1,Je}function Qe(V,Y,fe){V[Y+0]=fe>>24&255,V[Y+1]=fe>>16&255,V[Y+2]=fe>>8&255,V[Y+3]=255&fe}function Ie(V,Y){return V[Y+0]|V[Y+1]<<8}function Lt(V,Y){return Ie(V,Y)|V[Y+2]<<16}function at(V,Y){return Ie(V,Y)|Ie(V,Y+2)<<16}function Ve(V,Y){var fe=1<<Y;return e(V!=null),e(0<Y),V.X=a(fe),V.X==null?0:(V.Mb=32-Y,V.Xa=Y,1)}function nr(V,Y){e(V!=null),e(Y!=null),e(V.Xa==Y.Xa),n(Y.X,0,V.X,0,1<<Y.Xa)}function Yt(){this.X=[],this.Xa=this.Mb=0}function yr(V,Y,fe,Te){e(fe!=null),e(Te!=null);var We=fe[0],Je=Te[0];return We==0&&(We=(V*Je+Y/2)/Y),Je==0&&(Je=(Y*We+V/2)/V),0>=We||0>=Je?0:(fe[0]=We,Te[0]=Je,1)}function mt(V,Y){return V+(1<<Y)-1>>>Y}function br(V,Y){return((4278255360&V)+(4278255360&Y)>>>0&4278255360)+((16711935&V)+(16711935&Y)>>>0&16711935)>>>0}function Tr(V,Y){G[Y]=function(fe,Te,We,Je,et,it,ct){var bt;for(bt=0;bt<et;++bt){var xt=G[V](it[ct+bt-1],We,Je+bt);it[ct+bt]=br(fe[Te+bt],xt)}}}function mr(){this.ud=this.hd=this.jd=0}function Mr(V,Y){return((4278124286&(V^Y))>>>1)+(V&Y)>>>0}function Pr(V){return 0<=V&&256>V?V:0>V?0:255<V?255:void 0}function ar(V,Y){return Pr(V+(V-Y+.5>>1))}function fr(V,Y,fe){return Math.abs(Y-fe)-Math.abs(V-fe)}function Nr(V,Y,fe,Te,We,Je,et){for(Te=Je[et-1],fe=0;fe<We;++fe)Je[et+fe]=Te=br(V[Y+fe],Te)}function or(V,Y,fe,Te,We){var Je;for(Je=0;Je<fe;++Je){var et=V[Y+Je],it=et>>8&255,ct=16711935&(ct=(ct=16711935&et)+((it<<16)+it));Te[We+Je]=(4278255360&et)+ct>>>0}}function Dr(V,Y){Y.jd=255&V,Y.hd=V>>8&255,Y.ud=V>>16&255}function er(V,Y,fe,Te,We,Je){var et;for(et=0;et<Te;++et){var it=Y[fe+et],ct=it>>>8,bt=it,xt=255&(xt=(xt=it>>>16)+((V.jd<<24>>24)*(ct<<24>>24)>>>5));bt=255&(bt=(bt+=(V.hd<<24>>24)*(ct<<24>>24)>>>5)+((V.ud<<24>>24)*(xt<<24>>24)>>>5)),We[Je+et]=(4278255360&it)+(xt<<16)+bt}}function Gt(V,Y,fe,Te,We){G[Y]=function(Je,et,it,ct,bt,xt,kr,wt,ir){for(ct=kr;ct<wt;++ct)for(kr=0;kr<ir;++kr)bt[xt++]=We(it[Te(Je[et++])])},G[V]=function(Je,et,it,ct,bt,xt,kr){var wt=8>>Je.b,ir=Je.Ea,dr=Je.K[0],Ur=Je.w;if(8>wt)for(Je=(1<<Je.b)-1,Ur=(1<<wt)-1;et<it;++et){var Cr,wr=0;for(Cr=0;Cr<ir;++Cr)Cr&Je||(wr=Te(ct[bt++])),xt[kr++]=We(dr[wr&Ur]),wr>>=wt}else G["VP8LMapColor"+fe](ct,bt,dr,Ur,xt,kr,et,it,ir)}}function Tt(V,Y,fe,Te,We){for(fe=Y+fe;Y<fe;){var Je=V[Y++];Te[We++]=Je>>16&255,Te[We++]=Je>>8&255,Te[We++]=255&Je}}function Oe(V,Y,fe,Te,We){for(fe=Y+fe;Y<fe;){var Je=V[Y++];Te[We++]=Je>>16&255,Te[We++]=Je>>8&255,Te[We++]=255&Je,Te[We++]=Je>>24&255}}function Be(V,Y,fe,Te,We){for(fe=Y+fe;Y<fe;){var Je=(et=V[Y++])>>16&240|et>>12&15,et=240&et|et>>28&15;Te[We++]=Je,Te[We++]=et}}function Ne(V,Y,fe,Te,We){for(fe=Y+fe;Y<fe;){var Je=(et=V[Y++])>>16&248|et>>13&7,et=et>>5&224|et>>3&31;Te[We++]=Je,Te[We++]=et}}function rt(V,Y,fe,Te,We){for(fe=Y+fe;Y<fe;){var Je=V[Y++];Te[We++]=255&Je,Te[We++]=Je>>8&255,Te[We++]=Je>>16&255}}function pt(V,Y,fe,Te,We,Je){if(Je==0)for(fe=Y+fe;Y<fe;)Qe(Te,((Je=V[Y++])[0]>>24|Je[1]>>8&65280|Je[2]<<8&16711680|Je[3]<<24)>>>0),We+=32;else n(Te,We,V,Y,fe)}function Rt(V,Y){G[Y][0]=G[V+"0"],G[Y][1]=G[V+"1"],G[Y][2]=G[V+"2"],G[Y][3]=G[V+"3"],G[Y][4]=G[V+"4"],G[Y][5]=G[V+"5"],G[Y][6]=G[V+"6"],G[Y][7]=G[V+"7"],G[Y][8]=G[V+"8"],G[Y][9]=G[V+"9"],G[Y][10]=G[V+"10"],G[Y][11]=G[V+"11"],G[Y][12]=G[V+"12"],G[Y][13]=G[V+"13"],G[Y][14]=G[V+"0"],G[Y][15]=G[V+"0"]}function Bt(V){return V==pg||V==op||V==fd||V==_f}function At(){this.eb=[],this.size=this.A=this.fb=0}function Zt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function jt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new At,this.f.kb=new Zt,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Xt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ct(V){return alert("todo:WebPSamplerProcessPlane"),V.T}function Lr(V,Y){var fe=V.T,Te=Y.ba.f.RGBA,We=Te.eb,Je=Te.fb+V.ka*Te.A,et=Tl[Y.ba.S],it=V.y,ct=V.O,bt=V.f,xt=V.N,kr=V.ea,wt=V.W,ir=Y.cc,dr=Y.dc,Ur=Y.Mc,Cr=Y.Nc,wr=V.ka,qr=V.ka+V.T,fn=V.U,an=fn+1>>1;for(wr==0?et(it,ct,null,null,bt,xt,kr,wt,bt,xt,kr,wt,We,Je,null,null,fn):(et(Y.ec,Y.fc,it,ct,ir,dr,Ur,Cr,bt,xt,kr,wt,We,Je-Te.A,We,Je,fn),++fe);wr+2<qr;wr+=2)ir=bt,dr=xt,Ur=kr,Cr=wt,xt+=V.Rc,wt+=V.Rc,Je+=2*Te.A,et(it,(ct+=2*V.fa)-V.fa,it,ct,ir,dr,Ur,Cr,bt,xt,kr,wt,We,Je-Te.A,We,Je,fn);return ct+=V.fa,V.j+qr<V.o?(n(Y.ec,Y.fc,it,ct,fn),n(Y.cc,Y.dc,bt,xt,an),n(Y.Mc,Y.Nc,kr,wt,an),fe--):1&qr||et(it,ct,null,null,bt,xt,kr,wt,bt,xt,kr,wt,We,Je+Te.A,null,null,fn),fe}function qt(V,Y,fe){var Te=V.F,We=[V.J];if(Te!=null){var Je=V.U,et=Y.ba.S,it=et==hd||et==fd;Y=Y.ba.f.RGBA;var ct=[0],bt=V.ka;ct[0]=V.T,V.Kb&&(bt==0?--ct[0]:(--bt,We[0]-=V.width),V.j+V.ka+V.T==V.o&&(ct[0]=V.o-V.j-bt));var xt=Y.eb;bt=Y.fb+bt*Y.A,V=fo(Te,We[0],V.width,Je,ct,xt,bt+(it?0:3),Y.A),e(fe==ct),V&&Bt(et)&&Ri(xt,bt,it,Je,ct,Y.A)}return 0}function Zr(V){var Y=V.ma,fe=Y.ba.S,Te=11>fe,We=fe==Ci||fe==pc||fe==hd||fe==Fh||fe==12||Bt(fe);if(Y.memory=null,Y.Ib=null,Y.Jb=null,Y.Nd=null,!Co(Y.Oa,V,We?11:12))return 0;if(We&&Bt(fe)&&Js(),V.da)alert("todo:use_scaling");else{if(Te){if(Y.Ib=Ct,V.Kb){if(fe=V.U+1>>1,Y.memory=a(V.U+2*fe),Y.memory==null)return 0;Y.ec=Y.memory,Y.fc=0,Y.cc=Y.ec,Y.dc=Y.fc+V.U,Y.Mc=Y.cc,Y.Nc=Y.dc+fe,Y.Ib=Lr,Js()}}else alert("todo:EmitYUV");We&&(Y.Jb=qt,Te&&Eu())}if(Te&&!fp){for(V=0;256>V;++V)ay[V]=89858*(V-128)+Fc>>vd,yg[V]=-22014*(V-128)+Fc,Tf[V]=-45773*(V-128),oy[V]=113618*(V-128)+Fc>>vd;for(V=mc;V<al;++V)Y=76283*(V-16)+Fc>>vd,dp[V-mc]=Qa(Y,255),sy[V-mc]=Qa(Y+8>>4,15);fp=1}return 1}function jr(V){var Y=V.ma,fe=V.U,Te=V.T;return e(!(1&V.ka)),0>=fe||0>=Te?0:(fe=Y.Ib(V,Y),Y.Jb!=null&&Y.Jb(V,Y,fe),Y.Dc+=fe,1)}function vn(V){V.ma.memory=null}function Ce(V,Y,fe,Te){return Ae(V,8)!=47?0:(Y[0]=Ae(V,14)+1,fe[0]=Ae(V,14)+1,Te[0]=Ae(V,1),Ae(V,3)!=0?0:!V.h)}function Ue(V,Y){if(4>V)return V+1;var fe=V-2>>1;return(2+(1&V)<<fe)+Ae(Y,fe)+1}function ft(V,Y){return 120<Y?Y-120:1<=(fe=((fe=dd[Y-1])>>4)*V+(8-(15&fe)))?fe:1;var fe}function Mt(V,Y,fe){var Te=_e(fe),We=V[Y+=255&Te].g-8;return 0<We&&(Re(fe,fe.u+8),Te=_e(fe),Y+=V[Y].value,Y+=Te&(1<<We)-1),Re(fe,fe.u+V[Y].g),V[Y].value}function xr(V,Y,fe){return fe.g+=V.g,fe.value+=V.value<<Y>>>0,e(8>=fe.g),V.g}function Kr(V,Y,fe){var Te=V.xc;return e((Y=Te==0?0:V.vc[V.md*(fe>>Te)+(Y>>Te)])<V.Wb),V.Ya[Y]}function Rr(V,Y,fe,Te){var We=V.ab,Je=V.c*Y,et=V.C;Y=et+Y;var it=fe,ct=Te;for(Te=V.Ta,fe=V.Ua;0<We--;){var bt=V.gc[We],xt=et,kr=Y,wt=it,ir=ct,dr=(ct=Te,it=fe,bt.Ea);switch(e(xt<kr),e(kr<=bt.nc),bt.hc){case 2:ou(wt,ir,(kr-xt)*dr,ct,it);break;case 0:var Ur=xt,Cr=kr,wr=ct,qr=it,fn=(Yn=bt).Ea;Ur==0&&(rl(wt,ir,null,null,1,wr,qr),Nr(wt,ir+1,0,0,fn-1,wr,qr+1),ir+=fn,qr+=fn,++Ur);for(var an=1<<Yn.b,ri=an-1,Gn=mt(fn,Yn.b),Oi=Yn.K,Yn=Yn.w+(Ur>>Yn.b)*Gn;Ur<Cr;){var Zi=Oi,Jo=Yn,Pi=1;for(ls(wt,ir,wr,qr-fn,1,wr,qr);Pi<fn;){var Jn=(Pi&~ri)+an;Jn>fn&&(Jn=fn),(0,tr[Zi[Jo++]>>8&15])(wt,ir+ +Pi,wr,qr+Pi-fn,Jn-Pi,wr,qr+Pi),Pi=Jn}ir+=fn,qr+=fn,++Ur&ri||(Yn+=Gn)}kr!=bt.nc&&n(ct,it-dr,ct,it+(kr-xt-1)*dr,dr);break;case 1:for(dr=wt,Cr=ir,fn=(wt=bt.Ea)-(qr=wt&~(wr=(ir=1<<bt.b)-1)),Ur=mt(wt,bt.b),an=bt.K,bt=bt.w+(xt>>bt.b)*Ur;xt<kr;){for(ri=an,Gn=bt,Oi=new mr,Yn=Cr+qr,Zi=Cr+wt;Cr<Yn;)Dr(ri[Gn++],Oi),ur(Oi,dr,Cr,ir,ct,it),Cr+=ir,it+=ir;Cr<Zi&&(Dr(ri[Gn++],Oi),ur(Oi,dr,Cr,fn,ct,it),Cr+=fn,it+=fn),++xt&wr||(bt+=Ur)}break;case 3:if(wt==ct&&ir==it&&0<bt.b){for(Cr=ct,wt=dr=it+(kr-xt)*dr-(qr=(kr-xt)*mt(bt.Ea,bt.b)),ir=ct,wr=it,Ur=[],qr=(fn=qr)-1;0<=qr;--qr)Ur[qr]=ir[wr+qr];for(qr=fn-1;0<=qr;--qr)Cr[wt+qr]=Ur[qr];Yu(bt,xt,kr,ct,dr,ct,it)}else Yu(bt,xt,kr,wt,ir,ct,it)}it=Te,ct=fe}ct!=fe&&n(Te,fe,it,ct,Je)}function di(V,Y){var fe=V.V,Te=V.Ba+V.c*V.C,We=Y-V.C;if(e(Y<=V.l.o),e(16>=We),0<We){var Je=V.l,et=V.Ta,it=V.Ua,ct=Je.width;if(Rr(V,We,fe,Te),We=it=[it],e((fe=V.C)<(Te=Y)),e(Je.v<Je.va),Te>Je.o&&(Te=Je.o),fe<Je.j){var bt=Je.j-fe;fe=Je.j,We[0]+=bt*ct}if(fe>=Te?fe=0:(We[0]+=4*Je.v,Je.ka=fe-Je.j,Je.U=Je.va-Je.v,Je.T=Te-fe,fe=1),fe){if(it=it[0],11>(fe=V.ca).S){var xt=fe.f.RGBA,kr=(Te=fe.S,We=Je.U,Je=Je.T,bt=xt.eb,xt.A),wt=Je;for(xt=xt.fb+V.Ma*xt.A;0<wt--;){var ir=et,dr=it,Ur=We,Cr=bt,wr=xt;switch(Te){case Zu:mn(ir,dr,Ur,Cr,wr);break;case Ci:Tn(ir,dr,Ur,Cr,wr);break;case pg:Tn(ir,dr,Ur,Cr,wr),Ri(Cr,wr,0,Ur,1,0);break;case uu:A(ir,dr,Ur,Cr,wr);break;case pc:pt(ir,dr,Ur,Cr,wr,1);break;case op:pt(ir,dr,Ur,Cr,wr,1),Ri(Cr,wr,0,Ur,1,0);break;case hd:pt(ir,dr,Ur,Cr,wr,0);break;case fd:pt(ir,dr,Ur,Cr,wr,0),Ri(Cr,wr,1,Ur,1,0);break;case Fh:yi(ir,dr,Ur,Cr,wr);break;case _f:yi(ir,dr,Ur,Cr,wr),ho(Cr,wr,Ur,1,0);break;case ey:Rn(ir,dr,Ur,Cr,wr);break;default:e(0)}it+=ct,xt+=kr}V.Ma+=Je}else alert("todo:EmitRescaledRowsYUVA");e(V.Ma<=fe.height)}}V.C=Y,e(V.C<=V.i)}function ti(V){var Y;if(0<V.ua)return 0;for(Y=0;Y<V.Wb;++Y){var fe=V.Ya[Y].G,Te=V.Ya[Y].H;if(0<fe[1][Te[1]+0].g||0<fe[2][Te[2]+0].g||0<fe[3][Te[3]+0].g)return 0}return 1}function bi(V,Y,fe,Te,We,Je){if(V.Z!=0){var et=V.qd,it=V.rd;for(e(cs[V.Z]!=null);Y<fe;++Y)cs[V.Z](et,it,Te,We,Te,We,Je),et=Te,it=We,We+=Je;V.qd=et,V.rd=it}}function Ui(V,Y){var fe=V.l.ma,Te=fe.Z==0||fe.Z==1?V.l.j:V.C;if(Te=V.C<Te?Te:V.C,e(Y<=V.l.o),Y>Te){var We=V.l.width,Je=fe.ca,et=fe.tb+We*Te,it=V.V,ct=V.Ba+V.c*Te,bt=V.gc;e(V.ab==1),e(bt[0].hc==3),su(bt[0],Te,Y,it,ct,Je,et),bi(fe,Te,Y,Je,et,We)}V.C=V.Ma=Y}function Xr(V,Y,fe,Te,We,Je,et){var it=V.$/Te,ct=V.$%Te,bt=V.m,xt=V.s,kr=fe+V.$,wt=kr;We=fe+Te*We;var ir=fe+Te*Je,dr=280+xt.ua,Ur=V.Pb?it:16777216,Cr=0<xt.ua?xt.Wa:null,wr=xt.wc,qr=kr<ir?Kr(xt,ct,it):null;e(V.C<Je),e(ir<=We);var fn=!1;e:for(;;){for(;fn||kr<ir;){var an=0;if(it>=Ur){var ri=kr-fe;e((Ur=V).Pb),Ur.wd=Ur.m,Ur.xd=ri,0<Ur.s.ua&&nr(Ur.s.Wa,Ur.s.vb),Ur=it+wf}if(ct&wr||(qr=Kr(xt,ct,it)),e(qr!=null),qr.Qb&&(Y[kr]=qr.qb,fn=!0),!fn)if(He(bt),qr.jc){an=bt,ri=Y;var Gn=kr,Oi=qr.pd[_e(an)&Ao-1];e(qr.jc),256>Oi.g?(Re(an,an.u+Oi.g),ri[Gn]=Oi.value,an=0):(Re(an,an.u+Oi.g-256),e(256<=Oi.value),an=Oi.value),an==0&&(fn=!0)}else an=Mt(qr.G[0],qr.H[0],bt);if(bt.h)break;if(fn||256>an){if(!fn)if(qr.nd)Y[kr]=(qr.qb|an<<8)>>>0;else{if(He(bt),fn=Mt(qr.G[1],qr.H[1],bt),He(bt),ri=Mt(qr.G[2],qr.H[2],bt),Gn=Mt(qr.G[3],qr.H[3],bt),bt.h)break;Y[kr]=(Gn<<24|fn<<16|an<<8|ri)>>>0}if(fn=!1,++kr,++ct>=Te&&(ct=0,++it,et!=null&&it<=Je&&!(it%16)&&et(V,it),Cr!=null))for(;wt<kr;)an=Y[wt++],Cr.X[(506832829*an&4294967295)>>>Cr.Mb]=an}else if(280>an){if(an=Ue(an-256,bt),ri=Mt(qr.G[4],qr.H[4],bt),He(bt),ri=ft(Te,ri=Ue(ri,bt)),bt.h)break;if(kr-fe<ri||We-kr<an)break e;for(Gn=0;Gn<an;++Gn)Y[kr+Gn]=Y[kr+Gn-ri];for(kr+=an,ct+=an;ct>=Te;)ct-=Te,++it,et!=null&&it<=Je&&!(it%16)&&et(V,it);if(e(kr<=We),ct&wr&&(qr=Kr(xt,ct,it)),Cr!=null)for(;wt<kr;)an=Y[wt++],Cr.X[(506832829*an&4294967295)>>>Cr.Mb]=an}else{if(!(an<dr))break e;for(fn=an-280,e(Cr!=null);wt<kr;)an=Y[wt++],Cr.X[(506832829*an&4294967295)>>>Cr.Mb]=an;an=kr,e(!(fn>>>(ri=Cr).Xa)),Y[an]=ri.X[fn],fn=!0}fn||e(bt.h==Me(bt))}if(V.Pb&&bt.h&&kr<We)e(V.m.h),V.a=5,V.m=V.wd,V.$=V.xd,0<V.s.ua&&nr(V.s.vb,V.s.Wa);else{if(bt.h)break e;et?.(V,it>Je?Je:it),V.a=0,V.$=kr-fe}return 1}return V.a=3,0}function _n(V){e(V!=null),V.vc=null,V.yc=null,V.Ya=null;var Y=V.Wa;Y!=null&&(Y.X=null),V.vb=null,e(V!=null)}function Fn(){var V=new $i;return V==null?null:(V.a=0,V.xb=Dc,Rt("Predictor","VP8LPredictors"),Rt("Predictor","VP8LPredictors_C"),Rt("PredictorAdd","VP8LPredictorsAdd"),Rt("PredictorAdd","VP8LPredictorsAdd_C"),ou=or,ur=er,mn=Tt,Tn=Oe,yi=Be,Rn=Ne,A=rt,G.VP8LMapColor32b=nl,G.VP8LMapColor8b=Au,V)}function na(V,Y,fe,Te,We){var Je=1,et=[V],it=[Y],ct=Te.m,bt=Te.s,xt=null,kr=0;e:for(;;){if(fe)for(;Je&&Ae(ct,1);){var wt=et,ir=it,dr=Te,Ur=1,Cr=dr.m,wr=dr.gc[dr.ab],qr=Ae(Cr,2);if(dr.Oc&1<<qr)Je=0;else{switch(dr.Oc|=1<<qr,wr.hc=qr,wr.Ea=wt[0],wr.nc=ir[0],wr.K=[null],++dr.ab,e(4>=dr.ab),qr){case 0:case 1:wr.b=Ae(Cr,3)+2,Ur=na(mt(wr.Ea,wr.b),mt(wr.nc,wr.b),0,dr,wr.K),wr.K=wr.K[0];break;case 3:var fn,an=Ae(Cr,8)+1,ri=16<an?0:4<an?1:2<an?2:3;if(wt[0]=mt(wr.Ea,ri),wr.b=ri,fn=Ur=na(an,1,0,dr,wr.K)){var Gn,Oi=an,Yn=wr,Zi=1<<(8>>Yn.b),Jo=a(Zi);if(Jo==null)fn=0;else{var Pi=Yn.K[0],Jn=Yn.w;for(Jo[0]=Yn.K[0][0],Gn=1;Gn<1*Oi;++Gn)Jo[Gn]=br(Pi[Jn+Gn],Jo[Gn-1]);for(;Gn<4*Zi;++Gn)Jo[Gn]=0;Yn.K[0]=null,Yn.K[0]=Jo,fn=1}}Ur=fn;break;case 2:break;default:e(0)}Je=Ur}}if(et=et[0],it=it[0],Je&&Ae(ct,1)&&!(Je=1<=(kr=Ae(ct,4))&&11>=kr)){Te.a=3;break e}var Cn;if(Cn=Je)t:{var Pa,qn,Wi,ka=Te,hs=et,ol=it,Po=kr,sl=fe,po=ka.m,Oo=ka.s,sn=[null],Sn=1,eo=0,ga=xf[Po];r:for(;;){if(sl&&Ae(po,1)){var Uo=Ae(po,3)+2,to=mt(hs,Uo),No=mt(ol,Uo),Sa=to*No;if(!na(to,No,0,ka,sn))break r;for(sn=sn[0],Oo.xc=Uo,Pa=0;Pa<Sa;++Pa){var Ma=sn[Pa]>>8&65535;sn[Pa]=Ma,Ma>=Sn&&(Sn=Ma+1)}}if(po.h)break r;for(qn=0;5>qn;++qn){var ro=bf[qn];!qn&&0<Po&&(ro+=1<<Po),eo<ro&&(eo=ro)}var ia=s(Sn*ga,ne),Ki=Sn,Gl=s(Ki,ue);if(Gl==null)var Qo=null;else e(65536>=Ki),Qo=Gl;var Vo=a(eo);if(Qo==null||Vo==null||ia==null){ka.a=1;break r}var Cl=ia;for(Pa=Wi=0;Pa<Sn;++Pa){var Ea=Qo[Pa],fs=Ea.G,Al=Ea.H,Bc=0,Mu=1,ds=0;for(qn=0;5>qn;++qn){ro=bf[qn],fs[qn]=Cl,Al[qn]=Wi,!qn&&0<Po&&(ro+=1<<Po);i:{var R,l=ro,p=ka,w=Vo,T=Cl,O=Wi,j=0,X=p.m,te=Ae(X,1);if(i(w,0,0,l),te){var le=Ae(X,1)+1,ge=Ae(X,1),Se=Ae(X,ge==0?1:8);w[Se]=1,le==2&&(w[Se=Ae(X,8)]=1);var be=1}else{var Le=a(19),Ge=Ae(X,4)+4;if(19<Ge){p.a=3;var lt=0;break i}for(R=0;R<Ge;++R)Le[gg[R]]=Ae(X,3);var st=void 0,ut=void 0,_t=p,Dt=Le,kt=l,zt=w,$t=0,It=_t.m,Kt=8,Er=s(128,ne);n:for(;H(Er,0,7,Dt,19);){if(Ae(It,1)){var vr=2+2*Ae(It,3);if((st=2+Ae(It,vr))>kt)break n}else st=kt;for(ut=0;ut<kt&&st--;){He(It);var _r=Er[0+(127&_e(It))];Re(It,It.u+_r.g);var Ar=_r.value;if(16>Ar)zt[ut++]=Ar,Ar!=0&&(Kt=Ar);else{var gn=Ar==16,dn=Ar-16,Yr=lp[dn],Nn=Ae(It,sp[dn])+Yr;if(ut+Nn>kt)break n;for(var Mi=gn?Kt:0;0<Nn--;)zt[ut++]=Mi}}$t=1;break n}$t||(_t.a=3),be=$t}(be=be&&!X.h)&&(j=H(T,O,8,w,l)),be&&j!=0?lt=j:(p.a=3,lt=0)}if(lt==0)break r;if(Mu&&up[qn]==1&&(Mu=Cl[Wi].g==0),Bc+=Cl[Wi].g,Wi+=lt,3>=qn){var Ji,Ha=Vo[0];for(Ji=1;Ji<ro;++Ji)Vo[Ji]>Ha&&(Ha=Vo[Ji]);ds+=Ha}}if(Ea.nd=Mu,Ea.Qb=0,Mu&&(Ea.qb=(fs[3][Al[3]+0].value<<24|fs[1][Al[1]+0].value<<16|fs[2][Al[2]+0].value)>>>0,Bc==0&&256>fs[0][Al[0]+0].value&&(Ea.Qb=1,Ea.qb+=fs[0][Al[0]+0].value<<8)),Ea.jc=!Ea.Qb&&6>ds,Ea.jc){var fa,da=Ea;for(fa=0;fa<Ao;++fa){var oa=fa,aa=da.pd[oa],ma=da.G[0][da.H[0]+oa];256<=ma.value?(aa.g=ma.g+256,aa.value=ma.value):(aa.g=0,aa.value=0,oa>>=xr(ma,8,aa),oa>>=xr(da.G[1][da.H[1]+oa],16,aa),oa>>=xr(da.G[2][da.H[2]+oa],0,aa),xr(da.G[3][da.H[3]+oa],24,aa))}}}Oo.vc=sn,Oo.Wb=Sn,Oo.Ya=Qo,Oo.yc=ia,Cn=1;break t}Cn=0}if(!(Je=Cn)){Te.a=3;break e}if(0<kr){if(bt.ua=1<<kr,!Ve(bt.Wa,kr)){Te.a=1,Je=0;break e}}else bt.ua=0;var ps=Te,Gi=et,Is=it,gs=ps.s,yc=gs.xc;if(ps.c=Gi,ps.i=Is,gs.md=mt(Gi,yc),gs.wc=yc==0?-1:(1<<yc)-1,fe){Te.xb=Io;break e}if((xt=a(et*it))==null){Te.a=1,Je=0;break e}Je=(Je=Xr(Te,xt,0,et,it,it,null))&&!ct.h;break e}return Je?(We!=null?We[0]=xt:(e(xt==null),e(fe)),Te.$=0,fe||_n(bt)):_n(bt),Je}function Ca(V,Y){var fe=V.c*V.i,Te=fe+Y+16*Y;return e(V.c<=Y),V.V=a(Te),V.V==null?(V.Ta=null,V.Ua=0,V.a=1,0):(V.Ta=V.V,V.Ua=V.Ba+fe+Y,1)}function ua(V,Y){var fe=V.C,Te=Y-fe,We=V.V,Je=V.Ba+V.c*fe;for(e(Y<=V.l.o);0<Te;){var et=16<Te?16:Te,it=V.l.ma,ct=V.l.width,bt=ct*et,xt=it.ca,kr=it.tb+ct*fe,wt=V.Ta,ir=V.Ua;Rr(V,et,We,Je),Zo(wt,ir,xt,kr,bt),bi(it,fe,fe+et,xt,kr,ct),Te-=et,We+=et*V.c,fe+=et}e(fe==Y),V.C=V.Ma=Y}function Mn(){this.ub=this.yd=this.td=this.Rb=0}function oo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function _a(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Hi(){this.Yb=(function(){var V=[];return(function Y(fe,Te,We){for(var Je=We[Te],et=0;et<Je&&(fe.push(We.length>Te+1?[]:0),!(We.length<Te+1));et++)Y(fe[et],Te+1,We)})(V,0,[3,11]),V})()}function Ya(){this.jb=a(3),this.Wc=o([4,8],Hi),this.Xc=o([4,17],Hi)}function Xs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function ki(){this.ld=this.La=this.dd=this.tc=0}function bl(){this.Na=this.la=0}function zo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function xi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function So(){this.uc=this.M=this.Nb=0,this.wa=Array(new ki),this.Y=0,this.ya=Array(new xi),this.aa=0,this.l=new so}function Fs(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Mo(){this.cb=this.a=0,this.sc="",this.m=new ce,this.Od=new Mn,this.Kc=new oo,this.ed=new Xs,this.Qa=new _a,this.Ic=this.$c=this.Aa=0,this.D=new So,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,ce),this.ia=0,this.pb=s(4,zo),this.Pa=new Ya,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fs),this.Hd=0,this.rb=Array(new bl),this.sb=0,this.wa=Array(new ki),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new xi),this.L=this.aa=0,this.gd=o([4,2],ki),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function so(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function xl(){var V=new Mo;return V!=null&&(V.a=0,V.sc="OK",V.cb=0,V.Xb=0,Iu||(Iu=Yo)),V}function Za(V,Y,fe){return V.a==0&&(V.a=Y,V.sc=fe,V.cb=0),0}function Lc(V,Y,fe){return 3<=fe&&V[Y+0]==157&&V[Y+1]==1&&V[Y+2]==42}function cc(V,Y){if(V==null)return 0;if(V.a=0,V.sc="OK",Y==null)return Za(V,2,"null VP8Io passed to VP8GetHeaders()");var fe=Y.data,Te=Y.w,We=Y.ha;if(4>We)return Za(V,7,"Truncated header.");var Je=fe[Te+0]|fe[Te+1]<<8|fe[Te+2]<<16,et=V.Od;if(et.Rb=!(1&Je),et.td=Je>>1&7,et.yd=Je>>4&1,et.ub=Je>>5,3<et.td)return Za(V,3,"Incorrect keyframe parameters.");if(!et.yd)return Za(V,4,"Frame not displayable.");Te+=3,We-=3;var it=V.Kc;if(et.Rb){if(7>We)return Za(V,7,"cannot parse picture header");if(!Lc(fe,Te,We))return Za(V,3,"Bad code word");it.c=16383&(fe[Te+4]<<8|fe[Te+3]),it.Td=fe[Te+4]>>6,it.i=16383&(fe[Te+6]<<8|fe[Te+5]),it.Ud=fe[Te+6]>>6,Te+=7,We-=7,V.za=it.c+15>>4,V.Ub=it.i+15>>4,Y.width=it.c,Y.height=it.i,Y.Da=0,Y.j=0,Y.v=0,Y.va=Y.width,Y.o=Y.height,Y.da=0,Y.ib=Y.width,Y.hb=Y.height,Y.U=Y.width,Y.T=Y.height,i((Je=V.Pa).jb,0,255,Je.jb.length),e((Je=V.Qa)!=null),Je.Cb=0,Je.Bb=0,Je.Fb=1,i(Je.Zb,0,0,Je.Zb.length),i(Je.Lb,0,0,Je.Lb)}if(et.ub>We)return Za(V,7,"bad partition length");de(Je=V.m,fe,Te,et.ub),Te+=et.ub,We-=et.ub,et.Rb&&(it.Ld=tt(Je),it.Kd=tt(Je)),it=V.Qa;var ct,bt=V.Pa;if(e(Je!=null),e(it!=null),it.Cb=tt(Je),it.Cb){if(it.Bb=tt(Je),tt(Je)){for(it.Fb=tt(Je),ct=0;4>ct;++ct)it.Zb[ct]=tt(Je)?me(Je,7):0;for(ct=0;4>ct;++ct)it.Lb[ct]=tt(Je)?me(Je,6):0}if(it.Bb)for(ct=0;3>ct;++ct)bt.jb[ct]=tt(Je)?Pe(Je,8):255}else it.Bb=0;if(Je.Ka)return Za(V,3,"cannot parse segment header");if((it=V.ed).zd=tt(Je),it.Tb=Pe(Je,6),it.wb=Pe(Je,3),it.Pc=tt(Je),it.Pc&&tt(Je)){for(bt=0;4>bt;++bt)tt(Je)&&(it.vd[bt]=me(Je,6));for(bt=0;4>bt;++bt)tt(Je)&&(it.od[bt]=me(Je,6))}if(V.L=it.Tb==0?0:it.zd?1:2,Je.Ka)return Za(V,3,"cannot parse filter header");var xt=We;if(We=ct=Te,Te=ct+xt,it=xt,V.Xb=(1<<Pe(V.m,2))-1,xt<3*(bt=V.Xb))fe=7;else{for(ct+=3*bt,it-=3*bt,xt=0;xt<bt;++xt){var kr=fe[We+0]|fe[We+1]<<8|fe[We+2]<<16;kr>it&&(kr=it),de(V.Jc[+xt],fe,ct,kr),ct+=kr,it-=kr,We+=3}de(V.Jc[+bt],fe,ct,it),fe=ct<Te?0:5}if(fe!=0)return Za(V,fe,"cannot parse partitions");for(fe=Pe(ct=V.m,7),We=tt(ct)?me(ct,4):0,Te=tt(ct)?me(ct,4):0,it=tt(ct)?me(ct,4):0,bt=tt(ct)?me(ct,4):0,ct=tt(ct)?me(ct,4):0,xt=V.Qa,kr=0;4>kr;++kr){if(xt.Cb){var wt=xt.Zb[kr];xt.Fb||(wt+=fe)}else{if(0<kr){V.pb[kr]=V.pb[0];continue}wt=fe}var ir=V.pb[kr];ir.Sc[0]=Bh[Qa(wt+We,127)],ir.Sc[1]=pd[Qa(wt+0,127)],ir.Eb[0]=2*Bh[Qa(wt+Te,127)],ir.Eb[1]=101581*pd[Qa(wt+it,127)]>>16,8>ir.Eb[1]&&(ir.Eb[1]=8),ir.Qc[0]=Bh[Qa(wt+bt,117)],ir.Qc[1]=pd[Qa(wt+ct,127)],ir.lc=wt+ct}if(!et.Rb)return Za(V,4,"Not a key frame.");for(tt(Je),et=V.Pa,fe=0;4>fe;++fe){for(We=0;8>We;++We)for(Te=0;3>Te;++Te)for(it=0;11>it;++it)bt=Ze(Je,ny[fe][We][Te][it])?Pe(Je,8):mg[fe][We][Te][it],et.Wc[fe][We].Yb[Te][it]=bt;for(We=0;17>We;++We)et.Xc[fe][We]=et.Wc[fe][md[We]]}return V.kc=tt(Je),V.kc&&(V.Bd=Pe(Je,8)),V.cb=1}function Yo(V,Y,fe,Te,We,Je,et){var it=Y[We].Yb[fe];for(fe=0;16>We;++We){if(!Ze(V,it[fe+0]))return We;for(;!Ze(V,it[fe+1]);)if(it=Y[++We].Yb[0],fe=0,We==16)return 16;var ct=Y[We+1].Yb;if(Ze(V,it[fe+2])){var bt=V,xt=0;if(Ze(bt,(wt=it)[(kr=fe)+3]))if(Ze(bt,wt[kr+6])){for(it=0,kr=2*(xt=Ze(bt,wt[kr+8]))+(wt=Ze(bt,wt[kr+9+xt])),xt=0,wt=W0[kr];wt[it];++it)xt+=xt+Ze(bt,wt[it]);xt+=3+(8<<kr)}else Ze(bt,wt[kr+7])?(xt=7+2*Ze(bt,165),xt+=Ze(bt,145)):xt=5+Ze(bt,159);else xt=Ze(bt,wt[kr+4])?3+Ze(bt,wt[kr+5]):2;it=ct[2]}else xt=1,it=ct[1];ct=et+ty[We],0>(bt=V).b&&Fe(bt);var kr,wt=bt.b,ir=(kr=bt.Ca>>1)-(bt.I>>wt)>>31;--bt.b,bt.Ca+=ir,bt.Ca|=1,bt.I-=(kr+1&ir)<<wt,Je[ct]=((xt^ir)-ir)*Te[(0<We)+0]}return 16}function Bs(V){var Y=V.rb[V.sb-1];Y.la=0,Y.Na=0,i(V.zc,0,0,V.zc.length),V.ja=0}function Ka(V,Y,fe,Te,We){We=V[Y+fe+32*Te]+(We>>3),V[Y+fe+32*Te]=-256&We?0>We?0:255:We}function Eo(V,Y,fe,Te,We,Je){Ka(V,Y,0,fe,Te+We),Ka(V,Y,1,fe,Te+Je),Ka(V,Y,2,fe,Te-Je),Ka(V,Y,3,fe,Te-We)}function Va(V){return(20091*V>>16)+V}function wl(V,Y,fe,Te){var We,Je=0,et=a(16);for(We=0;4>We;++We){var it=V[Y+0]+V[Y+8],ct=V[Y+0]-V[Y+8],bt=(35468*V[Y+4]>>16)-Va(V[Y+12]),xt=Va(V[Y+4])+(35468*V[Y+12]>>16);et[Je+0]=it+xt,et[Je+1]=ct+bt,et[Je+2]=ct-bt,et[Je+3]=it-xt,Je+=4,Y++}for(We=Je=0;4>We;++We)it=(V=et[Je+0]+4)+et[Je+8],ct=V-et[Je+8],bt=(35468*et[Je+4]>>16)-Va(et[Je+12]),Ka(fe,Te,0,0,it+(xt=Va(et[Je+4])+(35468*et[Je+12]>>16))),Ka(fe,Te,1,0,ct+bt),Ka(fe,Te,2,0,ct-bt),Ka(fe,Te,3,0,it-xt),Je++,Te+=32}function xu(V,Y,fe,Te){var We=V[Y+0]+4,Je=35468*V[Y+4]>>16,et=Va(V[Y+4]),it=35468*V[Y+1]>>16;Eo(fe,Te,0,We+et,V=Va(V[Y+1]),it),Eo(fe,Te,1,We+Je,V,it),Eo(fe,Te,2,We-Je,V,it),Eo(fe,Te,3,We-et,V,it)}function wu(V,Y,fe,Te,We){wl(V,Y,fe,Te),We&&wl(V,Y+16,fe,Te+4)}function K(V,Y,fe,Te){_(V,Y+0,fe,Te,1),_(V,Y+32,fe,Te+128,1)}function pe(V,Y,fe,Te){var We;for(V=V[Y+0]+4,We=0;4>We;++We)for(Y=0;4>Y;++Y)Ka(fe,Te,Y,We,V)}function Ye(V,Y,fe,Te){V[Y+0]&&re(V,Y+0,fe,Te),V[Y+16]&&re(V,Y+16,fe,Te+4),V[Y+32]&&re(V,Y+32,fe,Te+128),V[Y+48]&&re(V,Y+48,fe,Te+128+4)}function Et(V,Y,fe,Te){var We,Je=a(16);for(We=0;4>We;++We){var et=V[Y+0+We]+V[Y+12+We],it=V[Y+4+We]+V[Y+8+We],ct=V[Y+4+We]-V[Y+8+We],bt=V[Y+0+We]-V[Y+12+We];Je[0+We]=et+it,Je[8+We]=et-it,Je[4+We]=bt+ct,Je[12+We]=bt-ct}for(We=0;4>We;++We)et=(V=Je[0+4*We]+3)+Je[3+4*We],it=Je[1+4*We]+Je[2+4*We],ct=Je[1+4*We]-Je[2+4*We],bt=V-Je[3+4*We],fe[Te+0]=et+it>>3,fe[Te+16]=bt+ct>>3,fe[Te+32]=et-it>>3,fe[Te+48]=bt-ct>>3,Te+=64}function Ut(V,Y,fe){var Te,We=Y-32,Je=qa,et=255-V[We-1];for(Te=0;Te<fe;++Te){var it,ct=Je,bt=et+V[Y-1];for(it=0;it<fe;++it)V[Y+it]=ct[bt+V[We+it]];Y+=32}}function Nt(V,Y){Ut(V,Y,4)}function Qt(V,Y){Ut(V,Y,8)}function Gr(V,Y){Ut(V,Y,16)}function on(V,Y){var fe;for(fe=0;16>fe;++fe)n(V,Y+32*fe,V,Y-32,16)}function en(V,Y){var fe;for(fe=16;0<fe;--fe)i(V,Y,V[Y-1],16),Y+=32}function hn(V,Y,fe){var Te;for(Te=0;16>Te;++Te)i(Y,fe+32*Te,V,16)}function nn(V,Y){var fe,Te=16;for(fe=0;16>fe;++fe)Te+=V[Y-1+32*fe]+V[Y+fe-32];hn(Te>>5,V,Y)}function Xn(V,Y){var fe,Te=8;for(fe=0;16>fe;++fe)Te+=V[Y-1+32*fe];hn(Te>>4,V,Y)}function En(V,Y){var fe,Te=8;for(fe=0;16>fe;++fe)Te+=V[Y+fe-32];hn(Te>>4,V,Y)}function $n(V,Y){hn(128,V,Y)}function Ln(V,Y,fe){return V+2*Y+fe+2>>2}function $r(V,Y){var fe,Te=Y-32;for(Te=new Uint8Array([Ln(V[Te-1],V[Te+0],V[Te+1]),Ln(V[Te+0],V[Te+1],V[Te+2]),Ln(V[Te+1],V[Te+2],V[Te+3]),Ln(V[Te+2],V[Te+3],V[Te+4])]),fe=0;4>fe;++fe)n(V,Y+32*fe,Te,0,Te.length)}function xn(V,Y){var fe=V[Y-1],Te=V[Y-1+32],We=V[Y-1+64],Je=V[Y-1+96];Qe(V,Y+0,16843009*Ln(V[Y-1-32],fe,Te)),Qe(V,Y+32,16843009*Ln(fe,Te,We)),Qe(V,Y+64,16843009*Ln(Te,We,Je)),Qe(V,Y+96,16843009*Ln(We,Je,Je))}function si(V,Y){var fe,Te=4;for(fe=0;4>fe;++fe)Te+=V[Y+fe-32]+V[Y-1+32*fe];for(Te>>=3,fe=0;4>fe;++fe)i(V,Y+32*fe,Te,4)}function Li(V,Y){var fe=V[Y-1+0],Te=V[Y-1+32],We=V[Y-1+64],Je=V[Y-1-32],et=V[Y+0-32],it=V[Y+1-32],ct=V[Y+2-32],bt=V[Y+3-32];V[Y+0+96]=Ln(Te,We,V[Y-1+96]),V[Y+1+96]=V[Y+0+64]=Ln(fe,Te,We),V[Y+2+96]=V[Y+1+64]=V[Y+0+32]=Ln(Je,fe,Te),V[Y+3+96]=V[Y+2+64]=V[Y+1+32]=V[Y+0+0]=Ln(et,Je,fe),V[Y+3+64]=V[Y+2+32]=V[Y+1+0]=Ln(it,et,Je),V[Y+3+32]=V[Y+2+0]=Ln(ct,it,et),V[Y+3+0]=Ln(bt,ct,it)}function wi(V,Y){var fe=V[Y+1-32],Te=V[Y+2-32],We=V[Y+3-32],Je=V[Y+4-32],et=V[Y+5-32],it=V[Y+6-32],ct=V[Y+7-32];V[Y+0+0]=Ln(V[Y+0-32],fe,Te),V[Y+1+0]=V[Y+0+32]=Ln(fe,Te,We),V[Y+2+0]=V[Y+1+32]=V[Y+0+64]=Ln(Te,We,Je),V[Y+3+0]=V[Y+2+32]=V[Y+1+64]=V[Y+0+96]=Ln(We,Je,et),V[Y+3+32]=V[Y+2+64]=V[Y+1+96]=Ln(Je,et,it),V[Y+3+64]=V[Y+2+96]=Ln(et,it,ct),V[Y+3+96]=Ln(it,ct,ct)}function Vi(V,Y){var fe=V[Y-1+0],Te=V[Y-1+32],We=V[Y-1+64],Je=V[Y-1-32],et=V[Y+0-32],it=V[Y+1-32],ct=V[Y+2-32],bt=V[Y+3-32];V[Y+0+0]=V[Y+1+64]=Je+et+1>>1,V[Y+1+0]=V[Y+2+64]=et+it+1>>1,V[Y+2+0]=V[Y+3+64]=it+ct+1>>1,V[Y+3+0]=ct+bt+1>>1,V[Y+0+96]=Ln(We,Te,fe),V[Y+0+64]=Ln(Te,fe,Je),V[Y+0+32]=V[Y+1+96]=Ln(fe,Je,et),V[Y+1+32]=V[Y+2+96]=Ln(Je,et,it),V[Y+2+32]=V[Y+3+96]=Ln(et,it,ct),V[Y+3+32]=Ln(it,ct,bt)}function Bi(V,Y){var fe=V[Y+0-32],Te=V[Y+1-32],We=V[Y+2-32],Je=V[Y+3-32],et=V[Y+4-32],it=V[Y+5-32],ct=V[Y+6-32],bt=V[Y+7-32];V[Y+0+0]=fe+Te+1>>1,V[Y+1+0]=V[Y+0+64]=Te+We+1>>1,V[Y+2+0]=V[Y+1+64]=We+Je+1>>1,V[Y+3+0]=V[Y+2+64]=Je+et+1>>1,V[Y+0+32]=Ln(fe,Te,We),V[Y+1+32]=V[Y+0+96]=Ln(Te,We,Je),V[Y+2+32]=V[Y+1+96]=Ln(We,Je,et),V[Y+3+32]=V[Y+2+96]=Ln(Je,et,it),V[Y+3+64]=Ln(et,it,ct),V[Y+3+96]=Ln(it,ct,bt)}function Pn(V,Y){var fe=V[Y-1+0],Te=V[Y-1+32],We=V[Y-1+64],Je=V[Y-1+96];V[Y+0+0]=fe+Te+1>>1,V[Y+2+0]=V[Y+0+32]=Te+We+1>>1,V[Y+2+32]=V[Y+0+64]=We+Je+1>>1,V[Y+1+0]=Ln(fe,Te,We),V[Y+3+0]=V[Y+1+32]=Ln(Te,We,Je),V[Y+3+32]=V[Y+1+64]=Ln(We,Je,Je),V[Y+3+64]=V[Y+2+64]=V[Y+0+96]=V[Y+1+96]=V[Y+2+96]=V[Y+3+96]=Je}function $a(V,Y){var fe=V[Y-1+0],Te=V[Y-1+32],We=V[Y-1+64],Je=V[Y-1+96],et=V[Y-1-32],it=V[Y+0-32],ct=V[Y+1-32],bt=V[Y+2-32];V[Y+0+0]=V[Y+2+32]=fe+et+1>>1,V[Y+0+32]=V[Y+2+64]=Te+fe+1>>1,V[Y+0+64]=V[Y+2+96]=We+Te+1>>1,V[Y+0+96]=Je+We+1>>1,V[Y+3+0]=Ln(it,ct,bt),V[Y+2+0]=Ln(et,it,ct),V[Y+1+0]=V[Y+3+32]=Ln(fe,et,it),V[Y+1+32]=V[Y+3+64]=Ln(Te,fe,et),V[Y+1+64]=V[Y+3+96]=Ln(We,Te,fe),V[Y+1+96]=Ln(Je,We,Te)}function ii(V,Y){var fe;for(fe=0;8>fe;++fe)n(V,Y+32*fe,V,Y-32,8)}function Wn(V,Y){var fe;for(fe=0;8>fe;++fe)i(V,Y,V[Y-1],8),Y+=32}function ws(V,Y,fe){var Te;for(Te=0;8>Te;++Te)i(Y,fe+32*Te,V,8)}function In(V,Y){var fe,Te=8;for(fe=0;8>fe;++fe)Te+=V[Y+fe-32]+V[Y-1+32*fe];ws(Te>>4,V,Y)}function Sl(V,Y){var fe,Te=4;for(fe=0;8>fe;++fe)Te+=V[Y+fe-32];ws(Te>>3,V,Y)}function Na(V,Y){var fe,Te=4;for(fe=0;8>fe;++fe)Te+=V[Y-1+32*fe];ws(Te>>3,V,Y)}function Ys(V,Y){ws(128,V,Y)}function lo(V,Y,fe){var Te=V[Y-fe],We=V[Y+0],Je=3*(We-Te)+dc[1020+V[Y-2*fe]-V[Y+fe]],et=As[112+(Je+4>>3)];V[Y-fe]=qa[255+Te+As[112+(Je+3>>3)]],V[Y+0]=qa[255+We-et]}function iu(V,Y,fe,Te){var We=V[Y+0],Je=V[Y+fe];return us[255+V[Y-2*fe]-V[Y-fe]]>Te||us[255+Je-We]>Te}function os(V,Y,fe,Te){return 4*us[255+V[Y-fe]-V[Y+0]]+us[255+V[Y-2*fe]-V[Y+fe]]<=Te}function ss(V,Y,fe,Te,We){var Je=V[Y-3*fe],et=V[Y-2*fe],it=V[Y-fe],ct=V[Y+0],bt=V[Y+fe],xt=V[Y+2*fe],kr=V[Y+3*fe];return 4*us[255+it-ct]+us[255+et-bt]>Te?0:us[255+V[Y-4*fe]-Je]<=We&&us[255+Je-et]<=We&&us[255+et-it]<=We&&us[255+kr-xt]<=We&&us[255+xt-bt]<=We&&us[255+bt-ct]<=We}function zl(V,Y,fe,Te){var We=2*Te+1;for(Te=0;16>Te;++Te)os(V,Y+Te,fe,We)&&lo(V,Y+Te,fe)}function Zs(V,Y,fe,Te){var We=2*Te+1;for(Te=0;16>Te;++Te)os(V,Y+Te*fe,1,We)&&lo(V,Y+Te*fe,1)}function Ja(V,Y,fe,Te){var We;for(We=3;0<We;--We)zl(V,Y+=4*fe,fe,Te)}function uo(V,Y,fe,Te){var We;for(We=3;0<We;--We)Zs(V,Y+=4,fe,Te)}function sa(V,Y,fe,Te,We,Je,et,it){for(Je=2*Je+1;0<We--;){if(ss(V,Y,fe,Je,et))if(iu(V,Y,fe,it))lo(V,Y,fe);else{var ct=V,bt=Y,xt=fe,kr=ct[bt-2*xt],wt=ct[bt-xt],ir=ct[bt+0],dr=ct[bt+xt],Ur=ct[bt+2*xt],Cr=27*(qr=dc[1020+3*(ir-wt)+dc[1020+kr-dr]])+63>>7,wr=18*qr+63>>7,qr=9*qr+63>>7;ct[bt-3*xt]=qa[255+ct[bt-3*xt]+qr],ct[bt-2*xt]=qa[255+kr+wr],ct[bt-xt]=qa[255+wt+Cr],ct[bt+0]=qa[255+ir-Cr],ct[bt+xt]=qa[255+dr-wr],ct[bt+2*xt]=qa[255+Ur-qr]}Y+=Te}}function La(V,Y,fe,Te,We,Je,et,it){for(Je=2*Je+1;0<We--;){if(ss(V,Y,fe,Je,et))if(iu(V,Y,fe,it))lo(V,Y,fe);else{var ct=V,bt=Y,xt=fe,kr=ct[bt-xt],wt=ct[bt+0],ir=ct[bt+xt],dr=As[112+(4+(Ur=3*(wt-kr))>>3)],Ur=As[112+(Ur+3>>3)],Cr=dr+1>>1;ct[bt-2*xt]=qa[255+ct[bt-2*xt]+Cr],ct[bt-xt]=qa[255+kr+Ur],ct[bt+0]=qa[255+wt-dr],ct[bt+xt]=qa[255+ir-Cr]}Y+=Te}}function se(V,Y,fe,Te,We,Je){sa(V,Y,fe,1,16,Te,We,Je)}function qe(V,Y,fe,Te,We,Je){sa(V,Y,1,fe,16,Te,We,Je)}function dt(V,Y,fe,Te,We,Je){var et;for(et=3;0<et;--et)La(V,Y+=4*fe,fe,1,16,Te,We,Je)}function Vt(V,Y,fe,Te,We,Je){var et;for(et=3;0<et;--et)La(V,Y+=4,1,fe,16,Te,We,Je)}function sr(V,Y,fe,Te,We,Je,et,it){sa(V,Y,We,1,8,Je,et,it),sa(fe,Te,We,1,8,Je,et,it)}function Vr(V,Y,fe,Te,We,Je,et,it){sa(V,Y,1,We,8,Je,et,it),sa(fe,Te,1,We,8,Je,et,it)}function rn(V,Y,fe,Te,We,Je,et,it){La(V,Y+4*We,We,1,8,Je,et,it),La(fe,Te+4*We,We,1,8,Je,et,it)}function kn(V,Y,fe,Te,We,Je,et,it){La(V,Y+4,1,We,8,Je,et,it),La(fe,Te+4,1,We,8,Je,et,it)}function Vn(){this.ba=new jt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Xt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ci(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ti(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function li(){this.ua=0,this.Wa=new Yt,this.vb=new Yt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new ne}function $i(){this.xb=this.a=0,this.l=new so,this.ca=new jt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new xe,this.Pb=0,this.wd=new xe,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new li,this.ab=0,this.gc=s(4,Ti),this.Oc=0}function Si(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new so,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ii(V,Y,fe,Te,We,Je,et){for(V=V==null?0:V[Y+0],Y=0;Y<et;++Y)We[Je+Y]=V+fe[Te+Y]&255,V=We[Je+Y]}function Aa(V,Y,fe,Te,We,Je,et){var it;if(V==null)Ii(null,null,fe,Te,We,Je,et);else for(it=0;it<et;++it)We[Je+it]=V[Y+it]+fe[Te+it]&255}function ca(V,Y,fe,Te,We,Je,et){if(V==null)Ii(null,null,fe,Te,We,Je,et);else{var it,ct=V[Y+0],bt=ct,xt=ct;for(it=0;it<et;++it)bt=xt+(ct=V[Y+it])-bt,xt=fe[Te+it]+(-256&bt?0>bt?0:255:bt)&255,bt=ct,We[Je+it]=xt}}function ba(V,Y,fe,Te){var We=Y.width,Je=Y.o;if(e(V!=null&&Y!=null),0>fe||0>=Te||fe+Te>Je)return null;if(!V.Cc){if(V.ga==null){var et;if(V.ga=new Si,(et=V.ga==null)||(et=Y.width*Y.o,e(V.Gb.length==0),V.Gb=a(et),V.Uc=0,V.Gb==null?et=0:(V.mb=V.Gb,V.nb=V.Uc,V.rc=null,et=1),et=!et),!et){et=V.ga;var it=V.Fa,ct=V.P,bt=V.qc,xt=V.mb,kr=V.nb,wt=ct+1,ir=bt-1,dr=et.l;if(e(it!=null&&xt!=null&&Y!=null),cs[0]=null,cs[1]=Ii,cs[2]=Aa,cs[3]=ca,et.ca=xt,et.tb=kr,et.c=Y.width,et.i=Y.height,e(0<et.c&&0<et.i),1>=bt)Y=0;else if(et.$a=3&it[ct+0],et.Z=it[ct+0]>>2&3,et.Lc=it[ct+0]>>4&3,ct=it[ct+0]>>6&3,0>et.$a||1<et.$a||4<=et.Z||1<et.Lc||ct)Y=0;else if(dr.put=jr,dr.ac=Zr,dr.bc=vn,dr.ma=et,dr.width=Y.width,dr.height=Y.height,dr.Da=Y.Da,dr.v=Y.v,dr.va=Y.va,dr.j=Y.j,dr.o=Y.o,et.$a)e:{e(et.$a==1),Y=Fn();t:for(;;){if(Y==null){Y=0;break e}if(e(et!=null),et.mc=Y,Y.c=et.c,Y.i=et.i,Y.l=et.l,Y.l.ma=et,Y.l.width=et.c,Y.l.height=et.i,Y.a=0,Ee(Y.m,it,wt,ir),!na(et.c,et.i,1,Y,null)||(Y.ab==1&&Y.gc[0].hc==3&&ti(Y.s)?(et.ic=1,it=Y.c*Y.i,Y.Ta=null,Y.Ua=0,Y.V=a(it),Y.Ba=0,Y.V==null?(Y.a=1,Y=0):Y=1):(et.ic=0,Y=Ca(Y,et.c)),!Y))break t;Y=1;break e}et.mc=null,Y=0}else Y=ir>=et.c*et.i;et=!Y}if(et)return null;V.ga.Lc!=1?V.Ga=0:Te=Je-fe}e(V.ga!=null),e(fe+Te<=Je);e:{if(Y=(it=V.ga).c,Je=it.l.o,it.$a==0){if(wt=V.rc,ir=V.Vc,dr=V.Fa,ct=V.P+1+fe*Y,bt=V.mb,xt=V.nb+fe*Y,e(ct<=V.P+V.qc),it.Z!=0)for(e(cs[it.Z]!=null),et=0;et<Te;++et)cs[it.Z](wt,ir,dr,ct,bt,xt,Y),wt=bt,ir=xt,xt+=Y,ct+=Y;else for(et=0;et<Te;++et)n(bt,xt,dr,ct,Y),wt=bt,ir=xt,xt+=Y,ct+=Y;V.rc=wt,V.Vc=ir}else{if(e(it.mc!=null),Y=fe+Te,e((et=it.mc)!=null),e(Y<=et.i),et.C>=Y)Y=1;else if(it.ic||Eu(),it.ic){it=et.V,wt=et.Ba,ir=et.c;var Ur=et.i,Cr=(dr=1,ct=et.$/ir,bt=et.$%ir,xt=et.m,kr=et.s,et.$),wr=ir*Ur,qr=ir*Y,fn=kr.wc,an=Cr<qr?Kr(kr,bt,ct):null;e(Cr<=wr),e(Y<=Ur),e(ti(kr));t:for(;;){for(;!xt.h&&Cr<qr;){if(bt&fn||(an=Kr(kr,bt,ct)),e(an!=null),He(xt),256>(Ur=Mt(an.G[0],an.H[0],xt)))it[wt+Cr]=Ur,++Cr,++bt>=ir&&(bt=0,++ct<=Y&&!(ct%16)&&Ui(et,ct));else{if(!(280>Ur)){dr=0;break t}Ur=Ue(Ur-256,xt);var ri,Gn=Mt(an.G[4],an.H[4],xt);if(He(xt),!(Cr>=(Gn=ft(ir,Gn=Ue(Gn,xt)))&&wr-Cr>=Ur)){dr=0;break t}for(ri=0;ri<Ur;++ri)it[wt+Cr+ri]=it[wt+Cr+ri-Gn];for(Cr+=Ur,bt+=Ur;bt>=ir;)bt-=ir,++ct<=Y&&!(ct%16)&&Ui(et,ct);Cr<qr&&bt&fn&&(an=Kr(kr,bt,ct))}e(xt.h==Me(xt))}Ui(et,ct>Y?Y:ct);break t}!dr||xt.h&&Cr<wr?(dr=0,et.a=xt.h?5:3):et.$=Cr,Y=dr}else Y=Xr(et,et.V,et.Ba,et.c,et.i,Y,ua);if(!Y){Te=0;break e}}fe+Te>=Je&&(V.Cc=1),Te=1}if(!Te)return null;if(V.Cc&&((Te=V.ga)!=null&&(Te.mc=null),V.ga=null,0<V.Ga))return alert("todo:WebPDequantizeLevels"),null}return V.nb+fe*We}function Ss(V,Y,fe,Te,We,Je){for(;0<We--;){var et,it=V,ct=Y+(fe?1:0),bt=V,xt=Y+(fe?0:3);for(et=0;et<Te;++et){var kr=bt[xt+4*et];kr!=255&&(kr*=32897,it[ct+4*et+0]=it[ct+4*et+0]*kr>>23,it[ct+4*et+1]=it[ct+4*et+1]*kr>>23,it[ct+4*et+2]=it[ct+4*et+2]*kr>>23)}Y+=Je}}function Ks(V,Y,fe,Te,We){for(;0<Te--;){var Je;for(Je=0;Je<fe;++Je){var et=V[Y+2*Je+0],it=15&(bt=V[Y+2*Je+1]),ct=4369*it,bt=(240&bt|bt>>4)*ct>>16;V[Y+2*Je+0]=(240&et|et>>4)*ct>>16&240|(15&et|et<<4)*ct>>16>>4&15,V[Y+2*Je+1]=240&bt|it}Y+=We}}function Su(V,Y,fe,Te,We,Je,et,it){var ct,bt,xt=255;for(bt=0;bt<We;++bt){for(ct=0;ct<Te;++ct){var kr=V[Y+ct];Je[et+4*ct]=kr,xt&=kr}Y+=fe,et+=it}return xt!=255}function Es(V,Y,fe,Te,We){var Je;for(Je=0;Je<We;++Je)fe[Te+Je]=V[Y+Je]>>8}function Eu(){Ri=Ss,ho=Ks,fo=Su,Zo=Es}function xa(V,Y,fe){G[V]=function(Te,We,Je,et,it,ct,bt,xt,kr,wt,ir,dr,Ur,Cr,wr,qr,fn){var an,ri=fn-1>>1,Gn=it[ct+0]|bt[xt+0]<<16,Oi=kr[wt+0]|ir[dr+0]<<16;e(Te!=null);var Yn=3*Gn+Oi+131074>>2;for(Y(Te[We+0],255&Yn,Yn>>16,Ur,Cr),Je!=null&&(Yn=3*Oi+Gn+131074>>2,Y(Je[et+0],255&Yn,Yn>>16,wr,qr)),an=1;an<=ri;++an){var Zi=it[ct+an]|bt[xt+an]<<16,Jo=kr[wt+an]|ir[dr+an]<<16,Pi=Gn+Zi+Oi+Jo+524296,Jn=Pi+2*(Zi+Oi)>>3;Yn=Jn+Gn>>1,Gn=(Pi=Pi+2*(Gn+Jo)>>3)+Zi>>1,Y(Te[We+2*an-1],255&Yn,Yn>>16,Ur,Cr+(2*an-1)*fe),Y(Te[We+2*an-0],255&Gn,Gn>>16,Ur,Cr+(2*an-0)*fe),Je!=null&&(Yn=Pi+Oi>>1,Gn=Jn+Jo>>1,Y(Je[et+2*an-1],255&Yn,Yn>>16,wr,qr+(2*an-1)*fe),Y(Je[et+2*an+0],255&Gn,Gn>>16,wr,qr+(2*an+0)*fe)),Gn=Zi,Oi=Jo}1&fn||(Yn=3*Gn+Oi+131074>>2,Y(Te[We+fn-1],255&Yn,Yn>>16,Ur,Cr+(fn-1)*fe),Je!=null&&(Yn=3*Oi+Gn+131074>>2,Y(Je[et+fn-1],255&Yn,Yn>>16,wr,qr+(fn-1)*fe)))}}function Js(){Tl[Zu]=yd,Tl[Ci]=zh,Tl[uu]=Sf,Tl[pc]=cp,Tl[hd]=Ef,Tl[Fh]=hp,Tl[ey]=iy,Tl[pg]=zh,Tl[op]=cp,Tl[fd]=Ef,Tl[_f]=hp}function au(V){return V&-16384?0>V?0:255:V>>Ju}function Ts(V,Y){return au((19077*V>>8)+(26149*Y>>8)-14234)}function Da(V,Y,fe){return au((19077*V>>8)-(6419*Y>>8)-(13320*fe>>8)+8708)}function To(V,Y){return au((19077*V>>8)+(33050*Y>>8)-17685)}function ha(V,Y,fe,Te,We){Te[We+0]=Ts(V,fe),Te[We+1]=Da(V,Y,fe),Te[We+2]=To(V,Y)}function Qs(V,Y,fe,Te,We){Te[We+0]=To(V,Y),Te[We+1]=Da(V,Y,fe),Te[We+2]=Ts(V,fe)}function jl(V,Y,fe,Te,We){var Je=Da(V,Y,fe);Y=Je<<3&224|To(V,Y)>>3,Te[We+0]=248&Ts(V,fe)|Je>>5,Te[We+1]=Y}function wa(V,Y,fe,Te,We){var Je=240&To(V,Y)|15;Te[We+0]=240&Ts(V,fe)|Da(V,Y,fe)>>4,Te[We+1]=Je}function Tu(V,Y,fe,Te,We){Te[We+0]=255,ha(V,Y,fe,Te,We+1)}function Ul(V,Y,fe,Te,We){Qs(V,Y,fe,Te,We),Te[We+3]=255}function el(V,Y,fe,Te,We){ha(V,Y,fe,Te,We),Te[We+3]=255}function Qa(V,Y){return 0>V?0:V>Y?Y:V}function Ro(V,Y,fe){G[V]=function(Te,We,Je,et,it,ct,bt,xt,kr){for(var wt=xt+(-2&kr)*fe;xt!=wt;)Y(Te[We+0],Je[et+0],it[ct+0],bt,xt),Y(Te[We+1],Je[et+0],it[ct+0],bt,xt+fe),We+=2,++et,++ct,xt+=2*fe;1&kr&&Y(Te[We+0],Je[et+0],it[ct+0],bt,xt)}}function hc(V,Y,fe){return fe==0?V==0?Y==0?6:5:Y==0?4:0:fe}function fc(V,Y,fe,Te,We){switch(V>>>30){case 3:_(Y,fe,Te,We,0);break;case 2:I(Y,fe,Te,We);break;case 1:re(Y,fe,Te,We)}}function Vl(V,Y){var fe,Te,We=Y.M,Je=Y.Nb,et=V.oc,it=V.pc+40,ct=V.oc,bt=V.pc+584,xt=V.oc,kr=V.pc+600;for(fe=0;16>fe;++fe)et[it+32*fe-1]=129;for(fe=0;8>fe;++fe)ct[bt+32*fe-1]=129,xt[kr+32*fe-1]=129;for(0<We?et[it-1-32]=ct[bt-1-32]=xt[kr-1-32]=129:(i(et,it-32-1,127,21),i(ct,bt-32-1,127,9),i(xt,kr-32-1,127,9)),Te=0;Te<V.za;++Te){var wt=Y.ya[Y.aa+Te];if(0<Te){for(fe=-1;16>fe;++fe)n(et,it+32*fe-4,et,it+32*fe+12,4);for(fe=-1;8>fe;++fe)n(ct,bt+32*fe-4,ct,bt+32*fe+4,4),n(xt,kr+32*fe-4,xt,kr+32*fe+4,4)}var ir=V.Gd,dr=V.Hd+Te,Ur=wt.ad,Cr=wt.Hc;if(0<We&&(n(et,it-32,ir[dr].y,0,16),n(ct,bt-32,ir[dr].f,0,8),n(xt,kr-32,ir[dr].ea,0,8)),wt.Za){var wr=et,qr=it-32+16;for(0<We&&(Te>=V.za-1?i(wr,qr,ir[dr].y[15],4):n(wr,qr,ir[dr+1].y,0,4)),fe=0;4>fe;fe++)wr[qr+128+fe]=wr[qr+256+fe]=wr[qr+384+fe]=wr[qr+0+fe];for(fe=0;16>fe;++fe,Cr<<=2)wr=et,qr=it+_d[fe],Wl[wt.Ob[fe]](wr,qr),fc(Cr,Ur,16*+fe,wr,qr)}else if(wr=hc(Te,We,wt.Ob[0]),Ku[wr](et,it),Cr!=0)for(fe=0;16>fe;++fe,Cr<<=2)fc(Cr,Ur,16*+fe,et,it+_d[fe]);for(fe=wt.Gc,wr=hc(Te,We,wt.Dd),gc[wr](ct,bt),gc[wr](xt,kr),Cr=Ur,wr=ct,qr=bt,255&(wt=0|fe)&&(170&wt?U(Cr,256,wr,qr):ye(Cr,256,wr,qr)),wt=xt,Cr=kr,255&(fe>>=8)&&(170&fe?U(Ur,320,wt,Cr):ye(Ur,320,wt,Cr)),We<V.Ub-1&&(n(ir[dr].y,0,et,it+480,16),n(ir[dr].f,0,ct,bt+224,8),n(ir[dr].ea,0,xt,kr+224,8)),fe=8*Je*V.B,ir=V.sa,dr=V.ta+16*Te+16*Je*V.R,Ur=V.qa,wt=V.ra+8*Te+fe,Cr=V.Ha,wr=V.Ia+8*Te+fe,fe=0;16>fe;++fe)n(ir,dr+fe*V.R,et,it+32*fe,16);for(fe=0;8>fe;++fe)n(Ur,wt+fe*V.B,ct,bt+32*fe,8),n(Cr,wr+fe*V.B,xt,kr+32*fe,8)}}function $l(V,Y,fe,Te,We,Je,et,it,ct){var bt=[0],xt=[0],kr=0,wt=ct!=null?ct.kd:0,ir=ct??new ci;if(V==null||12>fe)return 7;ir.data=V,ir.w=Y,ir.ha=fe,Y=[Y],fe=[fe],ir.gb=[ir.gb];e:{var dr=Y,Ur=fe,Cr=ir.gb;if(e(V!=null),e(Ur!=null),e(Cr!=null),Cr[0]=0,12<=Ur[0]&&!r(V,dr[0],"RIFF")){if(r(V,dr[0]+8,"WEBP")){Cr=3;break e}var wr=at(V,dr[0]+4);if(12>wr||4294967286<wr){Cr=3;break e}if(wt&&wr>Ur[0]-8){Cr=7;break e}Cr[0]=wr,dr[0]+=12,Ur[0]-=12}Cr=0}if(Cr!=0)return Cr;for(wr=0<ir.gb[0],fe=fe[0];;){e:{var qr=V;Ur=Y,Cr=fe;var fn=bt,an=xt,ri=dr=[0];if((Yn=kr=[kr])[0]=0,8>Cr[0])Cr=7;else{if(!r(qr,Ur[0],"VP8X")){if(at(qr,Ur[0]+4)!=10){Cr=3;break e}if(18>Cr[0]){Cr=7;break e}var Gn=at(qr,Ur[0]+8),Oi=1+Lt(qr,Ur[0]+12);if(2147483648<=Oi*(qr=1+Lt(qr,Ur[0]+15))){Cr=3;break e}ri!=null&&(ri[0]=Gn),fn!=null&&(fn[0]=Oi),an!=null&&(an[0]=qr),Ur[0]+=18,Cr[0]-=18,Yn[0]=1}Cr=0}}if(kr=kr[0],dr=dr[0],Cr!=0)return Cr;if(Ur=!!(2&dr),!wr&&kr)return 3;if(Je!=null&&(Je[0]=!!(16&dr)),et!=null&&(et[0]=Ur),it!=null&&(it[0]=0),et=bt[0],dr=xt[0],kr&&Ur&&ct==null){Cr=0;break}if(4>fe){Cr=7;break}if(wr&&kr||!wr&&!kr&&!r(V,Y[0],"ALPH")){fe=[fe],ir.na=[ir.na],ir.P=[ir.P],ir.Sa=[ir.Sa];e:{Gn=V,Cr=Y,wr=fe;var Yn=ir.gb;fn=ir.na,an=ir.P,ri=ir.Sa,Oi=22,e(Gn!=null),e(wr!=null),qr=Cr[0];var Zi=wr[0];for(e(fn!=null),e(ri!=null),fn[0]=null,an[0]=null,ri[0]=0;;){if(Cr[0]=qr,wr[0]=Zi,8>Zi){Cr=7;break e}var Jo=at(Gn,qr+4);if(4294967286<Jo){Cr=3;break e}var Pi=8+Jo+1&-2;if(Oi+=Pi,0<Yn&&Oi>Yn){Cr=3;break e}if(!r(Gn,qr,"VP8 ")||!r(Gn,qr,"VP8L")){Cr=0;break e}if(Zi[0]<Pi){Cr=7;break e}r(Gn,qr,"ALPH")||(fn[0]=Gn,an[0]=qr+8,ri[0]=Jo),qr+=Pi,Zi-=Pi}}if(fe=fe[0],ir.na=ir.na[0],ir.P=ir.P[0],ir.Sa=ir.Sa[0],Cr!=0)break}fe=[fe],ir.Ja=[ir.Ja],ir.xa=[ir.xa];e:if(Yn=V,Cr=Y,wr=fe,fn=ir.gb[0],an=ir.Ja,ri=ir.xa,Gn=Cr[0],qr=!r(Yn,Gn,"VP8 "),Oi=!r(Yn,Gn,"VP8L"),e(Yn!=null),e(wr!=null),e(an!=null),e(ri!=null),8>wr[0])Cr=7;else{if(qr||Oi){if(Yn=at(Yn,Gn+4),12<=fn&&Yn>fn-12){Cr=3;break e}if(wt&&Yn>wr[0]-8){Cr=7;break e}an[0]=Yn,Cr[0]+=8,wr[0]-=8,ri[0]=Oi}else ri[0]=5<=wr[0]&&Yn[Gn+0]==47&&!(Yn[Gn+4]>>5),an[0]=wr[0];Cr=0}if(fe=fe[0],ir.Ja=ir.Ja[0],ir.xa=ir.xa[0],Y=Y[0],Cr!=0)break;if(4294967286<ir.Ja)return 3;if(it==null||Ur||(it[0]=ir.xa?2:1),et=[et],dr=[dr],ir.xa){if(5>fe){Cr=7;break}it=et,wt=dr,Ur=Je,V==null||5>fe?V=0:5<=fe&&V[Y+0]==47&&!(V[Y+4]>>5)?(wr=[0],Yn=[0],fn=[0],Ee(an=new xe,V,Y,fe),Ce(an,wr,Yn,fn)?(it!=null&&(it[0]=wr[0]),wt!=null&&(wt[0]=Yn[0]),Ur!=null&&(Ur[0]=fn[0]),V=1):V=0):V=0}else{if(10>fe){Cr=7;break}it=dr,V==null||10>fe||!Lc(V,Y+3,fe-3)?V=0:(wt=V[Y+0]|V[Y+1]<<8|V[Y+2]<<16,Ur=16383&(V[Y+7]<<8|V[Y+6]),V=16383&(V[Y+9]<<8|V[Y+8]),1&wt||3<(wt>>1&7)||!(wt>>4&1)||wt>>5>=ir.Ja||!Ur||!V?V=0:(et&&(et[0]=Ur),it&&(it[0]=V),V=1))}if(!V||(et=et[0],dr=dr[0],kr&&(bt[0]!=et||xt[0]!=dr)))return 3;ct!=null&&(ct[0]=ir,ct.offset=Y-ct.w,e(4294967286>Y-ct.w),e(ct.offset==ct.ha-fe));break}return Cr==0||Cr==7&&kr&&ct==null?(Je!=null&&(Je[0]|=ir.na!=null&&0<ir.na.length),Te!=null&&(Te[0]=et),We!=null&&(We[0]=dr),0):Cr}function Co(V,Y,fe){var Te=Y.width,We=Y.height,Je=0,et=0,it=Te,ct=We;if(Y.Da=V!=null&&0<V.Da,Y.Da&&(it=V.cd,ct=V.bd,Je=V.v,et=V.j,11>fe||(Je&=-2,et&=-2),0>Je||0>et||0>=it||0>=ct||Je+it>Te||et+ct>We))return 0;if(Y.v=Je,Y.j=et,Y.va=Je+it,Y.o=et+ct,Y.U=it,Y.T=ct,Y.da=V!=null&&0<V.da,Y.da){if(!yr(it,ct,fe=[V.ib],Je=[V.hb]))return 0;Y.ib=fe[0],Y.hb=Je[0]}return Y.ob=V!=null&&V.ob,Y.Kb=V==null||!V.Sd,Y.da&&(Y.ob=Y.ib<3*Te/4&&Y.hb<3*We/4,Y.Kb=0),1}function co(V){if(V==null)return 2;if(11>V.S){var Y=V.f.RGBA;Y.fb+=(V.height-1)*Y.A,Y.A=-Y.A}else Y=V.f.kb,V=V.height,Y.O+=(V-1)*Y.fa,Y.fa=-Y.fa,Y.N+=(V-1>>1)*Y.Ab,Y.Ab=-Y.Ab,Y.W+=(V-1>>1)*Y.Db,Y.Db=-Y.Db,Y.F!=null&&(Y.J+=(V-1)*Y.lb,Y.lb=-Y.lb);return 0}function Cu(V,Y,fe,Te){if(Te==null||0>=V||0>=Y)return 2;if(fe!=null){if(fe.Da){var We=fe.cd,Je=fe.bd,et=-2&fe.v,it=-2&fe.j;if(0>et||0>it||0>=We||0>=Je||et+We>V||it+Je>Y)return 2;V=We,Y=Je}if(fe.da){if(!yr(V,Y,We=[fe.ib],Je=[fe.hb]))return 2;V=We[0],Y=Je[0]}}Te.width=V,Te.height=Y;e:{var ct=Te.width,bt=Te.height;if(V=Te.S,0>=ct||0>=bt||!(V>=Zu&&13>V))V=2;else{if(0>=Te.Rd&&Te.sd==null){et=Je=We=Y=0;var xt=(it=ct*ku[V])*bt;if(11>V||(Je=(bt+1)/2*(Y=(ct+1)/2),V==12&&(et=(We=ct)*bt)),(bt=a(xt+2*Je+et))==null){V=1;break e}Te.sd=bt,11>V?((ct=Te.f.RGBA).eb=bt,ct.fb=0,ct.A=it,ct.size=xt):((ct=Te.f.kb).y=bt,ct.O=0,ct.fa=it,ct.Fd=xt,ct.f=bt,ct.N=0+xt,ct.Ab=Y,ct.Cd=Je,ct.ea=bt,ct.W=0+xt+Je,ct.Db=Y,ct.Ed=Je,V==12&&(ct.F=bt,ct.J=0+xt+2*Je),ct.Tc=et,ct.lb=We)}if(Y=1,We=Te.S,Je=Te.width,et=Te.height,We>=Zu&&13>We)if(11>We)V=Te.f.RGBA,Y&=(it=Math.abs(V.A))*(et-1)+Je<=V.size,Y&=it>=Je*ku[We],Y&=V.eb!=null;else{V=Te.f.kb,it=(Je+1)/2,xt=(et+1)/2,ct=Math.abs(V.fa),bt=Math.abs(V.Ab);var kr=Math.abs(V.Db),wt=Math.abs(V.lb),ir=wt*(et-1)+Je;Y&=ct*(et-1)+Je<=V.Fd,Y&=bt*(xt-1)+it<=V.Cd,Y=(Y&=kr*(xt-1)+it<=V.Ed)&ct>=Je&bt>=it&kr>=it,Y&=V.y!=null,Y&=V.f!=null,Y&=V.ea!=null,We==12&&(Y&=wt>=Je,Y&=ir<=V.Tc,Y&=V.F!=null)}else Y=0;V=Y?0:2}}return V!=0||fe!=null&&fe.fd&&(V=co(Te)),V}var Ao=64,ql=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],jo=24,El=32,Ia=8,tl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Tr("Predictor0","PredictorAdd0"),G.Predictor0=function(){return 4278190080},G.Predictor1=function(V){return V},G.Predictor2=function(V,Y,fe){return Y[fe+0]},G.Predictor3=function(V,Y,fe){return Y[fe+1]},G.Predictor4=function(V,Y,fe){return Y[fe-1]},G.Predictor5=function(V,Y,fe){return Mr(Mr(V,Y[fe+1]),Y[fe+0])},G.Predictor6=function(V,Y,fe){return Mr(V,Y[fe-1])},G.Predictor7=function(V,Y,fe){return Mr(V,Y[fe+0])},G.Predictor8=function(V,Y,fe){return Mr(Y[fe-1],Y[fe+0])},G.Predictor9=function(V,Y,fe){return Mr(Y[fe+0],Y[fe+1])},G.Predictor10=function(V,Y,fe){return Mr(Mr(V,Y[fe-1]),Mr(Y[fe+0],Y[fe+1]))},G.Predictor11=function(V,Y,fe){var Te=Y[fe+0];return 0>=fr(Te>>24&255,V>>24&255,(Y=Y[fe-1])>>24&255)+fr(Te>>16&255,V>>16&255,Y>>16&255)+fr(Te>>8&255,V>>8&255,Y>>8&255)+fr(255&Te,255&V,255&Y)?Te:V},G.Predictor12=function(V,Y,fe){var Te=Y[fe+0];return(Pr((V>>24&255)+(Te>>24&255)-((Y=Y[fe-1])>>24&255))<<24|Pr((V>>16&255)+(Te>>16&255)-(Y>>16&255))<<16|Pr((V>>8&255)+(Te>>8&255)-(Y>>8&255))<<8|Pr((255&V)+(255&Te)-(255&Y)))>>>0},G.Predictor13=function(V,Y,fe){var Te=Y[fe-1];return(ar((V=Mr(V,Y[fe+0]))>>24&255,Te>>24&255)<<24|ar(V>>16&255,Te>>16&255)<<16|ar(V>>8&255,Te>>8&255)<<8|ar(255&V,255&Te))>>>0};var rl=G.PredictorAdd0;G.PredictorAdd1=Nr,Tr("Predictor2","PredictorAdd2"),Tr("Predictor3","PredictorAdd3"),Tr("Predictor4","PredictorAdd4"),Tr("Predictor5","PredictorAdd5"),Tr("Predictor6","PredictorAdd6"),Tr("Predictor7","PredictorAdd7"),Tr("Predictor8","PredictorAdd8"),Tr("Predictor9","PredictorAdd9"),Tr("Predictor10","PredictorAdd10"),Tr("Predictor11","PredictorAdd11"),Tr("Predictor12","PredictorAdd12"),Tr("Predictor13","PredictorAdd13");var ls=G.PredictorAdd2;Gt("ColorIndexInverseTransform","MapARGB","32b",function(V){return V>>8&255},function(V){return V}),Gt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(V){return V},function(V){return V>>8&255});var ou,Yu=G.ColorIndexInverseTransform,nl=G.MapARGB,su=G.VP8LColorIndexInverseTransformAlpha,Au=G.MapAlpha,tr=G.VP8LPredictorsAdd=[];tr.length=16,(G.VP8LPredictors=[]).length=16,(G.VP8LPredictorsAdd_C=[]).length=16,(G.VP8LPredictors_C=[]).length=16;var ur,mn,Tn,yi,Rn,A,y,_,I,U,re,ye,ke,Ke,yt,rr,gr,Wr,wn,Un,Kn,jn,Bn,zi,Ri,ho,fo,Zo,Ko=a(511),Hl=a(2041),lu=a(225),il=a(767),Cs=0,dc=Hl,As=lu,qa=il,us=Ko,Zu=0,Ci=1,uu=2,pc=3,hd=4,Fh=5,ey=6,pg=7,op=8,fd=9,_f=10,sp=[2,3,7],lp=[3,3,11],bf=[280,256,256,256,40],up=[0,1,1,1,0],gg=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dd=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],xf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],wf=8,Bh=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],pd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Iu=null,W0=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ty=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],mg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ry=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ny=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],md=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ku=[],Wl=[],gc=[],Io=1,Dc=2,cs=[],Tl=[];xa("UpsampleRgbLinePair",ha,3),xa("UpsampleBgrLinePair",Qs,3),xa("UpsampleRgbaLinePair",el,4),xa("UpsampleBgraLinePair",Ul,4),xa("UpsampleArgbLinePair",Tu,4),xa("UpsampleRgba4444LinePair",wa,2),xa("UpsampleRgb565LinePair",jl,2);var yd=G.UpsampleRgbLinePair,Sf=G.UpsampleBgrLinePair,zh=G.UpsampleRgbaLinePair,cp=G.UpsampleBgraLinePair,Ef=G.UpsampleArgbLinePair,hp=G.UpsampleRgba4444LinePair,iy=G.UpsampleRgb565LinePair,vd=16,Fc=1<<vd-1,mc=-227,al=482,Ju=6,fp=0,ay=a(256),oy=a(256),Tf=a(256),yg=a(256),dp=a(al-mc),sy=a(al-mc);Ro("YuvToRgbRow",ha,3),Ro("YuvToBgrRow",Qs,3),Ro("YuvToRgbaRow",el,4),Ro("YuvToBgraRow",Ul,4),Ro("YuvToArgbRow",Tu,4),Ro("YuvToRgba4444Row",wa,2),Ro("YuvToRgb565Row",jl,2);var _d=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],jh=[0,2,8],Cf=[8,7,6,4,4,2,2,2,1,1,1,1],Pu=1;this.WebPDecodeRGBA=function(V,Y,fe,Te,We){var Je=Ci,et=new Vn,it=new jt;et.ba=it,it.S=Je,it.width=[it.width],it.height=[it.height];var ct=it.width,bt=it.height,xt=new St;if(xt==null||V==null)var kr=2;else e(xt!=null),kr=$l(V,Y,fe,xt.width,xt.height,xt.Pd,xt.Qd,xt.format,null);if(kr!=0?ct=0:(ct!=null&&(ct[0]=xt.width[0]),bt!=null&&(bt[0]=xt.height[0]),ct=1),ct){it.width=it.width[0],it.height=it.height[0],Te!=null&&(Te[0]=it.width),We!=null&&(We[0]=it.height);e:{if(Te=new so,(We=new ci).data=V,We.w=Y,We.ha=fe,We.kd=1,Y=[0],e(We!=null),((V=$l(We.data,We.w,We.ha,null,null,null,Y,null,We))==0||V==7)&&Y[0]&&(V=4),(Y=V)==0){if(e(et!=null),Te.data=We.data,Te.w=We.w+We.offset,Te.ha=We.ha-We.offset,Te.put=jr,Te.ac=Zr,Te.bc=vn,Te.ma=et,We.xa){if((V=Fn())==null){et=1;break e}if((function(wt,ir){var dr=[0],Ur=[0],Cr=[0];t:for(;;){if(wt==null)return 0;if(ir==null)return wt.a=2,0;if(wt.l=ir,wt.a=0,Ee(wt.m,ir.data,ir.w,ir.ha),!Ce(wt.m,dr,Ur,Cr)){wt.a=3;break t}if(wt.xb=Dc,ir.width=dr[0],ir.height=Ur[0],!na(dr[0],Ur[0],1,wt,null))break t;return 1}return e(wt.a!=0),0})(V,Te)){if(Te=(Y=Cu(Te.width,Te.height,et.Oa,et.ba))==0){t:{Te=V;r:for(;;){if(Te==null){Te=0;break t}if(e(Te.s.yc!=null),e(Te.s.Ya!=null),e(0<Te.s.Wb),e((fe=Te.l)!=null),e((We=fe.ma)!=null),Te.xb!=0){if(Te.ca=We.ba,Te.tb=We.tb,e(Te.ca!=null),!Co(We.Oa,fe,pc)){Te.a=2;break r}if(!Ca(Te,fe.width)||fe.da)break r;if((fe.da||Bt(Te.ca.S))&&Eu(),11>Te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Te.ca.f.kb.F!=null&&Eu()),Te.Pb&&0<Te.s.ua&&Te.s.vb.X==null&&!Ve(Te.s.vb,Te.s.Wa.Xa)){Te.a=1;break r}Te.xb=0}if(!Xr(Te,Te.V,Te.Ba,Te.c,Te.i,fe.o,di))break r;We.Dc=Te.Ma,Te=1;break t}e(Te.a!=0),Te=0}Te=!Te}Te&&(Y=V.a)}else Y=V.a}else{if((V=new xl)==null){et=1;break e}if(V.Fa=We.na,V.P=We.P,V.qc=We.Sa,cc(V,Te)){if((Y=Cu(Te.width,Te.height,et.Oa,et.ba))==0){if(V.Aa=0,fe=et.Oa,e((We=V)!=null),fe!=null){if(0<(ct=0>(ct=fe.Md)?0:100<ct?255:255*ct/100)){for(bt=xt=0;4>bt;++bt)12>(kr=We.pb[bt]).lc&&(kr.ia=ct*Cf[0>kr.lc?0:kr.lc]>>3),xt|=kr.ia;xt&&(alert("todo:VP8InitRandom"),We.ia=1)}We.Ga=fe.Id,100<We.Ga?We.Ga=100:0>We.Ga&&(We.Ga=0)}(function(wt,ir){if(wt==null)return 0;if(ir==null)return Za(wt,2,"NULL VP8Io parameter in VP8Decode().");if(!wt.cb&&!cc(wt,ir))return 0;if(e(wt.cb),ir.ac==null||ir.ac(ir)){ir.ob&&(wt.L=0);var dr=jh[wt.L];if(wt.L==2?(wt.yb=0,wt.zb=0):(wt.yb=ir.v-dr>>4,wt.zb=ir.j-dr>>4,0>wt.yb&&(wt.yb=0),0>wt.zb&&(wt.zb=0)),wt.Va=ir.o+15+dr>>4,wt.Hb=ir.va+15+dr>>4,wt.Hb>wt.za&&(wt.Hb=wt.za),wt.Va>wt.Ub&&(wt.Va=wt.Ub),0<wt.L){var Ur=wt.ed;for(dr=0;4>dr;++dr){var Cr;if(wt.Qa.Cb){var wr=wt.Qa.Lb[dr];wt.Qa.Fb||(wr+=Ur.Tb)}else wr=Ur.Tb;for(Cr=0;1>=Cr;++Cr){var qr=wt.gd[dr][Cr],fn=wr;if(Ur.Pc&&(fn+=Ur.vd[0],Cr&&(fn+=Ur.od[0])),0<(fn=0>fn?0:63<fn?63:fn)){var an=fn;0<Ur.wb&&(an=4<Ur.wb?an>>2:an>>1)>9-Ur.wb&&(an=9-Ur.wb),1>an&&(an=1),qr.dd=an,qr.tc=2*fn+an,qr.ld=40<=fn?2:15<=fn?1:0}else qr.tc=0;qr.La=Cr}}}dr=0}else Za(wt,6,"Frame setup failed"),dr=wt.a;if(dr=dr==0){if(dr){wt.$c=0,0<wt.Aa||(wt.Ic=Pu);t:{dr=wt.Ic,Ur=4*(an=wt.za);var ri=32*an,Gn=an+1,Oi=0<wt.L?an*(0<wt.Aa?2:1):0,Yn=(wt.Aa==2?2:1)*an;if((qr=Ur+832+(Cr=3*(16*dr+jh[wt.L])/2*ri)+(wr=wt.Fa!=null&&0<wt.Fa.length?wt.Kc.c*wt.Kc.i:0))!=qr)dr=0;else{if(qr>wt.Vb){if(wt.Vb=0,wt.Ec=a(qr),wt.Fc=0,wt.Ec==null){dr=Za(wt,1,"no memory during frame initialization.");break t}wt.Vb=qr}qr=wt.Ec,fn=wt.Fc,wt.Ac=qr,wt.Bc=fn,fn+=Ur,wt.Gd=s(ri,Fs),wt.Hd=0,wt.rb=s(Gn+1,bl),wt.sb=1,wt.wa=Oi?s(Oi,ki):null,wt.Y=0,wt.D.Nb=0,wt.D.wa=wt.wa,wt.D.Y=wt.Y,0<wt.Aa&&(wt.D.Y+=an),e(!0),wt.oc=qr,wt.pc=fn,fn+=832,wt.ya=s(Yn,xi),wt.aa=0,wt.D.ya=wt.ya,wt.D.aa=wt.aa,wt.Aa==2&&(wt.D.aa+=an),wt.R=16*an,wt.B=8*an,an=(ri=jh[wt.L])*wt.R,ri=ri/2*wt.B,wt.sa=qr,wt.ta=fn+an,wt.qa=wt.sa,wt.ra=wt.ta+16*dr*wt.R+ri,wt.Ha=wt.qa,wt.Ia=wt.ra+8*dr*wt.B+ri,wt.$c=0,fn+=Cr,wt.mb=wr?qr:null,wt.nb=wr?fn:null,e(fn+wr<=wt.Fc+wt.Vb),Bs(wt),i(wt.Ac,wt.Bc,0,Ur),dr=1}}if(dr){if(ir.ka=0,ir.y=wt.sa,ir.O=wt.ta,ir.f=wt.qa,ir.N=wt.ra,ir.ea=wt.Ha,ir.Vd=wt.Ia,ir.fa=wt.R,ir.Rc=wt.B,ir.F=null,ir.J=0,!Cs){for(dr=-255;255>=dr;++dr)Ko[255+dr]=0>dr?-dr:dr;for(dr=-1020;1020>=dr;++dr)Hl[1020+dr]=-128>dr?-128:127<dr?127:dr;for(dr=-112;112>=dr;++dr)lu[112+dr]=-16>dr?-16:15<dr?15:dr;for(dr=-255;510>=dr;++dr)il[255+dr]=0>dr?0:255<dr?255:dr;Cs=1}y=Et,_=wu,U=K,re=pe,ye=Ye,I=xu,ke=se,Ke=qe,yt=sr,rr=Vr,gr=dt,Wr=Vt,wn=rn,Un=kn,Kn=zl,jn=Zs,Bn=Ja,zi=uo,Wl[0]=si,Wl[1]=Nt,Wl[2]=$r,Wl[3]=xn,Wl[4]=Li,Wl[5]=Vi,Wl[6]=wi,Wl[7]=Bi,Wl[8]=$a,Wl[9]=Pn,Ku[0]=nn,Ku[1]=Gr,Ku[2]=on,Ku[3]=en,Ku[4]=Xn,Ku[5]=En,Ku[6]=$n,gc[0]=In,gc[1]=Qt,gc[2]=ii,gc[3]=Wn,gc[4]=Na,gc[5]=Sl,gc[6]=Ys,dr=1}else dr=0}dr&&(dr=(function(Zi,Jo){for(Zi.M=0;Zi.M<Zi.Va;++Zi.M){var Pi,Jn=Zi.Jc[Zi.M&Zi.Xb],Cn=Zi.m,Pa=Zi;for(Pi=0;Pi<Pa.za;++Pi){var qn=Cn,Wi=Pa,ka=Wi.Ac,hs=Wi.Bc+4*Pi,ol=Wi.zc,Po=Wi.ya[Wi.aa+Pi];if(Wi.Qa.Bb?Po.$b=Ze(qn,Wi.Pa.jb[0])?2+Ze(qn,Wi.Pa.jb[2]):Ze(qn,Wi.Pa.jb[1]):Po.$b=0,Wi.kc&&(Po.Ad=Ze(qn,Wi.Bd)),Po.Za=!Ze(qn,145)+0,Po.Za){var sl=Po.Ob,po=0;for(Wi=0;4>Wi;++Wi){var Oo,sn=ol[0+Wi];for(Oo=0;4>Oo;++Oo){sn=ry[ka[hs+Oo]][sn];for(var Sn=gd[Ze(qn,sn[0])];0<Sn;)Sn=gd[2*Sn+Ze(qn,sn[Sn])];sn=-Sn,ka[hs+Oo]=sn}n(sl,po,ka,hs,4),po+=4,ol[0+Wi]=sn}}else sn=Ze(qn,156)?Ze(qn,128)?1:3:Ze(qn,163)?2:0,Po.Ob[0]=sn,i(ka,hs,sn,4),i(ol,0,sn,4);Po.Dd=Ze(qn,142)?Ze(qn,114)?Ze(qn,183)?1:3:2:0}if(Pa.m.Ka)return Za(Zi,7,"Premature end-of-partition0 encountered.");for(;Zi.ja<Zi.za;++Zi.ja){if(Pa=Jn,qn=(Cn=Zi).rb[Cn.sb-1],ka=Cn.rb[Cn.sb+Cn.ja],Pi=Cn.ya[Cn.aa+Cn.ja],hs=Cn.kc?Pi.Ad:0)qn.la=ka.la=0,Pi.Za||(qn.Na=ka.Na=0),Pi.Hc=0,Pi.Gc=0,Pi.ia=0;else{var eo,ga;if(qn=ka,ka=Pa,hs=Cn.Pa.Xc,ol=Cn.ya[Cn.aa+Cn.ja],Po=Cn.pb[ol.$b],Wi=ol.ad,sl=0,po=Cn.rb[Cn.sb-1],sn=Oo=0,i(Wi,sl,0,384),ol.Za)var Uo=0,to=hs[3];else{Sn=a(16);var No=qn.Na+po.Na;if(No=Iu(ka,hs[1],No,Po.Eb,0,Sn,0),qn.Na=po.Na=(0<No)+0,1<No)y(Sn,0,Wi,sl);else{var Sa=Sn[0]+3>>3;for(Sn=0;256>Sn;Sn+=16)Wi[sl+Sn]=Sa}Uo=1,to=hs[0]}var Ma=15&qn.la,ro=15&po.la;for(Sn=0;4>Sn;++Sn){var ia=1&ro;for(Sa=ga=0;4>Sa;++Sa)Ma=Ma>>1|(ia=(No=Iu(ka,to,No=ia+(1&Ma),Po.Sc,Uo,Wi,sl))>Uo)<<7,ga=ga<<2|(3<No?3:1<No?2:Wi[sl+0]!=0),sl+=16;Ma>>=4,ro=ro>>1|ia<<7,Oo=(Oo<<8|ga)>>>0}for(to=Ma,Uo=ro>>4,eo=0;4>eo;eo+=2){for(ga=0,Ma=qn.la>>4+eo,ro=po.la>>4+eo,Sn=0;2>Sn;++Sn){for(ia=1&ro,Sa=0;2>Sa;++Sa)No=ia+(1&Ma),Ma=Ma>>1|(ia=0<(No=Iu(ka,hs[2],No,Po.Qc,0,Wi,sl)))<<3,ga=ga<<2|(3<No?3:1<No?2:Wi[sl+0]!=0),sl+=16;Ma>>=2,ro=ro>>1|ia<<5}sn|=ga<<4*eo,to|=Ma<<4<<eo,Uo|=(240&ro)<<eo}qn.la=to,po.la=Uo,ol.Hc=Oo,ol.Gc=sn,ol.ia=43690&sn?0:Po.ia,hs=!(Oo|sn)}if(0<Cn.L&&(Cn.wa[Cn.Y+Cn.ja]=Cn.gd[Pi.$b][Pi.Za],Cn.wa[Cn.Y+Cn.ja].La|=!hs),Pa.Ka)return Za(Zi,7,"Premature end-of-file encountered.")}if(Bs(Zi),Cn=Jo,Pa=1,Pi=(Jn=Zi).D,qn=0<Jn.L&&Jn.M>=Jn.zb&&Jn.M<=Jn.Va,Jn.Aa==0)t:{if(Pi.M=Jn.M,Pi.uc=qn,Vl(Jn,Pi),Pa=1,Pi=(ga=Jn.D).Nb,qn=(sn=jh[Jn.L])*Jn.R,ka=sn/2*Jn.B,Sn=16*Pi*Jn.R,Sa=8*Pi*Jn.B,hs=Jn.sa,ol=Jn.ta-qn+Sn,Po=Jn.qa,Wi=Jn.ra-ka+Sa,sl=Jn.Ha,po=Jn.Ia-ka+Sa,ro=(Ma=ga.M)==0,Oo=Ma>=Jn.Va-1,Jn.Aa==2&&Vl(Jn,ga),ga.uc)for(ia=(No=Jn).D.M,e(No.D.uc),ga=No.yb;ga<No.Hb;++ga){Uo=ga,to=ia;var Ki=(Gl=(ds=No).D).Nb;eo=ds.R;var Gl=Gl.wa[Gl.Y+Uo],Qo=ds.sa,Vo=ds.ta+16*Ki*eo+16*Uo,Cl=Gl.dd,Ea=Gl.tc;if(Ea!=0)if(e(3<=Ea),ds.L==1)0<Uo&&jn(Qo,Vo,eo,Ea+4),Gl.La&&zi(Qo,Vo,eo,Ea),0<to&&Kn(Qo,Vo,eo,Ea+4),Gl.La&&Bn(Qo,Vo,eo,Ea);else{var fs=ds.B,Al=ds.qa,Bc=ds.ra+8*Ki*fs+8*Uo,Mu=ds.Ha,ds=ds.Ia+8*Ki*fs+8*Uo;Ki=Gl.ld,0<Uo&&(Ke(Qo,Vo,eo,Ea+4,Cl,Ki),rr(Al,Bc,Mu,ds,fs,Ea+4,Cl,Ki)),Gl.La&&(Wr(Qo,Vo,eo,Ea,Cl,Ki),Un(Al,Bc,Mu,ds,fs,Ea,Cl,Ki)),0<to&&(ke(Qo,Vo,eo,Ea+4,Cl,Ki),yt(Al,Bc,Mu,ds,fs,Ea+4,Cl,Ki)),Gl.La&&(gr(Qo,Vo,eo,Ea,Cl,Ki),wn(Al,Bc,Mu,ds,fs,Ea,Cl,Ki))}}if(Jn.ia&&alert("todo:DitherRow"),Cn.put!=null){if(ga=16*Ma,Ma=16*(Ma+1),ro?(Cn.y=Jn.sa,Cn.O=Jn.ta+Sn,Cn.f=Jn.qa,Cn.N=Jn.ra+Sa,Cn.ea=Jn.Ha,Cn.W=Jn.Ia+Sa):(ga-=sn,Cn.y=hs,Cn.O=ol,Cn.f=Po,Cn.N=Wi,Cn.ea=sl,Cn.W=po),Oo||(Ma-=sn),Ma>Cn.o&&(Ma=Cn.o),Cn.F=null,Cn.J=null,Jn.Fa!=null&&0<Jn.Fa.length&&ga<Ma&&(Cn.J=ba(Jn,Cn,ga,Ma-ga),Cn.F=Jn.mb,Cn.F==null&&Cn.F.length==0)){Pa=Za(Jn,3,"Could not decode alpha data.");break t}ga<Cn.j&&(sn=Cn.j-ga,ga=Cn.j,e(!(1&sn)),Cn.O+=Jn.R*sn,Cn.N+=Jn.B*(sn>>1),Cn.W+=Jn.B*(sn>>1),Cn.F!=null&&(Cn.J+=Cn.width*sn)),ga<Ma&&(Cn.O+=Cn.v,Cn.N+=Cn.v>>1,Cn.W+=Cn.v>>1,Cn.F!=null&&(Cn.J+=Cn.v),Cn.ka=ga-Cn.j,Cn.U=Cn.va-Cn.v,Cn.T=Ma-ga,Pa=Cn.put(Cn))}Pi+1!=Jn.Ic||Oo||(n(Jn.sa,Jn.ta-qn,hs,ol+16*Jn.R,qn),n(Jn.qa,Jn.ra-ka,Po,Wi+8*Jn.B,ka),n(Jn.Ha,Jn.Ia-ka,sl,po+8*Jn.B,ka))}if(!Pa)return Za(Zi,6,"Output aborted.")}return 1})(wt,ir)),ir.bc!=null&&ir.bc(ir),dr&=1}return dr?(wt.cb=0,dr):0})(V,Te)||(Y=V.a)}}else Y=V.a}Y==0&&et.Oa!=null&&et.Oa.fd&&(Y=co(et.ba))}et=Y}Je=et!=0?null:11>Je?it.f.RGBA.eb:it.f.kb.y}else Je=null;return Je};var ku=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(G,ie){for(var J="",H=0;H<4;H++)J+=String.fromCharCode(G[ie++]);return J}function f(G,ie){return G[ie+0]|G[ie+1]<<8}function d(G,ie){return(G[ie+0]|G[ie+1]<<8|G[ie+2]<<16)>>>0}function b(G,ie){return(G[ie+0]|G[ie+1]<<8|G[ie+2]<<16|G[ie+3]<<24)>>>0}new u;var v=[0],S=[0],E=[],P=new u,k=t,L=(function(G,ie){var J={},H=0,ne=!1,ae=0,ue=0;if(J.frames=[],!(function(ce,xe){for(var _e=0;_e<4;_e++)if(ce[xe+_e]!="RIFF".charCodeAt(_e))return!0;return!1})(G,ie)){for(b(G,ie+=4),ie+=8;ie<G.length;){var de=h(G,ie),Pe=b(G,ie+=4);ie+=4;var me=Pe+(1&Pe);switch(de){case"VP8 ":case"VP8L":J.frames[H]===void 0&&(J.frames[H]={}),(Ae=J.frames[H]).src_off=ne?ue:ie-8,Ae.src_size=ae+Pe+8,H++,ne&&(ne=!1,ae=0,ue=0);break;case"VP8X":(Ae=J.header={}).feature_flags=G[ie];var Ee=ie+4;Ae.canvas_width=1+d(G,Ee),Ee+=3,Ae.canvas_height=1+d(G,Ee),Ee+=3;break;case"ALPH":ne=!0,ae=me+8,ue=ie-8;break;case"ANIM":(Ae=J.header).bgcolor=b(G,ie),Ee=ie+4,Ae.loop_count=f(G,Ee),Ee+=2;break;case"ANMF":var we,Ae;(Ae=J.frames[H]={}).offset_x=2*d(G,ie),ie+=3,Ae.offset_y=2*d(G,ie),ie+=3,Ae.width=1+d(G,ie),ie+=3,Ae.height=1+d(G,ie),ie+=3,Ae.duration=d(G,ie),ie+=3,we=G[ie++],Ae.dispose=1&we,Ae.blend=we>>1&1}de!="ANMF"&&(ie+=me)}return J}})(k,0);L.response=k,L.rgbaoutput=!0,L.dataurl=!1;var N=L.header?L.header:null,M=L.frames?L.frames:null;if(N){N.loop_counter=N.loop_count,v=[N.canvas_height],S=[N.canvas_width];for(var z=0;z<M.length&&M[z].blend!=0;z++);}var B=M[0],q=P.WebPDecodeRGBA(k,B.src_off,B.src_size,S,v);B.rgba=q,B.imgwidth=S[0],B.imgheight=v[0];for(var W=0;W<S[0]*v[0]*4;W++)E[W]=q[W];return this.width=S,this.height=v,this.data=E,this}(function(t){var e,r,n,i,a,s,o,u,h,f=function(ce){return ce=ce||{},this.isStrokeTransparent=ce.isStrokeTransparent||!1,this.strokeOpacity=ce.strokeOpacity||1,this.strokeStyle=ce.strokeStyle||"#000000",this.fillStyle=ce.fillStyle||"#000000",this.isFillTransparent=ce.isFillTransparent||!1,this.fillOpacity=ce.fillOpacity||1,this.font=ce.font||"10px sans-serif",this.textBaseline=ce.textBaseline||"alphabetic",this.textAlign=ce.textAlign||"left",this.lineWidth=ce.lineWidth||1,this.lineJoin=ce.lineJoin||"miter",this.lineCap=ce.lineCap||"butt",this.path=ce.path||[],this.transform=ce.transform!==void 0?ce.transform.clone():new u,this.globalCompositeOperation=ce.globalCompositeOperation||"normal",this.globalAlpha=ce.globalAlpha||1,this.clip_path=ce.clip_path||[],this.currentPoint=ce.currentPoint||new s,this.miterLimit=ce.miterLimit||10,this.lastPoint=ce.lastPoint||new s,this.lineDashOffset=ce.lineDashOffset||0,this.lineDash=ce.lineDash||[],this.margin=ce.margin||[0,0,0,0],this.prevPageLastElemOffset=ce.prevPageLastElemOffset||0,this.ignoreClearRect=typeof ce.ignoreClearRect!="boolean"||ce.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,h=new f}]);var d=function(ce){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var xe=ce;Object.defineProperty(this,"pdf",{get:function(){return xe}});var _e=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return _e},set:function(at){_e=!!at}});var Me=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Me},set:function(at){Me=!!at}});var Re=0;Object.defineProperty(this,"posX",{get:function(){return Re},set:function(at){isNaN(at)||(Re=at)}});var He=0;Object.defineProperty(this,"posY",{get:function(){return He},set:function(at){isNaN(at)||(He=at)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(at){var Ve;typeof at=="number"?Ve=[at,at,at,at]:((Ve=new Array(4))[0]=at[0],Ve[1]=at.length>=2?at[1]:Ve[0],Ve[2]=at.length>=3?at[2]:Ve[0],Ve[3]=at.length>=4?at[3]:Ve[1]),h.margin=Ve}});var Fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Fe},set:function(at){Fe=at}});var tt=0;Object.defineProperty(this,"lastBreak",{get:function(){return tt},set:function(at){tt=at}});var Ze=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ze},set:function(at){Ze=at}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(at){at instanceof f&&(h=at)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(at){h.path=at}});var Qe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Qe},set:function(at){Qe=at}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(at){var Ve;Ve=b(at),this.ctx.fillStyle=Ve.style,this.ctx.isFillTransparent=Ve.a===0,this.ctx.fillOpacity=Ve.a,this.pdf.setFillColor(Ve.r,Ve.g,Ve.b,{a:Ve.a}),this.pdf.setTextColor(Ve.r,Ve.g,Ve.b,{a:Ve.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(at){var Ve=b(at);this.ctx.strokeStyle=Ve.style,this.ctx.isStrokeTransparent=Ve.a===0,this.ctx.strokeOpacity=Ve.a,Ve.a===0?this.pdf.setDrawColor(255,255,255):(Ve.a,this.pdf.setDrawColor(Ve.r,Ve.g,Ve.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(at){["butt","round","square"].indexOf(at)!==-1&&(this.ctx.lineCap=at,this.pdf.setLineCap(at))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(at){isNaN(at)||(this.ctx.lineWidth=at,this.pdf.setLineWidth(at))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(at){["bevel","round","miter"].indexOf(at)!==-1&&(this.ctx.lineJoin=at,this.pdf.setLineJoin(at))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(at){isNaN(at)||(this.ctx.miterLimit=at,this.pdf.setMiterLimit(at))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(at){this.ctx.textBaseline=at}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(at){["right","end","center","left","start"].indexOf(at)!==-1&&(this.ctx.textAlign=at)}});var Ie=null,Lt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Lt},set:function(at){Ie=null,Lt=at}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(at){var Ve;if(this.ctx.font=at,(Ve=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(at))!==null){var nr=Ve[1];Ve[2];var Yt=Ve[3],yr=Ve[4];Ve[5];var mt=Ve[6],br=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(yr)[2];yr=Math.floor(br==="px"?parseFloat(yr)*this.pdf.internal.scaleFactor:br==="em"?parseFloat(yr)*this.pdf.getFontSize():parseFloat(yr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(yr);var Tr=(function(er){var Gt,Tt,Oe=[],Be=er.trim();if(Be==="")return j3;if(Be in MB)return[MB[Be]];for(;Be!=="";){switch(Tt=null,Gt=(Be=OB(Be)).charAt(0)){case'"':case"'":Tt=ove(Be.substring(1),Gt);break;default:Tt=sve(Be)}if(Tt===null||(Oe.push(Tt[0]),(Be=OB(Tt[1]))!==""&&Be.charAt(0)!==","))return j3;Be=Be.replace(/^,/,"")}return Oe})(mt);if(this.fontFaces){var mr=(function(er,Gt){if(Ie===null){var Tt=(function(Oe){var Be=[];return Object.keys(Oe).forEach(function(Ne){Oe[Ne].forEach(function(rt){var pt=null;switch(rt){case"bold":pt={family:Ne,weight:"bold"};break;case"italic":pt={family:Ne,style:"italic"};break;case"bolditalic":pt={family:Ne,weight:"bold",style:"italic"};break;case"":case"normal":pt={family:Ne}}pt!==null&&(pt.ref={name:Ne,style:rt},Be.push(pt))})}),Be})(er.getFontList());Ie=(function(Oe){for(var Be={},Ne=0;Ne<Oe.length;++Ne){var rt=z3(Oe[Ne]),pt=rt.family,Rt=rt.stretch,Bt=rt.style,At=rt.weight;Be[pt]=Be[pt]||{},Be[pt][Rt]=Be[pt][Rt]||{},Be[pt][Rt][Bt]=Be[pt][Rt][Bt]||{},Be[pt][Rt][Bt][At]=rt}return Be})(Tt.concat(Gt))}return Ie})(this.pdf,this.fontFaces),Mr=Tr.map(function(er){return{family:er,stretch:"normal",weight:Yt,style:nr}}),Pr=(function(er,Gt,Tt){for(var Oe=(Tt=Tt||{}).defaultFontFamily||"times",Be=Object.assign({},ave,Tt.genericFontFamilies||{}),Ne=null,rt=null,pt=0;pt<Gt.length;++pt)if(Be[(Ne=z3(Gt[pt])).family]&&(Ne.family=Be[Ne.family]),er.hasOwnProperty(Ne.family)){rt=er[Ne.family];break}if(!(rt=rt||er[Oe]))throw new Error("Could not find a font-family for the rule '"+RB(Ne)+"' and default family '"+Oe+"'.");if(rt=(function(Rt,Bt){if(Bt[Rt])return Bt[Rt];var At=QP[Rt],Zt=At<=QP.normal?-1:1,jt=kB(Bt,NX,At,Zt);if(!jt)throw new Error("Could not find a matching font-stretch value for "+Rt);return jt})(Ne.stretch,rt),rt=(function(Rt,Bt){if(Bt[Rt])return Bt[Rt];for(var At=OX[Rt],Zt=0;Zt<At.length;++Zt)if(Bt[At[Zt]])return Bt[At[Zt]];throw new Error("Could not find a matching font-style for "+Rt)})(Ne.style,rt),!(rt=(function(Rt,Bt){if(Bt[Rt])return Bt[Rt];if(Rt===400&&Bt[500])return Bt[500];if(Rt===500&&Bt[400])return Bt[400];var At=ive[Rt],Zt=kB(Bt,LX,At,Rt<400?-1:1);if(!Zt)throw new Error("Could not find a matching font-weight for value "+Rt);return Zt})(Ne.weight,rt)))throw new Error("Failed to resolve a font for the rule '"+RB(Ne)+"'.");return rt})(mr,Mr);this.pdf.setFont(Pr.ref.name,Pr.ref.style)}else{var ar="";(Yt==="bold"||parseInt(Yt,10)>=700||nr==="bold")&&(ar="bold"),nr==="italic"&&(ar+="italic"),ar.length===0&&(ar="normal");for(var fr="",Nr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},or=0;or<Tr.length;or++){if(this.pdf.internal.getFont(Tr[or],ar,{noFallback:!0,disableWarning:!0})!==void 0){fr=Tr[or];break}if(ar==="bolditalic"&&this.pdf.internal.getFont(Tr[or],"bold",{noFallback:!0,disableWarning:!0})!==void 0)fr=Tr[or],ar="bold";else if(this.pdf.internal.getFont(Tr[or],"normal",{noFallback:!0,disableWarning:!0})!==void 0){fr=Tr[or],ar="normal";break}}if(fr===""){for(var Dr=0;Dr<Tr.length;Dr++)if(Nr[Tr[Dr]]){fr=Nr[Tr[Dr]];break}}fr=fr===""?"Times":fr,this.pdf.setFont(fr,ar)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(at){this.ctx.globalCompositeOperation=at}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(at){this.ctx.globalAlpha=at}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(at){this.ctx.lineDashOffset=at,Ae.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(at){this.ctx.lineDash=at,Ae.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(at){this.ctx.ignoreClearRect=!!at}})};d.prototype.setLineDash=function(ce){this.lineDash=ce},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){M.call(this,"fill",!1)},d.prototype.stroke=function(){M.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(ce,xe){if(isNaN(ce)||isNaN(xe))throw ko.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var _e=this.ctx.transform.applyToPoint(new s(ce,xe));this.path.push({type:"mt",x:_e.x,y:_e.y}),this.ctx.lastPoint=new s(ce,xe)},d.prototype.closePath=function(){var ce=new s(0,0),xe=0;for(xe=this.path.length-1;xe!==-1;xe--)if(this.path[xe].type==="begin"&&ao(this.path[xe+1])==="object"&&typeof this.path[xe+1].x=="number"){ce=new s(this.path[xe+1].x,this.path[xe+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(ce.x,ce.y)},d.prototype.lineTo=function(ce,xe){if(isNaN(ce)||isNaN(xe))throw ko.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var _e=this.ctx.transform.applyToPoint(new s(ce,xe));this.path.push({type:"lt",x:_e.x,y:_e.y}),this.ctx.lastPoint=new s(_e.x,_e.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},d.prototype.quadraticCurveTo=function(ce,xe,_e,Me){if(isNaN(_e)||isNaN(Me)||isNaN(ce)||isNaN(xe))throw ko.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Re=this.ctx.transform.applyToPoint(new s(_e,Me)),He=this.ctx.transform.applyToPoint(new s(ce,xe));this.path.push({type:"qct",x1:He.x,y1:He.y,x:Re.x,y:Re.y}),this.ctx.lastPoint=new s(Re.x,Re.y)},d.prototype.bezierCurveTo=function(ce,xe,_e,Me,Re,He){if(isNaN(Re)||isNaN(He)||isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me))throw ko.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Fe=this.ctx.transform.applyToPoint(new s(Re,He)),tt=this.ctx.transform.applyToPoint(new s(ce,xe)),Ze=this.ctx.transform.applyToPoint(new s(_e,Me));this.path.push({type:"bct",x1:tt.x,y1:tt.y,x2:Ze.x,y2:Ze.y,x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new s(Fe.x,Fe.y)},d.prototype.arc=function(ce,xe,_e,Me,Re,He){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me)||isNaN(Re))throw ko.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(He=!!He,!this.ctx.transform.isIdentity){var Fe=this.ctx.transform.applyToPoint(new s(ce,xe));ce=Fe.x,xe=Fe.y;var tt=this.ctx.transform.applyToPoint(new s(0,_e)),Ze=this.ctx.transform.applyToPoint(new s(0,0));_e=Math.sqrt(Math.pow(tt.x-Ze.x,2)+Math.pow(tt.y-Ze.y,2))}Math.abs(Re-Me)>=2*Math.PI&&(Me=0,Re=2*Math.PI),this.path.push({type:"arc",x:ce,y:xe,radius:_e,startAngle:Me,endAngle:Re,counterclockwise:He})},d.prototype.arcTo=function(ce,xe,_e,Me,Re){throw new Error("arcTo not implemented.")},d.prototype.rect=function(ce,xe,_e,Me){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me))throw ko.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(ce,xe),this.lineTo(ce+_e,xe),this.lineTo(ce+_e,xe+Me),this.lineTo(ce,xe+Me),this.lineTo(ce,xe),this.lineTo(ce+_e,xe),this.lineTo(ce,xe)},d.prototype.fillRect=function(ce,xe,_e,Me){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me))throw ko.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var Re={};this.lineCap!=="butt"&&(Re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(ce,xe,_e,Me),this.fill(),Re.hasOwnProperty("lineCap")&&(this.lineCap=Re.lineCap),Re.hasOwnProperty("lineJoin")&&(this.lineJoin=Re.lineJoin)}},d.prototype.strokeRect=function(ce,xe,_e,Me){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me))throw ko.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(ce,xe,_e,Me),this.stroke())},d.prototype.clearRect=function(ce,xe,_e,Me){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me))throw ko.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(ce,xe,_e,Me))},d.prototype.save=function(ce){ce=typeof ce!="boolean"||ce;for(var xe=this.pdf.internal.getCurrentPageInfo().pageNumber,_e=0;_e<this.pdf.internal.getNumberOfPages();_e++)this.pdf.setPage(_e+1),this.pdf.internal.out("q");if(this.pdf.setPage(xe),ce){this.ctx.fontSize=this.pdf.internal.getFontSize();var Me=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Me}},d.prototype.restore=function(ce){ce=typeof ce!="boolean"||ce;for(var xe=this.pdf.internal.getCurrentPageInfo().pageNumber,_e=0;_e<this.pdf.internal.getNumberOfPages();_e++)this.pdf.setPage(_e+1),this.pdf.internal.out("Q");this.pdf.setPage(xe),ce&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(ce){var xe,_e,Me,Re;if(ce.isCanvasGradient===!0&&(ce=ce.getColor()),!ce)return{r:0,g:0,b:0,a:0,style:ce};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(ce))xe=0,_e=0,Me=0,Re=0;else{var He=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(ce);if(He!==null)xe=parseInt(He[1]),_e=parseInt(He[2]),Me=parseInt(He[3]),Re=1;else if((He=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(ce))!==null)xe=parseInt(He[1]),_e=parseInt(He[2]),Me=parseInt(He[3]),Re=parseFloat(He[4]);else{if(Re=1,typeof ce=="string"&&ce.charAt(0)!=="#"){var Fe=new CX(ce);ce=Fe.ok?Fe.toHex():"#000000"}ce.length===4?(xe=ce.substring(1,2),xe+=xe,_e=ce.substring(2,3),_e+=_e,Me=ce.substring(3,4),Me+=Me):(xe=ce.substring(1,3),_e=ce.substring(3,5),Me=ce.substring(5,7)),xe=parseInt(xe,16),_e=parseInt(_e,16),Me=parseInt(Me,16)}}return{r:xe,g:_e,b:Me,a:Re,style:ce}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(ce,xe,_e,Me){if(isNaN(xe)||isNaN(_e)||typeof ce!="string")throw ko.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Me=isNaN(Me)?void 0:Me,!v.call(this)){var Re=me(this.ctx.transform.rotation),He=this.ctx.transform.scaleX;H.call(this,{text:ce,x:xe,y:_e,scale:He,angle:Re,align:this.textAlign,maxWidth:Me})}},d.prototype.strokeText=function(ce,xe,_e,Me){if(isNaN(xe)||isNaN(_e)||typeof ce!="string")throw ko.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){Me=isNaN(Me)?void 0:Me;var Re=me(this.ctx.transform.rotation),He=this.ctx.transform.scaleX;H.call(this,{text:ce,x:xe,y:_e,scale:He,renderingMode:"stroke",angle:Re,align:this.textAlign,maxWidth:Me})}},d.prototype.measureText=function(ce){if(typeof ce!="string")throw ko.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var xe=this.pdf,_e=this.pdf.internal.scaleFactor,Me=xe.internal.getFontSize(),Re=xe.getStringUnitWidth(ce)*Me/xe.internal.scaleFactor;return new function(He){var Fe=(He=He||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Fe}}),this}({width:Re*=Math.round(96*_e/72*1e4)/1e4})},d.prototype.scale=function(ce,xe){if(isNaN(ce)||isNaN(xe))throw ko.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var _e=new u(ce,0,0,xe,0,0);this.ctx.transform=this.ctx.transform.multiply(_e)},d.prototype.rotate=function(ce){if(isNaN(ce))throw ko.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var xe=new u(Math.cos(ce),Math.sin(ce),-Math.sin(ce),Math.cos(ce),0,0);this.ctx.transform=this.ctx.transform.multiply(xe)},d.prototype.translate=function(ce,xe){if(isNaN(ce)||isNaN(xe))throw ko.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var _e=new u(1,0,0,1,ce,xe);this.ctx.transform=this.ctx.transform.multiply(_e)},d.prototype.transform=function(ce,xe,_e,Me,Re,He){if(isNaN(ce)||isNaN(xe)||isNaN(_e)||isNaN(Me)||isNaN(Re)||isNaN(He))throw ko.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Fe=new u(ce,xe,_e,Me,Re,He);this.ctx.transform=this.ctx.transform.multiply(Fe)},d.prototype.setTransform=function(ce,xe,_e,Me,Re,He){ce=isNaN(ce)?1:ce,xe=isNaN(xe)?0:xe,_e=isNaN(_e)?0:_e,Me=isNaN(Me)?1:Me,Re=isNaN(Re)?0:Re,He=isNaN(He)?0:He,this.ctx.transform=new u(ce,xe,_e,Me,Re,He)};var E=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(ce,xe,_e,Me,Re,He,Fe,tt,Ze){var Qe=this.pdf.getImageProperties(ce),Ie=1,Lt=1,at=1,Ve=1;Me!==void 0&&tt!==void 0&&(at=tt/Me,Ve=Ze/Re,Ie=Qe.width/Me*tt/Me,Lt=Qe.height/Re*Ze/Re),He===void 0&&(He=xe,Fe=_e,xe=0,_e=0),Me!==void 0&&tt===void 0&&(tt=Me,Ze=Re),Me===void 0&&tt===void 0&&(tt=Qe.width,Ze=Qe.height);for(var nr,Yt=this.ctx.transform.decompose(),yr=me(Yt.rotate.shx),mt=new u,br=(mt=(mt=(mt=mt.multiply(Yt.translate)).multiply(Yt.skew)).multiply(Yt.scale)).applyToRectangle(new o(He-xe*at,Fe-_e*Ve,Me*Ie,Re*Lt)),Tr=P.call(this,br),mr=[],Mr=0;Mr<Tr.length;Mr+=1)mr.indexOf(Tr[Mr])===-1&&mr.push(Tr[Mr]);if(N(mr),this.autoPaging)for(var Pr=mr[0],ar=mr[mr.length-1],fr=Pr;fr<ar+1;fr++){this.pdf.setPage(fr);var Nr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],or=fr===1?this.posY+this.margin[0]:this.margin[0],Dr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],er=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Gt=fr===1?0:Dr+(fr-2)*er;if(this.ctx.clip_path.length!==0){var Tt=this.path;nr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(nr,this.posX+this.margin[3],-Gt+or+this.ctx.prevPageLastElemOffset),z.call(this,"fill",!0),this.path=Tt}var Oe=JSON.parse(JSON.stringify(br));Oe=L([Oe],this.posX+this.margin[3],-Gt+or+this.ctx.prevPageLastElemOffset)[0];var Be=(fr>Pr||fr<ar)&&E.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Nr,er,null).clip().discardPath()),this.pdf.addImage(ce,"JPEG",Oe.x,Oe.y,Oe.w,Oe.h,null,null,yr),Be&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(ce,"JPEG",br.x,br.y,br.w,br.h,null,null,yr)};var P=function(ce,xe,_e){var Me=[];xe=xe||this.pdf.internal.pageSize.width,_e=_e||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Re=this.posY+this.ctx.prevPageLastElemOffset;switch(ce.type){default:case"mt":case"lt":Me.push(Math.floor((ce.y+Re)/_e)+1);break;case"arc":Me.push(Math.floor((ce.y+Re-ce.radius)/_e)+1),Me.push(Math.floor((ce.y+Re+ce.radius)/_e)+1);break;case"qct":var He=Ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ce.x1,ce.y1,ce.x,ce.y);Me.push(Math.floor((He.y+Re)/_e)+1),Me.push(Math.floor((He.y+He.h+Re)/_e)+1);break;case"bct":var Fe=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ce.x1,ce.y1,ce.x2,ce.y2,ce.x,ce.y);Me.push(Math.floor((Fe.y+Re)/_e)+1),Me.push(Math.floor((Fe.y+Fe.h+Re)/_e)+1);break;case"rect":Me.push(Math.floor((ce.y+Re)/_e)+1),Me.push(Math.floor((ce.y+ce.h+Re)/_e)+1)}for(var tt=0;tt<Me.length;tt+=1)for(;this.pdf.internal.getNumberOfPages()<Me[tt];)k.call(this);return Me},k=function(){var ce=this.fillStyle,xe=this.strokeStyle,_e=this.font,Me=this.lineCap,Re=this.lineWidth,He=this.lineJoin;this.pdf.addPage(),this.fillStyle=ce,this.strokeStyle=xe,this.font=_e,this.lineCap=Me,this.lineWidth=Re,this.lineJoin=He},L=function(ce,xe,_e){for(var Me=0;Me<ce.length;Me++)switch(ce[Me].type){case"bct":ce[Me].x2+=xe,ce[Me].y2+=_e;case"qct":ce[Me].x1+=xe,ce[Me].y1+=_e;default:ce[Me].x+=xe,ce[Me].y+=_e}return ce},N=function(ce){return ce.sort(function(xe,_e){return xe-_e})},M=function(ce,xe){for(var _e,Me,Re=this.fillStyle,He=this.strokeStyle,Fe=this.lineCap,tt=this.lineWidth,Ze=Math.abs(tt*this.ctx.transform.scaleX),Qe=this.lineJoin,Ie=JSON.parse(JSON.stringify(this.path)),Lt=JSON.parse(JSON.stringify(this.path)),at=[],Ve=0;Ve<Lt.length;Ve++)if(Lt[Ve].x!==void 0)for(var nr=P.call(this,Lt[Ve]),Yt=0;Yt<nr.length;Yt+=1)at.indexOf(nr[Yt])===-1&&at.push(nr[Yt]);for(var yr=0;yr<at.length;yr++)for(;this.pdf.internal.getNumberOfPages()<at[yr];)k.call(this);if(N(at),this.autoPaging)for(var mt=at[0],br=at[at.length-1],Tr=mt;Tr<br+1;Tr++){this.pdf.setPage(Tr),this.fillStyle=Re,this.strokeStyle=He,this.lineCap=Fe,this.lineWidth=Ze,this.lineJoin=Qe;var mr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mr=Tr===1?this.posY+this.margin[0]:this.margin[0],Pr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ar=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],fr=Tr===1?0:Pr+(Tr-2)*ar;if(this.ctx.clip_path.length!==0){var Nr=this.path;_e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(_e,this.posX+this.margin[3],-fr+Mr+this.ctx.prevPageLastElemOffset),z.call(this,ce,!0),this.path=Nr}if(Me=JSON.parse(JSON.stringify(Ie)),this.path=L(Me,this.posX+this.margin[3],-fr+Mr+this.ctx.prevPageLastElemOffset),xe===!1||Tr===0){var or=(Tr>mt||Tr<br)&&E.call(this);or&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],mr,ar,null).clip().discardPath()),z.call(this,ce,xe),or&&this.pdf.restoreGraphicsState()}this.lineWidth=tt}else this.lineWidth=Ze,z.call(this,ce,xe),this.lineWidth=tt;this.path=Ie},z=function(ce,xe){if((ce!=="stroke"||xe||!S.call(this))&&(ce==="stroke"||xe||!v.call(this))){for(var _e,Me,Re=[],He=this.path,Fe=0;Fe<He.length;Fe++){var tt=He[Fe];switch(tt.type){case"begin":Re.push({begin:!0});break;case"close":Re.push({close:!0});break;case"mt":Re.push({start:tt,deltas:[],abs:[]});break;case"lt":var Ze=Re.length;if(He[Fe-1]&&!isNaN(He[Fe-1].x)&&(_e=[tt.x-He[Fe-1].x,tt.y-He[Fe-1].y],Ze>0)){for(;Ze>=0;Ze--)if(Re[Ze-1].close!==!0&&Re[Ze-1].begin!==!0){Re[Ze-1].deltas.push(_e),Re[Ze-1].abs.push(tt);break}}break;case"bct":_e=[tt.x1-He[Fe-1].x,tt.y1-He[Fe-1].y,tt.x2-He[Fe-1].x,tt.y2-He[Fe-1].y,tt.x-He[Fe-1].x,tt.y-He[Fe-1].y],Re[Re.length-1].deltas.push(_e);break;case"qct":var Qe=He[Fe-1].x+2/3*(tt.x1-He[Fe-1].x),Ie=He[Fe-1].y+2/3*(tt.y1-He[Fe-1].y),Lt=tt.x+2/3*(tt.x1-tt.x),at=tt.y+2/3*(tt.y1-tt.y),Ve=tt.x,nr=tt.y;_e=[Qe-He[Fe-1].x,Ie-He[Fe-1].y,Lt-He[Fe-1].x,at-He[Fe-1].y,Ve-He[Fe-1].x,nr-He[Fe-1].y],Re[Re.length-1].deltas.push(_e);break;case"arc":Re.push({deltas:[],abs:[],arc:!0}),Array.isArray(Re[Re.length-1].abs)&&Re[Re.length-1].abs.push(tt)}}Me=xe?null:ce==="stroke"?"stroke":"fill";for(var Yt=!1,yr=0;yr<Re.length;yr++)if(Re[yr].arc)for(var mt=Re[yr].abs,br=0;br<mt.length;br++){var Tr=mt[br];Tr.type==="arc"?W.call(this,Tr.x,Tr.y,Tr.radius,Tr.startAngle,Tr.endAngle,Tr.counterclockwise,void 0,xe,!Yt):ne.call(this,Tr.x,Tr.y),Yt=!0}else if(Re[yr].close===!0)this.pdf.internal.out("h"),Yt=!1;else if(Re[yr].begin!==!0){var mr=Re[yr].start.x,Mr=Re[yr].start.y;ae.call(this,Re[yr].deltas,mr,Mr),Yt=!0}Me&&G.call(this,Me),xe&&ie.call(this)}},B=function(ce){var xe=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,_e=xe*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return ce-_e;case"top":return ce+xe-_e;case"hanging":return ce+xe-2*_e;case"middle":return ce+xe/2-_e;default:return ce}},q=function(ce){return ce+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var ce=function(){};return ce.colorStops=[],ce.addColorStop=function(xe,_e){this.colorStops.push([xe,_e])},ce.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},ce.isCanvasGradient=!0,ce},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(ce,xe,_e,Me,Re,He,Fe,tt,Ze){for(var Qe=de.call(this,_e,Me,Re,He),Ie=0;Ie<Qe.length;Ie++){var Lt=Qe[Ie];Ie===0&&(Ze?J.call(this,Lt.x1+ce,Lt.y1+xe):ne.call(this,Lt.x1+ce,Lt.y1+xe)),ue.call(this,ce,xe,Lt.x2,Lt.y2,Lt.x3,Lt.y3,Lt.x4,Lt.y4)}tt?ie.call(this):G.call(this,Fe)},G=function(ce){switch(ce){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ie=function(){this.pdf.clip(),this.pdf.discardPath()},J=function(ce,xe){this.pdf.internal.out(r(ce)+" "+n(xe)+" m")},H=function(ce){var xe;switch(ce.align){case"right":case"end":xe="right";break;case"center":xe="center";break;default:xe="left"}var _e=this.pdf.getTextDimensions(ce.text),Me=B.call(this,ce.y),Re=q.call(this,Me)-_e.h,He=this.ctx.transform.applyToPoint(new s(ce.x,Me)),Fe=this.ctx.transform.decompose(),tt=new u;tt=(tt=(tt=tt.multiply(Fe.translate)).multiply(Fe.skew)).multiply(Fe.scale);for(var Ze,Qe,Ie,Lt=this.ctx.transform.applyToRectangle(new o(ce.x,Me,_e.w,_e.h)),at=tt.applyToRectangle(new o(ce.x,Re,_e.w,_e.h)),Ve=P.call(this,at),nr=[],Yt=0;Yt<Ve.length;Yt+=1)nr.indexOf(Ve[Yt])===-1&&nr.push(Ve[Yt]);if(N(nr),this.autoPaging)for(var yr=nr[0],mt=nr[nr.length-1],br=yr;br<mt+1;br++){this.pdf.setPage(br);var Tr=br===1?this.posY+this.margin[0]:this.margin[0],mr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mr=this.pdf.internal.pageSize.height-this.margin[2],Pr=Mr-this.margin[0],ar=this.pdf.internal.pageSize.width-this.margin[1],fr=ar-this.margin[3],Nr=br===1?0:mr+(br-2)*Pr;if(this.ctx.clip_path.length!==0){var or=this.path;Ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(Ze,this.posX+this.margin[3],-1*Nr+Tr),z.call(this,"fill",!0),this.path=or}var Dr=L([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Nr+Tr+this.ctx.prevPageLastElemOffset)[0];ce.scale>=.01&&(Qe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Qe*ce.scale),Ie=this.lineWidth,this.lineWidth=Ie*ce.scale);var er=this.autoPaging!=="text";if(er||Dr.y+Dr.h<=Mr){if(er||Dr.y>=Tr&&Dr.x<=ar){var Gt=er?ce.text:this.pdf.splitTextToSize(ce.text,ce.maxWidth||ar-Dr.x)[0],Tt=L([JSON.parse(JSON.stringify(Lt))],this.posX+this.margin[3],-Nr+Tr+this.ctx.prevPageLastElemOffset)[0],Oe=er&&(br>yr||br<mt)&&E.call(this);Oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fr,Pr,null).clip().discardPath()),this.pdf.text(Gt,Tt.x,Tt.y,{angle:ce.angle,align:xe,renderingMode:ce.renderingMode}),Oe&&this.pdf.restoreGraphicsState()}}else Dr.y<Mr&&(this.ctx.prevPageLastElemOffset+=Mr-Dr.y);ce.scale>=.01&&(this.pdf.setFontSize(Qe),this.lineWidth=Ie)}else ce.scale>=.01&&(Qe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Qe*ce.scale),Ie=this.lineWidth,this.lineWidth=Ie*ce.scale),this.pdf.text(ce.text,He.x+this.posX,He.y+this.posY,{angle:ce.angle,align:xe,renderingMode:ce.renderingMode,maxWidth:ce.maxWidth}),ce.scale>=.01&&(this.pdf.setFontSize(Qe),this.lineWidth=Ie)},ne=function(ce,xe,_e,Me){_e=_e||0,Me=Me||0,this.pdf.internal.out(r(ce+_e)+" "+n(xe+Me)+" l")},ae=function(ce,xe,_e){return this.pdf.lines(ce,xe,_e,null,null)},ue=function(ce,xe,_e,Me,Re,He,Fe,tt){this.pdf.internal.out([e(i(_e+ce)),e(a(Me+xe)),e(i(Re+ce)),e(a(He+xe)),e(i(Fe+ce)),e(a(tt+xe)),"c"].join(" "))},de=function(ce,xe,_e,Me){for(var Re=2*Math.PI,He=Math.PI/2;xe>_e;)xe-=Re;var Fe=Math.abs(_e-xe);Fe<Re&&Me&&(Fe=Re-Fe);for(var tt=[],Ze=Me?-1:1,Qe=xe;Fe>1e-5;){var Ie=Qe+Ze*Math.min(Fe,He);tt.push(Pe.call(this,ce,Qe,Ie)),Fe-=Math.abs(Ie-Qe),Qe=Ie}return tt},Pe=function(ce,xe,_e){var Me=(_e-xe)/2,Re=ce*Math.cos(Me),He=ce*Math.sin(Me),Fe=Re,tt=-He,Ze=Fe*Fe+tt*tt,Qe=Ze+Fe*Re+tt*He,Ie=4/3*(Math.sqrt(2*Ze*Qe)-Qe)/(Fe*He-tt*Re),Lt=Fe-Ie*tt,at=tt+Ie*Fe,Ve=Lt,nr=-at,Yt=Me+xe,yr=Math.cos(Yt),mt=Math.sin(Yt);return{x1:ce*Math.cos(xe),y1:ce*Math.sin(xe),x2:Lt*yr-at*mt,y2:Lt*mt+at*yr,x3:Ve*yr-nr*mt,y3:Ve*mt+nr*yr,x4:ce*Math.cos(_e),y4:ce*Math.sin(_e)}},me=function(ce){return 180*ce/Math.PI},Ee=function(ce,xe,_e,Me,Re,He){var Fe=ce+.5*(_e-ce),tt=xe+.5*(Me-xe),Ze=Re+.5*(_e-Re),Qe=He+.5*(Me-He),Ie=Math.min(ce,Re,Fe,Ze),Lt=Math.max(ce,Re,Fe,Ze),at=Math.min(xe,He,tt,Qe),Ve=Math.max(xe,He,tt,Qe);return new o(Ie,at,Lt-Ie,Ve-at)},we=function(ce,xe,_e,Me,Re,He,Fe,tt){var Ze,Qe,Ie,Lt,at,Ve,nr,Yt,yr,mt,br,Tr,mr,Mr,Pr=_e-ce,ar=Me-xe,fr=Re-_e,Nr=He-Me,or=Fe-Re,Dr=tt-He;for(Qe=0;Qe<41;Qe++)yr=(nr=(Ie=ce+(Ze=Qe/40)*Pr)+Ze*((at=_e+Ze*fr)-Ie))+Ze*(at+Ze*(Re+Ze*or-at)-nr),mt=(Yt=(Lt=xe+Ze*ar)+Ze*((Ve=Me+Ze*Nr)-Lt))+Ze*(Ve+Ze*(He+Ze*Dr-Ve)-Yt),Qe==0?(br=yr,Tr=mt,mr=yr,Mr=mt):(br=Math.min(br,yr),Tr=Math.min(Tr,mt),mr=Math.max(mr,yr),Mr=Math.max(Mr,mt));return new o(Math.round(br),Math.round(Tr),Math.round(mr-br),Math.round(Mr-Tr))},Ae=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var ce,xe,_e=(ce=this.ctx.lineDash,xe=this.ctx.lineDashOffset,JSON.stringify({lineDash:ce,lineDashOffset:xe}));this.prevLineDash!==_e&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=_e)}}})(hi.API),(function(t){var e=function(s){var o,u,h,f,d,b,v,S,E,P;for(u=[],h=0,f=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;f>h;h+=4)(d=(s.charCodeAt(h)<<24)+(s.charCodeAt(h+1)<<16)+(s.charCodeAt(h+2)<<8)+s.charCodeAt(h+3))!==0?(b=(d=((d=((d=((d=(d-(P=d%85))/85)-(E=d%85))/85)-(S=d%85))/85)-(v=d%85))/85)%85,u.push(b+33,v+33,S+33,E+33,P+33)):u.push(122);return(function(k,L){for(var N=L;N>0;N--)k.pop()})(u,o.length),String.fromCharCode.apply(String,u)+"~>"},r=function(s){var o,u,h,f,d,b=String,v="length",S=255,E="charCodeAt",P="slice",k="replace";for(s[P](-2),s=s[P](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),h=[],f=0,d=(s+=o="uuuuu"[P](s[v]%5||5))[v];d>f;f+=5)u=52200625*(s[E](f)-33)+614125*(s[E](f+1)-33)+7225*(s[E](f+2)-33)+85*(s[E](f+3)-33)+(s[E](f+4)-33),h.push(S&u>>24,S&u>>16,S&u>>8,S&u);return(function(L,N){for(var M=N;M>0;M--)L.pop()})(h,o[v]),b.fromCharCode.apply(b,h)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var u="",h=0;h<s.length;h+=2)u+=String.fromCharCode("0x"+(s[h]+s[h+1]));return u},a=function(s){for(var o=new Uint8Array(s.length),u=s.length;u--;)o[u]=s.charCodeAt(u);return(o=WP(o)).reduce(function(h,f){return h+String.fromCharCode(f)},"")};t.processDataByFilters=function(s,o){var u=0,h=s||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),u=0;u<o.length;u+=1)switch(o[u]){case"ASCII85Decode":case"/ASCII85Decode":h=r(h),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=i(h),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=n(h),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=a(h),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[u]+'" is not implemented')}return{data:h,reverseChain:f.reverse().join(" ")}}})(hi.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(u,h,f){var d=new XMLHttpRequest,b=0,v=function(S){var E=S.length,P=[],k=String.fromCharCode;for(b=0;b<E;b+=1)P.push(k(255&S.charCodeAt(b)));return P.join("")};if(d.open("GET",u,!h),d.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(d.onload=function(){d.status===200?f(v(this.responseText)):f(void 0)}),d.send(null),h&&d.status===200)return v(d.responseText)})(i,a,s)}catch{}return o})(e,r,n)},t.loadImageFile=t.loadFile})(hi.API),(function(t){function e(){return(Ni.html2canvas?Promise.resolve(Ni.html2canvas):e3(()=>import("./html2canvas.esm-B0tyYwQk.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ni.DOMPurify?Promise.resolve(Ni.DOMPurify):e3(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var u=ao(o);return u==="undefined"?"undefined":u==="string"||o instanceof String?"string":u==="number"||o instanceof Number?"number":u==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(o,u){var h=document.createElement(o);for(var f in u.className&&(h.className=u.className),u.innerHTML&&u.dompurify&&(h.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)h.style[f]=u.style[f];return h},a=function o(u,h){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),d=u.firstChild;d;d=d.nextSibling)h!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(o(d,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f},s=function o(u){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),h);return(f=f.setProgress(1,o,1,[o])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,u){return o.__proto__=u||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,u){return this.then(function(){switch(u=u||(function(h){switch(n(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),u){case"string":return this.then(r).then(function(h){return this.set({src:i("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,u(this.prop.container,h)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=this.opt.jsPDF,f=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=f,f)for(var v=0;v<f.length;++v){var S=f[v],E=S.src.find(function(P){return P.format==="truetype"});E&&h.addFont(E.url,S.ref.name,S.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,h.context2d.save(!0),u(this.prop.container,b)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,u,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,u):this.outputPdf(o,u)},s.prototype.outputPdf=function(o,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,u)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var u=Object.keys(o||{}).map(function(h){if(h in s.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(o,u){return this.then(function(){var h=o in s.template.prop?this.prop[o]:this.opt[o];return u?u(h):h})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function u(h,f){return Math.floor(h*f/72*96)}return this.then(function(){(o=o||hi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:u(o.inner.width,o.k),height:u(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,u,h,f){return o!=null&&(this.progress.val=o),u!=null&&(this.progress.state=u),h!=null&&(this.progress.n=h),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,u,h,f){return this.setProgress(o?this.progress.val+o:null,u||null,h?this.progress.n+h:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(o,u){var h=this;return this.thenCore(o,u,function(f,d){return h.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(b){return h.updateProgress(null,f),b}).then(f,d).then(function(b){return h.updateProgress(1),b})})},s.prototype.thenCore=function(o,u,h){h=h||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),u&&(u=u.bind(f));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:s.convert(Object.assign({},f),Promise.prototype),b=h.call(d,o,u);return s.convert(b,f.__proto__)},s.prototype.thenExternal=function(o,u){return Promise.prototype.then.call(this,o,u)},s.prototype.thenList=function(o){var u=this;return o.forEach(function(h){u=u.thenCore(h)}),u},s.prototype.catch=function(o){o&&(o=o.bind(this));var u=Promise.prototype.catch.call(this,o);return s.convert(u,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,hi.getPageSize=function(o,u,h){if(ao(o)==="object"){var f=o;o=f.orientation,u=f.unit||u,h=f.format||h}u=u||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var d,b=(""+h).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+u}var S,E=0,P=0;if(v.hasOwnProperty(b))E=v[b][1]/d,P=v[b][0]/d;else try{E=h[1],P=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",P>E&&(S=P,P=E,E=S);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",E>P&&(S=P,P=E,E=S)}return{width:P,height:E,unit:u,k:d,orientation:o}},t.html=function(o,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(z3):null;var h=new s(u);return u.worker?h:h.from(o).doCallback()}})(hi.API),hi.API.addJS=function(t){return LB=t,this.internal.events.subscribe("postPutResources",function(){s2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(s2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),NB=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+LB+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){s2!==void 0&&NB!==void 0&&this.internal.out("/Names <</JavaScript "+s2+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var u=o[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,f=[];for(a=0;a<h;a++){var d=r.internal.newObject();f.push(d);var b=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var v=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<f.length;a++)r.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+v+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var u=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(hi.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,s,o){var u,h=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=(function(d){for(var b,v=256*d.charCodeAt(4)+d.charCodeAt(5),S=d.length,E={width:0,height:0,numcomponents:1},P=4;P<S;P+=2){if(P+=v,e.indexOf(d.charCodeAt(P+1))!==-1){b=256*d.charCodeAt(P+5)+d.charCodeAt(P+6),E={width:256*d.charCodeAt(P+7)+d.charCodeAt(P+8),height:b,numcomponents:d.charCodeAt(P+9)};break}v=256*d.charCodeAt(P+2)+d.charCodeAt(P+3)}return E})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:h,index:n,alias:i}}return f}})(hi.API),hi.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=qye(t,{checkCrc:!0}),s=a.width,o=a.height,u=a.channels,h=a.palette,f=a.depth;i=h&&u===1?(function(q){for(var W=q.width,G=q.height,ie=q.data,J=q.palette,H=q.depth,ne=!1,ae=[],ue=[],de=void 0,Pe=!1,me=0,Ee=0;Ee<J.length;Ee++){var we=z8(J[Ee],4),Ae=we[0],ce=we[1],xe=we[2],_e=we[3];ae.push(Ae,ce,xe),_e!=null&&(_e===0?(me++,ue.length<1&&ue.push(Ee)):_e<255&&(Pe=!0))}if(Pe||me>1){ne=!0,ue=void 0;var Me=W*G;de=new Uint8Array(Me);for(var Re=new DataView(ie.buffer),He=0;He<Me;He++){var Fe=U3(Re,He,H),tt=z8(J[Fe],4)[3];de[He]=tt}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:ie,alphaBytes:de,needSMask:ne,palette:ae,mask:ue}})(a):u===2||u===4?(function(q){for(var W=q.data,G=q.width,ie=q.height,J=q.channels,H=q.depth,ne=J===2?"DeviceGray":"DeviceRGB",ae=J-1,ue=G*ie,de=ae,Pe=ue*de,me=1*ue,Ee=Math.ceil(Pe*H/8),we=Math.ceil(me*H/8),Ae=new Uint8Array(Ee),ce=new Uint8Array(we),xe=new DataView(W.buffer),_e=new DataView(Ae.buffer),Me=new DataView(ce.buffer),Re=!1,He=0;He<ue;He++){for(var Fe=He*J,tt=0;tt<de;tt++)qB(_e,U3(xe,Fe+tt,H),He*de+tt,H);var Ze=U3(xe,Fe+de,H);Ze<(1<<H)-1&&(Re=!0),qB(Me,Ze,1*He,H)}return{colorSpace:ne,colorsPerPixel:ae,colorBytes:Ae,alphaBytes:ce,needSMask:Re}})(a):(function(q){var W=q.data,G=q.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:G,colorsPerPixel:G==="DeviceGray"?1:3,colorBytes:W instanceof Uint8Array?W:new Uint8Array(W.buffer),needSMask:!1}})(a);var d,b,v,S=i,E=S.colorSpace,P=S.colorsPerPixel,k=S.colorBytes,L=S.alphaBytes,N=S.needSMask,M=S.palette,z=S.mask,B=null;return n!==hi.API.image_compression.NONE&&typeof WP=="function"?(B=(function(q){var W;switch(q){case hi.API.image_compression.FAST:W=11;break;case hi.API.image_compression.MEDIUM:W=13;break;case hi.API.image_compression.SLOW:W=14;break;default:W=12}return W})(n),d=this.decode.FLATE_DECODE,b="/Predictor ".concat(B," "),t=zB(k,s*P,P,n),N&&(v=zB(L,s,1,n))):(d=void 0,b="",t=k,N&&(v=L)),b+="/Colors ".concat(P," /BitsPerComponent ").concat(f," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:r,data:t,index:e,filter:d,decodeParameters:b,transparency:z,palette:M,sMask:v,predictor:B,width:s,height:o,bitsPerComponent:f,colorSpace:E}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new hve(e),s=a.width,o=a.height,u=[];a.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:s,height:o},f=new V3(100).encode(h,100);return t.processJPEG.call(this,f,r,n,i)},t.processGIF87A=t.processGIF89A})(hi.API),Gh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Gh.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){ko.log("bit decode error:"+r)}},Gh.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var u=this.palette[a>>7-o&1];this.data[s+4*o]=u.blue,this.data[s+4*o+1]=u.green,this.data[s+4*o+2]=u.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Gh.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,u=15&a,h=this.palette[o];if(this.data[s]=h.blue,this.data[s+1]=h.green,this.data[s+2]=h.red,this.data[s+3]=255,2*i+1>=this.width)break;h=this.palette[u],this.data[s+4]=h.blue,this.data[s+4+1]=h.green,this.data[s+4+2]=h.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Gh.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Gh.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,u=(a>>10&e)/e*255|0,h=a>>15?255:0,f=n*this.width*4+4*i;this.data[f]=u,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=h}this.pos+=t}},Gh.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,u=(s>>5&r)/r*255|0,h=(s>>11)/e*255|0,f=i*this.width*4+4*a;this.data[f]=h,this.data[f+1]=u,this.data[f+2]=o,this.data[f+3]=255}this.pos+=t}},Gh.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Gh.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},Gh.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new Gh(e,!1),s=a.width,o=a.height,u={data:a.getData(),width:s,height:o},h=new V3(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}})(hi.API),WB.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new WB(e),s=a.width,o=a.height,u={data:a.getData(),width:s,height:o},h=new V3(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}})(hi.API),hi.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,u=0,h=0;h<i;h+=4){var f=n[h],d=n[h+1],b=n[h+2],v=n[h+3];a[o++]=f,a[o++]=d,a[o++]=b,s[u++]=v}var S=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:S,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},hi.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ky=hi.API,l2=ky.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,u=o.fof?o.fof:1,h=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=h.fof?h.fof:1,d=e.doKerning!==!1,b=0,v=t.length,S=0,E=o[0]||u,P=[];for(r=0;r<v;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?P.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(b=d&&ao(h[n])==="object"&&!isNaN(parseInt(h[n][S],10))?h[n][S]/f:0,P.push((o[n]||E)/u+b)),S=n;return P},DB=ky.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ky.processArabic&&(t=ky.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:l2.apply(this,arguments).reduce(function(a,s){return a+s},0)},FB=function(t,e,r,n){for(var i=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<r;)o+=e[a],a++;i.push(t.slice(0,a));var u=a;for(o=0;a!==s;)o+e[a]>n&&(i.push(t.slice(u,a)),o=0,u=a),o+=e[a],a++;return u!==a&&i.push(t.slice(u,a)),i},BB=function(t,e,r){r||(r={});var n,i,a,s,o,u,h,f=[],d=[f],b=r.textIndent||0,v=0,S=0,E=t.split(" "),P=l2.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?E[0].length+2:r.lineIndent||0){var k=Array(u).join(" "),L=[];E.map(function(M){(M=M.split(/\s*\n/)).length>1?L=L.concat(M.map(function(z,B){return(B&&z.length?`
`:"")+z})):L.push(M[0])}),E=L,u=DB.apply(this,[k,r])}for(a=0,s=E.length;a<s;a++){var N=0;if(n=E[a],u&&n[0]==`
`&&(n=n.substr(1),N=1),b+v+(S=(i=l2.apply(this,[n,r])).reduce(function(M,z){return M+z},0))>e||N){if(S>e){for(o=FB.apply(this,[n,i,e-(b+v),e]),f.push(o.shift()),f=[o.pop()];o.length;)d.push([o.shift()]);S=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(M,z){return M+z},0)}else f=[n];d.push(f),b=S+u,v=P}else f.push(n),b+=v+S,v=P}return h=u?function(M,z){return(z?k:"")+M.join(" ")}:function(M){return M.join(" ")},d.map(h)},ky.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle),b="Unicode";return d.metadata[b]?{widths:d.metadata[b].widths||{0:1},kerning:d.metadata[b].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,u,h=[];for(o=0,u=n.length;o<u;o++)h=h.concat(BB.apply(this,[n[o],s,a]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var s=function(b){return"0x"+parseInt(b,10).toString(16)},o=t.__fontmetrics__.compress=function(b){var v,S,E,P,k=["{"];for(var L in b){if(v=b[L],isNaN(parseInt(L,10))?S="'"+L+"'":(L=parseInt(L,10),S=(S=s(L).slice(2)).slice(0,-1)+i[S.slice(-1)]),typeof v=="number")v<0?(E=s(v).slice(3),P="-"):(E=s(v).slice(2),P=""),E=P+E.slice(0,-1)+i[E.slice(-1)];else{if(ao(v)!=="object")throw new Error("Don't know what to do with value type "+ao(v)+".");E=o(v)}k.push(S+E)}return k.push("}"),k.join("")},u=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,S,E,P,k={},L=1,N=k,M=[],z="",B="",q=b.length-1,W=1;W<q;W+=1)(P=b[W])=="'"?v?(E=v.join(""),v=void 0):v=[]:v?v.push(P):P=="{"?(M.push([N,E]),N={},E=void 0):P=="}"?((S=M.pop())[0][S[1]]=N,E=void 0,N=S[0]):P=="-"?L=-1:E===void 0?n.hasOwnProperty(P)?(z+=n[P],E=parseInt(z,16)*L,L=1,z=""):z+=P:n.hasOwnProperty(P)?(B+=n[P],N[E]=parseInt(B,16)*L,L=1,E=void 0,B=""):B+=P;return k},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},d={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var v=b.font,S=d.Unicode[v.postScriptName];S&&(v.metadata.Unicode={},v.metadata.Unicode.widths=S.widths,v.metadata.Unicode.kerning=S.kerning);var E=f.Unicode[v.postScriptName];E&&(v.metadata.Unicode.encoding=E,v.encoding=E.codePages[0])}])})(hi.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(fw(o)),s.metadata=t.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])})(hi),hi.API.addSvgAsImage=function(t,e,r,n,i,a,s,o){if(isNaN(e)||isNaN(r))throw ko.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw ko.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=n,u.height=i;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Ni.canvg?Promise.resolve(Ni.canvg):e3(()=>import("./index.es-CXmEimrv.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(h,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(f)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),e,r,n,i,s,o)})},hi.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},hi.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),u=[],h=0,f=0,d=0;function b(S,E){var P,k=!1;for(P=0;P<S.length;P+=1)S[P]===E&&(k=!0);return k}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var v=o.length;for(d=0;d<v;d+=1)r[o[d]].value=r[o[d]].defaultValue,r[o[d]].explicitSet=!1}if(ao(t)==="object"){for(i in t)if(a=t[i],b(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&b(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(h=0;h<a.length;h+=1)if(n=!0,a[h].length===1&&typeof a[h][0]=="number")u.push(String(a[h]-1));else if(a[h].length>1){for(f=0;f<a[h].length;f+=1)typeof a[h][f]!="number"&&(n=!1);n===!0&&u.push([a[h][0]-1,a[h][1]-1].join(" "))}r[i].value="["+u.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,E=[];for(S in r)r[S].explicitSet===!0&&(r[S].type==="name"?E.push("/"+S+" /"+r[S].value):E.push("/"+S+" "+r[S].value));E.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+E.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),h=a.length+s.length+o.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(hi.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,s){for(var o,u=s.metadata.Unicode.widths,h=["","0","00","000","0000"],f=[""],d=0,b=a.length;d<b;++d){if(o=s.metadata.characterToGlyph(a.charCodeAt(d)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(d),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(h[4-o.length],o)}return f.join("")},n=function(a){var s,o,u,h,f,d,b;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],d=0,b=(o=Object.keys(a).sort(function(v,S){return v-S})).length;d<b;d++)s=o[d],u.length>=100&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(h=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+h+">"));return u.length&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(s){var o=s.font,u=s.out,h=s.newObject,f=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,b=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),v="",S=0;S<b.length;S++)v+=String.fromCharCode(b[S]);var E=h();f({data:v,addLength1:!0,objectId:E}),u("endobj");var P=h();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:P}),u("endobj");var k=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Ky(o.fontName)),u("/FontFile2 "+E+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var L=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+Ky(o.fontName)),u("/FontDescriptor "+k+" 0 R"),u("/W "+t.API.PDFObject.convert(d)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+P+" 0 R"),u("/BaseFont /"+Ky(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+L+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(s){var o=s.font,u=s.out,h=s.newObject,f=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,b="",v=0;v<d.length;v++)b+=String.fromCharCode(d[v]);var S=h();f({data:b,addLength1:!0,objectId:S}),u("endobj");var E=h();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var P=h();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+S+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+Ky(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=h();for(var k=0;k<o.metadata.hmtx.widths.length;k++)o.metadata.hmtx.widths[k]=parseInt(o.metadata.hmtx.widths[k]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+E+" 0 R/BaseFont/"+Ky(o.fontName)+"/FontDescriptor "+P+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",u=a.x,h=a.y,f=a.options||{},d=a.mutex||{},b=d.pdfEscape,v=d.activeFontKey,S=d.fonts,E=v,P="",k=0,L="",N=S[E].encoding;if(S[E].encoding!=="Identity-H")return{text:o,x:u,y:h,options:f,mutex:d};for(L=o,E=v,Array.isArray(o)&&(L=o[0]),k=0;k<L.length;k+=1)S[E].metadata.hasOwnProperty("cmap")&&(s=S[E].metadata.cmap.unicode.codeMap[L[k].charCodeAt(0)]),s||L[k].charCodeAt(0)<256&&S[E].metadata.hasOwnProperty("Unicode")?P+=L[k]:P+="";var M="";return parseInt(E.slice(1))<14||N==="WinAnsiEncoding"?M=b(P,E).split("").map(function(z){return z.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(M=r(P,S[E])),d.isHex=!0,{text:M,x:u,y:h,options:f,mutex:d}};e.events.push(["postProcessText",function(a){var s=a.text||"",o=[],u={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var h=0;for(h=0;h<s.length;h+=1)Array.isArray(s[h])&&s[h].length===3?o.push([i(Object.assign({},u,{text:s[h][0]})).text,s[h][1],s[h][2]]):o.push(i(Object.assign({},u,{text:s[h]})).text);a.text=o}else a.text=i(Object.assign({},u,{text:s})).text}])})(hi),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(hi.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,s,o,u,h,f,d=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},E={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},P=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],k=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),L=!1,N=0;this.__bidiEngine__={};var M=function(J){var H=J.charCodeAt(),ne=H>>8,ae=E[ne];return ae!==void 0?d[256*ae+(255&H)]:ne===252||ne===253?"AL":k.test(ne)?"L":ne===8?"R":"N"},z=function(J){for(var H,ne=0;ne<J.length;ne++){if((H=M(J.charAt(ne)))==="L")return!1;if(H==="R")return!0}return!1},B=function(J,H,ne,ae){var ue,de,Pe,me,Ee=H[ae];switch(Ee){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":L=!1;break;case"N":case"AN":break;case"EN":L&&(Ee="AN");break;case"AL":L=!0,Ee="R";break;case"WS":case"BN":Ee="N";break;case"CS":ae<1||ae+1>=H.length||(ue=ne[ae-1])!=="EN"&&ue!=="AN"||(de=H[ae+1])!=="EN"&&de!=="AN"?Ee="N":L&&(de="AN"),Ee=de===ue?de:"N";break;case"ES":Ee=(ue=ae>0?ne[ae-1]:"B")==="EN"&&ae+1<H.length&&H[ae+1]==="EN"?"EN":"N";break;case"ET":if(ae>0&&ne[ae-1]==="EN"){Ee="EN";break}if(L){Ee="N";break}for(Pe=ae+1,me=H.length;Pe<me&&H[Pe]==="ET";)Pe++;Ee=Pe<me&&H[Pe]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(me=H.length,Pe=ae+1;Pe<me&&H[Pe]==="NSM";)Pe++;if(Pe<me){var we=J[ae],Ae=we>=1425&&we<=2303||we===64286;if(ue=H[Pe],Ae&&(ue==="R"||ue==="AL")){Ee="R";break}}}Ee=ae<1||(ue=H[ae-1])==="B"?"N":ne[ae-1];break;case"B":L=!1,i=!0,Ee=N;break;case"S":a=!0,Ee="N"}return Ee},q=function(J,H,ne){var ae=J.split("");return ne&&W(ae,ne,{hiLevel:N}),ae.reverse(),H&&H.reverse(),ae.join("")},W=function(J,H,ne){var ae,ue,de,Pe,me,Ee=-1,we=J.length,Ae=0,ce=[],xe=N?v:b,_e=[];for(L=!1,i=!1,a=!1,ue=0;ue<we;ue++)_e[ue]=M(J[ue]);for(de=0;de<we;de++){if(me=Ae,ce[de]=B(J,_e,ce,de),ae=240&(Ae=xe[me][S[ce[de]]]),Ae&=15,H[de]=Pe=xe[Ae][5],ae>0)if(ae===16){for(ue=Ee;ue<de;ue++)H[ue]=1;Ee=-1}else Ee=-1;if(xe[Ae][6])Ee===-1&&(Ee=de);else if(Ee>-1){for(ue=Ee;ue<de;ue++)H[ue]=Pe;Ee=-1}_e[de]==="B"&&(H[de]=0),ne.hiLevel|=Pe}a&&(function(Me,Re,He){for(var Fe=0;Fe<He;Fe++)if(Me[Fe]==="S"){Re[Fe]=N;for(var tt=Fe-1;tt>=0&&Me[tt]==="WS";tt--)Re[tt]=N}})(_e,H,we)},G=function(J,H,ne,ae,ue){if(!(ue.hiLevel<J)){if(J===1&&N===1&&!i)return H.reverse(),void(ne&&ne.reverse());for(var de,Pe,me,Ee,we=H.length,Ae=0;Ae<we;){if(ae[Ae]>=J){for(me=Ae+1;me<we&&ae[me]>=J;)me++;for(Ee=Ae,Pe=me-1;Ee<Pe;Ee++,Pe--)de=H[Ee],H[Ee]=H[Pe],H[Pe]=de,ne&&(de=ne[Ee],ne[Ee]=ne[Pe],ne[Pe]=de);Ae=me}Ae++}}},ie=function(J,H,ne){var ae=J.split(""),ue={hiLevel:N};return ne||(ne=[]),W(ae,ne,ue),(function(de,Pe,me){if(me.hiLevel!==0&&f)for(var Ee,we=0;we<de.length;we++)Pe[we]===1&&(Ee=P.indexOf(de[we]))>=0&&(de[we]=P[Ee+1])})(ae,ne,ue),G(2,ae,H,ne,ue),G(1,ae,H,ne,ue),ae.join("")};return this.__bidiEngine__.doBidiReorder=function(J,H,ne){if((function(ue,de){if(de)for(var Pe=0;Pe<ue.length;Pe++)de[Pe]=Pe;o===void 0&&(o=z(ue)),h===void 0&&(h=z(ue))})(J,H),s||!u||h)if(s&&u&&o^h)N=o?1:0,J=q(J,H,ne);else if(!s&&u&&h)N=o?1:0,J=ie(J,H,ne),J=q(J,H);else if(!s||o||u||h){if(s&&!u&&o^h)J=q(J,H),o?(N=0,J=ie(J,H,ne)):(N=1,J=ie(J,H,ne),J=q(J,H));else if(s&&o&&!u&&h)N=1,J=ie(J,H,ne),J=q(J,H);else if(!s&&!u&&o^h){var ae=f;o?(N=1,J=ie(J,H,ne),N=0,f=!1,J=ie(J,H,ne),f=ae):(N=0,J=ie(J,H,ne),J=q(J,H),N=1,f=!1,J=ie(J,H,ne),f=ae,J=q(J,H))}}else N=0,J=ie(J,H,ne);else N=o?1:0,J=ie(J,H,ne);return J},this.__bidiEngine__.setOptions=function(J){J&&(s=J.isInputVisual,u=J.isOutputVisual,o=J.isInputRtl,h=J.isOutputRtl,f=J.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(hi),hi.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Jp(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Cve(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new fve(this.contents),this.head=new pve(this),this.name=new _ve(this),this.cmap=new FX(this),this.toUnicode={},this.hhea=new gve(this),this.maxp=new bve(this),this.hmtx=new xve(this),this.post=new yve(this),this.os2=new mve(this),this.loca=new Tve(this),this.glyf=new wve(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,u,h;for(h=[],s=0,o=(u=this.bbox).length;s<o;s++)e=u[s],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,s,o;for(s=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var pf,Jp=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,s,o,u;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^u)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+u},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),fve=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,s,o,u,h,f,d,b,v,S,E;for(E in v=Object.keys(r).length,u=Math.log(2),d=16*Math.floor(Math.log(v)/u),s=Math.floor(d/u),f=16*v-d,(i=new Jp).writeInt(this.scalarType),i.writeShort(v),i.writeShort(d),i.writeShort(s),i.writeShort(f),a=16*v,h=i.pos+a,o=null,S=[],r)for(b=r[E],i.writeString(E),i.writeInt(t(b)),i.writeInt(h),i.writeInt(b.length),S=S.concat(b),E==="head"&&(o=h),h+=b.length;h%4;)S.push(0),h++;return i.write(S),n=2981146554-t(i.data),i.pos=o+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,s;for(r=BX.call(r);r.length%4;)r.push(0);for(a=new Jp(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),dve={}.hasOwnProperty,sd=function(t,e){for(var r in e)dve.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};pf=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var pve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Jp).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),GB=(function(){function t(e,r){var n,i,a,s,o,u,h,f,d,b,v,S,E,P,k,L,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(v=e.readUInt16(),b=v/2,e.pos+=6,a=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),e.pos+=2,E=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),h=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),f=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),i=(this.length-e.pos+this.offset)/2,o=(function(){var M,z;for(z=[],u=M=0;0<=i?M<i:M>i;u=0<=i?++M:--M)z.push(e.readUInt16());return z})(),u=k=0,N=a.length;k<N;u=++k)for(P=a[u],n=L=S=E[u];S<=P?L<=P:L>=P;n=S<=P?++L:--L)f[u]===0?s=n+h[u]:(s=o[f[u]/2+(n-S)-(b-u)]||0)!==0&&(s+=h[u]),this.codeMap[n]=65535&s}e.pos=d}return t.encode=function(e,r){var n,i,a,s,o,u,h,f,d,b,v,S,E,P,k,L,N,M,z,B,q,W,G,ie,J,H,ne,ae,ue,de,Pe,me,Ee,we,Ae,ce,xe,_e,Me,Re,He,Fe,tt,Ze,Qe,Ie;switch(ae=new Jp,s=Object.keys(e).sort(function(Lt,at){return Lt-at}),r){case"macroman":for(E=0,P=(function(){var Lt=[];for(S=0;S<256;++S)Lt.push(0);return Lt})(),L={0:0},a={},ue=0,Ee=s.length;ue<Ee;ue++)L[tt=e[i=s[ue]]]==null&&(L[tt]=++E),a[i]={old:e[i],new:L[e[i]]},P[i]=L[e[i]];return ae.writeUInt16(1),ae.writeUInt16(0),ae.writeUInt32(12),ae.writeUInt16(0),ae.writeUInt16(262),ae.writeUInt16(0),ae.write(P),{charMap:a,subtable:ae.data,maxGlyphID:E+1};case"unicode":for(H=[],d=[],N=0,L={},n={},k=h=null,de=0,we=s.length;de<we;de++)L[z=e[i=s[de]]]==null&&(L[z]=++N),n[i]={old:z,new:L[z]},o=L[z]-i,k!=null&&o===h||(k&&d.push(k),H.push(i),h=o),k=i;for(k&&d.push(k),d.push(65535),H.push(65535),ie=2*(G=H.length),W=2*Math.pow(Math.log(G)/Math.LN2,2),b=Math.log(W/2)/Math.LN2,q=2*G-W,u=[],B=[],v=[],S=Pe=0,Ae=H.length;Pe<Ae;S=++Pe){if(J=H[S],f=d[S],J===65535){u.push(0),B.push(0);break}if(J-(ne=n[J].new)>=32768)for(u.push(0),B.push(2*(v.length+G-S)),i=me=J;J<=f?me<=f:me>=f;i=J<=f?++me:--me)v.push(n[i].new);else u.push(ne-J),B.push(0)}for(ae.writeUInt16(3),ae.writeUInt16(1),ae.writeUInt32(12),ae.writeUInt16(4),ae.writeUInt16(16+8*G+2*v.length),ae.writeUInt16(0),ae.writeUInt16(ie),ae.writeUInt16(W),ae.writeUInt16(b),ae.writeUInt16(q),He=0,ce=d.length;He<ce;He++)i=d[He],ae.writeUInt16(i);for(ae.writeUInt16(0),Fe=0,xe=H.length;Fe<xe;Fe++)i=H[Fe],ae.writeUInt16(i);for(Ze=0,_e=u.length;Ze<_e;Ze++)o=u[Ze],ae.writeUInt16(o);for(Qe=0,Me=B.length;Qe<Me;Qe++)M=B[Qe],ae.writeUInt16(M);for(Ie=0,Re=v.length;Ie<Re;Ie++)E=v[Ie],ae.writeUInt16(E);return{charMap:n,subtable:ae.data,maxGlyphID:N+1}}},t})(),FX=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new GB(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=GB.encode(e,r),(i=new Jp).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),gve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),mve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),yve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var s,o,u;for(u=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)u.push(e.readUInt32());return u}).call(this)}},t})(),vve=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},_ve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,s,o,u,h,f,d,b;for(e.pos=this.offset,e.readShort(),r=e.readShort(),o=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(u={},a=f=0,d=n.length;f<d;a=++f)i=n[a],e.pos=i.offset,h=e.readString(i.length),s=new vve(h,i),u[b=i.nameID]==null&&(u[b]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),bve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),xve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,s,o,u;for(e.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,f;for(f=[],r=h=0;0<=i?h<i:h>i;r=0<=i?++h:--h)f.push(e.readInt16());return f})(),this.widths=(function(){var h,f,d,b;for(b=[],h=0,f=(d=this.metrics).length;h<f;h++)a=d[h],b.push(a.advance);return b}).call(this),n=this.widths[this.widths.length-1],u=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)u.push(this.widths.push(n));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),BX=[].slice,wve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,s,o,u,h,f,d;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,s=(o=new Jp(r.read(i))).readShort(),h=o.readShort(),d=o.readShort(),u=o.readShort(),f=o.readShort(),this.cache[e]=s===-1?new Eve(o,h,d,u,f):new Sve(o,s,h,d,u,f),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,s,o,u;for(s=[],a=[],o=0,u=r.length;o<u;o++)i=e[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},t})(),Sve=(function(){function t(e,r,n,i,a,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),Eve=(function(){function t(e,r,n,i,a){var s,o;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Jp(BX.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),Tve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return sd(t,pf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],u=this.offsets[s+1]-o;u>0&&(i+=u)}for(var h=new Array(4*n.length),f=0;f<n.length;++f)h[4*f+3]=255&n[f],h[4*f+2]=(65280&n[f])>>8,h[4*f+1]=(16711680&n[f])>>16,h[4*f]=(4278190080&n[f])>>24;return h},t})(),Cve=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,s,o,u;for(i={},s=0,o=e.length;s<o;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in u=this.glyphsFor(r))n=u[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,s,o,u,h,f,d,b,v,S,E,P,k;for(i in n=FX.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),v={0:0},k=n.charMap)v[(u=k[i]).old]=u.new;for(S in b=n.maxGlyphID,s)S in v||(v[S]=b++);return f=(function(L){var N,M;for(N in M={},L)M[L[N]]=N;return M})(v),d=Object.keys(f).sort(function(L,N){return L-N}),E=(function(){var L,N,M;for(M=[],L=0,N=d.length;L<N;L++)o=d[L],M.push(f[o]);return M})(),a=this.font.glyf.encode(s,E,v),h=this.font.loca.encode(a.offsets,E),P={cmap:this.font.cmap.raw(),glyf:a.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(P["OS/2"]=this.font.os2.raw()),this.font.directory.encode(P)},t})();hi.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+(function(){var o,u,h;for(h=[],o=0,u=r.length;o<u;o++)n=r[o],h.push(e.convert(n));return h})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+e.convert(s));return a.push(">>"),a.join(`
`)}return""+r},e})();const Ave=t=>{const e=t.width,r=t.height,n=document.createElement("div");n.className="hidden-map",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",document.body.appendChild(n);const i=document.createElement("div");i.style.width=e+"px",i.style.height=r+"px",n.appendChild(i);const a=t.map.map.getStyle();for(const u in a.sources){const h=a.sources[u];Object.keys(h).forEach(f=>{h[f]||delete h[f]})}const s=new ME.Map({container:i,center:t.map.map.getCenter(),zoom:t.map.map.getZoom(),bearing:0,pitch:0,interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,style:a}),o=s._cameraForBoxAndBearing([t.bboxUnrotated[0],t.bboxUnrotated[1]],[t.bboxUnrotated[2],t.bboxUnrotated[3]],t.bearing+t.map.map.getBearing());return s._fitInternal(o),new Promise(u=>{console.log("before idle"),s.once("idle",function(){const h={...t,renderMap:s,hiddenContainer:n,createPdf:f=>Ive({...t,renderMap:s,hiddenContainer:n,...f}),createPng:f=>kve({...t,renderMap:s,hiddenContainer:n,...f})};u(h)})})};function Ive(t){const e=new hi({orientation:t?.orientation==="portrait"?"p":"l",unit:"mm",compress:!0,format:t.format});return Object.defineProperty(window,"devicePixelRatio",{get:function(){return 300/96}}),new Promise(r=>{e.addImage(t.renderMap.getCanvas().toDataURL("image/png"),"png",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),void 0,"FAST"),t.renderMap.remove(),t.hiddenContainer.parentNode?.removeChild(t.hiddenContainer);const n={...t,pdf:e,downloadPdf:i=>Pve({...n,...i}),formData:new FormData};r(n)})}function Pve(t){return t.pdf.save("Map.pdf"),new Promise(function(e){e({...t})})}function kve(t){return new Promise(e=>{const r=t.renderMap.getCanvas().toDataURL("image/png"),n={...t,png:r,downloadPng:i=>Mve({...n,...i})};e(n)})}function Mve(t){const e=document.createElement("a");return e.download=t?.name?t.name+".png":"map.png",e.href=t.png,document.body.appendChild(e),e.click(),document.body.removeChild(e),new Promise(function(r){r({...t})})}function zX(t){const e=pa({mapId:t.mapId});return{createExport:ee.useMemo(()=>{if(e.map)return n=>Ave({map:e.map,...n})},[e.map])}}const XB=t=>{const e=pa({mapId:t.mapId}),r=zX({mapId:t.mapId}),[n,i]=ht.useState(!1);return Z.jsx(Z.Fragment,{children:Z.jsx(ra,{color:"primary",variant:"contained",onClick:()=>{if(e.map&&r?.createExport){i(!0);const a=e.map.getBounds(),s=[a.getWest(),a.getSouth(),a.getEast(),a.getNorth()];r.createExport({width:595*1.4,height:842*1.4,bbox:s,bboxUnrotated:s,bearing:e.map.getBearing(),format:"a4",orientation:"portrait",...t.exportOptions}).then(o=>o.createPdf()).then(o=>(i(!1),o.downloadPdf())).catch(o=>{console.log(o),i(!1)})}},children:n?Z.jsx(KE,{size:24,sx:{color:"#fff"}}):Z.jsx(Bge,{})})})};try{XB.displayName="MlCreatePdfButton",XB.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).",displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:null,description:"ID of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},exportOptions:{defaultValue:null,description:"Option overrides for the createExport function",name:"exportOptions",required:!1,type:{name:"createExportOptions | undefined"}}}}}catch{}const bv={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}},jX=ht.createContext({}),Rve=bv.A4["72dpi"],ek=({children:t})=>{const[e,r]=ee.useState("A4"),[n,i]=ee.useState("72dpi"),[a,s]=ee.useState({center:void 0,scale:void 0,rotate:0,width:210,height:297,orientation:"portrait",fixedScale:0}),o=ee.useRef(null),u=ee.useMemo(()=>typeof bv[e][n]<"u"?a.orientation==="portrait"?bv[e][n]:{width:bv[e][n].height,height:bv[e][n].width}:Rve,[e,n,a.orientation]),h={options:a,setOptions:s,format:e,setFormat:r,quality:n,setQuality:i,geojsonRef:o,template:u};return Z.jsx(jX.Provider,{value:h,children:t})};try{ek.displayName="PdfContextProvider",ek.__docgenInfo={description:"",displayName:"PdfContextProvider",props:{}}}catch{}function mO(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function UX(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function VX(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function yO(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function Ove(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function Nve(t,e){var r=yO("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function tk(t){return t.replace(/_/g,".")}function Z_(t,e){var r=null,n="-1";return mO(t,function(i){var a=yO("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=Nve(i.versionTest.toLowerCase(),e)||n),n=tk(n),!0)}),{preset:r,version:n}}function u2(t,e){var r={brand:"",version:"-1"};return mO(t,function(n){var i=$X(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function $X(t,e){return UX(t,function(r){var n=r.brand;return yO(""+e.test,n.toLowerCase())})}var qX=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],HX=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],rk=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],WX=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],GX=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function XX(t){return!!Z_(WX,t).preset}function Lve(t){var e=VX(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:XX(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=Z_(qX,e),s=a.preset,o=a.version,u=Z_(GX,e),h=u.preset,f=u.version,d=Z_(HX,e);if(n.chromium=!!d.preset,n.chromiumVersion=d.version,!n.chromium){var b=Z_(rk,e);n.webkit=!!b.preset,n.webkitVersion=b.version}return h&&(i.name=h.id,i.version=f,i.majorVersion=parseInt(f,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function Dve(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!u2(WX,r).brand||XX(VX())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&mO(rk,function(b){return $X(r,b)});var u=u2(HX,r);if(s.chromium=!!u.brand,s.chromiumVersion=u.version||"-1",!s.chromium){var h=u2(rk,r);s.webkit=!!h.brand,s.webkitVersion=h.version||"-1"}var f=UX(GX,function(b){return new RegExp(""+b.test,"g").exec(a)});o.name=f?f.id:"";{var d=u2(qX,r);s.name=d.brand||s.name,s.version=d.brand&&t?t.uaFullVersion:d.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=tk(o.version),s.version=tk(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function Fve(t){return Ove()?Dve():Lve(t)}function Bve(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function zve(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function om(t,e){return function(r){r&&(t[e]=r)}}function YX(t,e,r){return function(n){n&&(t[e][r]=n)}}function jve(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var h=(s=this[n])[i].apply(s,o);return h===this[n]?this:h})})}}var Uve="function",Vve="object",$ve="string",qve="number",vO="undefined",ZX=typeof window!==vO,Hve=typeof document!==vO&&document,Wve=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],yl=1e-7,c2={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Gve(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function tS(t,e,r,n){return(t*n+e*r)/(r+n)}function _O(t){return typeof t===vO}function sf(t){return t&&typeof t===Vve}function ru(t){return Array.isArray(t)}function rp(t){return typeof t===$ve}function rb(t){return typeof t===qve}function bO(t){return typeof t===Uve}function Xve(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function KX(t,e,r,n,i){var a=xO(t,e,r);return a?r:Yve(t,e,r+1,n,i)}function xO(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function Yve(t,e,r,n,i){for(var a=function(h){var f=e[h].trim();if(f===t.close&&!xO(t,e,h))return{value:h};var d=h,b=nh(i,function(v){var S=v.open;return S===f});if(b&&(d=KX(b,e,h,n,i)),d===-1)return s=h,"break";h=d,s=h},s,o=r;o<n;++o){var u=a(o);if(o=s,typeof u=="object")return u.value;if(u==="break")break}return-1}function wO(t,e){var r=rp(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,u=o===void 0?s:o,h=r.openCloseCharacters,f=h===void 0?Wve:h,d=f.map(function(q){var W=q.open,G=q.close;return W===G?W:W+"|"+G}).join("|"),b="(\\s*"+i+"\\s*|"+d+"|\\s+)",v=new RegExp(b,"g"),S=t.split(v).filter(function(q){return q&&q!=="undefined"}),E=S.length,P=[],k=[];function L(){return k.length?(P.push(k.join("")),k=[],!0):!1}for(var N=function(q){var W=S[q].trim(),G=q,ie=nh(f,function(ne){var ae=ne.open;return ae===W}),J=nh(f,function(ne){var ae=ne.close;return ae===W});if(ie){if(G=KX(ie,S,q,E,f),G!==-1&&u)return L()&&a||(P.push(S.slice(q,G+1).join("")),q=G,a)?(M=q,"break"):(M=q,"continue")}else if(J&&!xO(J,S,q)){var H=Gve(f);return H.splice(f.indexOf(J),1),{value:wO(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:u,openCloseCharacters:H})}}else if(Xve(W,i)&&!s)return L(),a?(M=q,"break"):(M=q,"continue");G===-1&&(G=E-1),k.push(S.slice(q,G+1).join("")),q=G,M=q},M,z=0;z<E;++z){var B=N(z);if(z=M,typeof B=="object")return B.value;if(B==="break")break}return k.length&&P.push(k.join("")),P}function Qp(t){return wO(t,"")}function Kg(t){return wO(t,",")}function JX(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Yb(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function Zve(t,e){return t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function nb(){return Date.now?Date.now():new Date().getTime()}function Yd(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function nh(t,e,r){var n=Yd(t,e);return n>-1?t[n]:r}var QX=(function(){var t=nb(),e=ZX&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=nb(),i=setTimeout(function(){r(n-t)},1e3/60);return i}})(),Kve=(function(){var t=ZX&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function k0(t){return Object.keys(t)}function bo(t,e){var r=Yb(t),n=r.value,i=r.unit;if(sf(e)){var a=e[i];if(a){if(bO(a))return a(n);if(c2[i])return c2[i](n,a)}}else if(i==="%")return n*e/100;return c2[i]?c2[i](n):n}function nk(t,e,r){return Math.max(e,Math.min(t,r))}function YB(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[Fi(e[0],yl),Fi(e[0]/n,yl)],[Fi(e[1]*n,yl),Fi(e[1],yl)]].filter(function(i){return i.every(function(a,s){var o=e[s],u=Fi(o,yl);return r?a<=o||a<=u:a>=o||a>=u})})[0]||t}function eY(t,e,r,n){if(!n)return t.map(function(v,S){return nk(v,e[S],r[S])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=YB(t,e,!1,s),u=o[0],h=o[1],f=YB(t,r,!0,s),d=f[0],b=f[1];return i<u||a<h?(i=u,a=h):(i>d||a>b)&&(i=d,a=b),[i,a]}function Jve(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function ik(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function Ws(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function Qve(t){return[0,1].map(function(e){return ik(t.map(function(r){return r[e]}))})}function ZB(t){var e=Qve(t),r=Ws(e,t[0]),n=Ws(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function Ud(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Fi(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function KB(t,e){return t.forEach(function(r,n){t[n]=Fi(t[n],e)}),t}function e0e(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function t0e(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Dl(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function tY(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function rY(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Bu(t,e,r,n){t.addEventListener(e,r,n)}function fu(t,e,r,n){t.removeEventListener(e,r,n)}function SO(t){return t?.ownerDocument||Hve}function EO(t){return SO(t).documentElement}function hg(t){return SO(t).body}function Wp(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function nY(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function TO(t){return sf(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function r0e(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,u=n+s*i;t[o]+=t[u]*a,e[o]+=e[u]*a}}function n0e(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,u=t[s],h=e[s];t[s]=t[o],t[o]=u,e[s]=e[o],e[o]=h}}function i0e(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function iY(t,e,r){for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function td(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=Wo(e),i=0;i<e;++i){var a=e*i+i;if(!Fi(r[a],yl)){for(var s=i+1;s<e;++s)if(r[e*i+s]){n0e(r,n,i,s,e);break}}if(!Fi(r[a],yl))return[];i0e(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,u=s+i*e,h=r[u];!Fi(h,yl)||i===s||r0e(r,n,o,i,e,-h)}}return n}function a0e(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function aY(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function o0e(t,e){for(var r=Wo(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function vm(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function lf(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=Wo(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function rS(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Wo(t);return e.forEach(function(i){n=xo(n,i,t)}),n}function xo(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var u=0;u<i;++u)n[o*r+s]+=t[u*r+s]*e[o*i+u]}return n}function Ta(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function vi(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function s0e(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function oY(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Xu(t,e,r){r===void 0&&(r=e.length);var n=xo(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function l0e(t,e){return xo(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function u0e(t,e){return xo(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function c0e(t,e){return xo(t,Kb(e,4))}function h2(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return xo(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function Zb(t,e){return Xu(Kb(e,3),vm(t,3))}function $3(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return xo(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function JB(t,e){return xo(t,e,4)}function Kb(t,e){var r=Math.cos(t),n=Math.sin(t),i=Wo(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function Wo(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function CO(t,e){for(var r=Wo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function _m(t,e){for(var r=Wo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function AO(t,e,r,n,i,a,s,o){var u=t[0],h=t[1],f=e[0],d=e[1],b=r[0],v=r[1],S=n[0],E=n[1],P=i[0],k=i[1],L=a[0],N=a[1],M=s[0],z=s[1],B=o[0],q=o[1],W=[u,0,f,0,b,0,S,0,h,0,d,0,v,0,E,0,1,0,1,0,1,0,1,0,0,u,0,f,0,b,0,S,0,h,0,d,0,v,0,E,0,1,0,1,0,1,0,1,-P*u,-k*u,-L*f,-N*f,-M*b,-z*b,-B*S,-q*S,-P*h,-k*h,-L*d,-N*d,-M*v,-z*v,-B*E,-q*E],G=td(W,8);if(!G.length)return[];var ie=xo(G,[P,k,L,N,M,z,B,q],8);return ie[8]=1,lf(a0e(ie),3,4)}var C1=function(){return C1=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C1.apply(this,arguments)};function h0e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ib(t,e){return e===void 0&&(e=0),Jy(r0(t,e))}function f0e(t,e){var r=Xu(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Jy(t){var e=h0e();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function r0(t,e){e===void 0&&(e=0);var r=ru(t)?t:Qp(t);return r.map(function(n){var i=JX(n),a=i.prefix,s=i.value,o=null,u=a,h="";if(a==="translate"||a==="translateX"||a==="translate3d"){var f=sf(e)?C1(C1({},e),{"o%":e["%"]}):{"%":e,"o%":e},d=Kg(s).map(function(ne,ae){return ae===0&&"x%"in f?f["%"]=e["x%"]:ae===1&&"y%"in f?f["%"]=e["y%"]:f["%"]=e["o%"],bo(ne,f)}),b=d[0],v=d[1],S=v===void 0?0:v,E=d[2],P=E===void 0?0:E;o=$3,h=[b,S,P]}else if(a==="translateY"){var k=sf(e)?C1({"%":e["y%"]},e):{"%":e},S=bo(s,k);o=$3,h=[0,S,0]}else if(a==="translateZ"){var P=parseFloat(s);o=$3,h=[0,0,P]}else if(a==="scale"||a==="scale3d"){var L=Kg(s).map(function(ne){return parseFloat(ne)}),N=L[0],M=L[1],z=M===void 0?N:M,B=L[2],q=B===void 0?1:B;o=h2,h=[N,z,q]}else if(a==="scaleX"){var N=parseFloat(s);o=h2,h=[N,1,1]}else if(a==="scaleY"){var z=parseFloat(s);o=h2,h=[1,z,1]}else if(a==="scaleZ"){var q=parseFloat(s);o=h2,h=[1,1,q]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var W=Yb(s),G=W.unit,ie=W.value,J=G==="rad"?ie:ie*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",o=c0e):a==="rotateX"?o=l0e:a==="rotateY"&&(o=u0e),h=J}else if(a==="matrix3d")o=JB,h=Kg(s).map(function(ne){return parseFloat(ne)});else if(a==="matrix"){var H=Kg(s).map(function(ne){return parseFloat(ne)});o=JB,h=[H[0],H[1],0,0,H[2],H[3],0,0,0,0,1,0,H[4],H[5],0,1]}else u="";return{name:a,functionName:u,value:s,matrixFunction:o,functionValue:h}})}var d0e=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t})(),p0e=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t})(),g0e=typeof Map=="function",m0e=(function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t})();function y0e(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new m0e;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var u=r[s],h=n[o-1],f=u.getIndex();u.disconnect(),h?u.connect(h,h.next):u.connect(void 0,r[0]);var d=u.getIndex();return[f,d]})}var v0e=(function(){function t(r,n,i,a,s,o,u,h){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=u,this.fixed=h}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=y0e(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],u=a[1],h=n[s],f=h[0],d=h[1];if(o!==u)return i.push([f,d]),!0}),this.cachePureChanged=i},t})();function IO(t,e,r){var n=g0e?Map:r?p0e:d0e,i=r||function(L){return L},a=[],s=[],o=[],u=t.map(i),h=e.map(i),f=new n,d=new n,b=[],v=[],S={},E=[],P=0,k=0;return u.forEach(function(L,N){f.set(L,N)}),h.forEach(function(L,N){d.set(L,N)}),u.forEach(function(L,N){var M=d.get(L);typeof M>"u"?(++k,s.push(N)):S[M]=k}),h.forEach(function(L,N){var M=f.get(L);typeof M>"u"?(a.push(N),++P):(o.push([M,N]),k=S[N]||0,b.push([M-k,N-P]),v.push(N===M),M!==N&&E.push([M,N]))}),s.reverse(),new v0e(t,e,a,s,E,o,b,v)}var _0e=(function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=IO(this.list,n,this.findKeyCallback);return this.list=n,i},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ak=function(t,e){return ak=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ak(t,e)};function b0e(t,e){ak(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var sY=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),lY=(function(t){b0e(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,sY)||this}return e})(_0e);function x0e(t,e){return IO(t,e,sY)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ok=function(){return ok=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ok.apply(this,arguments)};function w0e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var PO=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(sf(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(sf(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Yd(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,w0e(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(ok({listener:n},i))},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sk=function(t,e){return sk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},sk(t,e)};function S0e(t,e){sk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xv=function(){return xv=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xv.apply(this,arguments)};function E0e(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function QB(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function f2(t){if(t){if(rp(t))return document.querySelector(t)}else return null;if(bO(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var T0e=(function(t){S0e(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=f2(i.container);if(!a){this._flag=!1;return}var s=0,o=0,u=0,h=0;if(a===document.body)u=window.innerWidth,h=window.innerHeight;else{var f=a.getBoundingClientRect();s=f.top,o=f.left,u=f.width,h=f.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:u,height:h},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,u=o===void 0?0:o,h=this,f=h._startRect,d=h._startPos;this._currentOptions=i;var b=[0,0];return f.top>s-u?(d[1]>f.top||s<d[1])&&(b[1]=-1):f.top+f.height<s+u&&(d[1]<f.top+f.height||s>d[1])&&(b[1]=1),f.left>a-u?(d[0]>f.left||a<d[0])&&(b[0]=-1):f.left+f.width<a+u&&(d[0]<f.left+f.width||a>d[0])&&(b[0]=1),!b[0]&&!b[1]?!1:this._continueDrag(xv(xv({},i),{direction:b,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,u=n.throttleTime,h=u===void 0?0:u,f=n.inputEvent,d=n.isDrag,b=this._getScrollPosition(o||[0,0],n),v=b[0]-s[0],S=b[1]-s[1],E=o||[v?Math.abs(v)/v:0,S?Math.abs(S)/S:0];return this._prevScrollPos=b,this._lock=!1,!v&&!S?!1:(this.emit("move",{offsetX:E[0]?v:0,offsetY:E[1]?S:0,inputEvent:f}),h&&d&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},h)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?E0e:s;return o({container:f2(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,u=n.throttleTime,h=n.useScroll,f=n.isDrag,d=n.inputEvent;if(!(!this._flag||f&&this._isWait)){var b=nb(),v=Math.max(u+this._prevTime-b,0);if(v>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},v),!1;this._prevTime=b;var S=this._getScrollPosition(o,n);this._prevScrollPos=S,f&&(this._isWait=!0),h||(this._lock=!0);var E={container:f2(s),direction:o,inputEvent:d};return(a=n.requestScroll)===null||a===void 0||a.call(n,E),this.emit("scroll",E),this._isWait=!1,h||this.checkScroll(xv(xv({},n),{prevScrollPos:S,direction:o,inputEvent:d}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?QB:i,s=f2(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=QB(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e})(PO);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function C0e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function xc(t){return Fi(t,yl)}function A0e(t,e){return t.every(function(r,n){return xc(r-e[n])===0})}function I0e(t,e){return!xc(t[0]-e[0])&&!xc(t[1]-e[1])}function uY(t){return t.length<3?0:Math.abs(Jve(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function ez(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=bm(t),o=s.minX,u=s.minY,h=s.maxX,f=s.maxY,d=r/(h-o),b=n/(f-u);return t.map(function(v){return[i+(v[0]-o)*d,a+(v[1]-u)*b]})}function bm(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function lk(t,e,r){var n=t[0],i=t[1],a=bm(e),s=a.minX,o=a.maxX,u=[[s,i],[o,i]],h=nS(u[0],u[1]),f=uk(e),d=[];if(f.forEach(function(S){var E=nS(S[0],S[1]),P=S[0];if(A0e(h,E))d.push({pos:t,line:S,type:"line"});else{var k=cY(kO(h,E),[u,S]);k.forEach(function(L){S.some(function(N){return I0e(N,L)})?d.push({pos:L,line:S,type:"point"}):xc(P[1]-i)!==0&&d.push({pos:L,line:S,type:"intersection"})})}}),nh(d,function(S){return S[0]===n}))return!0;var b=0,v={};return d.forEach(function(S){var E=S.pos,P=S.type,k=S.line;if(!(E[0]>n))if(P==="intersection")++b;else{if(P==="line")return;if(P==="point"){var L=nh(k,function(z){return z[1]!==i}),N=v[E[0]],M=L[1]>i?1:-1;N?N!==M&&++b:v[E[0]]=M}}}),b%2===1}function nS(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<yl&&(s=0),Math.abs(o)<yl&&(o=0);var u=0,h=0,f=0;return s?o?(u=-o/s,h=1,f=-u*r-n):(h=1,f=-n):o&&(u=-1,f=r),[u,h,f]}function kO(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=r===0&&a===0,h=n===0&&s===0,f=[];if(u&&h)return[];if(u){var d=-i/n,b=-o/s;return d!==b?[]:[[-1/0,d],[1/0,d]]}else if(h){var v=-i/r,S=-o/a;return v!==S?[]:[[v,-1/0],[v,1/0]]}else if(r===0){var E=-i/n,P=-(s*E+o)/a;f=[[P,E]]}else if(a===0){var E=-o/s,P=-(n*E+i)/r;f=[[P,E]]}else if(n===0){var P=-i/r,E=-(a*P+o)/s;f=[[P,E]]}else if(s===0){var P=-o/a,E=-(r*P+i)/n;f=[[P,E]]}else{var P=(n*o-s*i)/(s*r-n*a),E=-(r*P+i)/n;f=[[P,E]]}return f.map(function(k){return[k[0],k[1]]})}function cY(t,e){var r=e.map(function(d){return[0,1].map(function(b){return[Math.min(d[0][b],d[1][b]),Math.max(d[0][b],d[1][b])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(xc(a-t[1][0])){if(!xc(s-t[1][1])){var h=Math.max.apply(Math,r.map(function(d){return d[0][0]})),f=Math.min.apply(Math,r.map(function(d){return d[0][1]}));if(xc(h-f)>0)return[];n=[[h,s],[f,s]]}}else{var o=Math.max.apply(Math,r.map(function(d){return d[1][0]})),u=Math.min.apply(Math,r.map(function(d){return d[1][1]}));if(xc(o-u)>0)return[];n=[[a,o],[a,u]]}}return n.length||(n=t.filter(function(d){var b=d[0],v=d[1];return r.every(function(S){return 0<=xc(b-S[0][0])&&0<=xc(S[0][1]-b)&&0<=xc(v-S[1][0])&&0<=xc(S[1][1]-v)})})),n.map(function(d){return[xc(d[0]),xc(d[1])]})}function uk(t){return C0e(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function P0e(t,e){var r=t.slice(),n=e.slice();ZB(r)===-1&&r.reverse(),ZB(n)===-1&&n.reverse();var i=uk(r),a=uk(n),s=i.map(function(f){return nS(f[0],f[1])}),o=a.map(function(f){return nS(f[0],f[1])}),u=[];s.forEach(function(f,d){var b=i[d],v=[];o.forEach(function(S,E){var P=kO(f,S),k=cY(P,[b,a[E]]);v.push.apply(v,k.map(function(L){return{index1:d,index2:E,pos:L,type:"intersection"}}))}),v.sort(function(S,E){return Ud(b[0],S.pos)-Ud(b[0],E.pos)}),u.push.apply(u,v),lk(b[1],n)&&u.push({index1:d,index2:-1,pos:b[1],type:"inside"})}),a.forEach(function(f,d){if(lk(f[1],r)){var b=!1,v=Yd(u,function(S){var E=S.index2;return E===d?(b=!0,!1):!!b});v===-1&&(b=!1,v=Yd(u,function(S){var E=S.index1,P=S.index2;return E===-1&&P+1===d?(b=!0,!1):!!b})),v===-1?u.push({index1:-1,index2:d,pos:f[1],type:"inside"}):u.splice(v,0,{index1:-1,index2:d,pos:f[1],type:"inside"})}});var h={};return u.filter(function(f){var d=f.pos,b=d[0]+"x"+d[1];return h[b]?!1:(h[b]=!0,!0)})}function k0e(t,e){var r=P0e(t,e);return r.map(function(n){var i=n.pos;return i})}function M0e(t,e){var r=k0e(t,e);return uY(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ck=function(t,e){return ck=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ck(t,e)};function R0e(t,e){ck(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var pl=function(){return pl=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pl.apply(this,arguments)};function O0e(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function q3(t){return O0e([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function N0e(t){return t.touches&&t.touches.length>=2}function d2(t){return t?t.touches?D0e(t.touches):[hY(t)]:[]}function L0e(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function tz(t,e,r){var n=r.length,i=A1(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,u=i.originalClientY,h=A1(e,n),f=h.clientX,d=h.clientY,b=A1(r,n),v=b.clientX,S=b.clientY,E=a-f,P=s-d,k=a-v,L=s-S;return{clientX:o,clientY:u,deltaX:E,deltaY:P,distX:k,distY:L}}function H3(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function D0e(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(hY(t[n]));return r}function hY(t){return{clientX:t.clientX,clientY:t.clientY}}function A1(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var W3=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),q3(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),q3(e)-q3(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=tz(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=tz([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=A1(e,this.length),i=A1(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),H3(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),H3(e)/H3(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t})(),rz=["textarea","input"],F0e=(function(t){R0e(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(b,v){if(v===void 0&&(v=!0),!(!i.flag&&b.cancelable===!1)){var S=b.type.indexOf("drag")>=-1;if(!(i.flag&&S)){i._isDragAPI=!0;var E=i.options,P=E.container,k=E.pinchOutside,L=E.preventWheelClick,N=E.preventRightClick,M=E.preventDefault,z=E.checkInput,B=E.dragFocusedInput,q=E.preventClickEventOnDragStart,W=E.preventClickEventOnDrag,G=E.preventClickEventByCondition,ie=i._useTouch,J=!i.flag;if(i._isSecondaryButton=b.which===3||b.button===2,L&&(b.which===2||b.button===1)||N&&(b.which===3||b.button===2))return i.stop(),!1;if(J){var H=i._window.document.activeElement,ne=b.target;if(ne){var ae=ne.tagName.toLowerCase(),ue=rz.indexOf(ae)>-1,de=ne.isContentEditable;if(ue||de){if(z||!B&&H===ne)return!1;if(H&&(H===ne||de&&H.isContentEditable&&H.contains(ne)))if(B)ne.blur();else return!1}else if((M||b.type==="touchstart")&&H){var Pe=H.tagName.toLowerCase();(H.isContentEditable||rz.indexOf(Pe)>-1)&&H.blur()}(q||W||G)&&Bu(i._window,"click",i._onClick,!0)}i.clientStores=[new W3(d2(b))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=v,i._dragFlag=!0,i._prevInputEvent=b,i.data={},i.doubleFlag=nb()-i.prevTime<200,i._isMouseEvent=L0e(b),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var me=i._preventMouseEvent||i.emit("dragStart",pl(pl({data:i.data,datas:i.data,inputEvent:b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:v,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){b.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));me===!1&&i.stop(),i._isMouseEvent&&i.flag&&M&&b.preventDefault()}if(!i.flag)return!1;var Ee=0;if(J?(i._attchDragEvent(),ie&&k&&(Ee=setTimeout(function(){Bu(P,"touchstart",i.onDragStart,{passive:!1})}))):ie&&k&&fu(P,"touchstart",i.onDragStart),i.flag&&N0e(b)){if(clearTimeout(Ee),J&&b.touches.length!==b.changedTouches.length)return;i.pinchFlag||i.onPinchStart(b)}}}},i.onDrag=function(b,v){if(i.flag){var S=i.options.preventDefault;!i._isMouseEvent&&S&&b.preventDefault(),i._prevInputEvent=b;var E=d2(b),P=i.moveClients(E,b,!1);if(i._dragFlag){if(i.pinchFlag||P.deltaX||P.deltaY){var k=i._preventMouseEvent||i.emit("drag",pl(pl({},P),{isScroll:!!v,inputEvent:b}));if(k===!1){i.stop();return}}i.pinchFlag&&i.onPinch(b,E)}i.getCurrentStore().getPosition(E,!0)}},i.onDragEnd=function(b){if(i.flag){var v=i.options,S=v.pinchOutside,E=v.container,P=v.preventClickEventOnDrag,k=v.preventClickEventOnDragStart,L=v.preventClickEventByCondition,N=i.isDrag;(P||k||L)&&requestAnimationFrame(function(){i._allowClickEvent()}),!L&&!k&&P&&!N&&i._allowClickEvent(),i._useTouch&&S&&fu(E,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(b);var M=b?.touches?d2(b):[],z=M.length;z===0||!i.options.keepDragging?i.flag=!1:i._addStore(new W3(M));var B=i._getPosition(),q=nb(),W=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||W?0:q,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",pl({data:i.data,datas:i.data,isDouble:W,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:b,isTrusted:i._isTrusted},B)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){fu(i._window,"click",i._onClick,!0)},i._onClick=function(b){i._allowClickEvent(),i._allowMouseEvent();var v=i.options.preventClickEventByCondition;v?.(b)||(b.stopPropagation(),b.preventDefault())},i._onContextMenu=function(b){var v=i.options;v.preventRightClick?i.onDragEnd(b):b.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=nY(s)?s:Wp(s),i.options=pl({checkInput:!1,container:s&&!("document"in s)?Wp(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,u=o.container,h=o.events,f=o.checkWindowBlur;if(i._useDrag=h.indexOf("drag")>-1,i._useTouch=h.indexOf("touch")>-1,i._useMouse=h.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(b){Bu(b,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(b){Bu(b,"mousedown",i.onDragStart),Bu(b,"mousemove",i._passCallback)}),Bu(u,"contextmenu",i._onContextMenu)),f&&Bu(Wp(),"blur",i.onBlur),i._useTouch){var d={passive:!1};a.forEach(function(b){Bu(b,"touchstart",i.onDragStart,d),Bu(b,"touchmove",i._passCallback,d)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(u){var h=u.clientX,f=u.clientY;return{clientX:h+i,clientY:f+a,originalClientX:h,originalClientY:f}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),pl(pl({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),fu(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){fu(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){fu(a,"mousedown",r.onDragStart)}),fu(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){fu(a,"touchstart",r.onDragStart)}),fu(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new W3(d2(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",pl(pl({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",pl(pl({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",pl(pl({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),pl(pl({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(h,f){var d=f.getPosition();return h.distX+=d.distX,h.distY+=d.distY,h},a),o=s.distX,u=s.distY;return pl(pl({},a),{distX:o,distY:u})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Bu(n,"dragover",this.onDrag,i),Bu(r,"dragend",this.onDragEnd)),this._useMouse&&(Bu(n,"mousemove",this.onDrag),Bu(r,"mouseup",this.onDragEnd)),this._useTouch&&(Bu(n,"touchmove",this.onDrag,i),Bu(r,"touchend",this.onDragEnd,i),Bu(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(fu(n,"dragover",this.onDrag),fu(r,"dragend",this.onDragEnd)),this._useMouse&&(fu(n,"mousemove",this.onDrag),fu(r,"mouseup",this.onDragEnd)),this._useTouch&&(fu(n,"touchstart",this.onDragStart),fu(n,"touchmove",this.onDrag),fu(r,"touchend",this.onDragEnd),fu(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(PO);function B0e(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var z0e=B0e;function j0e(t){return z0e(t).toString(36)}function U0e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function V0e(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?Kg(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function $0e(t,e,r,n,i){var a=SO(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=V0e(t,e,r),(i||a.head||a.body).appendChild(s),s}function q0e(t){var e="rCS"+j0e(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=U0e(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=$0e(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var hk=function(){return hk=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hk.apply(this,arguments)};function H0e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function fY(t,e){var r=q0e(e),n=r.className;return ee.forwardRef(function(i,a){var s=i.className,o=s===void 0?"":s;i.cspNonce;var u=H0e(i,["className","cspNonce"]),h=ee.useRef();return ee.useImperativeHandle(a,function(){return h.current},[]),ee.useEffect(function(){var f=r.inject(h.current,{nonce:i.cspNonce});return function(){f.destroy()}},[]),ee.createElement(t,hk({ref:h,"data-styled-id":n,className:"".concat(o," ").concat(n)},u))})}var fk=function(t,e){return fk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},fk(t,e)};function Jb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wt=function(){return Wt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wt.apply(this,arguments)};function W0e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function G0e(t,e,r,n){var i=arguments.length,a=i<3?e:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function X0e(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jt(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function bn(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function Qb(t,e){return Wt({events:[],props:[],name:t},e)}var Y0e=["n","w","s","e"],MO=["n","w","s","e","nw","ne","sw","se"];function Z0e(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function K0e(t){var e=Z0e(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var M0=Fve(),dY=M0.browser.webkit,pY=dY&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),gY=M0.browser.name,mY=parseInt(M0.browser.version,10),J0e=gY==="chrome",Q0e=M0.browser.chromium,e_e=parseInt(M0.browser.chromiumVersion,10)||0,t_e=J0e&&mY>=109||Q0e&&e_e>=109,r_e=gY==="firefox",n_e=parseInt(M0.browser.webkitVersion,10)>=612||mY>=15,RO="moveable-",i_e=MO.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),a_e=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(i_e,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(K0e(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(pY?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),o_e=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],dk=1e-4,uc=1e-7,p2=1e-9,pk=Math.pow(10,10),nz=-pk,s_e={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},OO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},yY={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},l_e=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function ex(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var u=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},h=u.originalDatas||u.datas,f=h[a]||(h[a]={});return Wt(Wt({},u),{isPinch:!!n,parentEvent:!0,datas:f,originalDatas:t.originalDatas})}var n0=(function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),Wt(Wt({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function Vv(t,e,r,n){var i=t.length===16,a=i?4:3,s=Vm(t,r,n,a),o=Jt(s,4),u=Jt(o[0],2),h=u[0],f=u[1],d=Jt(o[1],2),b=d[0],v=d[1],S=Jt(o[2],2),E=S[0],P=S[1],k=Jt(o[3],2),L=k[0],N=k[1],M=Jt(ys(t,e,a),2),z=M[0],B=M[1],q=Math.min(h,b,E,L),W=Math.min(f,v,P,N),G=Math.max(h,b,E,L),ie=Math.max(f,v,P,N);h=h-q||0,b=b-q||0,E=E-q||0,L=L-q||0,f=f-W||0,v=v-W||0,P=P-W||0,N=N-W||0,z=z-q||0,B=B-W||0;var J=t[0],H=t[a+1],ne=oc(J*H);return{left:q,top:W,right:G,bottom:ie,origin:[z,B],pos1:[h,f],pos2:[b,v],pos3:[E,P],pos4:[L,N],direction:ne}}function vY(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,u=a.is3d,h=a.pos1,f=s.left,d=s.top,b=u?4:3,v=Jt(vi(o0(o,[r-f,n-d],b),h),2),S=v[0],E=v[1],P=Jt(ld({datas:i,distX:S,distY:E}),2),k=P[0],L=P[1];return[k,L]}function Um(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,u=n.top,h=n.origin,f=n.offsetMatrix,d=n.targetMatrix,b=n.transformOrigin,v=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=d,r.beforeMatrix=a,r.offsetMatrix=f,r.transformOrigin=b,r.inverseMatrix=td(i,v),r.inverseBeforeMatrix=td(a,v),r.absoluteOrigin=vm(Ta([o,u],h),v),r.startDragBeforeDist=Xu(r.inverseBeforeMatrix,r.absoluteOrigin,v),r.startDragDist=Xu(r.inverseMatrix,r.absoluteOrigin,v)}function u_e(t){return Vv(t.datas.beforeTransform,[50,50],100,100).direction}function sT(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,u=i.nextTransformAppendedIndexes,h=-1;a===-1?(r==="translate"?h=0:r==="rotate"&&(h=Yd(s,function(v){return v.match(/scale\(/g)})),h===-1&&(h=s.length),n.transformIndex=h):nh(u,function(v){return v.index===a&&v.functionName===r})?h=a:h=a+u.filter(function(v){return v.index<a}).length;var f=L1e(s,t.state,h),d=f.targetFunction,b=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=f.beforeFunctionTexts,n.afterFunctionTexts=f.afterFunctionTexts,n.beforeTransform=f.beforeFunctionMatrix,n.beforeTransform2=f.beforeFunctionMatrix2,n.targetTansform=f.targetFunctionMatrix,n.afterTransform=f.afterFunctionMatrix,n.afterTransform2=f.afterFunctionMatrix2,n.targetAllTransform=f.allFunctionMatrix,d.functionName===b?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>h&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=bn(bn([],Jt(u),!1),[{functionName:r,index:h,isAppend:!0}],!1))}function lT(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function c_e(t){var e=t.datas,r=t.distX,n=t.distY,i=Jt(bY({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=_Y(e,o0e([a,s],4));return Xu(o,vm([0,0,0],4),4)}function _Y(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,u=r?xo(o,e,4):xo(e,o,4),h=xo(td(r?a:n,4),u,4),f=xo(h,td(r?s:i,4),4);return f}function bY(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,u=a?4:3;return vi(Xu(i,Ta(o,[r,n]),u),s)}function ld(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,u=r.startDragBeforeDist,h=r.startDragDist,f=r.absoluteOrigin,d=o?4:3;return vi(Xu(e?a:s,Ta(f,[n,i]),d),e?u:h)}function h_e(t,e){var r=t.datas,n=t.distX,i=t.distY;r.beforeMatrix;var a=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,u=r.absoluteOrigin,h=s?4:3;return vi(Xu(a,Ta(o,[n,i]),h),u)}function f_e(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var u=Yb(s),h=u.value,f=u.unit,d=o?i:n,b=o?r:e;if(s==="%"||isNaN(h)){var v=d?a[o]/d:0;return b*v}else if(f!=="%")return h;return b*h/100}):a}function xY(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function d_e(t,e){return xY(e).map(function(r){return t[r]})}function G3(t,e){var r=(e+1)/2;return[tS(t[0][0],t[1][0],r,1-r),tS(t[0][1],t[1][1],r,1-r)]}function Fl(t,e){var r=G3([t[0],t[1]],e[0]),n=G3([t[2],t[3]],e[0]);return G3([r,n],e[1])}function p_e(t,e,r,n,i,a){var s=Vm(e,r,n,i),o=Fl(s,a),u=t[0]-o[0],h=t[1]-o[1];return[u,h]}function tx(t,e,r,n){return xo(t,P1(e,n,r),n)}function g_e(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,u;if(rp(r)){var h=e.beforeTransform,f=e.afterTransform;n?u=lf(ib(r),4,o):u=lf(xo(xo(h,ib([r]),4),f,4),4,o)}else u=r;return tx(a,u,i,o)}function m_e(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return tx(n,xo(s||a,CO(e,o),o),r,o)}function uT(t,e){var r=R0(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=ru(n)?n:Qp(n),gk(t,e,i)},setTransformIndex:function(n){gk(t,e,n)}}}function cT(t,e,r){var n=R0(e),i=n.startTransforms;gk(t,e,Yd(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function gk(t,e,r){var n=R0(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=r0([a],{"x%":function(u){return u/100*s.offsetWidth},"y%":function(u){return u/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function NO(t,e){var r=R0(t);r.nextTransforms=Qp(e)}function R0(t){return t.originalDatas.beforeRenderable}function iS(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function g2(t){return(iS(t)||[]).join(" ")}function m2(t){return R0(t).nextStyle}function wY(t,e,r,n,i){NO(i,e);var a=ac.drag(t,ex(i,t.state,r,n)),s=a?a.transform:e;return Wt(Wt({transform:e,drag:a},sc({transform:s},i)),{afterTransform:s})}function LO(t,e,r,n,i,a){var s=g_e(t.state,i,e,a),o=__e(t,r,n,s);return o}function SY(t,e,r,n,i,a,s){var o=LO(t,e,r,i,a,s),u=t.state,h=u.left,f=u.top,d=t.props.groupable,b=d?h:0,v=d?f:0,S=vi(n,o);return vi(S,[b,v])}function y_e(t,e,r,n,i,a,s){var o=SY(t,e,r,n,i,a,s);return o}function v_e(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function __e(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,u=o?4:3,h=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return ys(n,h,u)}function b_e(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return SY(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function x_e(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,u=o.transformOrigin,h=o.offsetMatrix,f=o.is3d,d=o.width,b=o.height,v=o.left,S=o.top,E=a.fixedDirection,P=a.nextTargetMatrix||o.targetMatrix,k=f?4:3,L=f_e(i,e,r,d,b,u),N=s?v:0,M=s?S:0,z=tx(h,P,L,k),B=p_e(n,z,e,r,k,E);return vi(B,[N,M])}function w_e(t,e){return Fl(kh(t.state),e)}function S_e(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function E_e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function T_e(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function EY(t,e,r){for(var n=t,i=[],a=EO(t)||hg(t),s=!r&&t===e||t===a,o=s,u=!1,h=3,f,d,b,v=!1,S=ob(e,e,!0).offsetParent,E=1;n&&!o;){o=s;var P=Pc(n),k=P("position"),L=XY(n),N=k==="fixed",M=T_e(P),z=s0e(w1e(L)),B=void 0,q=!1,W=!1,G=0,ie=0,J=0,H=0,ne={hasTransform:!1,fixedContainer:null};N&&(v=!0,ne=A1e(n),S=ne.fixedContainer);var ae=z.length;!u&&(ae===16||M.length)&&(u=!0,h=4,xk(i),b&&(b=lf(b,3,4))),u&&ae===9&&(z=lf(z,3,4));var ue=C1e(n,t),de=ue.tagName,Pe=ue.hasOffset,me=ue.isSVG,Ee=ue.origin,we=ue.targetOrigin,Ae=ue.offset,ce=Jt(Ae,2),xe=ce[0],_e=ce[1];de==="svg"&&!n.ownerSVGElement&&b&&(i.push({type:"target",target:n,matrix:I1e(n,h)}),i.push({type:"offset",target:n,matrix:Wo(h)}));var Me=parseFloat(P("zoom"))||1;if(N)B=ne.fixedContainer,q=!0;else{var Re=ob(n,e,!1,!0,P),He=Re.offsetZoom;if(B=Re.offsetParent,q=Re.isEnd,W=Re.isStatic,E*=He,(Re.isCustomElement||He!==1)&&W)xe-=B.offsetLeft,_e-=B.offsetTop;else if(r_e||t_e){var Fe=Re.parentSlotElement;if(Fe){for(var tt=B,Ze=0,Qe=0;tt&&E_e(tt);)Ze+=tt.offsetLeft,Qe+=tt.offsetTop,tt=tt.offsetParent;xe-=Ze,_e-=Qe}}}if(dY&&!n_e&&Pe&&!me&&W&&(k==="relative"||k==="static")&&(xe-=B.offsetLeft,_e-=B.offsetTop,s=s||q),N)Pe&&ne.hasTransform&&(J=B.clientLeft,H=B.clientTop);else if(Pe&&S!==B&&(G=B.clientLeft,ie=B.clientTop),Pe&&B===a){var Ie=YY(n,!1);xe+=Ie[0],_e+=Ie[1]}if(i.push({type:"target",target:n,matrix:P1(z,h,Ee)}),M.length&&(i.push({type:"offset",target:n,matrix:Wo(h)}),i.push({type:"target",target:n,matrix:P1(ib(M),h,Ee)})),Pe){var Lt=n===t,at=Lt?0:n.scrollLeft,Ve=Lt?0:n.scrollTop;i.push({type:"offset",target:n,matrix:_m([xe-at+G-J,_e-Ve+ie-H],h)})}else i.push({type:"offset",target:n,origin:Ee});if(Me!==1&&i.push({type:"zoom",target:n,matrix:P1(CO([Me,Me],h),h,[0,0])}),b||(b=z),f||(f=Ee),d||(d=we),o||N)break;n=B,s=q,(!r||n===a)&&(o=s)}return b||(b=Wo(h)),f||(f=[0,0]),d||(d=[0,0]),{zoom:E,offsetContainer:S,matrixes:i,targetMatrix:b,transformOrigin:f,targetOrigin:d,is3d:u,hasFixed:v}}var qg=null,Hg=null,wv=null;function i0(t){t?(window.Map&&(qg=new Map,Hg=new Map),wv=[]):(qg=null,wv=null,Hg=null)}function C_e(t){var e=Hg?.get(t);if(e)return e;var r=k1(t,!0);return Hg&&Hg.set(t,r),r}function A_e(t,e){if(wv){var r=nh(wv,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=EY(t,e,!0);return wv&&wv.push([[t,e],n]),n}function Pc(t){var e=qg?.get(t);if(!e){var r=Wp(t).getComputedStyle(t);if(!qg)return function(a){return r[a]};e={style:r,cached:{}},qg.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function af(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},Wt(Wt({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function X3(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),u=!!r.match(/End$/g),h=i.isPinch,f=i.datas,d=af(t,e.name,i),b=t.moveables,v=[],S=d.map(function(E,P){var k=b[P],L=k.state,N=L.gestos,M=E;if(o)M=new n0(s).dragStart(n,E),v.push(M);else{if(N[s]||(N[s]=f.childGestos[P]),!N[s])return;M=ex(E,L,n,h,a,s),v.push(M)}var z=e[r](k,Wt(Wt({},M),{parentFlag:!0}));return u&&(N[s]=null),z});return o&&(f.childGestos=b.map(function(E){return E.state.gestos[s]})),{eventParams:S,childEvents:v}}function Vd(t,e,r,n,i,a){i===void 0&&(i=function(f,d){return d});var s=!!r.match(/End$/g),o=af(t,e.name,n),u=t.moveables,h=o.map(function(f,d){var b=u[d],v=f;v=i(b,f);var S=e[r](b,Wt(Wt({},v),{parentFlag:!0}));return s&&(b.state.gestos={}),S});return h}function aS(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||kh(e.state),o=Fl(s,i),u=Jt(Xu(Kb(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),h=u[0],f=u[1];return n.datas.originalX=h,n.datas.originalY=f,n}function TY(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,u=xm(t.props,e).zoom,h=I1(s/Math.PI*180),f={},d=t.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var b=d.renderDirectionMap;r.forEach(function(S){var E=S.dir;f[E]=!0});var v=oc(o);return r.map(function(S){var E=S.data,P=S.classNames,k=S.dir,L=OO[k];if(!L||!f[k])return null;b[k]=!0;var N=(Fi(h,15)+v*yY[k]+720)%180,M={};return k0(E).forEach(function(z){M["data-".concat(z)]=E[z]}),n.createElement("div",Wt({className:mi.apply(void 0,bn(["control","direction",k,e],Jt(P),!1)),"data-rotation":N,"data-direction":k},M,{key:"direction-".concat(k),style:uS.apply(void 0,bn([s,u],Jt(L.map(function(z){return a[z]})),!1))}))})}function CY(t,e,r,n){var i=xm(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var u=s===!0?MO:s;return bn(bn([],Jt(o?kY(t,n,r,u):[]),!1),Jt(TY(t,r,u.map(function(h){return{data:{},classNames:[],dir:h}}),n)),!1)}function ab(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var u=Ws(r,n),h=e?Fi(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:mi.apply(void 0,bn(["line","direction",e?"edge":"",e],Jt(s),!1)),"data-rotation":h,"data-line-key":a,"data-direction":e,style:J_(r,n,i,u)})}function AY(t,e,r,n,i){var a=r===!0?Y0e:r;return a.map(function(s,o){var u=Jt(OO[s],2),h=u[0],f=u[1];if(f!=null)return ab(t,s,n[h],n[f],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function IY(t){return function(e,r){var n=xm(e.props,t).edge;return n&&(n===!0||n.length)?bn(bn([],Jt(AY(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),Jt(I_e(e,t,r)),!1):PY(e,t,r)}}function PY(t,e,r){return CY(t,MO,e,r)}function I_e(t,e,r){return CY(t,["nw","ne","sw","se"],e,r)}function kY(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,u=a.direction,h=i.renderDirectionMap,f=t.props.zoom,d=oc(u),b=o/Math.PI*180;return(n||k0(h)).map(function(v){var S=OO[v];if(!S)return null;var E=(Fi(b,15)+d*yY[v]+720)%180,P=["around-control"];return r&&P.push("direction",r),e.createElement("div",{className:mi.apply(void 0,bn([],Jt(P),!1)),"data-rotation":E,"data-direction":v,key:"direction-around-".concat(v),style:uS.apply(void 0,bn([o,f],Jt(S.map(function(k){return s[k]})),!1))})})}function DO(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,u=n.top,h=u===void 0?-1/0:u,f=n.right,d=f===void 0?1/0:f,b=n.bottom,v=b===void 0?1/0:b,S={position:a,left:o,top:h,right:d,bottom:v};return{vertical:iz(S,e,!0),horizontal:iz(S,r,!1)}}function hT(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,u=r.snapOffset,h=u.left,f=u.top,d=u.right,b=u.bottom,v=e||t.props.bounds||{},S=v.position||"client",E=S==="css",P=v.left,k=P===void 0?-1/0:P,L=v.top,N=L===void 0?-1/0:L,M=v.right,z=M===void 0?E?-1/0:1/0:M,B=v.bottom,q=B===void 0?E?-1/0:1/0:B;return E&&(z=a+d-h-z,q=i+b-f-q),{left:k+h-s,right:z+h-s,top:N+f-o,bottom:q+f-o}}function P_e(t,e,r){var n=hT(t),i=n.left,a=n.top,s=n.right,o=n.bottom,u=Jt(r,2),h=u[0],f=u[1],d=Jt(vi(r,e),2),b=d[0],v=d[1];un(b)<uc&&(b=0),un(v)<uc&&(v=0);var S=v>0,E=b>0,P={isBound:!1,offset:0,pos:0},k={isBound:!1,offset:0,pos:0};if(b===0&&v===0)return{vertical:P,horizontal:k};if(b===0)S?o<f&&(k.pos=o,k.offset=f-o):a>f&&(k.pos=a,k.offset=f-a);else if(v===0)E?s<h&&(P.pos=s,P.offset=h-s):i>h&&(P.pos=i,P.offset=h-i);else{var L=v/b,N=r[1]-L*h,M=0,z=0,B=!1;E&&s<=h?(M=L*s+N,z=s,B=!0):!E&&h<=i&&(M=L*i+N,z=i,B=!0),B&&(M<a||M>o)&&(B=!1),B||(S&&o<=f?(M=o,z=(M-N)/L,B=!0):!S&&f<=a&&(M=a,z=(M-N)/L,B=!0)),B&&(P.isBound=!0,P.pos=z,P.offset=h-z,k.isBound=!0,k.pos=M,k.offset=f-M)}return{vertical:P,horizontal:k}}function iz(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,bn([],Jt(e),!1)),s=Math.max.apply(Math,bn([],Jt(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(u,h){return un(h.offset)-un(u.offset)})}function az(t,e,r){var n=r?t.map(function(i){return Zb(i,r)}):t;return n.some(function(i){return i[0]<e.left&&un(i[0]-e.left)>.1||i[0]>e.right&&un(i[0]-e.right)>.1||i[1]<e.top&&un(i[1]-e.top)>.1||i[1]>e.bottom&&un(i[1]-e.bottom)>.1})}function k_e(t,e,r){var n=Ph(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return un(a-t[r?0:1])-un(s-t[r?0:1])}).map(function(a){return Ws([0,0],r?[a,e]:[e,a])})}function M_e(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=hT(t),o=s.left,u=s.top,h=s.right,f=s.bottom,d=o-n[0],b=h-n[0],v=u-n[1],S=f-n[1],E={left:d,top:v,right:b,bottom:S};if(!az(r,E,0))return[];var P=[];return[[d,0],[b,0],[v,1],[S,1]].forEach(function(k){var L=Jt(k,2),N=L[0],M=L[1];r.forEach(function(z){var B=Ws([0,0],z);P.push.apply(P,bn([],Jt(k_e(z,N,M).map(function(q){return a+q-B}).filter(function(q){return!az(e,E,q)}).map(function(q){return Fi(q*180/Math.PI,uc)})),!1))})}),P}var R_e=["left","right","center"],O_e=["top","bottom","middle"],oz={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},eg={start:"left",end:"right",center:"center"},tg={start:"top",end:"bottom",center:"middle"};function Sv(){return{left:!1,top:!1,right:!1,bottom:!1}}function O0(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,u=r.snapGridWidth,h=r.snapGridHeight,f=t.state,d=f.guidelines,b=f.enableSnap;return!n||!b||e&&n!==!0&&n.indexOf(e)<0?!1:!!(u||h||i||a||d&&d.length||s&&s.length||o&&o.length)}function FO(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function N_e(t,e){var r=FO(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function BO(t,e){var r=N_e(t,e),n=O_e.filter(function(a){return a in r}),i=R_e.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function L_e(t,e,r){var n=ys(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function D_e(t){var e=Jt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<yl&&(i=0),Math.abs(a)<yl&&(a=0);var s=0,o=0,u=0;return i?a?(s=-a/i,o=1,u=s*r[0]-r[1]):(o=1,u=-r[1]):(s=-1,u=r[0]),[s,o,u].map(function(h){return Fi(h,yl)})}var MY="snapRotationThreshold",RY="snapRotationDegrees",OY="snapHorizontalThreshold",NY="snapVerticalThreshold";function fT(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var u=t.props,h=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],f=xz(s,u[OY],5),d=xz(a,u[NY],5);return LY(t.state.guidelines,e,r,n,i,f,d,h)}function LY(t,e,r,n,i,a,s,o){return{vertical:lz(t,"vertical",e,s*o[0],n),horizontal:lz(t,"horizontal",r,a*o[1],i)}}function F_e(t,e,r){var n=Jt(r,2),i=n[0],a=n[1],s=Jt(e,2),o=s[0],u=s[1],h=Jt(vi(r,e),2),f=h[0],d=h[1],b=d>0,v=f>0;f=cS(f),d=cS(d);var S={isSnap:!1,offset:0,pos:0},E={isSnap:!1,offset:0,pos:0};if(f===0&&d===0)return{vertical:S,horizontal:E};var P=fT(t,f?[i]:[],d?[a]:[],[],[],void 0,void 0),k=P.vertical,L=P.horizontal;k.posInfos.filter(function(de){var Pe=de.pos;return v?Pe>=o:Pe<=o}),L.posInfos.filter(function(de){var Pe=de.pos;return b?Pe>=u:Pe<=u}),k.isSnap=k.posInfos.length>0,L.isSnap=L.posInfos.length>0;var N=mk(k),M=N.isSnap,z=N.guideline,B=mk(L),q=B.isSnap,W=B.guideline,G=q?W.pos[1]:0,ie=M?z.pos[0]:0;if(f===0)q&&(E.isSnap=!0,E.pos=W.pos[1],E.offset=a-E.pos);else if(d===0)M&&(S.isSnap=!0,S.pos=ie,S.offset=i-ie);else{var J=d/f,H=r[1]-J*i,ne=0,ae=0,ue=!1;M?(ae=ie,ne=J*ae+H,ue=!0):q&&(ne=G,ae=(ne-H)/J,ue=!0),ue&&(S.isSnap=!0,S.pos=ae,S.offset=i-ae,E.isSnap=!0,E.pos=ne,E.offset=a-ne)}return{vertical:S,horizontal:E}}function Bp(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function sz(t,e,r,n){var i=BO(t.props.snapDirections,e),a=fT(t,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Bp(u)}),i.horizontalNames.map(function(u){return Bp(u)}),r,n),s=Bp(i.horizontalNames[a.horizontal.index]),o=Bp(i.verticalNames[a.vertical.index]);return{vertical:Wt(Wt({},a.vertical),{direction:o}),horizontal:Wt(Wt({},a.horizontal),{direction:s})}}function mk(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function lz(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",u=o?0:1,h=r.map(function(d,b){var v=i[b]||"",S=t.map(function(E){var P=E.pos,k=d-P[u];return{offset:k,dist:un(k),guideline:E,direction:v}}).filter(function(E){var P=E.guideline,k=E.dist,L=P.type;return!(L!==e||k>n)}).sort(function(E,P){return E.dist-P.dist});return{pos:d,index:b,guidelineInfos:S,direction:v}}).filter(function(d){return d.guidelineInfos.length>0}).sort(function(d,b){return d.guidelineInfos[0].dist-b.guidelineInfos[0].dist}),f=h.length>0;return{isSnap:f,index:f?h[0].index:-1,direction:(s=(a=h[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:h}}function B_e(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(b,v,S){var E=S[v+1]||S[0];a.push(b),a.push([(b[0]+E[0])/2,(b[1]+E[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,bn([],Jt(d_e([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(b){return Fl(e,b)}),o=s.map(function(b){return b[0]}),u=s.map(function(b){return b[1]}),h=fT(t,o,u,a.map(function(b){return Bp(b[0])}),a.map(function(b){return Bp(b[1])}),n,i),f=Bp(a.map(function(b){return b[0]})[h.vertical.index]),d=Bp(a.map(function(b){return b[1]})[h.horizontal.index]);return{vertical:Wt(Wt({},h.vertical),{direction:f}),horizontal:Wt(Wt({},h.horizontal),{direction:d})}}function DY(t,e){var r=un(t.offset),n=un(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<uc?1:n<uc?-1:r-n}function oS(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return DY({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function z_e(t,e,r){var n=[];if(r)un(e[0])!==1||un(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var u=[s*i[0],o*i[1]];e[0]===u[0]&&e[1]===u[1]||n.push([e,u])})})}else if(t[0]){var a=un(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=un(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function FY(t,e){var r=ik([e[0][0],e[1][0]]),n=ik([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function zO(t,e){var r=Jt(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];un(a)<uc&&(a=0),un(s)<uc&&(s=0);var o,u;if(!a)o=n[0],u=t[0];else if(!s)o=n[1],u=t[1];else{var h=s/a;o=h*(t[0]-n[0])+n[1],u=t[1]}return o-u}function BY(t,e,r,n){return n===void 0&&(n=uc),t.every(function(i){var a=zO(i,e),s=a<=0;return s===r||un(a)<=n})}function uz(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function j_e(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=o.left,h=o.top,f=o.width,d=o.height,b=[[u,h],[u,h+d]],v=[[u,h],[u+f,h]],S=[[u+f,h],[u+f,h+d]],E=[[u,h+d],[u+f,h+d]];if(BY([[u,h],[u+f,h],[u,h+d],[u+f,h+d]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var P=zp(r,s,v,i),k=zp(r,s,E,i),L=zp(r,s,b,a),N=zp(r,s,S,a),M=P.isBound&&k.isBound,z=P.isBound||k.isBound,B=L.isBound&&N.isBound,q=L.isBound||N.isBound,W=a0(P.offset,k.offset),G=a0(L.offset,N.offset),ie=[0,0],J=!1,H=!1;return un(G)<un(W)?(ie=[W,0],J=z,H=M):(ie=[0,G],J=q,H=B),{isAllBound:H,isVerticalBound:z,isHorizontalBound:q,isBound:J,offset:ie}}function zp(t,e,r,n,i,a){var s=Jt(e,2),o=s[0],u=s[1],h=t[0],f=r[0],d=r[1],b=cS(d[1]-f[1]),v=cS(d[0]-f[0]),S=u,E=o,P=-o/u;if(v){if(!b){if(a&&!S)return{isBound:!1,offset:0};if(E){var M=(f[1]-h[1])/P+h[0];return uz(M,f[0],d[0],n,i)}else{var L=f[1]-h[1],N=un(L)<=(i||0);return{isBound:N,offset:N?L:0}}}}else{if(a&&!E)return{isBound:!1,offset:0};if(S){var k=P*(f[0]-h[0])+h[1];return uz(k,f[1],d[1],n,i)}else{var L=f[0]-h[0],N=un(L)<=(i||0);return{isBound:N,offset:N?L:0}}}return{isBound:!1,offset:0}}function zY(t,e,r){return e.map(function(n){var i=j_e(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,u=i.isHorizontalBound,h=n.multiple,f=ld({datas:r,distX:s[0],distY:s[1]}).map(function(d,b){return d*(h[b]?2/h[b]:0)});return{sign:h,isBound:a,isVerticalBound:o,isHorizontalBound:u,isSnap:!1,offset:f}})}function U_e(t,e,r){var n,i=jO(t,e,[0,0],!1).map(function(b){return Wt(Wt({},b),{multiple:b.multiple.map(function(v){return un(v)*2})})}),a=zY(t,i,r),s=oS(a,0),o=oS(a,1),u=0,h=0,f=s.isVerticalBound||o.isVerticalBound,d=s.isHorizontalBound||o.isHorizontalBound;return(f||d)&&(n=Jt(h_e({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),u=n[0],h=n[1]),{vertical:{isBound:f,offset:u},horizontal:{isBound:d,offset:h}}}function V_e(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function jO(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=Vm(a,100,100,s?4:3),u=Fl(o,[0,0]);return V_e(r,n).map(function(h){var f=Jt(h,3),d=f[0],b=f[1],v=f[2],S=[Fl(o,b),Fl(o,v)],E=D_e(S),P=FY(u,S),k=P.vertical,L=P.horizontal,N=zO(u,S)<=0;return{multiple:d,centerSign:N,verticalSign:k,horizontalSign:L,lineConstants:E,line:[Fl(e,b),Fl(e,v)]}})}function cz(t,e,r,n){var i=n?t.map(function(a){return Zb(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=zO(r,a)<=0;return!BY(e,a,s)})}function $_e(t){var e=Jt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return un(r[0]);if(!a)return un(r[1]);var s=a/i;return un((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function q_e(t){var e=Jt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function H_e(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,u=a.top,h=a.width,f=a.height,d=o-n[0],b=o+h-n[0],v=u-n[1],S=u+f-n[1],E=[[d,v],[b,v],[d,S],[b,S]],P=Fl(r,[0,0]);if(!cz(r,E,P,0))return[];var k=[],L=E.map(function(N){return[Ph(N),Ws([0,0],N)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(N){var M=Ws([0,0],q_e(N)),z=$_e(N);k.push.apply(k,bn([],Jt(L.filter(function(B){var q=Jt(B,1),W=q[0];return W&&z<=W}).map(function(B){var q=Jt(B,2),W=q[0],G=q[1],ie=Math.acos(W?z/W:0),J=G+ie,H=G-ie;return[s+J-M,s+H-M]}).reduce(function(B,q){return B.push.apply(B,bn([],Jt(q),!1)),B},[]).filter(function(B){return!cz(e,E,P,B)}).map(function(B){return Fi(B*180/Math.PI,uc)})),!1))}),k}function W_e(t){var e=t.props.innerBounds,r=Sv();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,u=[i,a,s,o],h=Fl(u,[0,0]),f=e.left,d=e.top,b=e.width,v=e.height,S=[[f,d],[f,d+v]],E=[[f,d],[f+b,d]],P=[[f+b,d],[f+b,d+v]],k=[[f,d+v],[f+b,d+v]],L=jO(t,u,[0,0],!1),N=[],M=[];return L.forEach(function(z){var B=z.line,q=z.lineConstants,W=FY(h,B),G=W.horizontal,ie=W.vertical,J=zp(B,q,E,ie,1,!0),H=zp(B,q,k,ie,1,!0),ne=zp(B,q,S,G,1,!0),ae=zp(B,q,P,G,1,!0);J.isBound&&!r.top&&(N.push(d),r.top=!0),H.isBound&&!r.bottom&&(N.push(d+v),r.bottom=!0),ne.isBound&&!r.left&&(M.push(f),r.left=!0),ae.isBound&&!r.right&&(M.push(f+b),r.right=!0)}),{boundMap:r,horizontal:N,vertical:M}}function G_e(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(un(i)<yl&&(i=0),un(a)<yl&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var u=s*(e[0]+r)+o;return[r,u-e[1]]}else{var h=(e[1]+r-o)/s;return[h-e[0],r]}}function yk(t,e,r,n,i){var a=G_e(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=Ud(t,e),o=Ud(a,t),u=Ud(a,e),h=o>s||u>s,f=Jt(ld({datas:i,distX:a[0],distY:a[1]}),2),d=f[0],b=f[1];return{offset:[d,b],isOutside:h}}function sS(t,e){return t.isBound?t.offset:e.isSnap?mk(e).offset:0}function X_e(t,e,r,n,i){var a=Jt(e,2),s=a[0],o=a[1],u=Jt(r,2),h=u[0],f=u[1],d=Jt(n,2),b=d[0],v=d[1],S=Jt(i,2),E=S[0],P=S[1],k=-E,L=-P;if(t&&s&&o){k=0,L=0;var N=[];if(h&&f?N.push([0,P],[E,0]):h?N.push([E,0]):f?N.push([0,P]):b&&v?N.push([0,P],[E,0]):b?N.push([E,0]):v&&N.push([0,P]),N.length){N.sort(function(q,W){return Ph(vi([s,o],q))-Ph(vi([s,o],W))});var M=N[0];if(M[0]&&un(s)>yl)k=-M[0],L=o*un(s+k)/un(s)-o;else if(M[1]&&un(o)>yl){var z=o;L=-M[1],k=s*un(o+L)/un(z)-s}if(t&&f&&h)if(un(k)>yl&&un(k)<un(E)){var B=un(E)/un(k);k*=B,L*=B}else if(un(L)>yl&&un(L)<un(P)){var B=un(P)/un(L);k*=B,L*=B}else k=a0(-E,k),L=a0(-P,L)}}else k=s||h?-E:0,L=o||f?-P:0;return[k,L]}function Y_e(t,e,r,n,i,a){if(!O0(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=$O(a.absolutePoses,[e,r]),o=bh(s),u=o.left,h=o.right,f=o.top,d=o.bottom,b={horizontal:s.map(function(ae){return ae[1]}),vertical:s.map(function(ae){return ae[0]})},v=FO(t.props.snapDirections),S=BO(v,{left:u,right:h,top:f,bottom:d,center:(u+h)/2,middle:(f+d)/2}),E=dT(t,i,S,b),P=E.vertical,k=E.horizontal,L=U_e(t,s,a),N=L.vertical,M=L.horizontal,z=P.isSnap,B=k.isSnap,q=P.isBound||N.isBound,W=k.isBound||M.isBound,G=a0(P.offset,N.offset),ie=a0(k.offset,M.offset),J=Jt(X_e(n,[e,r],[q,W],[z,B],[G,ie]),2),H=J[0],ne=J[1];return[{isBound:q,isSnap:z,offset:H},{isBound:W,isSnap:B,offset:ne}]}function dT(t,e,r,n){n===void 0&&(n=r);var i=DO(hT(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:fT(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),u=o.horizontal,h=o.vertical,f=sS(a[0],u),d=sS(s[0],h),b=un(f),v=un(d);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:b,bounds:a,snap:u},vertical:{isBound:s[0].isBound,isSnap:h.isSnap,snapIndex:h.index,offset:d,dist:v,bounds:s,snap:h}}}function hz(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=DO(e,r,n),u=o.horizontal,h=o.vertical,f=LY(t,r,n,[],[],i,a,s),d=f.horizontal,b=f.vertical,v=sS(u[0],d),S=sS(h[0],b),E=un(v),P=un(S);return{horizontal:{isBound:u[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:v,dist:E,bounds:u,snap:d},vertical:{isBound:h[0].isBound,isSnap:b.isSnap,snapIndex:b.index,offset:S,dist:P,bounds:h,snap:b}}}function Z_e(t,e,r,n){var i=Ws(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,u=a.dist,h=r.horizontal,f=h.isBound,d=h.isSnap,b=h.dist,v=i%180,S=v<3||v>177,E=v>87&&v<93;return b<u&&(s||o&&!E&&(!n||!S))?"vertical":f||d&&!S&&(!n||!E)?"horizontal":""}function K_e(t,e,r,n,i,a){return r.map(function(s){var o=Jt(s,2),u=o[0],h=o[1],f=Fl(e,u),d=Fl(e,h),b=n?J_e(t,f,d,i):dT(t,i,{vertical:[d[0]],horizontal:[d[1]]}),v=b.horizontal,S=v.offset,E=v.isBound,P=v.isSnap,k=b.vertical,L=k.offset,N=k.isBound,M=k.isSnap,z=vi(h,u);if(!L&&!S)return{isBound:N||E,isSnap:M||P,sign:z,offset:[0,0]};var B=Z_e(f,d,b,n);if(!B)return{sign:z,isBound:!1,isSnap:!1,offset:[0,0]};var q=B==="vertical",W=[0,0];return!n&&un(h[0])===1&&un(h[1])===1&&u[0]!==h[0]&&u[1]!==h[1]?W=ld({datas:a,distX:-L,distY:-S}):W=yk(f,d,-(q?L:S),q,a).offset,W=W.map(function(G,ie){return G*(z[ie]?2/z[ie]:0)}),{sign:z,isBound:q?N:E,isSnap:q?M:P,offset:W}})}function fz(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function J_e(t,e,r,n){var i=P_e(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:F_e(t,e,r),u=o.horizontal,h=o.vertical,f=fz(a,u),d=fz(s,h),b=un(f),v=un(d);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:f,dist:b},vertical:{isBound:s.isBound,isSnap:h.isSnap,offset:d,dist:v}}}function Q_e(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,u=s.height,h=t.props.bounds,f=1/0,d=1/0;if(h){var b=[[r[0],-r[1]],[-r[0],r[1]]],v=h.left,S=v===void 0?-1/0:v,E=h.top,P=E===void 0?-1/0:E,k=h.right,L=k===void 0?1/0:k,N=h.bottom,M=N===void 0?1/0:N;b.forEach(function(z){var B=z[0]!==a[0],q=z[1]!==a[1],W=Fl(e,z),G=Ws(n,W)*360/Math.PI;if(q){var ie=W.slice();(un(G-360)<2||un(G-180)<2)&&(ie[1]=n[1]);var J=yk(n,ie,(n[1]<W[1]?M:P)-W[1],!1,i),H=Jt(J.offset,2),ne=H[1],ae=J.isOutside;isNaN(ne)||(d=u+(ae?1:-1)*un(ne))}if(B){var ie=W.slice();(un(G-90)<2||un(G-270)<2)&&(ie[0]=n[0]);var ue=yk(n,ie,(n[0]<W[0]?L:S)-W[0],!0,i),de=Jt(ue.offset,1),Pe=de[0],me=ue.isOutside;isNaN(Pe)||(f=o+(me?1:-1)*un(Pe))}})}return{maxWidth:f,maxHeight:d}}var ac={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,u=s.beforeOrigin;if(n||!i||!o)return[];var h=o.dist;if(!h[0]&&!h[1])return[];var f=Ph(h),d=Ws(h,[0,0]);return[e.createElement("div",{className:mi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(f,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(d,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],Um(t,e),cT(t,e,"translate"),v1e(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var u=Xi(t,e,Wt({set:function(f){r.startValue=f}},uT(t,e))),h=n||Zn(t,"onDragStart",u);return h!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?u:!1},drag:function(t,e){if(e){sT(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,u=e.isRequest,h=e.isGroup,f=e.parentThrottleDrag,d=e.distX,b=e.distY,v=r.isDrag,S=r.prevDist,E=r.prevBeforeDist,P=r.startValue;if(v){s&&(d+=s[0],b+=s[1]);var k=t.props,L=k.parentMoveable,N=h?0:k.throttleDrag||f||0,M=n?0:k.throttleDragRotate||0,z=0,B=!1,q=!1,W=!1,G=!1;if(!n&&M>0&&(d||b)){var ie=k.startDragRotate||0,J=Fi(ie+Ws([0,0],[d,b])*180/Math.PI,M)-ie,H=b*Math.abs(Math.cos((J-90)/180*Math.PI)),ne=d*Math.abs(Math.cos(J/180*Math.PI)),ae=Ph([ne,H]);z=J*Math.PI/180,d=ae*Math.cos(z),b=ae*Math.sin(z)}if(!a&&!n&&!i){var ue=Jt(Y_e(t,d,b,M,!o&&u||s,r),2),de=ue[0],Pe=ue[1];B=de.isSnap,q=de.isBound,W=Pe.isSnap,G=Pe.isBound;var me=de.offset,Ee=Pe.offset;d+=me,b+=Ee}var we=Ta(bY({datas:r,distX:d,distY:b}),P),Ae=Ta(c_e({datas:r,distX:d,distY:b}),P);KB(Ae,uc),KB(we,uc),M||(!B&&!q&&(Ae[0]=Fi(Ae[0],N),we[0]=Fi(we[0],N)),!W&&!G&&(Ae[1]=Fi(Ae[1],N),we[1]=Fi(we[1],N)));var ce=vi(we,P),xe=vi(Ae,P),_e=vi(xe,S),Me=vi(ce,E);r.prevDist=xe,r.prevBeforeDist=ce,r.passDelta=_e,r.passDist=xe;var Re=r.left+ce[0],He=r.top+ce[1],Fe=r.right-ce[0],tt=r.bottom-ce[1],Ze=lT(r,"translate(".concat(Ae[0],"px, ").concat(Ae[1],"px)"),"translate(".concat(xe[0],"px, ").concat(xe[1],"px)"));if(NO(e,Ze),t.state.dragInfo.dist=n?[0,0]:xe,!(!n&&!L&&_e.every(function(Ve){return!Ve})&&Me.some(function(Ve){return!Ve}))){var Qe=t.state,Ie=Qe.width,Lt=Qe.height,at=Xi(t,e,Wt({transform:Ze,dist:xe,delta:_e,translate:Ae,beforeDist:ce,beforeDelta:Me,beforeTranslate:we,left:Re,top:He,right:Fe,bottom:tt,width:Ie,height:Lt,isPinch:a},sc({transform:Ze},e)));return!n&&Zn(t,"onDrag",at),at}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,Wt(Wt({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=ih(t,e,{});return!r&&Zn(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var u=X3(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),h=u.childEvents,f=u.eventParams,d=Wt(Wt({},o),{targets:t.props.targets,events:f}),b=Zn(t,"onDragGroupStart",d);i.isDrag=b!==!1;var v=(n=(r=h[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[v[0]%1,v[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,Wt(Wt({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=X3(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=Wt({targets:t.props.targets,events:a},n);return Zn(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=X3(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Zn(t,"onDragGroupEnd",ih(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function jY(t,e){var r=Fl(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function e1e(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],u=ys(r,o,s),h=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:h}}function UY(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=v_e(e,i,a),u=ys(r,e,s),h=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:o,fixedOffset:h}}var dz=WO("resizable"),vk={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:IY("resizable"),dragControlCondition:dz,viewClassName:HO("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,u=e.datas,h=e.parentFixedDirection,f=e.parentEvent,d=eZ(s,i,n,u),b=t.state,v=b.target,S=b.width,E=b.height,P=b.gestos;if(!d||!v||P.resizable)return!1;P.resizable=o||t.controlGesto,!i&&Um(t,e),u.datas={},u.direction=d,u.startOffsetWidth=S,u.startOffsetHeight=E,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=b.inlineCSSWidth||b.cssWidth,u.startHeight=b.inlineCSSHeight||b.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[b.minOffsetWidth,b.minOffsetHeight],u.maxSize=[b.maxOffsetWidth,b.maxOffsetHeight]);var k=t.props.transformOrigin||"% %";u.transformOrigin=rp(k)?k.split(" "):k,u.startOffsetMatrix=b.offsetMatrix,u.startTransformOrigin=b.transformOrigin,u.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!d[0]&&!d[1]||d[0]||!d[1];function L(G){u.ratio=G&&isFinite(G)?G:0}u.startPositions=kh(t.state);function N(G){var ie=jY(u.startPositions,G);u.fixedDirection=ie.fixedDirection,u.fixedPosition=ie.fixedPosition,u.fixedOffset=ie.fixedOffset}function M(G){var ie=UY(t.state,G);u.fixedDirection=ie.fixedDirection,u.fixedPosition=ie.fixedPosition,u.fixedOffset=ie.fixedOffset}function z(G){u.minSize=[bo("".concat(G[0]),0)||0,bo("".concat(G[1]),0)||0]}function B(G){var ie=[G[0]||1/0,G[1]||1/0];(!rb(ie[0])||isFinite(ie[0]))&&(ie[0]=bo("".concat(ie[0]),0)||1/0),(!rb(ie[1])||isFinite(ie[1]))&&(ie[1]=bo("".concat(ie[1]),0)||1/0),u.maxSize=ie}L(S/E),N(h||[-d[0],-d[1]]),u.setFixedDirection=N,u.setFixedPosition=M,u.setMin=z,u.setMax=B;var q=Xi(t,e,{direction:d,startRatio:u.ratio,set:function(G){var ie=Jt(G,2),J=ie[0],H=ie[1];u.startWidth=J,u.startHeight=H},setMin:z,setMax:B,setRatio:L,setFixedDirection:N,setFixedPosition:M,setOrigin:function(G){u.transformOrigin=G},dragStart:ac.dragStart(t,new n0().dragStart([0,0],e))}),W=f||Zn(t,"onResizeStart",q);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,W!==!1&&(u.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:d}),u.isResize?q:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,u=e.parentDist,h=e.useSnap,f=e.isRequest,d=e.isGroup,b=e.parentEvent,v=e.resolveMatrix,S=n.isResize,E=n.transformOrigin,P=n.startWidth,k=n.startHeight,L=n.prevWidth,N=n.prevHeight,M=n.minSize,z=n.maxSize,B=n.ratio,q=n.startOffsetWidth,W=n.startOffsetHeight,G=n.isWidth;if(!S)return;if(v){var ie=t.state.is3d,J=n.startOffsetMatrix,H=n.startTransformOrigin,ne=ie?4:3,ae=ib(iS(e)),ue=Math.sqrt(ae.length);ne!==ue&&(ae=lf(ae,ue,ne));var de=tx(J,ae,H,ne),Pe=Vm(de,q,W,ne);n.startPositions=Pe,n.nextTargetMatrix=ae,n.nextAllMatrix=de}var me=xm(t.props,"resizable"),Ee=me.resizeFormat,we=me.throttleResize,Ae=we===void 0?i?0:1:we,ce=me.parentMoveable,xe=me.keepRatioFinally,_e=n.direction,Me=_e,Re=0,He=0;!_e[0]&&!_e[1]&&(Me=[1,1]);var Fe=B&&(s??me.keepRatio)||!1;function tt(){var Pr=n.fixedDirection,ar=oZ(Me,Fe,n,e);Re=ar.distWidth,He=ar.distHeight;var fr=Me[0]-Pr[0]||Fe?Math.max(q+Re,uc):q,Nr=Me[1]-Pr[1]||Fe?Math.max(W+He,uc):W;return Fe&&q&&W&&(G?Nr=fr/B:fr=Nr*B),[fr,Nr]}var Ze=Jt(tt(),2),Qe=Ze[0],Ie=Ze[1];b||(n.setFixedDirection(n.fixedDirection),Zn(t,"onBeforeResize",Xi(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Pr){var ar;return n.setFixedDirection(Pr),ar=Jt(tt(),2),Qe=ar[0],Ie=ar[1],[Qe,Ie]},setFixedPosition:function(Pr){var ar;return n.setFixedPosition(Pr),ar=Jt(tt(),2),Qe=ar[0],Ie=ar[1],[Qe,Ie]},boundingWidth:Qe,boundingHeight:Ie,setSize:function(Pr){var ar;ar=Jt(Pr,2),Qe=ar[0],Ie=ar[1]}},!0)));var Lt=o;o||(!i&&a?Lt=w_e(t,[0,0]):Lt=n.fixedPosition);var at=[0,0];a||(at=m1e(t,Qe,Ie,_e,Lt,!h&&f,n)),u&&(!u[0]&&(at[0]=0),!u[1]&&(at[1]=0));function Ve(){var Pr;Ee&&(Pr=Jt(Ee([Qe,Ie]),2),Qe=Pr[0],Ie=Pr[1]),Qe=Fi(Qe,Ae),Ie=Fi(Ie,Ae)}if(Fe){Me[0]&&Me[1]&&at[0]&&at[1]&&(un(at[0])>un(at[1])?at[1]=0:at[0]=0);var nr=!at[0]&&!at[1];nr&&Ve(),Me[0]&&!Me[1]||at[0]&&!at[1]||nr&&G?(Qe+=at[0],Ie=Qe/B):(!Me[0]&&Me[1]||!at[0]&&at[1]||nr&&!G)&&(Ie+=at[1],Qe=Ie*B)}else Qe+=at[0],Ie+=at[1],Qe=Math.max(0,Qe),Ie=Math.max(0,Ie);r=Jt(eY([Qe,Ie],M,z,Fe?B:!1),2),Qe=r[0],Ie=r[1],Ve(),Fe&&(d||xe)&&(G?Ie=Qe/B:Qe=Ie*B),Re=Qe-q,He=Ie-W;var Yt=[Re-L,He-N];n.prevWidth=Re,n.prevHeight=He;var yr=x_e(t,Qe,Ie,Lt,E,n);if(!(!ce&&Yt.every(function(Pr){return!Pr})&&yr.every(function(Pr){return!Pr}))){var mt=ac.drag(t,ex(e,t.state,yr,!!a,!1,"draggable")),br=mt.transform,Tr=P+Re,mr=k+He,Mr=Xi(t,e,Wt({width:Tr,height:mr,offsetWidth:Math.round(Qe),offsetHeight:Math.round(Ie),startRatio:B,boundingWidth:Qe,boundingHeight:Ie,direction:_e,dist:[Re,He],delta:Yt,isPinch:!!a,drag:mt},rZ({style:{width:"".concat(Tr,"px"),height:"".concat(mr,"px")},transform:br},mt,e)));return!b&&Zn(t,"onResize",Mr),Mr}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var u=t.state,h=u.width,f=u.height,d=h-(i+s),b=f-(a+o),v=un(d)>3,S=un(b)>3;if(v&&(r.startWidth+=d,r.startOffsetWidth+=d,r.prevWidth+=d),S&&(r.startHeight+=b,r.startOffsetHeight+=b,r.prevHeight+=b),v||S)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=ih(t,e,{});return!n&&Zn(t,"onResizeEnd",i),i}},dragGroupControlCondition:dz,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,Wt(Wt({},e),{isGroup:!0}));if(!n)return!1;var i=af(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var v=r.minSize;i.forEach(function(S){var E=S.datas,P=E.minSize,k=E.startOffsetWidth,L=E.startOffsetHeight,N=a*(k?P[0]/k:0),M=s*(L?P[1]/L:0);v[0]=Math.max(v[0],N),v[1]=Math.max(v[1],M)})}function u(){var v=r.maxSize;i.forEach(function(S){var E=S.datas,P=E.maxSize,k=E.startOffsetWidth,L=E.startOffsetHeight,N=a*(k?P[0]/k:0),M=s*(L?P[1]/L:0);v[0]=Math.min(v[0],N),v[1]=Math.min(v[1],M)})}var h=Vd(t,this,"dragControlStart",e,function(v,S){return aS(t,v,r,S)});o(),u();var f=function(v){n.setFixedDirection(v),h.forEach(function(S,E){S.setFixedDirection(v),aS(t,S.moveable,r,i[E])})};r.setFixedDirection=f;var d=Wt(Wt({},n),{targets:t.props.targets,events:h.map(function(v){return Wt(Wt({},v),{setMin:function(S){v.setMin(S),o()},setMax:function(S){v.setMax(S),u()}})}),setFixedDirection:f,setMin:function(v){n.setMin(v),o()},setMax:function(v){n.setMax(v),u()}}),b=Zn(t,"onResizeGroupStart",d);return r.isResize=b!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=xm(t.props,"resizable");gT(t,"onBeforeResize",function(v){Zn(t,"onBeforeResizeGroup",Xi(t,e,Wt(Wt({},v),{targets:n.targets}),!0))});var i=this.dragControl(t,Wt(Wt({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,u=n.keepRatio,h=[a/(a-o[0]),s/(s-o[1])],f=r.fixedPosition,d=Vd(t,this,"dragControl",e,function(v,S){var E=Jt(Xu(Kb(t.rotation/180*Math.PI,3),[S.datas.originalX*h[0],S.datas.originalY*h[1],1],3),2),P=E[0],k=E[1];return Wt(Wt({},S),{parentDist:null,parentScale:h,dragClient:Ta(f,[P,k]),parentKeepRatio:u})}),b=Wt({targets:n.targets,events:d},i);return Zn(t,"onResizeGroup",b),b}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=Vd(t,this,"dragControlEnd",e),a=ih(t,e,{targets:t.props.targets,events:i});return Zn(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function Y3(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,u=e.origin,h=ys(t.state.rootMatrix,vi([u[0],u[1]],a?[0,0]:[s.left,s.top]),o),f=Ta([i.left,i.top],h);e.startAbsoluteOrigin=f,e.prevDeg=Ws(f,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Ud(f,[r,n])}function yw(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function Z3(t,e,r,n){return yw(Ws(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function K3(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,u=r.prevSnapDeg,h=0,f=!1;if(a){var d=g1e(t,e,n,i+n);f=d.isSnap,h=i+d.dist}f||(h=Fi(i+n,o));var b=h-i;return r.prevSnapDeg=b,[b-u,b,h]}function VY(t,e,r){var n=Jt(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(ru(t))return t.map(function(P){return VY(P,[i,a,s,o],r)[0]});var u=Jt((t||"top").split("-"),2),h=u[0],f=u[1],d=[i,a];h==="left"?d=[s,i]:h==="right"?d=[a,o]:h==="bottom"&&(d=[o,s]);var b=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],v=JY(d,r);if(f){var S=f==="top"||f==="left",E=h==="bottom"||h==="left";b=d[S&&!E||!S&&E?0:1]}return[[b,v]]}function _k(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Dl(r,mi("rotation-control"))||t.props.rotateAroundControls&&Dl(r,mi("around-control"))||Dl(r,mi("control"))&&Dl(r,mi("rotatable")))return!0;var n=t.props.rotationTarget;return n?GO(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var t1e=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,r1e={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[t1e],viewClassName:function(t){return t.isDragging("rotatable")?mi("view-rotation-dragging"):""},render:function(t,e){var r=xm(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,u=r.resolveAblesWithRotatable,h=t.getState(),f=h.renderPoses,d=h.direction;if(!n)return null;var b=VY(i,f,d),v=[];if(b.forEach(function(k,L){var N=Jt(k,2),M=N[0],z=N[1];v.push(e.createElement("div",{key:"rotation".concat(L),className:mi("rotation"),style:{transform:"translate(-50%) translate(".concat(M[0],"px, ").concat(M[1],"px) rotate(").concat(z,"rad)")}},e.createElement("div",{className:mi("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:mi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var S=k0(u||{}),E={};S.forEach(function(k){u[k].forEach(function(L){E[L]=k})});var P=[];ru(s)&&(P=s.map(function(k){var L=E[k];return{data:L?{resolve:L}:{},classNames:L?["move"]:[],dir:k}})),v.push.apply(v,bn([],Jt(TY(t,"rotatable",P,e)),!1))}return o&&v.push.apply(v,bn([],Jt(kY(t,e)),!1)),v},dragControlCondition:_k,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,u=e.parentFlag,h=e.isPinch,f=e.isRequest,d=t.state,b=d.target,v=d.left,S=d.top,E=d.direction,P=d.beforeDirection,k=d.targetTransform,L=d.moveableClientRect,N=d.offsetMatrix,M=d.targetMatrix,z=d.allMatrix,B=d.width,q=d.height;if(!f&&!b)return!1;var W=t.getRect();i.rect=W,i.transform=k,i.left=v,i.top=S;var G=function(Me){var Re=UY(t.state,Me);i.fixedDirection=Re.fixedDirection,i.fixedOffset=Re.fixedOffset,i.fixedPosition=Re.fixedPosition,Ae&&Ae.setFixedPosition(Me)},ie=function(Me){var Re=e1e(t.state,Me);i.fixedDirection=Re.fixedDirection,i.fixedOffset=Re.fixedOffset,i.fixedPosition=Re.fixedPosition,Ae&&Ae.setFixedDirection(Me)},J=a,H=s;if(f||h||u){var ne=o||0;i.beforeInfo={origin:W.beforeOrigin,prevDeg:ne,defaultDeg:ne,prevSnapDeg:0,startDist:0},i.afterInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin}),i.absoluteInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin,startValue:ne})}else{var ae=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(ae){var ue=ae.getAttribute("data-direction")||"",de=s_e[ue];if(de){i.isControl=!0,i.isAroundControl=Dl(ae,mi("around-control")),i.controlDirection=de;var Pe=ae.getAttribute("data-resolve");Pe&&(i.resolveAble=Pe);var me=M1e(d.rootMatrix,d.renderPoses,L);r=Jt(Fl(me,de),2),J=r[0],H=r[1]}}i.beforeInfo={origin:W.beforeOrigin},i.afterInfo={origin:W.origin},i.absoluteInfo={origin:W.origin,startValue:W.rotation};var Ee=G;G=function(Me){var Re=d.is3d?4:3,He=Jt(Ta(aY(M,Re),Me),2),Fe=He[0],tt=He[1],Ze=Xu(N,vm([Fe,tt],Re)),Qe=Xu(z,vm([Me[0],Me[1]],Re));Ee(Me);var Ie=d.posDelta;i.beforeInfo.origin=vi(Ze,Ie),i.afterInfo.origin=vi(Qe,Ie),i.absoluteInfo.origin=vi(Qe,Ie),Y3(t,i.beforeInfo,J,H,L),Y3(t,i.afterInfo,J,H,L),Y3(t,i.absoluteInfo,J,H,L)},ie=function(Me){var Re=Fl([[0,0],[B,0],[0,q],[B,q]],Me);G(Re)}}i.startClientX=J,i.startClientY=H,i.direction=E,i.beforeDirection=P,i.startValue=0,i.datas={},cT(t,e,"rotate");var we=!1,Ae=!1;if(i.isControl&&i.resolveAble){var ce=i.resolveAble;ce==="resizable"&&(Ae=vk.dragControlStart(t,Wt(Wt({},new n0("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}Ae||(we=ac.dragStart(t,new n0().dragStart([0,0],e))),G(R1e(t));var xe=Xi(t,e,Wt(Wt({set:function(Me){i.startValue=Me*Math.PI/180},setFixedDirection:ie,setFixedPosition:G},uT(t,e)),{dragStart:we,resizeStart:Ae})),_e=Zn(t,"onRotateStart",xe);return i.isRotate=_e!==!1,d.snapRenderInfo={request:e.isRequest},i.isRotate?xe:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,u=e.parentRotate,h=e.parentFlag,f=e.isPinch,d=e.groupDelta,b=e.resolveMatrix,v=a.beforeDirection,S=a.beforeInfo,E=a.afterInfo,P=a.absoluteInfo,k=a.isRotate,L=a.startValue,N=a.rect,M=a.startClientX,z=a.startClientY;if(k){sT(t,e,"rotate");var B=u_e(e),q=v*B,W=t.props.parentMoveable,G=0,ie,J,H=0,ne,ae,ue=0,de,Pe,me=180/Math.PI*L,Ee=P.startValue,we=!1,Ae=M+s,ce=z+o;if(!h&&"parentDist"in e){var xe=e.parentDist;ie=xe,ne=xe,de=xe}else f||h?(ie=yw(u,v,S),ne=yw(u,q,E),de=yw(u,q,P)):(ie=Z3(Ae,ce,v,S),ne=Z3(Ae,ce,q,E),de=Z3(Ae,ce,q,P),we=!0);if(J=me+ie,ae=me+ne,Pe=Ee+de,Zn(t,"onBeforeRotate",Xi(t,e,{beforeRotation:J,rotation:ae,absoluteRotation:Pe,setRotation:function(Lt){ne=Lt-me,ie=ne,de=ne}},!0)),r=Jt(K3(t,N,S,ie,me,we),3),G=r[0],ie=r[1],J=r[2],n=Jt(K3(t,N,E,ne,me,we),3),H=n[0],ne=n[1],ae=n[2],i=Jt(K3(t,N,P,de,Ee,we),3),ue=i[0],de=i[1],Pe=i[2],!(!ue&&!H&&!G&&!W&&!b)){var _e=lT(a,"rotate(".concat(ae,"deg)"),"rotate(".concat(ne,"deg)"));b&&(a.fixedPosition=LO(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var Me=b_e(t,ne,a),Re=vi(Ta(d||[0,0],Me),a.prevInverseDist||[0,0]);a.prevInverseDist=Me,a.requestValue=null;var He=wY(t,_e,Re,f,e),Fe=He,tt=Ud([Ae,ce],P.startAbsoluteOrigin)-P.startDist,Ze=void 0;if(a.resolveAble==="resizable"){var Qe=vk.dragControl(t,Wt(Wt({},ex(e,t.state,[e.deltaX,e.deltaY],!!f,!1,"resizable")),{resolveMatrix:!0,parentDistance:tt}));Qe&&(Ze=Qe,Fe=rZ(Fe,Qe,e))}var Ie=Xi(t,e,Wt(Wt({delta:H,dist:ne,rotate:ae,rotation:ae,beforeDist:ie,beforeDelta:G,beforeRotate:J,beforeRotation:J,absoluteDist:de,absoluteDelta:ue,absoluteRotate:Pe,absoluteRotation:Pe,isPinch:!!f,resize:Ze},He),Fe));return Zn(t,"onRotate",Ie),Ie}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=ih(t,e,{});return Zn(t,"onRotateEnd",n),n}},dragGroupControlCondition:_k,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var u=Vd(t,this,"dragControlStart",e,function(d,b){var v=d.state,S=v.left,E=v.top,P=v.beforeOrigin,k=Ta(vi([S,E],[i,a]),vi(P,s));return b.datas.startGroupClient=k,b.datas.groupClient=k,Wt(Wt({},b),{parentRotate:0})}),h=Wt(Wt({},o),{targets:t.props.targets,events:u}),f=Zn(t,"onRotateGroupStart",h);return r.isRotate=f!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){gT(t,"onBeforeRotate",function(h){Zn(t,"onBeforeRotateGroup",Xi(t,e,Wt(Wt({},h),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=Vd(t,this,"dragControl",e,function(h,f){var d=f.datas.startGroupClient,b=Jt(f.datas.groupClient,2),v=b[0],S=b[1],E=Jt(Zb(d,s*i),2),P=E[0],k=E[1],L=[P-v,k-S];return f.datas.groupClient=[P,k],Wt(Wt({},f),{parentRotate:a,groupDelta:L})});t.rotation=i*n.beforeRotation;var u=Wt({targets:t.props.targets,events:o,set:function(h){t.rotation=h},setGroupRotation:function(h){t.rotation=h}},n);return Zn(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=Vd(t,this,"dragControlEnd",e),a=ih(t,e,{targets:t.props.targets,events:i});return Zn(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function n1e(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,u=t.key,h=n==="horizontal",f=h?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(r={},r[h?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(f,"(-50%) scale").concat(f,"(").concat(o,")"),r)})}function UO(t,e){return n1e(Wt(Wt({},t),{classNames:bn([mi("line","guideline",t.direction)],Jt(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(Fi(r,.1),"px")})}),e)}function pz(t,e,r,n,i,a,s,o){var u=t.props.zoom;return r.map(function(h,f){var d=h.type,b=h.pos,v=[0,0];return v[s]=n,v[s?0:1]=-i+b,UO({key:"".concat(e,"TargetGuideline").concat(f),classNames:[mi("target","bold",d)],posValue:v,sizeValue:a,zoom:u,direction:e},o)})}function gz(t,e,r,n,i,a){var s=t.props,o=s.zoom,u=s.isDisplayInnerSnapDigit,h=e==="horizontal"?eg:tg,f=i[h.start],d=i[h.end];return r.filter(function(b){var v=b.hide,S=b.elementRect;if(v)return!1;if(u&&S){var E=S.rect;if(E[h.start]<=f&&d<=E[h.end])return!1}return!0}).map(function(b,v){var S=b.pos,E=b.size,P=b.element,k=b.className,L=[-n[0]+S[0],-n[1]+S[1]];return UO({key:"".concat(e,"-default-guideline-").concat(v),classNames:P?[mi("bold"),k]:[mi("normal"),k],direction:e,posValue:L,sizeValue:E,zoom:o},a)})}function K_(t,e,r,n,i,a,s,o){var u,h=t.props,f=h.snapDigit,d=f===void 0?0:f,b=h.isDisplaySnapDigit,v=b===void 0?!0:b,S=h.snapDistFormat,E=S===void 0?function(z,B){return z}:S,P=h.zoom,k=e==="horizontal"?"X":"Y",L=e==="vertical"?"height":"width",N=Math.abs(i),M=v?parseFloat(N.toFixed(d)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:mi("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[L]="".concat(N,"px"),u)},UO({direction:e,classNames:[mi(r),s],size:"100%",posValue:[0,0],sizeValue:N,zoom:P},o),o.createElement("div",{className:mi("size-value","gap"),style:{transform:"translate".concat(k,"(-50%) scale(").concat(P,")")}},M>0?E(M,e):""))}function i1e(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?eg:tg,o=r[s.start],u=r[s.end];return nZ(e,function(h){return h.pos[i]}).map(function(h){var f=[],d=[],b=[];return h.forEach(function(v){var S,E,P=v.element,k=v.elementRect.rect;if(k[s.end]<o)f.push(v);else if(u<k[s.start])d.push(v);else if(k[s.start]<=o&&u<=k[s.end]&&n){var L=v.pos,N={element:P,rect:Wt(Wt({},k),(S={},S[s.end]=k[s.start],S))},M={element:P,rect:Wt(Wt({},k),(E={},E[s.start]=k[s.end],E))},z=[0,0],B=[0,0];z[i]=L[i],z[a]=L[a],B[i]=L[i],B[a]=L[a]+v.size,f.push({type:t,pos:z,size:0,elementRect:N,direction:"",elementDirection:"end"}),d.push({type:t,pos:B,size:0,elementRect:M,direction:"",elementDirection:"start"})}}),f.sort(function(v,S){return S.pos[a]-v.pos[a]}),d.sort(function(v,S){return v.pos[a]-S.pos[a]}),{total:h,start:f,end:d,inner:b}})}function a1e(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var u=e.filter(function(P){return P.type===o}),h=o==="vertical"?1:0,f=h?0:1,d=i1e(o,u,n,a),b=h?tg:eg,v=h?eg:tg,S=n[b.start],E=n[b.end];d.forEach(function(P){var k=P.total,L=P.start,N=P.end,M=P.inner,z=r[f]+k[0].pos[f]-n[v.start],B=n;L.forEach(function(q){var W=q.elementRect.rect,G=B[b.start]-W[b.end];if(G>0){var ie=[0,0];ie[h]=r[h]+B[b.start]-S-G,ie[f]=z,s.push(K_(t,o,"dashed",s.length,G,ie,q.className,i))}B=W}),B=n,N.forEach(function(q){var W=q.elementRect.rect,G=W[b.start]-B[b.end];if(G>0){var ie=[0,0];ie[h]=r[h]+B[b.end]-S,ie[f]=z,s.push(K_(t,o,"dashed",s.length,G,ie,q.className,i))}B=W}),M.forEach(function(q){var W=q.elementRect.rect,G=S-W[b.start],ie=W[b.end]-E,J=[0,0],H=[0,0];J[h]=r[h]-G,J[f]=z,H[h]=r[h]+E-S,H[f]=z,s.push(K_(t,o,"dashed",s.length,G,J,q.className,i)),s.push(K_(t,o,"dashed",s.length,ie,H,q.className,i))})})}),s}function o1e(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(P){return P.type===s}).slice(0,1),u=s==="vertical"?0:1,h=u?0:1,f=u?tg:eg,d=u?eg:tg,b=n[f.start],v=n[f.end],S=n[d.start],E=n[d.end];o.forEach(function(P){var k=P.gap,L=P.gapRects,N=Math.max.apply(Math,bn([S],Jt(L.map(function(B){var q=B.rect;return q[d.start]})),!1)),M=Math.min.apply(Math,bn([E],Jt(L.map(function(B){var q=B.rect;return q[d.end]})),!1)),z=(N+M)/2;N===M||z===(S+E)/2||L.forEach(function(B){var q=B.rect,W=B.className,G=[r[0],r[1]];if(q[f.end]<b)G[u]+=q[f.end]-b;else if(v<q[f.start])G[u]+=q[f.start]-b-k;else return;G[h]+=z-S,a.push(K_(t,u?"vertical":"horizontal","gap",a.length,k,G,W,i))})})}),a}function bk(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,u=i.scrollWidth,h=i.clientHeight,f=i.clientWidth,d=i.clientLeft,b=i.clientTop,v=t.props,S=v.snapGap,E=S===void 0?!0:S,P=v.verticalGuidelines,k=v.horizontalGuidelines,L=v.snapThreshold,N=L===void 0?5:L,M=v.maxSnapElementGuidelineDistance,z=M===void 0?1/0:M,B=v.isDisplayGridGuidelines,q=bh(kh(t.state)),W=q.top,G=q.left,ie=q.bottom,J=q.right,H={top:W,left:G,bottom:ie,right:J,center:(G+J)/2,middle:(W+ie)/2},ne=c1e(t),ae=bn([],Jt(ne),!1),ue=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(Ee){return Ee*N});E&&ae.push.apply(ae,bn([],Jt(s1e(t,H,ue)),!1));var de=Wt({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(ae.push.apply(ae,bn([],Jt(u1e(t,s?u:f,s?o:h,d,b,de,B)),!1)),a){var Pe=i.left,me=i.top;de.left+=Pe,de.top+=me,de.right+=Pe,de.bottom+=me}return ae.push.apply(ae,bn([],Jt(qY(k||!1,P||!1,s?u:f,s?o:h,d,b,de)),!1)),ae=ae.filter(function(Ee){var we=Ee.element,Ae=Ee.elementRect,ce=Ee.type;if(!we||!Ae)return!0;var xe=Ae.rect;return $Y(H,xe,ce,z)}),ae}function s1e(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,u=t.state.elementRects,h=[];return[["vertical",eg,tg],["horizontal",tg,eg]].forEach(function(f){var d=Jt(f,3),b=d[0],v=d[1],S=d[2],E=e[v.start],P=e[v.end],k=e[v.center],L=e[S.start],N=e[S.end],M={left:r[0],top:r[1]};function z(W){var G=W.rect,ie=M[v.start];return G[v.end]<E+ie?E-G[v.end]:P-ie<G[v.start]?G[v.start]-P:-1}var B=u.filter(function(W){var G=W.rect;return G[S.start]>N||G[S.end]<L?!1:z(W)>0}).sort(function(W,G){return z(W)-z(G)}),q=[];B.forEach(function(W){B.forEach(function(G){if(W!==G){var ie=W.rect,J=G.rect,H=ie[S.start],ne=ie[S.end],ae=J[S.start],ue=J[S.end];H>ue||ae>ne||q.push([W,G])}})}),q.forEach(function(W){var G=Jt(W,2),ie=G[0],J=G[1],H=ie.rect,ne=J.rect,ae=H[v.start],ue=H[v.end],de=ne[v.start],Pe=ne[v.end],me=M[v.start],Ee=0,we=0,Ae=!1,ce=!1,xe=!1;if(ue<=E&&P<=de){if(ce=!0,Ee=(de-ue-(P-E))/2,we=ue+Ee+(P-E)/2,un(we-k)>me)return}else if(ue<de&&Pe<E+me){if(Ae=!0,Ee=de-ue,we=Pe+Ee,un(we-E)>me)return}else if(ue<de&&P-me<ae){if(xe=!0,Ee=de-ue,we=ae-Ee,un(we-P)>me)return}else return;Ee&&$Y(e,ne,b,a)&&(Ee>o||h.push({type:b,pos:b==="vertical"?[we,0]:[0,we],element:J.element,size:0,className:J.className,isStart:Ae,isCenter:ce,isEnd:xe,gap:Ee,hide:!0,gapRects:[ie,J],direction:"",elementDirection:""}))})}),h}function l1e(t,e,r,n){var i,a,s=t.props,o=t.state,u=s.snapGridAll,h=s.snapGridWidth,f=h===void 0?0:h,d=s.snapGridHeight,b=d===void 0?0:d,v=o.snapRenderInfo,S=v&&(((i=v.direction)===null||i===void 0?void 0:i[0])||((a=v.direction)===null||a===void 0?void 0:a[1])),E=t.moveables;if(u&&E&&S&&(f||b)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var P=t.getRect(),k=P.children,L=v.direction;if(k){var N=L.map(function(z,B){var q=B===0?{snapSize:f,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:b,posName:"top",sizeName:"height",clientOffset:n.top-r},W=q.snapSize,G=q.posName,ie=q.sizeName,J=q.clientOffset;if(!W)return{dir:z,multiple:1,snapSize:W,snapOffset:0};var H=P[ie],ne=P[G],ae=t0e(k.map(function(Ae){return[Ae[G]-ne,Ae[ie],H-Ae[ie]-Ae[G]+ne]})).filter(function(Ae){return Ae}).sort(function(Ae,ce){return Ae-ce}),ue=ae[0],de=ae.map(function(Ae){return Fi(Ae/ue,.1)*W}),Pe=1,me=Fi(H/ue,.1);for(Pe=1;Pe<=10&&!de.every(function(Ae){return Ae*Pe%1===0});++Pe);var Ee=(-z+1)/2,we=tS(ne-J,ne-J+H,Ee,1-Ee);return{multiple:me*Pe,dir:z,snapSize:W,snapOffset:Math.round(we/W)}}),M=N.map(function(z){return z.multiple||1});o.snapThresholdInfo.multiples=M,o.snapThresholdInfo.offset=N.map(function(z){return z.snapOffset}),N.forEach(function(z,B){z.snapSize})}}else o.snapThresholdInfo=null}function u1e(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,u=t.state,h=o.snapGridWidth,f=h===void 0?0:h,d=o.snapGridHeight,b=d===void 0?0:d,v=[],S=a.left,E=a.top,P=[0,0];l1e(t,n,i,a);var k=u.snapThresholdInfo,L=f,N=b;if(k&&(f*=k.multiples[0]||1,b*=k.multiples[1]||1,P=k.offset),b){for(var M=function(B){v.push({type:"horizontal",pos:[S,Fi(P[1]*N+B-i+E,.1)],className:mi("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},z=0;z<=r*2;z+=b)M(z);for(var z=-b;z>=-r;z-=b)M(z)}if(f){for(var M=function(q){v.push({type:"vertical",pos:[Fi(P[0]*L+q-n+S,.1),E],className:mi("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},z=0;z<=e*2;z+=f)M(z);for(var z=-f;z>=-e;z-=f)M(z)}return v}function $Y(t,e,r,n){return r==="horizontal"?un(t.right-e.left)<=n||un(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?un(t.bottom-e.top)<=n||un(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function c1e(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(b){return!b.refresh}),a=n.map(function(b){return sf(b)&&"element"in b?Wt(Wt({},b),{element:Kf(b.element,!0)}):{element:Kf(b,!0)}}).filter(function(b){return b.element}),s=x0e(i.map(function(b){return b.element}),a.map(function(b){return b.element})),o=s.maintained,u=s.added,h=[];o.forEach(function(b){var v=Jt(b,2),S=v[0],E=v[1];h[E]=i[S]}),h1e(t,u.map(function(b){return a[b]})).map(function(b,v){h[u[v]]=b}),e.elementRects=h;var f=FO(t.props.elementSnapDirections),d=[];return h.forEach(function(b){var v=b.element,S=b.top,E=S===void 0?f.top:S,P=b.left,k=P===void 0?f.left:P,L=b.right,N=L===void 0?f.right:L,M=b.bottom,z=M===void 0?f.bottom:M,B=b.center,q=B===void 0?f.center:B,W=b.middle,G=W===void 0?f.middle:W,ie=b.className,J=b.rect,H=BO({top:E,right:N,left:k,bottom:z,center:q,middle:G},J),ne=H.horizontal,ae=H.vertical,ue=H.horizontalNames,de=H.verticalNames,Pe=J.top,me=J.left,Ee=J.right-me,we=J.bottom-Pe,Ae=[Ee,we];ae.forEach(function(ce,xe){d.push({type:"vertical",element:v,pos:[Fi(ce,.1),Pe],size:we,sizes:Ae,className:ie,elementRect:b,elementDirection:oz[de[xe]]||de[xe],direction:""})}),ne.forEach(function(ce,xe){d.push({type:"horizontal",element:v,pos:[me,Fi(ce,.1)],size:Ee,sizes:Ae,className:ie,elementRect:b,elementDirection:oz[ue[xe]]||ue[xe],direction:""})})}),d}function mz(t,e){return t?t.map(function(r){var n=sf(r)?r:{pos:r},i=n.pos;return rb(i)?n:Wt(Wt({},n),{pos:bo(i,e)})}):[]}function qY(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],u=s.left,h=s.top,f=s.bottom,d=s.right,b=r+d-u,v=n+f-h;return mz(t,v).forEach(function(S){o.push({type:"horizontal",pos:[u,Fi(S.pos-a+h,.1)],size:b,className:S.className,direction:""})}),mz(e,b).forEach(function(S){o.push({type:"vertical",pos:[Fi(S.pos-i+u,.1),h],size:v,className:S.className,direction:""})}),o}function h1e(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,u=s?4:3,h=Jt(L_e(a,i,u),2),f=h[0],d=h[1],b=r?0:o[0],v=r?0:o[1];return e.map(function(S){var E=S.element.getBoundingClientRect(),P=E.left-f-b,k=E.top-d-v,L=k+E.height,N=P+E.width,M=Jt(o0(a,[P,k],u),2),z=M[0],B=M[1],q=Jt(o0(a,[N,L],u),2),W=q[0],G=q[1];return Wt(Wt({},S),{rect:{left:z,right:W,top:B,bottom:G,center:(z+W)/2,middle:(B+G)/2}})})}function y2(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=Kf(n,!0);if(s){var o=k1(s),u=wz(e,[o.left-i.left,o.top-i.top]),h=wz(e,[o.right-i.right,o.bottom-i.bottom]);a.left=Fi(u[0],1e-5),a.top=Fi(u[1],1e-5),a.right=Fi(h[0],1e-5),a.bottom=Fi(h[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=bk(t),e.enableSnap=!0,!0}function HY(t,e,r,n,i,a){var s=Vm(t,e,r,a?4:3),o=Fl(s,n);return $O(s,vi(i,o))}function yz(t){return t?t/un(t):0}function f1e(t,e,r,n,i,a){var s=a.fixedDirection,o=z_e(r,s,n),u=jO(t,e,r,n),h=bn(bn([],Jt(K_e(t,e,o,n,i,a)),!1),Jt(zY(t,u,a)),!1),f=oS(h,0),d=oS(h,1);return{width:{isBound:f.isBound,offset:f.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function d1e(t,e,r,n,i,a,s,o,u){var h=Fl(e,s),f=dT(t,o,{vertical:[h[0]],horizontal:[h[1]]}),d=f.horizontal.offset,b=f.vertical.offset;if(Fi(b,dk)||Fi(d,dk)){var v=Jt(ld({datas:u,distX:-b,distY:-d}),2),S=v[0],E=v[1],P=Math.min(i||1/0,r+s[0]*S),k=Math.min(a||1/0,n+s[1]*E);return[P-r,k-n]}return[0,0]}function WY(t,e,r,n,i,a,s,o){for(var u=kh(t.state),h=t.props.keepRatio,f=0,d=0,b=0;b<2;++b){var v=e(f,d),S=f1e(t,v,i,h,s,o),E=S.width,P=S.height,k=E.isBound,L=P.isBound,N=E.offset,M=P.offset;if(b===1&&(k||(N=0),L||(M=0)),b===0&&s&&!k&&!L)return[0,0];if(h){var z=un(N)*(r?1/r:1),B=un(M)*(n?1/n:1),q=k&&L?z<B:L||!k&&z<B;q?N=r*M/n:M=n*N/r}f+=N,d+=M}if(!h&&i[0]&&i[1]){var W=Q_e(t,u,i,a,o),G=W.maxWidth,ie=W.maxHeight,J=Jt(d1e(t,e(f,d).map(function(ae){return ae.map(function(ue){return Fi(ue,dk)})}),r+f,n+d,G,ie,i,s,o),2),N=J[0],M=J[1];f+=N,d+=M}return[f,d]}function I1(t){return t<0&&(t=t%360+360),t%=360,t}function p1e(t,e){e=I1(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return un(t-n)<un(t-i)?n:i}function J3(t,e){t=I1(t),e=I1(e);var r=I1(t-e);return Math.min(r,360-r)}function g1e(t,e,r,n){var i,a=t.props,s=(i=a[MY])!==null&&i!==void 0?i:5,o=a[RY];if(O0(t,"rotatable")){var u=e.pos1,h=e.pos2,f=e.pos3,d=e.pos4,b=e.origin,v=r*Math.PI/180,S=[u,h,f,d].map(function(M){return vi(M,b)}),E=S.map(function(M){return Zb(M,v)}),P=bn(bn([],Jt(M_e(t,S,E,b,r)),!1),Jt(H_e(t,S,E,b,r)),!1);P.sort(function(M,z){return un(M-r)-un(z-r)});var k=P.length>0;if(k)return{isSnap:k,dist:k?P[0]:r}}if(o?.length&&s){var L=o.slice().sort(function(M,z){return J3(M,n)-J3(z,n)}),N=L[0];if(J3(N,n)<=s)return{isSnap:!0,dist:r+p1e(n,N)-n}}return{isSnap:!1,dist:r}}function m1e(t,e,r,n,i,a,s){if(!O0(t,"resizable"))return[0,0];var o=s.fixedDirection,u=s.nextAllMatrix,h=t.state,f=h.allMatrix,d=h.is3d;return WY(t,function(b,v){return HY(u||f,e+b,r+v,o,i,d)},e,r,n,i,a,s)}function y1e(t,e,r,n,i){if(!O0(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,u=i.fixedDirection,h=i.is3d,f=WY(t,function(d,b){return HY(m_e(i,Ta(e,[d/a,b/s])),a,s,u,o,h)},a,s,r,o,n,i);return[f[0]/a,f[1]/s]}function v1e(t,e){e.absolutePoses=kh(t.state)}function vz(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;nh(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return Wt(Wt({},n),{direction:i.direction})})}function _z(t,e,r,n,i,a){var s=DO(hT(t,a),e,r),o=s.vertical,u=s.horizontal,h=Sv();o.forEach(function(S){S.isBound&&(S.direction==="start"&&(h.left=!0),S.direction==="end"&&(h.right=!0),n.push({type:"bounds",pos:S.pos}))}),u.forEach(function(S){S.isBound&&(S.direction==="start"&&(h.top=!0),S.direction==="end"&&(h.bottom=!0),i.push({type:"bounds",pos:S.pos}))});var f=W_e(t),d=f.boundMap,b=f.vertical,v=f.horizontal;return b.forEach(function(S){Yd(n,function(E){var P=E.type,k=E.pos;return P==="bounds"&&k===S})>=0||n.push({type:"bounds",pos:S})}),v.forEach(function(S){Yd(i,function(E){var P=E.type,k=E.pos;return P==="bounds"&&k===S})>=0||i.push({type:"bounds",pos:S})}),{boundMap:h,innerBoundMap:d}}var _1e=WO("",["resizable","scalable"]),b1e={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",MY,RY,OY,NY,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,u=r.pos4,h=r.snapRenderInfo,f=t.props.snapRenderThreshold,d=f===void 0?1:f;if(!h||!h.render||!O0(t,""))return Tv(t,"boundMap",Sv(),function(_e){return JSON.stringify(_e)}),Tv(t,"innerBoundMap",Sv(),function(_e){return JSON.stringify(_e)}),[];r.guidelines=bk(t);var b=Math.min(a[0],s[0],o[0],u[0]),v=Math.min(a[1],s[1],o[1],u[1]),S=h.externalPoses||[],E=kh(t.state),P=[],k=[],L=[],N=[],M=[],z=bh(E),B=z.width,q=z.height,W=z.top,G=z.left,ie=z.bottom,J=z.right,H={left:G,right:J,top:W,bottom:ie,center:(G+J)/2,middle:(W+ie)/2},ne=S.length>0,ae=ne?bh(S):{};if(!h.request){if(h.direction&&M.push(B_e(t,E,h.direction,d,d)),h.snap){var ue=bh(E);h.center&&(ue.middle=(ue.top+ue.bottom)/2,ue.center=(ue.left+ue.right)/2),M.push(sz(t,ue,d,d))}ne&&(h.center&&(ae.middle=(ae.top+ae.bottom)/2,ae.center=(ae.left+ae.right)/2),M.push(sz(t,ae,d,d))),M.forEach(function(_e){var Me=_e.vertical.posInfos,Re=_e.horizontal.posInfos;P.push.apply(P,bn([],Jt(Me.filter(function(He){var Fe=He.guidelineInfos;return Fe.some(function(tt){var Ze=tt.guideline;return!Ze.hide})}).map(function(He){return{type:"snap",pos:He.pos}})),!1)),k.push.apply(k,bn([],Jt(Re.filter(function(He){var Fe=He.guidelineInfos;return Fe.some(function(tt){var Ze=tt.guideline;return!Ze.hide})}).map(function(He){return{type:"snap",pos:He.pos}})),!1)),L.push.apply(L,bn([],Jt(vz(Me)),!1)),N.push.apply(N,bn([],Jt(vz(Re)),!1))})}var de=_z(t,[G,J],[W,ie],P,k),Pe=de.boundMap,me=de.innerBoundMap;ne&&_z(t,[ae.left,ae.right],[ae.top,ae.bottom],P,k,h.externalBounds);var Ee=bn(bn([],Jt(L),!1),Jt(N),!1),we=Ee.filter(function(_e){return _e.element&&!_e.gapRects}),Ae=Ee.filter(function(_e){return _e.gapRects}).sort(function(_e,Me){return _e.gap-Me.gap});Zn(t,"onSnap",{guidelines:Ee.filter(function(_e){var Me=_e.element;return!Me}),elements:we,gaps:Ae},!0);var ce=Tv(t,"boundMap",Pe,function(_e){return JSON.stringify(_e)},Sv()),xe=Tv(t,"innerBoundMap",me,function(_e){return JSON.stringify(_e)},Sv());return(Pe===ce||me===xe)&&Zn(t,"onBound",{bounds:Pe,innerBounds:me},!0),bn(bn(bn(bn(bn(bn([],Jt(a1e(t,we,[b,v],H,e)),!1),Jt(o1e(t,Ae,[b,v],H,e)),!1),Jt(gz(t,"horizontal",N,[i,n],H,e)),!1),Jt(gz(t,"vertical",L,[i,n],H,e)),!1),Jt(pz(t,"horizontal",k,b,n,B,0,e)),!1),Jt(pz(t,"vertical",P,v,i,q,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},y2(t)},drag:function(t){var e=t.state;y2(t)||(e.guidelines=bk(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(_1e(t,e)||_k(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Dl(e.inputEvent.target,mi("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,y2(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,y2(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function x1e(t,e){return[t[0]*e[0],t[1]*e[1]]}function mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bve.apply(void 0,bn([RO],Jt(t),!1))}function GY(t){t()}function w1e(t){return!t||t==="none"?[1,0,0,1,0,0]:sf(t)?t:ib(t)}function P1(t,e,r){return rS(e,_m(r,e),t,_m(r.map(function(n){return-n}),e))}function S1e(t,e,r){if(e==="%"){var n=VO(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function E1e(t){var e=T1e(qO(t,":before"));return e.map(function(r,n){var i=Yb(r),a=i.value,s=i.unit;return a*S1e(t,s,n===0)})}function lS(t){return t?t.split(" "):["0","0"]}function T1e(t){return lS(t.transformOrigin)}function XY(t){var e=Pc(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(h){var f=i[h].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(d){return f[d]}).join(", "),")"))},u=0;u<a;++u)o(u);return s.join(" ")}return""}function ob(t,e,r,n,i){var a,s,o=EO(t)||hg(t),u=!1,h,f;if(!t||r)h=t;else{var d=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,b=t.parentElement;d?(u=!0,f=b,h=d):h=b}for(var v=!1,S=t===e||h===e,E="relative",P=1,k=parseFloat(i?.("zoom"))||1,L=i?.("position");h&&h!==o;){e===h&&(S=!0);var N=Pc(h),M=h.tagName.toLowerCase(),z=XY(h),B=N("willChange"),q=parseFloat(N("zoom"))||1;if(E=N("position"),n&&q!==1){P=q;break}if(!r&&n&&k!==1&&L&&L!=="absolute"||M==="svg"||M==="foreignobject"||E!=="static"||z&&z!=="none"||B==="transform")break;var W=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,G=h.parentNode;W&&(u=!0,f=G);var ie=G;if(ie&&ie.nodeType===11){h=ie.host,v=!0,E=Pc(h)("position");break}h=ie,E="relative"}return{offsetZoom:P,hasSlot:u,parentSlotElement:f,isCustomElement:v,isStatic:E==="static",isEnd:S||!h||h===o,offsetParent:h||o}}function C1e(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=Pc(t),o=_O(i),u=!o,h,f;return!u&&(n!=="svg"||t.ownerSVGElement)?(h=pY?E1e(t):lS(s("transformOrigin")).map(function(d){return parseFloat(d)}),f=h.slice(),u=!0,n==="svg"?(i=0,a=0):(r=Jt(P1e(t,h,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],h[0]=r[2],h[1]=r[3])):(h=lS(s("transformOrigin")).map(function(d){return parseFloat(d)}),f=h.slice()),{tagName:n,isSVG:o,hasOffset:u,offset:[i||0,a||0],origin:h,targetOrigin:f}}function YY(t,e){var r=Pc(t),n=Pc(hg(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function xk(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=lf(r,3,4))})}function A1e(t){for(var e=t.parentElement,r=!1,n=hg(t);e;){var i=qO(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function pT(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(oY(t,!e).join(","),")")}function VO(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function I1e(t,e){var r,n=VO(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,u=s/i,h=o/a,f=t.preserveAspectRatio.baseVal,d=f.align,b=f.meetOrSlice,v=[0,0],S=[u,h],E=[0,0];if(d!==1){var P=(d-2)%3,k=Math.floor((d-2)/3);v[0]=i*P/2,v[1]=a*k/2;var L=b===2?Math.max(h,u):Math.min(u,h);S[0]=L,S[1]=L,E[0]=(s-i)/2*P,E[1]=(o-a)/2*k}var N=CO(S,e);return r=Jt(E,2),N[e*(e-1)]=r[0],N[e*(e-1)+1]=r[1],P1(N,e,v)}function P1e(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=Pc(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=VO(t.ownerSVGElement),u=s.x,h=s.y;n==="foreignobject"&&!u&&!h&&(u=parseFloat(t.getAttribute("x"))||0,h=parseFloat(t.getAttribute("y"))||0);var f=u-o.x,d=h-o.y,b=a?e[0]:e[0]-f,v=a?e[1]:e[1]-d;return[f,d,b,v]}function ys(t,e,r){return Xu(t,vm(e,r),r)}function Vm(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return ys(t,i,n)})}function bh(t){var e=t.map(function(h){return h[0]}),r=t.map(function(h){return h[1]}),n=Math.min.apply(Math,bn([],Jt(e),!1)),i=Math.min.apply(Math,bn([],Jt(r),!1)),a=Math.max.apply(Math,bn([],Jt(e),!1)),s=Math.max.apply(Math,bn([],Jt(r),!1)),o=a-n,u=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:u}}function bz(t,e,r,n){var i=Vm(t,e,r,n);return bh(i)}function k1e(t,e,r,n,i){var a,s=t.target,o=t.origin,u=e.matrix,h=KY(s),f=h.offsetWidth,d=h.offsetHeight,b=r.getBoundingClientRect(),v=[0,0];r===hg(r)&&(v=YY(s,!0));for(var S=s.getBoundingClientRect(),E=S.left-b.left+r.scrollLeft-(r.clientLeft||0)+v[0],P=S.top-b.top+r.scrollTop-(r.clientTop||0)+v[1],k=S.width,L=S.height,N=rS(n,i,u),M=bz(N,f,d,n),z=M.left,B=M.top,q=M.width,W=M.height,G=ys(N,o,n),ie=vi(G,[z,B]),J=[E+ie[0]*k/q,P+ie[1]*L/W],H=[0,0],ne=0;++ne<10;){var ae=td(i,n);a=Jt(vi(ys(ae,J,n),ys(ae,G,n)),2),H[0]=a[0],H[1]=a[1];var ue=rS(n,i,_m(H,n),u),de=bz(ue,f,d,n),Pe=de.left,me=de.top,Ee=Pe-E,we=me-P;if(un(Ee)<2&&un(we)<2)break;J[0]-=Ee,J[1]-=we}return H.map(function(Ae){return Math.round(Ae)})}function M1e(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(u){return ys(t,u,i)}),s=r.left,o=r.top;return a.map(function(u){return[u[0]+s,u[1]+o]})}function Ph(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ZY(t,e){return Ph([e[0]-t[0],e[1]-t[1]])}function J_(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=Ws(t,e));var i=ZY(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function uS(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,u){return o+u[0]},0)/i,s=r.reduce(function(o,u){return o+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function xm(t,e){var r=t[e];return sf(r)?Wt(Wt({},t),r):t}function KY(t){var e=t&&!_O(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,u=0,h=0,f=0,d=0,b=0,v=0,S=1/0,E=1/0,P=1/0,k=1/0,L=0,N=0,M=!1;if(t)if(!e&&t.ownerSVGElement){var z=t.getBBox();M=!0,r=z.width,n=z.height,s=r,o=n,u=r,h=n,i=r,a=n}else{var B=Pc(t),q=t.style,W=B("boxSizing")==="border-box",G=parseFloat(B("borderLeftWidth"))||0,ie=parseFloat(B("borderRightWidth"))||0,J=parseFloat(B("borderTopWidth"))||0,H=parseFloat(B("borderBottomWidth"))||0,ne=parseFloat(B("paddingLeft"))||0,ae=parseFloat(B("paddingRight"))||0,ue=parseFloat(B("paddingTop"))||0,de=parseFloat(B("paddingBottom"))||0,Pe=ne+ae,me=ue+de,Ee=G+ie,we=J+H,Ae=Pe+Ee,ce=me+we,xe=B("position"),_e=0,Me=0;if("clientLeft"in t){var Re=null;if(xe==="absolute"){var He=ob(t,hg(t));Re=He.offsetParent}else Re=t.parentElement;if(Re){var Fe=Pc(Re);_e=parseFloat(Fe("width")),Me=parseFloat(Fe("height"))}}f=Math.max(Pe,bo(B("minWidth"),_e)||0),d=Math.max(me,bo(B("minHeight"),Me)||0),S=bo(B("maxWidth"),_e),E=bo(B("maxHeight"),Me),isNaN(S)&&(S=1/0),isNaN(E)&&(E=1/0),L=bo(q.width,0)||0,N=bo(q.height,0)||0,s=parseFloat(B("width"))||0,o=parseFloat(B("height"))||0,u=un(s-L)<1?nk(f,L||s,S):s,h=un(o-N)<1?nk(d,N||o,E):o,r=u,n=h,i=u,a=h,W?(P=S,k=E,b=f,v=d,u=r-Ae,h=n-ce):(P=S+Ae,k=E+ce,b=f+Ae,v=d+ce,r=u+Ae,n=h+ce),i=u+Pe,a=h+me}return{svg:M,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:h,inlineCSSWidth:L,inlineCSSHeight:N,cssWidth:s,cssHeight:o,minWidth:f,minHeight:d,maxWidth:S,maxHeight:E,minOffsetWidth:b,minOffsetHeight:v,maxOffsetWidth:P,maxOffsetHeight:k}}function JY(t,e){return Ws(e>0?t[0]:t[1],e>0?t[1]:t[0])}function v2(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function QY(t,e){var r=t===hg(t)||t===EO(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=Pc(t)("overflow")!=="visible",Wt(Wt({},e),n)}function Q3(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,u=e.top,h=e.left,f={left:h+i,top:u+s,right:h+a,bottom:u+o,width:a-i,height:o-s};return r&&n?QY(r,f):f}function k1(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?QY(t,o):o}function R1e(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,u=i.transformOrigin;return!r&&o&&n?XO(n,a,s):u}function eZ(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=tZ(a,n)}return i}function tZ(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function $O(t,e){return[Ta(e,t[0]),Ta(e,t[1]),Ta(e,t[2]),Ta(e,t[3])]}function kh(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return $O([n,i,a,s],[e,r])}function wk(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function Ev(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&wk(t,e),n?.unset(),t[r]=null}function sc(t,e){if(e){var r=R0(e);r.nextStyle=Wt(Wt({},r.nextStyle),t)}return{style:t,cssText:k0(t).map(function(n){return"".concat(Zve(n,"-"),": ").concat(t[n],";")}).join("")}}function rZ(t,e,r){var n=e.afterTransform||e.transform;return Wt(Wt({},sc(Wt(Wt(Wt({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function Xi(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=Wt(Wt({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function ih(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),Wt(Wt({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function gT(t,e,r){t._emitter.on(e,r)}function Zn(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function qO(t,e){return Wp(t).getComputedStyle(t,e)}function _2(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function Sk(t,e){return t===e||t==null&&e==null}function xz(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!_O(i))return i}return t[r]}function nZ(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),u=r[o]||[];o===-1&&(n.push(s),r.push(u)),u.push(i)}),r}function O1e(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function iZ(t){return t.reduce(function(e,r){return e.concat(r)},[])}function a0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return un(n)-un(r)}),t[0]}function o0(t,e,r){return Xu(td(t,r),vm(e,r),r)}function N1e(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=Jt(o0(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function ch(t,e,r,n){if(!r[0]&&!r[1])return e;var i=ys(t,[yz(r[0]||1),0],n),a=ys(t,[0,yz(r[1]||1)],n),s=ys(t,[r[0]/Ph(i),r[1]/Ph(a)],n);return Ta(e,s)}function Kh(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function cS(t){return un(t)<=uc?0:t}function HO(t){return function(e){if(!e.isDragging(t))return"";var r=S_e(e,t),n=r.deg;return n?mi("view-control-rotation".concat(n)):""}}function WO(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Dl(i,mi("direction"))&&(!t||Dl(i,mi(t)))}}function L1e(t,e,r){var n,i=r0(t,{"x%":function(z){return z/100*e.offsetWidth},"y%":function(z){return z/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",u=r<0?[]:t.slice(r),h=r<0?[]:t.slice(r+1),f=i.slice(0,r<0?void 0:r),d=i.slice(0,r<0?void 0:r+1),b=(n=i[r])!==null&&n!==void 0?n:r0([""])[0],v=r<0?[]:i.slice(r),S=r<0?[]:i.slice(r+1),E=b?[b]:[],P=Jy(f),k=Jy(d),L=Jy(v),N=Jy(S),M=xo(P,L,4);return{transforms:t,beforeFunctionMatrix:P,beforeFunctionMatrix2:k,targetFunctionMatrix:Jy(E),afterFunctionMatrix:L,afterFunctionMatrix2:N,allFunctionMatrix:M,beforeFunctions:f,beforeFunctions2:d,targetFunction:E[0],afterFunctions:v,afterFunctions2:S,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:u,afterFunctionTexts2:h}}function D1e(t){return!t||!sf(t)||TO(t)?!1:ru(t)||"length"in t}function Kf(t,e){return t?TO(t)?t:rp(t)?e?document.querySelector(t):t:bO(t)?t():nY(t)?t:"current"in t?t.current:t:null}function GO(t,e){if(!t)return[];var r=D1e(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return rp(i)&&e?bn(bn([],Jt(n),!1),Jt([].slice.call(document.querySelectorAll(i))),!1):(ru(i)?n.push(GO(i,e)):n.push(Kf(i,e)),n)},[])}function F1e(t,e,r){var n=Ws(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function wz(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=td(r,i);return n||(a=lf(a,3,4)),a[12]=0,a[13]=0,a[14]=0,f0e(a,e)}function aZ(t,e,r,n,i){var a=Jt(t,2),s=a[0],o=a[1],u=0,h=0;if(i&&s&&o){var f=Ws([0,0],e),d=Ws([0,0],n),b=Ph(e),v=Math.cos(f-d)*b;if(!n[0])h=v,u=h*r;else if(!n[1])u=v,h=u/r;else{var S=n[0]*s,E=n[1]*o,P=Math.atan2(S+e[0],E+e[1]),k=Math.atan2(S,E);P<0&&(P+=Math.PI*2),k<0&&(k+=Math.PI*2);var L=0;un(P-k)<Math.PI/2||un(P-k)>Math.PI/2*3||(k+=Math.PI),L=P-k,L>Math.PI*2?L-=Math.PI*2:L>Math.PI?L=2*Math.PI-L:L<-Math.PI&&(L=-2*Math.PI-L);var N=Ph([S+e[0],E+e[1]])*Math.cos(L);u=N*Math.sin(k)-S,h=N*Math.cos(k)-E,n[0]<0&&(u*=-1),n[1]<0&&(h*=-1)}}else u=n[0]*e[0],h=n[1]*e[1];return[u,h]}function oZ(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,u=0,h=0,f=n.distX,d=n.distY,b=n.pinchScale,v=n.parentDistance,S=n.parentDist,E=n.parentScale,P=r.fixedDirection,k=[0,1].map(function(q){return un(t[q]-P[q])}),L=[0,1].map(function(q){var W=k[q];return W!==0&&(W=2/W),W});if(S)u=S[0],h=S[1],e&&(u?h||(h=u/a):u=h*a);else if(rb(b))u=(b-1)*s,h=(b-1)*o;else if(E)u=(E[0]-1)*s,h=(E[1]-1)*o;else if(v){var N=s*k[0],M=o*k[1],z=Ph([N,M]);u=v/z*N*L[0],h=v/z*M*L[1]}else{var B=ld({datas:r,distX:f,distY:d});B=L.map(function(q,W){return B[W]*q}),i=Jt(aZ([s,o],B,a,t,e),2),u=i[0],h=i[1]}return{distWidth:u,distHeight:h}}function Ek(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=Jt(t.split(" "),2),n=r[0],i=r[1],a=Ek(n||""),s=Ek(i||""),o=Wt(Wt({},a),s),u={x:"50%",y:"50%"};return o.x&&(u.x=o.x),o.y&&(u.y=o.y),o.value&&(o.x&&!o.y&&(u.y=o.value),!o.x&&o.y&&(u.x=o.value)),u}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function XO(t,e,r){var n=Ek(t,!0),i=n.x,a=n.y;return[bo(i,e)||0,bo(a,r)||0]}function B1e(t,e,r){var n=t.map(function(a){return vi(a,e)}),i=n.map(function(a){return Zb(a,r)});return{prev:n,next:i,result:i.map(function(a){return Ta(a,e)})}}function sZ(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=ru(r),s=ru(i);return a&&s?sZ(r,i):!a&&!s?r===i:!1})}function Tv(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function oc(t){return t>=0?1:-1}function un(t){return Math.abs(t)}function eA(t,e){return e0e(t).map(function(r){return e(r)})}function lZ(t){return rb(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var z1e=Qb("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,u=s.ables;if(!o)return!1;var h="onPinch".concat(n?"Group":"","Start"),f="drag".concat(n?"Group":"","ControlStart"),d=(o===!0?t.controlAbles:u.filter(function(E){return o.indexOf(E.name)>-1})).filter(function(E){return E.canPinch&&E[f]}),b=Xi(t,e,{});n&&(b.targets=n);var v=Zn(t,h,b);r.isPinch=v!==!1,r.ables=d;var S=r.isPinch;return S?(d.forEach(function(E){if(a[E.name]=a[E.name]||{},!!E[f]){var P=Wt(Wt({},e),{datas:a[E.name],parentRotate:i,isPinch:!0});E[f](t,P)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},S):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,u=e.angle;if(r.isPinch){var h=i*(1-1/n),f=Xi(t,e,{});o&&(f.targets=o);var d="onPinch".concat(o?"Group":"");Zn(t,d,f);var b=r.ables,v="drag".concat(o?"Group":"","Control");return b.forEach(function(S){S[v]&&S[v](t,Wt(Wt({},e),{datas:a[S.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:h,parentRotate:u,isPinch:!0}))}),f}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),u=ih(t,e,{isDrag:n});a&&(u.targets=a),Zn(t,o,u);var h=r.ables,f="drag".concat(a?"Group":"","ControlEnd");return h.forEach(function(d){d[f]&&d[f](t,Wt(Wt({},e),{isDrag:n,datas:s[d.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Wt(Wt({},e),{targets:t.props.targets}))}}),Sz=WO("scalable"),j1e={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:IY("scalable"),dragControlCondition:Sz,viewClassName:HO("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=eZ(a,n,i,r),o=t.state,u=o.width,h=o.height,f=o.targetTransform,d=o.target,b=o.pos1,v=o.pos2,S=o.pos4;if(!s||!d)return!1;n||Um(t,e),r.datas={},r.transform=f,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=u,r.startOffsetHeight=h,r.startValue=[1,1];var E=!s[0]&&!s[1]||s[0]||!s[1];cT(t,e,"scale"),r.isWidth=E;function P(B){r.ratio=B&&isFinite(B)?B:0}r.startPositions=kh(t.state);function k(B){var q=jY(r.startPositions,B);r.fixedDirection=q.fixedDirection,r.fixedPosition=q.fixedPosition,r.fixedOffset=q.fixedOffset}r.setFixedDirection=k,P(Ud(b,v)/Ud(v,S)),k([-s[0],-s[1]]);var L=function(B){r.minScaleSize=B},N=function(B){r.maxScaleSize=B};L([-1/0,-1/0]),N([1/0,1/0]);var M=Xi(t,e,Wt(Wt({direction:s,set:function(B){r.startValue=B},setRatio:P,setFixedDirection:k,setMinScaleSize:L,setMaxScaleSize:N},uT(t,e)),{dragStart:ac.dragStart(t,new n0().dragStart([0,0],e))})),z=Zn(t,"onScaleStart",M);return r.startFixedDirection=r.fixedDirection,z!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?M:!1},dragControl:function(t,e){sT(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,u=e.useSnap,h=e.resolveMatrix,f=r.prevDist,d=r.direction,b=r.startOffsetWidth,v=r.startOffsetHeight,S=r.isScale,E=r.startValue,P=r.isWidth,k=r.ratio;if(!S)return!1;var L=t.props,N=L.throttleScale,M=L.parentMoveable,z=d;!d[0]&&!d[1]&&(z=[1,1]);var B=k&&(n??L.keepRatio)||!1,q=t.state,W=[E[0],E[1]];function G(){var Qe=oZ(z,B,r,e),Ie=Qe.distWidth,Lt=Qe.distHeight,at=b?(b+Ie)/b:1,Ve=v?(v+Lt)/v:1;E[0]||(W[0]=Ie/b),E[1]||(W[1]=Lt/v);var nr=(z[0]||B?at:1)*W[0],Yt=(z[1]||B?Ve:1)*W[1];return nr===0&&(nr=oc(f[0])*p2),Yt===0&&(Yt=oc(f[1])*p2),[nr,Yt]}var ie=G();if(!a&&t.props.groupable){var J=q.snapRenderInfo||{},H=J.direction;ru(H)&&(H[0]||H[1])&&(q.snapRenderInfo={direction:d,request:e.isRequest})}Zn(t,"onBeforeScale",Xi(t,e,{scale:ie,setFixedDirection:function(Qe){return r.setFixedDirection(Qe),ie=G(),ie},startFixedDirection:r.startFixedDirection,setScale:function(Qe){ie=Qe}},!0));var ne=[ie[0]/W[0],ie[1]/W[1]],ae=s,ue=[0,0],de=oc(ne[0]*ne[1]),Pe=!s&&!i&&a;if(Pe||h?ae=LO(t,r.targetAllTransform,[0,0],[0,0],r):s||(ae=r.fixedPosition),a||(ue=y1e(t,ne,d,!u&&o,r)),B){z[0]&&z[1]&&ue[0]&&ue[1]&&(Math.abs(ue[0]*b)>Math.abs(ue[1]*v)?ue[1]=0:ue[0]=0);var me=!ue[0]&&!ue[1];if(me&&(P?ne[0]=Fi(ne[0]*W[0],N)/W[0]:ne[1]=Fi(ne[1]*W[1],N)/W[1]),z[0]&&!z[1]||ue[0]&&!ue[1]||me&&P){ne[0]+=ue[0];var Ee=b*ne[0]*W[0]/k;ne[1]=oc(de*ne[0])*un(Ee/v/W[1])}else if(!z[0]&&z[1]||!ue[0]&&ue[1]||me&&!P){ne[1]+=ue[1];var we=v*ne[1]*W[1]*k;ne[0]=oc(de*ne[1])*un(we/b/W[0])}}else ne[0]+=ue[0],ne[1]+=ue[1],ue[0]||(ne[0]=Fi(ne[0]*W[0],N)/W[0]),ue[1]||(ne[1]=Fi(ne[1]*W[1],N)/W[1]);ne[0]===0&&(ne[0]=oc(f[0])*p2),ne[1]===0&&(ne[1]=oc(f[1])*p2),ie=x1e(ne,[W[0],W[1]]);var Ae=[b,v],ce=[b*ie[0],v*ie[1]];ce=eY(ce,r.minScaleSize,r.maxScaleSize,B?k:!1),ie=eA(2,function(Qe){return Ae[Qe]?ce[Qe]/Ae[Qe]:ce[Qe]}),ne=eA(2,function(Qe){return ie[Qe]/W[Qe]});var xe=eA(2,function(Qe){return f[Qe]?ne[Qe]/f[Qe]:ne[Qe]}),_e="scale(".concat(ne.join(", "),")"),Me="scale(".concat(ie.join(", "),")"),Re=lT(r,Me,_e),He=!E[0]||!E[1],Fe=y_e(t,He?Me:_e,r.fixedDirection,ae,r.fixedOffset,r,He),tt=Pe?Fe:vi(Fe,r.prevInverseDist||[0,0]);if(r.prevDist=ne,r.prevInverseDist=Fe,ie[0]===f[0]&&ie[1]===f[1]&&tt.every(function(Qe){return!Qe})&&!M&&!Pe)return!1;var Ze=Xi(t,e,Wt({offsetWidth:b,offsetHeight:v,direction:d,scale:ie,dist:ne,delta:xe,isPinch:!!a},wY(t,Re,tt,a,e)));return Zn(t,"onScale",Ze),Ze},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=ih(t,e,{});return Zn(t,"onScaleEnd",n),n},dragGroupControlCondition:Sz,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=af(t,"resizable",e);r.moveableScale=t.scale;var a=Vd(t,this,"dragControlStart",e,function(h,f){return aS(t,h,r,f)}),s=function(h){n.setFixedDirection(h),a.forEach(function(f,d){f.setFixedDirection(h),aS(t,f.moveable,r,i[d])})};r.setFixedDirection=s;var o=Wt(Wt({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),u=Zn(t,"onScaleGroupStart",o);return r.isScale=u!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){gT(t,"onBeforeScale",function(f){Zn(t,"onBeforeScaleGroup",Xi(t,e,Wt(Wt({},f),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,u=Vd(t,this,"dragControl",e,function(f,d){var b=Jt(Xu(Kb(t.rotation/180*Math.PI,3),[d.datas.originalX*i[0],d.datas.originalY*i[1],1],3),2),v=b[0],S=b[1];return Wt(Wt({},d),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:Ta(o,[v,S])})}),h=Wt({targets:t.props.targets,events:u},n);return Zn(t,"onScaleGroup",h),h}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=Vd(t,this,"dragControlEnd",e),a=ih(t,e,{targets:t.props.targets,events:i});return Zn(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function Sp(t,e){return t.map(function(r,n){return tS(r,e[n],1,2)})}function Ez(t,e,r){var n=Ws(t,e),i=Ws(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function U1e(t,e){var r=Ez(t[0],t[1],t[2]),n=Ez(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var V1e={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:HO("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,u=o.pos1,h=o.pos2,f=o.pos3,d=o.pos4,b=Sp(u,h),v=Sp(h,u),S=Sp(u,f),E=Sp(f,u),P=Sp(f,d),k=Sp(d,f),L=Sp(h,d),N=Sp(d,h);return bn([e.createElement("div",{className:mi("line"),key:"middeLine1",style:J_(b,P,s)}),e.createElement("div",{className:mi("line"),key:"middeLine2",style:J_(v,k,s)}),e.createElement("div",{className:mi("line"),key:"middeLine3",style:J_(S,L,s)}),e.createElement("div",{className:mi("line"),key:"middeLine4",style:J_(E,N,s)})],Jt(PY(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Dl(r,mi("direction"))&&Dl(r,mi("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=tZ(a,r);if(!s||!i)return!1;var o=t.state,u=o.transformOrigin,h=o.is3d,f=o.targetTransform,d=o.targetMatrix,b=o.width,v=o.height,S=o.left,E=o.top;r.datas={},r.targetTransform=f,r.warpTargetMatrix=h?d:lf(d,3,4),r.targetInverseMatrix=iY(td(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=S,r.top=E,r.poses=[[0,0],[b,0],[0,v],[b,v]].map(function(L){return vi(L,u)}),r.nextPoses=r.poses.map(function(L){var N=Jt(L,2),M=N[0],z=N[1];return Xu(r.warpTargetMatrix,[M,z,0,1],4)}),r.startValue=Wo(4),r.prevMatrix=Wo(4),r.absolutePoses=kh(o),r.posIndexes=xY(s),Um(t,e),cT(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var P=Xi(t,e,Wt({set:function(L){r.startValue=L}},uT(t,e))),k=Zn(t,"onWarpStart",P);return k!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,u=r.isWarp,h=r.startValue,f=r.poses,d=r.posIndexes,b=r.absolutePoses;if(!u)return!1;if(sT(t,e,"matrix3d"),O0(t,"warpable")){var v=d.map(function(G){return b[G]});v.length>1&&v.push([(v[0][0]+v[1][0])/2,(v[0][1]+v[1][1])/2]);var S=dT(t,n,{horizontal:v.map(function(G){return G[1]+a}),vertical:v.map(function(G){return G[0]+i})}),E=S.horizontal,P=S.vertical;a-=E.offset,i-=P.offset}var k=ld({datas:r,distX:i,distY:a},!0),L=r.nextPoses.slice();if(d.forEach(function(G){L[G]=Ta(L[G],k)}),!o_e.every(function(G){return U1e(G.map(function(ie){return f[ie]}),G.map(function(ie){return L[ie]}))}))return!1;var N=AO(f[0],f[2],f[1],f[3],L[0],L[2],L[1],L[3]);if(!N.length)return!1;var M=xo(s,N,4),z=_Y(r,M,!0),B=xo(td(o,4),z,4);r.prevMatrix=z;var q=xo(h,z,4),W=lT(r,"matrix3d(".concat(q.join(", "),")"),"matrix3d(".concat(z.join(", "),")"));return NO(e,W),Zn(t,"onWarp",Xi(t,e,Wt({delta:B,matrix:q,dist:z,multiply:xo,transform:W},sc({transform:W},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,Zn(t,"onWarpEnd",ih(t,e,{})),n):!1}},$1e=mi("area-pieces"),b2=mi("area-piece"),uZ=mi("avoid"),q1e=mi("view-dragging");function tA(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;rY(e,uZ),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function Tz(t){return t.createElement("div",{key:"area_pieces",className:$1e},t.createElement("div",{className:b2}),t.createElement("div",{className:b2}),t.createElement("div",{className:b2}),t.createElement("div",{className:b2}))}var cZ={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),u=o.width,h=o.height,f=o.renderPoses,d=s?mi("area","pass"):mi("area");if(a)return[e.createElement("div",{key:"area",ref:om(t,"areaElement"),className:d}),Tz(e)];if(!n||!i)return[];var b=AO([0,0],[u,0],[0,h],[u,h],f[0],f[1],f[2],f[3]),v=b.length?pT(b,!0):"none";return[e.createElement("div",{key:"area",ref:om(t,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(h,"px"),transformOrigin:"0 0",transform:v}}),Tz(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,u=o.moveableClientRect,h=o.renderPoses,f=o.rootMatrix,d=o.is3d,b=u.left,v=u.top,S=bh(h),E=S.left,P=S.top,k=S.width,L=S.height,N=d?4:3,M=Jt(o0(f,[n-b,i-v],N),2),z=M[0],B=M[1];z-=E,B-=P;var q=[{left:E,top:P,width:k,height:B-10},{left:E,top:P,width:z-10,height:L},{left:E,top:P+B+10,width:k,height:L-B-10},{left:E+z+10,top:P,width:k-z-10,height:L}],W=[].slice.call(s.nextElementSibling.children);q.forEach(function(G,ie){W[ie].style.cssText="left: ".concat(G.left,"px;top: ").concat(G.top,"px; width: ").concat(G.width,"px; height: ").concat(G.height,"px;")}),tY(s,uZ),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,tA(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||tA(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){tA(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&QX(function(){e.disableNativeEvent=!1})}},H1e=Qb("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,u=s.rotation,h=s.svg,f=s.allMatrix,d=s.is3d,b=s.left,v=s.top,S=s.offsetWidth,E=s.offsetHeight,P;if(!a&&h&&i){var k=Jt(XO(i,S,E),2),L=k[0],N=k[1],M=d?4:3,z=ys(f,[L,N],M);P=uS(u,n,vi(z,[b,v]))}else P=uS(u,n,o);return[e.createElement("div",{className:mi("control","origin"),style:P,key:"beforeOrigin"})]}});function W1e(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var G1e={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new T0e,o=Kf(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var u=e.isControl?"controlGesto":"targetGesto",h=e.targets;s.on("scroll",function(f){var d=f.container,b=f.direction,v=Xi(t,e,{scrollContainer:d,direction:b}),S=h?"onScrollGroup":"onScroll";h&&(v.targets=h),Zn(t,S,v)}).on("move",function(f){var d=f.offsetX,b=f.offsetY,v=f.inputEvent;t[u].scrollBy(d,b,v.inputEvent,!1)}).on("scrollDrag",function(f){var d=f.next;d(t[u].getCurrentEvent())}),s.dragStart(e,Wt({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,u=n.scrollThrottleTime,h=u===void 0?0:u,f=n.getScrollPosition,d=f===void 0?W1e:f,b=n.scrollOptions;return r.drag(e,Wt({container:a,threshold:o,throttleTime:h,getScrollPosition:function(v){return d({scrollContainer:v.container,direction:v.direction})}},b)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},hZ={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},X1e=Qb("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=lZ(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,u=t.getState(),h=u.renderPoses,f=u.pos1,d=u.pos2,b=u.pos3,v=u.pos4,S=[f,d,b,v],E=[];return i>0&&E.push([0,2]),a>0&&E.push([0,1]),s>0&&E.push([1,3]),o>0&&E.push([2,3]),E.map(function(P,k){var L=Jt(P,2),N=L[0],M=L[1],z=S[N],B=S[M],q=h[N],W=h[M],G=AO([0,0],[100,0],[0,100],[100,100],z,B,q,W);if(G.length)return e.createElement("div",{key:"padding".concat(k),className:mi("padding"),style:{transform:pT(G,!0)}})})}}),Cz=["nw","ne","se","sw"];function x2(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var Y1e=[1,2,5,6],Z1e=[0,3,4,7],Wg=[1,-1,-1,1],Gg=[1,1,-1,-1];function YO(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var u=[],h=!1,f=t.filter(function(b){return!b.virtual}),d=f.map(function(b){var v=b.horizontal,S=b.vertical,E=b.pos;if(S&&!h&&(h=!0,u.push("/")),h){var P=Math.max(0,S===1?E[1]-a:o-E[1]);return u.push(Kh(P,n,e)),P}else{var P=Math.max(0,v===1?E[0]-i:s-E[0]);return u.push(Kh(P,r,e)),P}});return{radiusPoses:f,styles:u,raws:d}}function fZ(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function dZ(t,e,r,n,i,a,s){var o,u,h,f;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var d=t.indexOf("/"),b=(d>-1?t.slice(0,d):t).length,v=t.slice(0,b),S=t.slice(b+1),E=v.length,P=S.length,k=P>0,L=Jt(v,4),N=L[0],M=N===void 0?"0px":N,z=L[1],B=z===void 0?M:z,q=L[2],W=q===void 0?M:q,G=L[3],ie=G===void 0?B:G,J=Jt(S,4),H=J[0],ne=H===void 0?M:H,ae=J[1],ue=ae===void 0?k?ne:B:ae,de=J[2],Pe=de===void 0?k?ne:W:de,me=J[3],Ee=me===void 0?k?ue:ie:me,we=[M,B,W,ie].map(function(Re){return bo(Re,e)}),Ae=[ne,ue,Pe,Ee].map(function(Re){return bo(Re,r)}),ce=we.slice(),xe=Ae.slice();o=Jt(x2([ce[0],ce[1]],e),2),ce[0]=o[0],ce[1]=o[1],u=Jt(x2([ce[3],ce[2]],e),2),ce[3]=u[0],ce[2]=u[1],h=Jt(x2([xe[0],xe[3]],r),2),xe[0]=h[0],xe[3]=h[1],f=Jt(x2([xe[1],xe[2]],r),2),xe[1]=f[0],xe[2]=f[1];var _e=s?ce:ce.slice(0,Math.max(a[0],E)),Me=s?xe:xe.slice(0,Math.max(a[1],P));return bn(bn([],Jt(_e.map(function(Re,He){var Fe=Cz[He];return{virtual:He>=E,horizontal:Wg[He],vertical:0,pos:[n+Re,i+(Gg[He]===-1?r:0)],sub:!0,raw:we[He],direction:Fe}})),!1),Jt(Me.map(function(Re,He){var Fe=Cz[He];return{virtual:He>=P,horizontal:0,vertical:Gg[He],pos:[n+(Wg[He]===-1?e:0),i+Re],sub:!0,raw:Ae[He],direction:Fe}})),!1)}function K1e(t,e,r,n,i){i===void 0&&(i=e.length);var a=fZ(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,u=r-n,h=0;if(u===0)h=i;else if(u>0&&u<s[1])h=s[1]-u;else if(u>=o[0])h=o[0]+o[1]-u;else return;t.splice(r,h),e.splice(r,h)}function J1e(t,e,r,n,i,a,s,o,u,h,f){h===void 0&&(h=0),f===void 0&&(f=0);var d=fZ(t.slice(r)),b=d.horizontalRange,v=d.verticalRange;if(n>-1)for(var S=Wg[n]===1?a-h:o-a,E=b[1];E<=n;++E){var P=Gg[E]===1?f:u,k=0;if(n===E?k=a:E===0?k=h+S:Wg[E]===-1&&(k=o-(e[r][0]-h)),t.splice(r+E,0,{horizontal:Wg[E],vertical:0,pos:[k,P]}),e.splice(r+E,0,[k,P]),E===0)break}else if(i>-1){var L=Gg[i]===1?s-f:u-s;if(b[1]===0&&v[1]===0){var N=[h+L,f];t.push({horizontal:Wg[0],vertical:0,pos:N}),e.push(N)}for(var M=v[0],E=v[1];E<=i;++E){var k=Wg[E]===1?h:o,P=0;if(i===E?P=s:E===0?P=f+L:Gg[E]===1?P=e[r+M][1]:Gg[E]===-1&&(P=u-(e[r+M][1]-f)),t.push({horizontal:0,vertical:Gg[E],pos:[k,P]}),e.push([k,P]),E===0)break}}}function Q1e(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var ebe=[[0,-1,"n"],[1,0,"e"]],tbe=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function ZO(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,u=o.type,h=o.poses,f=u==="rect",d=u==="circle";if(u==="polygon")return r.map(function(B){return"".concat(Kh(B[0],a,n)," ").concat(Kh(B[1],s,n))});if(f||u==="inset"){var b=r[1][1],v=r[3][0],S=r[7][0],E=r[5][1];if(f)return[b,v,E,S].map(function(B){return"".concat(B,"px")});var P=[b,a-v,s-E,S].map(function(B,q){return Kh(B,q%2?a:s,n)});if(r.length>8){var k=Jt(vi(r[4],r[0]),2),L=k[0],N=k[1];P.push.apply(P,bn(["round"],Jt(YO(h.slice(8).map(function(B,q){return Wt(Wt({},B),{pos:r[q]})}),n,L,N,S,b,v,E).styles),!1))}return P}else if(d||u==="ellipse"){var M=r[0],z=Kh(un(r[1][1]-M[1]),d?Math.sqrt((a*a+s*s)/2):s,n),P=d?[z]:[Kh(un(r[2][0]-M[0]),a,n),z];return P.push("at",Kh(M[0],a,n),Kh(M[1],s,n)),P}}function hS(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return tbe.map(function(s){var o=Jt(s,3),u=o[0],h=o[1],f=o[2],d=i[u+1],b=a[h+1];return{vertical:un(h),horizontal:un(u),direction:f,pos:[d,b]}})}function pZ(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[un(e[1]-e[0]),un(r[1]-r[0])]}function Az(t,e,r,n,i){var a,s,o,u,h,f,d,b,v;if(t){var S=i;if(!S){var E=Pc(t),P=E("clipPath");S=P!=="none"?P:E("clip")}if(!((!S||S==="none"||S==="auto")&&(S=n,!S))){var k=JX(S),L=k.prefix,N=L===void 0?S:L,M=k.value,z=M===void 0?"":M,B=N==="circle",q=" ";if(N==="polygon"){var W=Kg(z||"0% 0%, 100% 0%, 100% 100%, 0% 100%");q=",";var G=W.map(function(Tr){var mr=Jt(Tr.split(" "),2),Mr=mr[0],Pr=mr[1];return{vertical:1,horizontal:1,pos:[bo(Mr,e),bo(Pr,r)]}}),ie=bm(G.map(function(Tr){return Tr.pos}));return{type:N,clipText:S,poses:G,splitter:q,left:ie.minX,right:ie.maxX,top:ie.minY,bottom:ie.maxY}}else if(B||N==="ellipse"){var J="",H="",ne=0,ae=0,W=Qp(z);if(B){var ue="";a=Jt(W,4),s=a[0],ue=s===void 0?"50%":s,o=a[2],J=o===void 0?"50%":o,u=a[3],H=u===void 0?"50%":u,ne=bo(ue,Math.sqrt((e*e+r*r)/2)),ae=ne}else{var de="",Pe="";h=Jt(W,5),f=h[0],de=f===void 0?"50%":f,d=h[1],Pe=d===void 0?"50%":d,b=h[3],J=b===void 0?"50%":b,v=h[4],H=v===void 0?"50%":v,ne=bo(de,e),ae=bo(Pe,r)}var me=[bo(J,e),bo(H,r)],G=bn([{vertical:1,horizontal:1,pos:me,direction:"nesw"}],Jt(ebe.slice(0,B?1:2).map(function(Mr){return{vertical:un(Mr[1]),horizontal:Mr[0],direction:Mr[2],sub:!0,pos:[me[0]+Mr[0]*ne,me[1]+Mr[1]*ae]}})),!1);return{type:N,clipText:S,radiusX:ne,radiusY:ae,left:me[0]-ne,top:me[1]-ae,right:me[0]+ne,bottom:me[1]+ae,poses:G,splitter:q}}else if(N==="inset"){var W=Qp(z||"0 0 0 0"),Ee=W.indexOf("round"),we=(Ee>-1?W.slice(0,Ee):W).length,Ae=W.slice(we+1),ce=Jt(W.slice(0,we),4),xe=ce[0],_e=ce[1],Me=_e===void 0?xe:_e,Re=ce[2],He=Re===void 0?xe:Re,Fe=ce[3],tt=Fe===void 0?Me:Fe,Ze=Jt([xe,He].map(function(Mr){return bo(Mr,r)}),2),Qe=Ze[0],Ie=Ze[1],Lt=Jt([tt,Me].map(function(Mr){return bo(Mr,e)}),2),at=Lt[0],Ve=Lt[1],nr=e-Ve,Yt=r-Ie,yr=dZ(Ae,nr-at,Yt-Qe,at,Qe),G=bn(bn([],Jt(hS(Qe,nr,Yt,at)),!1),Jt(yr),!1);return{type:"inset",clipText:S,poses:G,top:Qe,left:at,right:nr,bottom:Yt,radius:Ae,splitter:q}}else if(N==="rect"){var W=Kg(z||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));q=",";var mt=Jt(W.map(function(fr){var Nr=Yb(fr).value;return Nr}),4),br=mt[0],Ve=mt[1],Ie=mt[2],at=mt[3],G=hS(br,Ve,Ie,at);return{type:"rect",clipText:S,poses:G,top:br,right:Ve,bottom:Ie,left:at,values:W,splitter:q}}}}}function rbe(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,u=t.map(function(){return[0,0]}),h=s?s.split(""):[];if(n&&e<8){var f=h.filter(function(ne){return ne==="w"||ne==="e"}),d=h.filter(function(ne){return ne==="n"||ne==="s"}),b=f[0],v=d[0];u[e]=r;var S=Jt(pZ(t),2),E=S[0],P=S[1],k=E&&P?E/P:0;if(k&&i){var L=(e+4)%8,N=t[L].pos,M=[0,0];s.indexOf("w")>-1?M[0]=-1:s.indexOf("e")>-1&&(M[0]=1),s.indexOf("n")>-1?M[1]=-1:s.indexOf("s")>-1&&(M[1]=1);var z=aZ([E,P],r,k,M,!0),B=E+z[0],q=P+z[1],W=N[1],G=N[1],ie=N[0],J=N[0];M[0]===-1?ie=J-B:M[0]===1?J=ie+B:(ie=ie-B/2,J=J+B/2),M[1]===-1?W=G-q:(M[1]===1||(W=G-q/2),G=W+q);var H=hS(W,J,G,ie);t.forEach(function(ne,ae){u[ae][0]=H[ae].pos[0]-ne.pos[0],u[ae][1]=H[ae].pos[1]-ne.pos[1]})}else t.forEach(function(ne,ae){var ue=ne.direction;ue&&(ue.indexOf(b)>-1&&(u[ae][0]=r[0]),ue.indexOf(v)>-1&&(u[ae][1]=r[1]))}),b&&(u[1][0]=r[0]/2,u[5][0]=r[0]/2),v&&(u[3][1]=r[1]/2,u[7][1]=r[1]/2)}else s&&!o?h.forEach(function(ne){var ae=ne==="n"||ne==="s";t.forEach(function(ue,de){var Pe=ue.direction,me=ue.horizontal,Ee=ue.vertical;!Pe||Pe.indexOf(ne)===-1||(u[de]=[ae||!me?0:r[0],!ae||!Ee?0:r[1]])})}):u[e]=r;return u}function nbe(t,e){var r=Jt(vY(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,u=s,h=u.type,f=u.poses,d=u.splitter,b=f.map(function(L){return L.pos});if(h==="polygon")b.splice(o,0,[n,i]);else if(h==="inset"){var v=Y1e.indexOf(o),S=Z1e.indexOf(o),E=f.length;if(J1e(f,b,8,v,S,n,i,b[4][0],b[4][1],b[0][0],b[0][1]),E===f.length)return}else return;var P=ZO(t,s,b),k="".concat(h,"(").concat(P.join(d),")");Zn(t,"onClip",Xi(t,e,Wt({clipEventType:"added",clipType:h,poses:b,clipStyles:P,clipStyle:k,distX:0,distY:0},sc({clipPath:k},e))))}function ibe(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,u=a.splitter,h=o.map(function(v){return v.pos}),f=h.length;if(s==="polygon")o.splice(i,1),h.splice(i,1);else if(s==="inset"){if(i<8||(K1e(o,h,i,8,f),f===o.length))return}else return;var d=ZO(t,n,h),b="".concat(s,"(").concat(d.join(u),")");Zn(t,"onClip",Xi(t,e,Wt({clipEventType:"removed",clipType:s,poses:h,clipStyles:d,clipStyle:b,distX:0,distY:0},sc({clipPath:b},e))))}var abe={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,u=t.getState(),h=u.target,f=u.width,d=u.height,b=u.allMatrix,v=u.is3d,S=u.left,E=u.top,P=u.pos1,k=u.pos2,L=u.pos3,N=u.pos4,M=u.clipPathState,z=u.snapBoundInfos,B=u.rotation;if(!h||o)return[];var q=Az(h,f,d,i||"inset",M||n);if(!q)return[];var W=v?4:3,G=q.type,ie=q.poses,J=ie.map(function(Ve){var nr=ys(b,Ve.pos,W);return[nr[0]-S,nr[1]-E]}),H=[],ne=[],ae=G==="rect",ue=G==="inset",de=G==="polygon";if(ae||ue||de){var Pe=ue?J.slice(0,8):J;ne=Pe.map(function(Ve,nr){var Yt=nr===0?Pe[Pe.length-1]:Pe[nr-1],yr=Ws(Yt,Ve),mt=ZY(Yt,Ve);return e.createElement("div",{key:"clipLine".concat(nr),className:mi("line","clip-line","snap-control"),"data-clip-index":nr,style:{width:"".concat(mt,"px"),transform:"translate(".concat(Yt[0],"px, ").concat(Yt[1],"px) rotate(").concat(yr,"rad) scaleY(").concat(s,")")}})})}if(H=J.map(function(Ve,nr){return e.createElement("div",{key:"clipControl".concat(nr),className:mi("control","clip-control","snap-control"),"data-clip-index":nr,style:{transform:"translate(".concat(Ve[0],"px, ").concat(Ve[1],"px) rotate(").concat(B,"rad) scale(").concat(s,")")}})}),ue&&H.push.apply(H,bn([],Jt(J.slice(8).map(function(Ve,nr){return e.createElement("div",{key:"clipRadiusControl".concat(nr),className:mi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+nr,style:{transform:"translate(".concat(Ve[0],"px, ").concat(Ve[1],"px) rotate(").concat(B,"rad) scale(").concat(s,")")}})})),!1)),G==="circle"||G==="ellipse"){var me=q.left,Ee=q.top,we=q.radiusX,Ae=q.radiusY,ce=Jt(vi(ys(b,[me,Ee],W),ys(b,[0,0],W)),2),xe=ce[0],_e=ce[1],Me="none";if(!a){for(var Re=Math.max(10,we/5,Ae/5),He=[],Fe=0;Fe<=Re;++Fe){var tt=Math.PI*2/Re*Fe;He.push([we+(we-s)*Math.cos(tt),Ae+(Ae-s)*Math.sin(tt)])}He.push([we,-2]),He.push([-2,-2]),He.push([-2,Ae*2+2]),He.push([we*2+2,Ae*2+2]),He.push([we*2+2,-2]),He.push([we,-2]),Me="polygon(".concat(He.map(function(Ve){return"".concat(Ve[0],"px ").concat(Ve[1],"px")}).join(", "),")")}H.push(e.createElement("div",{key:"clipEllipse",className:mi("clip-ellipse","snap-control"),style:{width:"".concat(we*2,"px"),height:"".concat(Ae*2,"px"),clipPath:Me,transform:"translate(".concat(-S+xe,"px, ").concat(-E+_e,"px) ").concat(pT(b))}}))}if(a){var Ze=bh(bn([P,k,L,N],Jt(J),!1)),Qe=Ze.width,Ie=Ze.height,Lt=Ze.left,at=Ze.top;if(de||ae||ue){var He=ue?J.slice(0,8):J;H.push(e.createElement("div",{key:"clipArea",className:mi("clip-area","snap-control"),style:{width:"".concat(Qe,"px"),height:"".concat(Ie,"px"),transform:"translate(".concat(Lt,"px, ").concat(at,"px)"),clipPath:"polygon(".concat(He.map(function(nr){return"".concat(nr[0]-Lt,"px ").concat(nr[1]-at,"px")}).join(", "),")")}}))}}return z&&["vertical","horizontal"].forEach(function(Ve){var nr=z[Ve],Yt=Ve==="horizontal";nr.isSnap&&ne.push.apply(ne,bn([],Jt(nr.snap.posInfos.map(function(yr,mt){var br=yr.pos,Tr=vi(ys(b,Yt?[0,br]:[br,0],W),[S,E]),mr=vi(ys(b,Yt?[f,br]:[br,d],W),[S,E]);return ab(e,"",Tr,mr,s,"clip".concat(Ve,"snap").concat(mt),"guideline")})),!1)),nr.isBound&&ne.push.apply(ne,bn([],Jt(nr.bounds.map(function(yr,mt){var br=yr.pos,Tr=vi(ys(b,Yt?[0,br]:[br,0],W),[S,E]),mr=vi(ys(b,Yt?[f,br]:[br,d],W),[S,E]);return ab(e,"",Tr,mr,s,"clip".concat(Ve,"bounds").concat(mt),"guideline","bounds","bold")})),!1))}),bn(bn([],Jt(H),!1),Jt(ne),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Wt(Wt({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,u=r.height,h=e.inputEvent?e.inputEvent.target:null,f=h&&h.getAttribute("class")||"",d=e.datas,b=Az(s,o,u,i||"inset",a);if(!b)return!1;var v=b.clipText,S=b.type,E=b.poses,P=Zn(t,"onClipStart",Xi(t,e,{clipType:S,clipStyle:v,poses:E.map(function(k){return k.pos})}));return P===!1?(d.isClipStart=!1,!1):(d.isControl=f&&f.indexOf("clip-control")>-1,d.isLine=f.indexOf("clip-line")>-1,d.isArea=f.indexOf("clip-area")>-1||f.indexOf("clip-ellipse")>-1,d.clipIndex=h?parseInt(h.getAttribute("data-clip-index"),10):-1,d.clipPath=b,d.isClipStart=!0,r.clipPathState=v,Um(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,h=u.isControl,f=u.isLine,d=u.isArea,b=u.clipIndex,v=u.clipPath;if(!v)return!1;var S=xm(t.props,"clippable"),E=S.keepRatio,P=0,k=0,L=s.draggable,N=ld(e);o&&L?(r=Jt(L.prevBeforeDist,2),P=r[0],k=r[1]):(n=Jt(N,2),P=n[0],k=n[1]);var M=[P,k],z=t.state,B=z.width,q=z.height,W=!d&&!h&&!f,G=v.type,ie=v.poses,J=v.splitter,H=ie.map(function(At){return At.pos});W&&(P=-P,k=-k);var ne=!h||ie[b].direction==="nesw",ae=G==="inset"||G==="rect",ue=ie.map(function(){return[0,0]});if(h&&!ne){var de=ie[b],Pe=de.horizontal,me=de.vertical,Ee=[P*un(Pe),k*un(me)];ue=rbe(ie,b,Ee,ae,E)}else ne&&(ue=H.map(function(){return[P,k]}));var we=H.map(function(At,Zt){return Ta(At,ue[Zt])}),Ae=bn([],Jt(we),!1);z.snapBoundInfos=null;var ce=v.type==="circle",xe=v.type==="ellipse";if(ce||xe){var _e=bh(we),Me=un(_e.bottom-_e.top),Re=un(xe?_e.right-_e.left:Me),He=we[0][1]+Me,Fe=we[0][0]-Re,tt=we[0][0]+Re;ce&&(Ae.push([tt,_e.bottom]),ue.push([1,0])),Ae.push([_e.left,He]),ue.push([0,1]),Ae.push([Fe,_e.bottom]),ue.push([1,0])}var Ze=qY((S.clipHorizontalGuidelines||[]).map(function(At){return bo("".concat(At),q)}),(S.clipVerticalGuidelines||[]).map(function(At){return bo("".concat(At),B)}),B,q),Qe=[],Ie=[];if(ce||xe)Qe=[Ae[4][0],Ae[2][0]],Ie=[Ae[1][1],Ae[3][1]];else if(ae){var Lt=[Ae[0],Ae[2],Ae[4],Ae[6]],at=[ue[0],ue[2],ue[4],ue[6]];Qe=Lt.filter(function(At,Zt){return at[Zt][0]}).map(function(At){return At[0]}),Ie=Lt.filter(function(At,Zt){return at[Zt][1]}).map(function(At){return At[1]})}else Qe=Ae.filter(function(At,Zt){return ue[Zt][0]}).map(function(At){return At[0]}),Ie=Ae.filter(function(At,Zt){return ue[Zt][1]}).map(function(At){return At[1]});var Ve=[0,0],nr=hz(Ze,S.clipTargetBounds&&{left:0,top:0,right:B,bottom:q},Qe,Ie,5,5),Yt=nr.horizontal,yr=nr.vertical,mt=Yt.offset,br=yr.offset;if(Yt.isBound&&(Ve[1]+=mt),yr.isBound&&(Ve[0]+=br),(xe||ce)&&ue[0][0]===0&&ue[0][1]===0){var _e=bh(we),Tr=_e.bottom-_e.top,mr=xe?_e.right-_e.left:Tr,Mr=yr.isBound?un(br):yr.snapIndex===0?-br:br,Pr=Yt.isBound?un(mt):Yt.snapIndex===0?-mt:mt;mr-=Mr,Tr-=Pr,ce&&(Tr=DY(yr,Yt)>0?Tr:mr,mr=Tr);var ar=Ae[0];Ae[1][1]=ar[1]-Tr,Ae[2][0]=ar[0]+mr,Ae[3][1]=ar[1]+Tr,Ae[4][0]=ar[0]-mr}else if(ae&&E&&h){var fr=Jt(pZ(ie),2),Nr=fr[0],or=fr[1],Dr=Nr&&or?Nr/or:0,er=ie[b],Gt=er.direction||"",Tt=Ae[1][1],He=Ae[5][1],Fe=Ae[7][0],tt=Ae[3][0];un(mt)<=un(br)?mt=oc(mt)*un(br)/Dr:br=oc(br)*un(mt)*Dr,Gt.indexOf("w")>-1?Fe-=br:Gt.indexOf("e")>-1?tt-=br:(Fe+=br/2,tt-=br/2),Gt.indexOf("n")>-1?Tt-=mt:Gt.indexOf("s")>-1?He-=mt:(Tt+=mt/2,He-=mt/2);var Oe=hS(Tt,tt,He,Fe);Ae.forEach(function(St,Xt){var Ct;Ct=Jt(Oe[Xt].pos,2),St[0]=Ct[0],St[1]=Ct[1]})}else Ae.forEach(function(At,Zt){var jt=ue[Zt];jt[0]&&(At[0]-=br),jt[1]&&(At[1]-=mt)});var Be=ZO(t,v,we),Ne="".concat(G,"(").concat(Be.join(J),")");if(z.clipPathState=Ne,ce||xe)Qe=[Ae[4][0],Ae[2][0]],Ie=[Ae[1][1],Ae[3][1]];else if(ae){var Lt=[Ae[0],Ae[2],Ae[4],Ae[6]];Qe=Lt.map(function(Zt){return Zt[0]}),Ie=Lt.map(function(Zt){return Zt[1]})}else Qe=Ae.map(function(At){return At[0]}),Ie=Ae.map(function(At){return At[1]});if(z.snapBoundInfos=hz(Ze,S.clipTargetBounds&&{left:0,top:0,right:B,bottom:q},Qe,Ie,1,1),L){var rt=z.is3d,pt=z.allMatrix,Rt=rt?4:3,Bt=Ve;o&&(Bt=[M[0]+Ve[0]-N[0],M[1]+Ve[1]-N[1]]),L.deltaOffset=xo(pt,[Bt[0],Bt[1],0,0],Rt)}return Zn(t,"onClip",Xi(t,e,Wt({clipEventType:"changed",clipType:G,poses:we,clipStyle:Ne,clipStyles:Be,distX:P,distY:k},sc((i={},i[G==="rect"?"clip":"clipPath"]=Ne,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?(Zn(t,"onClipEnd",ih(t,e,{})),i&&(o?ibe(t,e):a&&nbe(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},obe={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Dl(e.inputEvent.target,mi("origin"))},dragControlStart:function(t,e){var r=e.datas;Um(t,e);var n=Xi(t,e,{dragStart:ac.dragStart(t,new n0().dragStart([0,0],e))}),i=Zn(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=Jt(ld(e),2),s=a[0],o=a[1],u=t.state,h=u.width,f=u.height,d=u.offsetMatrix,b=u.targetMatrix,v=u.is3d,S=t.props.originRelative,E=S===void 0?!0:S,P=v?4:3,k=[s,o];if(i){var L=e.distOrigin;(L[0]||L[1])&&(k=L)}var N=Ta(r.startOrigin,k),M=Ta(r.startTargetOrigin,k),z=vi(k,r.prevOrigin),B=tx(d,b,N,P),q=t.getRect(),W=bh(Vm(B,h,f,P)),G=[q.left-W.left,q.top-W.top];r.prevOrigin=k;var ie=[Kh(M[0],h,E),Kh(M[1],f,E)].join(" "),J=ac.drag(t,ex(e,t.state,G,!!n)),H=Xi(t,e,Wt(Wt({width:h,height:f,origin:N,dist:k,delta:z,transformOrigin:ie,drag:J},sc({transformOrigin:ie,transform:J.transform},e)),{afterTransform:J.transform}));return Zn(t,"onDragOrigin",H),H},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?(Zn(t,"onDragOriginEnd",ih(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function sbe(t,e,r,n){var i=t.filter(function(u){var h=u.virtual,f=u.horizontal;return f&&!h}).length,a=t.filter(function(u){var h=u.virtual,f=u.vertical;return f&&!h}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];lbe(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function lbe(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function ube(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function Iz(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Qp(t),dZ(a,e,r,0,0,n,i)}function Pz(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,u=YO(i,t.props.roundRelative,s,o),h=u.raws,f=u.styles,d=u.radiusPoses,b=Q1e(d,h),v=b.horizontals,S=b.verticals,E=f.join(" ");a.borderRadiusState=E;var P=Xi(t,e,Wt({horizontals:v,verticals:S,borderRadius:E,width:s,height:o,delta:n,dist:r},sc({borderRadius:E},e)));return Zn(t,"onRound",P),P}function kz(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=qO(s).borderRadius,n.borderRadius=i))}return i}var cbe={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?mi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,u=r.left,h=r.top,f=r.borderRadiusState,d=t.props,b=d.minRoundControls,v=b===void 0?[0,0]:b,S=d.maxRoundControls,E=S===void 0?[4,4]:S,P=d.zoom,k=d.roundPadding,L=k===void 0?0:k,N=d.isDisplayShadowRoundControls,M=d.groupable;if(!n)return null;var z=f||kz(t),B=o?4:3,q=Iz(z,i,a,v,!0);if(!q)return null;var W=0,G=0,ie=M?[0,0]:[u,h];return q.map(function(J,H){var ne=J.horizontal,ae=J.vertical,ue=J.direction||"",de=bn([],Jt(J.pos),!1);G+=Math.abs(ne),W+=Math.abs(ae),ne&&ue.indexOf("n")>-1&&(de[1]-=L),ae&&ue.indexOf("w")>-1&&(de[0]-=L),ne&&ue.indexOf("s")>-1&&(de[1]+=L),ae&&ue.indexOf("e")>-1&&(de[0]+=L);var Pe=vi(ys(s,de,B),ie),me=N&&N!=="horizontal",Ee=J.vertical?W<=E[1]&&(me||!J.virtual):G<=E[0]&&(N||!J.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(H),className:mi("control","border-radius",J.vertical?"vertical":"",J.virtual?"virtual":""),"data-radius-index":H,style:{display:Ee?"block":"none",transform:"translate(".concat(Pe[0],"px, ").concat(Pe[1],"px) scale(").concat(P,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=s?parseInt(i.getAttribute("data-radius-index"),10):-1,h=-1;if(o){var f=i.getAttribute("data-line-key")||"";f&&(h=parseInt(f.replace(/render-line-/g,""),10),isNaN(h)&&(h=-1))}if(!s&&!o)return!1;var d=Xi(t,e,{}),b=Zn(t,"onRoundStart",d);if(b===!1)return!1;n.lineIndex=h,n.controlIndex=u,n.isControl=s,n.isLine=o,Um(t,e);var v=t.props,S=v.roundRelative,E=v.minRoundControls,P=E===void 0?[0,0]:E,k=t.state,L=k.width,N=k.height;n.isRound=!0,n.prevDist=[0,0];var M=kz(t),z=Iz(M||"",L,N,P,!0)||[];return n.controlPoses=z,k.borderRadiusState=YO(z,S,L,N).styles.join(" "),d},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=Jt(ld(e),2),s=a[0],o=a[1],u=[s,o],h=vi(u,r.prevDist),f=t.props.maxRoundControls,d=f===void 0?[4,4]:f,b=t.state,v=b.width,S=b.height,E=n[i],P=E.vertical,k=E.horizontal,L=n.map(function(M){var z=M.horizontal,B=M.vertical,q=[z*k*u[0],B*P*u[1]];if(z){if(d[0]===1)return q;if(d[0]<4&&z!==k)return q}else{if(d[1]===0)return q[1]=B*k*u[0]/v*S,q;if(P){if(d[1]===1)return q;if(d[1]<4&&B!==P)return q}}return[0,0]});L[i]=u;var N=n.map(function(M,z){return Wt(Wt({},M),{pos:Ta(M.pos,L[z])})});return i<4?N.slice(0,i+1).forEach(function(M){M.virtual=!1}):N.slice(4,i+1).forEach(function(M){M.virtual=!1}),r.prevDist=[s,o],Pz(t,e,u,h,N)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,u=n.lineIndex,h=n.controlPoses,f=h.filter(function(k){var L=k.virtual;return L}).length,d=t.props.roundClickable,b=d===void 0?!0:d;if(i&&b){if(a&&(b===!0||b==="control"))ube(h,s);else if(o&&(b===!0||b==="line")){var v=Jt(vY(t,e),2),S=v[0],E=v[1];sbe(h,u,S,E)}f!==h.filter(function(k){var L=k.virtual;return L}).length&&Pz(t,e,[0,0],[0,0],h)}var P=ih(t,e,{});return Zn(t,"onRoundEnd",P),r.borderRadiusState="",P},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=af(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,u){return Wt(Wt({},o),{target:i[u],moveable:n[u],currentTarget:n[u]})})},r);return Zn(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=af(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,u){return Wt(Wt(Wt({},o),{target:i[u],moveable:n[u],currentTarget:n[u]}),sc({borderRadius:r.borderRadius},o))})},r);return Zn(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=af(t,"roundable",e);gT(t,"onRound",function(o){var u=Wt({targets:t.props.targets,events:i.map(function(h,f){return Wt(Wt(Wt({},h),{target:n[f],moveable:r[f],currentTarget:r[f]}),sc({borderRadius:o.borderRadius},h))})},o);Zn(t,"onRoundGroup",u)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=Wt({targets:t.props.targets,events:i.map(function(o,u){var h;return Wt(Wt({},o),{target:n[u],moveable:r[u],currentTarget:r[u],lastEvent:(h=o.datas)===null||h===void 0?void 0:h.lastEvent})})},a);return Zn(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function hbe(t,e){var r=e?4:3,n=Wo(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var gZ={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(oY(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=hbe(o,n)?[]:Qp(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Xi(t,e,{setTransform:function(r){e.datas.startTransforms=ru(r)?r:Qp(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Xi(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Zn(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Zn(t,"onBeforeRender",Xi(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Zn(t,"onBeforeRenderEnd",Xi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.setTransform(u,s),r.resetStyle(s),r.fillDragStartParams(u,s)});Zn(t,"onBeforeRenderGroupStart",Xi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.resetStyle(s),r.fillDragParams(u,s)});Zn(t,"onBeforeRenderGroup",Xi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Zn(t,"onBeforeRenderGroupEnd",Xi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},mZ={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Zn(t,"onRenderStart",Xi(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Zn(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Zn(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Zn(t,"onRenderGroupStart",Xi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.fillDragParams(u,s)});Zn(t,"onRenderGroup",Xi(t,e,Wt(Wt({isPinch:!!e.isPinch,targets:t.props.targets,transform:g2(e),transformObject:{}},sc(m2(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.fillDragEndParams(u,s)});Zn(t,"onRenderGroupEnd",Xi(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:g2(e)},sc(m2(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return r0(iS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Xi(t,e,Wt({isPinch:!!e.isPinch,transformObject:r,transform:g2(e)},sc(m2(e))))},fillDragEndParams:function(t,e){var r={};return r0(iS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Xi(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:g2(e)},sc(m2(e))))}};function M1(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",u=i==="End",h=i==="After",f=t.state.target,d=a.isRequest,b=n.indexOf("Control")>-1;if(!f||o&&b&&!d&&t.areaElement===a.inputEvent.target)return!1;var v=bn([],Jt(e),!1);if(d){var S=a.requestAble;v.some(function(H){return H.name===S})||v.push.apply(v,bn([],Jt(t.props.ables.filter(function(H){return H.name===S})),!1))}if(!v.length||v.every(function(H){return H.dragRelation}))return!1;var E=a.inputEvent,P;u&&E&&(P=document.elementFromPoint(a.clientX,a.clientY)||E.target);var k=!1,L=function(){var H;k=!0,(H=a.stop)===null||H===void 0||H.call(a)},N=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var M=a.datas,z=b?"controlGesto":"targetGesto",B=t[z],q=function(H,ne,ae){if(!(ne in H)||B!==t[z])return!1;var ue=H.name,de=M[ue]||(M[ue]={});if(o&&(de.isEventStart=!ae||!H[ae]||H[ae](t,a)),!de.isEventStart)return!1;var Pe=H[ne](t,Wt(Wt({},a),{stop:L,datas:de,originalDatas:M,inputTarget:P}));return t._emitter.off(),o&&Pe===!1&&(de.isEventStart=!1),Pe};N&&v.forEach(function(H){H.unset&&H.unset(t)}),q(gZ,"drag".concat(n).concat(i));var W=0,G=0;r.forEach(function(H){if(k)return!1;var ne="".concat(H).concat(n).concat(i),ae="".concat(H).concat(n,"Condition");i===""&&!d&&N1e(t.state,a);var ue=v.filter(function(me){return me[ne]});ue=ue.filter(function(me,Ee){return me.name&&ue.indexOf(me)===Ee});var de=ue.filter(function(me){return q(me,ne,ae)}),Pe=de.length;k&&++W,Pe&&++G,!k&&o&&ue.length&&!Pe&&(W+=ue.filter(function(me){var Ee=me.name,we=M[Ee];return we.isEventStart?me.dragRelation!=="strong":!1}).length?1:0)}),(!h||G)&&q(mZ,"drag".concat(n).concat(i));var ie=B!==t[z]||W===r.length;if((u||k||ie)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(H){H.state.gestos={}}),v.forEach(function(H){H.unset&&H.unset(t)})),o&&!ie&&!d&&G&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||ie)return!1;if(!o&&G&&!s||u){var J=t.props.flushSync||GY;J(function(){t.updateRect(u?i:"",!0,!1),t.forceUpdate()})}return!o&&!u&&!h&&G&&!s&&M1(t,e,r,n,i+"After",a),!0}function KO(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Dl(a,"moveable-area")||Dl(a,"moveable-padding")||Dl(a,"moveable-edgeDraggable")}}function yZ(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,u=a.dragTarget;i.push(n),(!s||u)&&i.push(e),!s&&u&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var h=KO(t);return _Z(t,i,"targetAbles",r,{dragStart:h,pinchStart:h})}function vZ(t,e){var r=t.controlBox,n=[];n.push(r);var i=KO(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var u=i(s,o);return!u};return _Z(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function _Z(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,u=s.pinchThreshold,h=s.preventClickEventOnDrag,f=s.preventClickDefault,d=s.checkInput,b=s.dragFocusedInput,v=s.preventDefault,S=v===void 0?!0:v,E=s.preventRightClick,P=E===void 0?!0:E,k=s.preventWheelClick,L=k===void 0?!0:k,N=s.dragContainer,M=Kf(N,!0),z={preventDefault:S,preventRightClick:P,preventWheelClick:L,container:M||Wp(t.getControlBoxElement()),pinchThreshold:u,pinchOutside:o,preventClickEventOnDrag:a?h:!1,preventClickEventOnDragStart:a?f:!1,preventClickEventByCondition:a?null:function(W){return t.controlBox.contains(W.target)},checkInput:a?d:!1,dragFocusedInput:b},B=new F0e(e,z),q=n==="Control";return["drag","pinch"].forEach(function(W){["Start","","End"].forEach(function(G){B.on("".concat(W).concat(G),function(ie){var J,H=ie.eventType,ne=W==="drag"&&ie.isPinch;if(i[H]&&!i[H](ie)){ie.stop();return}if(!ne){var ae=W==="drag"?[W]:["drag",W],ue=bn([],Jt(t[r]),!1),de=M1(t,ue,ae,n,G,ie);de?(t.props.stopPropagation||G==="Start"&&q)&&((J=ie?.inputEvent)===null||J===void 0||J.stopPropagation()):ie.stop()}})})}),B}var fbe=(function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(u){u[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function dbe(t,e,r,n){var i;r===void 0&&(r=e);var a=EY(t,e),s=a.matrixes,o=a.is3d,u=a.targetMatrix,h=a.transformOrigin,f=a.targetOrigin,d=a.offsetContainer,b=a.hasFixed,v=a.zoom,S=A_e(d,r),E=S.matrixes,P=S.is3d,k=S.offsetContainer,L=S.zoom,N=n,M=4,z=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,B=u,q=Wo(M),W=Wo(M),G=Wo(M),ie=Wo(M),J=s.length,H=E.map(function(Ee){return Wt(Wt({},Ee),{matrix:Ee.matrix?bn([],Jt(Ee.matrix),!1):void 0})}).reverse();s.reverse(),!o&&N&&(B=lf(B,3,4),xk(s)),!P&&N&&xk(H),H.forEach(function(Ee){W=xo(W,Ee.matrix,M)});var ne=r||hg(t),ae=((i=H[0])===null||i===void 0?void 0:i.target)||ob(ne,ne,!0).offsetParent,ue=H.slice(1).reduce(function(Ee,we){return xo(Ee,we.matrix,M)},Wo(M));s.forEach(function(Ee,we){if(J-2===we&&(G=q.slice()),J-1===we&&(ie=q.slice()),!Ee.matrix){var Ae=s[we+1],ce=k1e(Ee,Ae,ae,M,xo(ue,q,M));Ee.matrix=_m(ce,M)}q=xo(q,Ee.matrix,M)});var de=!z&&o;B||(B=Wo(de?4:3));var Pe=pT(z&&B.length===16?lf(B,4,3):B,de),me=W;return W=iY(W,M,M),{hasZoom:v!==1||L!==1,hasFixed:b,matrixes:s,rootMatrix:W,originalRootMatrix:me,beforeMatrix:G,offsetMatrix:ie,allMatrix:q,targetMatrix:B,targetTransform:Pe,inlineTransform:t.style.transform,transformOrigin:h,targetOrigin:f,is3d:N,offsetContainer:d,offsetRootContainer:k}}function pbe(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},u=KY(t);if(t&&(i=u.offsetWidth,a=u.offsetHeight),t){var h=dbe(t,e,r,n),f=Vv(h.allMatrix,h.transformOrigin,i,a);o=Wt(Wt({},h),f);var d=Vv(h.allMatrix,[50,50],100,100);s=JY([d.pos1,d.pos2],d.direction)}var b=4;return Wt(Wt(Wt({hasZoom:!1,width:i,height:a,rotation:s},u),{originalRootMatrix:Wo(b),rootMatrix:Wo(b),beforeMatrix:Wo(b),offsetMatrix:Wo(b),allMatrix:Wo(b),targetMatrix:Wo(b),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function Tk(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],u=v2(),h=v2(),f=v2(),d=v2(),b=[0,0],v={},S=pbe(e,r,i,!0);if(e){var E=Pc(e);a.forEach(function(H){v[H]=E(H)});var P=S.is3d?4:3,k=Vv(S.offsetMatrix,Ta(S.transformOrigin,aY(S.targetMatrix,P)),S.width,S.height);s=k.direction,o=Ta(k.origin,[k.left-S.left,k.top-S.top]),d=k1(S.offsetRootContainer);var L=ob(n,n,!0).offsetParent||S.offsetRootContainer;if(S.hasZoom){var N=Vv(xo(S.originalRootMatrix,S.allMatrix),S.transformOrigin,S.width,S.height),M=Vv(S.originalRootMatrix,lS(Pc(L)("transformOrigin")).map(function(H){return parseFloat(H)}),L.offsetWidth,L.offsetHeight);if(u=Q3(N,d),f=Q3(M,d,L,!0),t){var z=N.left,B=N.top;h=Q3({left:z,top:B,bottom:B,right:B},d)}}else{u=k1(e),f=C_e(L),t&&(h=k1(t));var q=f.left,W=f.top,G=f.clientLeft,ie=f.clientTop,J=[u.left-q,u.top-W];b=vi(o0(S.rootMatrix,J,4),[G+S.left,ie+S.top])}}return Wt({targetClientRect:u,containerClientRect:f,moveableClientRect:h,rootContainerClientRect:d,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:v,offsetDelta:b},S)}function Mz(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=bm([e,r,n,i]),s=[a.minX,a.minY],o=vi(t.origin,s);return e=vi(e,s),r=vi(r,s),n=vi(n,s),i=vi(i,s),Wt(Wt({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var s0=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=Wt({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Tk(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new PO,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}Kve(r._observerId),r._observerId=QX(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,u=r.cspNonce,h=r.translateZ,f=r.cssStyled,d=r.groupable,b=r.linePadding,v=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var S=Jt(i||[0,0],2),E=S[0],P=S[1],k=n.left,L=n.top,N=n.target,M=n.direction,z=n.hasFixed,B=n.offsetDelta,q=r.targets,W=this.isDragging(),G={};this.getEnabledAbles().forEach(function(ue){G["data-able-".concat(ue.name.toLowerCase())]=!0});var ie=this._getAbleClassName(),J=q&&q.length&&(N||d)||s||!this._hasFirstTarget&&this.state.isPersisted,H=this.controlBox||this.props.firstRenderState||this.props.persistData,ne=[k-E,L-P];!d&&r.useAccuratePosition&&(ne[0]+=B[0],ne[1]+=B[1]);var ae={position:z?"fixed":"absolute",display:J?"block":"none",visibility:H?"visible":"hidden",transform:"translate3d(".concat(ne[0],"px, ").concat(ne[1],"px, ").concat(h,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return b&&(ae["--moveable-line-padding"]=b),v&&(ae["--moveable-control-padding"]=v),ee.createElement(f,Wt({cspNonce:u,ref:om(this,"controlBox"),className:"".concat(mi("control-box",M===-1?"reverse":"",W?"dragging":"")," ").concat(ie," ").concat(a)},G,{onClick:this._onPreventClick,style:ae}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Ev(this,!1),Ev(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return nh(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(RO)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&KO(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,u=n.pos4,h=n.targetClientRect;if(!i)return 0;var f;if(TO(r)){var d=r.getBoundingClientRect();f={left:d.left,top:d.top,width:d.width,height:d.height}}else f=Wt({width:0,height:0},r);var b=f.left,v=f.top,S=f.width,E=f.height,P=ez([a,s,u,o],h),k=M0e(P,[[b,v],[b+S,v],[b+S,v+E],[b,v+E]]),L=uY(P);return!k||!L?0:Math.min(100,k/L*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,u=i.pos3,h=i.pos4,f=i.targetClientRect;return a?lk([r,n],ez([s,o,h,u],f)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&i0(!0);var o=a.parentMoveable,u=this.state,h=u.target||a.target,f=this.getContainer(),d=o?o._rootContainer:this._rootContainer,b=Tk(this.controlBox,h,f,f,d||f,this._getRequestStyles());if(!h&&this._hasFirstTarget&&a.persistData){var v=Mz(a.persistData);for(var S in v)b[S]=v[S]}s&&i0(),this.updateState(b,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=kh(this.state),i=Jt(n,4),a=i[0],s=i[1],o=i[2],u=i[3],h=bh(n),f=r.width,d=r.height,b=h.width,v=h.height,S=h.left,E=h.top,P=[r.left,r.top],k=Ta(P,r.origin),L=Ta(P,r.beforeOrigin),N=r.transformOrigin;return{width:b,height:v,left:S,top:E,pos1:a,pos2:s,pos3:o,pos4:u,offsetWidth:f,offsetHeight:d,beforeOrigin:L,origin:k,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&wk(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&wk(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return F1e(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,u=o.props.ables,h=s.groupable,f=nh(u,function(k){return k.name===r});if(this.isDragging()||!f||!f.request)return{request:function(){return this},requestEnd:function(){return this}};var d=f.request(a),b=i||n.isInstant,v=d.isControl?"controlAbles":"targetAbles",S="".concat(h?"Group":"").concat(d.isControl?"Control":""),E=bn([],Jt(o[v]),!1),P={request:function(k){return M1(a,E,["drag"],S,"",Wt(Wt({},d.request(k)),{requestAble:r,isRequest:!0}),b),P},requestEnd:function(){return M1(a,E,["drag"],S,"End",Wt(Wt({},d.requestEnd()),{requestAble:r,isRequest:!0}),b),P}};return M1(a,E,["drag"],S,"Start",Wt(Wt({},d.requestStart(n)),{requestAble:r,isRequest:!0}),b),b?P.request(n).requestEnd():P},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,u=r.is3d,h=r.pos1,f=r.pos2,d=r.pos3,b=r.pos4,v=r.left,S=r.top,E=r.isPersisted,P=n.zoom||1;if(!i&&P<=1){r.renderPoses=[h,f,d,b],r.renderLines=[[h,f],[f,b],[b,d],[d,h]];return}var k=lZ(i||{}),L=k.left,N=k.top,M=k.bottom,z=k.right,B=u?4:3,q=[];E?q=s:this.controlBox&&n.groupable?q=a:q=Ta(a,[v,S]);var W=rS(B,_m(q.map(function(ae){return-ae}),B),o,_m(s,B)),G=ch(W,h,[-L,-N],B),ie=ch(W,f,[z,-N],B),J=ch(W,d,[-L,M],B),H=ch(W,b,[z,M],B);r.renderPoses=[G,ie,J,H],r.renderLines=[[G,ie],[ie,H],[H,J],[J,G]];{var ne=P/2;r.renderLines=[[ch(W,h,[-L-ne,-N],B),ch(W,f,[z+ne,-N],B)],[ch(W,f,[z,-N-ne],B),ch(W,b,[z,M+ne],B)],[ch(W,b,[z+ne,M],B),ch(W,d,[-L-ne,M],B)],[ch(W,d,[-L,M+ne],B),ch(W,h,[-L,-N-ne],B)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,u=s.container;if(!(!o&&!n)){this.updateAbles();var h=!Sk(o,n),f=h||!Sk(u,i);if(f){var d=i||this.controlBox;d&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&d&&this.updateRect("End",!1,!1),this._isPropTargetChanged=h}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=fY(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=Mz(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),u="pinch".concat(n,"Start"),h="drag".concat(n,"ControlStart"),f=_2(s,[o,u],a),d=_2(s,[h],a);this.enabledAbles=s,this.targetAbles=f,this.controlAbles=d},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:ee.createElement};return this.renderState={},O1e(iZ(_2(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return bn(bn([],Jt(n),!1),Jt(o),!1)},bn([],Jt(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(Ev(this,!1),this.updateState({gestos:{}})),n||Ev(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=yZ(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=vZ(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=Kf(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var u=this.getState(),h={createElement:ee.createElement};return u.renderLines.map(function(f,d){return ab(h,"",f[0],f[1],i,"render-line-".concat(d))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,u=!o&&a!==i,h=(r||o)&&s!==o;return u||h||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=k0(a);if(this._isTargetChanged())for(var o in a){var u=a[o];u&&u.destroy(),a[o]=null}if(i){var h=this.enabledAbles;s.forEach(function(f){var d=_2(h,[f]),b=d.length>0,v=a[f];if(!b){v&&(v.destroy(),a[f]=null);return}v||(v=new fbe(i,r,f),a[f]=v),v.setAbles(d)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=Kf(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=Kf(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(bn(bn([],Jt(this._getAbleViewClassNames()),!1),[this.isDragging()?q1e:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=nZ(r.filter(Boolean),function(h){return h}).map(function(h){var f=Jt(h,1),d=f[0];return d}),a=this._viewClassNames,s=IO(a,i),o=s.removed,u=s.added;o.forEach(function(h){rY(n,a[h])}),u.forEach(function(h){tY(n,i[h])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},u=s?.isFlag()?s.getEventData():{};return i.map(function(h){var f,d,b,v=h.name,S=((f=h.className)===null||f===void 0?void 0:f.call(h,n))||"";return(!((d=o[v])===null||d===void 0)&&d.isEventStart||!((b=u[v])===null||b===void 0)&&b.isEventStart)&&(S+=" ".concat(mi("".concat(v).concat(r,"-dragging")))),S.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=Wp(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=Wp(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var u=new o.MutationObserver(function(h){var f,d;try{for(var b=X0e(h),v=b.next();!v.done;v=b.next()){var S=v.value;S.type==="attributes"&&S.attributeName==="style"&&n.checkUpdateRect()}}catch(E){f={error:E}}finally{try{v&&!v.done&&(d=b.return)&&d.call(b)}finally{if(f)throw f.error}}});u.observe(s,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:GY,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(ee.PureComponent),JO={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,u=a.isPersisted,h=n.zoom||1,f=t.renderGroupRects,d=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];u?i=d.map(function(){return null}):d=[];var b=Tv(t,"parentPosition",[s,o],function(S){return S.join(",")}),v=Tv(t,"requestStyles",t.getRequestChildStyles(),function(S){return S.join(",")});return t.moveables=t.moveables.slice(0,i.length),bn(bn([],Jt(i.map(function(S,E){return e.createElement(s0,{key:"moveable"+E,ref:YX(t,"moveables",E),target:S,origin:!1,requestStyles:v,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:d[E],zoom:h})})),!1),Jt(iZ(f.map(function(S,E){var P=S.pos1,k=S.pos2,L=S.pos3,N=S.pos4,M=[P,k,L,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(z,B){var q=Jt(z,2),W=q[0],G=q[1];return ab(e,"",vi(M[W],b),vi(M[G],b),h,"group-rect-".concat(E,"-").concat(B))})}))),!1)}},gbe=Qb("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);Zn(t,"onClick",Xi(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=Yd(i,function(u){return u.contains(n)}),o=a>-1),Zn(t,"onClickGroup",Xi(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function My(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Wt(Wt({},t),{datas:e})}var mbe=Qb("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?AY(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Dl(i,mi("direction"))&&Dl(i,mi("edge"))&&Dl(i,mi("edgeDraggable"))},dragStart:function(t,e){return ac.dragStart(t,My(e))},drag:function(t,e){return ac.drag(t,My(e))},dragEnd:function(t,e){return ac.dragEnd(t,My(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Dl(i,mi("direction"))&&Dl(i,mi("line"))},dragGroupStart:function(t,e){return ac.dragGroupStart(t,My(e))},dragGroup:function(t,e){return ac.dragGroup(t,My(e))},dragGroupEnd:function(t,e){return ac.dragGroupEnd(t,My(e))},unset:function(t){return ac.unset(t)}}),bZ={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},ybe=[gZ,hZ,b1e,z1e,ac,mbe,vk,j1e,V1e,r1e,G1e,X1e,H1e,obe,abe,cbe,JO,bZ,gbe,cZ,mZ];function Rz(t,e){var r=Jt(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function w2(t,e){var r=Jt(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function Oz(t,e){return Math.max.apply(Math,bn([],Jt(t.map(function(r){var n=Jt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function Nz(t,e){return Math.min.apply(Math,bn([],Jt(t.map(function(r){var n=Jt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function vbe(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],u=[0,0],h=0,f=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:h,height:f,rotation:e};var d=Fi(e,uc);if(d%90){var b=d/180*Math.PI,v=Math.tan(b),S=-1/v,E=[pk,nz],P=[[0,0],[0,0]],k=[pk,nz],L=[[0,0],[0,0]];t.forEach(function(xe){xe.forEach(function(_e){var Me=Rz([-v,1,0],_e),Re=Rz([-S,1,0],_e);E[0]>Me&&(P[0]=_e,E[0]=Me),E[1]<Me&&(P[1]=_e,E[1]=Me),k[0]>Re&&(L[0]=_e,k[0]=Re),k[1]<Re&&(L[1]=_e,k[1]=Re)})});var N=Jt(P,2),M=N[0],z=N[1],B=Jt(L,2),q=B[0],W=B[1],G=[-v,1,w2([-v,1],M)],ie=[-v,1,w2([-v,1],z)],J=[-S,1,w2([-S,1],q)],H=[-S,1,w2([-S,1],W)];r=Jt([[G,J],[G,H],[ie,J],[ie,H]].map(function(xe){var _e=Jt(xe,2),Me=_e[0],Re=_e[1];return kO(Me,Re)[0]}),4),a=r[0],s=r[1],o=r[2],u=r[3],h=k[1]-k[0],f=E[1]-E[0]}else{var ne=Nz(t,0),ae=Nz(t,1),ue=Oz(t,0),de=Oz(t,1);if(a=[ne,ae],s=[ue,ae],o=[ne,de],u=[ue,de],h=ue-ne,f=de-ae,d%180){var Pe=[o,a,u,s];n=Jt(Pe,4),a=n[0],s=n[1],o=n[2],u=n[3],h=de-ae,f=ue-ne}}if(d%360>180){var Pe=[u,o,s,a];i=Jt(Pe,4),a=i[0],s=i[1],o=i[2],u=i[3]}var me=bm([a,s,o,u]),Ee=me.minX,we=me.minY,Ae=me.maxX,ce=me.maxY;return{pos1:a,pos2:s,pos3:o,pos4:u,width:h,height:f,minX:Ee,minY:we,maxX:Ae,maxY:ce,rotation:e}}function xZ(t,e){var r=e.map(function(n){if(ru(n)){var i=xZ(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=nh(t,function(o){var u=o.manager;return u.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&ru(r[0])?r[0]:r}var _be=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new lY,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;i0(!0),this.moveables.forEach(function(Fe){Fe.updateRect(r,!1,!1)});var o=this.props,u=this.moveables,h=s.target||o.target,f=u.map(function(Fe){return{finded:!1,manager:Fe}}),d=this.props.targetGroups||[],b=xZ(f,d),v=o.useDefaultGroupRotate;b.push.apply(b,bn([],Jt(f.filter(function(Fe){var tt=Fe.finded;return!tt}).map(function(Fe){var tt=Fe.manager;return tt})),!1));var S=[],E=!n||r!==""&&o.updateGroup,P=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var k=(a=o.persistData)===null||a===void 0?void 0:a.rotation;k!=null&&(P=k)}function L(Fe,tt,Ze){var Qe=Fe.map(function(yr){if(ru(yr)){var mt=L(yr,tt),br=[mt.pos1,mt.pos2,mt.pos3,mt.pos4];return S.push(mt),{poses:br,rotation:mt.rotation}}else return{poses:kh(yr.state),rotation:yr.getRotation()}}),Ie=Qe.map(function(yr){var mt=yr.rotation;return mt}),Lt=0,at=Ie[0],Ve=Ie.every(function(yr){return Math.abs(at-yr)<.1});E?Lt=!v&&Ve?at:P:Lt=!v&&!Ze&&Ve?at:tt;var nr=Qe.map(function(yr){var mt=yr.poses;return mt}),Yt=vbe(nr,Lt);return Yt}var N=L(b,this.rotation,!0);E&&(this.rotation=N.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=d,this.renderGroupRects=S;var M=this.transformOrigin,z=this.rotation,B=this.scale,q=N.width,W=N.height,G=N.minX,ie=N.minY,J=B1e([[0,0],[q,0],[0,W],[q,W]],XO(M,q,W),this.rotation/180*Math.PI),H=bm(J.result),ne=H.minX,ae=H.minY,ue=" rotate(".concat(z,"deg)")+" scale(".concat(oc(B[0]),", ").concat(oc(B[1]),")"),de="translate(".concat(-ne,"px, ").concat(-ae,"px)").concat(ue);this.controlBox.style.transform="translate3d(".concat(G,"px, ").concat(ie,"px, ").concat(this.props.translateZ||0,")"),h.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(M,";")+"width:".concat(q,"px;height:").concat(W,"px;")+"transform: ".concat(de),s.width=q,s.height=W;var Pe=this.getContainer(),me=Tk(this.controlBox,h,this.controlBox,this.getContainer(),this._rootContainer||Pe,[]),Ee=[me.left,me.top],we=Jt(kh(me),4),Ae=we[0],ce=we[1],xe=we[2],_e=we[3],Me=bm([Ae,ce,xe,_e]),Re=[Me.minX,Me.minY],He=oc(B[0]*B[1]);me.pos1=vi(Ae,Re),me.pos2=vi(ce,Re),me.pos3=vi(xe,Re),me.pos4=vi(_e,Re),me.left=G-me.left+Re[0],me.top=ie-me.top+Re[1],me.origin=vi(Ta(Ee,me.origin),Re),me.beforeOrigin=vi(Ta(Ee,me.beforeOrigin),Re),me.originalBeforeOrigin=Ta(Ee,me.originalBeforeOrigin),me.transformOrigin=vi(Ta(Ee,me.transformOrigin),Re),h.style.transform="translate(".concat(-ne-Re[0],"px, ").concat(-ae-Re[1],"px)")+ue,i0(),this.updateState(Wt(Wt({},me),{posDelta:Re,direction:He,beforeDirection:He}),i)},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return bn(bn([],Jt(n),!1),Jt(o),!1)},[]);return r},e.prototype.getMoveables=function(){return bn([],Jt(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,bn(bn([],Jt(this.props.ables),!1),[JO],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Kf(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),u=o.added,h=o.changed,f=o.removed,d=u.length||f.length;(d||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Ev(this,!1),Ev(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=yZ(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=vZ(this,"GroupControl")));var b=!Sk(r.container,n.container);b&&(r.container=n.container),(b||d||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||h.length||s.length&&!sZ(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!d},e.prototype._updateObserver=function(){},e.defaultProps=Wt(Wt({},s0.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(s0),bbe=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,u=i.targets||[],h=u.length,f=this.isUnmounted||!h,d=(n=o?.children)!==null&&n!==void 0?n:[];return f&&!h&&d.length?u=d.map(function(){return null}):f||(d=[]),ee.createElement(s,{cspNonce:a,ref:om(this,"controlBox"),className:mi("control-box")},u.map(function(b,v){var S,E,P=(E=(S=i.individualGroupableProps)===null||S===void 0?void 0:S.call(i,b,v))!==null&&E!==void 0?E:{};return ee.createElement(s0,Wt({key:"moveable"+v,ref:YX(r,"moveables",v)},i,P,{target:b,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:d[v]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),i0(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),i0()},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(u){return u.request(r,Wt(Wt({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(u){return a.forEach(function(h){return h.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=nh(this.moveables,function(s){var o=s.getTargets()[0],u=s.getControlBoxElement(),h=s.getDragElement();return!o||!h?!1:h===i||h.contains(i)||h!==o&&o===i||o.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return bn([],Jt(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(s0);function wZ(t,e){var r=[];return t.forEach(function(n){if(n){if(rp(n)){e[n]&&r.push.apply(r,bn([],Jt(e[n]),!1));return}ru(n)?r.push.apply(r,bn([],Jt(wZ(n,e)),!1)):r.push(n)}}),r}function SZ(t,e){var r=[];return t.forEach(function(n){if(n){if(rp(n)){e[n]&&r.push.apply(r,bn([],Jt(e[n]),!1));return}ru(n)?r.push(SZ(n,e)):r.push(n)}}),r}function EZ(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?ru(r)&&ru(i)?EZ(r,i):!0:!1})}var xbe=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new lY,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=k0(r).join(`
`);this.defaultStyled=fY("div",zve(RO,a_e+i))},e.getTotalAbles=function(){return bn([hZ,JO,bZ,cZ],Jt(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=W0e(i,["ables","props"]),u=Jt(this._updateRefs(!0),2),h=u[0],f=u[1],d=wZ(h,f),b=d.length>1,v=n.getTotalAbles(),S=bn(bn([],Jt(v),!1),Jt(a||[]),!1),E=Wt(Wt(Wt({},o),s||{}),{ables:S,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=d;var P=null,k=this.moveable,L=o.persistData;if(L?.children&&(b=!0),o.individualGroupable)return ee.createElement(bbe,Wt({key:"individual-group",ref:om(this,"moveable")},E,{target:null,targets:d}));if(b){var N=SZ(h,f);if(k&&!k.props.groupable&&!k.props.individualGroupable){var M=k.props.target;M&&d.indexOf(M)>-1&&(P=Wt({},k.state))}return ee.createElement(_be,Wt({key:"group",ref:om(this,"moveable")},E,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:d,targetGroups:N,firstRenderState:P}))}else{var z=d[0];if(k&&(k.props.groupable||k.props.individualGroupable)){var B=k.moveables||[],q=nh(B,function(W){return W.props.target===z});q&&(P=Wt({},q.state))}return ee.createElement(s0,Wt({key:"single",ref:om(this,"moveable")},E,{target:z,firstRenderState:P}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=GO(this.props.target||this.props.targets),a=typeof document<"u",s=EZ(n,i),o=this.selectorMap,u={};return this.refTargets.forEach(function h(f){if(rp(f)){var d=o[f];d?u[f]=o[f]:a&&(s=!0,u[f]=[].slice.call(document.querySelectorAll(f)))}else ru(f)&&f.forEach(h)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,u=s.length||o.length;u&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var h=Jt(this._updateRefs(),3),f=h[0],d=h[1],b=h[2];this.refTargets=f,this.selectorMap=d,b&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,G0e([jve(l_e)],e.prototype,"moveable",void 0),e})(ee.PureComponent),wbe=(function(t){Jb(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=ybe,e})(xbe),$u=63710088e-1,TZ={centimeters:$u*100,centimetres:$u*100,degrees:360/(2*Math.PI),feet:$u*3.28084,inches:$u*39.37,kilometers:$u/1e3,kilometres:$u/1e3,meters:$u,metres:$u,miles:$u/1609.344,millimeters:$u*1e3,millimetres:$u*1e3,nauticalmiles:$u/1852,radians:1,yards:$u*1.0936};function wm(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function Mh(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Lz(t[0])||!Lz(t[1]))throw new Error("coordinates must contain numbers");return wm({type:"Point",coordinates:t},e,r)}function mT(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return wm({type:"Polygon",coordinates:t},e,r)}function mu(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return wm({type:"LineString",coordinates:t},e,r)}function Zd(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function Sbe(t,e,r={}){return wm({type:"MultiLineString",coordinates:t},e,r)}function CZ(t,e="kilometers"){const r=TZ[e];if(!r)throw new Error(e+" units is invalid");return t*r}function QO(t,e="kilometers"){const r=TZ[e];if(!r)throw new Error(e+" units is invalid");return t/r}function Ebe(t,e){return fS(QO(t,e))}function fS(t){return t%(2*Math.PI)*180/Math.PI}function ef(t){return t%360*Math.PI/180}function Lz(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function eN(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function rg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function AZ(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function sb(t){return t.type==="Feature"?t.geometry:t}function IZ(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function lb(t,e,r={}){if(r.final===!0)return Tbe(t,e);const n=rg(t),i=rg(e),a=ef(n[0]),s=ef(i[0]),o=ef(n[1]),u=ef(i[1]),h=Math.sin(s-a)*Math.cos(u),f=Math.cos(o)*Math.sin(u)-Math.sin(o)*Math.cos(u)*Math.cos(s-a);return fS(Math.atan2(h,f))}function Tbe(t,e){let r=lb(e,t);return r=(r+180)%360,r}function l0(t,e,r,n={}){const i=rg(t),a=ef(i[0]),s=ef(i[1]),o=ef(r),u=QO(e,n.units),h=Math.asin(Math.sin(s)*Math.cos(u)+Math.cos(s)*Math.sin(u)*Math.cos(o)),f=a+Math.atan2(Math.sin(o)*Math.sin(u)*Math.cos(s),Math.cos(u)-Math.sin(s)*Math.sin(h)),d=fS(f),b=fS(h);return Mh([d,b],n.properties)}function yT(t,e,r={}){var n=rg(t),i=rg(e),a=ef(i[1]-n[1]),s=ef(i[0]-n[0]),o=ef(n[1]),u=ef(i[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(u);return CZ(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),r.units)}function Cbe(t,e,r={}){const i=sb(t).coordinates;let a=0;for(let s=0;s<i.length&&!(e>=a&&s===i.length-1);s++)if(a>=e){const o=e-a;if(o){const u=lb(i[s],i[s-1])-180;return l0(i[s],o,u,r)}else return Mh(i[s])}else a+=yT(i[s],i[s+1],r);return Mh(i[i.length-1])}function N0(t,e,r){if(t!==null)for(var n,i,a,s,o,u,h,f=0,d=0,b,v=t.type,S=v==="FeatureCollection",E=v==="Feature",P=S?t.features.length:1,k=0;k<P;k++){h=S?t.features[k].geometry:E?t.geometry:t,b=h?h.type==="GeometryCollection":!1,o=b?h.geometries.length:1;for(var L=0;L<o;L++){var N=0,M=0;if(s=b?h.geometries[L]:h,s!==null){u=s.coordinates;var z=s.type;switch(f=r&&(z==="Polygon"||z==="MultiPolygon")?1:0,z){case null:break;case"Point":if(e(u,d,k,N,M)===!1)return!1;d++,N++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(e(u[n],d,k,N,M)===!1)return!1;d++,z==="MultiPoint"&&N++}z==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-f;i++){if(e(u[n][i],d,k,N,M)===!1)return!1;d++}z==="MultiLineString"&&N++,z==="Polygon"&&M++}z==="Polygon"&&N++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(M=0,i=0;i<u[n].length;i++){for(a=0;a<u[n][i].length-f;a++){if(e(u[n][i][a],d,k,N,M)===!1)return!1;d++}M++}N++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(N0(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Dz(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function vT(t,e){var r,n,i,a,s,o,u,h,f,d,b=0,v=t.type==="FeatureCollection",S=t.type==="Feature",E=v?t.features.length:1;for(r=0;r<E;r++){for(o=v?t.features[r].geometry:S?t.geometry:t,h=v?t.features[r].properties:S?t.properties:{},f=v?t.features[r].bbox:S?t.bbox:void 0,d=v?t.features[r].id:S?t.id:void 0,u=o?o.type==="GeometryCollection":!1,s=u?o.geometries.length:1,i=0;i<s;i++){if(a=u?o.geometries[i]:o,a===null){if(e(null,b,h,f,d)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,b,h,f,d)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],b,h,f,d)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function Abe(t,e,r){var n=r;return vT(t,function(i,a,s,o,u){n=e(n,i,a,s,o,u)}),n}function tN(t,e){vT(t,function(r,n,i,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(wm(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var u;switch(o){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var h=0;h<r.coordinates.length;h++){var f=r.coordinates[h],d={type:u,coordinates:f};if(e(wm(d,i),n,h)===!1)return!1}})}function Ibe(t,e){tN(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var o,u=0,h=0,f=0;if(N0(r,function(d,b,v,S,E){if(o===void 0||n>u||S>h||E>f){o=d,u=n,h=S,f=E,a=0;return}var P=mu([o,d],r.properties);if(e(P,n,i,E,a)===!1)return!1;a++,o=d})===!1)return!1}}})}function Pbe(t,e,r){var n=r,i=!1;return Ibe(t,function(a,s,o,u,h){i===!1&&r===void 0?n=a:n=e(n,a,s,o,u,h),i=!0}),n}function kbe(t){return Abe(t,(e,r)=>e+Mbe(r),0)}function Mbe(t){let e=0,r;switch(t.type){case"Polygon":return Fz(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=Fz(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Fz(t){let e=0;if(t&&t.length>0){e+=Math.abs(Bz(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(Bz(t[r]))}return e}var Rbe=$u*$u/2,rA=Math.PI/180;function Bz(t){const e=t.length-1;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],o=i[0]*rA,u=a[1]*rA,h=s[0]*rA;r+=(h-o)*Math.sin(u),n++}return r*Rbe}function ah(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return N0(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}function zz(t,e={}){const r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const s=[r,n];return mT([[s,[i,n],[i,a],[r,a],s]],e.properties,{bbox:t,id:e.id})}const $d=11102230246251565e-32,zu=134217729,Obe=(3+8*$d)*$d;function nA(t,e,r,n,i){let a,s,o,u,h=e[0],f=n[0],d=0,b=0;f>h==f>-h?(a=h,h=e[++d]):(a=f,f=n[++b]);let v=0;if(d<t&&b<r)for(f>h==f>-h?(s=h+a,o=a-(s-h),h=e[++d]):(s=f+a,o=a-(s-f),f=n[++b]),a=s,o!==0&&(i[v++]=o);d<t&&b<r;)f>h==f>-h?(s=a+h,u=s-a,o=a-(s-u)+(h-u),h=e[++d]):(s=a+f,u=s-a,o=a-(s-u)+(f-u),f=n[++b]),a=s,o!==0&&(i[v++]=o);for(;d<t;)s=a+h,u=s-a,o=a-(s-u)+(h-u),h=e[++d],a=s,o!==0&&(i[v++]=o);for(;b<r;)s=a+f,u=s-a,o=a-(s-u)+(f-u),f=n[++b],a=s,o!==0&&(i[v++]=o);return(a!==0||v===0)&&(i[v++]=a),v}function Nbe(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function rx(t){return new Float64Array(t)}const Lbe=(3+16*$d)*$d,Dbe=(2+12*$d)*$d,Fbe=(9+64*$d)*$d*$d,Ry=rx(4),jz=rx(8),Uz=rx(12),Vz=rx(16),rc=rx(4);function Bbe(t,e,r,n,i,a,s){let o,u,h,f,d,b,v,S,E,P,k,L,N,M,z,B,q,W;const G=t-i,ie=r-i,J=e-a,H=n-a;M=G*H,b=zu*G,v=b-(b-G),S=G-v,b=zu*H,E=b-(b-H),P=H-E,z=S*P-(M-v*E-S*E-v*P),B=J*ie,b=zu*J,v=b-(b-J),S=J-v,b=zu*ie,E=b-(b-ie),P=ie-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,d=z-k,Ry[0]=z-(k+d)+(d-q),L=M+k,d=L-M,N=M-(L-d)+(k-d),k=N-B,d=N-k,Ry[1]=N-(k+d)+(d-B),W=L+k,d=W-L,Ry[2]=L-(W-d)+(k-d),Ry[3]=W;let ne=Nbe(4,Ry),ae=Dbe*s;if(ne>=ae||-ne>=ae||(d=t-G,o=t-(G+d)+(d-i),d=r-ie,h=r-(ie+d)+(d-i),d=e-J,u=e-(J+d)+(d-a),d=n-H,f=n-(H+d)+(d-a),o===0&&u===0&&h===0&&f===0)||(ae=Fbe*s+Obe*Math.abs(ne),ne+=G*f+H*o-(J*h+ie*u),ne>=ae||-ne>=ae))return ne;M=o*H,b=zu*o,v=b-(b-o),S=o-v,b=zu*H,E=b-(b-H),P=H-E,z=S*P-(M-v*E-S*E-v*P),B=u*ie,b=zu*u,v=b-(b-u),S=u-v,b=zu*ie,E=b-(b-ie),P=ie-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,d=z-k,rc[0]=z-(k+d)+(d-q),L=M+k,d=L-M,N=M-(L-d)+(k-d),k=N-B,d=N-k,rc[1]=N-(k+d)+(d-B),W=L+k,d=W-L,rc[2]=L-(W-d)+(k-d),rc[3]=W;const ue=nA(4,Ry,4,rc,jz);M=G*f,b=zu*G,v=b-(b-G),S=G-v,b=zu*f,E=b-(b-f),P=f-E,z=S*P-(M-v*E-S*E-v*P),B=J*h,b=zu*J,v=b-(b-J),S=J-v,b=zu*h,E=b-(b-h),P=h-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,d=z-k,rc[0]=z-(k+d)+(d-q),L=M+k,d=L-M,N=M-(L-d)+(k-d),k=N-B,d=N-k,rc[1]=N-(k+d)+(d-B),W=L+k,d=W-L,rc[2]=L-(W-d)+(k-d),rc[3]=W;const de=nA(ue,jz,4,rc,Uz);M=o*f,b=zu*o,v=b-(b-o),S=o-v,b=zu*f,E=b-(b-f),P=f-E,z=S*P-(M-v*E-S*E-v*P),B=u*h,b=zu*u,v=b-(b-u),S=u-v,b=zu*h,E=b-(b-h),P=h-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,d=z-k,rc[0]=z-(k+d)+(d-q),L=M+k,d=L-M,N=M-(L-d)+(k-d),k=N-B,d=N-k,rc[1]=N-(k+d)+(d-B),W=L+k,d=W-L,rc[2]=L-(W-d)+(k-d),rc[3]=W;const Pe=nA(de,Uz,4,rc,Vz);return Vz[Pe-1]}function zbe(t,e,r,n,i,a){const s=(e-a)*(r-i),o=(t-i)*(n-a),u=s-o,h=Math.abs(s+o);return Math.abs(u)>=Lbe*h?u:-Bbe(t,e,r,n,i,a,h)}function jbe(t,e){var r,n,i=0,a,s,o,u,h,f,d,b=t[0],v=t[1],S=e.length;for(r=0;r<S;r++){n=0;var E=e[r],P=E.length-1;if(f=E[0],f[0]!==E[P][0]&&f[1]!==E[P][1])throw new Error("First and last coordinates in a ring must be the same");for(s=f[0]-b,o=f[1]-v,n;n<P;n++){if(d=E[n+1],u=d[0]-b,h=d[1]-v,o===0&&h===0){if(u<=0&&s>=0||s<=0&&u>=0)return 0}else if(h>=0&&o<=0||h<=0&&o>=0){if(a=zbe(s,u,o,h,0,0),a===0)return 0;(a>0&&h>0&&o<=0||a<0&&h<=0&&o>0)&&i++}f=d,o=h,s=u}}return i%2!==0}function _T(t,e,r={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=rg(t),i=sb(e),a=i.type,s=e.bbox;let o=i.coordinates;if(s&&Ube(n,s)===!1)return!1;a==="Polygon"&&(o=[o]);let u=!1;for(var h=0;h<o.length;++h){const f=jbe(n,o[h]);if(f===0)return!r.ignoreBoundary;f&&(u=!0)}return u}function Ube(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function ub(t,e,r={}){const n=rg(t),i=AZ(e);for(let a=0;a<i.length-1;a++){let s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===i.length-2&&(s="end"),a===0&&a+1===i.length-1&&(s="both")),Vbe(i[a],i[a+1],n,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function Vbe(t,e,r,n,i){const a=r[0],s=r[1],o=t[0],u=t[1],h=e[0],f=e[1],d=r[0]-o,b=r[1]-u,v=h-o,S=f-u,E=d*S-b*v;if(i!==null){if(Math.abs(E)>i)return!1}else if(E!==0)return!1;if(Math.abs(v)===Math.abs(S)&&Math.abs(v)===0)return n?!1:r[0]===t[0]&&r[1]===t[1];if(n){if(n==="start")return Math.abs(v)>=Math.abs(S)?v>0?o<a&&a<=h:h<=a&&a<o:S>0?u<s&&s<=f:f<=s&&s<u;if(n==="end")return Math.abs(v)>=Math.abs(S)?v>0?o<=a&&a<h:h<a&&a<=o:S>0?u<=s&&s<f:f<s&&s<=u;if(n==="both")return Math.abs(v)>=Math.abs(S)?v>0?o<a&&a<h:h<a&&a<o:S>0?u<s&&s<f:f<s&&s<u}else return Math.abs(v)>=Math.abs(S)?v>0?o<=a&&a<=h:h<=a&&a<=o:S>0?u<=s&&s<=f:f<=s&&s<=u;return!1}function $be(t,e){const r=sb(t),n=sb(e),i=r.type,a=n.type,s=r.coordinates,o=n.coordinates;switch(i){case"Point":switch(a){case"Point":return rN(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return Hbe(r,n);case"MultiPoint":return Wbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return ub(n,r,{ignoreEndVertices:!0});case"LineString":return Ybe(r,n);case"MultiPoint":return Gbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return _T(n,r,{ignoreBoundary:!0});case"LineString":return Zbe(r,n);case"Polygon":return PZ(r,n);case"MultiPoint":return Xbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPolygon":switch(a){case"Polygon":return qbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function qbe(t,e){return t.coordinates.some(r=>PZ({type:"Polygon",coordinates:r},e))}function Hbe(t,e){let r,n=!1;for(r=0;r<t.coordinates.length;r++)if(rN(t.coordinates[r],e.coordinates)){n=!0;break}return n}function Wbe(t,e){for(const r of e.coordinates){let n=!1;for(const i of t.coordinates)if(rN(r,i)){n=!0;break}if(!n)return!1}return!0}function Gbe(t,e){let r=!1;for(const n of e.coordinates)if(ub(n,t,{ignoreEndVertices:!0})&&(r=!0),!ub(n,t))return!1;return!!r}function Xbe(t,e){for(const r of e.coordinates)if(!_T(r,t,{ignoreBoundary:!0}))return!1;return!0}function Ybe(t,e){let r=!1;for(const n of e.coordinates)if(ub({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(r=!0),!ub({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1;return r}function Zbe(t,e){let r=!1,n=0;const i=ah(t),a=ah(e);if(!kZ(i,a))return!1;for(n;n<e.coordinates.length-1;n++){const s=Kbe(e.coordinates[n],e.coordinates[n+1]);if(_T({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){r=!0;break}}return r}function PZ(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const r=ah(t),n=ah(e);if(!kZ(r,n))return!1;const i=sb(e).coordinates;for(const a of i)for(const s of a)if(!_T(s,t))return!1;return!0}function kZ(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function rN(t,e){return t[0]===e[0]&&t[1]===e[1]}function Kbe(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function Jbe(t,e={}){const r=ah(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return Mh([n,i],e.properties,e)}var vw={exports:{}},Qbe=vw.exports,$z;function exe(){return $z||($z=1,(function(t,e){(function(r,n){t.exports=n()})(Qbe,(function(){function r(A,y){(y==null||y>A.length)&&(y=A.length);for(var _=0,I=Array(y);_<y;_++)I[_]=A[_];return I}function n(A,y,_){return y=f(y),(function(I,U){if(U&&(typeof U=="object"||typeof U=="function"))return U;if(U!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(re){if(re===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re})(I)})(A,b()?Reflect.construct(y,_||[],f(A).constructor):y.apply(A,_))}function i(A,y){if(!(A instanceof y))throw new TypeError("Cannot call a class as a function")}function a(A,y,_){if(b())return Reflect.construct.apply(null,arguments);var I=[null];I.push.apply(I,y);var U=new(A.bind.apply(A,I));return _&&v(U,_.prototype),U}function s(A,y){for(var _=0;_<y.length;_++){var I=y[_];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(A,P(I.key),I)}}function o(A,y,_){return y&&s(A.prototype,y),_&&s(A,_),Object.defineProperty(A,"prototype",{writable:!1}),A}function u(A,y){var _=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!_){if(Array.isArray(A)||(_=k(A))||y){_&&(A=_);var I=0,U=function(){};return{s:U,n:function(){return I>=A.length?{done:!0}:{done:!1,value:A[I++]}},e:function(Ke){throw Ke},f:U}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,ye=!0,ke=!1;return{s:function(){_=_.call(A)},n:function(){var Ke=_.next();return ye=Ke.done,Ke},e:function(Ke){ke=!0,re=Ke},f:function(){try{ye||_.return==null||_.return()}finally{if(ke)throw re}}}}function h(){return h=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(A,y,_){var I=(function(re,ye){for(;!{}.hasOwnProperty.call(re,ye)&&(re=f(re))!==null;);return re})(A,y);if(I){var U=Object.getOwnPropertyDescriptor(I,y);return U.get?U.get.call(arguments.length<3?A:_):U.value}},h.apply(null,arguments)}function f(A){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},f(A)}function d(A,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(y&&y.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),Object.defineProperty(A,"prototype",{writable:!1}),y&&v(A,y)}function b(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(b=function(){return!!A})()}function v(A,y){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,I){return _.__proto__=I,_},v(A,y)}function S(A,y,_,I){var U=h(f(1&I?A.prototype:A),y,_);return 2&I&&typeof U=="function"?function(re){return U.apply(_,re)}:U}function E(A){return(function(y){if(Array.isArray(y))return r(y)})(A)||(function(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)})(A)||k(A)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function P(A){var y=(function(_,I){if(typeof _!="object"||!_)return _;var U=_[Symbol.toPrimitive];if(U!==void 0){var re=U.call(_,I);if(typeof re!="object")return re;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)})(A,"string");return typeof y=="symbol"?y:y+""}function k(A,y){if(A){if(typeof A=="string")return r(A,y);var _={}.toString.call(A).slice(8,-1);return _==="Object"&&A.constructor&&(_=A.constructor.name),_==="Map"||_==="Set"?Array.from(A):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(A,y):void 0}}function L(A){var y=typeof Map=="function"?new Map:void 0;return L=function(_){if(_===null||!(function(U){try{return Function.toString.call(U).indexOf("[native code]")!==-1}catch{return typeof U=="function"}})(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(y!==void 0){if(y.has(_))return y.get(_);y.set(_,I)}function I(){return a(_,arguments,f(this).constructor)}return I.prototype=Object.create(_.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),v(I,_)},L(A)}var N=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(y){this._quadrantSegments=y,this._quadrantSegments===0&&(this._joinStyle=A.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=A.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),y<=0&&(this._quadrantSegments=1),this._joinStyle!==A.JOIN_ROUND&&(this._quadrantSegments=A.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(y){this._joinStyle=y}},{key:"setSimplifyFactor",value:function(y){this._simplifyFactor=y<0?0:y}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(y){this._endCapStyle=y}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(y){this._mitreLimit=y}},{key:"setSingleSided",value:function(y){this._isSingleSided=y}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=A.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=A.CAP_ROUND,this._joinStyle=A.JOIN_ROUND,this._mitreLimit=A.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=A.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.setQuadrantSegments(y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(I)}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3];this.setQuadrantSegments(U),this.setEndCapStyle(re),this.setJoinStyle(ye),this.setMitreLimit(ke)}}}},{key:"bufferDistanceError",value:function(y){var _=Math.PI/2/y;return 1-Math.cos(_/2)}}])})();N.CAP_ROUND=1,N.CAP_FLAT=2,N.CAP_SQUARE=3,N.JOIN_ROUND=1,N.JOIN_MITRE=2,N.JOIN_BEVEL=3,N.DEFAULT_QUADRANT_SEGMENTS=8,N.DEFAULT_MITRE_LIMIT=5,N.DEFAULT_SIMPLIFY_FACTOR=.01;var M=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({Exception:y})[0],I}return d(y,A),o(y,[{key:"toString",value:function(){return this.message}}])})(L(Error)),z=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({IllegalArgumentException:y})[0],I}return d(y,A),o(y)})(M),B=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})();function q(){}function W(){}function G(){}var ie,J,H,ne,ae,ue,de,Pe,me=(function(){return o((function A(){i(this,A)}),null,[{key:"equalsWithTolerance",value:function(A,y,_){return Math.abs(A-y)<=_}}])})(),Ee=(function(){return o((function A(y,_){i(this,A),this.low=_||0,this.high=y||0}),null,[{key:"toBinaryString",value:function(A){var y,_="";for(y=2147483648;y>0;y>>>=1)_+=(A.high&y)===y?"1":"0";for(y=2147483648;y>0;y>>>=1)_+=(A.low&y)===y?"1":"0";return _}}])})();function we(){}function Ae(){}we.NaN=NaN,we.isNaN=function(A){return Number.isNaN(A)},we.isInfinite=function(A){return!Number.isFinite(A)},we.MAX_VALUE=Number.MAX_VALUE,we.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,we.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(ue=2146435072,de=new Float64Array(1),Pe=new Int32Array(de.buffer),we.doubleToLongBits=function(A){de[0]=A;var y=0|Pe[0],_=0|Pe[1];return(_&ue)===ue&&1048575&_&&y!==0&&(y=0,_=2146959360),new Ee(_,y)},we.longBitsToDouble=function(A){return Pe[0]=A.low,Pe[1]=A.high,de[0]}):(ie=1023,J=Math.log2,H=Math.floor,ne=Math.pow,ae=(function(){for(var A=53;A>0;A--){var y=ne(2,A)-1;if(H(J(y))+1===A)return y}return 0})(),we.doubleToLongBits=function(A){var y,_,I,U,re,ye,ke,Ke,yt;if(A<0||1/A===Number.NEGATIVE_INFINITY?(ye=1<<31,A=-A):ye=0,A===0)return new Ee(Ke=ye,yt=0);if(A===1/0)return new Ee(Ke=2146435072|ye,yt=0);if(A!=A)return new Ee(Ke=2146959360,yt=0);if(U=0,yt=0,(y=H(A))>1)if(y<=ae)(U=H(J(y)))<=20?(yt=0,Ke=y<<20-U&1048575):(yt=y%(_=ne(2,I=U-20))<<32-I,Ke=y/_&1048575);else for(I=y,yt=0;(I=H(_=I/2))!==0;)U++,yt>>>=1,yt|=(1&Ke)<<31,Ke>>>=1,_!==I&&(Ke|=524288);if(ke=U+ie,re=y===0,y=A-y,U<52&&y!==0)for(I=0;;){if((_=2*y)>=1?(y=_-1,re?(ke--,re=!1):(I<<=1,I|=1,U++)):(y=_,re?--ke==0&&(U++,re=!1):(I<<=1,U++)),U===20)Ke|=I,I=0;else if(U===52){yt|=I;break}if(_===1){U<20?Ke|=I<<20-U:U<52&&(yt|=I<<52-U);break}}return Ke|=ke<<20,new Ee(Ke|=ye,yt)},we.longBitsToDouble=function(A){var y,_,I,U,re=A.high,ye=A.low,ke=re&1<<31?-1:1;for(I=((2146435072&re)>>20)-ie,U=0,_=1<<19,y=1;y<=20;y++)re&_&&(U+=ne(2,-y)),_>>>=1;for(_=1<<31,y=21;y<=52;y++)ye&_&&(U+=ne(2,-y)),_>>>=1;if(I===-1023){if(U===0)return 0*ke;I=-1022}else{if(I===1024)return U===0?ke/0:NaN;U+=1}return ke*U*ne(2,I)});var ce=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({RuntimeException:y})[0],I}return d(y,A),o(y)})(M),xe=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,null,[{key:"constructor_",value:function(){if(arguments.length===0)ce.constructor_.call(this);else if(arguments.length===1){var _=arguments[0];ce.constructor_.call(this,_)}}}])})(ce),_e=(function(){function A(){i(this,A)}return o(A,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)A.shouldNeverReachHere(null);else if(arguments.length===1){var y=arguments[0];throw new xe("Should never reach here"+(y!==null?": "+y:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var y=arguments[0];A.isTrue(y,null)}else if(arguments.length===2){var _=arguments[1];if(!arguments[0])throw _===null?new xe:new xe(_)}}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];A.equals(y,_,null)}else if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];if(!U.equals(I))throw new xe("Expected "+I+" but encountered "+U+(re!==null?": "+re:""))}}}])})(),Me=new ArrayBuffer(8),Re=new Float64Array(Me),He=new Int32Array(Me),Fe=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getM",value:function(){return we.NaN}},{key:"setOrdinate",value:function(y,_){switch(y){case A.X:this.x=_;break;case A.Y:this.y=_;break;case A.Z:this.setZ(_);break;default:throw new z("Invalid ordinate index: "+y)}}},{key:"equals2D",value:function(){if(arguments.length===1){var y=arguments[0];return this.x===y.x&&this.y===y.y}if(arguments.length===2){var _=arguments[0],I=arguments[1];return!!me.equalsWithTolerance(this.x,_.x,I)&&!!me.equalsWithTolerance(this.y,_.y,I)}}},{key:"setM",value:function(y){throw new z("Invalid ordinate index: "+A.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(y){switch(y){case A.X:return this.x;case A.Y:return this.y;case A.Z:return this.getZ()}throw new z("Invalid ordinate index: "+y)}},{key:"equals3D",value:function(y){return this.x===y.x&&this.y===y.y&&(this.getZ()===y.getZ()||we.isNaN(this.getZ())&&we.isNaN(y.getZ()))}},{key:"equals",value:function(y){return y instanceof A&&this.equals2D(y)}},{key:"equalInZ",value:function(y,_){return me.equalsWithTolerance(this.getZ(),y.getZ(),_)}},{key:"setX",value:function(y){this.x=y}},{key:"compareTo",value:function(y){var _=y;return this.x<_.x?-1:this.x>_.x?1:this.y<_.y?-1:this.y>_.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(y){this.z=y}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return _e.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw y}}},{key:"copy",value:function(){return new A(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(y){var _=this.x-y.x,I=this.y-y.y,U=this.getZ()-y.getZ();return Math.sqrt(_*_+I*I+U*U)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(y){this.y=y}},{key:"distance",value:function(y){var _=this.x-y.x,I=this.y-y.y;return Math.sqrt(_*_+I*I)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*y+A.hashCode(this.x))+A.hashCode(this.y)}},{key:"setCoordinate",value:function(y){this.x=y.x,this.y=y.y,this.z=y.getZ()}},{key:"interfaces_",get:function(){return[q,W,G]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)A.constructor_.call(this,0,0);else if(arguments.length===1){var y=arguments[0];A.constructor_.call(this,y.x,y.y,y.getZ())}else if(arguments.length===2){var _=arguments[0],I=arguments[1];A.constructor_.call(this,_,I,A.NULL_ORDINATE)}else if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];this.x=U,this.y=re,this.z=ye}}},{key:"hashCode",value:function(y){return Re[0]=y,He[0]^He[1]}}])})(),tt=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compare",value:function(y,_){var I=A.compare(y.x,_.x);if(I!==0)return I;var U=A.compare(y.y,_.y);return U!==0?U:this._dimensionsToTest<=2?0:A.compare(y.getZ(),_.getZ())}},{key:"interfaces_",get:function(){return[Ae]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)A.constructor_.call(this,2);else if(arguments.length===1){var y=arguments[0];if(y!==2&&y!==3)throw new z("only 2 or 3 dimensions may be specified");this._dimensionsToTest=y}}},{key:"compare",value:function(y,_){return y<_?-1:y>_?1:we.isNaN(y)?we.isNaN(_)?0:-1:we.isNaN(_)?1:0}}])})();Fe.DimensionalComparator=tt,Fe.NULL_ORDINATE=we.NaN,Fe.X=0,Fe.Y=1,Fe.Z=2,Fe.M=3;var Ze=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this.isNull()?_.isNull():this._maxx===_.getMaxX()&&this._maxy===_.getMaxY()&&this._minx===_.getMinX()&&this._miny===_.getMinY()}},{key:"intersection",value:function(y){if(this.isNull()||y.isNull()||!this.intersects(y))return new A;var _=this._minx>y._minx?this._minx:y._minx,I=this._miny>y._miny?this._miny:y._miny;return new A(_,this._maxx<y._maxx?this._maxx:y._maxx,I,this._maxy<y._maxy?this._maxy:y._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Fe){var y=arguments[0];return this.covers(y.x,y.y)}if(arguments[0]instanceof A){var _=arguments[0];return!this.isNull()&&!_.isNull()&&_.getMinX()>=this._minx&&_.getMaxX()<=this._maxx&&_.getMinY()>=this._miny&&_.getMaxY()<=this._maxy}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];return!this.isNull()&&I>=this._minx&&I<=this._maxx&&U>=this._miny&&U<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return!this.isNull()&&!y.isNull()&&!(y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny)}if(arguments[0]instanceof Fe){var _=arguments[0];return this.intersects(_.x,_.y)}}else if(arguments.length===2){if(arguments[0]instanceof Fe&&arguments[1]instanceof Fe){var I=arguments[0],U=arguments[1];return!this.isNull()&&!((I.x<U.x?I.x:U.x)>this._maxx)&&!((I.x>U.x?I.x:U.x)<this._minx)&&!((I.y<U.y?I.y:U.y)>this._maxy)&&!((I.y>U.y?I.y:U.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var re=arguments[0],ye=arguments[1];return!this.isNull()&&!(re>this._maxx||re<this._minx||ye>this._maxy||ye<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return Math.sqrt(y*y+_*_)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Fe){var y=arguments[0];this.expandToInclude(y.x,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];if(_.isNull())return null;this.isNull()?(this._minx=_.getMinX(),this._maxx=_.getMaxX(),this._miny=_.getMinY(),this._maxy=_.getMaxY()):(_._minx<this._minx&&(this._minx=_._minx),_._maxx>this._maxx&&(this._maxx=_._maxx),_._miny<this._miny&&(this._miny=_._miny),_._maxy>this._maxy&&(this._maxy=_._maxy))}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.isNull()?(this._minx=I,this._maxx=I,this._miny=U,this._maxy=U):(I<this._minx&&(this._minx=I),I>this._maxx&&(this._maxx=I),U<this._miny&&(this._miny=U),U>this._maxy&&(this._maxy=U))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y<_?y:_}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(y){var _=y;return this.isNull()?_.isNull()?0:-1:_.isNull()?1:this._minx<_._minx?-1:this._minx>_._minx?1:this._miny<_._miny?-1:this._miny>_._miny?1:this._maxx<_._maxx?-1:this._maxx>_._maxx?1:this._maxy<_._maxy?-1:this._maxy>_._maxy?1:0}},{key:"translate",value:function(y,_){if(this.isNull())return null;this.init(this.getMinX()+y,this.getMaxX()+y,this.getMinY()+_,this.getMaxY()+_)}},{key:"copy",value:function(){return new A(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(y){return!(!this.isNull()&&!y.isNull())||y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y>_?y:_}},{key:"expandBy",value:function(){if(arguments.length===1){var y=arguments[0];this.expandBy(y,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];if(this.isNull())return null;this._minx-=_,this._maxx+=_,this._miny-=I,this._maxy+=I,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.covers(y)}if(arguments[0]instanceof Fe){var _=arguments[0];return this.covers(_)}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];return this.covers(I,U)}}},{key:"centre",value:function(){return this.isNull()?null:new Fe((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Fe){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];this._minx=_._minx,this._maxx=_._maxx,this._miny=_._miny,this._maxy=_._maxy}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.init(I.x,U.x,I.y,U.y)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],ke=arguments[2],Ke=arguments[3];re<ye?(this._minx=re,this._maxx=ye):(this._minx=ye,this._maxx=re),ke<Ke?(this._miny=ke,this._maxy=Ke):(this._miny=Ke,this._maxy=ke)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(y){if(this.intersects(y))return 0;var _=0;this._maxx<y._minx?_=y._minx-this._maxx:this._minx>y._maxx&&(_=this._minx-y._maxx);var I=0;return this._maxy<y._miny?I=y._miny-this._maxy:this._miny>y._maxy&&(I=this._miny-y._maxy),_===0?I:I===0?_:Math.sqrt(_*_+I*I)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*(y=37*(y=37*y+Fe.hashCode(this._minx))+Fe.hashCode(this._maxx))+Fe.hashCode(this._miny))+Fe.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[q,G]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Fe){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.init(I.x,U.x,I.y,U.y)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],ke=arguments[2],Ke=arguments[3];this.init(re,ye,ke,Ke)}}},{key:"intersects",value:function(){if(arguments.length===3){var y=arguments[0],_=arguments[1],I=arguments[2];return I.x>=(y.x<_.x?y.x:_.x)&&I.x<=(y.x>_.x?y.x:_.x)&&I.y>=(y.y<_.y?y.y:_.y)&&I.y<=(y.y>_.y?y.y:_.y)}if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3],Ke=Math.min(ye.x,ke.x),yt=Math.max(ye.x,ke.x),rr=Math.min(U.x,re.x),gr=Math.max(U.x,re.x);return!(rr>yt)&&!(gr<Ke)&&(Ke=Math.min(ye.y,ke.y),yt=Math.max(ye.y,ke.y),rr=Math.min(U.y,re.y),gr=Math.max(U.y,re.y),!(rr>yt)&&!(gr<Ke))}}}])})(),Qe=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(y){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(y){return this===y||this.equalsExact(y,0)}},{key:"geometryChanged",value:function(){this.apply(A.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(y){return y!==null&&this.norm().equalsExact(y.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var y;if(arguments.length===1){var _=arguments[0];return y=_,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(_)}if(arguments.length===2){var I=arguments[0],U=arguments[1];return y=I,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(I,U)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(y){if(y.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION)throw new z("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(y,_,I){return I===0?y.equals(_):y.distance(_)<=I}},{key:"norm",value:function(){var y=this.copy();return y.normalize(),y}},{key:"reverse",value:function(){var y=this.reverseInternal();return this.envelope!=null&&(y.envelope=this.envelope.copy()),y.setSRID(this.getSRID()),y}},{key:"copy",value:function(){var y=this.copyInternal();return y.envelope=this._envelope==null?null:this._envelope.copy(),y._SRID=this._SRID,y._userData=this._userData,y}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ze(this._envelope)}},{key:"setSRID",value:function(y){this._SRID=y}},{key:"setUserData",value:function(y){this._userData=y}},{key:"compare",value:function(y,_){for(var I=y.iterator(),U=_.iterator();I.hasNext()&&U.hasNext();){var re=I.next(),ye=U.next(),ke=re.compareTo(ye);if(ke!==0)return ke}return I.hasNext()?1:U.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(y){return this.getClass()===y.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===A.TYPECODE_MULTIPOINT||this.getTypeCode()===A.TYPECODE_MULTILINESTRING||this.getTypeCode()===A.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[W,q,G]}},{key:"getClass",value:function(){return A}}],[{key:"hasNonEmptyElements",value:function(y){for(var _=0;_<y.length;_++)if(!y[_].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(y){for(var _=0;_<y.length;_++)if(y[_]===null)return!0;return!1}}])})();Qe.constructor_=function(A){A&&(this._envelope=null,this._userData=null,this._factory=A,this._SRID=A.getSRID())},Qe.TYPECODE_POINT=0,Qe.TYPECODE_MULTIPOINT=1,Qe.TYPECODE_LINESTRING=2,Qe.TYPECODE_LINEARRING=3,Qe.TYPECODE_MULTILINESTRING=4,Qe.TYPECODE_POLYGON=5,Qe.TYPECODE_MULTIPOLYGON=6,Qe.TYPECODE_GEOMETRYCOLLECTION=7,Qe.TYPENAME_POINT="Point",Qe.TYPENAME_MULTIPOINT="MultiPoint",Qe.TYPENAME_LINESTRING="LineString",Qe.TYPENAME_LINEARRING="LinearRing",Qe.TYPENAME_MULTILINESTRING="MultiLineString",Qe.TYPENAME_POLYGON="Polygon",Qe.TYPENAME_MULTIPOLYGON="MultiPolygon",Qe.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",Qe.geometryChangedFilter={get interfaces_(){return[B]},filter:function(A){A.geometryChangedAction()}};var Ie=(function(){function A(){i(this,A)}return o(A,null,[{key:"toLocationSymbol",value:function(y){switch(y){case A.EXTERIOR:return"e";case A.BOUNDARY:return"b";case A.INTERIOR:return"i";case A.NONE:return"-"}throw new z("Unknown location value: "+y)}}])})();Ie.INTERIOR=0,Ie.BOUNDARY=1,Ie.EXTERIOR=2,Ie.NONE=-1;var Lt=(function(){return o((function A(){i(this,A)}),[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])})(),at=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({NoSuchElementException:y})[0],I}return d(y,A),o(y)})(M),Ve=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({UnsupportedOperationException:y})[0],I}return d(y,A),o(y)})(M),nr=(function(A){function y(){return i(this,y),n(this,y,arguments)}return d(y,A),o(y,[{key:"contains",value:function(){}}])})(Lt),Yt=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).map=new Map,_ instanceof Lt&&I.addAll(_),I}return d(y,A),o(y,[{key:"contains",value:function(_){var I=_.hashCode?_.hashCode():_;return!!this.map.has(I)}},{key:"add",value:function(_){var I=_.hashCode?_.hashCode():_;return!this.map.has(I)&&!!this.map.set(I,_)}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.add(re)}}catch(ye){U.e(ye)}finally{U.f()}return!0}},{key:"remove",value:function(){throw new Ve}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new yr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])})(nr),yr=(function(){return o((function A(y){i(this,A),this.iterator=y.values();var _=this.iterator.next(),I=_.done,U=_.value;this.done=I,this.value=U}),[{key:"next",value:function(){if(this.done)throw new at;var A=this.value,y=this.iterator.next(),_=y.done,I=y.value;return this.done=_,this.value=I,A}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new Ve}}])})(),mt=(function(){function A(){i(this,A)}return o(A,null,[{key:"opposite",value:function(y){return y===A.LEFT?A.RIGHT:y===A.RIGHT?A.LEFT:y}}])})();mt.ON=0,mt.LEFT=1,mt.RIGHT=2;var br=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({EmptyStackException:y})[0],I}return d(y,A),o(y)})(M),Tr=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({IndexOutOfBoundsException:y})[0],I}return d(y,A),o(y)})(M),mr=(function(A){function y(){return i(this,y),n(this,y,arguments)}return d(y,A),o(y,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])})(Lt),Mr=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).array=[],_}return d(y,A),o(y,[{key:"add",value:function(_){return this.array.push(_),!0}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new Tr;return this.array[_]}},{key:"push",value:function(_){return this.array.push(_),_}},{key:"pop",value:function(){if(this.array.length===0)throw new br;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new br;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(_){return this.array.indexOf(_)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])})(mr);function Pr(A,y){return A.interfaces_&&A.interfaces_.indexOf(y)>-1}var ar=(function(){return o((function A(y){i(this,A),this.str=y}),[{key:"append",value:function(A){this.str+=A}},{key:"setCharAt",value:function(A,y){this.str=this.str.substr(0,A)+y+this.str.substr(A+1)}},{key:"toString",value:function(){return this.str}}])})(),fr=(function(){function A(y){i(this,A),this.value=y}return o(A,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(y){return this.value<y?-1:this.value>y?1:0}}],[{key:"compare",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"isNan",value:function(y){return Number.isNaN(y)}},{key:"valueOf",value:function(y){return new A(y)}}])})(),Nr=(function(){return o((function A(){i(this,A)}),null,[{key:"isWhitespace",value:function(A){return A<=32&&A>=0||A===127}},{key:"toUpperCase",value:function(A){return A.toUpperCase()}}])})(),or=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"le",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<=y._lo}},{key:"extractSignificantDigits",value:function(y,_){var I=this.abs(),U=A.magnitude(I._hi),re=A.TEN.pow(U);(I=I.divide(re)).gt(A.TEN)?(I=I.divide(A.TEN),U+=1):I.lt(A.ONE)&&(I=I.multiply(A.TEN),U-=1);for(var ye=U+1,ke=new ar,Ke=A.MAX_PRINT_DIGITS-1,yt=0;yt<=Ke;yt++){y&&yt===ye&&ke.append(".");var rr=Math.trunc(I._hi);if(rr<0)break;var gr=!1,Wr=0;rr>9?(gr=!0,Wr="9"):Wr="0"+rr,ke.append(Wr),I=I.subtract(A.valueOf(rr)).multiply(A.TEN),gr&&I.selfAdd(A.TEN);var wn=!0,Un=A.magnitude(I._hi);if(Un<0&&Math.abs(Un)>=Ke-yt&&(wn=!1),!wn)break}return _[0]=U,ke.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.add(y.negate())}if(typeof arguments[0]=="number"){var _=arguments[0];return this.add(-_)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof A){var y=arguments[0];return this._hi===y._hi&&this._lo===y._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.isNaN()?this:this.selfAdd(-y._hi,-y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.isNaN()?this:this.selfAdd(-_,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(y){return this.le(y)?this:y}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfDivide(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfDivide(_,0)}}else if(arguments.length===2){var I,U,re,ye,ke=arguments[0],Ke=arguments[1],yt=null,rr=null,gr=null,Wr=null;return re=this._hi/ke,Wr=(yt=(gr=A.SPLIT*re)-(yt=gr-re))*(rr=(Wr=A.SPLIT*ke)-(rr=Wr-ke))-(ye=re*ke)+yt*(U=ke-rr)+(I=re-yt)*rr+I*U,Wr=re+(gr=(this._hi-ye-Wr+this._lo-re*Ke)/ke),this._hi=Wr,this._lo=re-Wr+gr,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof A){var y,_,I,U,re=arguments[0],ye=null,ke=null,Ke=null,yt=null;return y=(I=this._hi/re._hi)-(ye=(Ke=A.SPLIT*I)-(ye=Ke-I)),yt=ye*(ke=(yt=A.SPLIT*re._hi)-(ke=yt-re._hi))-(U=I*re._hi)+ye*(_=re._hi-ke)+y*ke+y*_,new A(yt=I+(Ke=(this._hi-U-yt+this._lo-I*re._lo)/re._hi),I-yt+Ke)}if(typeof arguments[0]=="number"){var rr=arguments[0];return we.isNaN(rr)?A.createNaN():A.copy(this).selfDivide(rr,0)}}},{key:"ge",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>=y._lo}},{key:"pow",value:function(y){if(y===0)return A.valueOf(1);var _=new A(this),I=A.valueOf(1),U=Math.abs(y);if(U>1)for(;U>0;)U%2==1&&I.selfMultiply(_),(U/=2)>0&&(_=_.sqr());else I=_;return y<0?I.reciprocal():I}},{key:"ceil",value:function(){if(this.isNaN())return A.NaN;var y=Math.ceil(this._hi),_=0;return y===this._hi&&(_=Math.ceil(this._lo)),new A(y,_)}},{key:"compareTo",value:function(y){var _=y;return this._hi<_._hi?-1:this._hi>_._hi?1:this._lo<_._lo?-1:this._lo>_._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.init(y),this}if(typeof arguments[0]=="number"){var _=arguments[0];return this.init(_),this}}},{key:"max",value:function(y){return this.ge(y)?this:y}},{key:"sqrt",value:function(){if(this.isZero())return A.valueOf(0);if(this.isNegative())return A.NaN;var y=1/Math.sqrt(this._hi),_=this._hi*y,I=A.valueOf(_),U=this.subtract(I.sqr())._hi*(.5*y);return I.add(U)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfAdd(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _,I,U,re,ye,ke=arguments[0],Ke=null;return Ke=(U=this._hi+ke)-(re=U-this._hi),I=(ye=(Ke=ke-re+(this._hi-Ke))+this._lo)+(U-(_=U+ye)),this._hi=_+I,this._lo=I+(_-this._hi),this}}else if(arguments.length===2){var yt,rr,gr,Wr,wn=arguments[0],Un=arguments[1],Kn=null,jn=null,Bn=null;gr=this._hi+wn,rr=this._lo+Un,jn=gr-(Bn=gr-this._hi),Kn=rr-(Wr=rr-this._lo);var zi=(yt=gr+(Bn=(jn=wn-Bn+(this._hi-jn))+rr))+(Bn=(Kn=Un-Wr+(this._lo-Kn))+(Bn+(gr-yt))),Ri=Bn+(yt-zi);return this._hi=zi,this._lo=Ri,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfMultiply(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfMultiply(_,0)}}else if(arguments.length===2){var I,U,re=arguments[0],ye=arguments[1],ke=null,Ke=null,yt=null,rr=null;ke=(yt=A.SPLIT*this._hi)-this._hi,rr=A.SPLIT*re,ke=yt-ke,I=this._hi-ke,Ke=rr-re;var gr=(yt=this._hi*re)+(rr=ke*(Ke=rr-Ke)-yt+ke*(U=re-Ke)+I*Ke+I*U+(this._hi*ye+this._lo*re)),Wr=rr+(ke=yt-gr);return this._hi=gr,this._lo=Wr,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return A.NaN;var y=Math.floor(this._hi),_=0;return y===this._hi&&(_=Math.floor(this._lo)),new A(y,_)}},{key:"negate",value:function(){return this.isNaN()?this:new A(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return null;throw y}}},{key:"multiply",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return y.isNaN()?A.createNaN():A.copy(this).selfMultiply(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return we.isNaN(_)?A.createNaN():A.copy(this).selfMultiply(_,0)}}},{key:"isNaN",value:function(){return we.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var y=A.magnitude(this._hi);return y>=-3&&y<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),I=this.extractSignificantDigits(!0,_),U=_[0]+1,re=I;if(I.charAt(0)===".")re="0"+I;else if(U<0)re="0."+A.stringOfChar("0",-U)+I;else if(I.indexOf(".")===-1){var ye=U-I.length;re=I+A.stringOfChar("0",ye)+".0"}return this.isNegative()?"-"+re:re}},{key:"reciprocal",value:function(){var y,_,I,U,re=null,ye=null,ke=null,Ke=null;y=(I=1/this._hi)-(re=(ke=A.SPLIT*I)-(re=ke-I)),ye=(Ke=A.SPLIT*this._hi)-this._hi;var yt=I+(ke=(1-(U=I*this._hi)-(Ke=re*(ye=Ke-ye)-U+re*(_=this._hi-ye)+y*ye+y*_)-I*this._lo)/this._hi);return new A(yt,I-yt+ke)}},{key:"toSciNotation",value:function(){if(this.isZero())return A.SCI_NOT_ZERO;var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),I=this.extractSignificantDigits(!1,_),U=A.SCI_NOT_EXPONENT_CHAR+_[0];if(I.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+I);var re="";I.length>1&&(re=I.substring(1));var ye=I.charAt(0)+"."+re;return this.isNegative()?"-"+ye+U:ye+U}},{key:"abs",value:function(){return this.isNaN()?A.NaN:this.isNegative()?this.negate():new A(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<y._lo}},{key:"add",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return A.copy(this).selfAdd(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return A.copy(this).selfAdd(_)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this._hi=y,this._lo=0}else if(arguments[0]instanceof A){var _=arguments[0];this._hi=_._hi,this._lo=_._lo}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this._hi=I,this._lo=U}}},{key:"gt",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>y._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?A.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[G,q,W]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this.init(y)}else if(arguments[0]instanceof A){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var I=arguments[0];A.constructor_.call(this,A.parse(I))}}else if(arguments.length===2){var U=arguments[0],re=arguments[1];this.init(U,re)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],I=arguments[2],U=arguments[3];return A.determinant(A.valueOf(y),A.valueOf(_),A.valueOf(I),A.valueOf(U))}if(arguments[3]instanceof A&&arguments[2]instanceof A&&arguments[0]instanceof A&&arguments[1]instanceof A){var re=arguments[1],ye=arguments[2],ke=arguments[3];return arguments[0].multiply(ke).selfSubtract(re.multiply(ye))}}},{key:"sqr",value:function(y){return A.valueOf(y).selfMultiply(y)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var y=arguments[0];return A.parse(y)}if(typeof arguments[0]=="number")return new A(arguments[0])}},{key:"sqrt",value:function(y){return A.valueOf(y).sqrt()}},{key:"parse",value:function(y){for(var _=0,I=y.length;Nr.isWhitespace(y.charAt(_));)_++;var U=!1;if(_<I){var re=y.charAt(_);re!=="-"&&re!=="+"||(_++,re==="-"&&(U=!0))}for(var ye=new A,ke=0,Ke=0,yt=0,rr=!1;!(_>=I);){var gr=y.charAt(_);if(_++,Nr.isDigit(gr)){var Wr=gr-"0";ye.selfMultiply(A.TEN),ye.selfAdd(Wr),ke++}else{if(gr!=="."){if(gr==="e"||gr==="E"){var wn=y.substring(_);try{yt=fr.parseInt(wn)}catch(zi){throw zi instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+wn+" in string "+y):zi}break}throw new NumberFormatException("Unexpected character '"+gr+"' at position "+_+" in string "+y)}Ke=ke,rr=!0}}var Un=ye;rr||(Ke=ke);var Kn=ke-Ke-yt;if(Kn===0)Un=ye;else if(Kn>0){var jn=A.TEN.pow(Kn);Un=ye.divide(jn)}else if(Kn<0){var Bn=A.TEN.pow(-Kn);Un=ye.multiply(Bn)}return U?Un.negate():Un}},{key:"createNaN",value:function(){return new A(we.NaN,we.NaN)}},{key:"copy",value:function(y){return new A(y)}},{key:"magnitude",value:function(y){var _=Math.abs(y),I=Math.log(_)/Math.log(10),U=Math.trunc(Math.floor(I));return 10*Math.pow(10,U)<=_&&(U+=1),U}},{key:"stringOfChar",value:function(y,_){for(var I=new ar,U=0;U<_;U++)I.append(y);return I.toString()}}])})();or.PI=new or(3.141592653589793,12246467991473532e-32),or.TWO_PI=new or(6.283185307179586,24492935982947064e-32),or.PI_2=new or(1.5707963267948966,6123233995736766e-32),or.E=new or(2.718281828459045,14456468917292502e-32),or.NaN=new or(we.NaN,we.NaN),or.EPS=123259516440783e-46,or.SPLIT=134217729,or.MAX_PRINT_DIGITS=32,or.TEN=or.valueOf(10),or.ONE=or.valueOf(1),or.SCI_NOT_EXPONENT_CHAR="E",or.SCI_NOT_ZERO="0.0E0";var Dr=(function(){function A(){i(this,A)}return o(A,null,[{key:"orientationIndex",value:function(y,_,I){var U=A.orientationIndexFilter(y,_,I);if(U<=1)return U;var re=or.valueOf(_.x).selfAdd(-y.x),ye=or.valueOf(_.y).selfAdd(-y.y),ke=or.valueOf(I.x).selfAdd(-_.x),Ke=or.valueOf(I.y).selfAdd(-_.y);return re.selfMultiply(Ke).selfSubtract(ye.selfMultiply(ke)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof or&&arguments[2]instanceof or&&arguments[0]instanceof or&&arguments[1]instanceof or){var y=arguments[1],_=arguments[2],I=arguments[3];return arguments[0].multiply(I).selfSubtract(y.multiply(_)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3],Ke=or.valueOf(U),yt=or.valueOf(re),rr=or.valueOf(ye),gr=or.valueOf(ke);return Ke.multiply(gr).selfSubtract(yt.multiply(rr)).signum()}}},{key:"intersection",value:function(y,_,I,U){var re=new or(y.y).selfSubtract(_.y),ye=new or(_.x).selfSubtract(y.x),ke=new or(y.x).selfMultiply(_.y).selfSubtract(new or(_.x).selfMultiply(y.y)),Ke=new or(I.y).selfSubtract(U.y),yt=new or(U.x).selfSubtract(I.x),rr=new or(I.x).selfMultiply(U.y).selfSubtract(new or(U.x).selfMultiply(I.y)),gr=ye.multiply(rr).selfSubtract(yt.multiply(ke)),Wr=Ke.multiply(ke).selfSubtract(re.multiply(rr)),wn=re.multiply(yt).selfSubtract(Ke.multiply(ye)),Un=gr.selfDivide(wn).doubleValue(),Kn=Wr.selfDivide(wn).doubleValue();return we.isNaN(Un)||we.isInfinite(Un)||we.isNaN(Kn)||we.isInfinite(Kn)?null:new Fe(Un,Kn)}},{key:"orientationIndexFilter",value:function(y,_,I){var U=null,re=(y.x-I.x)*(_.y-I.y),ye=(y.y-I.y)*(_.x-I.x),ke=re-ye;if(re>0){if(ye<=0)return A.signum(ke);U=re+ye}else{if(!(re<0)||ye>=0)return A.signum(ke);U=-re-ye}var Ke=A.DP_SAFE_EPSILON*U;return ke>=Ke||-ke>=Ke?A.signum(ke):2}},{key:"signum",value:function(y){return y>0?1:y<0?-1:0}}])})();Dr.DP_SAFE_EPSILON=1e-15;var er=(function(){return o((function A(){i(this,A)}),[{key:"getM",value:function(A){if(this.hasM()){var y=this.getDimension()-this.getMeasures();return this.getOrdinate(A,y)}return we.NaN}},{key:"setOrdinate",value:function(A,y,_){}},{key:"getZ",value:function(A){return this.hasZ()?this.getOrdinate(A,2):we.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(A,y){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(A){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(A){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(A){}},{key:"copy",value:function(){}},{key:"getY",value:function(A){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[W]}}])})();er.X=0,er.Y=1,er.Z=2,er.M=3;var Gt=(function(){function A(){i(this,A)}return o(A,null,[{key:"index",value:function(y,_,I){return Dr.orientationIndex(y,_,I)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var y=arguments[0],_=y.length-1;if(_<3)throw new z("Ring has fewer than 4 points, so orientation cannot be determined");for(var I=y[0],U=0,re=1;re<=_;re++){var ye=y[re];ye.y>I.y&&(I=ye,U=re)}var ke=U;do(ke-=1)<0&&(ke=_);while(y[ke].equals2D(I)&&ke!==U);var Ke=U;do Ke=(Ke+1)%_;while(y[Ke].equals2D(I)&&Ke!==U);var yt=y[ke],rr=y[Ke];if(yt.equals2D(I)||rr.equals2D(I)||yt.equals2D(rr))return!1;var gr=A.index(yt,I,rr);return gr===0?yt.x>rr.x:gr>0}if(Pr(arguments[0],er)){var Wr=arguments[0],wn=Wr.size()-1;if(wn<3)throw new z("Ring has fewer than 4 points, so orientation cannot be determined");for(var Un=Wr.getCoordinate(0),Kn=0,jn=1;jn<=wn;jn++){var Bn=Wr.getCoordinate(jn);Bn.y>Un.y&&(Un=Bn,Kn=jn)}var zi=null,Ri=Kn;do(Ri-=1)<0&&(Ri=wn),zi=Wr.getCoordinate(Ri);while(zi.equals2D(Un)&&Ri!==Kn);var ho=null,fo=Kn;do fo=(fo+1)%wn,ho=Wr.getCoordinate(fo);while(ho.equals2D(Un)&&fo!==Kn);if(zi.equals2D(Un)||ho.equals2D(Un)||zi.equals2D(ho))return!1;var Zo=A.index(zi,Un,ho);return Zo===0?zi.x>ho.x:Zo>0}}}])})();Gt.CLOCKWISE=-1,Gt.RIGHT=Gt.CLOCKWISE,Gt.COUNTERCLOCKWISE=1,Gt.LEFT=Gt.COUNTERCLOCKWISE,Gt.COLLINEAR=0,Gt.STRAIGHT=Gt.COLLINEAR;var Tt=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(A,y){var _=this.getRightmostSideOfSegment(A,y);return _<0&&(_=this.getRightmostSideOfSegment(A,y-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(A)),_}},{key:"findRightmostEdgeAtVertex",value:function(){var A=this._minDe.getEdge().getCoordinates();_e.isTrue(this._minIndex>0&&this._minIndex<A.length,"rightmost point expected to be interior vertex of edge");var y=A[this._minIndex-1],_=A[this._minIndex+1],I=Gt.index(this._minCoord,_,y),U=!1;(y.y<this._minCoord.y&&_.y<this._minCoord.y&&I===Gt.COUNTERCLOCKWISE||y.y>this._minCoord.y&&_.y>this._minCoord.y&&I===Gt.CLOCKWISE)&&(U=!0),U&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(A,y){var _=A.getEdge().getCoordinates();if(y<0||y+1>=_.length||_[y].y===_[y+1].y)return-1;var I=mt.LEFT;return _[y].y<_[y+1].y&&(I=mt.RIGHT),I}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(A){for(var y=A.getEdge().getCoordinates(),_=0;_<y.length-1;_++)(this._minCoord===null||y[_].x>this._minCoord.x)&&(this._minDe=A,this._minIndex=_,this._minCoord=y[_])}},{key:"findRightmostEdgeAtNode",value:function(){var A=this._minDe.getNode().getEdges();this._minDe=A.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next();_.isForward()&&this.checkForRightmostCoordinate(_)}_e.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===mt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])})(),Oe=(function(A){function y(_,I){var U;return i(this,y),(U=n(this,y,[I?_+" [ "+I+" ]":_])).pt=I?new Fe(I):void 0,U.name=Object.keys({TopologyException:y})[0],U}return d(y,A),o(y,[{key:"getCoordinate",value:function(){return this.pt}}])})(ce),Be=(function(){return o((function A(){i(this,A),this.array=[]}),[{key:"addLast",value:function(A){this.array.push(A)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])})(),Ne=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).array=[],_ instanceof Lt&&I.addAll(_),I}return d(y,A),o(y,[{key:"interfaces_",get:function(){return[mr,Lt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(_){return arguments.length===1?this.array.push(_):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.array.push(re)}}catch(ye){U.e(ye)}finally{U.f()}}},{key:"set",value:function(_,I){var U=this.array[_];return this.array[_]=I,U}},{key:"iterator",value:function(){return new rt(this)}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new Tr;return this.array[_]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(_){_?this.array.sort((function(I,U){return _.compare(I,U)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(_){for(var I=0,U=this.array.length;I<U;I++)if(this.array[I]===_)return!!this.array.splice(I,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])})(mr),rt=(function(){return o((function A(y){i(this,A),this.arrayList=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new at;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(A){return this.arrayList.set(this.position-1,A)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])})(),pt=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"clearVisitedEdges",value:function(){for(var A=this._dirEdgeList.iterator();A.hasNext();)A.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(A){for(var y=null,_=A.getEdges().iterator();_.hasNext();){var I=_.next();if(I.isVisited()||I.getSym().isVisited()){y=I;break}}if(y===null)throw new Oe("unable to find edge to compute depths at "+A.getCoordinate());A.getEdges().computeDepths(y);for(var U=A.getEdges().iterator();U.hasNext();){var re=U.next();re.setVisited(!0),this.copySymDepths(re)}}},{key:"computeDepth",value:function(A){this.clearVisitedEdges();var y=this._finder.getEdge();y.getNode(),y.getLabel(),y.setEdgeDepths(mt.RIGHT,A),this.copySymDepths(y),this.computeDepths(y)}},{key:"create",value:function(A){this.addReachable(A),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var A=this._dirEdgeList.iterator();A.hasNext();){var y=A.next();y.getDepth(mt.RIGHT)>=1&&y.getDepth(mt.LEFT)<=0&&!y.isInteriorAreaEdge()&&y.setInResult(!0)}}},{key:"computeDepths",value:function(A){var y=new Yt,_=new Be,I=A.getNode();for(_.addLast(I),y.add(I),A.setVisited(!0);!_.isEmpty();){var U=_.removeFirst();y.add(U),this.computeNodeDepth(U);for(var re=U.getEdges().iterator();re.hasNext();){var ye=re.next().getSym();if(!ye.isVisited()){var ke=ye.getNode();y.contains(ke)||(_.addLast(ke),y.add(ke))}}}}},{key:"compareTo",value:function(A){var y=A;return this._rightMostCoord.x<y._rightMostCoord.x?-1:this._rightMostCoord.x>y._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var A=new Ze,y=this._dirEdgeList.iterator();y.hasNext();)for(var _=y.next().getEdge().getCoordinates(),I=0;I<_.length-1;I++)A.expandToInclude(_[I]);this._env=A}return this._env}},{key:"addReachable",value:function(A){var y=new Mr;for(y.add(A);!y.empty();){var _=y.pop();this.add(_,y)}}},{key:"copySymDepths",value:function(A){var y=A.getSym();y.setDepth(mt.LEFT,A.getDepth(mt.RIGHT)),y.setDepth(mt.RIGHT,A.getDepth(mt.LEFT))}},{key:"add",value:function(A,y){A.setVisited(!0),this._nodes.add(A);for(var _=A.getEdges().iterator();_.hasNext();){var I=_.next();this._dirEdgeList.add(I);var U=I.getSym().getNode();U.isVisited()||y.push(U)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Ne,this._nodes=new Ne,this._rightMostCoord=null,this._env=null,this._finder=new Tt}}])})(),Rt=(function(){return o((function A(){i(this,A)}),null,[{key:"intersection",value:function(A,y,_,I){var U=A.x<y.x?A.x:y.x,re=A.y<y.y?A.y:y.y,ye=A.x>y.x?A.x:y.x,ke=A.y>y.y?A.y:y.y,Ke=_.x<I.x?_.x:I.x,yt=_.y<I.y?_.y:I.y,rr=_.x>I.x?_.x:I.x,gr=_.y>I.y?_.y:I.y,Wr=((U>Ke?U:Ke)+(ye<rr?ye:rr))/2,wn=((re>yt?re:yt)+(ke<gr?ke:gr))/2,Un=A.x-Wr,Kn=A.y-wn,jn=y.x-Wr,Bn=y.y-wn,zi=_.x-Wr,Ri=_.y-wn,ho=I.x-Wr,fo=I.y-wn,Zo=Kn-Bn,Ko=jn-Un,Hl=Un*Bn-jn*Kn,lu=Ri-fo,il=ho-zi,Cs=zi*fo-ho*Ri,dc=Zo*il-lu*Ko,As=(Ko*Cs-il*Hl)/dc,qa=(lu*Hl-Zo*Cs)/dc;return we.isNaN(As)||we.isInfinite(As)||we.isNaN(qa)||we.isInfinite(qa)?null:new Fe(As+Wr,qa+wn)}}])})(),Bt=(function(){return o((function A(){i(this,A)}),null,[{key:"arraycopy",value:function(A,y,_,I,U){for(var re=0,ye=y;ye<y+U;ye++)_[I+re]=A[ye],re++}},{key:"getProperty",value:function(A){return{"line.separator":`
`}[A]}}])})(),At=(function(){function A(){i(this,A)}return o(A,null,[{key:"log10",value:function(y){var _=Math.log(y);return we.isInfinite(_)||we.isNaN(_)?_:_/A.LOG_10}},{key:"min",value:function(y,_,I,U){var re=y;return _<re&&(re=_),I<re&&(re=I),U<re&&(re=U),re}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],I=arguments[2];return y<_?_:y>I?I:y}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var U=arguments[0],re=arguments[1],ye=arguments[2];return U<re?re:U>ye?ye:U}}},{key:"wrap",value:function(y,_){return y<0?_- -y%_:y%_}},{key:"max",value:function(){if(arguments.length===3){var y=arguments[1],_=arguments[2],I=arguments[0];return y>I&&(I=y),_>I&&(I=_),I}if(arguments.length===4){var U=arguments[1],re=arguments[2],ye=arguments[3],ke=arguments[0];return U>ke&&(ke=U),re>ke&&(ke=re),ye>ke&&(ke=ye),ke}}},{key:"average",value:function(y,_){return(y+_)/2}}])})();At.LOG_10=Math.log(10);var Zt=(function(){function A(){i(this,A)}return o(A,null,[{key:"segmentToSegment",value:function(y,_,I,U){if(y.equals(_))return A.pointToSegment(y,I,U);if(I.equals(U))return A.pointToSegment(U,y,_);var re=!1;if(Ze.intersects(y,_,I,U)){var ye=(_.x-y.x)*(U.y-I.y)-(_.y-y.y)*(U.x-I.x);if(ye===0)re=!0;else{var ke=(y.y-I.y)*(U.x-I.x)-(y.x-I.x)*(U.y-I.y),Ke=((y.y-I.y)*(_.x-y.x)-(y.x-I.x)*(_.y-y.y))/ye,yt=ke/ye;(yt<0||yt>1||Ke<0||Ke>1)&&(re=!0)}}else re=!0;return re?At.min(A.pointToSegment(y,I,U),A.pointToSegment(_,I,U),A.pointToSegment(I,y,_),A.pointToSegment(U,y,_)):0}},{key:"pointToSegment",value:function(y,_,I){if(_.x===I.x&&_.y===I.y)return y.distance(_);var U=(I.x-_.x)*(I.x-_.x)+(I.y-_.y)*(I.y-_.y),re=((y.x-_.x)*(I.x-_.x)+(y.y-_.y)*(I.y-_.y))/U;if(re<=0)return y.distance(_);if(re>=1)return y.distance(I);var ye=((_.y-y.y)*(I.x-_.x)-(_.x-y.x)*(I.y-_.y))/U;return Math.abs(ye)*Math.sqrt(U)}},{key:"pointToLinePerpendicular",value:function(y,_,I){var U=(I.x-_.x)*(I.x-_.x)+(I.y-_.y)*(I.y-_.y),re=((_.y-y.y)*(I.x-_.x)-(_.x-y.x)*(I.y-_.y))/U;return Math.abs(re)*Math.sqrt(U)}},{key:"pointToSegmentString",value:function(y,_){if(_.length===0)throw new z("Line array must contain at least one vertex");for(var I=y.distance(_[0]),U=0;U<_.length-1;U++){var re=A.pointToSegment(y,_[U],_[U+1]);re<I&&(I=re)}return I}}])})(),jt=(function(){return o((function A(){i(this,A)}),[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Pr(arguments[0],er);else if(arguments.length!==2){if(arguments.length===3){var A=arguments[0],y=arguments[1];return this.create(A,y)}}}}])})(),St=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})(),Xt=(function(){return o((function A(){i(this,A)}),null,[{key:"ofLine",value:function(A){var y=A.size();if(y<=1)return 0;var _=0,I=new Fe;A.getCoordinate(0,I);for(var U=I.x,re=I.y,ye=1;ye<y;ye++){A.getCoordinate(ye,I);var ke=I.x,Ke=I.y,yt=ke-U,rr=Ke-re;_+=Math.sqrt(yt*yt+rr*rr),U=ke,re=Ke}return _}}])})(),Ct=o((function A(){i(this,A)})),Lr=(function(){function A(){i(this,A)}return o(A,null,[{key:"copyCoord",value:function(y,_,I,U){for(var re=Math.min(y.getDimension(),I.getDimension()),ye=0;ye<re;ye++)I.setOrdinate(U,ye,y.getOrdinate(_,ye))}},{key:"isRing",value:function(y){var _=y.size();return _===0||!(_<=3)&&y.getOrdinate(0,er.X)===y.getOrdinate(_-1,er.X)&&y.getOrdinate(0,er.Y)===y.getOrdinate(_-1,er.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Pr(arguments[0],er)&&Number.isInteger(arguments[1])){var y=arguments[0],_=arguments[1];A.scroll(y,_,A.isRing(y))}else if(Pr(arguments[0],er)&&arguments[1]instanceof Fe){var I=arguments[0],U=arguments[1],re=A.indexOf(U,I);if(re<=0)return null;A.scroll(I,re)}}else if(arguments.length===3){var ye=arguments[0],ke=arguments[1],Ke=arguments[2];if(ke<=0)return null;for(var yt=ye.copy(),rr=Ke?ye.size()-1:ye.size(),gr=0;gr<rr;gr++)for(var Wr=0;Wr<ye.getDimension();Wr++)ye.setOrdinate(gr,Wr,yt.getOrdinate((ke+gr)%rr,Wr));if(Ke)for(var wn=0;wn<ye.getDimension();wn++)ye.setOrdinate(rr,wn,ye.getOrdinate(0,wn))}}},{key:"isEqual",value:function(y,_){var I=y.size();if(I!==_.size())return!1;for(var U=Math.min(y.getDimension(),_.getDimension()),re=0;re<I;re++)for(var ye=0;ye<U;ye++){var ke=y.getOrdinate(re,ye),Ke=_.getOrdinate(re,ye);if(y.getOrdinate(re,ye)!==_.getOrdinate(re,ye)&&(!we.isNaN(ke)||!we.isNaN(Ke)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var y=arguments[0];return A.minCoordinateIndex(y,0,y.size()-1)}if(arguments.length===3){for(var _=arguments[0],I=arguments[2],U=-1,re=null,ye=arguments[1];ye<=I;ye++){var ke=_.getCoordinate(ye);(re===null||re.compareTo(ke)>0)&&(re=ke,U=ye)}return U}}},{key:"extend",value:function(y,_,I){var U=y.create(I,_.getDimension()),re=_.size();if(A.copy(_,0,U,0,re),re>0)for(var ye=re;ye<I;ye++)A.copy(_,re-1,U,ye,1);return U}},{key:"reverse",value:function(y){for(var _=y.size()-1,I=Math.trunc(_/2),U=0;U<=I;U++)A.swap(y,U,_-U)}},{key:"swap",value:function(y,_,I){if(_===I)return null;for(var U=0;U<y.getDimension();U++){var re=y.getOrdinate(_,U);y.setOrdinate(_,U,y.getOrdinate(I,U)),y.setOrdinate(I,U,re)}}},{key:"copy",value:function(y,_,I,U,re){for(var ye=0;ye<re;ye++)A.copyCoord(y,_+ye,I,U+ye)}},{key:"ensureValidRing",value:function(y,_){var I=_.size();return I===0?_:I<=3?A.createClosedRing(y,_,4):_.getOrdinate(0,er.X)===_.getOrdinate(I-1,er.X)&&_.getOrdinate(0,er.Y)===_.getOrdinate(I-1,er.Y)?_:A.createClosedRing(y,_,I+1)}},{key:"indexOf",value:function(y,_){for(var I=0;I<_.size();I++)if(y.x===_.getOrdinate(I,er.X)&&y.y===_.getOrdinate(I,er.Y))return I;return-1}},{key:"createClosedRing",value:function(y,_,I){var U=y.create(I,_.getDimension()),re=_.size();A.copy(_,0,U,0,re);for(var ye=re;ye<I;ye++)A.copy(_,0,U,ye,1);return U}},{key:"minCoordinate",value:function(y){for(var _=null,I=0;I<y.size();I++){var U=y.getCoordinate(I);(_===null||_.compareTo(U)>0)&&(_=U)}return _}}])})(),qt=(function(){function A(){i(this,A)}return o(A,null,[{key:"toDimensionSymbol",value:function(y){switch(y){case A.FALSE:return A.SYM_FALSE;case A.TRUE:return A.SYM_TRUE;case A.DONTCARE:return A.SYM_DONTCARE;case A.P:return A.SYM_P;case A.L:return A.SYM_L;case A.A:return A.SYM_A}throw new z("Unknown dimension value: "+y)}},{key:"toDimensionValue",value:function(y){switch(Nr.toUpperCase(y)){case A.SYM_FALSE:return A.FALSE;case A.SYM_TRUE:return A.TRUE;case A.SYM_DONTCARE:return A.DONTCARE;case A.SYM_P:return A.P;case A.SYM_L:return A.L;case A.SYM_A:return A.A}throw new z("Unknown dimension symbol: "+y)}}])})();qt.P=0,qt.L=1,qt.A=2,qt.FALSE=-1,qt.TRUE=-2,qt.DONTCARE=-3,qt.SYM_FALSE="F",qt.SYM_TRUE="T",qt.SYM_DONTCARE="*",qt.SYM_P="0",qt.SYM_L="1",qt.SYM_A="2";var Zr=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})(),jr=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A,y){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])})(),vn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ze:this._points.expandEnvelope(new Ze)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._points.size()!==U._points.size())return!1;for(var re=0;re<this._points.size();re++)if(!this.equal(this._points.getCoordinate(re),U._points.getCoordinate(re),I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var I=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(I))){if(this._points.getCoordinate(_).compareTo(this._points.getCoordinate(I))>0){var U=this._points.copy();Lr.reverse(U),this._points=U}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?qt.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Lr.reverse(_),this.getFactory().createLineString(_)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Xt.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var _=arguments[0],I=0,U=0;I<this._points.size()&&U<_._points.size();){var re=this._points.getCoordinate(I).compareTo(_._points.getCoordinate(U));if(re!==0)return re;I++,U++}return I<this._points.size()?1:U<_._points.size()?-1:0}if(arguments.length===2){var ye=arguments[0];return arguments[1].compare(this._points,ye._points)}}},{key:"apply",value:function(){if(Pr(arguments[0],St))for(var _=arguments[0],I=0;I<this._points.size();I++)_.filter(this._points.getCoordinate(I));else if(Pr(arguments[0],jr)){var U=arguments[0];if(this._points.size()===0)return null;for(var re=0;re<this._points.size()&&(U.filter(this._points,re),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else Pr(arguments[0],Zr)?arguments[0].filter(this):Pr(arguments[0],B)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new Ve}},{key:"isEquivalentClass",value:function(_){return _ instanceof y}},{key:"getCoordinateN",value:function(_){return this._points.getCoordinate(_)}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new z("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_}},{key:"isCoordinate",value:function(_){for(var I=0;I<this._points.size();I++)if(this._points.getCoordinate(I).equals(_))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))}},{key:"interfaces_",get:function(){return[Ct]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],I=arguments[1];Qe.constructor_.call(this,I),this.init(_)}}}}])})(Qe),Ce=o((function A(){i(this,A)})),Ue=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ze;var _=new Ze;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new y(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),I))}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return qt.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var I=arguments[0];return arguments[1].compare(this._coordinates,I._coordinates)}}},{key:"apply",value:function(){if(Pr(arguments[0],St)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Pr(arguments[0],jr)){var I=arguments[0];if(this.isEmpty())return null;I.filter(this._coordinates,0),I.isGeometryChanged()&&this.geometryChanged()}else Pr(arguments[0],Zr)?arguments[0].filter(this):Pr(arguments[0],B)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_e.isTrue(_.size()<=1),this._coordinates=_}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Ce]}}],[{key:"constructor_",value:function(){this._coordinates=null;var _=arguments[0],I=arguments[1];Qe.constructor_.call(this,I),this.init(_)}}])})(Qe),ft=(function(){function A(){i(this,A)}return o(A,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];return Math.abs(A.ofRingSigned(y))}if(Pr(arguments[0],er)){var _=arguments[0];return Math.abs(A.ofRingSigned(_))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];if(y.length<3)return 0;for(var _=0,I=y[0].x,U=1;U<y.length-1;U++){var re=y[U].x-I,ye=y[U+1].y;_+=re*(y[U-1].y-ye)}return _/2}if(Pr(arguments[0],er)){var ke=arguments[0],Ke=ke.size();if(Ke<3)return 0;var yt=new Fe,rr=new Fe,gr=new Fe;ke.getCoordinate(0,rr),ke.getCoordinate(1,gr);var Wr=rr.x;gr.x-=Wr;for(var wn=0,Un=1;Un<Ke-1;Un++)yt.y=rr.y,rr.x=gr.x,rr.y=gr.y,ke.getCoordinate(Un+1,gr),gr.x-=Wr,wn+=rr.x*(yt.y-gr.y);return wn/2}}}])})(),Mt=(function(){return o((function A(){i(this,A)}),null,[{key:"sort",value:function(){var A=arguments,y=arguments[0];if(arguments.length===1)y.sort((function(Wr,wn){return Wr.compareTo(wn)}));else if(arguments.length===2)y.sort((function(Wr,wn){return A[1].compare(Wr,wn)}));else if(arguments.length===3){var _=y.slice(arguments[1],arguments[2]);_.sort();var I=y.slice(0,arguments[1]).concat(_,y.slice(arguments[2],y.length));y.splice(0,y.length);var U,re=u(I);try{for(re.s();!(U=re.n()).done;){var ye=U.value;y.push(ye)}}catch(Wr){re.e(Wr)}finally{re.f()}}else if(arguments.length===4){var ke=y.slice(arguments[1],arguments[2]);ke.sort((function(Wr,wn){return A[3].compare(Wr,wn)}));var Ke=y.slice(0,arguments[1]).concat(ke,y.slice(arguments[2],y.length));y.splice(0,y.length);var yt,rr=u(Ke);try{for(rr.s();!(yt=rr.n()).done;){var gr=yt.value;y.push(gr)}}catch(Wr){rr.e(Wr)}finally{rr.f()}}}},{key:"asList",value:function(A){var y,_=new Ne,I=u(A);try{for(I.s();!(y=I.n()).done;){var U=y.value;_.add(U)}}catch(re){I.e(re)}finally{I.f()}return _}},{key:"copyOf",value:function(A,y){return A.slice(0,y)}}])})(),xr=o((function A(){i(this,A)})),Kr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),I=-1,U=this._shell.getCoordinates(),re=0;re<U.length;re++)_[++I]=U[re];for(var ye=0;ye<this._holes.length;ye++)for(var ke=this._holes[ye].getCoordinates(),Ke=0;Ke<ke.length;Ke++)_[++I]=ke[Ke];return _}},{key:"getArea",value:function(){var _=0;_+=ft.ofRing(this._shell.getCoordinateSequence());for(var I=0;I<this._holes.length;I++)_-=ft.ofRing(this._holes[I].getCoordinateSequence());return _}},{key:"copyInternal",value:function(){for(var _=this._shell.copy(),I=new Array(this._holes.length).fill(null),U=0;U<this._holes.length;U++)I[U]=this._holes[U].copy();return new y(_,I,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),I=this.getEnvelopeInternal(),U=0;U<5;U++){var re=_.getX(U);if(re!==I.getMinX()&&re!==I.getMaxX())return!1;var ye=_.getY(U);if(ye!==I.getMinY()&&ye!==I.getMaxY())return!1}for(var ke=_.getX(0),Ke=_.getY(0),yt=1;yt<=4;yt++){var rr=_.getX(yt),gr=_.getY(yt);if(rr!==ke==(gr!==Ke))return!1;ke=rr,Ke=gr}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_,re=this._shell,ye=U._shell;if(!re.equalsExact(ye,I)||this._holes.length!==U._holes.length)return!1;for(var ke=0;ke<this._holes.length;ke++)if(!this._holes[ke].equalsExact(U._holes[ke],I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var _=0;_<this._holes.length;_++)this._holes[_]=this.normalized(this._holes[_],!1);Mt.sort(this._holes)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];if(I.isEmpty())return null;var re=I.getCoordinateSequence(),ye=Lr.minCoordinateIndex(re,0,re.size()-2);Lr.scroll(re,ye,!0),Gt.isCCW(re)===U&&Lr.reverse(re)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var _=this.getExteriorRing().reverse(),I=new Array(this.getNumInteriorRing()).fill(null),U=0;U<I.length;U++)I[U]=this.getInteriorRingN(U).reverse();return this.getFactory().createPolygon(_,I)}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var _=0;_+=this._shell.getLength();for(var I=0;I<this._holes.length;I++)_+=this._holes[I].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=this._shell.getNumPoints(),I=0;I<this._holes.length;I++)_+=this._holes[I].getNumPoints();return _}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(_,I){var U=_.copy();return this.normalize(U,I),U}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],I=this._shell,U=_._shell;return I.compareToSameClass(U)}if(arguments.length===2){var re=arguments[1],ye=arguments[0],ke=this._shell,Ke=ye._shell,yt=ke.compareToSameClass(Ke,re);if(yt!==0)return yt;for(var rr=this.getNumInteriorRing(),gr=ye.getNumInteriorRing(),Wr=0;Wr<rr&&Wr<gr;){var wn=this.getInteriorRingN(Wr),Un=ye.getInteriorRingN(Wr),Kn=wn.compareToSameClass(Un,re);if(Kn!==0)return Kn;Wr++}return Wr<rr?1:Wr<gr?-1:0}}},{key:"apply",value:function(){if(Pr(arguments[0],St)){var _=arguments[0];this._shell.apply(_);for(var I=0;I<this._holes.length;I++)this._holes[I].apply(_)}else if(Pr(arguments[0],jr)){var U=arguments[0];if(this._shell.apply(U),!U.isDone())for(var re=0;re<this._holes.length&&(this._holes[re].apply(U),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else if(Pr(arguments[0],Zr))arguments[0].filter(this);else if(Pr(arguments[0],B)){var ye=arguments[0];ye.filter(this),this._shell.apply(ye);for(var ke=0;ke<this._holes.length;ke++)this._holes[ke].apply(ye)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var I=0;I<this._holes.length;I++)_[I+1]=this._holes[I];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(_){return this._holes[_]}},{key:"interfaces_",get:function(){return[xr]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var _=arguments[0],I=arguments[1],U=arguments[2];if(Qe.constructor_.call(this,U),_===null&&(_=this.getFactory().createLinearRing()),I===null&&(I=[]),Qe.hasNullElements(I))throw new z("holes must not contain null elements");if(_.isEmpty()&&Qe.hasNonEmptyElements(I))throw new z("shell is empty but holes are not");this._shell=_,this._holes=I}}])})(Qe),Rr=(function(A){function y(){return i(this,y),n(this,y,arguments)}return d(y,A),o(y)})(nr),di=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).array=[],_ instanceof Lt&&I.addAll(_),I}return d(y,A),o(y,[{key:"contains",value:function(_){var I,U=u(this.array);try{for(U.s();!(I=U.n()).done;)if(I.value.compareTo(_)===0)return!0}catch(re){U.e(re)}finally{U.f()}return!1}},{key:"add",value:function(_){if(this.contains(_))return!1;for(var I=0,U=this.array.length;I<U;I++)if(this.array[I].compareTo(_)===1)return!!this.array.splice(I,0,_);return this.array.push(_),!0}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.add(re)}}catch(ye){U.e(ye)}finally{U.f()}return!0}},{key:"remove",value:function(){throw new Ve}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new ti(this.array)}}])})(Rr),ti=(function(){return o((function A(y){i(this,A),this.array=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.array.length)throw new at;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new Ve}}])})(),bi=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){for(var _=new Ze,I=0;I<this._geometries.length;I++)_.expandToInclude(this._geometries[I].getEnvelopeInternal());return _}},{key:"getGeometryN",value:function(_){return this._geometries[_]}},{key:"getCoordinates",value:function(){for(var _=new Array(this.getNumPoints()).fill(null),I=-1,U=0;U<this._geometries.length;U++)for(var re=this._geometries[U].getCoordinates(),ye=0;ye<re.length;ye++)_[++I]=re[ye];return _}},{key:"getArea",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getArea();return _}},{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._geometries.length!==U._geometries.length)return!1;for(var re=0;re<this._geometries.length;re++)if(!this._geometries[re].equalsExact(U._geometries[re],I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();Mt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var _=qt.FALSE,I=0;I<this._geometries.length;I++)_=Math.max(_,this._geometries[I].getBoundaryDimension());return _}},{key:"reverseInternal",value:function(){for(var _=this._geometries.length,I=new Ne(_),U=0;U<_;U++)I.add(this._geometries[U].reverse());return this.getFactory().buildGeometry(I)}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var _=qt.FALSE,I=0;I<this._geometries.length;I++)_=Math.max(_,this._geometries[I].getDimension());return _}},{key:"getLength",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getNumPoints();return _}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],I=new di(Mt.asList(this._geometries)),U=new di(Mt.asList(_._geometries));return this.compare(I,U)}if(arguments.length===2){for(var re=arguments[1],ye=arguments[0],ke=this.getNumGeometries(),Ke=ye.getNumGeometries(),yt=0;yt<ke&&yt<Ke;){var rr=this.getGeometryN(yt),gr=ye.getGeometryN(yt),Wr=rr.compareToSameClass(gr,re);if(Wr!==0)return Wr;yt++}return yt<ke?1:yt<Ke?-1:0}}},{key:"apply",value:function(){if(Pr(arguments[0],St))for(var _=arguments[0],I=0;I<this._geometries.length;I++)this._geometries[I].apply(_);else if(Pr(arguments[0],jr)){var U=arguments[0];if(this._geometries.length===0)return null;for(var re=0;re<this._geometries.length&&(this._geometries[re].apply(U),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else if(Pr(arguments[0],Zr)){var ye=arguments[0];ye.filter(this);for(var ke=0;ke<this._geometries.length;ke++)this._geometries[ke].apply(ye)}else if(Pr(arguments[0],B)){var Ke=arguments[0];Ke.filter(this);for(var yt=0;yt<this._geometries.length;yt++)this._geometries[yt].apply(Ke)}}},{key:"getBoundary",value:function(){return Qe.checkNotGeometryCollection(this),_e.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],I=arguments[1];if(Qe.constructor_.call(this,I),_===null&&(_=[]),Qe.hasNullElements(_))throw new z("geometries must not contain null elements");this._geometries=_}}}}])})(Qe),Ui=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var _=arguments[0];return this._geometries[_].getCoordinate()}return S(y,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return qt.FALSE}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Ce]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bi.constructor_.call(this,_,I)}}])})(bi),Xr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return qt.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||S(y,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Lr.reverse(_),this.getFactory().createLinearRing(_)}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!S(y,"isClosed",this,1).call(this))throw new z("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<y.MINIMUM_VALID_SIZE)throw new z("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];vn.constructor_.call(this,_,I),this.validateConstruction()}}])})(vn);Xr.MINIMUM_VALID_SIZE=4;var _n=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"setOrdinate",value:function(_,I){switch(_){case y.X:this.x=I;break;case y.Y:this.y=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"getZ",value:function(){return Fe.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y}throw new z("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new z("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Fe.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Fe.constructor_.call(this,_.x,_.y)}else if(arguments[0]instanceof Fe){var I=arguments[0];Fe.constructor_.call(this,I.x,I.y)}}else if(arguments.length===2){var U=arguments[0],re=arguments[1];Fe.constructor_.call(this,U,re,Fe.NULL_ORDINATE)}}}])})(Fe);_n.X=0,_n.Y=1,_n.Z=-1,_n.M=-1;var Fn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,I){switch(_){case y.X:this.x=I;break;case y.Y:this.y=I;break;case y.M:this._m=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getZ",value:function(){return Fe.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y;case y.M:return this._m}throw new z("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new z("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Fe.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Fe.constructor_.call(this,_.x,_.y),this._m=_._m}else if(arguments[0]instanceof Fe){var I=arguments[0];Fe.constructor_.call(this,I.x,I.y),this._m=this.getM()}}else if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];Fe.constructor_.call(this,U,re,Fe.NULL_ORDINATE),this._m=ye}}}])})(Fe);Fn.X=0,Fn.Y=1,Fn.Z=-1,Fn.M=2;var na=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,I){switch(_){case Fe.X:this.x=I;break;case Fe.Y:this.y=I;break;case Fe.Z:this.z=I;break;case Fe.M:this._m=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getOrdinate",value:function(_){switch(_){case Fe.X:return this.x;case Fe.Y:return this.y;case Fe.Z:return this.getZ();case Fe.M:return this.getM()}throw new z("Invalid ordinate index: "+_)}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Fe.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Fe.constructor_.call(this,_),this._m=_._m}else if(arguments[0]instanceof Fe){var I=arguments[0];Fe.constructor_.call(this,I),this._m=this.getM()}}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3];Fe.constructor_.call(this,U,re,ye),this._m=ke}}}])})(Fe),Ca=(function(){function A(){i(this,A)}return o(A,null,[{key:"measures",value:function(y){return y instanceof _n?0:y instanceof Fn||y instanceof na?1:0}},{key:"dimension",value:function(y){return y instanceof _n?2:y instanceof Fn?3:y instanceof na?4:3}},{key:"create",value:function(){if(arguments.length===1){var y=arguments[0];return A.create(y,0)}if(arguments.length===2){var _=arguments[0],I=arguments[1];return _===2?new _n:_===3&&I===0?new Fe:_===3&&I===1?new Fn:_===4&&I===1?new na:new Fe}}}])})(),ua=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getCoordinate",value:function(_){return this.get(_)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Pr(arguments[0],Lt)){for(var _=arguments[1],I=!1,U=arguments[0].iterator();U.hasNext();)this.add(U.next(),_),I=!0;return I}return S(y,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var _=S(y,"clone",this,1).call(this),I=0;I<this.size();I++)_.add(I,this.get(I).clone());return _}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(y.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(y.coordArrayType);for(var _=this.size(),I=new Array(_).fill(null),U=0;U<_;U++)I[U]=this.get(_-U-1);return I}}},{key:"add",value:function(){if(arguments.length===1){var _=arguments[0];return S(y,"add",this,1).call(this,_)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var I=arguments[0],U=arguments[1];return this.add(I,U,!0),!0}if(arguments[0]instanceof Fe&&typeof arguments[1]=="boolean"){var re=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(re))return null;S(y,"add",this,1).call(this,re)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ye=arguments[0],ke=arguments[1];return this.add(ye,ke),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Ke=arguments[0],yt=arguments[1];if(arguments[2])for(var rr=0;rr<Ke.length;rr++)this.add(Ke[rr],yt);else for(var gr=Ke.length-1;gr>=0;gr--)this.add(Ke[gr],yt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Fe){var Wr=arguments[0],wn=arguments[1];if(!arguments[2]){var Un=this.size();if(Un>0&&(Wr>0&&this.get(Wr-1).equals2D(wn)||Wr<Un&&this.get(Wr).equals2D(wn)))return null}S(y,"add",this,1).call(this,Wr,wn)}}else if(arguments.length===4){var Kn=arguments[0],jn=arguments[1],Bn=arguments[2],zi=arguments[3],Ri=1;Bn>zi&&(Ri=-1);for(var ho=Bn;ho!==zi;ho+=Ri)this.add(Kn[ho],jn);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var _=this.get(0).copy();this.add(_,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.ensureCapacity(I.length),this.add(I,U)}}}}])})(Ne);ua.coordArrayType=new Array(0).fill(null);var Mn=(function(){function A(){i(this,A)}return o(A,null,[{key:"isRing",value:function(y){return!(y.length<4)&&!!y[0].equals2D(y[y.length-1])}},{key:"ptNotInList",value:function(y,_){for(var I=0;I<y.length;I++){var U=y[I];if(A.indexOf(U,_)<0)return U}return null}},{key:"scroll",value:function(y,_){var I=A.indexOf(_,y);if(I<0)return null;var U=new Array(y.length).fill(null);Bt.arraycopy(y,I,U,0,y.length-I),Bt.arraycopy(y,0,U,y.length-I,I),Bt.arraycopy(U,0,y,0,y.length)}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];if(y===_)return!0;if(y===null||_===null||y.length!==_.length)return!1;for(var I=0;I<y.length;I++)if(!y[I].equals(_[I]))return!1;return!0}if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];if(U===re)return!0;if(U===null||re===null||U.length!==re.length)return!1;for(var ke=0;ke<U.length;ke++)if(ye.compare(U[ke],re[ke])!==0)return!1;return!0}}},{key:"intersection",value:function(y,_){for(var I=new ua,U=0;U<y.length;U++)_.intersects(y[U])&&I.add(y[U],!0);return I.toCoordinateArray()}},{key:"measures",value:function(y){if(y===null||y.length===0)return 0;var _,I=0,U=u(y);try{for(U.s();!(_=U.n()).done;){var re=_.value;I=Math.max(I,Ca.measures(re))}}catch(ye){U.e(ye)}finally{U.f()}return I}},{key:"hasRepeatedPoints",value:function(y){for(var _=1;_<y.length;_++)if(y[_-1].equals(y[_]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(y){return A.hasRepeatedPoints(y)?new ua(y,!1).toCoordinateArray():y}},{key:"reverse",value:function(y){for(var _=y.length-1,I=Math.trunc(_/2),U=0;U<=I;U++){var re=y[U];y[U]=y[_-U],y[_-U]=re}}},{key:"removeNull",value:function(y){for(var _=0,I=0;I<y.length;I++)y[I]!==null&&_++;var U=new Array(_).fill(null);if(_===0)return U;for(var re=0,ye=0;ye<y.length;ye++)y[ye]!==null&&(U[re++]=y[ye]);return U}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var y=arguments[0],_=new Array(y.length).fill(null),I=0;I<y.length;I++)_[I]=y[I].copy();return _}if(arguments.length===5)for(var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3],Ke=arguments[4],yt=0;yt<Ke;yt++)ye[ke+yt]=U[re+yt].copy()}},{key:"isEqualReversed",value:function(y,_){for(var I=0;I<y.length;I++){var U=y[I],re=_[y.length-I-1];if(U.compareTo(re)!==0)return!1}return!0}},{key:"envelope",value:function(y){for(var _=new Ze,I=0;I<y.length;I++)_.expandToInclude(y[I]);return _}},{key:"toCoordinateArray",value:function(y){return y.toArray(A.coordArrayType)}},{key:"dimension",value:function(y){if(y===null||y.length===0)return 3;var _,I=0,U=u(y);try{for(U.s();!(_=U.n()).done;){var re=_.value;I=Math.max(I,Ca.dimension(re))}}catch(ye){U.e(ye)}finally{U.f()}return I}},{key:"atLeastNCoordinatesOrNothing",value:function(y,_){return _.length>=y?_:[]}},{key:"indexOf",value:function(y,_){for(var I=0;I<_.length;I++)if(y.equals(_[I]))return I;return-1}},{key:"increasingDirection",value:function(y){for(var _=0;_<Math.trunc(y.length/2);_++){var I=y.length-1-_,U=y[_].compareTo(y[I]);if(U!==0)return U}return 1}},{key:"compare",value:function(y,_){for(var I=0;I<y.length&&I<_.length;){var U=y[I].compareTo(_[I]);if(U!==0)return U;I++}return I<_.length?-1:I<y.length?1:0}},{key:"minCoordinate",value:function(y){for(var _=null,I=0;I<y.length;I++)(_===null||_.compareTo(y[I])>0)&&(_=y[I]);return _}},{key:"extract",value:function(y,_,I){_=At.clamp(_,0,y.length);var U=(I=At.clamp(I,-1,y.length))-_+1;I<0&&(U=0),_>=y.length&&(U=0),I<_&&(U=0);var re=new Array(U).fill(null);if(U===0)return re;for(var ye=0,ke=_;ke<=I;ke++)re[ye++]=y[ke];return re}}])})(),oo=(function(){return o((function A(){i(this,A)}),[{key:"compare",value:function(A,y){var _=A,I=y;return Mn.compare(_,I)}},{key:"interfaces_",get:function(){return[Ae]}}])})(),_a=(function(){return o((function A(){i(this,A)}),[{key:"compare",value:function(A,y){var _=A,I=y;if(_.length<I.length)return-1;if(_.length>I.length)return 1;if(_.length===0)return 0;var U=Mn.compare(_,I);return Mn.isEqualReversed(_,I)?0:U}},{key:"OLDcompare",value:function(A,y){var _=A,I=y;if(_.length<I.length)return-1;if(_.length>I.length)return 1;if(_.length===0)return 0;for(var U=Mn.increasingDirection(_),re=Mn.increasingDirection(I),ye=U>0?0:_.length-1,ke=re>0?0:_.length-1,Ke=0;Ke<_.length;Ke++){var yt=_[ye].compareTo(I[ke]);if(yt!==0)return yt;ye+=U,ke+=re}return 0}},{key:"interfaces_",get:function(){return[Ae]}}])})();Mn.ForwardComparator=oo,Mn.BidirectionalComparator=_a,Mn.coordArrayType=new Array(0).fill(null);var Hi=(function(){return o((function A(y){i(this,A),this.str=y}),[{key:"append",value:function(A){this.str+=A}},{key:"setCharAt",value:function(A,y){this.str=this.str.substr(0,A)+y+this.str.substr(A+1)}},{key:"toString",value:function(){return this.str}}])})(),Ya=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getM",value:function(y){return this.hasM()?this._coordinates[y].getM():we.NaN}},{key:"setOrdinate",value:function(y,_,I){switch(_){case er.X:this._coordinates[y].x=I;break;case er.Y:this._coordinates[y].y=I;break;default:this._coordinates[y].setOrdinate(_,I)}}},{key:"getZ",value:function(y){return this.hasZ()?this._coordinates[y].getZ():we.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(y,_){switch(_){case er.X:return this._coordinates[y].x;case er.Y:return this._coordinates[y].y;default:return this._coordinates[y].getOrdinate(_)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var y=arguments[0];return this._coordinates[y]}if(arguments.length===2){var _=arguments[0];arguments[1].setCoordinate(this._coordinates[_])}}},{key:"getCoordinateCopy",value:function(y){var _=this.createCoordinate();return _.setCoordinate(this._coordinates[y]),_}},{key:"createCoordinate",value:function(){return Ca.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(y){return this._coordinates[y].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(y){for(var _=0;_<this._coordinates.length;_++)y.expandToInclude(this._coordinates[_]);return y}},{key:"copy",value:function(){for(var y=new Array(this.size()).fill(null),_=0;_<this._coordinates.length;_++){var I=this.createCoordinate();I.setCoordinate(this._coordinates[_]),y[_]=I}return new A(y,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var y=new Hi(17*this._coordinates.length);y.append("("),y.append(this._coordinates[0]);for(var _=1;_<this._coordinates.length;_++)y.append(", "),y.append(this._coordinates[_]);return y.append(")"),y.toString()}return"()"}},{key:"getY",value:function(y){return this._coordinates[y].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[er,G]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];A.constructor_.call(this,y,Mn.dimension(y),Mn.measures(y))}else if(Number.isInteger(arguments[0])){var _=arguments[0];this._coordinates=new Array(_).fill(null);for(var I=0;I<_;I++)this._coordinates[I]=new Fe}else if(Pr(arguments[0],er)){var U=arguments[0];if(U===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=U.getDimension(),this._measures=U.getMeasures(),this._coordinates=new Array(U.size()).fill(null);for(var re=0;re<this._coordinates.length;re++)this._coordinates[re]=U.getCoordinateCopy(re)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ye=arguments[0],ke=arguments[1];A.constructor_.call(this,ye,ke,Mn.measures(ye))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Ke=arguments[0],yt=arguments[1];this._coordinates=new Array(Ke).fill(null),this._dimension=yt;for(var rr=0;rr<Ke;rr++)this._coordinates[rr]=Ca.create(yt)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var gr=arguments[0],Wr=arguments[1],wn=arguments[2];this._dimension=Wr,this._measures=wn,this._coordinates=gr===null?new Array(0).fill(null):gr}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Un=arguments[0],Kn=arguments[1],jn=arguments[2];this._coordinates=new Array(Un).fill(null),this._dimension=Kn,this._measures=jn;for(var Bn=0;Bn<Un;Bn++)this._coordinates[Bn]=this.createCoordinate()}}}}])})(),Xs=(function(){function A(){i(this,A)}return o(A,[{key:"readResolve",value:function(){return A.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new Ya(arguments[0]);if(Pr(arguments[0],er))return new Ya(arguments[0])}else{if(arguments.length===2){var y=arguments[1];return y>3&&(y=3),y<2&&(y=2),new Ya(arguments[0],y)}if(arguments.length===3){var _=arguments[2],I=arguments[1]-_;return _>1&&(_=1),I>3&&(I=3),I<2&&(I=2),new Ya(arguments[0],I+_,_)}}}},{key:"interfaces_",get:function(){return[jt,G]}}],[{key:"instance",value:function(){return A.instanceObject}}])})();Xs.instanceObject=new Xs;var ki=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new Ne,I=0;I<this._geometries.length;I++)for(var U=this._geometries[I].getBoundary(),re=0;re<U.getNumGeometries();re++)_.add(U.getGeometryN(re));var ye=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ye))}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[xr]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bi.constructor_.call(this,_,I)}}])})(bi),bl=(function(){return o((function A(){i(this,A)}),[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])})(),zo=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).map=new Map,_}return d(y,A),o(y,[{key:"get",value:function(_){return this.map.get(_)||null}},{key:"put",value:function(_,I){return this.map.set(_,I),I}},{key:"values",value:function(){for(var _=new Ne,I=this.map.values(),U=I.next();!U.done;)_.add(U.value),U=I.next();return _}},{key:"entrySet",value:function(){var _=new Yt;return this.map.entries().forEach((function(I){return _.add(I)})),_}},{key:"size",value:function(){return this.map.size()}}])})(bl),xi=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this._modelType===_._modelType&&this._scale===_._scale}},{key:"compareTo",value:function(y){var _=y,I=this.getMaximumSignificantDigits(),U=_.getMaximumSignificantDigits();return fr.compare(I,U)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===A.FLOATING||this._modelType===A.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var y="UNKNOWN";return this._modelType===A.FLOATING?y="Floating":this._modelType===A.FLOATING_SINGLE?y="Floating-Single":this._modelType===A.FIXED&&(y="Fixed (Scale="+this.getScale()+")"),y}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var y=arguments[0];return we.isNaN(y)||this._modelType===A.FLOATING_SINGLE?y:this._modelType===A.FIXED?Math.round(y*this._scale)/this._scale:y}if(arguments[0]instanceof Fe){var _=arguments[0];if(this._modelType===A.FLOATING)return null;_.x=this.makePrecise(_.x),_.y=this.makePrecise(_.y)}}},{key:"getMaximumSignificantDigits",value:function(){var y=16;return this._modelType===A.FLOATING?y=16:this._modelType===A.FLOATING_SINGLE?y=6:this._modelType===A.FIXED&&(y=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),y}},{key:"setScale",value:function(y){this._scale=Math.abs(y)}},{key:"interfaces_",get:function(){return[G,q]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=A.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof So){var y=arguments[0];this._modelType=y,y===A.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=A.FIXED,this.setScale(_)}else if(arguments[0]instanceof A){var I=arguments[0];this._modelType=I._modelType,this._scale=I._scale}}}},{key:"mostPrecise",value:function(y,_){return y.compareTo(_)>=0?y:_}}])})(),So=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"readResolve",value:function(){return A.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){this._name=null;var y=arguments[0];this._name=y,A.nameToTypeMap.put(y,this)}}])})();So.nameToTypeMap=new zo,xi.Type=So,xi.FIXED=new So("FIXED"),xi.FLOATING=new So("FLOATING"),xi.FLOATING_SINGLE=new So("FLOATING SINGLE"),xi.maximumPreciseValue=9007199254740992;var Fs=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Qe){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?qt.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return Qe.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new Ve}},{key:"getGeometryType",value:function(){return Qe.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[Ct]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bi.constructor_.call(this,_,I)}}])})(bi),Mo=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"createEmpty",value:function(y){switch(y){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new z("Invalid dimension: "+y)}}},{key:"toGeometry",value:function(y){return y.isNull()?this.createPoint():y.getMinX()===y.getMaxX()&&y.getMinY()===y.getMaxY()?this.createPoint(new Fe(y.getMinX(),y.getMinY())):y.getMinX()===y.getMaxX()||y.getMinY()===y.getMaxY()?this.createLineString([new Fe(y.getMinX(),y.getMinY()),new Fe(y.getMaxX(),y.getMaxY())]):this.createPolygon(this.createLinearRing([new Fe(y.getMinX(),y.getMinY()),new Fe(y.getMinX(),y.getMaxY()),new Fe(y.getMaxX(),y.getMaxY()),new Fe(y.getMaxX(),y.getMinY()),new Fe(y.getMinX(),y.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLineString(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Pr(arguments[0],er))return new vn(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Fs(null,this):arguments.length===1?new Fs(arguments[0],this):void 0}},{key:"buildGeometry",value:function(y){for(var _=null,I=!1,U=!1,re=y.iterator();re.hasNext();){var ye=re.next(),ke=ye.getTypeCode();_===null&&(_=ke),ke!==_&&(I=!0),ye instanceof bi&&(U=!0)}if(_===null)return this.createGeometryCollection();if(I||U)return this.createGeometryCollection(A.toGeometryArray(y));var Ke=y.iterator().next();if(y.size()>1){if(Ke instanceof Kr)return this.createMultiPolygon(A.toPolygonArray(y));if(Ke instanceof vn)return this.createMultiLineString(A.toLineStringArray(y));if(Ke instanceof Ue)return this.createMultiPoint(A.toPointArray(y));_e.shouldNeverReachHere("Unhandled geometry type: "+Ke.getGeometryType())}return Ke}},{key:"createMultiPointFromCoords",value:function(y){return this.createMultiPoint(y!==null?this.getCoordinateSequenceFactory().create(y):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Fe){var y=arguments[0];return this.createPoint(y!==null?this.getCoordinateSequenceFactory().create([y]):null)}if(Pr(arguments[0],er))return new Ue(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Pr(arguments[0],er)){var y=arguments[0];return this.createPolygon(this.createLinearRing(y))}if(arguments[0]instanceof Array){var _=arguments[0];return this.createPolygon(this.createLinearRing(_))}if(arguments[0]instanceof Xr){var I=arguments[0];return this.createPolygon(I,null)}}else if(arguments.length===2)return new Kr(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new bi(null,this):arguments.length===1?new bi(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLinearRing(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Pr(arguments[0],er))return new Xr(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new ki(null,this):arguments.length===1?new ki(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Ui(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Ui(arguments[0],this);if(Pr(arguments[0],er)){var y=arguments[0];if(y===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(y.size()).fill(null),I=0;I<y.size();I++){var U=this.getCoordinateSequenceFactory().create(1,y.getDimension(),y.getMeasures());Lr.copy(y,I,U,0,1),_[I]=this.createPoint(U)}return this.createMultiPoint(_)}}}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)A.constructor_.call(this,new xi,0);else if(arguments.length===1){if(Pr(arguments[0],jt)){var y=arguments[0];A.constructor_.call(this,new xi,0,y)}else if(arguments[0]instanceof xi){var _=arguments[0];A.constructor_.call(this,_,0,A.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];A.constructor_.call(this,I,U,A.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],ke=arguments[2];this._precisionModel=re,this._coordinateSequenceFactory=ke,this._SRID=ye}}},{key:"toMultiPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toGeometryArray",value:function(y){if(y===null)return null;var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Xs.instance()}},{key:"toMultiLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toMultiPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLinearRingArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"createPointFromInternalCoord",value:function(y,_){return _.getPrecisionModel().makePrecise(y),_.getFactory().createPoint(y)}}])})(),so="XY",xl="XYZ",Za="XYM",Lc="XYZM",cc={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Yo="EMPTY",Bs=1,Ka=2,Eo=3,Va=4,wl=5,xu=6;for(var wu in cc)cc[wu].toUpperCase();var K=(function(){return o((function A(y){i(this,A),this.wkt=y,this.index_=-1}),[{key:"isAlpha_",value:function(A){return A>="a"&&A<="z"||A>="A"&&A<="Z"}},{key:"isNumeric_",value:function(A,y){return A>="0"&&A<="9"||A=="."&&!(y!==void 0&&y)}},{key:"isWhiteSpace_",value:function(A){return A==" "||A=="	"||A=="\r"||A==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var A,y=this.nextChar_(),_=this.index_,I=y;if(y=="(")A=Ka;else if(y==",")A=wl;else if(y==")")A=Eo;else if(this.isNumeric_(y)||y=="-")A=Va,I=this.readNumber_();else if(this.isAlpha_(y))A=Bs,I=this.readText_();else{if(this.isWhiteSpace_(y))return this.nextToken();if(y!=="")throw new Error("Unexpected character: "+y);A=xu}return{position:_,value:I,type:A}}},{key:"readNumber_",value:function(){var A,y=this.index_,_=!1,I=!1;do A=="."?_=!0:A!="e"&&A!="E"||(I=!0),A=this.nextChar_();while(this.isNumeric_(A,_)||!I&&(A=="e"||A=="E")||I&&(A=="-"||A=="+"));return parseFloat(this.wkt.substring(y,this.index_--))}},{key:"readText_",value:function(){var A,y=this.index_;do A=this.nextChar_();while(this.isAlpha_(A));return this.wkt.substring(y,this.index_--).toUpperCase()}}])})(),pe=(function(){return o((function A(y,_){i(this,A),this.lexer_=y,this.token_,this.layout_=so,this.factory=_}),[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(A){return this.token_.type==A}},{key:"match",value:function(A){var y=this.isTokenType(A);return y&&this.consume_(),y}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var A=so,y=this.token_;if(this.isTokenType(Bs)){var _=y.value;_==="Z"?A=xl:_==="M"?A=Za:_==="ZM"&&(A=Lc),A!==so&&this.consume_()}return A}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(Ka)){var A=[];do A.push(this.parseGeometry_());while(this.match(wl));if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(Ka)){var A=this.parsePoint_();if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(Ka)){var A=this.parsePointList_();if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(Ka)){var A=this.parseLineStringTextList_();if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var A;if(this.match(Ka)){if(A=this.token_.type==Ka?this.parsePointTextList_():this.parsePointList_(),this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(Ka)){var A=this.parseLineStringTextList_();if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(Ka)){var A=this.parsePolygonTextList_();if(this.match(Eo))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var A=[],y=this.layout_.length,_=0;_<y;++_){var I=this.token_;if(!this.match(Va))break;A.push(I.value)}if(A.length==y)return A;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var A=[this.parsePoint_()];this.match(wl);)A.push(this.parsePoint_());return A}},{key:"parsePointTextList_",value:function(){for(var A=[this.parsePointText_()];this.match(wl);)A.push(this.parsePointText_());return A}},{key:"parseLineStringTextList_",value:function(){for(var A=[this.parseLineStringText_()];this.match(wl);)A.push(this.parseLineStringText_());return A}},{key:"parsePolygonTextList_",value:function(){for(var A=[this.parsePolygonText_()];this.match(wl);)A.push(this.parsePolygonText_());return A}},{key:"isEmptyGeometry_",value:function(){var A=this.isTokenType(Bs)&&this.token_.value==Yo;return A&&this.consume_(),A}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var A=this.factory,y=function(Kn){return a(Fe,E(Kn))},_=function(Kn){var jn=Kn.map((function(Bn){return A.createLinearRing(Bn.map(y))}));return jn.length>1?A.createPolygon(jn[0],jn.slice(1)):A.createPolygon(jn[0])},I=this.token_;if(this.match(Bs)){var U=I.value;if(this.layout_=this.parseGeometryLayout_(),U=="GEOMETRYCOLLECTION"){var re=this.parseGeometryCollectionText_();return A.createGeometryCollection(re)}switch(U){case"POINT":var ye=this.parsePointText_();return ye?A.createPoint(a(Fe,E(ye))):A.createPoint();case"LINESTRING":var ke=this.parseLineStringText_().map(y);return A.createLineString(ke);case"LINEARRING":var Ke=this.parseLineStringText_().map(y);return A.createLinearRing(Ke);case"POLYGON":var yt=this.parsePolygonText_();return yt&&yt.length!==0?_(yt):A.createPolygon();case"MULTIPOINT":var rr=this.parseMultiPointText_();if(!rr||rr.length===0)return A.createMultiPoint();var gr=rr.map(y).map((function(Kn){return A.createPoint(Kn)}));return A.createMultiPoint(gr);case"MULTILINESTRING":var Wr=this.parseMultiLineStringText_().map((function(Kn){return A.createLineString(Kn.map(y))}));return A.createMultiLineString(Wr);case"MULTIPOLYGON":var wn=this.parseMultiPolygonText_();if(!wn||wn.length===0)return A.createMultiPolygon();var Un=wn.map(_);return A.createMultiPolygon(Un);default:throw new Error("Invalid geometry type: "+U)}}throw new Error(this.formatErrorMessage_())}}])})();function Ye(A){if(A.isEmpty())return"";var y=A.getCoordinate(),_=[y.x,y.y];return y.z===void 0||Number.isNaN(y.z)||_.push(y.z),y.m===void 0||Number.isNaN(y.m)||_.push(y.m),_.join(" ")}function Et(A){for(var y=A.getCoordinates().map((function(re){var ye=[re.x,re.y];return re.z===void 0||Number.isNaN(re.z)||ye.push(re.z),re.m===void 0||Number.isNaN(re.m)||ye.push(re.m),ye})),_=[],I=0,U=y.length;I<U;++I)_.push(y[I].join(" "));return _.join(", ")}function Ut(A){var y=[];y.push("("+Et(A.getExteriorRing())+")");for(var _=0,I=A.getNumInteriorRing();_<I;++_)y.push("("+Et(A.getInteriorRingN(_))+")");return y.join(", ")}var Nt={Point:Ye,LineString:Et,LinearRing:Et,Polygon:Ut,MultiPoint:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Ye(A.getGeometryN(_))+")");return y.join(", ")},MultiLineString:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Et(A.getGeometryN(_))+")");return y.join(", ")},MultiPolygon:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Ut(A.getGeometryN(_))+")");return y.join(", ")},GeometryCollection:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push(Qt(A.getGeometryN(_)));return y.join(", ")}};function Qt(A){var y=A.getGeometryType(),_=Nt[y];y=y.toUpperCase();var I=(function(U){var re="";if(U.isEmpty())return re;var ye=U.getCoordinate();return ye.z===void 0||Number.isNaN(ye.z)||(re+="Z"),ye.m===void 0||Number.isNaN(ye.m)||(re+="M"),re})(A);return I.length>0&&(y+=" "+I),A.isEmpty()?y+" "+Yo:y+" ("+_(A)+")"}var Gr=(function(){return o((function A(y){i(this,A),this.geometryFactory=y||new Mo,this.precisionModel=this.geometryFactory.getPrecisionModel()}),[{key:"read",value:function(A){var y=new K(A);return new pe(y,this.geometryFactory).parse()}},{key:"write",value:function(A){return Qt(A)}}])})(),on=(function(){return o((function A(y){i(this,A),this.parser=new Gr(y)}),[{key:"write",value:function(A){return this.parser.write(A)}}],[{key:"toLineString",value:function(A,y){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+A.x+" "+A.y+", "+y.x+" "+y.y+" )"}}])})(),en=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getIndexAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intLineIndex[y][_]}},{key:"getTopologySummary",value:function(){var y=new Hi;return this.isEndPoint()&&y.append(" endpoint"),this._isProper&&y.append(" proper"),this.isCollinear()&&y.append(" collinear"),y.toString()}},{key:"computeIntersection",value:function(y,_,I,U){this._inputLines[0][0]=y,this._inputLines[0][1]=_,this._inputLines[1][0]=I,this._inputLines[1][1]=U,this._result=this.computeIntersect(y,_,I,U)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var y=arguments[0];this.getEdgeDistance(y,0)>this.getEdgeDistance(y,1)?(this._intLineIndex[y][0]=0,this._intLineIndex[y][1]=1):(this._intLineIndex[y][0]=1,this._intLineIndex[y][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var y=arguments[0],_=0;_<this._result;_++)if(!this._intPt[_].equals2D(this._inputLines[y][0])&&!this._intPt[_].equals2D(this._inputLines[y][1]))return!0;return!1}}},{key:"getIntersection",value:function(y){return this._intPt[y]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==A.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(y,_){return A.computeEdgeDistance(this._intPt[_],this._inputLines[y][0],this._inputLines[y][1])}},{key:"isCollinear",value:function(){return this._result===A.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return on.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+on.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(y,_){return this._inputLines[y][_]}},{key:"isIntersection",value:function(y){for(var _=0;_<this._result;_++)if(this._intPt[_].equals2D(y))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[y][_]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Fe,this._intPt[1]=new Fe,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(y,_,I){var U=Math.abs(I.x-_.x),re=Math.abs(I.y-_.y),ye=-1;if(y.equals(_))ye=0;else if(y.equals(I))ye=U>re?U:re;else{var ke=Math.abs(y.x-_.x),Ke=Math.abs(y.y-_.y);(ye=U>re?ke:Ke)!==0||y.equals(_)||(ye=Math.max(ke,Ke))}return _e.isTrue(!(ye===0&&!y.equals(_)),"Bad distance calculation"),ye}},{key:"nonRobustComputeEdgeDistance",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y,ye=Math.sqrt(U*U+re*re);return _e.isTrue(!(ye===0&&!y.equals(_)),"Invalid distance calculation"),ye}}])})();en.DONT_INTERSECT=0,en.DO_INTERSECT=1,en.COLLINEAR=2,en.NO_INTERSECTION=0,en.POINT_INTERSECTION=1,en.COLLINEAR_INTERSECTION=2;var hn=(function(A){function y(){return i(this,y),n(this,y)}return d(y,A),o(y,[{key:"isInSegmentEnvelopes",value:function(_){var I=new Ze(this._inputLines[0][0],this._inputLines[0][1]),U=new Ze(this._inputLines[1][0],this._inputLines[1][1]);return I.contains(_)&&U.contains(_)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return S(y,"computeIntersection",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1],U=arguments[2];if(this._isProper=!1,Ze.intersects(I,U,_)&&Gt.index(I,U,_)===0&&Gt.index(U,I,_)===0)return this._isProper=!0,(_.equals(I)||_.equals(U))&&(this._isProper=!1),this._result=en.POINT_INTERSECTION,null;this._result=en.NO_INTERSECTION}},{key:"intersection",value:function(_,I,U,re){var ye=this.intersectionSafe(_,I,U,re);return this.isInSegmentEnvelopes(ye)||(ye=new Fe(y.nearestEndpoint(_,I,U,re))),this._precisionModel!==null&&this._precisionModel.makePrecise(ye),ye}},{key:"checkDD",value:function(_,I,U,re,ye){var ke=Dr.intersection(_,I,U,re),Ke=this.isInSegmentEnvelopes(ke);Bt.out.println("DD in env = "+Ke+"  --------------------- "+ke),ye.distance(ke)>1e-4&&Bt.out.println("Distance = "+ye.distance(ke))}},{key:"intersectionSafe",value:function(_,I,U,re){var ye=Rt.intersection(_,I,U,re);return ye===null&&(ye=y.nearestEndpoint(_,I,U,re)),ye}},{key:"computeCollinearIntersection",value:function(_,I,U,re){var ye=Ze.intersects(_,I,U),ke=Ze.intersects(_,I,re),Ke=Ze.intersects(U,re,_),yt=Ze.intersects(U,re,I);return ye&&ke?(this._intPt[0]=U,this._intPt[1]=re,en.COLLINEAR_INTERSECTION):Ke&&yt?(this._intPt[0]=_,this._intPt[1]=I,en.COLLINEAR_INTERSECTION):ye&&Ke?(this._intPt[0]=U,this._intPt[1]=_,!U.equals(_)||ke||yt?en.COLLINEAR_INTERSECTION:en.POINT_INTERSECTION):ye&&yt?(this._intPt[0]=U,this._intPt[1]=I,!U.equals(I)||ke||Ke?en.COLLINEAR_INTERSECTION:en.POINT_INTERSECTION):ke&&Ke?(this._intPt[0]=re,this._intPt[1]=_,!re.equals(_)||ye||yt?en.COLLINEAR_INTERSECTION:en.POINT_INTERSECTION):ke&&yt?(this._intPt[0]=re,this._intPt[1]=I,!re.equals(I)||ye||Ke?en.COLLINEAR_INTERSECTION:en.POINT_INTERSECTION):en.NO_INTERSECTION}},{key:"computeIntersect",value:function(_,I,U,re){if(this._isProper=!1,!Ze.intersects(_,I,U,re))return en.NO_INTERSECTION;var ye=Gt.index(_,I,U),ke=Gt.index(_,I,re);if(ye>0&&ke>0||ye<0&&ke<0)return en.NO_INTERSECTION;var Ke=Gt.index(U,re,_),yt=Gt.index(U,re,I);return Ke>0&&yt>0||Ke<0&&yt<0?en.NO_INTERSECTION:ye===0&&ke===0&&Ke===0&&yt===0?this.computeCollinearIntersection(_,I,U,re):(ye===0||ke===0||Ke===0||yt===0?(this._isProper=!1,_.equals2D(U)||_.equals2D(re)?this._intPt[0]=_:I.equals2D(U)||I.equals2D(re)?this._intPt[0]=I:ye===0?this._intPt[0]=new Fe(U):ke===0?this._intPt[0]=new Fe(re):Ke===0?this._intPt[0]=new Fe(_):yt===0&&(this._intPt[0]=new Fe(I))):(this._isProper=!0,this._intPt[0]=this.intersection(_,I,U,re)),en.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(_,I,U,re){var ye=_,ke=Zt.pointToSegment(_,U,re),Ke=Zt.pointToSegment(I,U,re);return Ke<ke&&(ke=Ke,ye=I),(Ke=Zt.pointToSegment(U,_,I))<ke&&(ke=Ke,ye=U),(Ke=Zt.pointToSegment(re,_,I))<ke&&(ke=Ke,ye=re),ye}}])})(en),nn=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"countSegment",value:function(y,_){if(y.x<this._p.x&&_.x<this._p.x)return null;if(this._p.x===_.x&&this._p.y===_.y)return this._isPointOnSegment=!0,null;if(y.y===this._p.y&&_.y===this._p.y){var I=y.x,U=_.x;return I>U&&(I=_.x,U=y.x),this._p.x>=I&&this._p.x<=U&&(this._isPointOnSegment=!0),null}if(y.y>this._p.y&&_.y<=this._p.y||_.y>this._p.y&&y.y<=this._p.y){var re=Gt.index(y,_,this._p);if(re===Gt.COLLINEAR)return this._isPointOnSegment=!0,null;_.y<y.y&&(re=-re),re===Gt.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Ie.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Ie.BOUNDARY:this._crossingCount%2==1?Ie.INTERIOR:Ie.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var y=arguments[0];this._p=y}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Fe&&Pr(arguments[1],er)){for(var y=arguments[1],_=new A(arguments[0]),I=new Fe,U=new Fe,re=1;re<y.size();re++)if(y.getCoordinate(re,I),y.getCoordinate(re-1,U),_.countSegment(I,U),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof Fe&&arguments[1]instanceof Array){for(var ye=arguments[1],ke=new A(arguments[0]),Ke=1;Ke<ye.length;Ke++){var yt=ye[Ke],rr=ye[Ke-1];if(ke.countSegment(yt,rr),ke.isOnSegment())return ke.getLocation()}return ke.getLocation()}}}])})(),Xn=(function(){function A(){i(this,A)}return o(A,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Fe&&Pr(arguments[1],er)){for(var y=arguments[0],_=arguments[1],I=new hn,U=new Fe,re=new Fe,ye=_.size(),ke=1;ke<ye;ke++)if(_.getCoordinate(ke-1,U),_.getCoordinate(ke,re),I.computeIntersection(y,U,re),I.hasIntersection())return!0;return!1}if(arguments[0]instanceof Fe&&arguments[1]instanceof Array){for(var Ke=arguments[0],yt=arguments[1],rr=new hn,gr=1;gr<yt.length;gr++){var Wr=yt[gr-1],wn=yt[gr];if(rr.computeIntersection(Ke,Wr,wn),rr.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(y,_){return nn.locatePointInRing(y,_)}},{key:"isInRing",value:function(y,_){return A.locateInRing(y,_)!==Ie.EXTERIOR}}])})(),En=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"setAllLocations",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]=y}},{key:"isNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]!==Ie.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]===Ie.NONE&&(this.location[_]=y)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(y){if(y.location.length>this.location.length){var _=new Array(3).fill(null);_[mt.ON]=this.location[mt.ON],_[mt.LEFT]=Ie.NONE,_[mt.RIGHT]=Ie.NONE,this.location=_}for(var I=0;I<this.location.length;I++)this.location[I]===Ie.NONE&&I<y.location.length&&(this.location[I]=y.location[I])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var y=this.location[mt.LEFT];this.location[mt.LEFT]=this.location[mt.RIGHT],this.location[mt.RIGHT]=y}},{key:"toString",value:function(){var y=new ar;return this.location.length>1&&y.append(Ie.toLocationSymbol(this.location[mt.LEFT])),y.append(Ie.toLocationSymbol(this.location[mt.ON])),this.location.length>1&&y.append(Ie.toLocationSymbol(this.location[mt.RIGHT])),y.toString()}},{key:"setLocations",value:function(y,_,I){this.location[mt.ON]=y,this.location[mt.LEFT]=_,this.location[mt.RIGHT]=I}},{key:"get",value:function(y){return y<this.location.length?this.location[y]:Ie.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]===Ie.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var y=arguments[0];this.setLocation(mt.ON,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.location[_]=I}}},{key:"init",value:function(y){this.location=new Array(y).fill(null),this.setAllLocations(Ie.NONE)}},{key:"isEqualOnSide",value:function(y,_){return this.location[_]===y.location[_]}},{key:"allPositionsEqual",value:function(y){for(var _=0;_<this.location.length;_++)if(this.location[_]!==y)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];this.init(y.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[mt.ON]=_}else if(arguments[0]instanceof A){var I=arguments[0];if(this.init(I.location.length),I!==null)for(var U=0;U<this.location.length;U++)this.location[U]=I.location[U]}}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],ke=arguments[2];this.init(3),this.location[mt.ON]=re,this.location[mt.LEFT]=ye,this.location[mt.RIGHT]=ke}}}])})(),$n=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getGeometryCount",value:function(){var y=0;return this.elt[0].isNull()||y++,this.elt[1].isNull()||y++,y}},{key:"setAllLocations",value:function(y,_){this.elt[y].setAllLocations(_)}},{key:"isNull",value:function(y){return this.elt[y].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var y=arguments[0];this.setAllLocationsIfNull(0,y),this.setAllLocationsIfNull(1,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.elt[_].setAllLocationsIfNull(I)}}},{key:"isLine",value:function(y){return this.elt[y].isLine()}},{key:"merge",value:function(y){for(var _=0;_<2;_++)this.elt[_]===null&&y.elt[_]!==null?this.elt[_]=new En(y.elt[_]):this.elt[_].merge(y.elt[_])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var y=arguments[0];return this.elt[y].get(mt.ON)}if(arguments.length===2){var _=arguments[0],I=arguments[1];return this.elt[_].get(I)}}},{key:"toString",value:function(){var y=new ar;return this.elt[0]!==null&&(y.append("A:"),y.append(this.elt[0].toString())),this.elt[1]!==null&&(y.append(" B:"),y.append(this.elt[1].toString())),y.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var y=arguments[0];return this.elt[y].isArea()}}},{key:"isAnyNull",value:function(y){return this.elt[y].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.elt[y].setLocation(mt.ON,_)}else if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];this.elt[I].setLocation(U,re)}}},{key:"isEqualOnSide",value:function(y,_){return this.elt[0].isEqualOnSide(y.elt[0],_)&&this.elt[1].isEqualOnSide(y.elt[1],_)}},{key:"allPositionsEqual",value:function(y,_){return this.elt[y].allPositionsEqual(_)}},{key:"toLine",value:function(y){this.elt[y].isArea()&&(this.elt[y]=new En(this.elt[y].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var y=arguments[0];this.elt[0]=new En(y),this.elt[1]=new En(y)}else if(arguments[0]instanceof A){var _=arguments[0];this.elt[0]=new En(_.elt[0]),this.elt[1]=new En(_.elt[1])}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.elt[0]=new En(Ie.NONE),this.elt[1]=new En(Ie.NONE),this.elt[I].setLocation(U)}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],ke=arguments[2];this.elt[0]=new En(re,ye,ke),this.elt[1]=new En(re,ye,ke)}else if(arguments.length===4){var Ke=arguments[0],yt=arguments[1],rr=arguments[2],gr=arguments[3];this.elt[0]=new En(Ie.NONE,Ie.NONE,Ie.NONE),this.elt[1]=new En(Ie.NONE,Ie.NONE,Ie.NONE),this.elt[Ke].setLocations(yt,rr,gr)}}},{key:"toLineLabel",value:function(y){for(var _=new A(Ie.NONE),I=0;I<2;I++)_.setLocation(I,y.getLocation(I));return _}}])})(),Ln=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var A=new Array(this._pts.size()).fill(null),y=0;y<this._pts.size();y++)A[y]=this._pts.get(y);this._ring=this._geometryFactory.createLinearRing(A),this._isHole=Gt.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(A){this._startDe=A;var y=A,_=!0;do{if(y===null)throw new Oe("Found null DirectedEdge");if(y.getEdgeRing()===this)throw new Oe("Directed Edge visited twice during ring-building at "+y.getCoordinate());this._edges.add(y);var I=y.getLabel();_e.isTrue(I.isArea()),this.mergeLabel(I),this.addPoints(y.getEdge(),y.isForward(),_),_=!1,this.setEdgeRing(y,this),y=this.getNext(y)}while(y!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(A){return this._pts.get(A)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var A=this._startDe;do{var y=A.getNode().getEdges().getOutgoingDegree(this);y>this._maxNodeDegree&&(this._maxNodeDegree=y),A=this.getNext(A)}while(A!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(A,y,_){var I=A.getCoordinates();if(y){var U=1;_&&(U=0);for(var re=U;re<I.length;re++)this._pts.add(I[re])}else{var ye=I.length-2;_&&(ye=I.length-1);for(var ke=ye;ke>=0;ke--)this._pts.add(I[ke])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var A=this._startDe;do A.getEdge().setInResult(!0),A=A.getNext();while(A!==this._startDe)}},{key:"containsPoint",value:function(A){var y=this.getLinearRing();if(!y.getEnvelopeInternal().contains(A)||!Xn.isInRing(A,y.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(A))return!1;return!0}},{key:"addHole",value:function(A){this._holes.add(A)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var A=arguments[0];this.mergeLabel(A,0),this.mergeLabel(A,1)}else if(arguments.length===2){var y=arguments[1],_=arguments[0].getLocation(y,mt.RIGHT);if(_===Ie.NONE)return null;if(this._label.getLocation(y)===Ie.NONE)return this._label.setLocation(y,_),null}}},{key:"setShell",value:function(A){this._shell=A,A!==null&&A.addHole(this)}},{key:"toPolygon",value:function(A){for(var y=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)y[_]=this._holes.get(_).getLinearRing();return A.createPolygon(this.getLinearRing(),y)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Ne,this._pts=new Ne,this._label=new $n(Ie.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Ne,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var A=arguments[0],y=arguments[1];this._geometryFactory=y,this.computePoints(A),this.computeRing()}}}}])})(),$r=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"setEdgeRing",value:function(_,I){_.setMinEdgeRing(I)}},{key:"getNext",value:function(_){return _.getNextMin()}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];Ln.constructor_.call(this,_,I)}}])})(Ln),xn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"buildMinimalRings",value:function(){var _=new Ne,I=this._startDe;do{if(I.getMinEdgeRing()===null){var U=new $r(I,this._geometryFactory);_.add(U)}I=I.getNext()}while(I!==this._startDe);return _}},{key:"setEdgeRing",value:function(_,I){_.setEdgeRing(I)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)}},{key:"getNext",value:function(_){return _.getNext()}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];Ln.constructor_.call(this,_,I)}}])})(Ln),si=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"setVisited",value:function(A){this._isVisited=A}},{key:"setInResult",value:function(A){this._isInResult=A}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(A){this._label=A}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(A){this._isCovered=A,this._isCoveredSet=!0}},{key:"updateIM",value:function(A){_e.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(A)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this._label=A}}}}])})(),Li=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"isIncidentEdgeInResult",value:function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(_){_.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(_){}},{key:"computeMergedLocation",value:function(_,I){var U=Ie.NONE;if(U=this._label.getLocation(I),!_.isNull(I)){var re=_.getLocation(I);U!==Ie.BOUNDARY&&(U=re)}return U}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return S(y,"setLabel",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1];this._label===null?this._label=new $n(_,I):this._label.setLocation(_,I)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof y){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof $n)for(var I=arguments[0],U=0;U<2;U++){var re=this.computeMergedLocation(I,U);this._label.getLocation(U)===Ie.NONE&&this._label.setLocation(U,re)}}},{key:"add",value:function(_){this._edges.insert(_),_.setNode(this)}},{key:"setLabelBoundary",value:function(_){if(this._label===null)return null;var I=Ie.NONE;this._label!==null&&(I=this._label.getLocation(_));var U=null;switch(I){case Ie.BOUNDARY:U=Ie.INTERIOR;break;case Ie.INTERIOR:default:U=Ie.BOUNDARY}this._label.setLocation(_,U)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var _=arguments[0],I=arguments[1];this._coord=_,this._edges=I,this._label=new $n(0,Ie.NONE)}}])})(si),wi=(function(A){function y(){return i(this,y),n(this,y,arguments)}return d(y,A),o(y)})(bl);function Vi(A){return A==null?0:A.color}function Bi(A){return A==null?null:A.parent}function Pn(A,y){A!==null&&(A.color=y)}function $a(A){return A==null?null:A.left}function ii(A){return A==null?null:A.right}var Wn=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).root_=null,_.size_=0,_}return d(y,A),o(y,[{key:"get",value:function(_){for(var I=this.root_;I!==null;){var U=_.compareTo(I.key);if(U<0)I=I.left;else{if(!(U>0))return I.value;I=I.right}}return null}},{key:"put",value:function(_,I){if(this.root_===null)return this.root_={key:_,value:I,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var U,re,ye=this.root_;do if(U=ye,(re=_.compareTo(ye.key))<0)ye=ye.left;else{if(!(re>0)){var ke=ye.value;return ye.value=I,ke}ye=ye.right}while(ye!==null);var Ke={key:_,left:null,right:null,value:I,parent:U,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return re<0?U.left=Ke:U.right=Ke,this.fixAfterInsertion(Ke),this.size_++,null}},{key:"fixAfterInsertion",value:function(_){var I;for(_.color=1;_!=null&&_!==this.root_&&_.parent.color===1;)Bi(_)===$a(Bi(Bi(_)))?Vi(I=ii(Bi(Bi(_))))===1?(Pn(Bi(_),0),Pn(I,0),Pn(Bi(Bi(_)),1),_=Bi(Bi(_))):(_===ii(Bi(_))&&(_=Bi(_),this.rotateLeft(_)),Pn(Bi(_),0),Pn(Bi(Bi(_)),1),this.rotateRight(Bi(Bi(_)))):Vi(I=$a(Bi(Bi(_))))===1?(Pn(Bi(_),0),Pn(I,0),Pn(Bi(Bi(_)),1),_=Bi(Bi(_))):(_===$a(Bi(_))&&(_=Bi(_),this.rotateRight(_)),Pn(Bi(_),0),Pn(Bi(Bi(_)),1),this.rotateLeft(Bi(Bi(_))));this.root_.color=0}},{key:"values",value:function(){var _=new Ne,I=this.getFirstEntry();if(I!==null)for(_.add(I.value);(I=y.successor(I))!==null;)_.add(I.value);return _}},{key:"entrySet",value:function(){var _=new Yt,I=this.getFirstEntry();if(I!==null)for(_.add(I);(I=y.successor(I))!==null;)_.add(I);return _}},{key:"rotateLeft",value:function(_){if(_!=null){var I=_.right;_.right=I.left,I.left!=null&&(I.left.parent=_),I.parent=_.parent,_.parent==null?this.root_=I:_.parent.left===_?_.parent.left=I:_.parent.right=I,I.left=_,_.parent=I}}},{key:"rotateRight",value:function(_){if(_!=null){var I=_.left;_.left=I.right,I.right!=null&&(I.right.parent=_),I.parent=_.parent,_.parent==null?this.root_=I:_.parent.right===_?_.parent.right=I:_.parent.left=I,I.right=_,_.parent=I}}},{key:"getFirstEntry",value:function(){var _=this.root_;if(_!=null)for(;_.left!=null;)_=_.left;return _}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(_){for(var I=this.root_;I!==null;){var U=_.compareTo(I.key);if(U<0)I=I.left;else{if(!(U>0))return!0;I=I.right}}return!1}}],[{key:"successor",value:function(_){var I;if(_===null)return null;if(_.right!==null){for(I=_.right;I.left!==null;)I=I.left;return I}I=_.parent;for(var U=_;I!==null&&U===I.right;)U=I,I=I.parent;return I}}])})(wi),ws=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"find",value:function(A){return this.nodeMap.get(A)}},{key:"addNode",value:function(){if(arguments[0]instanceof Fe){var A=arguments[0],y=this.nodeMap.get(A);return y===null&&(y=this.nodeFact.createNode(A),this.nodeMap.put(A,y)),y}if(arguments[0]instanceof Li){var _=arguments[0],I=this.nodeMap.get(_.getCoordinate());return I===null?(this.nodeMap.put(_.getCoordinate(),_),_):(I.mergeLabel(_),I)}}},{key:"print",value:function(A){for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(A){for(var y=new Ne,_=this.iterator();_.hasNext();){var I=_.next();I.getLabel().getLocation(A)===Ie.BOUNDARY&&y.add(I)}return y}},{key:"add",value:function(A){var y=A.getCoordinate();this.addNode(y).add(A)}}],[{key:"constructor_",value:function(){this.nodeMap=new Wn,this.nodeFact=null;var A=arguments[0];this.nodeFact=A}}])})(),In=(function(){function A(){i(this,A)}return o(A,null,[{key:"isNorthern",value:function(y){return y===A.NE||y===A.NW}},{key:"isOpposite",value:function(y,_){return y!==_&&(y-_+4)%4===2}},{key:"commonHalfPlane",value:function(y,_){if(y===_)return y;if((y-_+4)%4===2)return-1;var I=y<_?y:_;return I===0&&(y>_?y:_)===3?3:I}},{key:"isInHalfPlane",value:function(y,_){return _===A.SE?y===A.SE||y===A.SW:y===_||y===_+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new z("Cannot compute the quadrant for point ( "+y+", "+_+" )");return y>=0?_>=0?A.NE:A.SE:_>=0?A.NW:A.SW}if(arguments[0]instanceof Fe&&arguments[1]instanceof Fe){var I=arguments[0],U=arguments[1];if(U.x===I.x&&U.y===I.y)throw new z("Cannot compute the quadrant for two identical points "+I);return U.x>=I.x?U.y>=I.y?A.NE:A.SE:U.y>=I.y?A.NW:A.SW}}}])})();In.NE=0,In.NW=1,In.SW=2,In.SE=3;var Sl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compareDirection",value:function(y){return this._dx===y._dx&&this._dy===y._dy?0:this._quadrant>y._quadrant?1:this._quadrant<y._quadrant?-1:Gt.index(y._p0,y._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(y){this._node=y}},{key:"print",value:function(y){var _=Math.atan2(this._dy,this._dx),I=this.getClass().getName(),U=I.lastIndexOf("."),re=I.substring(U+1);y.print("  "+re+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+_+"   "+this._label)}},{key:"compareTo",value:function(y){var _=y;return this.compareDirection(_)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var y=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),I=_.lastIndexOf(".");return"  "+_.substring(I+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+y+"   "+this._label}},{key:"computeLabel",value:function(y){}},{key:"init",value:function(y,_){this._p0=y,this._p1=_,this._dx=_.x-y.x,this._dy=_.y-y.y,this._quadrant=In.quadrant(this._dx,this._dy),_e.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var y=arguments[0];this._edge=y}else if(arguments.length===3){var _=arguments[0],I=arguments[1],U=arguments[2];A.constructor_.call(this,_,I,U,null)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],ke=arguments[2],Ke=arguments[3];A.constructor_.call(this,re),this.init(ye,ke),this._label=Ke}}}])})(),Na=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(_){return this._depth[_]}},{key:"setVisited",value:function(_){this._isVisited=_}},{key:"computeDirectedLabel",value:function(){this._label=new $n(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(_,I){if(this._depth[_]!==-999&&this._depth[_]!==I)throw new Oe("assigned depths do not match",this.getCoordinate());this._depth[_]=I}},{key:"isInteriorAreaEdge",value:function(){for(var _=!0,I=0;I<2;I++)this._label.isArea(I)&&this._label.getLocation(I,mt.LEFT)===Ie.INTERIOR&&this._label.getLocation(I,mt.RIGHT)===Ie.INTERIOR||(_=!1);return _}},{key:"setNextMin",value:function(_){this._nextMin=_}},{key:"print",value:function(_){S(y,"print",this,1).call(this,_),_.print(" "+this._depth[mt.LEFT]+"/"+this._depth[mt.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")}},{key:"setMinEdgeRing",value:function(_){this._minEdgeRing=_}},{key:"isLineEdge",value:function(){var _=this._label.isLine(0)||this._label.isLine(1),I=!this._label.isArea(0)||this._label.allPositionsEqual(0,Ie.EXTERIOR),U=!this._label.isArea(1)||this._label.allPositionsEqual(1,Ie.EXTERIOR);return _&&I&&U}},{key:"setEdgeRing",value:function(_){this._edgeRing=_}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_}},{key:"setInResult",value:function(_){this._isInResult=_}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)}},{key:"setSym",value:function(_){this._sym=_}},{key:"setVisitedEdge",value:function(_){this.setVisited(_),this._sym.setVisited(_)}},{key:"setEdgeDepths",value:function(_,I){var U=this.getEdge().getDepthDelta();this._isForward||(U=-U);var re=1;_===mt.LEFT&&(re=-1);var ye=mt.opposite(_),ke=I+U*re;this.setDepth(_,I),this.setDepth(ye,ke)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(_){this._next=_}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var _=arguments[0],I=arguments[1];if(Sl.constructor_.call(this,_),this._isForward=I,I)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var U=_.getNumPoints()-1;this.init(_.getCoordinate(U),_.getCoordinate(U-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(_,I){return _===Ie.EXTERIOR&&I===Ie.INTERIOR?1:_===Ie.INTERIOR&&I===Ie.EXTERIOR?-1:0}}])})(Sl),Ys=(function(){return o((function A(){i(this,A)}),[{key:"createNode",value:function(A){return new Li(A,null)}}])})(),lo=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"printEdges",value:function(A){A.println("Edges:");for(var y=0;y<this._edges.size();y++){A.println("edge "+y+":");var _=this._edges.get(y);_.print(A),_.eiList.print(A)}}},{key:"find",value:function(A){return this._nodes.find(A)}},{key:"addNode",value:function(){if(arguments[0]instanceof Li){var A=arguments[0];return this._nodes.addNode(A)}if(arguments[0]instanceof Fe){var y=arguments[0];return this._nodes.addNode(y)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var A=this._nodes.iterator();A.hasNext();)A.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(A){Bt.out.println(A)}},{key:"isBoundaryNode",value:function(A,y){var _=this._nodes.find(y);if(_===null)return!1;var I=_.getLabel();return I!==null&&I.getLocation(A)===Ie.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var A=this._nodes.iterator();A.hasNext();)A.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(A,y,_,I){return!!A.equals(_)&&Gt.index(A,y,I)===Gt.COLLINEAR&&In.quadrant(A,y)===In.quadrant(_,I)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(A){Bt.out.print(A)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(A,y){for(var _=0;_<this._edges.size();_++){var I=this._edges.get(_),U=I.getCoordinates();if(this.matchInSameDirection(A,y,U[0],U[1])||this.matchInSameDirection(A,y,U[U.length-1],U[U.length-2]))return I}return null}},{key:"insertEdge",value:function(A){this._edges.add(A)}},{key:"findEdgeEnd",value:function(A){for(var y=this.getEdgeEnds().iterator();y.hasNext();){var _=y.next();if(_.getEdge()===A)return _}return null}},{key:"addEdges",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next();this._edges.add(_);var I=new Na(_,!0),U=new Na(_,!1);I.setSym(U),U.setSym(I),this.add(I),this.add(U)}}},{key:"add",value:function(A){this._nodes.add(A),this._edgeEndList.add(A)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(A,y){for(var _=0;_<this._edges.size();_++){var I=this._edges.get(_),U=I.getCoordinates();if(A.equals(U[0])&&y.equals(U[1]))return I}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Ne,this._nodes=null,this._edgeEndList=new Ne,arguments.length===0)this._nodes=new ws(new Ys);else if(arguments.length===1){var A=arguments[0];this._nodes=new ws(A)}}},{key:"linkResultDirectedEdges",value:function(A){for(var y=A.iterator();y.hasNext();)y.next().getEdges().linkResultDirectedEdges()}}])})(),iu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"sortShellsAndHoles",value:function(y,_,I){for(var U=y.iterator();U.hasNext();){var re=U.next();re.isHole()?I.add(re):_.add(re)}}},{key:"computePolygons",value:function(y){for(var _=new Ne,I=y.iterator();I.hasNext();){var U=I.next().toPolygon(this._geometryFactory);_.add(U)}return _}},{key:"placeFreeHoles",value:function(y,_){for(var I=_.iterator();I.hasNext();){var U=I.next();if(U.getShell()===null){var re=A.findEdgeRingContaining(U,y);if(re===null)throw new Oe("unable to assign hole to a shell",U.getCoordinate(0));U.setShell(re)}}}},{key:"buildMinimalEdgeRings",value:function(y,_,I){for(var U=new Ne,re=y.iterator();re.hasNext();){var ye=re.next();if(ye.getMaxNodeDegree()>2){ye.linkDirectedEdgesForMinimalEdgeRings();var ke=ye.buildMinimalRings(),Ke=this.findShell(ke);Ke!==null?(this.placePolygonHoles(Ke,ke),_.add(Ke)):I.addAll(ke)}else U.add(ye)}return U}},{key:"buildMaximalEdgeRings",value:function(y){for(var _=new Ne,I=y.iterator();I.hasNext();){var U=I.next();if(U.isInResult()&&U.getLabel().isArea()&&U.getEdgeRing()===null){var re=new xn(U,this._geometryFactory);_.add(re),re.setInResult()}}return _}},{key:"placePolygonHoles",value:function(y,_){for(var I=_.iterator();I.hasNext();){var U=I.next();U.isHole()&&U.setShell(y)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(y){for(var _=0,I=null,U=y.iterator();U.hasNext();){var re=U.next();re.isHole()||(I=re,_++)}return _e.isTrue(_<=1,"found two shells in MinimalEdgeRing list"),I}},{key:"add",value:function(){if(arguments.length===1){var y=arguments[0];this.add(y.getEdgeEnds(),y.getNodes())}else if(arguments.length===2){var _=arguments[0],I=arguments[1];lo.linkResultDirectedEdges(I);var U=this.buildMaximalEdgeRings(_),re=new Ne,ye=this.buildMinimalEdgeRings(U,this._shellList,re);this.sortShellsAndHoles(ye,this._shellList,re),this.placeFreeHoles(this._shellList,re)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Ne;var y=arguments[0];this._geometryFactory=y}},{key:"findEdgeRingContaining",value:function(y,_){for(var I=y.getLinearRing(),U=I.getEnvelopeInternal(),re=I.getCoordinateN(0),ye=null,ke=null,Ke=_.iterator();Ke.hasNext();){var yt=Ke.next(),rr=yt.getLinearRing(),gr=rr.getEnvelopeInternal();if(!gr.equals(U)&&gr.contains(U)){re=Mn.ptNotInList(I.getCoordinates(),rr.getCoordinates());var Wr=!1;Xn.isInRing(re,rr.getCoordinates())&&(Wr=!0),Wr&&(ye===null||ke.contains(gr))&&(ke=(ye=yt).getLinearRing().getEnvelopeInternal())}}return ye}}])})(),os=(function(){return o((function A(){i(this,A)}),[{key:"getBounds",value:function(){}}])})(),ss=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[os,G]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var A=arguments[0],y=arguments[1];this._bounds=A,this._item=y}}])})(),zl=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"poll",value:function(){if(this.isEmpty())return null;var A=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),A}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(A){for(var y=null,_=this._items.get(A);2*A<=this._size&&((y=2*A)!==this._size&&this._items.get(y+1).compareTo(this._items.get(y))<0&&y++,this._items.get(y).compareTo(_)<0);A=y)this._items.set(A,this._items.get(y));this._items.set(A,_)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(A){this._items.add(null),this._size+=1;var y=this._size;for(this._items.set(0,A);A.compareTo(this._items.get(Math.trunc(y/2)))<0;y/=2)this._items.set(y,this._items.get(Math.trunc(y/2)));this._items.set(y,A)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Ne,this._items.add(null)}}])})(),Zs=(function(){return o((function A(){i(this,A)}),[{key:"insert",value:function(A,y){}},{key:"remove",value:function(A,y){}},{key:"query",value:function(){}}])})(),Ja=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(A){_e.isTrue(this._bounds===null),this._childBoundables.add(A)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[os,G]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Ne,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this._level=A}}}}])})(),uo={reverseOrder:function(){return{compare:function(A,y){return y.compareTo(A)}}},min:function(A){return uo.sort(A),A.get(0)},sort:function(A,y){var _=A.toArray();y?Mt.sort(_,y):Mt.sort(_);for(var I=A.iterator(),U=0,re=_.length;U<re;U++)I.next(),I.set(_[U])},singletonList:function(A){var y=new Ne;return y.add(A),y}},sa=(function(){function A(){i(this,A)}return o(A,null,[{key:"maxDistance",value:function(y,_,I,U,re,ye,ke,Ke){var yt=A.distance(y,_,re,ye);return yt=Math.max(yt,A.distance(y,_,ke,Ke)),yt=Math.max(yt,A.distance(I,U,re,ye)),yt=Math.max(yt,A.distance(I,U,ke,Ke))}},{key:"distance",value:function(y,_,I,U){var re=I-y,ye=U-_;return Math.sqrt(re*re+ye*ye)}},{key:"maximumDistance",value:function(y,_){var I=Math.min(y.getMinX(),_.getMinX()),U=Math.min(y.getMinY(),_.getMinY()),re=Math.max(y.getMaxX(),_.getMaxX()),ye=Math.max(y.getMaxY(),_.getMaxY());return A.distance(I,U,re,ye)}},{key:"minMaxDistance",value:function(y,_){var I=y.getMinX(),U=y.getMinY(),re=y.getMaxX(),ye=y.getMaxY(),ke=_.getMinX(),Ke=_.getMinY(),yt=_.getMaxX(),rr=_.getMaxY(),gr=A.maxDistance(I,U,I,ye,ke,Ke,ke,rr);return gr=Math.min(gr,A.maxDistance(I,U,I,ye,ke,Ke,yt,Ke)),gr=Math.min(gr,A.maxDistance(I,U,I,ye,yt,rr,ke,rr)),gr=Math.min(gr,A.maxDistance(I,U,I,ye,yt,rr,yt,Ke)),gr=Math.min(gr,A.maxDistance(I,U,re,U,ke,Ke,ke,rr)),gr=Math.min(gr,A.maxDistance(I,U,re,U,ke,Ke,yt,Ke)),gr=Math.min(gr,A.maxDistance(I,U,re,U,yt,rr,ke,rr)),gr=Math.min(gr,A.maxDistance(I,U,re,U,yt,rr,yt,Ke)),gr=Math.min(gr,A.maxDistance(re,ye,I,ye,ke,Ke,ke,rr)),gr=Math.min(gr,A.maxDistance(re,ye,I,ye,ke,Ke,yt,Ke)),gr=Math.min(gr,A.maxDistance(re,ye,I,ye,yt,rr,ke,rr)),gr=Math.min(gr,A.maxDistance(re,ye,I,ye,yt,rr,yt,Ke)),gr=Math.min(gr,A.maxDistance(re,ye,re,U,ke,Ke,ke,rr)),gr=Math.min(gr,A.maxDistance(re,ye,re,U,ke,Ke,yt,Ke)),gr=Math.min(gr,A.maxDistance(re,ye,re,U,yt,rr,ke,rr)),gr=Math.min(gr,A.maxDistance(re,ye,re,U,yt,rr,yt,Ke))}}])})(),La=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"maximumDistance",value:function(){return sa.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(y,_){var I=A.isComposite(this._boundable1),U=A.isComposite(this._boundable2);if(I&&U)return A.area(this._boundable1)>A.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,y,_),null):(this.expand(this._boundable2,this._boundable1,!0,y,_),null);if(I)return this.expand(this._boundable1,this._boundable2,!1,y,_),null;if(U)return this.expand(this._boundable2,this._boundable1,!0,y,_),null;throw new z("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(A.isComposite(this._boundable1)||A.isComposite(this._boundable2))}},{key:"compareTo",value:function(y){var _=y;return this._distance<_._distance?-1:this._distance>_._distance?1:0}},{key:"expand",value:function(y,_,I,U,re){for(var ye=y.getChildBoundables().iterator();ye.hasNext();){var ke=ye.next(),Ke=null;(Ke=I?new A(_,ke,this._itemDistance):new A(ke,_,this._itemDistance)).getDistance()<re&&U.add(Ke)}}},{key:"getBoundable",value:function(y){return y===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var y=arguments[0],_=arguments[1],I=arguments[2];this._boundable1=y,this._boundable2=_,this._itemDistance=I,this._distance=this.distance()}},{key:"area",value:function(y){return y.getBounds().getArea()}},{key:"isComposite",value:function(y){return y instanceof Ja}}])})(),se=(function(){return o((function A(){i(this,A)}),[{key:"visitItem",value:function(A){}}])})(),qe=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"queryInternal",value:function(){if(Pr(arguments[2],se)&&arguments[0]instanceof Object&&arguments[1]instanceof Ja)for(var y=arguments[0],_=arguments[2],I=arguments[1].getChildBoundables(),U=0;U<I.size();U++){var re=I.get(U);this.getIntersectsOp().intersects(re.getBounds(),y)&&(re instanceof Ja?this.queryInternal(y,re,_):re instanceof ss?_.visitItem(re.getItem()):_e.shouldNeverReachHere())}else if(Pr(arguments[2],mr)&&arguments[0]instanceof Object&&arguments[1]instanceof Ja)for(var ye=arguments[0],ke=arguments[2],Ke=arguments[1].getChildBoundables(),yt=0;yt<Ke.size();yt++){var rr=Ke.get(yt);this.getIntersectsOp().intersects(rr.getBounds(),ye)&&(rr instanceof Ja?this.queryInternal(ye,rr,ke):rr instanceof ss?ke.add(rr.getItem()):_e.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(y){return y.get(y.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var I=_.next();I instanceof Ja?y+=this.size(I):I instanceof ss&&(y+=1)}return y}}},{key:"removeItem",value:function(y,_){for(var I=null,U=y.getChildBoundables().iterator();U.hasNext();){var re=U.next();re instanceof ss&&re.getItem()===_&&(I=re)}return I!==null&&(y.getChildBoundables().remove(I),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var y=this.itemsTree(this._root);return y===null?new Ne:y}if(arguments.length===1){for(var _=arguments[0],I=new Ne,U=_.getChildBoundables().iterator();U.hasNext();){var re=U.next();if(re instanceof Ja){var ye=this.itemsTree(re);ye!==null&&I.add(ye)}else re instanceof ss?I.add(re.getItem()):_e.shouldNeverReachHere()}return I.size()<=0?null:I}}},{key:"insert",value:function(y,_){_e.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ss(y,_))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var y=arguments[0],_=new Ne;return this.boundablesAtLevel(y,this._root,_),_}if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];if(_e.isTrue(I>-2),U.getLevel()===I)return re.add(U),null;for(var ye=U.getChildBoundables().iterator();ye.hasNext();){var ke=ye.next();ke instanceof Ja?this.boundablesAtLevel(I,ke,re):(_e.isTrue(ke instanceof ss),I===-1&&re.add(ke))}return null}}},{key:"query",value:function(){if(arguments.length===1){var y=arguments[0];this.build();var _=new Ne;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.queryInternal(y,this._root,_),_}if(arguments.length===2){var I=arguments[0],U=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),I)&&this.queryInternal(I,this._root,U)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.remove(y,this._root,_)}if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2],ye=this.removeItem(U,re);if(ye)return!0;for(var ke=null,Ke=U.getChildBoundables().iterator();Ke.hasNext();){var yt=Ke.next();if(this.getIntersectsOp().intersects(yt.getBounds(),I)&&yt instanceof Ja&&(ye=this.remove(I,yt,re))){ke=yt;break}}return ke!==null&&ke.getChildBoundables().isEmpty()&&U.getChildBoundables().remove(ke),ye}}},{key:"createHigherLevels",value:function(y,_){_e.isTrue(!y.isEmpty());var I=this.createParentBoundables(y,_+1);return I.size()===1?I.get(0):this.createHigherLevels(I,_+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var I=_.next();if(I instanceof Ja){var U=this.depth(I);U>y&&(y=U)}}return y+1}}},{key:"createParentBoundables",value:function(y,_){_e.isTrue(!y.isEmpty());var I=new Ne;I.add(this.createNode(_));var U=new Ne(y);uo.sort(U,this.getComparator());for(var re=U.iterator();re.hasNext();){var ye=re.next();this.lastNode(I).getChildBoundables().size()===this.getNodeCapacity()&&I.add(this.createNode(_)),this.lastNode(I).addChildBoundable(ye)}return I}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Ne,this._nodeCapacity=null,arguments.length===0)A.constructor_.call(this,A.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var y=arguments[0];_e.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}}},{key:"compareDoubles",value:function(y,_){return y>_?1:y<_?-1:0}}])})();qe.IntersectsOp=function(){},qe.DEFAULT_NODE_CAPACITY=10;var dt=(function(){return o((function A(){i(this,A)}),[{key:"distance",value:function(A,y){}}])})(),Vt=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"createParentBoundablesFromVerticalSlices",value:function(_,I){_e.isTrue(_.length>0);for(var U=new Ne,re=0;re<_.length;re++)U.addAll(this.createParentBoundablesFromVerticalSlice(_[re],I));return U}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var _=arguments[0],I=arguments[1];return this.nearestNeighbourK(_,we.POSITIVE_INFINITY,I)}if(arguments.length===3){var U=arguments[0],re=arguments[2],ye=arguments[1],ke=new zl;ke.add(U);for(var Ke=new zl;!ke.isEmpty()&&ye>=0;){var yt=ke.poll(),rr=yt.getDistance();if(rr>=ye)break;yt.isLeaves()?Ke.size()<re?Ke.add(yt):(Ke.peek().getDistance()>rr&&(Ke.poll(),Ke.add(yt)),ye=Ke.peek().getDistance()):yt.expandToQueue(ke,ye)}return y.getItems(Ke)}}},{key:"createNode",value:function(_){return new sr(_)}},{key:"size",value:function(){return arguments.length===0?S(y,"size",this,1).call(this):S(y,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ze))return S(y,"insert",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1];if(_.isNull())return null;S(y,"insert",this,1).call(this,_,I)}},{key:"getIntersectsOp",value:function(){return y.intersectsOp}},{key:"verticalSlices",value:function(_,I){for(var U=Math.trunc(Math.ceil(_.size()/I)),re=new Array(I).fill(null),ye=_.iterator(),ke=0;ke<I;ke++){re[ke]=new Ne;for(var Ke=0;ye.hasNext()&&Ke<U;){var yt=ye.next();re[ke].add(yt),Ke++}}return re}},{key:"query",value:function(){if(arguments.length===1){var _=arguments[0];return S(y,"query",this,1).call(this,_)}if(arguments.length===2){var I=arguments[0],U=arguments[1];S(y,"query",this,1).call(this,I,U)}}},{key:"getComparator",value:function(){return y.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(_,I){return S(y,"createParentBoundables",this,1).call(this,_,I)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ze){var _=arguments[0],I=arguments[1];return S(y,"remove",this,1).call(this,_,I)}return S(y,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?S(y,"depth",this,1).call(this):S(y,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(_,I){_e.isTrue(!_.isEmpty());var U=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),re=new Ne(_);uo.sort(re,y.xComparator);var ye=this.verticalSlices(re,Math.trunc(Math.ceil(Math.sqrt(U))));return this.createParentBoundablesFromVerticalSlices(ye,I)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Pr(arguments[0],dt)){var _=arguments[0];if(this.isEmpty())return null;var I=new La(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(I)}if(arguments[0]instanceof La){var U=arguments[0],re=we.POSITIVE_INFINITY,ye=null,ke=new zl;for(ke.add(U);!ke.isEmpty()&&re>0;){var Ke=ke.poll(),yt=Ke.getDistance();if(yt>=re)break;Ke.isLeaves()?(re=yt,ye=Ke):Ke.expandToQueue(ke,re)}return ye===null?null:[ye.getBoundable(0).getItem(),ye.getBoundable(1).getItem()]}}else{if(arguments.length===2){var rr=arguments[0],gr=arguments[1];if(this.isEmpty()||rr.isEmpty())return null;var Wr=new La(this.getRoot(),rr.getRoot(),gr);return this.nearestNeighbour(Wr)}if(arguments.length===3){var wn=arguments[2],Un=new ss(arguments[0],arguments[1]),Kn=new La(this.getRoot(),Un,wn);return this.nearestNeighbour(Kn)[0]}if(arguments.length===4){var jn=arguments[2],Bn=arguments[3],zi=new ss(arguments[0],arguments[1]),Ri=new La(this.getRoot(),zi,jn);return this.nearestNeighbourK(Ri,Bn)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var _=arguments[0],I=arguments[1],U=we.POSITIVE_INFINITY,re=new zl;for(re.add(_);!re.isEmpty();){var ye=re.poll(),ke=ye.getDistance();if(ke>I)return!1;if(ye.maximumDistance()<=I)return!0;if(ye.isLeaves()){if((U=ke)<=I)return!0}else ye.expandToQueue(re,U)}return!1}if(arguments.length===3){var Ke=arguments[0],yt=arguments[1],rr=arguments[2],gr=new La(this.getRoot(),Ke.getRoot(),yt);return this.isWithinDistance(gr,rr)}}},{key:"interfaces_",get:function(){return[Zs,G]}}],[{key:"constructor_",value:function(){if(arguments.length===0)y.constructor_.call(this,y.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var _=arguments[0];qe.constructor_.call(this,_)}}},{key:"centreX",value:function(_){return y.avg(_.getMinX(),_.getMaxX())}},{key:"avg",value:function(_,I){return(_+I)/2}},{key:"getItems",value:function(_){for(var I=new Array(_.size()).fill(null),U=0;!_.isEmpty();){var re=_.poll();I[U]=re.getBoundable(0).getItem(),U++}return I}},{key:"centreY",value:function(_){return y.avg(_.getMinY(),_.getMaxY())}}])})(qe),sr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"computeBounds",value:function(){for(var _=null,I=this.getChildBoundables().iterator();I.hasNext();){var U=I.next();_===null?_=new Ze(U.getBounds()):_.expandToInclude(U.getBounds())}return _}}],[{key:"constructor_",value:function(){var _=arguments[0];Ja.constructor_.call(this,_)}}])})(Ja);Vt.STRtreeNode=sr,Vt.xComparator=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[Ae]}},{key:"compare",value:function(A,y){return qe.compareDoubles(Vt.centreX(A.getBounds()),Vt.centreX(y.getBounds()))}}])})()),Vt.yComparator=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[Ae]}},{key:"compare",value:function(A,y){return qe.compareDoubles(Vt.centreY(A.getBounds()),Vt.centreY(y.getBounds()))}}])})()),Vt.intersectsOp=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(A,y){return A.intersects(y)}}])})()),Vt.DEFAULT_NODE_CAPACITY=10;var Vr=(function(){function A(){i(this,A)}return o(A,null,[{key:"relativeSign",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"compare",value:function(y,_,I){if(_.equals2D(I))return 0;var U=A.relativeSign(_.x,I.x),re=A.relativeSign(_.y,I.y);switch(y){case 0:return A.compareValue(U,re);case 1:return A.compareValue(re,U);case 2:return A.compareValue(re,-U);case 3:return A.compareValue(-U,re);case 4:return A.compareValue(-U,-re);case 5:return A.compareValue(-re,-U);case 6:return A.compareValue(-re,U);case 7:return A.compareValue(U,-re)}return _e.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(y,_){return y<0?-1:y>0?1:_<0?-1:_>0?1:0}}])})(),rn=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(A){A.print(this.coord),A.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(A){var y=A;return this.segmentIndex<y.segmentIndex?-1:this.segmentIndex>y.segmentIndex?1:this.coord.equals2D(y.coord)?0:this._isInterior?y._isInterior?Vr.compare(this._segmentOctant,this.coord,y.coord):1:-1}},{key:"isEndPoint",value:function(A){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===A}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this._segString=A,this.coord=new Fe(y),this.segmentIndex=_,this._segmentOctant=I,this._isInterior=!y.equals2D(A.getCoordinate(_))}}])})(),kn=(function(){return o((function A(){i(this,A)}),[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])})(),Vn=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getSplitCoordinates",value:function(){var A=new ua;this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next();this.addEdgeCoordinates(_,I,A),_=I}return A.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var A=new Ne;this.findCollapsesFromInsertedNodes(A),this.findCollapsesFromExistingVertices(A);for(var y=A.iterator();y.hasNext();){var _=y.next().intValue();this.add(this._edge.getCoordinate(_),_)}}},{key:"createSplitEdgePts",value:function(A,y){var _=y.segmentIndex-A.segmentIndex+2;if(_===2)return[new Fe(A.coord),new Fe(y.coord)];var I=this._edge.getCoordinate(y.segmentIndex),U=y.isInterior()||!y.coord.equals2D(I);U||_--;var re=new Array(_).fill(null),ye=0;re[ye++]=new Fe(A.coord);for(var ke=A.segmentIndex+1;ke<=y.segmentIndex;ke++)re[ye++]=this._edge.getCoordinate(ke);return U&&(re[ye]=new Fe(y.coord)),re}},{key:"print",value:function(A){A.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"findCollapsesFromExistingVertices",value:function(A){for(var y=0;y<this._edge.size()-2;y++){var _=this._edge.getCoordinate(y);this._edge.getCoordinate(y+1);var I=this._edge.getCoordinate(y+2);_.equals2D(I)&&A.add(fr.valueOf(y+1))}}},{key:"addEdgeCoordinates",value:function(A,y,_){var I=this.createSplitEdgePts(A,y);_.add(I,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(A){this.addEndpoints(),this.addCollapsedNodes();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next(),U=this.createSplitEdge(_,I);A.add(U),_=I}}},{key:"findCollapseIndex",value:function(A,y,_){if(!A.coord.equals2D(y.coord))return!1;var I=y.segmentIndex-A.segmentIndex;return y.isInterior()||I--,I===1&&(_[0]=A.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(A){for(var y=new Array(1).fill(null),_=this.iterator(),I=_.next();_.hasNext();){var U=_.next();this.findCollapseIndex(I,U,y)&&A.add(fr.valueOf(y[0])),I=U}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var A=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(A),A)}},{key:"createSplitEdge",value:function(A,y){var _=this.createSplitEdgePts(A,y);return new $i(_,this._edge.getData())}},{key:"add",value:function(A,y){var _=new rn(this._edge,A,y,this._edge.getSegmentOctant(y)),I=this._nodeMap.get(_);return I!==null?(_e.isTrue(I.coord.equals2D(A),"Found equal nodes with different coordinates"),I):(this._nodeMap.put(_,_),_)}},{key:"checkSplitEdgesCorrectness",value:function(A){var y=this._edge.getCoordinates(),_=A.get(0).getCoordinate(0);if(!_.equals2D(y[0]))throw new ce("bad split edge start point at "+_);var I=A.get(A.size()-1).getCoordinates(),U=I[I.length-1];if(!U.equals2D(y[y.length-1]))throw new ce("bad split edge end point at "+U)}}],[{key:"constructor_",value:function(){this._nodeMap=new Wn,this._edge=null;var A=arguments[0];this._edge=A}}])})(),ci=(function(){function A(){i(this,A)}return o(A,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new z("Cannot compute the octant for point ( "+y+", "+_+" )");var I=Math.abs(y),U=Math.abs(_);return y>=0?_>=0?I>=U?0:1:I>=U?7:6:_>=0?I>=U?3:2:I>=U?4:5}if(arguments[0]instanceof Fe&&arguments[1]instanceof Fe){var re=arguments[0],ye=arguments[1],ke=ye.x-re.x,Ke=ye.y-re.y;if(ke===0&&Ke===0)throw new z("Cannot compute the octant for two identical points "+re);return A.octant(ke,Ke)}}}])})(),Ti=(function(){return o((function A(){i(this,A)}),[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(A){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(A){}},{key:"getData",value:function(){}}])})(),li=(function(){return o((function A(){i(this,A)}),[{key:"addIntersection",value:function(A,y){}},{key:"interfaces_",get:function(){return[Ti]}}])})(),$i=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(y){return this._pts[y]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(y){return y===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(y),this.getCoordinate(y+1))}},{key:"setData",value:function(y){this._data=y}},{key:"safeOctant",value:function(y,_){return y.equals2D(_)?0:ci.octant(y,_)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.addIntersectionNode(y,_)}else if(arguments.length===4){var I=arguments[1],U=arguments[3],re=new Fe(arguments[0].getIntersection(U));this.addIntersection(re,I)}}},{key:"toString",value:function(){return on.toLineString(new Ya(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(y,_){var I=_,U=I+1;if(U<this._pts.length){var re=this._pts[U];y.equals2D(re)&&(I=U)}return this._nodeList.add(y,I)}},{key:"addIntersections",value:function(y,_,I){for(var U=0;U<y.getIntersectionNum();U++)this.addIntersection(y,_,I,U)}},{key:"interfaces_",get:function(){return[li]}}],[{key:"constructor_",value:function(){this._nodeList=new Vn(this),this._pts=null,this._data=null;var y=arguments[0],_=arguments[1];this._pts=y,this._data=_}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var y=arguments[0],_=new Ne;return A.getNodedSubstrings(y,_),_}if(arguments.length===2)for(var I=arguments[1],U=arguments[0].iterator();U.hasNext();)U.next().getNodeList().addSplitEdges(I)}}])})(),Si=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof A){var y=arguments[0],_=Gt.index(this.p0,this.p1,y.p0),I=Gt.index(this.p0,this.p1,y.p1);return _>=0&&I>=0||_<=0&&I<=0?Math.max(_,I):0}if(arguments[0]instanceof Fe){var U=arguments[0];return Gt.index(this.p0,this.p1,U)}}},{key:"toGeometry",value:function(y){return y.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this.p0.equals(_.p0)&&this.p1.equals(_.p1)}},{key:"intersection",value:function(y){var _=new hn;return _.computeIntersection(this.p0,this.p1,y.p0,y.p1),_.hasIntersection()?_.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Fe){var y=arguments[0];if(y.equals(this.p0)||y.equals(this.p1))return new Fe(y);var _=this.projectionFactor(y),I=new Fe;return I.x=this.p0.x+_*(this.p1.x-this.p0.x),I.y=this.p0.y+_*(this.p1.y-this.p0.y),I}if(arguments[0]instanceof A){var U=arguments[0],re=this.projectionFactor(U.p0),ye=this.projectionFactor(U.p1);if(re>=1&&ye>=1||re<=0&&ye<=0)return null;var ke=this.project(U.p0);re<0&&(ke=this.p0),re>1&&(ke=this.p1);var Ke=this.project(U.p1);return ye<0&&(Ke=this.p0),ye>1&&(Ke=this.p1),new A(ke,Ke)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(y){return y===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(y){return Zt.pointToLinePerpendicular(y,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return A.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(y){if(y.equals(this.p0))return 0;if(y.equals(this.p1))return 1;var _=this.p1.x-this.p0.x,I=this.p1.y-this.p0.y,U=_*_+I*I;return U<=0?we.NaN:((y.x-this.p0.x)*_+(y.y-this.p0.y)*I)/U}},{key:"closestPoints",value:function(y){var _=this.intersection(y);if(_!==null)return[_,_];var I=new Array(2).fill(null),U=we.MAX_VALUE,re=null,ye=this.closestPoint(y.p0);U=ye.distance(y.p0),I[0]=ye,I[1]=y.p0;var ke=this.closestPoint(y.p1);(re=ke.distance(y.p1))<U&&(U=re,I[0]=ke,I[1]=y.p1);var Ke=y.closestPoint(this.p0);(re=Ke.distance(this.p0))<U&&(U=re,I[0]=this.p0,I[1]=Ke);var yt=y.closestPoint(this.p1);return(re=yt.distance(this.p1))<U&&(U=re,I[0]=this.p1,I[1]=yt),I}},{key:"closestPoint",value:function(y){var _=this.projectionFactor(y);return _>0&&_<1?this.project(y):this.p0.distance(y)<this.p1.distance(y)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(y){var _=y,I=this.p0.compareTo(_.p0);return I!==0?I:this.p1.compareTo(_.p1)}},{key:"reverse",value:function(){var y=this.p0;this.p0=this.p1,this.p1=y}},{key:"equalsTopo",value:function(y){return this.p0.equals(y.p0)&&this.p1.equals(y.p1)||this.p0.equals(y.p1)&&this.p1.equals(y.p0)}},{key:"lineIntersection",value:function(y){return Rt.intersection(this.p0,this.p1,y.p0,y.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(y,_){var I=this.p0.x+y*(this.p1.x-this.p0.x),U=this.p0.y+y*(this.p1.y-this.p0.y),re=this.p1.x-this.p0.x,ye=this.p1.y-this.p0.y,ke=Math.sqrt(re*re+ye*ye),Ke=0,yt=0;if(_!==0){if(ke<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");Ke=_*re/ke,yt=_*ye/ke}return new Fe(I-yt,U+Ke)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var y=arguments[0];this.setCoordinates(y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.p0.x=_.x,this.p0.y=_.y,this.p1.x=I.x,this.p1.y=I.y}}},{key:"segmentFraction",value:function(y){var _=this.projectionFactor(y);return _<0?_=0:(_>1||we.isNaN(_))&&(_=1),_}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(y){var _=this.p1.getY()-this.p0.getY(),I=this.p0.getX()-this.p1.getX(),U=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),re=_*_+I*I,ye=_*_-I*I,ke=y.getX(),Ke=y.getY();return new Fe((-ye*ke-2*_*I*Ke-2*_*U)/re,(ye*Ke-2*_*I*ke-2*I*U)/re)}},{key:"distance",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return Zt.segmentToSegment(this.p0,this.p1,y.p0,y.p1)}if(arguments[0]instanceof Fe){var _=arguments[0];return Zt.pointToSegment(_,this.p0,this.p1)}}},{key:"pointAlong",value:function(y){var _=new Fe;return _.x=this.p0.x+y*(this.p1.x-this.p0.x),_.y=this.p0.y+y*(this.p1.y-this.p0.y),_}},{key:"hashCode",value:function(){var y=we.doubleToLongBits(this.p0.x);y^=31*we.doubleToLongBits(this.p0.y);var _=Math.trunc(y)^Math.trunc(y>>32),I=we.doubleToLongBits(this.p1.x);return I^=31*we.doubleToLongBits(this.p1.y),_^(Math.trunc(I)^Math.trunc(I>>32))}},{key:"interfaces_",get:function(){return[q,G]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)A.constructor_.call(this,new Fe,new Fe);else if(arguments.length===1){var y=arguments[0];A.constructor_.call(this,y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.p0=_,this.p1=I}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3];A.constructor_.call(this,new Fe(U,re),new Fe(ye,ke))}}},{key:"midPoint",value:function(y,_){return new Fe((y.x+_.x)/2,(y.y+_.y)/2)}}])})(),Ii=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var A=arguments[1],y=arguments[2],_=arguments[3];arguments[0].getLineSegment(A,this._overlapSeg1),y.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Si,this._overlapSeg2=new Si}}])})(),Aa=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getLineSegment",value:function(A,y){y.p0=this._pts[A],y.p1=this._pts[A+1]}},{key:"computeSelect",value:function(A,y,_,I){var U=this._pts[y],re=this._pts[_];if(_-y==1)return I.select(this,y),null;if(!A.intersects(U,re))return null;var ye=Math.trunc((y+_)/2);y<ye&&this.computeSelect(A,y,ye,I),ye<_&&this.computeSelect(A,ye,_,I)}},{key:"getCoordinates",value:function(){for(var A=new Array(this._end-this._start+1).fill(null),y=0,_=this._start;_<=this._end;_++)A[y++]=this._pts[_];return A}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var A=arguments[0],y=arguments[1];this.computeOverlaps(this._start,this._end,A,A._start,A._end,y)}else if(arguments.length===6){var _=arguments[0],I=arguments[1],U=arguments[2],re=arguments[3],ye=arguments[4],ke=arguments[5];if(I-_==1&&ye-re==1)return ke.overlap(this,_,U,re),null;if(!this.overlaps(_,I,U,re,ye))return null;var Ke=Math.trunc((_+I)/2),yt=Math.trunc((re+ye)/2);_<Ke&&(re<yt&&this.computeOverlaps(_,Ke,U,re,yt,ke),yt<ye&&this.computeOverlaps(_,Ke,U,yt,ye,ke)),Ke<I&&(re<yt&&this.computeOverlaps(Ke,I,U,re,yt,ke),yt<ye&&this.computeOverlaps(Ke,I,U,yt,ye,ke))}}},{key:"setId",value:function(A){this._id=A}},{key:"select",value:function(A,y){this.computeSelect(A,this._start,this._end,y)}},{key:"getEnvelope",value:function(){if(this._env===null){var A=this._pts[this._start],y=this._pts[this._end];this._env=new Ze(A,y)}return this._env}},{key:"overlaps",value:function(A,y,_,I,U){return Ze.intersects(this._pts[A],this._pts[y],_._pts[I],_._pts[U])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this._pts=A,this._start=y,this._end=_,this._context=I}}])})(),ca=(function(){function A(){i(this,A)}return o(A,null,[{key:"findChainEnd",value:function(y,_){for(var I=_;I<y.length-1&&y[I].equals2D(y[I+1]);)I++;if(I>=y.length-1)return y.length-1;for(var U=In.quadrant(y[I],y[I+1]),re=_+1;re<y.length&&!(!y[re-1].equals2D(y[re])&&In.quadrant(y[re-1],y[re])!==U);)re++;return re-1}},{key:"getChains",value:function(){if(arguments.length===1){var y=arguments[0];return A.getChains(y,null)}if(arguments.length===2){var _=arguments[0],I=arguments[1],U=new Ne,re=0;do{var ye=A.findChainEnd(_,re),ke=new Aa(_,re,ye,I);U.add(ke),re=ye}while(re<_.length-1);return U}}}])})(),ba=(function(){return o((function A(){i(this,A)}),[{key:"computeNodes",value:function(A){}},{key:"getNodedSubstrings",value:function(){}}])})(),Ss=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"setSegmentIntersector",value:function(A){this._segInt=A}},{key:"interfaces_",get:function(){return[ba]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this.setSegmentIntersector(A)}}}}])})(),Ks=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return $i.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(_){for(var I=ca.getChains(_.getCoordinates(),_).iterator();I.hasNext();){var U=I.next();U.setId(this._idCounter++),this._index.insert(U.getEnvelope(),U),this._monoChains.add(U)}}},{key:"computeNodes",value:function(_){this._nodedSegStrings=_;for(var I=_.iterator();I.hasNext();)this.add(I.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var _=new Su(this._segInt),I=this._monoChains.iterator();I.hasNext();)for(var U=I.next(),re=this._index.query(U.getEnvelope()).iterator();re.hasNext();){var ye=re.next();if(ye.getId()>U.getId()&&(U.computeOverlaps(ye,_),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Ne,this._index=new Vt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var _=arguments[0];Ss.constructor_.call(this,_)}}}}])})(Ss),Su=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"overlap",value:function(){if(arguments.length!==4)return S(y,"overlap",this,1).apply(this,arguments);var _=arguments[1],I=arguments[2],U=arguments[3],re=arguments[0].getContext(),ye=I.getContext();this._si.processIntersections(re,_,ye,U)}}],[{key:"constructor_",value:function(){this._si=null;var _=arguments[0];this._si=_}}])})(Ii);Ks.SegmentOverlapAction=Su;var Es=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isDeletable",value:function(y,_,I,U){var re=this._inputLine[y],ye=this._inputLine[_],ke=this._inputLine[I];return!!this.isConcave(re,ye,ke)&&!!this.isShallow(re,ye,ke,U)&&this.isShallowSampled(re,ye,y,I,U)}},{key:"deleteShallowConcavities",value:function(){for(var y=1,_=this.findNextNonDeletedIndex(y),I=this.findNextNonDeletedIndex(_),U=!1;I<this._inputLine.length;){var re=!1;this.isDeletable(y,_,I,this._distanceTol)&&(this._isDeleted[_]=A.DELETE,re=!0,U=!0),y=re?I:_,_=this.findNextNonDeletedIndex(y),I=this.findNextNonDeletedIndex(_)}return U}},{key:"isShallowConcavity",value:function(y,_,I,U){return Gt.index(y,_,I)===this._angleOrientation&&Zt.pointToSegment(_,y,I)<U}},{key:"isShallowSampled",value:function(y,_,I,U,re){var ye=Math.trunc((U-I)/A.NUM_PTS_TO_CHECK);ye<=0&&(ye=1);for(var ke=I;ke<U;ke+=ye)if(!this.isShallow(y,_,this._inputLine[ke],re))return!1;return!0}},{key:"isConcave",value:function(y,_,I){var U=Gt.index(y,_,I)===this._angleOrientation;return U}},{key:"simplify",value:function(y){this._distanceTol=Math.abs(y),y<0&&(this._angleOrientation=Gt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var _=!1;do _=this.deleteShallowConcavities();while(_);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(y){for(var _=y+1;_<this._inputLine.length&&this._isDeleted[_]===A.DELETE;)_++;return _}},{key:"isShallow",value:function(y,_,I,U){return Zt.pointToSegment(_,y,I)<U}},{key:"collapseLine",value:function(){for(var y=new ua,_=0;_<this._inputLine.length;_++)this._isDeleted[_]!==A.DELETE&&y.add(this._inputLine[_]);return y.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Gt.COUNTERCLOCKWISE;var y=arguments[0];this._inputLine=y}},{key:"simplify",value:function(y,_){return new A(y).simplify(_)}}])})();Es.INIT=0,Es.DELETE=1,Es.KEEP=1,Es.NUM_PTS_TO_CHECK=10;var Eu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getCoordinates",value:function(){return this._ptList.toArray(A.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"addPt",value:function(y){var _=new Fe(y);if(this._precisionModel.makePrecise(_),this.isRedundant(_))return null;this._ptList.add(_)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(y,_){if(_)for(var I=0;I<y.length;I++)this.addPt(y[I]);else for(var U=y.length-1;U>=0;U--)this.addPt(y[U])}},{key:"isRedundant",value:function(y){if(this._ptList.size()<1)return!1;var _=this._ptList.get(this._ptList.size()-1);return y.distance(_)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Mo().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var y=new Fe(this._ptList.get(0)),_=this._ptList.get(this._ptList.size()-1);if(y.equals(_))return null;this._ptList.add(y)}},{key:"setMinimumVertexDistance",value:function(y){this._minimimVertexDistance=y}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Ne}}])})();Eu.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var xa=(function(){function A(){i(this,A)}return o(A,null,[{key:"toDegrees",value:function(y){return 180*y/Math.PI}},{key:"normalize",value:function(y){for(;y>Math.PI;)y-=A.PI_TIMES_2;for(;y<=-Math.PI;)y+=A.PI_TIMES_2;return y}},{key:"angle",value:function(){if(arguments.length===1){var y=arguments[0];return Math.atan2(y.y,y.x)}if(arguments.length===2){var _=arguments[0],I=arguments[1],U=I.x-_.x,re=I.y-_.y;return Math.atan2(re,U)}}},{key:"isAcute",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y;return U*(I.x-_.x)+re*(I.y-_.y)>0}},{key:"isObtuse",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y;return U*(I.x-_.x)+re*(I.y-_.y)<0}},{key:"interiorAngle",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I);return Math.abs(re-U)}},{key:"normalizePositive",value:function(y){if(y<0){for(;y<0;)y+=A.PI_TIMES_2;y>=A.PI_TIMES_2&&(y=0)}else{for(;y>=A.PI_TIMES_2;)y-=A.PI_TIMES_2;y<0&&(y=0)}return y}},{key:"angleBetween",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I);return A.diff(U,re)}},{key:"diff",value:function(y,_){var I=null;return(I=y<_?_-y:y-_)>Math.PI&&(I=2*Math.PI-I),I}},{key:"toRadians",value:function(y){return y*Math.PI/180}},{key:"getTurn",value:function(y,_){var I=Math.sin(_-y);return I>0?A.COUNTERCLOCKWISE:I<0?A.CLOCKWISE:A.NONE}},{key:"angleBetweenOriented",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I)-U;return re<=-Math.PI?re+A.PI_TIMES_2:re>Math.PI?re-A.PI_TIMES_2:re}}])})();xa.PI_TIMES_2=2*Math.PI,xa.PI_OVER_2=Math.PI/2,xa.PI_OVER_4=Math.PI/4,xa.COUNTERCLOCKWISE=Gt.COUNTERCLOCKWISE,xa.CLOCKWISE=Gt.CLOCKWISE,xa.NONE=Gt.COLLINEAR;var Js=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"addNextSegment",value:function(y,_){if(this._s0=this._s1,this._s1=this._s2,this._s2=y,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var I=Gt.index(this._s0,this._s1,this._s2),U=I===Gt.CLOCKWISE&&this._side===mt.LEFT||I===Gt.COUNTERCLOCKWISE&&this._side===mt.RIGHT;I===0?this.addCollinear(_):U?this.addOutsideTurn(I,_):this.addInsideTurn(I,_)}},{key:"addLineEndCap",value:function(y,_){var I=new Si(y,_),U=new Si;this.computeOffsetSegment(I,mt.LEFT,this._distance,U);var re=new Si;this.computeOffsetSegment(I,mt.RIGHT,this._distance,re);var ye=_.x-y.x,ke=_.y-y.y,Ke=Math.atan2(ke,ye);switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:this._segList.addPt(U.p1),this.addDirectedFillet(_,Ke+Math.PI/2,Ke-Math.PI/2,Gt.CLOCKWISE,this._distance),this._segList.addPt(re.p1);break;case N.CAP_FLAT:this._segList.addPt(U.p1),this._segList.addPt(re.p1);break;case N.CAP_SQUARE:var yt=new Fe;yt.x=Math.abs(this._distance)*Math.cos(Ke),yt.y=Math.abs(this._distance)*Math.sin(Ke);var rr=new Fe(U.p1.x+yt.x,U.p1.y+yt.y),gr=new Fe(re.p1.x+yt.x,re.p1.y+yt.y);this._segList.addPt(rr),this._segList.addPt(gr)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(y,_,I,U){var re=Rt.intersection(_.p0,_.p1,I.p0,I.p1);if(re!==null&&(U<=0?1:re.distance(y)/Math.abs(U))<=this._bufParams.getMitreLimit())return this._segList.addPt(re),null;this.addLimitedMitreJoin(_,I,U,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(y,_){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*A.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===N.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===N.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(_&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,y,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(y){this._segList.addPt(new Fe(y.x+this._distance,y.y+this._distance)),this._segList.addPt(new Fe(y.x+this._distance,y.y-this._distance)),this._segList.addPt(new Fe(y.x-this._distance,y.y-this._distance)),this._segList.addPt(new Fe(y.x-this._distance,y.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(y,_){this._segList.addPts(y,_)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(y,_,I,U,re){var ye=_.x-y.x,ke=_.y-y.y,Ke=Math.atan2(ke,ye),yt=I.x-y.x,rr=I.y-y.y,gr=Math.atan2(rr,yt);U===Gt.CLOCKWISE?Ke<=gr&&(Ke+=2*Math.PI):Ke>=gr&&(Ke-=2*Math.PI),this._segList.addPt(_),this.addDirectedFillet(y,Ke,gr,U,re),this._segList.addPt(I)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(y,_,I){this._s1=y,this._s2=_,this._side=I,this._seg1.setCoordinates(y,_),this.computeOffsetSegment(this._seg1,I,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(y,_,I,U){var re=this._seg0.p1,ye=xa.angle(re,this._seg0.p0),ke=xa.angleBetweenOriented(this._seg0.p0,re,this._seg1.p1)/2,Ke=xa.normalize(ye+ke),yt=xa.normalize(Ke+Math.PI),rr=U*I,gr=I-rr*Math.abs(Math.sin(ke)),Wr=re.x+rr*Math.cos(yt),wn=re.y+rr*Math.sin(yt),Un=new Fe(Wr,wn),Kn=new Si(re,Un),jn=Kn.pointAlongOffset(1,gr),Bn=Kn.pointAlongOffset(1,-gr);this._side===mt.LEFT?(this._segList.addPt(jn),this._segList.addPt(Bn)):(this._segList.addPt(Bn),this._segList.addPt(jn))}},{key:"addDirectedFillet",value:function(y,_,I,U,re){var ye=U===Gt.CLOCKWISE?-1:1,ke=Math.abs(_-I),Ke=Math.trunc(ke/this._filletAngleQuantum+.5);if(Ke<1)return null;for(var yt=ke/Ke,rr=new Fe,gr=0;gr<Ke;gr++){var Wr=_+ye*gr*yt;rr.x=y.x+re*Math.cos(Wr),rr.y=y.y+re*Math.sin(Wr),this._segList.addPt(rr)}}},{key:"computeOffsetSegment",value:function(y,_,I,U){var re=_===mt.LEFT?1:-1,ye=y.p1.x-y.p0.x,ke=y.p1.y-y.p0.y,Ke=Math.sqrt(ye*ye+ke*ke),yt=re*I*ye/Ke,rr=re*I*ke/Ke;U.p0.x=y.p0.x-rr,U.p0.y=y.p0.y+yt,U.p1.x=y.p1.x-rr,U.p1.y=y.p1.y+yt}},{key:"addInsideTurn",value:function(y,_){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*A.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var I=new Fe((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(I);var U=new Fe((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(U)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(y){var _=new Fe(y.x+this._distance,y.y);this._segList.addPt(_),this.addDirectedFillet(y,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(y,_){this._segList.addPt(y.p1),this._segList.addPt(_.p0)}},{key:"init",value:function(y){this._distance=y,this._maxCurveSegmentError=y*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Eu,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(y*A.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(y){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===N.JOIN_BEVEL||this._bufParams.getJoinStyle()===N.JOIN_MITRE?(y&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Gt.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Si,this._seg1=new Si,this._offset0=new Si,this._offset1=new Si,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[0],_=arguments[1],I=arguments[2];this._precisionModel=y,this._bufParams=_,this._li=new hn,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===N.JOIN_ROUND&&(this._closingSegLengthFactor=A.MAX_CLOSING_SEG_LEN_FACTOR),this.init(I)}}])})();Js.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Js.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Js.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Js.MAX_CLOSING_SEG_LEN_FACTOR=80;var au=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getOffsetCurve",value:function(y,_){if(this._distance=_,_===0)return null;var I=_<0,U=Math.abs(_),re=this.getSegGen(U);y.length<=1?this.computePointCurve(y[0],re):this.computeOffsetCurve(y,I,re);var ye=re.getCoordinates();return I&&Mn.reverse(ye),ye}},{key:"computeSingleSidedBufferCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);if(_){I.addSegments(y,!0);var re=Es.simplify(y,-U),ye=re.length-1;I.initSideSegments(re[ye],re[ye-1],mt.LEFT),I.addFirstSegment();for(var ke=ye-2;ke>=0;ke--)I.addNextSegment(re[ke],!0)}else{I.addSegments(y,!1);var Ke=Es.simplify(y,U),yt=Ke.length-1;I.initSideSegments(Ke[0],Ke[1],mt.LEFT),I.addFirstSegment();for(var rr=2;rr<=yt;rr++)I.addNextSegment(Ke[rr],!0)}I.addLastSegment(),I.closeRing()}},{key:"computeRingBufferCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);_===mt.RIGHT&&(U=-U);var re=Es.simplify(y,U),ye=re.length-1;I.initSideSegments(re[ye-1],re[0],_);for(var ke=1;ke<=ye;ke++){var Ke=ke!==1;I.addNextSegment(re[ke],Ke)}I.closeRing()}},{key:"computeLineBufferCurve",value:function(y,_){var I=this.simplifyTolerance(this._distance),U=Es.simplify(y,I),re=U.length-1;_.initSideSegments(U[0],U[1],mt.LEFT);for(var ye=2;ye<=re;ye++)_.addNextSegment(U[ye],!0);_.addLastSegment(),_.addLineEndCap(U[re-1],U[re]);var ke=Es.simplify(y,-I),Ke=ke.length-1;_.initSideSegments(ke[Ke],ke[Ke-1],mt.LEFT);for(var yt=Ke-2;yt>=0;yt--)_.addNextSegment(ke[yt],!0);_.addLastSegment(),_.addLineEndCap(ke[1],ke[0]),_.closeRing()}},{key:"computePointCurve",value:function(y,_){switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:_.createCircle(y);break;case N.CAP_SQUARE:_.createSquare(y)}}},{key:"getLineCurve",value:function(y,_){if(this._distance=_,this.isLineOffsetEmpty(_))return null;var I=Math.abs(_),U=this.getSegGen(I);if(y.length<=1)this.computePointCurve(y[0],U);else if(this._bufParams.isSingleSided()){var re=_<0;this.computeSingleSidedBufferCurve(y,re,U)}else this.computeLineBufferCurve(y,U);return U.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(y){return y*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(y,_,I){if(this._distance=I,y.length<=2)return this.getLineCurve(y,I);if(I===0)return A.copyCoordinates(y);var U=this.getSegGen(I);return this.computeRingBufferCurve(y,_,U),U.getCoordinates()}},{key:"computeOffsetCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);if(_){var re=Es.simplify(y,-U),ye=re.length-1;I.initSideSegments(re[ye],re[ye-1],mt.LEFT),I.addFirstSegment();for(var ke=ye-2;ke>=0;ke--)I.addNextSegment(re[ke],!0)}else{var Ke=Es.simplify(y,U),yt=Ke.length-1;I.initSideSegments(Ke[0],Ke[1],mt.LEFT),I.addFirstSegment();for(var rr=2;rr<=yt;rr++)I.addNextSegment(Ke[rr],!0)}I.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(y){return y===0||y<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(y){return new Js(this._precisionModel,this._bufParams,y)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var y=arguments[0],_=arguments[1];this._precisionModel=y,this._bufParams=_}},{key:"copyCoordinates",value:function(y){for(var _=new Array(y.length).fill(null),I=0;I<_.length;I++)_[I]=new Fe(y[I]);return _}}])})(),Ts=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var A=arguments[0],y=new Ne,_=this._subgraphs.iterator();_.hasNext();){var I=_.next(),U=I.getEnvelope();A.y<U.getMinY()||A.y>U.getMaxY()||this.findStabbedSegments(A,I.getDirectedEdges(),y)}return y}if(arguments.length===3){if(Pr(arguments[2],mr)&&arguments[0]instanceof Fe&&arguments[1]instanceof Na){for(var re=arguments[0],ye=arguments[1],ke=arguments[2],Ke=ye.getEdge().getCoordinates(),yt=0;yt<Ke.length-1;yt++)if(this._seg.p0=Ke[yt],this._seg.p1=Ke[yt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<re.x||this._seg.isHorizontal()||re.y<this._seg.p0.y||re.y>this._seg.p1.y||Gt.index(this._seg.p0,this._seg.p1,re)===Gt.RIGHT)){var rr=ye.getDepth(mt.LEFT);this._seg.p0.equals(Ke[yt])||(rr=ye.getDepth(mt.RIGHT));var gr=new Da(this._seg,rr);ke.add(gr)}}else if(Pr(arguments[2],mr)&&arguments[0]instanceof Fe&&Pr(arguments[1],mr))for(var Wr=arguments[0],wn=arguments[2],Un=arguments[1].iterator();Un.hasNext();){var Kn=Un.next();Kn.isForward()&&this.findStabbedSegments(Wr,Kn,wn)}}}},{key:"getDepth",value:function(A){var y=this.findStabbedSegments(A);return y.size()===0?0:uo.min(y)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Si;var A=arguments[0];this._subgraphs=A}}])})(),Da=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"compareTo",value:function(A){var y=A;if(this._upwardSeg.minX()>=y._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=y._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(y._upwardSeg);return _!==0||(_=-1*y._upwardSeg.orientationIndex(this._upwardSeg))!==0?_:this._upwardSeg.compareTo(y._upwardSeg)}},{key:"compareX",value:function(A,y){var _=A.p0.compareTo(y.p0);return _!==0?_:A.p1.compareTo(y.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var A=arguments[0],y=arguments[1];this._upwardSeg=new Si(A),this._leftDepth=y}}])})();Ts.DepthSegment=Da;var To=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,null,[{key:"constructor_",value:function(){M.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])})(M),ha=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getY",value:function(){var y=this.y/this.w;if(we.isNaN(y)||we.isInfinite(y))throw new To;return y}},{key:"getX",value:function(){var y=this.x/this.w;if(we.isNaN(y)||we.isInfinite(y))throw new To;return y}},{key:"getCoordinate",value:function(){var y=new Fe;return y.x=this.getX(),y.y=this.getY(),y}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var y=arguments[0];this.x=y.x,this.y=y.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],I=arguments[1];this.x=_,this.y=I,this.w=1}else if(arguments[0]instanceof A&&arguments[1]instanceof A){var U=arguments[0],re=arguments[1];this.x=U.y*re.w-re.y*U.w,this.y=re.x*U.w-U.x*re.w,this.w=U.x*re.y-re.x*U.y}else if(arguments[0]instanceof Fe&&arguments[1]instanceof Fe){var ye=arguments[0],ke=arguments[1];this.x=ye.y-ke.y,this.y=ke.x-ye.x,this.w=ye.x*ke.y-ke.x*ye.y}}else if(arguments.length===3){var Ke=arguments[0],yt=arguments[1],rr=arguments[2];this.x=Ke,this.y=yt,this.w=rr}else if(arguments.length===4){var gr=arguments[0],Wr=arguments[1],wn=arguments[2],Un=arguments[3],Kn=gr.y-Wr.y,jn=Wr.x-gr.x,Bn=gr.x*Wr.y-Wr.x*gr.y,zi=wn.y-Un.y,Ri=Un.x-wn.x,ho=wn.x*Un.y-Un.x*wn.y;this.x=jn*ho-Ri*Bn,this.y=zi*Bn-Kn*ho,this.w=Kn*Ri-zi*jn}}}])})(),Qs=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"area",value:function(){return A.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return A.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(y){if(y===null)throw new z("Supplied point is null.");return A.interpolateZ(y,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return A.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return A.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return A.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return A.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return A.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return A.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var y=arguments[0],_=arguments[1],I=arguments[2];this.p0=y,this.p1=_,this.p2=I}},{key:"area",value:function(y,_,I){return Math.abs(((I.x-y.x)*(_.y-y.y)-(_.x-y.x)*(I.y-y.y))/2)}},{key:"signedArea",value:function(y,_,I){return((I.x-y.x)*(_.y-y.y)-(_.x-y.x)*(I.y-y.y))/2}},{key:"det",value:function(y,_,I,U){return y*U-_*I}},{key:"interpolateZ",value:function(y,_,I,U){var re=_.x,ye=_.y,ke=I.x-re,Ke=U.x-re,yt=I.y-ye,rr=U.y-ye,gr=ke*rr-Ke*yt,Wr=y.x-re,wn=y.y-ye,Un=(rr*Wr-Ke*wn)/gr,Kn=(-yt*Wr+ke*wn)/gr;return _.getZ()+Un*(I.getZ()-_.getZ())+Kn*(U.getZ()-_.getZ())}},{key:"longestSideLength",value:function(y,_,I){var U=y.distance(_),re=_.distance(I),ye=I.distance(y),ke=U;return re>ke&&(ke=re),ye>ke&&(ke=ye),ke}},{key:"circumcentreDD",value:function(y,_,I){var U=or.valueOf(y.x).subtract(I.x),re=or.valueOf(y.y).subtract(I.y),ye=or.valueOf(_.x).subtract(I.x),ke=or.valueOf(_.y).subtract(I.y),Ke=or.determinant(U,re,ye,ke).multiply(2),yt=U.sqr().add(re.sqr()),rr=ye.sqr().add(ke.sqr()),gr=or.determinant(re,yt,ke,rr),Wr=or.determinant(U,yt,ye,rr),wn=or.valueOf(I.x).subtract(gr.divide(Ke)).doubleValue(),Un=or.valueOf(I.y).add(Wr.divide(Ke)).doubleValue();return new Fe(wn,Un)}},{key:"isAcute",value:function(y,_,I){return!!xa.isAcute(y,_,I)&&!!xa.isAcute(_,I,y)&&!!xa.isAcute(I,y,_)}},{key:"circumcentre",value:function(y,_,I){var U=I.x,re=I.y,ye=y.x-U,ke=y.y-re,Ke=_.x-U,yt=_.y-re,rr=2*A.det(ye,ke,Ke,yt),gr=A.det(ke,ye*ye+ke*ke,yt,Ke*Ke+yt*yt),Wr=A.det(ye,ye*ye+ke*ke,Ke,Ke*Ke+yt*yt);return new Fe(U-gr/rr,re+Wr/rr)}},{key:"perpendicularBisector",value:function(y,_){var I=_.x-y.x,U=_.y-y.y,re=new ha(y.x+I/2,y.y+U/2,1),ye=new ha(y.x-U+I/2,y.y+I+U/2,1);return new ha(re,ye)}},{key:"angleBisector",value:function(y,_,I){var U=_.distance(y),re=U/(U+_.distance(I)),ye=I.x-y.x,ke=I.y-y.y;return new Fe(y.x+re*ye,y.y+re*ke)}},{key:"area3D",value:function(y,_,I){var U=_.x-y.x,re=_.y-y.y,ye=_.getZ()-y.getZ(),ke=I.x-y.x,Ke=I.y-y.y,yt=I.getZ()-y.getZ(),rr=re*yt-ye*Ke,gr=ye*ke-U*yt,Wr=U*Ke-re*ke,wn=rr*rr+gr*gr+Wr*Wr,Un=Math.sqrt(wn)/2;return Un}},{key:"centroid",value:function(y,_,I){var U=(y.x+_.x+I.x)/3,re=(y.y+_.y+I.y)/3;return new Fe(U,re)}},{key:"inCentre",value:function(y,_,I){var U=_.distance(I),re=y.distance(I),ye=y.distance(_),ke=U+re+ye,Ke=(U*y.x+re*_.x+ye*I.x)/ke,yt=(U*y.y+re*_.y+ye*I.y)/ke;return new Fe(Ke,yt)}}])})(),jl=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"addRingSide",value:function(A,y,_,I,U){if(y===0&&A.length<Xr.MINIMUM_VALID_SIZE)return null;var re=I,ye=U;A.length>=Xr.MINIMUM_VALID_SIZE&&Gt.isCCW(A)&&(re=U,ye=I,_=mt.opposite(_));var ke=this._curveBuilder.getRingCurve(A,_,y);this.addCurve(ke,re,ye)}},{key:"addRingBothSides",value:function(A,y){this.addRingSide(A,y,mt.LEFT,Ie.EXTERIOR,Ie.INTERIOR),this.addRingSide(A,y,mt.RIGHT,Ie.INTERIOR,Ie.EXTERIOR)}},{key:"addPoint",value:function(A){if(this._distance<=0)return null;var y=A.getCoordinates(),_=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Ie.EXTERIOR,Ie.INTERIOR)}},{key:"addPolygon",value:function(A){var y=this._distance,_=mt.LEFT;this._distance<0&&(y=-this._distance,_=mt.RIGHT);var I=A.getExteriorRing(),U=Mn.removeRepeatedPoints(I.getCoordinates());if(this._distance<0&&this.isErodedCompletely(I,this._distance)||this._distance<=0&&U.length<3)return null;this.addRingSide(U,y,_,Ie.EXTERIOR,Ie.INTERIOR);for(var re=0;re<A.getNumInteriorRing();re++){var ye=A.getInteriorRingN(re),ke=Mn.removeRepeatedPoints(ye.getCoordinates());this._distance>0&&this.isErodedCompletely(ye,-this._distance)||this.addRingSide(ke,y,mt.opposite(_),Ie.INTERIOR,Ie.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(A,y){var _=new Qs(A[0],A[1],A[2]),I=_.inCentre();return Zt.pointToSegment(I,_.p0,_.p1)<Math.abs(y)}},{key:"addLineString",value:function(A){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var y=Mn.removeRepeatedPoints(A.getCoordinates());if(Mn.isRing(y)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(y,this._distance);else{var _=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Ie.EXTERIOR,Ie.INTERIOR)}}},{key:"addCurve",value:function(A,y,_){if(A===null||A.length<2)return null;var I=new $i(A,new $n(0,Ie.BOUNDARY,y,_));this._curveList.add(I)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(A){if(A.isEmpty())return null;if(A instanceof Kr)this.addPolygon(A);else if(A instanceof vn)this.addLineString(A);else if(A instanceof Ue)this.addPoint(A);else if(A instanceof Ui)this.addCollection(A);else if(A instanceof Fs)this.addCollection(A);else if(A instanceof ki)this.addCollection(A);else{if(!(A instanceof bi))throw new Ve(A.getGeometryType());this.addCollection(A)}}},{key:"isErodedCompletely",value:function(A,y){var _=A.getCoordinates();if(_.length<4)return y<0;if(_.length===4)return this.isTriangleErodedCompletely(_,y);var I=A.getEnvelopeInternal(),U=Math.min(I.getHeight(),I.getWidth());return y<0&&2*Math.abs(y)>U}},{key:"addCollection",value:function(A){for(var y=0;y<A.getNumGeometries();y++){var _=A.getGeometryN(y);this.add(_)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Ne;var A=arguments[0],y=arguments[1],_=arguments[2];this._inputGeom=A,this._distance=y,this._curveBuilder=_}}])})(),wa=(function(){return o((function A(){i(this,A)}),[{key:"locate",value:function(A){}}])})(),Tu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,A.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new at;var y=this._parent.getGeometryN(this._index++);return y instanceof bi?(this._subcollectionIterator=new A(y),this._subcollectionIterator.next()):y}},{key:"remove",value:function(){throw new Ve(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[kn]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var y=arguments[0];this._parent=y,this._atStart=!0,this._index=0,this._max=y.getNumGeometries()}},{key:"isAtomic",value:function(y){return!(y instanceof bi)}}])})(),Ul=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"locate",value:function(y){return A.locate(y,this._geom)}},{key:"interfaces_",get:function(){return[wa]}}],[{key:"constructor_",value:function(){this._geom=null;var y=arguments[0];this._geom=y}},{key:"locatePointInPolygon",value:function(y,_){if(_.isEmpty())return Ie.EXTERIOR;var I=_.getExteriorRing(),U=A.locatePointInRing(y,I);if(U!==Ie.INTERIOR)return U;for(var re=0;re<_.getNumInteriorRing();re++){var ye=_.getInteriorRingN(re),ke=A.locatePointInRing(y,ye);if(ke===Ie.BOUNDARY)return Ie.BOUNDARY;if(ke===Ie.INTERIOR)return Ie.EXTERIOR}return Ie.INTERIOR}},{key:"locatePointInRing",value:function(y,_){return _.getEnvelopeInternal().intersects(y)?Xn.locateInRing(y,_.getCoordinates()):Ie.EXTERIOR}},{key:"containsPointInPolygon",value:function(y,_){return Ie.EXTERIOR!==A.locatePointInPolygon(y,_)}},{key:"locateInGeometry",value:function(y,_){if(_ instanceof Kr)return A.locatePointInPolygon(y,_);if(_ instanceof bi)for(var I=new Tu(_);I.hasNext();){var U=I.next();if(U!==_){var re=A.locateInGeometry(y,U);if(re!==Ie.EXTERIOR)return re}}return Ie.EXTERIOR}},{key:"isContained",value:function(y,_){return Ie.EXTERIOR!==A.locate(y,_)}},{key:"locate",value:function(y,_){return _.isEmpty()?Ie.EXTERIOR:_.getEnvelopeInternal().intersects(y)?A.locateInGeometry(y,_):Ie.EXTERIOR}}])})(),el=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getNextCW",value:function(A){this.getEdges();var y=this._edgeList.indexOf(A),_=y-1;return y===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)}},{key:"propagateSideLabels",value:function(A){for(var y=Ie.NONE,_=this.iterator();_.hasNext();){var I=_.next().getLabel();I.isArea(A)&&I.getLocation(A,mt.LEFT)!==Ie.NONE&&(y=I.getLocation(A,mt.LEFT))}if(y===Ie.NONE)return null;for(var U=y,re=this.iterator();re.hasNext();){var ye=re.next(),ke=ye.getLabel();if(ke.getLocation(A,mt.ON)===Ie.NONE&&ke.setLocation(A,mt.ON,U),ke.isArea(A)){var Ke=ke.getLocation(A,mt.LEFT),yt=ke.getLocation(A,mt.RIGHT);if(yt!==Ie.NONE){if(yt!==U)throw new Oe("side location conflict",ye.getCoordinate());Ke===Ie.NONE&&_e.shouldNeverReachHere("found single null side (at "+ye.getCoordinate()+")"),U=Ke}else _e.isTrue(ke.getLocation(A,mt.LEFT)===Ie.NONE,"found single null side"),ke.setLocation(A,mt.RIGHT,U),ke.setLocation(A,mt.LEFT,U)}}}},{key:"getCoordinate",value:function(){var A=this.iterator();return A.hasNext()?A.next().getCoordinate():null}},{key:"print",value:function(A){Bt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"isAreaLabelsConsistent",value:function(A){return this.computeEdgeEndLabels(A.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(A){var y=this.getEdges();if(y.size()<=0)return!0;var _=y.size()-1,I=y.get(_).getLabel().getLocation(A,mt.LEFT);_e.isTrue(I!==Ie.NONE,"Found unlabelled area edge");for(var U=I,re=this.iterator();re.hasNext();){var ye=re.next().getLabel();_e.isTrue(ye.isArea(A),"Found non-area edge");var ke=ye.getLocation(A,mt.LEFT),Ke=ye.getLocation(A,mt.RIGHT);if(ke===Ke||Ke!==U)return!1;U=ke}return!0}},{key:"findIndex",value:function(A){this.iterator();for(var y=0;y<this._edgeList.size();y++)if(this._edgeList.get(y)===A)return y;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Ne(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(A,y,_){return this._ptInAreaLocation[A]===Ie.NONE&&(this._ptInAreaLocation[A]=Ul.locate(y,_[A].getGeometry())),this._ptInAreaLocation[A]}},{key:"toString",value:function(){var A=new ar;A.append("EdgeEndStar:   "+this.getCoordinate()),A.append(`
`);for(var y=this.iterator();y.hasNext();){var _=y.next();A.append(_),A.append(`
`)}return A.toString()}},{key:"computeEdgeEndLabels",value:function(A){for(var y=this.iterator();y.hasNext();)y.next().computeLabel(A)}},{key:"computeLabelling",value:function(A){this.computeEdgeEndLabels(A[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var y=[!1,!1],_=this.iterator();_.hasNext();)for(var I=_.next().getLabel(),U=0;U<2;U++)I.isLine(U)&&I.getLocation(U)===Ie.BOUNDARY&&(y[U]=!0);for(var re=this.iterator();re.hasNext();)for(var ye=re.next(),ke=ye.getLabel(),Ke=0;Ke<2;Ke++)if(ke.isAnyNull(Ke)){var yt=Ie.NONE;if(y[Ke])yt=Ie.EXTERIOR;else{var rr=ye.getCoordinate();yt=this.getLocation(Ke,rr,A)}ke.setAllLocationsIfNull(Ke,yt)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(A,y){this._edgeMap.put(A,y),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Wn,this._edgeList=null,this._ptInAreaLocation=[Ie.NONE,Ie.NONE]}}])})(),Qa=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var _=null,I=null,U=this._SCANNING_FOR_INCOMING,re=0;re<this._resultAreaEdgeList.size();re++){var ye=this._resultAreaEdgeList.get(re),ke=ye.getSym();if(ye.getLabel().isArea())switch(_===null&&ye.isInResult()&&(_=ye),U){case this._SCANNING_FOR_INCOMING:if(!ke.isInResult())continue;I=ke,U=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ye.isInResult())continue;I.setNext(ye),U=this._SCANNING_FOR_INCOMING}}if(U===this._LINKING_TO_OUTGOING){if(_===null)throw new Oe("no outgoing dirEdge found",this.getCoordinate());_e.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),I.setNext(_)}}},{key:"insert",value:function(_){var I=_;this.insertEdgeEnd(I,I)}},{key:"getRightmostEdge",value:function(){var _=this.getEdges(),I=_.size();if(I<1)return null;var U=_.get(0);if(I===1)return U;var re=_.get(I-1),ye=U.getQuadrant(),ke=re.getQuadrant();return In.isNorthern(ye)&&In.isNorthern(ke)?U:In.isNorthern(ye)||In.isNorthern(ke)?U.getDy()!==0?U:re.getDy()!==0?re:(_e.shouldNeverReachHere("found two horizontal edges incident on node"),null):re}},{key:"print",value:function(_){Bt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var I=this.iterator();I.hasNext();){var U=I.next();_.print("out "),U.print(_),_.println(),_.print("in "),U.getSym().print(_),_.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Ne;for(var _=this.iterator();_.hasNext();){var I=_.next();(I.isInResult()||I.getSym().isInResult())&&this._resultAreaEdgeList.add(I)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(_){for(var I=this.iterator();I.hasNext();){var U=I.next().getLabel();U.setAllLocationsIfNull(0,_.getLocation(0)),U.setAllLocationsIfNull(1,_.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var _=null,I=null,U=this._edgeList.size()-1;U>=0;U--){var re=this._edgeList.get(U),ye=re.getSym();I===null&&(I=ye),_!==null&&ye.setNext(_),_=re}I.setNext(_)}},{key:"computeDepths",value:function(){if(arguments.length===1){var _=arguments[0],I=this.findIndex(_),U=_.getDepth(mt.LEFT),re=_.getDepth(mt.RIGHT),ye=this.computeDepths(I+1,this._edgeList.size(),U);if(this.computeDepths(0,I,ye)!==re)throw new Oe("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var ke=arguments[1],Ke=arguments[2],yt=arguments[0];yt<ke;yt++){var rr=this._edgeList.get(yt);rr.setEdgeDepths(mt.RIGHT,Ke),Ke=rr.getDepth(mt.LEFT)}return Ke}}},{key:"mergeSymLabels",value:function(){for(var _=this.iterator();_.hasNext();){var I=_.next();I.getLabel().merge(I.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(_){for(var I=null,U=null,re=this._SCANNING_FOR_INCOMING,ye=this._resultAreaEdgeList.size()-1;ye>=0;ye--){var ke=this._resultAreaEdgeList.get(ye),Ke=ke.getSym();switch(I===null&&ke.getEdgeRing()===_&&(I=ke),re){case this._SCANNING_FOR_INCOMING:if(Ke.getEdgeRing()!==_)continue;U=Ke,re=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ke.getEdgeRing()!==_)continue;U.setNextMin(ke),re=this._SCANNING_FOR_INCOMING}}re===this._LINKING_TO_OUTGOING&&(_e.isTrue(I!==null,"found null for first outgoing dirEdge"),_e.isTrue(I.getEdgeRing()===_,"unable to link last incoming dirEdge"),U.setNextMin(I))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var _=0,I=this.iterator();I.hasNext();)I.next().isInResult()&&_++;return _}if(arguments.length===1){for(var U=arguments[0],re=0,ye=this.iterator();ye.hasNext();)ye.next().getEdgeRing()===U&&re++;return re}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var _=Ie.NONE,I=this.iterator();I.hasNext();){var U=I.next(),re=U.getSym();if(!U.isLineEdge()){if(U.isInResult()){_=Ie.INTERIOR;break}if(re.isInResult()){_=Ie.EXTERIOR;break}}}if(_===Ie.NONE)return null;for(var ye=_,ke=this.iterator();ke.hasNext();){var Ke=ke.next(),yt=Ke.getSym();Ke.isLineEdge()?Ke.getEdge().setCovered(ye===Ie.INTERIOR):(Ke.isInResult()&&(ye=Ie.EXTERIOR),yt.isInResult()&&(ye=Ie.INTERIOR))}}},{key:"computeLabelling",value:function(_){S(y,"computeLabelling",this,1).call(this,_),this._label=new $n(Ie.NONE);for(var I=this.iterator();I.hasNext();)for(var U=I.next().getEdge().getLabel(),re=0;re<2;re++){var ye=U.getLocation(re);ye!==Ie.INTERIOR&&ye!==Ie.BOUNDARY||this._label.setLocation(re,Ie.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])})(el),Ro=(function(A){function y(){return i(this,y),n(this,y)}return d(y,A),o(y,[{key:"createNode",value:function(_){return new Li(_,new Qa)}}])})(Ys),hc=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compareTo",value:function(y){var _=y;return A.compareOriented(this._pts,this._orientation,_._pts,_._orientation)}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var y=arguments[0];this._pts=y,this._orientation=A.orientation(y)}},{key:"orientation",value:function(y){return Mn.increasingDirection(y)===1}},{key:"compareOriented",value:function(y,_,I,U){for(var re=_?1:-1,ye=U?1:-1,ke=_?y.length:-1,Ke=U?I.length:-1,yt=_?0:y.length-1,rr=U?0:I.length-1;;){var gr=y[yt].compareTo(I[rr]);if(gr!==0)return gr;var Wr=(yt+=re)===ke,wn=(rr+=ye)===Ke;if(Wr&&!wn)return-1;if(!Wr&&wn)return 1;if(Wr&&wn)return 0}}}])})(),fc=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"print",value:function(A){A.print("MULTILINESTRING ( ");for(var y=0;y<this._edges.size();y++){var _=this._edges.get(y);y>0&&A.print(","),A.print("(");for(var I=_.getCoordinates(),U=0;U<I.length;U++)U>0&&A.print(","),A.print(I[U].x+" "+I[U].y);A.println(")")}A.print(")  ")}},{key:"addAll",value:function(A){for(var y=A.iterator();y.hasNext();)this.add(y.next())}},{key:"findEdgeIndex",value:function(A){for(var y=0;y<this._edges.size();y++)if(this._edges.get(y).equals(A))return y;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(A){return this._edges.get(A)}},{key:"findEqualEdge",value:function(A){var y=new hc(A.getCoordinates());return this._ocaMap.get(y)}},{key:"add",value:function(A){this._edges.add(A);var y=new hc(A.getCoordinates());this._ocaMap.put(y,A)}}],[{key:"constructor_",value:function(){this._edges=new Ne,this._ocaMap=new Wn}}])})(),Vl=(function(){return o((function A(){i(this,A)}),[{key:"processIntersections",value:function(A,y,_,I){}},{key:"isDone",value:function(){}}])})(),$l=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isTrivialIntersection",value:function(y,_,I,U){if(y===I&&this._li.getIntersectionNum()===1){if(A.isAdjacentSegments(_,U))return!0;if(y.isClosed()){var re=y.size()-1;if(_===0&&U===re||U===0&&_===re)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(y,_,I,U){if(y===I&&_===U)return null;this.numTests++;var re=y.getCoordinates()[_],ye=y.getCoordinates()[_+1],ke=I.getCoordinates()[U],Ke=I.getCoordinates()[U+1];this._li.computeIntersection(re,ye,ke,Ke),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(y,_,I,U)||(this._hasIntersection=!0,y.addIntersections(this._li,_,0),I.addIntersections(this._li,U,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Vl]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var y=arguments[0];this._li=y}},{key:"isAdjacentSegments",value:function(y,_){return Math.abs(y-_)===1}}])})(),Co=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(A){A.print(this.coord),A.print(" seg # = "+this.segmentIndex),A.println(" dist = "+this.dist)}},{key:"compareTo",value:function(A){var y=A;return this.compare(y.segmentIndex,y.dist)}},{key:"isEndPoint",value:function(A){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===A}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(A,y){return this.segmentIndex<A?-1:this.segmentIndex>A?1:this.dist<y?-1:this.dist>y?1:0}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var A=arguments[0],y=arguments[1],_=arguments[2];this.coord=new Fe(A),this.segmentIndex=y,this.dist=_}}])})(),co=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"print",value:function(A){A.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(A){this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next(),U=this.createSplitEdge(_,I);A.add(U),_=I}}},{key:"addEndpoints",value:function(){var A=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[A],A,0)}},{key:"createSplitEdge",value:function(A,y){var _=y.segmentIndex-A.segmentIndex+2,I=this.edge.pts[y.segmentIndex],U=y.dist>0||!y.coord.equals2D(I);U||_--;var re=new Array(_).fill(null),ye=0;re[ye++]=new Fe(A.coord);for(var ke=A.segmentIndex+1;ke<=y.segmentIndex;ke++)re[ye++]=this.edge.pts[ke];return U&&(re[ye]=y.coord),new Ia(re,new $n(this.edge._label))}},{key:"add",value:function(A,y,_){var I=new Co(A,y,_),U=this._nodeMap.get(I);return U!==null?U:(this._nodeMap.put(I,I),I)}},{key:"isIntersection",value:function(A){for(var y=this.iterator();y.hasNext();)if(y.next().coord.equals(A))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Wn,this.edge=null;var A=arguments[0];this.edge=A}}])})(),Cu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===qt.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===qt.FALSE}},{key:"isCoveredBy",value:function(){return(A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===qt.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===qt.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var I=Math.trunc(_/3),U=_%3;this._matrix[I][U]=qt.toDimensionValue(y.charAt(_))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],ke=arguments[2];this._matrix[re][ye]=ke}}},{key:"isContains",value:function(){return A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===qt.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===qt.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var I=Math.trunc(_/3),U=_%3;this.setAtLeast(I,U,qt.toDimensionValue(y.charAt(_)))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],ke=arguments[2];this._matrix[re][ye]<ke&&(this._matrix[re][ye]=ke)}}},{key:"setAtLeastIfValid",value:function(y,_,I){y>=0&&_>=0&&this.setAtLeast(y,_,I)}},{key:"isWithin",value:function(){return A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===qt.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===qt.FALSE}},{key:"isTouches",value:function(y,_){return y>_?this.isTouches(_,y):(y===qt.A&&_===qt.A||y===qt.L&&_===qt.L||y===qt.L&&_===qt.A||y===qt.P&&_===qt.A||y===qt.P&&_===qt.L)&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===qt.FALSE&&(A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))}},{key:"isOverlaps",value:function(y,_){return y===qt.P&&_===qt.P||y===qt.A&&_===qt.A?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR]):y===qt.L&&_===qt.L&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===1&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR])}},{key:"isEquals",value:function(y,_){return y===_&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===qt.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===qt.FALSE&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===qt.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===qt.FALSE}},{key:"toString",value:function(){for(var y=new Hi("123456789"),_=0;_<3;_++)for(var I=0;I<3;I++)y.setCharAt(3*_+I,qt.toDimensionSymbol(this._matrix[_][I]));return y.toString()}},{key:"setAll",value:function(y){for(var _=0;_<3;_++)for(var I=0;I<3;I++)this._matrix[_][I]=y}},{key:"get",value:function(y,_){return this._matrix[y][_]}},{key:"transpose",value:function(){var y=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=y,y=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=y,y=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=y,this}},{key:"matches",value:function(y){if(y.length!==9)throw new z("Should be length 9: "+y);for(var _=0;_<3;_++)for(var I=0;I<3;I++)if(!A.matches(this._matrix[_][I],y.charAt(3*_+I)))return!1;return!0}},{key:"add",value:function(y){for(var _=0;_<3;_++)for(var I=0;I<3;I++)this.setAtLeast(_,I,y.get(_,I))}},{key:"isDisjoint",value:function(){return this._matrix[Ie.INTERIOR][Ie.INTERIOR]===qt.FALSE&&this._matrix[Ie.INTERIOR][Ie.BOUNDARY]===qt.FALSE&&this._matrix[Ie.BOUNDARY][Ie.INTERIOR]===qt.FALSE&&this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]===qt.FALSE}},{key:"isCrosses",value:function(y,_){return y===qt.P&&_===qt.L||y===qt.P&&_===qt.A||y===qt.L&&_===qt.A?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR]):y===qt.L&&_===qt.P||y===qt.A&&_===qt.P||y===qt.A&&_===qt.L?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR]):y===qt.L&&_===qt.L&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===0}},{key:"interfaces_",get:function(){return[W]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(qt.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var y=arguments[0];A.constructor_.call(this),this.set(y)}else if(arguments[0]instanceof A){var _=arguments[0];A.constructor_.call(this),this._matrix[Ie.INTERIOR][Ie.INTERIOR]=_._matrix[Ie.INTERIOR][Ie.INTERIOR],this._matrix[Ie.INTERIOR][Ie.BOUNDARY]=_._matrix[Ie.INTERIOR][Ie.BOUNDARY],this._matrix[Ie.INTERIOR][Ie.EXTERIOR]=_._matrix[Ie.INTERIOR][Ie.EXTERIOR],this._matrix[Ie.BOUNDARY][Ie.INTERIOR]=_._matrix[Ie.BOUNDARY][Ie.INTERIOR],this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]=_._matrix[Ie.BOUNDARY][Ie.BOUNDARY],this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]=_._matrix[Ie.BOUNDARY][Ie.EXTERIOR],this._matrix[Ie.EXTERIOR][Ie.INTERIOR]=_._matrix[Ie.EXTERIOR][Ie.INTERIOR],this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]=_._matrix[Ie.EXTERIOR][Ie.BOUNDARY],this._matrix[Ie.EXTERIOR][Ie.EXTERIOR]=_._matrix[Ie.EXTERIOR][Ie.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var y=arguments[0],_=arguments[1];return _===qt.SYM_DONTCARE||_===qt.SYM_TRUE&&(y>=0||y===qt.TRUE)||_===qt.SYM_FALSE&&y===qt.FALSE||_===qt.SYM_P&&y===qt.P||_===qt.SYM_L&&y===qt.L||_===qt.SYM_A&&y===qt.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var I=arguments[1];return new A(arguments[0]).matches(I)}}},{key:"isTrue",value:function(y){return y>=0||y===qt.TRUE}}])})(),Ao=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(y){return y===null||y.length===0?null:(this.ensureCapacity(this._size+y.length),Bt.arraycopy(y,0,this._data,this._size,y.length),void(this._size+=y.length))}},{key:"ensureCapacity",value:function(y){if(y<=this._data.length)return null;var _=Math.max(y,2*this._data.length);this._data=Mt.copyOf(this._data,_)}},{key:"toArray",value:function(){var y=new Array(this._size).fill(null);return Bt.arraycopy(this._data,0,y,0,this._size),y}},{key:"add",value:function(y){this.ensureCapacity(this._size+1),this._data[this._size]=y,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)A.constructor_.call(this,10);else if(arguments.length===1){var y=arguments[0];this._data=new Array(y).fill(null)}}}])})(),ql=(function(){function A(){i(this,A)}return o(A,[{key:"getChainStartIndices",value:function(y){var _=0,I=new Ao(Math.trunc(y.length/2));I.add(_);do{var U=this.findChainEnd(y,_);I.add(U),_=U}while(_<y.length-1);return I.toArray()}},{key:"findChainEnd",value:function(y,_){for(var I=In.quadrant(y[_],y[_+1]),U=_+1;U<y.length&&In.quadrant(y[U-1],y[U])===I;)U++;return U-1}},{key:"OLDgetChainStartIndices",value:function(y){var _=0,I=new Ne;I.add(_);do{var U=this.findChainEnd(y,_);I.add(U),_=U}while(_<y.length-1);return A.toIntArray(I)}}],[{key:"toIntArray",value:function(y){for(var _=new Array(y.size()).fill(null),I=0;I<_.length;I++)_[I]=y.get(I).intValue();return _}}])})(),jo=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(A){var y=this.pts[this.startIndex[A]].x,_=this.pts[this.startIndex[A+1]].x;return y>_?y:_}},{key:"getMinX",value:function(A){var y=this.pts[this.startIndex[A]].x,_=this.pts[this.startIndex[A+1]].x;return y<_?y:_}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this.computeIntersectsForChain(this.startIndex[A],this.startIndex[A+1],y,y.startIndex[_],y.startIndex[_+1],I)}else if(arguments.length===6){var U=arguments[0],re=arguments[1],ye=arguments[2],ke=arguments[3],Ke=arguments[4],yt=arguments[5];if(re-U==1&&Ke-ke==1)return yt.addIntersections(this.e,U,ye.e,ke),null;if(!this.overlaps(U,re,ye,ke,Ke))return null;var rr=Math.trunc((U+re)/2),gr=Math.trunc((ke+Ke)/2);U<rr&&(ke<gr&&this.computeIntersectsForChain(U,rr,ye,ke,gr,yt),gr<Ke&&this.computeIntersectsForChain(U,rr,ye,gr,Ke,yt)),rr<re&&(ke<gr&&this.computeIntersectsForChain(rr,re,ye,ke,gr,yt),gr<Ke&&this.computeIntersectsForChain(rr,re,ye,gr,Ke,yt))}}},{key:"overlaps",value:function(A,y,_,I,U){return Ze.intersects(this.pts[A],this.pts[y],_.pts[I],_.pts[U])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(A,y){for(var _=0;_<this.startIndex.length-1;_++)for(var I=0;I<A.startIndex.length-1;I++)this.computeIntersectsForChain(_,A,I,y)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var A=arguments[0];this.e=A,this.pts=A.getCoordinates();var y=new ql;this.startIndex=y.getChainStartIndices(this.pts)}}])})(),El=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getDepth",value:function(y,_){return this._depth[y][_]}},{key:"setDepth",value:function(y,_,I){this._depth[y][_]=I}},{key:"isNull",value:function(){if(arguments.length===0){for(var y=0;y<2;y++)for(var _=0;_<3;_++)if(this._depth[y][_]!==A.NULL_VALUE)return!1;return!0}if(arguments.length===1){var I=arguments[0];return this._depth[I][1]===A.NULL_VALUE}if(arguments.length===2){var U=arguments[0],re=arguments[1];return this._depth[U][re]===A.NULL_VALUE}}},{key:"normalize",value:function(){for(var y=0;y<2;y++)if(!this.isNull(y)){var _=this._depth[y][1];this._depth[y][2]<_&&(_=this._depth[y][2]),_<0&&(_=0);for(var I=1;I<3;I++){var U=0;this._depth[y][I]>_&&(U=1),this._depth[y][I]=U}}}},{key:"getDelta",value:function(y){return this._depth[y][mt.RIGHT]-this._depth[y][mt.LEFT]}},{key:"getLocation",value:function(y,_){return this._depth[y][_]<=0?Ie.EXTERIOR:Ie.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<2;_++)for(var I=1;I<3;I++){var U=y.getLocation(_,I);U!==Ie.EXTERIOR&&U!==Ie.INTERIOR||(this.isNull(_,I)?this._depth[_][I]=A.depthAtLocation(U):this._depth[_][I]+=A.depthAtLocation(U))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1];arguments[2]===Ie.INTERIOR&&this._depth[re][ye]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var y=0;y<2;y++)for(var _=0;_<3;_++)this._depth[y][_]=A.NULL_VALUE}},{key:"depthAtLocation",value:function(y){return y===Ie.EXTERIOR?0:y===Ie.INTERIOR?1:A.NULL_VALUE}}])})();El.NULL_VALUE=-1;var Ia=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new y(_,$n.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(_){this._isIsolated=_}},{key:"setName",value:function(_){this._name=_}},{key:"equals",value:function(_){if(!(_ instanceof y))return!1;var I=_;if(this.pts.length!==I.pts.length)return!1;for(var U=!0,re=!0,ye=this.pts.length,ke=0;ke<this.pts.length;ke++)if(this.pts[ke].equals2D(I.pts[ke])||(U=!1),this.pts[ke].equals2D(I.pts[--ye])||(re=!1),!U&&!re)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}}},{key:"print",value:function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var I=0;I<this.pts.length;I++)I>0&&_.print(","),_.print(this.pts[I].x+" "+this.pts[I].y);_.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(_){y.updateIM(this._label,_)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(_){_.print("edge "+this._name+": ");for(var I=this.pts.length-1;I>=0;I--)_.print(this.pts[I]+" ");_.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new jo(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ze;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env}},{key:"addIntersection",value:function(_,I,U,re){var ye=new Fe(_.getIntersection(re)),ke=I,Ke=_.getEdgeDistance(U,re),yt=ke+1;if(yt<this.pts.length){var rr=this.pts[yt];ye.equals2D(rr)&&(ke=yt,Ke=0)}this.eiList.add(ye,ke,Ke)}},{key:"toString",value:function(){var _=new Hi;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var I=0;I<this.pts.length;I++)I>0&&_.append(","),_.append(this.pts[I].x+" "+this.pts[I].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()}},{key:"isPointwiseEqual",value:function(_){if(this.pts.length!==_.pts.length)return!1;for(var I=0;I<this.pts.length;I++)if(!this.pts[I].equals2D(_.pts[I]))return!1;return!0}},{key:"setDepthDelta",value:function(_){this._depthDelta=_}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(_,I,U){for(var re=0;re<_.getIntersectionNum();re++)this.addIntersection(_,I,U,re)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new co(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new El,this._depthDelta=0,arguments.length===1){var _=arguments[0];y.constructor_.call(this,_,null)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.pts=I,this._label=U}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Cu&&arguments[0]instanceof $n))return S(y,"updateIM",this).apply(this,arguments);var _=arguments[0],I=arguments[1];I.setAtLeastIfValid(_.getLocation(0,mt.ON),_.getLocation(1,mt.ON),1),_.isArea()&&(I.setAtLeastIfValid(_.getLocation(0,mt.LEFT),_.getLocation(1,mt.LEFT),2),I.setAtLeastIfValid(_.getLocation(0,mt.RIGHT),_.getLocation(1,mt.RIGHT),2))}}])})(si),tl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"setWorkingPrecisionModel",value:function(y){this._workingPrecisionModel=y}},{key:"insertUniqueEdge",value:function(y){var _=this._edgeList.findEqualEdge(y);if(_!==null){var I=_.getLabel(),U=y.getLabel();_.isPointwiseEqual(y)||(U=new $n(y.getLabel())).flip(),I.merge(U);var re=A.depthDelta(U),ye=_.getDepthDelta()+re;_.setDepthDelta(ye)}else this._edgeList.add(y),y.setDepthDelta(A.depthDelta(y.getLabel()))}},{key:"buildSubgraphs",value:function(y,_){for(var I=new Ne,U=y.iterator();U.hasNext();){var re=U.next(),ye=re.getRightmostCoordinate(),ke=new Ts(I).getDepth(ye);re.computeDepth(ke),re.findResultEdges(),I.add(re),_.add(re.getDirectedEdges(),re.getNodes())}}},{key:"createSubgraphs",value:function(y){for(var _=new Ne,I=y.getNodes().iterator();I.hasNext();){var U=I.next();if(!U.isVisited()){var re=new pt;re.create(U),_.add(re)}}return uo.sort(_,uo.reverseOrder()),_}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(y){if(this._workingNoder!==null)return this._workingNoder;var _=new Ks,I=new hn;return I.setPrecisionModel(y),_.setSegmentIntersector(new $l(I)),_}},{key:"buffer",value:function(y,_){var I=this._workingPrecisionModel;I===null&&(I=y.getPrecisionModel()),this._geomFact=y.getFactory();var U=new au(I,this._bufParams),re=new jl(y,_,U).getCurves();if(re.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(re,I),this._graph=new lo(new Ro),this._graph.addEdges(this._edgeList.getEdges());var ye=this.createSubgraphs(this._graph),ke=new iu(this._geomFact);this.buildSubgraphs(ye,ke);var Ke=ke.getPolygons();return Ke.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Ke)}},{key:"computeNodedEdges",value:function(y,_){var I=this.getNoder(_);I.computeNodes(y);for(var U=I.getNodedSubstrings().iterator();U.hasNext();){var re=U.next(),ye=re.getCoordinates();if(ye.length!==2||!ye[0].equals2D(ye[1])){var ke=re.getData(),Ke=new Ia(re.getCoordinates(),new $n(ke));this.insertUniqueEdge(Ke)}}}},{key:"setNoder",value:function(y){this._workingNoder=y}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new fc;var y=arguments[0];this._bufParams=y}},{key:"depthDelta",value:function(y){var _=y.getLocation(0,mt.LEFT),I=y.getLocation(0,mt.RIGHT);return _===Ie.INTERIOR&&I===Ie.EXTERIOR?1:_===Ie.EXTERIOR&&I===Ie.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(y){for(var _=new Mo,I=new Ne;y.hasNext();){var U=y.next(),re=_.createLineString(U.getCoordinates());I.add(re)}return _.buildGeometry(I)}}])})(),rl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"rescale",value:function(){if(Pr(arguments[0],Lt))for(var y=arguments[0].iterator();y.hasNext();){var _=y.next();this.rescale(_.getCoordinates())}else if(arguments[0]instanceof Array){for(var I=arguments[0],U=0;U<I.length;U++)I[U].x=I[U].x/this._scaleFactor+this._offsetX,I[U].y=I[U].y/this._scaleFactor+this._offsetY;I.length===2&&I[0].equals2D(I[1])&&Bt.out.println(I)}}},{key:"scale",value:function(){if(Pr(arguments[0],Lt)){for(var y=arguments[0],_=new Ne(y.size()),I=y.iterator();I.hasNext();){var U=I.next();_.add(new $i(this.scale(U.getCoordinates()),U.getData()))}return _}if(arguments[0]instanceof Array){for(var re=arguments[0],ye=new Array(re.length).fill(null),ke=0;ke<re.length;ke++)ye[ke]=new Fe(Math.round((re[ke].x-this._offsetX)*this._scaleFactor),Math.round((re[ke].y-this._offsetY)*this._scaleFactor),re[ke].getZ());return Mn.removeRepeatedPoints(ye)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var y=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(y),y}},{key:"computeNodes",value:function(y){var _=y;this._isScaled&&(_=this.scale(y)),this._noder.computeNodes(_)}},{key:"interfaces_",get:function(){return[ba]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var y=arguments[0],_=arguments[1];A.constructor_.call(this,y,_,0,0)}else if(arguments.length===4){var I=arguments[0],U=arguments[1];this._noder=I,this._scaleFactor=U,this._isScaled=!this.isIntegerPrecision()}}}])})(),ls=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next().getCoordinates();this.checkEndPtVertexIntersections(_[0],this._segStrings),this.checkEndPtVertexIntersections(_[_.length-1],this._segStrings)}else if(arguments.length===2){for(var I=arguments[0],U=arguments[1].iterator();U.hasNext();)for(var re=U.next().getCoordinates(),ye=1;ye<re.length-1;ye++)if(re[ye].equals(I))throw new ce("found endpt/interior pt intersection at index "+ye+" :pt "+I)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();)for(var _=y.next(),I=this._segStrings.iterator();I.hasNext();){var U=I.next();this.checkInteriorIntersections(_,U)}else if(arguments.length===2)for(var re=arguments[0],ye=arguments[1],ke=re.getCoordinates(),Ke=ye.getCoordinates(),yt=0;yt<ke.length-1;yt++)for(var rr=0;rr<Ke.length-1;rr++)this.checkInteriorIntersections(re,yt,ye,rr);else if(arguments.length===4){var gr=arguments[0],Wr=arguments[1],wn=arguments[2],Un=arguments[3];if(gr===wn&&Wr===Un)return null;var Kn=gr.getCoordinates()[Wr],jn=gr.getCoordinates()[Wr+1],Bn=wn.getCoordinates()[Un],zi=wn.getCoordinates()[Un+1];if(this._li.computeIntersection(Kn,jn,Bn,zi),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Kn,jn)||this.hasInteriorIntersection(this._li,Bn,zi)))throw new ce("found non-noded intersection at "+Kn+"-"+jn+" and "+Bn+"-"+zi)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next();this.checkCollapses(_)}else if(arguments.length===1)for(var I=arguments[0].getCoordinates(),U=0;U<I.length-2;U++)this.checkCollapse(I[U],I[U+1],I[U+2])}},{key:"hasInteriorIntersection",value:function(y,_,I){for(var U=0;U<y.getIntersectionNum();U++){var re=y.getIntersection(U);if(!re.equals(_)&&!re.equals(I))return!0}return!1}},{key:"checkCollapse",value:function(y,_,I){if(y.equals(I))throw new ce("found non-noded collapse at "+A.fact.createLineString([y,_,I]))}}],[{key:"constructor_",value:function(){this._li=new hn,this._segStrings=null;var y=arguments[0];this._segStrings=y}}])})();ls.fact=new Mo;var ou=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"intersectsScaled",value:function(y,_){var I=Math.min(y.x,_.x),U=Math.max(y.x,_.x),re=Math.min(y.y,_.y),ye=Math.max(y.y,_.y),ke=this._maxx<I||this._minx>U||this._maxy<re||this._miny>ye;if(ke)return!1;var Ke=this.intersectsToleranceSquare(y,_);return _e.isTrue(!(ke&&Ke),"Found bad envelope test"),Ke}},{key:"initCorners",value:function(y){var _=.5;this._minx=y.x-_,this._maxx=y.x+_,this._miny=y.y-_,this._maxy=y.y+_,this._corner[0]=new Fe(this._maxx,this._maxy),this._corner[1]=new Fe(this._minx,this._maxy),this._corner[2]=new Fe(this._minx,this._miny),this._corner[3]=new Fe(this._maxx,this._miny)}},{key:"intersects",value:function(y,_){return this._scaleFactor===1?this.intersectsScaled(y,_):(this.copyScaled(y,this._p0Scaled),this.copyScaled(_,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(y){return Math.round(y*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(y,_){_.x=this.scale(y.x),_.y=this.scale(y.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var y=A.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ze(this._originalPt.x-y,this._originalPt.x+y,this._originalPt.y-y,this._originalPt.y+y)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(y,_){return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(y,_){var I=!1,U=!1;return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(I=!0),this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(U=!0),this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!I||!U)||!!y.equals(this._pt)||!!_.equals(this._pt))))}},{key:"addSnappedNode",value:function(y,_){var I=y.getCoordinate(_),U=y.getCoordinate(_+1);return!!this.intersects(I,U)&&(y.addIntersection(this.getCoordinate(),_),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var y=arguments[0],_=arguments[1],I=arguments[2];if(this._originalPt=y,this._pt=y,this._scaleFactor=_,this._li=I,_<=0)throw new z("Scale factor must be non-zero");_!==1&&(this._pt=new Fe(this.scale(y.x),this.scale(y.y)),this._p0Scaled=new Fe,this._p1Scaled=new Fe),this.initCorners(this._pt)}}])})();ou.SAFE_ENV_EXPANSION_FACTOR=.75;var Yu=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var A=arguments[1];arguments[0].getLineSegment(A,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Si}}])})(),nl=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"snap",value:function(){if(arguments.length===1){var A=arguments[0];return this.snap(A,null,-1)}if(arguments.length===3){var y=arguments[0],_=arguments[1],I=arguments[2],U=y.getSafeEnvelope(),re=new su(y,_,I);return this._index.query(U,new((function(){return o((function ye(){i(this,ye)}),[{key:"interfaces_",get:function(){return[se]}},{key:"visitItem",value:function(ye){ye.select(U,re)}}])})())),re.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var A=arguments[0];this._index=A}}])})(),su=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return d(y,A),o(y,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Aa))return S(y,"select",this,1).apply(this,arguments);var _=arguments[1],I=arguments[0].getContext();if(this._parentEdge===I&&(_===this._hotPixelVertexIndex||_+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(I,_)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],I=arguments[1],U=arguments[2];this._hotPixel=_,this._parentEdge=I,this._hotPixelVertexIndex=U}}])})(Yu);nl.HotPixelSnapAction=su;var Au=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"processIntersections",value:function(A,y,_,I){if(A===_&&y===I)return null;var U=A.getCoordinates()[y],re=A.getCoordinates()[y+1],ye=_.getCoordinates()[I],ke=_.getCoordinates()[I+1];if(this._li.computeIntersection(U,re,ye,ke),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ke=0;Ke<this._li.getIntersectionNum();Ke++)this._interiorIntersections.add(this._li.getIntersection(Ke));A.addIntersections(this._li,y,0),_.addIntersections(this._li,I,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Vl]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var A=arguments[0];this._li=A,this._interiorIntersections=new Ne}}])})(),tr=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"checkCorrectness",value:function(A){var y=$i.getNodedSubstrings(A),_=new ls(y);try{_.checkValid()}catch(I){if(!(I instanceof M))throw I;I.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return $i.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(A,y){var _=this.findInteriorIntersections(A,y);this.computeIntersectionSnaps(_),this.computeVertexSnaps(A)}},{key:"findInteriorIntersections",value:function(A,y){var _=new Au(y);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(A),_.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Pr(arguments[0],Lt))for(var A=arguments[0].iterator();A.hasNext();){var y=A.next();this.computeVertexSnaps(y)}else if(arguments[0]instanceof $i)for(var _=arguments[0],I=_.getCoordinates(),U=0;U<I.length;U++){var re=new ou(I[U],this._scaleFactor,this._li);this._pointSnapper.snap(re,_,U)&&_.addIntersection(I[U],U)}}},{key:"computeNodes",value:function(A){this._nodedSegStrings=A,this._noder=new Ks,this._pointSnapper=new nl(this._noder.getIndex()),this.snapRound(A,this._li)}},{key:"computeIntersectionSnaps",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next(),I=new ou(_,this._scaleFactor,this._li);this._pointSnapper.snap(I)}}},{key:"interfaces_",get:function(){return[ba]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var A=arguments[0];this._pm=A,this._li=new hn,this._li.setPrecisionModel(A),this._scaleFactor=A.getScale()}}])})(),ur=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"bufferFixedPrecision",value:function(y){var _=new rl(new tr(new xi(1)),y.getScale()),I=new tl(this._bufParams);I.setWorkingPrecisionModel(y),I.setNoder(_),this._resultGeometry=I.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var y=A.MAX_PRECISION_DIGITS;y>=0;y--){try{this.bufferReducedPrecision(y)}catch(re){if(!(re instanceof Oe))throw re;this._saveException=re}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],I=A.precisionScaleFactor(this._argGeom,this._distance,_),U=new xi(I);this.bufferFixedPrecision(U)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var y=this._argGeom.getFactory().getPrecisionModel();y.getType()===xi.FIXED?this.bufferFixedPrecision(y):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(y){this._bufParams.setQuadrantSegments(y)}},{key:"bufferOriginalPrecision",value:function(){try{var y=new tl(this._bufParams);this._resultGeometry=y.buffer(this._argGeom,this._distance)}catch(_){if(!(_ instanceof ce))throw _;this._saveException=_}}},{key:"getResultGeometry",value:function(y){return this._distance=y,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(y){this._bufParams.setEndCapStyle(y)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new N,this._resultGeometry=null,this._saveException=null,arguments.length===1){var y=arguments[0];this._argGeom=y}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this._argGeom=_,this._bufParams=I}}},{key:"bufferOp",value:function(){if(arguments.length===2){var y=arguments[1];return new A(arguments[0]).getResultGeometry(y)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Qe&&typeof arguments[1]=="number"){var _=arguments[1],I=arguments[2],U=new A(arguments[0]);return U.setQuadrantSegments(I),U.getResultGeometry(_)}if(arguments[2]instanceof N&&arguments[0]instanceof Qe&&typeof arguments[1]=="number"){var re=arguments[1];return new A(arguments[0],arguments[2]).getResultGeometry(re)}}else if(arguments.length===4){var ye=arguments[1],ke=arguments[2],Ke=arguments[3],yt=new A(arguments[0]);return yt.setQuadrantSegments(ke),yt.setEndCapStyle(Ke),yt.getResultGeometry(ye)}}},{key:"precisionScaleFactor",value:function(y,_,I){var U=y.getEnvelopeInternal(),re=At.max(Math.abs(U.getMaxX()),Math.abs(U.getMaxY()),Math.abs(U.getMinX()),Math.abs(U.getMinY()))+2*(_>0?_:0),ye=I-Math.trunc(Math.log(re)/Math.log(10)+1);return Math.pow(10,ye)}}])})();ur.CAP_ROUND=N.CAP_ROUND,ur.CAP_BUTT=N.CAP_FLAT,ur.CAP_FLAT=N.CAP_FLAT,ur.CAP_SQUARE=N.CAP_SQUARE,ur.MAX_PRECISION_DIGITS=12;var mn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Tn=(function(){return o((function A(y){i(this,A),this.geometryFactory=y||new Mo}),[{key:"read",value:function(A){var y,_=(y=typeof A=="string"?JSON.parse(A):A).type;if(!yi[_])throw new Error("Unknown GeoJSON type: "+y.type);return mn.indexOf(_)!==-1?yi[_].call(this,y.coordinates):_==="GeometryCollection"?yi[_].call(this,y.geometries):yi[_].call(this,y)}},{key:"write",value:function(A){var y=A.getGeometryType();if(!Rn[y])throw new Error("Geometry is not supported");return Rn[y].call(this,A)}}])})(),yi={Feature:function(A){var y={};for(var _ in A)y[_]=A[_];if(A.geometry){var I=A.geometry.type;if(!yi[I])throw new Error("Unknown GeoJSON type: "+A.type);y.geometry=this.read(A.geometry)}return A.bbox&&(y.bbox=yi.bbox.call(this,A.bbox)),y},FeatureCollection:function(A){var y={};if(A.features){y.features=[];for(var _=0;_<A.features.length;++_)y.features.push(this.read(A.features[_]))}return A.bbox&&(y.bbox=this.parse.bbox.call(this,A.bbox)),y},coordinates:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(a(Fe,E(I)))}return y},bbox:function(A){return this.geometryFactory.createLinearRing([new Fe(A[0],A[1]),new Fe(A[2],A[1]),new Fe(A[2],A[3]),new Fe(A[0],A[3]),new Fe(A[0],A[1])])},Point:function(A){var y=a(Fe,E(A));return this.geometryFactory.createPoint(y)},MultiPoint:function(A){for(var y=[],_=0;_<A.length;++_)y.push(yi.Point.call(this,A[_]));return this.geometryFactory.createMultiPoint(y)},LineString:function(A){var y=yi.coordinates.call(this,A);return this.geometryFactory.createLineString(y)},MultiLineString:function(A){for(var y=[],_=0;_<A.length;++_)y.push(yi.LineString.call(this,A[_]));return this.geometryFactory.createMultiLineString(y)},Polygon:function(A){for(var y=yi.coordinates.call(this,A[0]),_=this.geometryFactory.createLinearRing(y),I=[],U=1;U<A.length;++U){var re=A[U],ye=yi.coordinates.call(this,re),ke=this.geometryFactory.createLinearRing(ye);I.push(ke)}return this.geometryFactory.createPolygon(_,I)},MultiPolygon:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(yi.Polygon.call(this,I))}return this.geometryFactory.createMultiPolygon(y)},GeometryCollection:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(this.read(I))}return this.geometryFactory.createGeometryCollection(y)}},Rn={coordinate:function(A){var y=[A.x,A.y];return A.z&&y.push(A.z),A.m&&y.push(A.m),y},Point:function(A){return{type:"Point",coordinates:Rn.coordinate.call(this,A.getCoordinate())}},MultiPoint:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=Rn.Point.call(this,I);y.push(U.coordinates)}return{type:"MultiPoint",coordinates:y}},LineString:function(A){for(var y=[],_=A.getCoordinates(),I=0;I<_.length;++I){var U=_[I];y.push(Rn.coordinate.call(this,U))}return{type:"LineString",coordinates:y}},MultiLineString:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=Rn.LineString.call(this,I);y.push(U.coordinates)}return{type:"MultiLineString",coordinates:y}},Polygon:function(A){var y=[],_=Rn.LineString.call(this,A._shell);y.push(_.coordinates);for(var I=0;I<A._holes.length;++I){var U=A._holes[I],re=Rn.LineString.call(this,U);y.push(re.coordinates)}return{type:"Polygon",coordinates:y}},MultiPolygon:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=Rn.Polygon.call(this,I);y.push(U.coordinates)}return{type:"MultiPolygon",coordinates:y}},GeometryCollection:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=I.getGeometryType();y.push(Rn[U].call(this,I))}return{type:"GeometryCollection",geometries:y}}};return{BufferOp:ur,GeoJSONReader:(function(){return o((function A(y){i(this,A),this.parser=new Tn(y||new Mo)}),[{key:"read",value:function(A){return this.parser.read(A)}}])})(),GeoJSONWriter:(function(){return o((function A(){i(this,A),this.parser=new Tn(this.geometryFactory)}),[{key:"write",value:function(A){return this.parser.write(A)}}])})()}}))})(vw)),vw.exports}var txe=exe();const rxe=ad(txe);function fg(){return new dS}function dS(){this.reset()}dS.prototype={constructor:dS,reset:function(){this.s=this.t=0},add:function(t){qz(S2,t,this.t),qz(this,S2.s,this.s),this.s?this.t+=S2.t:this.s=S2.t},valueOf:function(){return this.s}};var S2=new dS;function qz(t,e,r){var n=t.s=e+r,i=n-e,a=n-i;t.t=e-a+(r-i)}var Do=1e-6,Ra=Math.PI,Hf=Ra/2,Hz=Ra/4,rd=Ra*2,Ep=180/Ra,fh=Ra/180,eu=Math.abs,nxe=Math.atan,u0=Math.atan2,vs=Math.cos,_s=Math.sin,L0=Math.sqrt;function MZ(t){return t>1?0:t<-1?Ra:Math.acos(t)}function Sm(t){return t>1?Hf:t<-1?-Hf:Math.asin(t)}function Q_(){}function pS(t,e){t&&Gz.hasOwnProperty(t.type)&&Gz[t.type](t,e)}var Wz={Feature:function(t,e){pS(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,n=-1,i=r.length;++n<i;)pS(r[n].geometry,e)}},Gz={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Ck(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)Ck(r[n],e,0)},Polygon:function(t,e){Xz(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)Xz(r[n],e)},GeometryCollection:function(t,e){for(var r=t.geometries,n=-1,i=r.length;++n<i;)pS(r[n],e)}};function Ck(t,e,r){var n=-1,i=t.length-r,a;for(e.lineStart();++n<i;)a=t[n],e.point(a[0],a[1],a[2]);e.lineEnd()}function Xz(t,e){var r=-1,n=t.length;for(e.polygonStart();++r<n;)Ck(t[r],e,1);e.polygonEnd()}function ixe(t,e){t&&Wz.hasOwnProperty(t.type)?Wz[t.type](t,e):pS(t,e)}fg();fg();function Ak(t){return[u0(t[1],t[0]),Sm(t[2])]}function c0(t){var e=t[0],r=t[1],n=vs(r);return[n*vs(e),n*_s(e),_s(r)]}function E2(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gS(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function iA(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function T2(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ik(t){var e=L0(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}fg();function RZ(t,e){function r(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(r.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),r}function Pk(t,e){return[t>Ra?t-rd:t<-Ra?t+rd:t,e]}Pk.invert=Pk;function axe(t,e,r){return(t%=rd)?e||r?RZ(Zz(t),Kz(e,r)):Zz(t):e||r?Kz(e,r):Pk}function Yz(t){return function(e,r){return e+=t,[e>Ra?e-rd:e<-Ra?e+rd:e,r]}}function Zz(t){var e=Yz(t);return e.invert=Yz(-t),e}function Kz(t,e){var r=vs(t),n=_s(t),i=vs(e),a=_s(e);function s(o,u){var h=vs(u),f=vs(o)*h,d=_s(o)*h,b=_s(u),v=b*r+f*n;return[u0(d*i-v*a,f*r-b*n),Sm(v*i+d*a)]}return s.invert=function(o,u){var h=vs(u),f=vs(o)*h,d=_s(o)*h,b=_s(u),v=b*i-d*a;return[u0(d*i+b*a,f*r+v*n),Sm(v*r-f*n)]},s}function oxe(t,e,r,n,i,a){if(r){var s=vs(e),o=_s(e),u=n*r;i==null?(i=e+n*rd,a=e-u/2):(i=Jz(s,i),a=Jz(s,a),(n>0?i<a:i>a)&&(i+=n*rd));for(var h,f=i;n>0?f>a:f<a;f-=u)h=Ak([s,-o*vs(f),-o*_s(f)]),t.point(h[0],h[1])}}function Jz(t,e){e=c0(e),e[0]-=t,Ik(e);var r=MZ(-e[1]);return((-e[2]<0?-r:r)+rd-Do)%rd}function OZ(){var t=[],e;return{point:function(r,n){e.push([r,n])},lineStart:function(){t.push(e=[])},lineEnd:Q_,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function sxe(t,e,r,n,i,a){var s=t[0],o=t[1],u=e[0],h=e[1],f=0,d=1,b=u-s,v=h-o,S;if(S=r-s,!(!b&&S>0)){if(S/=b,b<0){if(S<f)return;S<d&&(d=S)}else if(b>0){if(S>d)return;S>f&&(f=S)}if(S=i-s,!(!b&&S<0)){if(S/=b,b<0){if(S>d)return;S>f&&(f=S)}else if(b>0){if(S<f)return;S<d&&(d=S)}if(S=n-o,!(!v&&S>0)){if(S/=v,v<0){if(S<f)return;S<d&&(d=S)}else if(v>0){if(S>d)return;S>f&&(f=S)}if(S=a-o,!(!v&&S<0)){if(S/=v,v<0){if(S>d)return;S>f&&(f=S)}else if(v>0){if(S<f)return;S<d&&(d=S)}return f>0&&(t[0]=s+f*b,t[1]=o+f*v),d<1&&(e[0]=s+d*b,e[1]=o+d*v),!0}}}}}function _w(t,e){return eu(t[0]-e[0])<Do&&eu(t[1]-e[1])<Do}function C2(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function NZ(t,e,r,n,i){var a=[],s=[],o,u;if(t.forEach(function(S){if(!((E=S.length-1)<=0)){var E,P=S[0],k=S[E],L;if(_w(P,k)){for(i.lineStart(),o=0;o<E;++o)i.point((P=S[o])[0],P[1]);i.lineEnd();return}a.push(L=new C2(P,S,null,!0)),s.push(L.o=new C2(P,null,L,!1)),a.push(L=new C2(k,S,null,!1)),s.push(L.o=new C2(k,null,L,!0))}}),!!a.length){for(s.sort(e),Qz(a),Qz(s),o=0,u=s.length;o<u;++o)s[o].e=r=!r;for(var h=a[0],f,d;;){for(var b=h,v=!0;b.v;)if((b=b.n)===h)return;f=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(v)for(o=0,u=f.length;o<u;++o)i.point((d=f[o])[0],d[1]);else n(b.x,b.n.x,1,i);b=b.n}else{if(v)for(f=b.p.z,o=f.length-1;o>=0;--o)i.point((d=f[o])[0],d[1]);else n(b.x,b.p.x,-1,i);b=b.p}b=b.o,f=b.z,v=!v}while(!b.v);i.lineEnd()}}}function Qz(t){if(e=t.length){for(var e,r=0,n=t[0],i;++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function LZ(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lxe(t){return t.length===1&&(t=uxe(t)),{left:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)<0?n=a+1:i=a}return n},right:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)>0?i=a:n=a+1}return n}}}function uxe(t){return function(e,r){return LZ(t(e),r)}}lxe(LZ);function DZ(t){for(var e=t.length,r,n=-1,i=0,a,s;++n<e;)i+=t[n].length;for(a=new Array(i);--e>=0;)for(s=t[e],r=s.length;--r>=0;)a[--i]=s[r];return a}var e1=1e9,A2=-e1;function cxe(t,e,r,n){function i(h,f){return t<=h&&h<=r&&e<=f&&f<=n}function a(h,f,d,b){var v=0,S=0;if(h==null||(v=s(h,d))!==(S=s(f,d))||u(h,f)<0^d>0)do b.point(v===0||v===3?t:r,v>1?n:e);while((v=(v+d+4)%4)!==S);else b.point(f[0],f[1])}function s(h,f){return eu(h[0]-t)<Do?f>0?0:3:eu(h[0]-r)<Do?f>0?2:1:eu(h[1]-e)<Do?f>0?1:0:f>0?3:2}function o(h,f){return u(h.x,f.x)}function u(h,f){var d=s(h,1),b=s(f,1);return d!==b?d-b:d===0?f[1]-h[1]:d===1?h[0]-f[0]:d===2?h[1]-f[1]:f[0]-h[0]}return function(h){var f=h,d=OZ(),b,v,S,E,P,k,L,N,M,z,B,q={point:W,lineStart:H,lineEnd:ne,polygonStart:ie,polygonEnd:J};function W(ue,de){i(ue,de)&&f.point(ue,de)}function G(){for(var ue=0,de=0,Pe=v.length;de<Pe;++de)for(var me=v[de],Ee=1,we=me.length,Ae=me[0],ce,xe,_e=Ae[0],Me=Ae[1];Ee<we;++Ee)ce=_e,xe=Me,Ae=me[Ee],_e=Ae[0],Me=Ae[1],xe<=n?Me>n&&(_e-ce)*(n-xe)>(Me-xe)*(t-ce)&&++ue:Me<=n&&(_e-ce)*(n-xe)<(Me-xe)*(t-ce)&&--ue;return ue}function ie(){f=d,b=[],v=[],B=!0}function J(){var ue=G(),de=B&&ue,Pe=(b=DZ(b)).length;(de||Pe)&&(h.polygonStart(),de&&(h.lineStart(),a(null,null,1,h),h.lineEnd()),Pe&&NZ(b,o,ue,a,h),h.polygonEnd()),f=h,b=v=S=null}function H(){q.point=ae,v&&v.push(S=[]),z=!0,M=!1,L=N=NaN}function ne(){b&&(ae(E,P),k&&M&&d.rejoin(),b.push(d.result())),q.point=W,M&&f.lineEnd()}function ae(ue,de){var Pe=i(ue,de);if(v&&S.push([ue,de]),z)E=ue,P=de,k=Pe,z=!1,Pe&&(f.lineStart(),f.point(ue,de));else if(Pe&&M)f.point(ue,de);else{var me=[L=Math.max(A2,Math.min(e1,L)),N=Math.max(A2,Math.min(e1,N))],Ee=[ue=Math.max(A2,Math.min(e1,ue)),de=Math.max(A2,Math.min(e1,de))];sxe(me,Ee,t,e,r,n)?(M||(f.lineStart(),f.point(me[0],me[1])),f.point(Ee[0],Ee[1]),Pe||f.lineEnd(),B=!1):Pe&&(f.lineStart(),f.point(ue,de),B=!1)}L=ue,N=de,M=Pe}return q}}var aA=fg();function hxe(t,e){var r=e[0],n=e[1],i=[_s(r),-vs(r),0],a=0,s=0;aA.reset();for(var o=0,u=t.length;o<u;++o)if(f=(h=t[o]).length)for(var h,f,d=h[f-1],b=d[0],v=d[1]/2+Hz,S=_s(v),E=vs(v),P=0;P<f;++P,b=L,S=M,E=z,d=k){var k=h[P],L=k[0],N=k[1]/2+Hz,M=_s(N),z=vs(N),B=L-b,q=B>=0?1:-1,W=q*B,G=W>Ra,ie=S*M;if(aA.add(u0(ie*q*_s(W),E*z+ie*vs(W))),a+=G?B+q*rd:B,G^b>=r^L>=r){var J=gS(c0(d),c0(k));Ik(J);var H=gS(i,J);Ik(H);var ne=(G^B>=0?-1:1)*Sm(H[2]);(n>ne||n===ne&&(J[0]||J[1]))&&(s+=G^B>=0?1:-1)}}return(a<-Do||a<Do&&aA<-Do)^s&1}fg();function e9(t){return t}fg();fg();var h0=1/0,mS=h0,cb=-h0,yS=cb,t9={point:fxe,lineStart:Q_,lineEnd:Q_,polygonStart:Q_,polygonEnd:Q_,result:function(){var t=[[h0,mS],[cb,yS]];return cb=yS=-(mS=h0=1/0),t}};function fxe(t,e){t<h0&&(h0=t),t>cb&&(cb=t),e<mS&&(mS=e),e>yS&&(yS=e)}fg();function FZ(t,e,r,n){return function(i,a){var s=e(a),o=i.invert(n[0],n[1]),u=OZ(),h=e(u),f=!1,d,b,v,S={point:E,lineStart:k,lineEnd:L,polygonStart:function(){S.point=N,S.lineStart=M,S.lineEnd=z,b=[],d=[]},polygonEnd:function(){S.point=E,S.lineStart=k,S.lineEnd=L,b=DZ(b);var B=hxe(d,o);b.length?(f||(a.polygonStart(),f=!0),NZ(b,pxe,B,r,a)):B&&(f||(a.polygonStart(),f=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),b=d=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function E(B,q){var W=i(B,q);t(B=W[0],q=W[1])&&a.point(B,q)}function P(B,q){var W=i(B,q);s.point(W[0],W[1])}function k(){S.point=P,s.lineStart()}function L(){S.point=E,s.lineEnd()}function N(B,q){v.push([B,q]);var W=i(B,q);h.point(W[0],W[1])}function M(){h.lineStart(),v=[]}function z(){N(v[0][0],v[0][1]),h.lineEnd();var B=h.clean(),q=u.result(),W,G=q.length,ie,J,H;if(v.pop(),d.push(v),v=null,!!G){if(B&1){if(J=q[0],(ie=J.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),W=0;W<ie;++W)a.point((H=J[W])[0],H[1]);a.lineEnd()}return}G>1&&B&2&&q.push(q.pop().concat(q.shift())),b.push(q.filter(dxe))}}return S}}function dxe(t){return t.length>1}function pxe(t,e){return((t=t.x)[0]<0?t[1]-Hf-Do:Hf-t[1])-((e=e.x)[0]<0?e[1]-Hf-Do:Hf-e[1])}const r9=FZ(function(){return!0},gxe,yxe,[-Ra,-Hf]);function gxe(t){var e=NaN,r=NaN,n=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,s){var o=a>0?Ra:-Ra,u=eu(a-e);eu(u-Ra)<Do?(t.point(e,r=(r+s)/2>0?Hf:-Hf),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(a,r),i=0):n!==o&&u>=Ra&&(eu(e-n)<Do&&(e-=n*Do),eu(a-o)<Do&&(a-=o*Do),r=mxe(e,r,a,s),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),i=0),t.point(e=a,r=s),n=o},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-i}}}function mxe(t,e,r,n){var i,a,s=_s(t-r);return eu(s)>Do?nxe((_s(e)*(a=vs(n))*_s(r)-_s(n)*(i=vs(e))*_s(t))/(i*a*s)):(e+n)/2}function yxe(t,e,r,n){var i;if(t==null)i=r*Hf,n.point(-Ra,i),n.point(0,i),n.point(Ra,i),n.point(Ra,0),n.point(Ra,-i),n.point(0,-i),n.point(-Ra,-i),n.point(-Ra,0),n.point(-Ra,i);else if(eu(t[0]-e[0])>Do){var a=t[0]<e[0]?Ra:-Ra;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(e[0],e[1])}function vxe(t,e){var r=vs(t),n=r>0,i=eu(r)>Do;function a(f,d,b,v){oxe(v,t,e,b,f,d)}function s(f,d){return vs(f)*vs(d)>r}function o(f){var d,b,v,S,E;return{lineStart:function(){S=v=!1,E=1},point:function(P,k){var L=[P,k],N,M=s(P,k),z=n?M?0:h(P,k):M?h(P+(P<0?Ra:-Ra),k):0;if(!d&&(S=v=M)&&f.lineStart(),M!==v&&(N=u(d,L),(!N||_w(d,N)||_w(L,N))&&(L[0]+=Do,L[1]+=Do,M=s(L[0],L[1]))),M!==v)E=0,M?(f.lineStart(),N=u(L,d),f.point(N[0],N[1])):(N=u(d,L),f.point(N[0],N[1]),f.lineEnd()),d=N;else if(i&&d&&n^M){var B;!(z&b)&&(B=u(L,d,!0))&&(E=0,n?(f.lineStart(),f.point(B[0][0],B[0][1]),f.point(B[1][0],B[1][1]),f.lineEnd()):(f.point(B[1][0],B[1][1]),f.lineEnd(),f.lineStart(),f.point(B[0][0],B[0][1])))}M&&(!d||!_w(d,L))&&f.point(L[0],L[1]),d=L,v=M,b=z},lineEnd:function(){v&&f.lineEnd(),d=null},clean:function(){return E|(S&&v)<<1}}}function u(f,d,b){var v=c0(f),S=c0(d),E=[1,0,0],P=gS(v,S),k=E2(P,P),L=P[0],N=k-L*L;if(!N)return!b&&f;var M=r*k/N,z=-r*L/N,B=gS(E,P),q=T2(E,M),W=T2(P,z);iA(q,W);var G=B,ie=E2(q,G),J=E2(G,G),H=ie*ie-J*(E2(q,q)-1);if(!(H<0)){var ne=L0(H),ae=T2(G,(-ie-ne)/J);if(iA(ae,q),ae=Ak(ae),!b)return ae;var ue=f[0],de=d[0],Pe=f[1],me=d[1],Ee;de<ue&&(Ee=ue,ue=de,de=Ee);var we=de-ue,Ae=eu(we-Ra)<Do,ce=Ae||we<Do;if(!Ae&&me<Pe&&(Ee=Pe,Pe=me,me=Ee),ce?Ae?Pe+me>0^ae[1]<(eu(ae[0]-ue)<Do?Pe:me):Pe<=ae[1]&&ae[1]<=me:we>Ra^(ue<=ae[0]&&ae[0]<=de)){var xe=T2(G,(-ie+ne)/J);return iA(xe,q),[ae,Ak(xe)]}}}function h(f,d){var b=n?t:Ra-t,v=0;return f<-b?v|=1:f>b&&(v|=2),d<-b?v|=4:d>b&&(v|=8),v}return FZ(s,o,a,n?[0,-t]:[-Ra,t-Ra])}function BZ(t){return function(e){var r=new kk;for(var n in t)r[n]=t[n];return r.stream=e,r}}function kk(){}kk.prototype={constructor:kk,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function zZ(t,e,r){var n=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),a!=null&&t.clipExtent(null),ixe(r,t.stream(t9));var s=t9.result(),o=Math.min(n/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),u=+e[0][0]+(n-o*(s[1][0]+s[0][0]))/2,h=+e[0][1]+(i-o*(s[1][1]+s[0][1]))/2;return a!=null&&t.clipExtent(a),t.scale(o*150).translate([u,h])}function _xe(t,e,r){return zZ(t,[[0,0],e],r)}var n9=16,bxe=vs(30*fh);function i9(t,e){return+e?wxe(t,e):xxe(t)}function xxe(t){return BZ({point:function(e,r){e=t(e,r),this.stream.point(e[0],e[1])}})}function wxe(t,e){function r(n,i,a,s,o,u,h,f,d,b,v,S,E,P){var k=h-n,L=f-i,N=k*k+L*L;if(N>4*e&&E--){var M=s+b,z=o+v,B=u+S,q=L0(M*M+z*z+B*B),W=Sm(B/=q),G=eu(eu(B)-1)<Do||eu(a-d)<Do?(a+d)/2:u0(z,M),ie=t(G,W),J=ie[0],H=ie[1],ne=J-n,ae=H-i,ue=L*ne-k*ae;(ue*ue/N>e||eu((k*ne+L*ae)/N-.5)>.3||s*b+o*v+u*S<bxe)&&(r(n,i,a,s,o,u,J,H,G,M/=q,z/=q,B,E,P),P.point(J,H),r(J,H,G,M,z,B,h,f,d,b,v,S,E,P))}}return function(n){var i,a,s,o,u,h,f,d,b,v,S,E,P={point:k,lineStart:L,lineEnd:M,polygonStart:function(){n.polygonStart(),P.lineStart=z},polygonEnd:function(){n.polygonEnd(),P.lineStart=L}};function k(W,G){W=t(W,G),n.point(W[0],W[1])}function L(){d=NaN,P.point=N,n.lineStart()}function N(W,G){var ie=c0([W,G]),J=t(W,G);r(d,b,f,v,S,E,d=J[0],b=J[1],f=W,v=ie[0],S=ie[1],E=ie[2],n9,n),n.point(d,b)}function M(){P.point=k,n.lineEnd()}function z(){L(),P.point=B,P.lineEnd=q}function B(W,G){N(i=W,G),a=d,s=b,o=v,u=S,h=E,P.point=N}function q(){r(d,b,f,v,S,E,a,s,i,o,u,h,n9,n),P.lineEnd=M,M()}return P}}var Sxe=BZ({point:function(t,e){this.stream.point(t*fh,e*fh)}});function Exe(t){return Txe(function(){return t})()}function Txe(t){var e,r=150,n=480,i=250,a,s,o=0,u=0,h=0,f=0,d=0,b,v,S=null,E=r9,P=null,k,L,N,M=e9,z=.5,B=i9(J,z),q,W;function G(ae){return ae=v(ae[0]*fh,ae[1]*fh),[ae[0]*r+a,s-ae[1]*r]}function ie(ae){return ae=v.invert((ae[0]-a)/r,(s-ae[1])/r),ae&&[ae[0]*Ep,ae[1]*Ep]}function J(ae,ue){return ae=e(ae,ue),[ae[0]*r+a,s-ae[1]*r]}G.stream=function(ae){return q&&W===ae?q:q=Sxe(E(b,B(M(W=ae))))},G.clipAngle=function(ae){return arguments.length?(E=+ae?vxe(S=ae*fh,6*fh):(S=null,r9),ne()):S*Ep},G.clipExtent=function(ae){return arguments.length?(M=ae==null?(P=k=L=N=null,e9):cxe(P=+ae[0][0],k=+ae[0][1],L=+ae[1][0],N=+ae[1][1]),ne()):P==null?null:[[P,k],[L,N]]},G.scale=function(ae){return arguments.length?(r=+ae,H()):r},G.translate=function(ae){return arguments.length?(n=+ae[0],i=+ae[1],H()):[n,i]},G.center=function(ae){return arguments.length?(o=ae[0]%360*fh,u=ae[1]%360*fh,H()):[o*Ep,u*Ep]},G.rotate=function(ae){return arguments.length?(h=ae[0]%360*fh,f=ae[1]%360*fh,d=ae.length>2?ae[2]%360*fh:0,H()):[h*Ep,f*Ep,d*Ep]},G.precision=function(ae){return arguments.length?(B=i9(J,z=ae*ae),ne()):L0(z)},G.fitExtent=function(ae,ue){return zZ(G,ae,ue)},G.fitSize=function(ae,ue){return _xe(G,ae,ue)};function H(){v=RZ(b=axe(h,f,d),e);var ae=e(o,u);return a=n-ae[0]*r,s=i+ae[1]*r,ne()}function ne(){return q=W=null,G}return function(){return e=t.apply(this,arguments),G.invert=e.invert&&ie,H()}}function jZ(t){return function(e,r){var n=vs(e),i=vs(r),a=t(n*i);return[a*i*_s(e),a*_s(r)]}}function UZ(t){return function(e,r){var n=L0(e*e+r*r),i=t(n),a=_s(i),s=vs(i);return[u0(e*a,n*s),Sm(n&&r*a/n)]}}var Cxe=jZ(function(t){return L0(2/(1+t))});Cxe.invert=UZ(function(t){return 2*Sm(t/2)});var VZ=jZ(function(t){return(t=MZ(t))&&t/_s(t)});VZ.invert=UZ(function(t){return t});function Axe(){return Exe(VZ).scale(79.4188).clipAngle(180-.001)}function a9(t,e){return[t,e]}a9.invert=a9;var{BufferOp:Ixe,GeoJSONReader:Pxe,GeoJSONWriter:kxe}=rxe;function Mxe(t,e,r){r=r||{};var n=r.units||"kilometers",i=r.steps||8;if(!t)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(t.type){case"GeometryCollection":return vT(t,function(s){var o=bw(s,e,n,i);o&&a.push(o)}),Zd(a);case"FeatureCollection":return Dz(t,function(s){var o=bw(s,e,n,i);o&&Dz(o,function(u){u&&a.push(u)})}),Zd(a)}return bw(t,e,n,i)}function bw(t,e,r,n){var i=t.properties||{},a=t.type==="Feature"?t.geometry:t;if(a.type==="GeometryCollection"){var s=[];return vT(t,function(E){var P=bw(E,e,r,n);P&&s.push(P)}),Zd(s)}var o=Rxe(a),u={type:a.type,coordinates:qZ(a.coordinates,o)},h=new Pxe,f=h.read(u),d=CZ(QO(e,r),"meters"),b=Ixe.bufferOp(f,d,n),v=new kxe;if(b=v.write(b),!$Z(b.coordinates)){var S={type:b.type,coordinates:HZ(b.coordinates,o)};return wm(S,i)}}function $Z(t){return Array.isArray(t[0])?$Z(t[0]):isNaN(t[0])}function qZ(t,e){return typeof t[0]!="object"?e(t):t.map(function(r){return qZ(r,e)})}function HZ(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(r){return HZ(r,e)})}function Rxe(t){var e=Jbe(t).geometry.coordinates,r=[-e[0],-e[1]];return Axe().rotate(r).scale($u)}function o9(t,e={}){let r=0,n=0,i=0;return N0(t,function(a){r+=a[0],n+=a[1],i++},!0),Mh([r/i,n/i],e.properties)}var I2={exports:{}},xw={exports:{}},Oxe=xw.exports,s9;function Nxe(){return s9||(s9=1,(function(t,e){(function(r,n){t.exports=n()})(Oxe,function(){function r(L,N,M,z,B){(function q(W,G,ie,J,H){for(;J>ie;){if(J-ie>600){var ne=J-ie+1,ae=G-ie+1,ue=Math.log(ne),de=.5*Math.exp(2*ue/3),Pe=.5*Math.sqrt(ue*de*(ne-de)/ne)*(ae-ne/2<0?-1:1),me=Math.max(ie,Math.floor(G-ae*de/ne+Pe)),Ee=Math.min(J,Math.floor(G+(ne-ae)*de/ne+Pe));q(W,G,me,Ee,H)}var we=W[G],Ae=ie,ce=J;for(n(W,ie,G),H(W[J],we)>0&&n(W,ie,J);Ae<ce;){for(n(W,Ae,ce),Ae++,ce--;H(W[Ae],we)<0;)Ae++;for(;H(W[ce],we)>0;)ce--}H(W[ie],we)===0?n(W,ie,ce):n(W,++ce,J),ce<=G&&(ie=ce+1),G<=ce&&(J=ce-1)}})(L,N,M||0,z||L.length-1,B||i)}function n(L,N,M){var z=L[N];L[N]=L[M],L[M]=z}function i(L,N){return L<N?-1:L>N?1:0}var a=function(L){L===void 0&&(L=9),this._maxEntries=Math.max(4,L),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(L,N,M){if(!M)return N.indexOf(L);for(var z=0;z<N.length;z++)if(M(L,N[z]))return z;return-1}function o(L,N){u(L,0,L.children.length,N,L)}function u(L,N,M,z,B){B||(B=P(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(var q=N;q<M;q++){var W=L.children[q];h(B,L.leaf?z(W):W)}return B}function h(L,N){return L.minX=Math.min(L.minX,N.minX),L.minY=Math.min(L.minY,N.minY),L.maxX=Math.max(L.maxX,N.maxX),L.maxY=Math.max(L.maxY,N.maxY),L}function f(L,N){return L.minX-N.minX}function d(L,N){return L.minY-N.minY}function b(L){return(L.maxX-L.minX)*(L.maxY-L.minY)}function v(L){return L.maxX-L.minX+(L.maxY-L.minY)}function S(L,N){return L.minX<=N.minX&&L.minY<=N.minY&&N.maxX<=L.maxX&&N.maxY<=L.maxY}function E(L,N){return N.minX<=L.maxX&&N.minY<=L.maxY&&N.maxX>=L.minX&&N.maxY>=L.minY}function P(L){return{children:L,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(L,N,M,z,B){for(var q=[N,M];q.length;)if(!((M=q.pop())-(N=q.pop())<=z)){var W=N+Math.ceil((M-N)/z/2)*z;r(L,W,N,M,B),q.push(N,W,W,M)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(L){var N=this.data,M=[];if(!E(L,N))return M;for(var z=this.toBBox,B=[];N;){for(var q=0;q<N.children.length;q++){var W=N.children[q],G=N.leaf?z(W):W;E(L,G)&&(N.leaf?M.push(W):S(L,G)?this._all(W,M):B.push(W))}N=B.pop()}return M},a.prototype.collides=function(L){var N=this.data;if(!E(L,N))return!1;for(var M=[];N;){for(var z=0;z<N.children.length;z++){var B=N.children[z],q=N.leaf?this.toBBox(B):B;if(E(L,q)){if(N.leaf||S(L,q))return!0;M.push(B)}}N=M.pop()}return!1},a.prototype.load=function(L){if(!L||!L.length)return this;if(L.length<this._minEntries){for(var N=0;N<L.length;N++)this.insert(L[N]);return this}var M=this._build(L.slice(),0,L.length-1,0);if(this.data.children.length)if(this.data.height===M.height)this._splitRoot(this.data,M);else{if(this.data.height<M.height){var z=this.data;this.data=M,M=z}this._insert(M,this.data.height-M.height-1,!0)}else this.data=M;return this},a.prototype.insert=function(L){return L&&this._insert(L,this.data.height-1),this},a.prototype.clear=function(){return this.data=P([]),this},a.prototype.remove=function(L,N){if(!L)return this;for(var M,z,B,q=this.data,W=this.toBBox(L),G=[],ie=[];q||G.length;){if(q||(q=G.pop(),z=G[G.length-1],M=ie.pop(),B=!0),q.leaf){var J=s(L,q.children,N);if(J!==-1)return q.children.splice(J,1),G.push(q),this._condense(G),this}B||q.leaf||!S(q,W)?z?(M++,q=z.children[M],B=!1):q=null:(G.push(q),ie.push(M),M=0,z=q,q=q.children[0])}return this},a.prototype.toBBox=function(L){return L},a.prototype.compareMinX=function(L,N){return L.minX-N.minX},a.prototype.compareMinY=function(L,N){return L.minY-N.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(L){return this.data=L,this},a.prototype._all=function(L,N){for(var M=[];L;)L.leaf?N.push.apply(N,L.children):M.push.apply(M,L.children),L=M.pop();return N},a.prototype._build=function(L,N,M,z){var B,q=M-N+1,W=this._maxEntries;if(q<=W)return o(B=P(L.slice(N,M+1)),this.toBBox),B;z||(z=Math.ceil(Math.log(q)/Math.log(W)),W=Math.ceil(q/Math.pow(W,z-1))),(B=P([])).leaf=!1,B.height=z;var G=Math.ceil(q/W),ie=G*Math.ceil(Math.sqrt(W));k(L,N,M,ie,this.compareMinX);for(var J=N;J<=M;J+=ie){var H=Math.min(J+ie-1,M);k(L,J,H,G,this.compareMinY);for(var ne=J;ne<=H;ne+=G){var ae=Math.min(ne+G-1,H);B.children.push(this._build(L,ne,ae,z-1))}}return o(B,this.toBBox),B},a.prototype._chooseSubtree=function(L,N,M,z){for(;z.push(N),!N.leaf&&z.length-1!==M;){for(var B=1/0,q=1/0,W=void 0,G=0;G<N.children.length;G++){var ie=N.children[G],J=b(ie),H=(ne=L,ae=ie,(Math.max(ae.maxX,ne.maxX)-Math.min(ae.minX,ne.minX))*(Math.max(ae.maxY,ne.maxY)-Math.min(ae.minY,ne.minY))-J);H<q?(q=H,B=J<B?J:B,W=ie):H===q&&J<B&&(B=J,W=ie)}N=W||N.children[0]}var ne,ae;return N},a.prototype._insert=function(L,N,M){var z=M?L:this.toBBox(L),B=[],q=this._chooseSubtree(z,this.data,N,B);for(q.children.push(L),h(q,z);N>=0&&B[N].children.length>this._maxEntries;)this._split(B,N),N--;this._adjustParentBBoxes(z,B,N)},a.prototype._split=function(L,N){var M=L[N],z=M.children.length,B=this._minEntries;this._chooseSplitAxis(M,B,z);var q=this._chooseSplitIndex(M,B,z),W=P(M.children.splice(q,M.children.length-q));W.height=M.height,W.leaf=M.leaf,o(M,this.toBBox),o(W,this.toBBox),N?L[N-1].children.push(W):this._splitRoot(M,W)},a.prototype._splitRoot=function(L,N){this.data=P([L,N]),this.data.height=L.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(L,N,M){for(var z,B,q,W,G,ie,J,H=1/0,ne=1/0,ae=N;ae<=M-N;ae++){var ue=u(L,0,ae,this.toBBox),de=u(L,ae,M,this.toBBox),Pe=(B=ue,q=de,W=void 0,G=void 0,ie=void 0,J=void 0,W=Math.max(B.minX,q.minX),G=Math.max(B.minY,q.minY),ie=Math.min(B.maxX,q.maxX),J=Math.min(B.maxY,q.maxY),Math.max(0,ie-W)*Math.max(0,J-G)),me=b(ue)+b(de);Pe<H?(H=Pe,z=ae,ne=me<ne?me:ne):Pe===H&&me<ne&&(ne=me,z=ae)}return z||M-N},a.prototype._chooseSplitAxis=function(L,N,M){var z=L.leaf?this.compareMinX:f,B=L.leaf?this.compareMinY:d;this._allDistMargin(L,N,M,z)<this._allDistMargin(L,N,M,B)&&L.children.sort(z)},a.prototype._allDistMargin=function(L,N,M,z){L.children.sort(z);for(var B=this.toBBox,q=u(L,0,N,B),W=u(L,M-N,M,B),G=v(q)+v(W),ie=N;ie<M-N;ie++){var J=L.children[ie];h(q,L.leaf?B(J):J),G+=v(q)}for(var H=M-N-1;H>=N;H--){var ne=L.children[H];h(W,L.leaf?B(ne):ne),G+=v(W)}return G},a.prototype._adjustParentBBoxes=function(L,N,M){for(var z=M;z>=0;z--)h(N[z],L)},a.prototype._condense=function(L){for(var N=L.length-1,M=void 0;N>=0;N--)L[N].children.length===0?N>0?(M=L[N-1].children).splice(M.indexOf(L[N]),1):this.clear():o(L[N],this.toBBox)},a})})(xw)),xw.exports}class Lxe{constructor(e=[],r=Dxe){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,i=r[e];for(;e>0;){const a=e-1>>1,s=r[a];if(n(i,s)>=0)break;r[e]=s,e=a}r[e]=i}_down(e){const{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let s=(e<<1)+1,o=r[s];const u=s+1;if(u<this.length&&n(r[u],o)<0&&(s=u,o=r[u]),n(o,a)>=0)break;r[e]=o,e=s}r[e]=a}}function Dxe(t,e){return t<e?-1:t>e?1:0}const Fxe=Object.freeze(Object.defineProperty({__proto__:null,default:Lxe},Symbol.toStringTag,{value:"Module"})),Bxe=hW(Fxe);var E_={exports:{}},oA,l9;function zxe(){return l9||(l9=1,oA=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var u=(i-n)/2,h=0,f=u-1;h<u;f=h++){var d=r[n+h*2+0],b=r[n+h*2+1],v=r[n+f*2+0],S=r[n+f*2+1],E=b>s!=S>s&&a<(v-d)*(s-b)/(S-b)+d;E&&(o=!o)}return o}),oA}var sA,u9;function jxe(){return u9||(u9=1,sA=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var u=i-n,h=0,f=u-1;h<u;f=h++){var d=r[h+n][0],b=r[h+n][1],v=r[f+n][0],S=r[f+n][1],E=b>s!=S>s&&a<(v-d)*(s-b)/(S-b)+d;E&&(o=!o)}return o}),sA}var c9;function Uxe(){if(c9)return E_.exports;c9=1;var t=zxe(),e=jxe();return E_.exports=function(n,i,a,s){return i.length>0&&Array.isArray(i[0])?e(n,i,a,s):t(n,i,a,s)},E_.exports.nested=e,E_.exports.flat=t,E_.exports}var t1={exports:{}},Vxe=t1.exports,h9;function $xe(){return h9||(h9=1,(function(t,e){(function(r,n){n(e)})(Vxe,function(r){const i=33306690738754706e-32;function a(E,P,k,L,N){let M,z,B,q,W=P[0],G=L[0],ie=0,J=0;G>W==G>-W?(M=W,W=P[++ie]):(M=G,G=L[++J]);let H=0;if(ie<E&&J<k)for(G>W==G>-W?(B=M-((z=W+M)-W),W=P[++ie]):(B=M-((z=G+M)-G),G=L[++J]),M=z,B!==0&&(N[H++]=B);ie<E&&J<k;)G>W==G>-W?(B=M-((z=M+W)-(q=z-M))+(W-q),W=P[++ie]):(B=M-((z=M+G)-(q=z-M))+(G-q),G=L[++J]),M=z,B!==0&&(N[H++]=B);for(;ie<E;)B=M-((z=M+W)-(q=z-M))+(W-q),W=P[++ie],M=z,B!==0&&(N[H++]=B);for(;J<k;)B=M-((z=M+G)-(q=z-M))+(G-q),G=L[++J],M=z,B!==0&&(N[H++]=B);return M===0&&H!==0||(N[H++]=M),H}function s(E){return new Float64Array(E)}const o=33306690738754716e-32,u=22204460492503146e-32,h=11093356479670487e-47,f=s(4),d=s(8),b=s(12),v=s(16),S=s(4);r.orient2d=function(E,P,k,L,N,M){const z=(P-M)*(k-N),B=(E-N)*(L-M),q=z-B;if(z===0||B===0||z>0!=B>0)return q;const W=Math.abs(z+B);return Math.abs(q)>=o*W?q:-(function(G,ie,J,H,ne,ae,ue){let de,Pe,me,Ee,we,Ae,ce,xe,_e,Me,Re,He,Fe,tt,Ze,Qe,Ie,Lt;const at=G-ne,Ve=J-ne,nr=ie-ae,Yt=H-ae;we=(Ze=(xe=at-(ce=(Ae=134217729*at)-(Ae-at)))*(Me=Yt-(_e=(Ae=134217729*Yt)-(Ae-Yt)))-((tt=at*Yt)-ce*_e-xe*_e-ce*Me))-(Re=Ze-(Ie=(xe=nr-(ce=(Ae=134217729*nr)-(Ae-nr)))*(Me=Ve-(_e=(Ae=134217729*Ve)-(Ae-Ve)))-((Qe=nr*Ve)-ce*_e-xe*_e-ce*Me))),f[0]=Ze-(Re+we)+(we-Ie),we=(Fe=tt-((He=tt+Re)-(we=He-tt))+(Re-we))-(Re=Fe-Qe),f[1]=Fe-(Re+we)+(we-Qe),we=(Lt=He+Re)-He,f[2]=He-(Lt-we)+(Re-we),f[3]=Lt;let yr=(function(Mr,Pr){let ar=Pr[0];for(let fr=1;fr<Mr;fr++)ar+=Pr[fr];return ar})(4,f),mt=u*ue;if(yr>=mt||-yr>=mt||(de=G-(at+(we=G-at))+(we-ne),me=J-(Ve+(we=J-Ve))+(we-ne),Pe=ie-(nr+(we=ie-nr))+(we-ae),Ee=H-(Yt+(we=H-Yt))+(we-ae),de===0&&Pe===0&&me===0&&Ee===0)||(mt=h*ue+i*Math.abs(yr),(yr+=at*Ee+Yt*de-(nr*me+Ve*Pe))>=mt||-yr>=mt))return yr;we=(Ze=(xe=de-(ce=(Ae=134217729*de)-(Ae-de)))*(Me=Yt-(_e=(Ae=134217729*Yt)-(Ae-Yt)))-((tt=de*Yt)-ce*_e-xe*_e-ce*Me))-(Re=Ze-(Ie=(xe=Pe-(ce=(Ae=134217729*Pe)-(Ae-Pe)))*(Me=Ve-(_e=(Ae=134217729*Ve)-(Ae-Ve)))-((Qe=Pe*Ve)-ce*_e-xe*_e-ce*Me))),S[0]=Ze-(Re+we)+(we-Ie),we=(Fe=tt-((He=tt+Re)-(we=He-tt))+(Re-we))-(Re=Fe-Qe),S[1]=Fe-(Re+we)+(we-Qe),we=(Lt=He+Re)-He,S[2]=He-(Lt-we)+(Re-we),S[3]=Lt;const br=a(4,f,4,S,d);we=(Ze=(xe=at-(ce=(Ae=134217729*at)-(Ae-at)))*(Me=Ee-(_e=(Ae=134217729*Ee)-(Ae-Ee)))-((tt=at*Ee)-ce*_e-xe*_e-ce*Me))-(Re=Ze-(Ie=(xe=nr-(ce=(Ae=134217729*nr)-(Ae-nr)))*(Me=me-(_e=(Ae=134217729*me)-(Ae-me)))-((Qe=nr*me)-ce*_e-xe*_e-ce*Me))),S[0]=Ze-(Re+we)+(we-Ie),we=(Fe=tt-((He=tt+Re)-(we=He-tt))+(Re-we))-(Re=Fe-Qe),S[1]=Fe-(Re+we)+(we-Qe),we=(Lt=He+Re)-He,S[2]=He-(Lt-we)+(Re-we),S[3]=Lt;const Tr=a(br,d,4,S,b);we=(Ze=(xe=de-(ce=(Ae=134217729*de)-(Ae-de)))*(Me=Ee-(_e=(Ae=134217729*Ee)-(Ae-Ee)))-((tt=de*Ee)-ce*_e-xe*_e-ce*Me))-(Re=Ze-(Ie=(xe=Pe-(ce=(Ae=134217729*Pe)-(Ae-Pe)))*(Me=me-(_e=(Ae=134217729*me)-(Ae-me)))-((Qe=Pe*me)-ce*_e-xe*_e-ce*Me))),S[0]=Ze-(Re+we)+(we-Ie),we=(Fe=tt-((He=tt+Re)-(we=He-tt))+(Re-we))-(Re=Fe-Qe),S[1]=Fe-(Re+we)+(we-Qe),we=(Lt=He+Re)-He,S[2]=He-(Lt-we)+(Re-we),S[3]=Lt;const mr=a(Tr,b,4,S,v);return v[mr-1]})(E,P,k,L,N,M,W)},r.orient2dfast=function(E,P,k,L,N,M){return(P-M)*(k-N)-(E-N)*(L-M)},Object.defineProperty(r,"__esModule",{value:!0})})})(t1,t1.exports)),t1.exports}var f9;function qxe(){if(f9)return I2.exports;f9=1;var t=Nxe(),e=Bxe,r=Uxe(),n=$xe().orient2d;e.default&&(e=e.default),I2.exports=i,I2.exports.default=i;function i(M,z,B){z=Math.max(0,z===void 0?2:z),B=B||0;var q=v(M),W=new t(16);W.toBBox=function(ce){return{minX:ce[0],minY:ce[1],maxX:ce[0],maxY:ce[1]}},W.compareMinX=function(ce,xe){return ce[0]-xe[0]},W.compareMinY=function(ce,xe){return ce[1]-xe[1]},W.load(M);for(var G=[],ie=0,J;ie<q.length;ie++){var H=q[ie];W.remove(H),J=S(H,J),G.push(J)}var ne=new t(16);for(ie=0;ie<G.length;ie++)ne.insert(b(G[ie]));for(var ae=z*z,ue=B*B;G.length;){var de=G.shift(),Pe=de.p,me=de.next.p,Ee=E(Pe,me);if(!(Ee<ue)){var we=Ee/ae;H=a(W,de.prev.p,Pe,me,de.next.next.p,we,ne),H&&Math.min(E(H,Pe),E(H,me))<=we&&(G.push(de),G.push(S(H,de)),W.remove(H),ne.remove(de),ne.insert(b(de)),ne.insert(b(de.next)))}}de=J;var Ae=[];do Ae.push(de.p),de=de.next;while(de!==J);return Ae.push(de.p),Ae}function a(M,z,B,q,W,G,ie){for(var J=new e([],s),H=M.data;H;){for(var ne=0;ne<H.children.length;ne++){var ae=H.children[ne],ue=H.leaf?P(ae,B,q):o(B,q,ae);ue>G||J.push({node:ae,dist:ue})}for(;J.length&&!J.peek().node.children;){var de=J.pop(),Pe=de.node,me=P(Pe,z,B),Ee=P(Pe,q,W);if(de.dist<me&&de.dist<Ee&&h(B,Pe,ie)&&h(q,Pe,ie))return Pe}H=J.pop(),H&&(H=H.node)}return null}function s(M,z){return M.dist-z.dist}function o(M,z,B){if(u(M,B)||u(z,B))return 0;var q=k(M[0],M[1],z[0],z[1],B.minX,B.minY,B.maxX,B.minY);if(q===0)return 0;var W=k(M[0],M[1],z[0],z[1],B.minX,B.minY,B.minX,B.maxY);if(W===0)return 0;var G=k(M[0],M[1],z[0],z[1],B.maxX,B.minY,B.maxX,B.maxY);if(G===0)return 0;var ie=k(M[0],M[1],z[0],z[1],B.minX,B.maxY,B.maxX,B.maxY);return ie===0?0:Math.min(q,W,G,ie)}function u(M,z){return M[0]>=z.minX&&M[0]<=z.maxX&&M[1]>=z.minY&&M[1]<=z.maxY}function h(M,z,B){for(var q=Math.min(M[0],z[0]),W=Math.min(M[1],z[1]),G=Math.max(M[0],z[0]),ie=Math.max(M[1],z[1]),J=B.search({minX:q,minY:W,maxX:G,maxY:ie}),H=0;H<J.length;H++)if(d(J[H].p,J[H].next.p,M,z))return!1;return!0}function f(M,z,B){return n(M[0],M[1],z[0],z[1],B[0],B[1])}function d(M,z,B,q){return M!==q&&z!==B&&f(M,z,B)>0!=f(M,z,q)>0&&f(B,q,M)>0!=f(B,q,z)>0}function b(M){var z=M.p,B=M.next.p;return M.minX=Math.min(z[0],B[0]),M.minY=Math.min(z[1],B[1]),M.maxX=Math.max(z[0],B[0]),M.maxY=Math.max(z[1],B[1]),M}function v(M){for(var z=M[0],B=M[0],q=M[0],W=M[0],G=0;G<M.length;G++){var ie=M[G];ie[0]<z[0]&&(z=ie),ie[0]>q[0]&&(q=ie),ie[1]<B[1]&&(B=ie),ie[1]>W[1]&&(W=ie)}var J=[z,B,q,W],H=J.slice();for(G=0;G<M.length;G++)r(M[G],J)||H.push(M[G]);return N(H)}function S(M,z){var B={p:M,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return z?(B.next=z.next,B.prev=z,z.next.prev=B,z.next=B):(B.prev=B,B.next=B),B}function E(M,z){var B=M[0]-z[0],q=M[1]-z[1];return B*B+q*q}function P(M,z,B){var q=z[0],W=z[1],G=B[0]-q,ie=B[1]-W;if(G!==0||ie!==0){var J=((M[0]-q)*G+(M[1]-W)*ie)/(G*G+ie*ie);J>1?(q=B[0],W=B[1]):J>0&&(q+=G*J,W+=ie*J)}return G=M[0]-q,ie=M[1]-W,G*G+ie*ie}function k(M,z,B,q,W,G,ie,J){var H=B-M,ne=q-z,ae=ie-W,ue=J-G,de=M-W,Pe=z-G,me=H*H+ne*ne,Ee=H*ae+ne*ue,we=ae*ae+ue*ue,Ae=H*de+ne*Pe,ce=ae*de+ue*Pe,xe=me*we-Ee*Ee,_e,Me,Re,He,Fe=xe,tt=xe;xe===0?(Me=0,Fe=1,He=ce,tt=we):(Me=Ee*ce-we*Ae,He=me*ce-Ee*Ae,Me<0?(Me=0,He=ce,tt=we):Me>Fe&&(Me=Fe,He=ce+Ee,tt=we)),He<0?(He=0,-Ae<0?Me=0:-Ae>me?Me=Fe:(Me=-Ae,Fe=me)):He>tt&&(He=tt,-Ae+Ee<0?Me=0:-Ae+Ee>me?Me=Fe:(Me=-Ae+Ee,Fe=me)),_e=Me===0?0:Me/Fe,Re=He===0?0:He/tt;var Ze=(1-_e)*M+_e*B,Qe=(1-_e)*z+_e*q,Ie=(1-Re)*W+Re*ie,Lt=(1-Re)*G+Re*J,at=Ie-Ze,Ve=Lt-Qe;return at*at+Ve*Ve}function L(M,z){return M[0]===z[0]?M[1]-z[1]:M[0]-z[0]}function N(M){M.sort(L);for(var z=[],B=0;B<M.length;B++){for(;z.length>=2&&f(z[z.length-2],z[z.length-1],M[B])<=0;)z.pop();z.push(M[B])}for(var q=[],W=M.length-1;W>=0;W--){for(;q.length>=2&&f(q[q.length-2],q[q.length-1],M[W])<=0;)q.pop();q.push(M[W])}return q.pop(),z.pop(),z.concat(q)}return I2.exports}var Hxe=qxe();const Wxe=ad(Hxe);function Gxe(t,e={}){e.concavity=e.concavity||1/0;const r=[];if(N0(t,i=>{r.push([i[0],i[1]])}),!r.length)return null;const n=Wxe(r,e.concavity);return n.length>3?mT([n]):null}function nN(t,e={}){switch(IZ(t)){case"Point":return Mh(rg(t),e.properties);case"Polygon":var r=[];N0(t,function(M){r.push(M)});var n=o9(t,{properties:e.properties}),i=n.geometry.coordinates,a=0,s=0,o=0,u,h,f,d,b,v,S,E,P=r.map(function(M){return[M[0]-i[0],M[1]-i[1]]});for(u=0;u<r.length-1;u++)h=P[u],d=h[0],v=h[1],f=P[u+1],b=f[0],S=f[1],E=d*S-b*v,o+=E,a+=(d+b)*E,s+=(v+S)*E;if(o===0)return n;var k=o*.5,L=1/(6*k);return Mh([i[0]+L*a,i[1]+L*s],e.properties);default:var N=Gxe(t);return N?nN(N,{properties:e.properties}):o9(t,{properties:e.properties})}}function WZ(t,e,r={}){const n=r.steps||64,i=r.properties?r.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},a=[];for(let s=0;s<n;s++)a.push(l0(t,e,s*-360/n,r).geometry.coordinates);return a.push(a[0]),mT([a],i)}function Xxe(t){return t}function Yxe(t){if(t==null)return Xxe;var e,r,n=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(o,u){u||(e=r=0);var h=2,f=o.length,d=new Array(f);for(d[0]=(e+=o[0])*n+a,d[1]=(r+=o[1])*i+s;h<f;)d[h]=o[h],++h;return d}}function Zxe(t,e){for(var r,n=t.length,i=n-e;i<--n;)r=t[i],t[i++]=t[n],t[n]=r}function Kxe(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return d9(t,r)})}:d9(t,e)}function d9(t,e){var r=e.id,n=e.bbox,i=e.properties==null?{}:e.properties,a=Jxe(t,e);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function Jxe(t,e){var r=Yxe(t.transform),n=t.arcs;function i(f,d){d.length&&d.pop();for(var b=n[f<0?~f:f],v=0,S=b.length;v<S;++v)d.push(r(b[v],v));f<0&&Zxe(d,S)}function a(f){return r(f)}function s(f){for(var d=[],b=0,v=f.length;b<v;++b)i(f[b],d);return d.length<2&&d.push(d[0]),d}function o(f){for(var d=s(f);d.length<4;)d.push(d[0]);return d}function u(f){return f.map(o)}function h(f){var d=f.type,b;switch(d){case"GeometryCollection":return{type:d,geometries:f.geometries.map(h)};case"Point":b=a(f.coordinates);break;case"MultiPoint":b=f.coordinates.map(a);break;case"LineString":b=s(f.arcs);break;case"MultiLineString":b=f.arcs.map(s);break;case"Polygon":b=u(f.arcs);break;case"MultiPolygon":b=f.arcs.map(u);break;default:return null}return{type:d,coordinates:b}}return h(e)}function hb(t,e={}){return Pbe(t,(r,n)=>{const i=n.geometry.coordinates;return r+yT(i[0],i[1],e)},0)}function Qxe(t,e,r,n,i={}){const a=i.steps||64,s=p9(r),o=p9(n),u=!Array.isArray(t)&&t.type==="Feature"?t.properties:{};if(s===o)return mu(WZ(t,e,i).geometry.coordinates[0],u);const h=s,f=s<o?o:o+360;let d=h;const b=[];let v=0;const S=(f-h)/a;for(;d<=f;)b.push(l0(t,e,d,i).geometry.coordinates),v++,d=h+v*S;return mu(b,u)}function p9(t){let e=t%360;return e<0&&(e+=360),e}function e2e(t,e,r,n){if(n=n||{},!eN(n))throw new Error("options is invalid");var i,a=[];if(t.type==="Feature")i=t.geometry.coordinates;else if(t.type==="LineString")i=t.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=i.length,o=0,u,h,f,d=0;d<i.length&&!(e>=o&&d===i.length-1);d++){if(o>e&&a.length===0){if(u=e-o,!u)return a.push(i[d]),mu(a);h=lb(i[d],i[d-1])-180,f=l0(i[d],u,h,n),a.push(f.geometry.coordinates)}if(o>=r)return u=r-o,u?(h=lb(i[d],i[d-1])-180,f=l0(i[d],u,h,n),a.push(f.geometry.coordinates),mu(a)):(a.push(i[d]),mu(a));if(o>=e&&a.push(i[d]),d===i.length-1)return mu(a);o+=yT(i[d],i[d+1],n)}if(o<e&&i.length===s)throw new Error("Start position is beyond line");var b=i[i.length-1];return mu([b,b])}function t2e(t,e,r){if(r=r||{},!eN(r))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var a=[];return tN(t,function(s){i&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),r2e(s,e,n,function(o){a.push(o)})}),Zd(a)}function r2e(t,e,r,n){var i=hb(t,{units:r});if(i<=e)return n(t);var a=i/e;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var o=e2e(t,e*s,e*(s+1),{units:r});n(o,s)}}function vS(t){var e=t[0],r=t[1];return[r[0]-e[0],r[1]-e[1]]}function Mk(t,e){return t[0]*e[1]-e[0]*t[1]}function n2e(t,e){return[t[0]+e[0],t[1]+e[1]]}function i2e(t,e){return[t[0]-e[0],t[1]-e[1]]}function a2e(t,e){return[t*e[0],t*e[1]]}function o2e(t,e){var r=t[0],n=vS(t),i=e[0],a=vS(e),s=Mk(n,a),o=i2e(i,r),u=Mk(o,a),h=u/s,f=n2e(r,a2e(h,n));return f}function s2e(t,e){var r=vS(t),n=vS(e);return Mk(r,n)===0}function l2e(t,e){return s2e(t,e)?!1:o2e(t,e)}function u2e(t,e,r){if(r=r||{},!eN(r))throw new Error("options is invalid");var n=r.units;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var i=IZ(t),a=t.properties;switch(i){case"LineString":return g9(t,e,n);case"MultiLineString":var s=[];return tN(t,function(o){s.push(g9(o,e,n).geometry.coordinates)}),Sbe(s,a);default:throw new Error("geometry "+i+" is not supported")}}function g9(t,e,r){var n=[],i=Ebe(e,r),a=AZ(t),s=[];return a.forEach(function(o,u){if(u!==a.length-1){var h=c2e(o,a[u+1],i);if(n.push(h),u>0){var f=n[u-1],d=l2e(h,f);d!==!1&&(f[1]=d,h[0]=d),s.push(f[0]),u===a.length-2&&(s.push(h[0]),s.push(h[1]))}a.length===2&&(s.push(h[0]),s.push(h[1]))}}),mu(s,t.properties)}function c2e(t,e,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+r*(e[1]-t[1])/n,a=e[0]+r*(e[1]-t[1])/n,s=t[1]+r*(t[0]-e[0])/n,o=e[1]+r*(t[0]-e[0])/n;return[[i,s],[a,o]]}function h2e(t){const r=window.getComputedStyle(t,null).getPropertyValue("transform");let n=0;if(r!=="none"){const i=r.split("(")[1].split(")")[0].split(","),a=parseFloat(i[0]),s=parseFloat(i[1]);n=Math.round(Math.atan2(s,a)*(180/Math.PI))}return n<0?n+360:n}function P2(t,e,r){const n=getComputedStyle(t),i=[e[0]-r[0],e[1]-r[1]],a=new DOMMatrixReadOnly(n.transform);return[i[0]*a.a+i[1]*a.c+a.e+r[0],i[0]*a.b+i[1]*a.d+a.f+r[1]]}const m9=10;function k2(t,e){const r=e.unproject(t),n=e.unproject([t[0]+m9,t[1]]),i=r.distanceTo(n);return m9/i}function Rk(t){const e=YE({mapId:t.mapId,watch:{layers:!1,viewport:!0}}),r=ee.useRef(null),n=ee.useRef(null),i=ee.useRef(null),a=ee.useRef(document.querySelector(".mapContainer")),s=pa({mapId:t.mapId});ee.useEffect(()=>{if(!e?.viewport?.zoom||!s.map)return;const h=Math.round(s.map.map._container.clientWidth/2),f=Math.round(s.map.map._container.clientHeight/2);if(!t.options.scale){const d=1/k2([h,f],s.map.map);t.setOptions(b=>({...b,scale:[d,d]}))}if(!t.options.center){const d=s.map.map.unproject([h,f]);t.setOptions(b=>({...b,center:[d.lng,d.lat]}))}},[s.map,e.viewport?.zoom]),ee.useEffect(()=>{if(!s.map)return;s.map.map.setPitch(0);const h=s.map.map.getMaxPitch();return s.map.map.setMaxPitch(0),()=>{s.map?.map.setMaxPitch(h)}},[s.map]);const o=ee.useMemo(()=>t.options.orientation==="portrait"?[t.options.width/2,t.options.height/2]:[t.options.height/2,t.options.width/2],[t.options.orientation,t.options.width,t.options.height]),u=ee.useMemo(()=>{if(!s.map||!t.options.scale)return"none";const h=s.map.map.project(t.options.center),f=h.x,d=h.y,b=t.options.scale[0]*k2([f,d],s.map.map),v=e?.viewport?.bearing?e.viewport?.bearing:0,S=`translate(${Math.floor(h.x-o[0])}px,${Math.floor(h.y-o[1])}px) rotate(${t.options.rotate-v}deg) scale(${b},${b})`;return r.current&&(r.current.style.transform=S),S},[s.map,e.viewport,t.options.scale,t.options.rotate,t.options.center,o]);return ee.useEffect(()=>{i.current?.updateTarget()},[u]),ee.useEffect(()=>{if(!s.map||!t.options.center||!t.options.fixedScale||typeof t.options.fixedScale<"u"&&n.current===t.options.fixedScale)return;n.current=t.options.fixedScale;const h=Mh(t.options.center),f=t.options.fixedScale*(t.options.width/1e3),v=l0(h,f,90,{units:"meters"}),S=s.map.map.project(h.geometry.coordinates),E=s.map.map.project(v.geometry.coordinates),P=Math.round(E.x-S.x)/t.options.width*(1/k2([S.x,S.y],s.map.map));t.setOptions(k=>({...k,scale:[P,P]}))},[s.map,t.options.width,t.options.center,t.options.fixedScale]),ee.useEffect(()=>{if(r.current&&s.map){let h=t.options.width,f=t.options.height;t.options.orientation==="portrait"?(r.current.style.width=t.options.width+"px",r.current.style.height=t.options.height+"px"):(r.current.style.width=t.options.height+"px",r.current.style.height=t.options.width+"px",h=t.options.height,f=t.options.width),i.current?.updateTarget();const d=s.map.map.unproject(P2(r.current,[0,0],o)),b=s.map.map.unproject(P2(r.current,[h,0],o)),v=s.map.map.unproject(P2(r.current,[0,f],o)),S=s.map.map.unproject(P2(r.current,[h,f],o)),E={type:"Feature",bbox:[d.lng,d.lat,S.lng,S.lat],geometry:{type:"Polygon",coordinates:[[[d.lng,d.lat],[b.lng,b.lat],[S.lng,S.lat],[v.lng,v.lat],[d.lng,d.lat]]]},properties:{bearing:h2e(r.current)}};t.geojsonRef.current=E}},[s,u,t.options.orientation,t.geojsonRef,e,r.current,o]),a.current?q_.createPortal(Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"target",ref:r,style:{transform:u,transformOrigin:"center center"}}),Z.jsx(wbe,{ref:i,target:r,container:null,origin:!0,keepRatio:!0,draggable:!0,onDrag:h=>{if(s.map){let f=h.transform.split("translate(");f=f[1].split("px)")[0].split("px, ");const d=s.map?.map.unproject([parseInt(f[0])+o[0],parseInt(f[1])+o[1]]);t.setOptions(b=>({...b,center:[d.lng,d.lat]}))}},scalable:!t.options.fixedScale,onScale:h=>{if(s.map){let f=h.drag.transform.split("scale(");f=f[1].split(")")[0].split(", ");const d=s.map.map.project(t.options.center),b=d.x,v=d.y,S=parseFloat(f[0])*(1/k2([b,v],s.map.map));t.setOptions(E=>({...E,scale:[S,S]}))}},rotatable:!0,onRotate:h=>{if(s.map&&e.viewport){const d=h.drag.transform.split("rotate(")[1].split("deg)")[0],b=e?.viewport?.bearing?e.viewport.bearing:0;t.setOptions(v=>({...v,rotate:parseFloat(d)+b}))}}})]}),a.current):Z.jsx(Z.Fragment,{})}try{Rk.displayName="PdfPreview",Rk.__docgenInfo={description:"PdfPreview component renders a transformable (drag, scale, rotate) preview of the desired export or print content",displayName:"PdfPreview",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojsonRef:{defaultValue:null,description:"Polygon GeoJson Feature representing the printing area",name:"geojsonRef",required:!0,type:{name:"MutableRefObject<Feature<Geometry, GeoJsonProperties> | undefined>"}},options:{defaultValue:null,description:"a state variable containing the PDF previews current state",name:"options",required:!0,type:{name:"PdfPreviewOptions"}},setOptions:{defaultValue:null,description:"setter function to update the current PDF preview state",name:"setOptions",required:!0,type:{name:"(arg1: (val: PdfPreviewOptions) => PdfPreviewOptions) => void"}}}}}catch{}const f2e=[{value:0,label:"free scale"},{value:250,label:"1/250"},{value:500,label:"1/500"},{value:750,label:"1/750"},{value:1e3,label:"1/1000"},{value:1500,label:"1/1500"},{value:2e3,label:"1/2000"},{value:1e4,label:"1/10000"},{value:1e5,label:"1/100000"}],d2e=[{value:"72dpi",label:"Draft (72dpi)"},{value:"150dpi",label:"Medium (150dpi)"},{value:"300dpi",label:"High (300dpi)"}];function Ok(t){const[e,r]=ee.useState(!1),n=ee.useContext(jX),i=pa({mapId:t.mapId}),a=zX({mapId:t.mapId}),s=ee.useCallback(()=>{if(i.map&&a.createExport&&n.template&&n.format&&n.options?.orientation&&n.geojsonRef?.current?.bbox&&n.geojsonRef?.current){r(!0);const h=ah(n.geojsonRef.current);a.createExport({width:n.template.width,height:n.template.height,bbox:h,bboxUnrotated:n.geojsonRef.current.bbox,bearing:n.geojsonRef.current?.properties?.bearing||0,format:n.format.toLowerCase(),orientation:n.options.orientation}).then(f=>f.createPdf()).then(f=>(typeof t.onCreatePdf=="function"&&(f.formData=new FormData(document.getElementById("createPdfFormID")),t.onCreatePdf(f)),r(!1),f.downloadPdf())).catch(f=>{console.log(f),r(!1)})}},[i.map,n]),o=Gb("(max-width: 950px)"),u=ee.useMemo(()=>({margin:o?"1px 0 8px 0 ":"5px 0 15px 0 ",...t?.formControlStyles?{...t.formControlStyles}:{}}),[o,t.formControlStyles]);return Z.jsx(Z.Fragment,{children:Z.jsxs("form",{id:"createPdfFormID",children:[Z.jsxs(Kc,{fullWidth:!0,sx:u,children:[Z.jsx(ra,{variant:"contained",className:"createPdfButton",onClick:s,disabled:e,sx:{marginBottom:"16px"},children:"create PDF"}),e&&Z.jsx(KE,{size:24,sx:{color:"primary.main",position:"absolute",top:"25%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),Z.jsxs(Kc,{fullWidth:!0,sx:u,children:[Z.jsx(qp,{sx:{marginTop:"3px"},id:"format-select-label",children:"Format"}),Z.jsx(Hp,{labelId:"format-select-label",id:"format-select",label:"Format",value:n.format,onChange:h=>{n.setFormat?.(h.target.value)},children:Object.keys(bv).map(h=>Z.jsx(im,{value:h,children:h},h))})]}),Z.jsxs(Kc,{fullWidth:!0,sx:u,children:[Z.jsx(LG,{id:"orientation-radio-buttons-group-label",children:"Orientation"}),Z.jsxs(Ape,{row:!0,"aria-labelledby":"orientation-radio-buttons-group-label",name:"orientation-radio-buttons-group",value:n.options?.orientation,onChange:h=>{n.setOptions&&n.setOptions(f=>({...f,orientation:h.target.value}))},children:[Z.jsx(jP,{value:"portrait",control:Z.jsx(E8,{}),label:"Portrait"}),Z.jsx(jP,{value:"landscape",control:Z.jsx(E8,{}),label:"Landscape"})]})]}),Z.jsxs(Kc,{fullWidth:!0,sx:u,children:[Z.jsx(qp,{id:"quality-select-label",children:"Quality"}),Z.jsx(Hp,{labelId:"quality-select-label",id:"quality-select",label:"Quality",value:n.quality,onChange:h=>{n.setQuality?.(h.target.value)},children:d2e.map(h=>Z.jsx(im,{value:h.value,children:h.label},h.value))})]}),Z.jsxs(Kc,{fullWidth:!0,sx:u,children:[Z.jsx(qp,{id:"scale-select-label",children:"Scale"}),Z.jsx(Hp,{labelId:"scale-select-label",id:"scale-select",label:"Scale",value:n?.options?.fixedScale,onChange:h=>{n.setOptions?.(f=>({...f,fixedScale:h.target.value}))},children:f2e.map((h,f)=>Z.jsx(im,{value:h.value,children:h.label},f))})]}),t?.additionalFields,n.options&&n.setOptions&&Z.jsx(Rk,{options:n.options,setOptions:n.setOptions,geojsonRef:n.geojsonRef})]})})}try{Ok.displayName="PdfForm",Ok.__docgenInfo={description:"",displayName:"PdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}const y9=t=>Z.jsx(Z.Fragment,{children:Z.jsx(ek,{children:Z.jsx(Ok,{...t})})});try{y9.displayName="MlCreatePdfForm",y9.__docgenInfo={description:"Create PDF Form Component",displayName:"MlCreatePdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}var ww={exports:{}},p2e=ww.exports,v9;function g2e(){return v9||(v9=1,(function(t,e){(function(r,n){t.exports=n()})(p2e,(function(){var r=function(K,pe){var Ye={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Et={on:function(Nt,Qt,Gr){if(Ye[Nt]===void 0)throw new Error("Invalid event type: "+Nt);Ye[Nt].push({selector:Qt,fn:Gr})},render:function(Nt){pe.store.featureChanged(Nt)}},Ut=function(Nt,Qt){for(var Gr=Ye[Nt],on=Gr.length;on--;){var en=Gr[on];if(en.selector(Qt)){en.fn.call(Et,Qt)||pe.store.render(),pe.ui.updateMapClasses();break}}};return K.start.call(Et),{render:K.render,stop:function(){K.stop&&K.stop()},trash:function(){K.trash&&(K.trash(),pe.store.render())},combineFeatures:function(){K.combineFeatures&&K.combineFeatures()},uncombineFeatures:function(){K.uncombineFeatures&&K.uncombineFeatures()},drag:function(Nt){Ut("drag",Nt)},click:function(Nt){Ut("click",Nt)},mousemove:function(Nt){Ut("mousemove",Nt)},mousedown:function(Nt){Ut("mousedown",Nt)},mouseup:function(Nt){Ut("mouseup",Nt)},mouseout:function(Nt){Ut("mouseout",Nt)},keydown:function(Nt){Ut("keydown",Nt)},keyup:function(Nt){Ut("keyup",Nt)},touchstart:function(Nt){Ut("touchstart",Nt)},touchmove:function(Nt){Ut("touchmove",Nt)},touchend:function(Nt){Ut("touchend",Nt)},tap:function(Nt){Ut("tap",Nt)}}};function n(K){return K&&K.__esModule&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K}function i(K){if(K.__esModule)return K;var pe=K.default;if(typeof pe=="function"){var Ye=function Et(){if(this instanceof Et){var Ut=[null];Ut.push.apply(Ut,arguments);var Nt=Function.bind.apply(pe,Ut);return new Nt}return pe.apply(this,arguments)};Ye.prototype=pe.prototype}else Ye={};return Object.defineProperty(Ye,"__esModule",{value:!0}),Object.keys(K).forEach((function(Et){var Ut=Object.getOwnPropertyDescriptor(K,Et);Object.defineProperty(Ye,Et,Ut.get?Ut:{enumerable:!0,get:function(){return K[Et]}})})),Ye}var a={},s={RADIUS:6378137},o=s;function u(K){var pe=0;if(K&&K.length>0){pe+=Math.abs(h(K[0]));for(var Ye=1;Ye<K.length;Ye++)pe-=Math.abs(h(K[Ye]))}return pe}function h(K){var pe,Ye,Et,Ut,Nt,Qt,Gr=0,on=K.length;if(on>2){for(Qt=0;Qt<on;Qt++)Qt===on-2?(Et=on-2,Ut=on-1,Nt=0):Qt===on-1?(Et=on-1,Ut=0,Nt=1):(Et=Qt,Ut=Qt+1,Nt=Qt+2),pe=K[Et],Ye=K[Ut],Gr+=(f(K[Nt][0])-f(pe[0]))*Math.sin(f(Ye[1]));Gr=Gr*o.RADIUS*o.RADIUS/2}return Gr}function f(K){return K*Math.PI/180}a.geometry=function K(pe){var Ye,Et=0;switch(pe.type){case"Polygon":return u(pe.coordinates);case"MultiPolygon":for(Ye=0;Ye<pe.coordinates.length;Ye++)Et+=u(pe.coordinates[Ye]);return Et;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Ye=0;Ye<pe.geometries.length;Ye++)Et+=K(pe.geometries[Ye]);return Et}},a.ring=h;var d={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},v={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},S={POLYGON:"polygon",LINE:"line_string",POINT:"point"},E={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},P={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},k={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},L={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},N={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},M={ACTIVE:"true",INACTIVE:"false"},z=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],B=-85,q=Object.freeze({__proto__:null,classes:d,sources:b,cursors:v,types:S,geojsonTypes:E,modes:P,events:k,updateActions:L,meta:N,activeStates:M,interactions:z,LAT_MIN:-90,LAT_RENDERED_MIN:B,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),W={Point:0,LineString:1,MultiLineString:1,Polygon:2};function G(K,pe){var Ye=W[K.geometry.type]-W[pe.geometry.type];return Ye===0&&K.geometry.type===E.POLYGON?K.area-pe.area:Ye}function ie(K){return K.map((function(pe){return pe.geometry.type===E.POLYGON&&(pe.area=a.geometry({type:E.FEATURE,property:{},geometry:pe.geometry})),pe})).sort(G).map((function(pe){return delete pe.area,pe}))}function J(K,pe){return pe===void 0&&(pe=0),[[K.point.x-pe,K.point.y-pe],[K.point.x+pe,K.point.y+pe]]}function H(K){if(this._items={},this._nums={},this._length=K?K.length:0,K)for(var pe=0,Ye=K.length;pe<Ye;pe++)this.add(K[pe]),K[pe]!==void 0&&(typeof K[pe]=="string"?this._items[K[pe]]=pe:this._nums[K[pe]]=pe)}H.prototype.add=function(K){return this.has(K)||(this._length++,typeof K=="string"?this._items[K]=this._length:this._nums[K]=this._length),this},H.prototype.delete=function(K){return this.has(K)===!1||(this._length--,delete this._items[K],delete this._nums[K]),this},H.prototype.has=function(K){return(typeof K=="string"||typeof K=="number")&&(this._items[K]!==void 0||this._nums[K]!==void 0)},H.prototype.values=function(){var K=this,pe=[];return Object.keys(this._items).forEach((function(Ye){pe.push({k:Ye,v:K._items[Ye]})})),Object.keys(this._nums).forEach((function(Ye){pe.push({k:JSON.parse(Ye),v:K._nums[Ye]})})),pe.sort((function(Ye,Et){return Ye.v-Et.v})).map((function(Ye){return Ye.k}))},H.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ne=[N.FEATURE,N.MIDPOINT,N.VERTEX],ae={click:function(K,pe,Ye){return ue(K,pe,Ye,Ye.options.clickBuffer)},touch:function(K,pe,Ye){return ue(K,pe,Ye,Ye.options.touchBuffer)}};function ue(K,pe,Ye,Et){if(Ye.map===null)return[];var Ut=K?J(K,Et):pe,Nt={};Ye.options.styles&&(Nt.layers=Ye.options.styles.map((function(en){return en.id})).filter((function(en){return Ye.map.getLayer(en)!=null})));var Qt=Ye.map.queryRenderedFeatures(Ut,Nt).filter((function(en){return ne.indexOf(en.properties.meta)!==-1})),Gr=new H,on=[];return Qt.forEach((function(en){var hn=en.properties.id;Gr.has(hn)||(Gr.add(hn),on.push(en))})),ie(on)}function de(K,pe){var Ye=ae.click(K,null,pe),Et={mouse:v.NONE};return Ye[0]&&(Et.mouse=Ye[0].properties.active===M.ACTIVE?v.MOVE:v.POINTER,Et.feature=Ye[0].properties.meta),pe.events.currentModeName().indexOf("draw")!==-1&&(Et.mouse=v.ADD),pe.ui.queueMapClasses(Et),pe.ui.updateMapClasses(),Ye[0]}function Pe(K,pe){var Ye=K.x-pe.x,Et=K.y-pe.y;return Math.sqrt(Ye*Ye+Et*Et)}function me(K,pe,Ye){Ye===void 0&&(Ye={});var Et=Ye.fineTolerance!=null?Ye.fineTolerance:4,Ut=Ye.grossTolerance!=null?Ye.grossTolerance:12,Nt=Ye.interval!=null?Ye.interval:500;K.point=K.point||pe.point,K.time=K.time||pe.time;var Qt=Pe(K.point,pe.point);return Qt<Et||Qt<Ut&&pe.time-K.time<Nt}function Ee(K,pe,Ye){Ye===void 0&&(Ye={});var Et=Ye.tolerance!=null?Ye.tolerance:25,Ut=Ye.interval!=null?Ye.interval:250;return K.point=K.point||pe.point,K.time=K.time||pe.time,Pe(K.point,pe.point)<Et&&pe.time-K.time<Ut}var we={exports:{}},Ae=we.exports=function(K,pe){if(pe||(pe=16),K===void 0&&(K=128),K<=0)return"0";for(var Ye=Math.log(Math.pow(2,K))/Math.log(pe),Et=2;Ye===1/0;Et*=2)Ye=Math.log(Math.pow(2,K/Et))/Math.log(pe)*Et;var Ut=Ye-Math.floor(Ye),Nt="";for(Et=0;Et<Math.floor(Ye);Et++)Nt=Math.floor(Math.random()*pe).toString(pe)+Nt;if(Ut){var Qt=Math.pow(pe,Ut);Nt=Math.floor(Math.random()*Qt).toString(pe)+Nt}var Gr=parseInt(Nt,pe);return Gr!==1/0&&Gr>=Math.pow(2,K)?Ae(K,pe):Nt};Ae.rack=function(K,pe,Ye){var Et=function(Nt){var Qt=0;do{if(Qt++>10){if(!Ye)throw new Error("too many ID collisions, use more bits");K+=Ye}var Gr=Ae(K,pe)}while(Object.hasOwnProperty.call(Ut,Gr));return Ut[Gr]=Nt,Gr},Ut=Et.hats={};return Et.get=function(Nt){return Et.hats[Nt]},Et.set=function(Nt,Qt){return Et.hats[Nt]=Qt,Et},Et.bits=K||128,Et.base=pe||16,Et};var ce=n(we.exports),xe=function(K,pe){this.ctx=K,this.properties=pe.properties||{},this.coordinates=pe.geometry.coordinates,this.id=pe.id||ce(),this.type=pe.geometry.type};xe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},xe.prototype.incomingCoords=function(K){this.setCoordinates(K)},xe.prototype.setCoordinates=function(K){this.coordinates=K,this.changed()},xe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},xe.prototype.setProperty=function(K,pe){this.properties[K]=pe},xe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:E.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},xe.prototype.internal=function(K){var pe={id:this.id,meta:N.FEATURE,"meta:type":this.type,active:M.INACTIVE,mode:K};if(this.ctx.options.userProperties)for(var Ye in this.properties)pe["user_"+Ye]=this.properties[Ye];return{type:E.FEATURE,properties:pe,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var _e=function(K,pe){xe.call(this,K,pe)};(_e.prototype=Object.create(xe.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},_e.prototype.updateCoordinate=function(K,pe,Ye){this.coordinates=arguments.length===3?[pe,Ye]:[K,pe],this.changed()},_e.prototype.getCoordinate=function(){return this.getCoordinates()};var Me=function(K,pe){xe.call(this,K,pe)};(Me.prototype=Object.create(xe.prototype)).isValid=function(){return this.coordinates.length>1},Me.prototype.addCoordinate=function(K,pe,Ye){this.changed();var Et=parseInt(K,10);this.coordinates.splice(Et,0,[pe,Ye])},Me.prototype.getCoordinate=function(K){var pe=parseInt(K,10);return JSON.parse(JSON.stringify(this.coordinates[pe]))},Me.prototype.removeCoordinate=function(K){this.changed(),this.coordinates.splice(parseInt(K,10),1)},Me.prototype.updateCoordinate=function(K,pe,Ye){var Et=parseInt(K,10);this.coordinates[Et]=[pe,Ye],this.changed()};var Re=function(K,pe){xe.call(this,K,pe),this.coordinates=this.coordinates.map((function(Ye){return Ye.slice(0,-1)}))};(Re.prototype=Object.create(xe.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(K){return K.length>2}))},Re.prototype.incomingCoords=function(K){this.coordinates=K.map((function(pe){return pe.slice(0,-1)})),this.changed()},Re.prototype.setCoordinates=function(K){this.coordinates=K,this.changed()},Re.prototype.addCoordinate=function(K,pe,Ye){this.changed();var Et=K.split(".").map((function(Ut){return parseInt(Ut,10)}));this.coordinates[Et[0]].splice(Et[1],0,[pe,Ye])},Re.prototype.removeCoordinate=function(K){this.changed();var pe=K.split(".").map((function(Et){return parseInt(Et,10)})),Ye=this.coordinates[pe[0]];Ye&&(Ye.splice(pe[1],1),Ye.length<3&&this.coordinates.splice(pe[0],1))},Re.prototype.getCoordinate=function(K){var pe=K.split(".").map((function(Et){return parseInt(Et,10)})),Ye=this.coordinates[pe[0]];return JSON.parse(JSON.stringify(Ye[pe[1]]))},Re.prototype.getCoordinates=function(){return this.coordinates.map((function(K){return K.concat([K[0]])}))},Re.prototype.updateCoordinate=function(K,pe,Ye){this.changed();var Et=K.split("."),Ut=parseInt(Et[0],10),Nt=parseInt(Et[1],10);this.coordinates[Ut]===void 0&&(this.coordinates[Ut]=[]),this.coordinates[Ut][Nt]=[pe,Ye]};var He={MultiPoint:_e,MultiLineString:Me,MultiPolygon:Re},Fe=function(K,pe,Ye,Et,Ut){var Nt=Ye.split("."),Qt=parseInt(Nt[0],10),Gr=Nt[1]?Nt.slice(1).join("."):null;return K[Qt][pe](Gr,Et,Ut)},tt=function(K,pe){if(xe.call(this,K,pe),delete this.coordinates,this.model=He[pe.geometry.type],this.model===void 0)throw new TypeError(pe.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(pe.geometry.coordinates)};function Ze(K){this.map=K.map,this.drawConfig=JSON.parse(JSON.stringify(K.options||{})),this._ctx=K}(tt.prototype=Object.create(xe.prototype))._coordinatesToFeatures=function(K){var pe=this,Ye=this.model.bind(this);return K.map((function(Et){return new Ye(pe.ctx,{id:ce(),type:E.FEATURE,properties:{},geometry:{coordinates:Et,type:pe.type.replace("Multi","")}})}))},tt.prototype.isValid=function(){return this.features.every((function(K){return K.isValid()}))},tt.prototype.setCoordinates=function(K){this.features=this._coordinatesToFeatures(K),this.changed()},tt.prototype.getCoordinate=function(K){return Fe(this.features,"getCoordinate",K)},tt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(K){return K.type===E.POLYGON?K.getCoordinates():K.coordinates}))))},tt.prototype.updateCoordinate=function(K,pe,Ye){Fe(this.features,"updateCoordinate",K,pe,Ye),this.changed()},tt.prototype.addCoordinate=function(K,pe,Ye){Fe(this.features,"addCoordinate",K,pe,Ye),this.changed()},tt.prototype.removeCoordinate=function(K){Fe(this.features,"removeCoordinate",K),this.changed()},tt.prototype.getFeatures=function(){return this.features},Ze.prototype.setSelected=function(K){return this._ctx.store.setSelected(K)},Ze.prototype.setSelectedCoordinates=function(K){var pe=this;this._ctx.store.setSelectedCoordinates(K),K.reduce((function(Ye,Et){return Ye[Et.feature_id]===void 0&&(Ye[Et.feature_id]=!0,pe._ctx.store.get(Et.feature_id).changed()),Ye}),{})},Ze.prototype.getSelected=function(){return this._ctx.store.getSelected()},Ze.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Ze.prototype.isSelected=function(K){return this._ctx.store.isSelected(K)},Ze.prototype.getFeature=function(K){return this._ctx.store.get(K)},Ze.prototype.select=function(K){return this._ctx.store.select(K)},Ze.prototype.deselect=function(K){return this._ctx.store.deselect(K)},Ze.prototype.deleteFeature=function(K,pe){return pe===void 0&&(pe={}),this._ctx.store.delete(K,pe)},Ze.prototype.addFeature=function(K){return this._ctx.store.add(K)},Ze.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Ze.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Ze.prototype.setActionableState=function(K){K===void 0&&(K={});var pe={trash:K.trash||!1,combineFeatures:K.combineFeatures||!1,uncombineFeatures:K.uncombineFeatures||!1};return this._ctx.events.actionable(pe)},Ze.prototype.changeMode=function(K,pe,Ye){return pe===void 0&&(pe={}),Ye===void 0&&(Ye={}),this._ctx.events.changeMode(K,pe,Ye)},Ze.prototype.updateUIClasses=function(K){return this._ctx.ui.queueMapClasses(K)},Ze.prototype.activateUIButton=function(K){return this._ctx.ui.setActiveButton(K)},Ze.prototype.featuresAt=function(K,pe,Ye){if(Ye===void 0&&(Ye="click"),Ye!=="click"&&Ye!=="touch")throw new Error("invalid buffer type");return ae[Ye](K,pe,this._ctx)},Ze.prototype.newFeature=function(K){var pe=K.geometry.type;return pe===E.POINT?new _e(this._ctx,K):pe===E.LINE_STRING?new Me(this._ctx,K):pe===E.POLYGON?new Re(this._ctx,K):new tt(this._ctx,K)},Ze.prototype.isInstanceOf=function(K,pe){if(K===E.POINT)return pe instanceof _e;if(K===E.LINE_STRING)return pe instanceof Me;if(K===E.POLYGON)return pe instanceof Re;if(K==="MultiFeature")return pe instanceof tt;throw new Error("Unknown feature class: "+K)},Ze.prototype.doRender=function(K){return this._ctx.store.featureChanged(K)},Ze.prototype.onSetup=function(){},Ze.prototype.onDrag=function(){},Ze.prototype.onClick=function(){},Ze.prototype.onMouseMove=function(){},Ze.prototype.onMouseDown=function(){},Ze.prototype.onMouseUp=function(){},Ze.prototype.onMouseOut=function(){},Ze.prototype.onKeyUp=function(){},Ze.prototype.onKeyDown=function(){},Ze.prototype.onTouchStart=function(){},Ze.prototype.onTouchMove=function(){},Ze.prototype.onTouchEnd=function(){},Ze.prototype.onTap=function(){},Ze.prototype.onStop=function(){},Ze.prototype.onTrash=function(){},Ze.prototype.onCombineFeature=function(){},Ze.prototype.onUncombineFeature=function(){},Ze.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Qe={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Ie=Object.keys(Qe);function Lt(K){var pe=Object.keys(K);return function(Ye,Et){Et===void 0&&(Et={});var Ut={},Nt=pe.reduce((function(Qt,Gr){return Qt[Gr]=K[Gr],Qt}),new Ze(Ye));return{start:function(){var Qt=this;Ut=Nt.onSetup(Et),Ie.forEach((function(Gr){var on,en=Qe[Gr],hn=function(){return!1};K[en]&&(hn=function(){return!0}),Qt.on(Gr,hn,(on=en,function(nn){return Nt[on](Ut,nn)}))}))},stop:function(){Nt.onStop(Ut)},trash:function(){Nt.onTrash(Ut)},combineFeatures:function(){Nt.onCombineFeatures(Ut)},uncombineFeatures:function(){Nt.onUncombineFeatures(Ut)},render:function(Qt,Gr){Nt.toDisplayFeatures(Ut,Qt,Gr)}}}}function at(K){return[].concat(K).filter((function(pe){return pe!==void 0}))}function Ve(){var K=this;if(!(K.ctx.map&&K.ctx.map.getSource(b.HOT)!==void 0))return on();var pe=K.ctx.events.currentModeName();K.ctx.ui.queueMapClasses({mode:pe});var Ye=[],Et=[];K.isDirty?Et=K.getAllIds():(Ye=K.getChangedIds().filter((function(en){return K.get(en)!==void 0})),Et=K.sources.hot.filter((function(en){return en.properties.id&&Ye.indexOf(en.properties.id)===-1&&K.get(en.properties.id)!==void 0})).map((function(en){return en.properties.id}))),K.sources.hot=[];var Ut=K.sources.cold.length;K.sources.cold=K.isDirty?[]:K.sources.cold.filter((function(en){var hn=en.properties.id||en.properties.parent;return Ye.indexOf(hn)===-1}));var Nt=Ut!==K.sources.cold.length||Et.length>0;function Qt(en,hn){var nn=K.get(en).internal(pe);K.ctx.events.currentModeRender(nn,(function(Xn){K.sources[hn].push(Xn)}))}if(Ye.forEach((function(en){return Qt(en,"hot")})),Et.forEach((function(en){return Qt(en,"cold")})),Nt&&K.ctx.map.getSource(b.COLD).setData({type:E.FEATURE_COLLECTION,features:K.sources.cold}),K.ctx.map.getSource(b.HOT).setData({type:E.FEATURE_COLLECTION,features:K.sources.hot}),K._emitSelectionChange&&(K.ctx.map.fire(k.SELECTION_CHANGE,{features:K.getSelected().map((function(en){return en.toGeoJSON()})),points:K.getSelectedCoordinates().map((function(en){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:en.coordinates}}}))}),K._emitSelectionChange=!1),K._deletedFeaturesToEmit.length){var Gr=K._deletedFeaturesToEmit.map((function(en){return en.toGeoJSON()}));K._deletedFeaturesToEmit=[],K.ctx.map.fire(k.DELETE,{features:Gr})}function on(){K.isDirty=!1,K.clearChangedIds()}on(),K.ctx.map.fire(k.RENDER,{})}function nr(K){var pe,Ye=this;this._features={},this._featureIds=new H,this._selectedFeatureIds=new H,this._selectedCoordinates=[],this._changedFeatureIds=new H,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=K,this.sources={hot:[],cold:[]},this.render=function(){pe||(pe=requestAnimationFrame((function(){pe=null,Ve.call(Ye)})))},this.isDirty=!1}function Yt(K,pe){var Ye=K._selectedCoordinates.filter((function(Et){return K._selectedFeatureIds.has(Et.feature_id)}));K._selectedCoordinates.length===Ye.length||pe.silent||(K._emitSelectionChange=!0),K._selectedCoordinates=Ye}nr.prototype.createRenderBatch=function(){var K=this,pe=this.render,Ye=0;return this.render=function(){Ye++},function(){K.render=pe,Ye>0&&K.render()}},nr.prototype.setDirty=function(){return this.isDirty=!0,this},nr.prototype.featureChanged=function(K){return this._changedFeatureIds.add(K),this},nr.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},nr.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},nr.prototype.getAllIds=function(){return this._featureIds.values()},nr.prototype.add=function(K){return this.featureChanged(K.id),this._features[K.id]=K,this._featureIds.add(K.id),this},nr.prototype.delete=function(K,pe){var Ye=this;return pe===void 0&&(pe={}),at(K).forEach((function(Et){Ye._featureIds.has(Et)&&(Ye._featureIds.delete(Et),Ye._selectedFeatureIds.delete(Et),pe.silent||Ye._deletedFeaturesToEmit.indexOf(Ye._features[Et])===-1&&Ye._deletedFeaturesToEmit.push(Ye._features[Et]),delete Ye._features[Et],Ye.isDirty=!0)})),Yt(this,pe),this},nr.prototype.get=function(K){return this._features[K]},nr.prototype.getAll=function(){var K=this;return Object.keys(this._features).map((function(pe){return K._features[pe]}))},nr.prototype.select=function(K,pe){var Ye=this;return pe===void 0&&(pe={}),at(K).forEach((function(Et){Ye._selectedFeatureIds.has(Et)||(Ye._selectedFeatureIds.add(Et),Ye._changedFeatureIds.add(Et),pe.silent||(Ye._emitSelectionChange=!0))})),this},nr.prototype.deselect=function(K,pe){var Ye=this;return pe===void 0&&(pe={}),at(K).forEach((function(Et){Ye._selectedFeatureIds.has(Et)&&(Ye._selectedFeatureIds.delete(Et),Ye._changedFeatureIds.add(Et),pe.silent||(Ye._emitSelectionChange=!0))})),Yt(this,pe),this},nr.prototype.clearSelected=function(K){return K===void 0&&(K={}),this.deselect(this._selectedFeatureIds.values(),{silent:K.silent}),this},nr.prototype.setSelected=function(K,pe){var Ye=this;return pe===void 0&&(pe={}),K=at(K),this.deselect(this._selectedFeatureIds.values().filter((function(Et){return K.indexOf(Et)===-1})),{silent:pe.silent}),this.select(K.filter((function(Et){return!Ye._selectedFeatureIds.has(Et)})),{silent:pe.silent}),this},nr.prototype.setSelectedCoordinates=function(K){return this._selectedCoordinates=K,this._emitSelectionChange=!0,this},nr.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},nr.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},nr.prototype.getSelected=function(){var K=this;return this._selectedFeatureIds.values().map((function(pe){return K.get(pe)}))},nr.prototype.getSelectedCoordinates=function(){var K=this;return this._selectedCoordinates.map((function(pe){return{coordinates:K.get(pe.feature_id).getCoordinate(pe.coord_path)}}))},nr.prototype.isSelected=function(K){return this._selectedFeatureIds.has(K)},nr.prototype.setFeatureProperty=function(K,pe,Ye){this.get(K).setProperty(pe,Ye),this.featureChanged(K)},nr.prototype.storeMapConfig=function(){var K=this;z.forEach((function(pe){K.ctx.map[pe]&&(K._mapInitialConfig[pe]=K.ctx.map[pe].isEnabled())}))},nr.prototype.restoreMapConfig=function(){var K=this;Object.keys(this._mapInitialConfig).forEach((function(pe){K._mapInitialConfig[pe]?K.ctx.map[pe].enable():K.ctx.map[pe].disable()}))},nr.prototype.getInitialConfigValue=function(K){return this._mapInitialConfig[K]===void 0||this._mapInitialConfig[K]};var yr=function(){for(var K=arguments,pe={},Ye=0;Ye<arguments.length;Ye++){var Et=K[Ye];for(var Ut in Et)mt.call(Et,Ut)&&(pe[Ut]=Et[Ut])}return pe},mt=Object.prototype.hasOwnProperty,br=n(yr),Tr=["mode","feature","mouse"];function mr(K){var pe=null,Ye=null,Et={onRemove:function(){return K.map.off("load",Et.connect),clearInterval(Ye),Et.removeLayers(),K.store.restoreMapConfig(),K.ui.removeButtons(),K.events.removeEventListeners(),K.ui.clearMapClasses(),K.boxZoomInitial&&K.map.boxZoom.enable(),K.map=null,K.container=null,K.store=null,pe&&pe.parentNode&&pe.parentNode.removeChild(pe),pe=null,this},connect:function(){K.map.off("load",Et.connect),clearInterval(Ye),Et.addLayers(),K.store.storeMapConfig(),K.events.addEventListeners()},onAdd:function(Ut){var Nt=Ut.fire;return Ut.fire=function(Qt,Gr){var on=arguments;return Nt.length===1&&arguments.length!==1&&(on=[br({},{type:Qt},Gr)]),Nt.apply(Ut,on)},K.map=Ut,K.events=(function(Qt){var Gr=Object.keys(Qt.options.modes).reduce((function($r,xn){return $r[xn]=Lt(Qt.options.modes[xn]),$r}),{}),on={},en={},hn={},nn=null,Xn=null;hn.drag=function($r,xn){xn({point:$r.point,time:new Date().getTime()})?(Qt.ui.queueMapClasses({mouse:v.DRAG}),Xn.drag($r)):$r.originalEvent.stopPropagation()},hn.mousedrag=function($r){hn.drag($r,(function(xn){return!me(on,xn)}))},hn.touchdrag=function($r){hn.drag($r,(function(xn){return!Ee(en,xn)}))},hn.mousemove=function($r){if(($r.originalEvent.buttons!==void 0?$r.originalEvent.buttons:$r.originalEvent.which)===1)return hn.mousedrag($r);var xn=de($r,Qt);$r.featureTarget=xn,Xn.mousemove($r)},hn.mousedown=function($r){on={time:new Date().getTime(),point:$r.point};var xn=de($r,Qt);$r.featureTarget=xn,Xn.mousedown($r)},hn.mouseup=function($r){var xn=de($r,Qt);$r.featureTarget=xn,me(on,{point:$r.point,time:new Date().getTime()})?Xn.click($r):Xn.mouseup($r)},hn.mouseout=function($r){Xn.mouseout($r)},hn.touchstart=function($r){if(Qt.options.touchEnabled){en={time:new Date().getTime(),point:$r.point};var xn=ae.touch($r,null,Qt)[0];$r.featureTarget=xn,Xn.touchstart($r)}},hn.touchmove=function($r){if(Qt.options.touchEnabled)return Xn.touchmove($r),hn.touchdrag($r)},hn.touchend=function($r){if($r.originalEvent.preventDefault(),Qt.options.touchEnabled){var xn=ae.touch($r,null,Qt)[0];$r.featureTarget=xn,Ee(en,{time:new Date().getTime(),point:$r.point})?Xn.tap($r):Xn.touchend($r)}};var En=function($r){return!($r===8||$r===46||$r>=48&&$r<=57)};function $n($r,xn,si){si===void 0&&(si={}),Xn.stop();var Li=Gr[$r];if(Li===void 0)throw new Error($r+" is not valid");nn=$r;var wi=Li(Qt,xn);Xn=r(wi,Qt),si.silent||Qt.map.fire(k.MODE_CHANGE,{mode:$r}),Qt.store.setDirty(),Qt.store.render()}hn.keydown=function($r){($r.srcElement||$r.target).classList.contains("mapboxgl-canvas")&&($r.keyCode!==8&&$r.keyCode!==46||!Qt.options.controls.trash?En($r.keyCode)?Xn.keydown($r):$r.keyCode===49&&Qt.options.controls.point?$n(P.DRAW_POINT):$r.keyCode===50&&Qt.options.controls.line_string?$n(P.DRAW_LINE_STRING):$r.keyCode===51&&Qt.options.controls.polygon&&$n(P.DRAW_POLYGON):($r.preventDefault(),Xn.trash()))},hn.keyup=function($r){En($r.keyCode)&&Xn.keyup($r)},hn.zoomend=function(){Qt.store.changeZoom()},hn.data=function($r){if($r.dataType==="style"){var xn=Qt.setup,si=Qt.map,Li=Qt.options,wi=Qt.store;Li.styles.some((function(Vi){return si.getLayer(Vi.id)}))||(xn.addLayers(),wi.setDirty(),wi.render())}};var Ln={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){nn=Qt.options.defaultMode,Xn=r(Gr[nn](Qt),Qt)},changeMode:$n,actionable:function($r){var xn=!1;Object.keys($r).forEach((function(si){if(Ln[si]===void 0)throw new Error("Invalid action type");Ln[si]!==$r[si]&&(xn=!0),Ln[si]=$r[si]})),xn&&Qt.map.fire(k.ACTIONABLE,{actions:Ln})},currentModeName:function(){return nn},currentModeRender:function($r,xn){return Xn.render($r,xn)},fire:function($r,xn){hn[$r]&&hn[$r](xn)},addEventListeners:function(){Qt.map.on("mousemove",hn.mousemove),Qt.map.on("mousedown",hn.mousedown),Qt.map.on("mouseup",hn.mouseup),Qt.map.on("data",hn.data),Qt.map.on("touchmove",hn.touchmove),Qt.map.on("touchstart",hn.touchstart),Qt.map.on("touchend",hn.touchend),Qt.container.addEventListener("mouseout",hn.mouseout),Qt.options.keybindings&&(Qt.container.addEventListener("keydown",hn.keydown),Qt.container.addEventListener("keyup",hn.keyup))},removeEventListeners:function(){Qt.map.off("mousemove",hn.mousemove),Qt.map.off("mousedown",hn.mousedown),Qt.map.off("mouseup",hn.mouseup),Qt.map.off("data",hn.data),Qt.map.off("touchmove",hn.touchmove),Qt.map.off("touchstart",hn.touchstart),Qt.map.off("touchend",hn.touchend),Qt.container.removeEventListener("mouseout",hn.mouseout),Qt.options.keybindings&&(Qt.container.removeEventListener("keydown",hn.keydown),Qt.container.removeEventListener("keyup",hn.keyup))},trash:function($r){Xn.trash($r)},combineFeatures:function(){Xn.combineFeatures()},uncombineFeatures:function(){Xn.uncombineFeatures()},getMode:function(){return nn}}})(K),K.ui=(function(Qt){var Gr={},on=null,en={mode:null,feature:null,mouse:null},hn={mode:null,feature:null,mouse:null};function nn($r){hn=br(hn,$r)}function Xn(){var $r,xn;if(Qt.container){var si=[],Li=[];Tr.forEach((function(wi){hn[wi]!==en[wi]&&(si.push(wi+"-"+en[wi]),hn[wi]!==null&&Li.push(wi+"-"+hn[wi]))})),si.length>0&&($r=Qt.container.classList).remove.apply($r,si),Li.length>0&&(xn=Qt.container.classList).add.apply(xn,Li),en=br(en,hn)}}function En($r,xn){xn===void 0&&(xn={});var si=document.createElement("button");return si.className=d.CONTROL_BUTTON+" "+xn.className,si.setAttribute("title",xn.title),xn.container.appendChild(si),si.addEventListener("click",(function(Li){if(Li.preventDefault(),Li.stopPropagation(),Li.target===on)return $n(),void xn.onDeactivate();Ln($r),xn.onActivate()}),!0),si}function $n(){on&&(on.classList.remove(d.ACTIVE_BUTTON),on=null)}function Ln($r){$n();var xn=Gr[$r];xn&&xn&&$r!=="trash"&&(xn.classList.add(d.ACTIVE_BUTTON),on=xn)}return{setActiveButton:Ln,queueMapClasses:nn,updateMapClasses:Xn,clearMapClasses:function(){nn({mode:null,feature:null,mouse:null}),Xn()},addButtons:function(){var $r=Qt.options.controls,xn=document.createElement("div");return xn.className=d.CONTROL_GROUP+" "+d.CONTROL_BASE,$r&&($r[S.LINE]&&(Gr[S.LINE]=En(S.LINE,{container:xn,className:d.CONTROL_BUTTON_LINE,title:"LineString tool "+(Qt.options.keybindings?"(l)":""),onActivate:function(){return Qt.events.changeMode(P.DRAW_LINE_STRING)},onDeactivate:function(){return Qt.events.trash()}})),$r[S.POLYGON]&&(Gr[S.POLYGON]=En(S.POLYGON,{container:xn,className:d.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(Qt.options.keybindings?"(p)":""),onActivate:function(){return Qt.events.changeMode(P.DRAW_POLYGON)},onDeactivate:function(){return Qt.events.trash()}})),$r[S.POINT]&&(Gr[S.POINT]=En(S.POINT,{container:xn,className:d.CONTROL_BUTTON_POINT,title:"Marker tool "+(Qt.options.keybindings?"(m)":""),onActivate:function(){return Qt.events.changeMode(P.DRAW_POINT)},onDeactivate:function(){return Qt.events.trash()}})),$r.trash&&(Gr.trash=En("trash",{container:xn,className:d.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){Qt.events.trash()}})),$r.combine_features&&(Gr.combine_features=En("combineFeatures",{container:xn,className:d.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){Qt.events.combineFeatures()}})),$r.uncombine_features&&(Gr.uncombine_features=En("uncombineFeatures",{container:xn,className:d.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){Qt.events.uncombineFeatures()}}))),xn},removeButtons:function(){Object.keys(Gr).forEach((function($r){var xn=Gr[$r];xn.parentNode&&xn.parentNode.removeChild(xn),delete Gr[$r]}))}}})(K),K.container=Ut.getContainer(),K.store=new nr(K),pe=K.ui.addButtons(),K.options.boxSelect&&(K.boxZoomInitial=Ut.boxZoom.isEnabled(),Ut.boxZoom.disable(),Ut.dragPan.disable(),Ut.dragPan.enable()),Ut.loaded()?Et.connect():(Ut.on("load",Et.connect),Ye=setInterval((function(){Ut.loaded()&&Et.connect()}),16)),K.events.start(),pe},addLayers:function(){K.map.addSource(b.COLD,{data:{type:E.FEATURE_COLLECTION,features:[]},type:"geojson"}),K.map.addSource(b.HOT,{data:{type:E.FEATURE_COLLECTION,features:[]},type:"geojson"}),K.options.styles.forEach((function(Ut){K.map.addLayer(Ut)})),K.store.setDirty(!0),K.store.render()},removeLayers:function(){K.options.styles.forEach((function(Ut){K.map.getLayer(Ut.id)&&K.map.removeLayer(Ut.id)})),K.map.getSource(b.COLD)&&K.map.removeSource(b.COLD),K.map.getSource(b.HOT)&&K.map.removeSource(b.HOT)}};return K.setup=Et,Et}var Mr=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Pr(K){return function(pe){var Ye=pe.featureTarget;return!!Ye&&!!Ye.properties&&Ye.properties.meta===K}}function ar(K){return!!K.originalEvent&&!!K.originalEvent.shiftKey&&K.originalEvent.button===0}function fr(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.active===M.ACTIVE&&K.featureTarget.properties.meta===N.FEATURE}function Nr(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.active===M.INACTIVE&&K.featureTarget.properties.meta===N.FEATURE}function or(K){return K.featureTarget===void 0}function Dr(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.meta===N.FEATURE}function er(K){var pe=K.featureTarget;return!!pe&&!!pe.properties&&pe.properties.meta===N.VERTEX}function Gt(K){return!!K.originalEvent&&K.originalEvent.shiftKey===!0}function Tt(K){return K.keyCode===27}function Oe(K){return K.keyCode===13}var Be=Object.freeze({__proto__:null,isOfMetaType:Pr,isShiftMousedown:ar,isActiveFeature:fr,isInactiveFeature:Nr,noTarget:or,isFeature:Dr,isVertex:er,isShiftDown:Gt,isEscapeKey:Tt,isEnterKey:Oe,isTrue:function(){return!0}}),Ne=rt;function rt(K,pe){this.x=K,this.y=pe}rt.prototype={clone:function(){return new rt(this.x,this.y)},add:function(K){return this.clone()._add(K)},sub:function(K){return this.clone()._sub(K)},multByPoint:function(K){return this.clone()._multByPoint(K)},divByPoint:function(K){return this.clone()._divByPoint(K)},mult:function(K){return this.clone()._mult(K)},div:function(K){return this.clone()._div(K)},rotate:function(K){return this.clone()._rotate(K)},rotateAround:function(K,pe){return this.clone()._rotateAround(K,pe)},matMult:function(K){return this.clone()._matMult(K)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(K){return this.x===K.x&&this.y===K.y},dist:function(K){return Math.sqrt(this.distSqr(K))},distSqr:function(K){var pe=K.x-this.x,Ye=K.y-this.y;return pe*pe+Ye*Ye},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(K){return Math.atan2(this.y-K.y,this.x-K.x)},angleWith:function(K){return this.angleWithSep(K.x,K.y)},angleWithSep:function(K,pe){return Math.atan2(this.x*pe-this.y*K,this.x*K+this.y*pe)},_matMult:function(K){var pe=K[0]*this.x+K[1]*this.y,Ye=K[2]*this.x+K[3]*this.y;return this.x=pe,this.y=Ye,this},_add:function(K){return this.x+=K.x,this.y+=K.y,this},_sub:function(K){return this.x-=K.x,this.y-=K.y,this},_mult:function(K){return this.x*=K,this.y*=K,this},_div:function(K){return this.x/=K,this.y/=K,this},_multByPoint:function(K){return this.x*=K.x,this.y*=K.y,this},_divByPoint:function(K){return this.x/=K.x,this.y/=K.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var K=this.y;return this.y=this.x,this.x=-K,this},_rotate:function(K){var pe=Math.cos(K),Ye=Math.sin(K),Et=pe*this.x-Ye*this.y,Ut=Ye*this.x+pe*this.y;return this.x=Et,this.y=Ut,this},_rotateAround:function(K,pe){var Ye=Math.cos(K),Et=Math.sin(K),Ut=pe.x+Ye*(this.x-pe.x)-Et*(this.y-pe.y),Nt=pe.y+Et*(this.x-pe.x)+Ye*(this.y-pe.y);return this.x=Ut,this.y=Nt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rt.convert=function(K){return K instanceof rt?K:Array.isArray(K)?new rt(K[0],K[1]):K};var pt=n(Ne);function Rt(K,pe){var Ye=pe.getBoundingClientRect();return new pt(K.clientX-Ye.left-(pe.clientLeft||0),K.clientY-Ye.top-(pe.clientTop||0))}function Bt(K,pe,Ye,Et){return{type:E.FEATURE,properties:{meta:N.VERTEX,parent:K,coord_path:Ye,active:Et?M.ACTIVE:M.INACTIVE},geometry:{type:E.POINT,coordinates:pe}}}function At(K,pe,Ye){var Et=pe.geometry.coordinates,Ut=Ye.geometry.coordinates;if(Et[1]>85||Et[1]<B||Ut[1]>85||Ut[1]<B)return null;var Nt={lng:(Et[0]+Ut[0])/2,lat:(Et[1]+Ut[1])/2};return{type:E.FEATURE,properties:{meta:N.MIDPOINT,parent:K,lng:Nt.lng,lat:Nt.lat,coord_path:Ye.properties.coord_path},geometry:{type:E.POINT,coordinates:[Nt.lng,Nt.lat]}}}function Zt(K,pe,Ye){pe===void 0&&(pe={}),Ye===void 0&&(Ye=null);var Et,Ut=K.geometry,Nt=Ut.type,Qt=Ut.coordinates,Gr=K.properties&&K.properties.id,on=[];function en(nn,Xn){var En="",$n=null;nn.forEach((function(Ln,$r){var xn=Xn!=null?Xn+"."+$r:String($r),si=Bt(Gr,Ln,xn,hn(xn));if(pe.midpoints&&$n){var Li=At(Gr,$n,si);Li&&on.push(Li)}$n=si;var wi=JSON.stringify(Ln);En!==wi&&on.push(si),$r===0&&(En=wi)}))}function hn(nn){return!!pe.selectedPaths&&pe.selectedPaths.indexOf(nn)!==-1}return Nt===E.POINT?on.push(Bt(Gr,Qt,Ye,hn(Ye))):Nt===E.POLYGON?Qt.forEach((function(nn,Xn){en(nn,Ye!==null?Ye+"."+Xn:String(Xn))})):Nt===E.LINE_STRING?en(Qt,Ye):Nt.indexOf(E.MULTI_PREFIX)===0&&(Et=Nt.replace(E.MULTI_PREFIX,""),Qt.forEach((function(nn,Xn){var En={type:E.FEATURE,properties:K.properties,geometry:{type:Et,coordinates:nn}};on=on.concat(Zt(En,pe,Xn))}))),on}var jt={enable:function(K){setTimeout((function(){K.map&&K.map.doubleClickZoom&&K._ctx&&K._ctx.store&&K._ctx.store.getInitialConfigValue&&K._ctx.store.getInitialConfigValue("doubleClickZoom")&&K.map.doubleClickZoom.enable()}),0)},disable:function(K){setTimeout((function(){K.map&&K.map.doubleClickZoom&&K.map.doubleClickZoom.disable()}),0)}},St={exports:{}},Xt=function(K){if(!K||!K.type)return null;var pe=Ct[K.type];if(!pe)return null;if(pe==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:K}]};if(pe==="feature")return{type:"FeatureCollection",features:[K]};if(pe==="featurecollection")return K},Ct={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Lr=n(Xt),qt=Object.freeze({__proto__:null,default:function K(pe){switch(pe&&pe.type||null){case"FeatureCollection":return pe.features=pe.features.reduce((function(Ye,Et){return Ye.concat(K(Et))}),[]),pe;case"Feature":return pe.geometry?K(pe.geometry).map((function(Ye){var Et={type:"Feature",properties:JSON.parse(JSON.stringify(pe.properties)),geometry:Ye};return pe.id!==void 0&&(Et.id=pe.id),Et})):[pe];case"MultiPoint":return pe.coordinates.map((function(Ye){return{type:"Point",coordinates:Ye}}));case"MultiPolygon":return pe.coordinates.map((function(Ye){return{type:"Polygon",coordinates:Ye}}));case"MultiLineString":return pe.coordinates.map((function(Ye){return{type:"LineString",coordinates:Ye}}));case"GeometryCollection":return pe.geometries.map(K).reduce((function(Ye,Et){return Ye.concat(Et)}),[]);case"Point":case"Polygon":case"LineString":return[pe]}}}),Zr=Xt,jr=i(qt),vn=function(K){return(function pe(Ye){return Array.isArray(Ye)&&Ye.length&&typeof Ye[0]=="number"?[Ye]:Ye.reduce((function(Et,Ut){return Array.isArray(Ut)&&Array.isArray(Ut[0])?Et.concat(pe(Ut)):(Et.push(Ut),Et)}),[])})(K)};jr instanceof Function||(jr=jr.default);var Ce={exports:{}},Ue=Ce.exports=function(K){return new ft(K)};function ft(K){this.value=K}function Mt(K,pe,Ye){var Et=[],Ut=[],Nt=!0;return(function Qt(Gr){var on=Ye?xr(Gr):Gr,en={},hn=!0,nn={node:on,node_:Gr,path:[].concat(Et),parent:Ut[Ut.length-1],parents:Ut,key:Et.slice(-1)[0],isRoot:Et.length===0,level:Et.length,circular:null,update:function($n,Ln){nn.isRoot||(nn.parent.node[nn.key]=$n),nn.node=$n,Ln&&(hn=!1)},delete:function($n){delete nn.parent.node[nn.key],$n&&(hn=!1)},remove:function($n){di(nn.parent.node)?nn.parent.node.splice(nn.key,1):delete nn.parent.node[nn.key],$n&&(hn=!1)},keys:null,before:function($n){en.before=$n},after:function($n){en.after=$n},pre:function($n){en.pre=$n},post:function($n){en.post=$n},stop:function(){Nt=!1},block:function(){hn=!1}};if(!Nt)return nn;function Xn(){if(typeof nn.node=="object"&&nn.node!==null){nn.keys&&nn.node_===nn.node||(nn.keys=Kr(nn.node)),nn.isLeaf=nn.keys.length==0;for(var $n=0;$n<Ut.length;$n++)if(Ut[$n].node_===Gr){nn.circular=Ut[$n];break}}else nn.isLeaf=!0,nn.keys=null;nn.notLeaf=!nn.isLeaf,nn.notRoot=!nn.isRoot}Xn();var En=pe.call(nn,nn.node);return En!==void 0&&nn.update&&nn.update(En),en.before&&en.before.call(nn,nn.node),hn&&(typeof nn.node!="object"||nn.node===null||nn.circular||(Ut.push(nn),Xn(),ti(nn.keys,(function($n,Ln){Et.push($n),en.pre&&en.pre.call(nn,nn.node[$n],$n);var $r=Qt(nn.node[$n]);Ye&&bi.call(nn.node,$n)&&(nn.node[$n]=$r.node),$r.isLast=Ln==nn.keys.length-1,$r.isFirst=Ln==0,en.post&&en.post.call(nn,$r),Et.pop()})),Ut.pop()),en.after&&en.after.call(nn,nn.node)),nn})(K).node}function xr(K){if(typeof K=="object"&&K!==null){var pe;if(di(K))pe=[];else if(Rr(K)==="[object Date]")pe=new Date(K.getTime?K.getTime():K);else if((function(Ut){return Rr(Ut)==="[object RegExp]"})(K))pe=new RegExp(K);else if((function(Ut){return Rr(Ut)==="[object Error]"})(K))pe={message:K.message};else if((function(Ut){return Rr(Ut)==="[object Boolean]"})(K))pe=new Boolean(K);else if((function(Ut){return Rr(Ut)==="[object Number]"})(K))pe=new Number(K);else if((function(Ut){return Rr(Ut)==="[object String]"})(K))pe=new String(K);else if(Object.create&&Object.getPrototypeOf)pe=Object.create(Object.getPrototypeOf(K));else if(K.constructor===Object)pe={};else{var Ye=K.constructor&&K.constructor.prototype||K.__proto__||{},Et=function(){};Et.prototype=Ye,pe=new Et}return ti(Kr(K),(function(Ut){pe[Ut]=K[Ut]})),pe}return K}ft.prototype.get=function(K){for(var pe=this.value,Ye=0;Ye<K.length;Ye++){var Et=K[Ye];if(!pe||!bi.call(pe,Et)){pe=void 0;break}pe=pe[Et]}return pe},ft.prototype.has=function(K){for(var pe=this.value,Ye=0;Ye<K.length;Ye++){var Et=K[Ye];if(!pe||!bi.call(pe,Et))return!1;pe=pe[Et]}return!0},ft.prototype.set=function(K,pe){for(var Ye=this.value,Et=0;Et<K.length-1;Et++){var Ut=K[Et];bi.call(Ye,Ut)||(Ye[Ut]={}),Ye=Ye[Ut]}return Ye[K[Et]]=pe,pe},ft.prototype.map=function(K){return Mt(this.value,K,!0)},ft.prototype.forEach=function(K){return this.value=Mt(this.value,K,!1),this.value},ft.prototype.reduce=function(K,pe){var Ye=arguments.length===1,Et=Ye?this.value:pe;return this.forEach((function(Ut){this.isRoot&&Ye||(Et=K.call(this,Et,Ut))})),Et},ft.prototype.paths=function(){var K=[];return this.forEach((function(pe){K.push(this.path)})),K},ft.prototype.nodes=function(){var K=[];return this.forEach((function(pe){K.push(this.node)})),K},ft.prototype.clone=function(){var K=[],pe=[];return(function Ye(Et){for(var Ut=0;Ut<K.length;Ut++)if(K[Ut]===Et)return pe[Ut];if(typeof Et=="object"&&Et!==null){var Nt=xr(Et);return K.push(Et),pe.push(Nt),ti(Kr(Et),(function(Qt){Nt[Qt]=Ye(Et[Qt])})),K.pop(),pe.pop(),Nt}return Et})(this.value)};var Kr=Object.keys||function(K){var pe=[];for(var Ye in K)pe.push(Ye);return pe};function Rr(K){return Object.prototype.toString.call(K)}var di=Array.isArray||function(K){return Object.prototype.toString.call(K)==="[object Array]"},ti=function(K,pe){if(K.forEach)return K.forEach(pe);for(var Ye=0;Ye<K.length;Ye++)pe(K[Ye],Ye,K)};ti(Kr(ft.prototype),(function(K){Ue[K]=function(pe){var Ye=[].slice.call(arguments,1),Et=new ft(pe);return Et[K].apply(Et,Ye)}}));var bi=Object.hasOwnProperty||function(K,pe){return pe in K},Ui=Ce.exports,Xr=_n;function _n(K){if(!(this instanceof _n))return new _n(K);this._bbox=K||[1/0,1/0,-1/0,-1/0],this._valid=!!K}_n.prototype.include=function(K){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],K[0]),this._bbox[1]=Math.min(this._bbox[1],K[1]),this._bbox[2]=Math.max(this._bbox[2],K[0]),this._bbox[3]=Math.max(this._bbox[3],K[1]),this},_n.prototype.equals=function(K){var pe;return pe=K instanceof _n?K.bbox():K,this._bbox[0]==pe[0]&&this._bbox[1]==pe[1]&&this._bbox[2]==pe[2]&&this._bbox[3]==pe[3]},_n.prototype.center=function(K){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},_n.prototype.union=function(K){var pe;return this._valid=!0,pe=K instanceof _n?K.bbox():K,this._bbox[0]=Math.min(this._bbox[0],pe[0]),this._bbox[1]=Math.min(this._bbox[1],pe[1]),this._bbox[2]=Math.max(this._bbox[2],pe[2]),this._bbox[3]=Math.max(this._bbox[3],pe[3]),this},_n.prototype.bbox=function(){return this._valid?this._bbox:null},_n.prototype.contains=function(K){if(!K)return this._fastContains();if(!this._valid)return null;var pe=K[0],Ye=K[1];return this._bbox[0]<=pe&&this._bbox[1]<=Ye&&this._bbox[2]>=pe&&this._bbox[3]>=Ye},_n.prototype.intersect=function(K){return this._valid?(pe=K instanceof _n?K.bbox():K,!(this._bbox[0]>pe[2]||this._bbox[2]<pe[0]||this._bbox[3]<pe[1]||this._bbox[1]>pe[3])):null;var pe},_n.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var K="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",K)},_n.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Fn=function(K){if(!K)return[];var pe=jr(Zr(K)),Ye=[];return pe.features.forEach((function(Et){Et.geometry&&(Ye=Ye.concat(vn(Et.geometry.coordinates)))})),Ye},na=Ui,Ca=Xr,ua={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Mn=Object.keys(ua);function oo(K){for(var pe=Ca(),Ye=Fn(K),Et=0;Et<Ye.length;Et++)pe.include(Ye[Et]);return pe}St.exports=function(K){return oo(K).bbox()},St.exports.polygon=function(K){return oo(K).polygon()},St.exports.bboxify=function(K){return na(K).map((function(pe){pe&&Mn.some((function(Ye){return!!pe[Ye]&&ua[Ye].indexOf(pe.type)!==-1}))&&(pe.bbox=oo(pe).bbox(),this.update(pe))}))};var _a=n(St.exports),Hi=-90;function Ya(K,pe){var Ye=Hi,Et=90,Ut=Hi,Nt=90,Qt=270,Gr=-270;K.forEach((function(en){var hn=_a(en),nn=hn[1],Xn=hn[3],En=hn[0],$n=hn[2];nn>Ye&&(Ye=nn),Xn<Et&&(Et=Xn),Xn>Ut&&(Ut=Xn),nn<Nt&&(Nt=nn),En<Qt&&(Qt=En),$n>Gr&&(Gr=$n)}));var on=pe;return Ye+on.lat>85&&(on.lat=85-Ye),Ut+on.lat>90&&(on.lat=90-Ut),Et+on.lat<-85&&(on.lat=-85-Et),Nt+on.lat<Hi&&(on.lat=Hi-Nt),Qt+on.lng<=-270&&(on.lng+=360*Math.ceil(Math.abs(on.lng)/360)),Gr+on.lng>=270&&(on.lng-=360*Math.ceil(Math.abs(on.lng)/360)),on}function Xs(K,pe){var Ye=Ya(K.map((function(Et){return Et.toGeoJSON()})),pe);K.forEach((function(Et){var Ut,Nt=Et.getCoordinates(),Qt=function(on){var en={lng:on[0]+Ye.lng,lat:on[1]+Ye.lat};return[en.lng,en.lat]},Gr=function(on){return on.map((function(en){return Qt(en)}))};Et.type===E.POINT?Ut=Qt(Nt):Et.type===E.LINE_STRING||Et.type===E.MULTI_POINT?Ut=Nt.map(Qt):Et.type===E.POLYGON||Et.type===E.MULTI_LINE_STRING?Ut=Nt.map(Gr):Et.type===E.MULTI_POLYGON&&(Ut=Nt.map((function(on){return on.map((function(en){return Gr(en)}))}))),Et.incomingCoords(Ut)}))}var ki={onSetup:function(K){var pe=this,Ye={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:K.featureIds||[]};return this.setSelected(Ye.initiallySelectedFeatureIds.filter((function(Et){return pe.getFeature(Et)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Ye},fireUpdate:function(){this.map.fire(k.UPDATE,{action:L.MOVE,features:this.getSelected().map((function(K){return K.toGeoJSON()}))})},fireActionable:function(){var K=this,pe=this.getSelected(),Ye=pe.filter((function(Gr){return K.isInstanceOf("MultiFeature",Gr)})),Et=!1;if(pe.length>1){Et=!0;var Ut=pe[0].type.replace("Multi","");pe.forEach((function(Gr){Gr.type.replace("Multi","")!==Ut&&(Et=!1)}))}var Nt=Ye.length>0,Qt=pe.length>0;this.setActionableState({combineFeatures:Et,uncombineFeatures:Nt,trash:Qt})},getUniqueIds:function(K){return K.length?K.map((function(pe){return pe.properties.id})).filter((function(pe){return pe!==void 0})).reduce((function(pe,Ye){return pe.add(Ye),pe}),new H).values():[]},stopExtendedInteractions:function(K){K.boxSelectElement&&(K.boxSelectElement.parentNode&&K.boxSelectElement.parentNode.removeChild(K.boxSelectElement),K.boxSelectElement=null),this.map.dragPan.enable(),K.boxSelecting=!1,K.canBoxSelect=!1,K.dragMoving=!1,K.canDragMove=!1},onStop:function(){jt.enable(this)},onMouseMove:function(K,pe){return Dr(pe)&&K.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(K),!0},onMouseOut:function(K){return!K.dragMoving||this.fireUpdate()}};ki.onTap=ki.onClick=function(K,pe){return or(pe)?this.clickAnywhere(K,pe):Pr(N.VERTEX)(pe)?this.clickOnVertex(K,pe):Dr(pe)?this.clickOnFeature(K,pe):void 0},ki.clickAnywhere=function(K){var pe=this,Ye=this.getSelectedIds();Ye.length&&(this.clearSelectedFeatures(),Ye.forEach((function(Et){return pe.doRender(Et)}))),jt.enable(this),this.stopExtendedInteractions(K)},ki.clickOnVertex=function(K,pe){this.changeMode(P.DIRECT_SELECT,{featureId:pe.featureTarget.properties.parent,coordPath:pe.featureTarget.properties.coord_path,startPos:pe.lngLat}),this.updateUIClasses({mouse:v.MOVE})},ki.startOnActiveFeature=function(K,pe){this.stopExtendedInteractions(K),this.map.dragPan.disable(),this.doRender(pe.featureTarget.properties.id),K.canDragMove=!0,K.dragMoveLocation=pe.lngLat},ki.clickOnFeature=function(K,pe){var Ye=this;jt.disable(this),this.stopExtendedInteractions(K);var Et=Gt(pe),Ut=this.getSelectedIds(),Nt=pe.featureTarget.properties.id,Qt=this.isSelected(Nt);if(!Et&&Qt&&this.getFeature(Nt).type!==E.POINT)return this.changeMode(P.DIRECT_SELECT,{featureId:Nt});Qt&&Et?(this.deselect(Nt),this.updateUIClasses({mouse:v.POINTER}),Ut.length===1&&jt.enable(this)):!Qt&&Et?(this.select(Nt),this.updateUIClasses({mouse:v.MOVE})):Qt||Et||(Ut.forEach((function(Gr){return Ye.doRender(Gr)})),this.setSelected(Nt),this.updateUIClasses({mouse:v.MOVE})),this.doRender(Nt)},ki.onMouseDown=function(K,pe){return fr(pe)?this.startOnActiveFeature(K,pe):this.drawConfig.boxSelect&&ar(pe)?this.startBoxSelect(K,pe):void 0},ki.startBoxSelect=function(K,pe){this.stopExtendedInteractions(K),this.map.dragPan.disable(),K.boxSelectStartLocation=Rt(pe.originalEvent,this.map.getContainer()),K.canBoxSelect=!0},ki.onTouchStart=function(K,pe){if(fr(pe))return this.startOnActiveFeature(K,pe)},ki.onDrag=function(K,pe){return K.canDragMove?this.dragMove(K,pe):this.drawConfig.boxSelect&&K.canBoxSelect?this.whileBoxSelect(K,pe):void 0},ki.whileBoxSelect=function(K,pe){K.boxSelecting=!0,this.updateUIClasses({mouse:v.ADD}),K.boxSelectElement||(K.boxSelectElement=document.createElement("div"),K.boxSelectElement.classList.add(d.BOX_SELECT),this.map.getContainer().appendChild(K.boxSelectElement));var Ye=Rt(pe.originalEvent,this.map.getContainer()),Et=Math.min(K.boxSelectStartLocation.x,Ye.x),Ut=Math.max(K.boxSelectStartLocation.x,Ye.x),Nt=Math.min(K.boxSelectStartLocation.y,Ye.y),Qt=Math.max(K.boxSelectStartLocation.y,Ye.y),Gr="translate("+Et+"px, "+Nt+"px)";K.boxSelectElement.style.transform=Gr,K.boxSelectElement.style.WebkitTransform=Gr,K.boxSelectElement.style.width=Ut-Et+"px",K.boxSelectElement.style.height=Qt-Nt+"px"},ki.dragMove=function(K,pe){K.dragMoving=!0,pe.originalEvent.stopPropagation();var Ye={lng:pe.lngLat.lng-K.dragMoveLocation.lng,lat:pe.lngLat.lat-K.dragMoveLocation.lat};Xs(this.getSelected(),Ye),K.dragMoveLocation=pe.lngLat},ki.onTouchEnd=ki.onMouseUp=function(K,pe){var Ye=this;if(K.dragMoving)this.fireUpdate();else if(K.boxSelecting){var Et=[K.boxSelectStartLocation,Rt(pe.originalEvent,this.map.getContainer())],Ut=this.featuresAt(null,Et,"click"),Nt=this.getUniqueIds(Ut).filter((function(Qt){return!Ye.isSelected(Qt)}));Nt.length&&(this.select(Nt),Nt.forEach((function(Qt){return Ye.doRender(Qt)})),this.updateUIClasses({mouse:v.MOVE}))}this.stopExtendedInteractions(K)},ki.toDisplayFeatures=function(K,pe,Ye){pe.properties.active=this.isSelected(pe.properties.id)?M.ACTIVE:M.INACTIVE,Ye(pe),this.fireActionable(),pe.properties.active===M.ACTIVE&&pe.geometry.type!==E.POINT&&Zt(pe).forEach(Ye)},ki.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},ki.onCombineFeatures=function(){var K=this.getSelected();if(!(K.length===0||K.length<2)){for(var pe=[],Ye=[],Et=K[0].type.replace("Multi",""),Ut=0;Ut<K.length;Ut++){var Nt=K[Ut];if(Nt.type.replace("Multi","")!==Et)return;Nt.type.includes("Multi")?Nt.getCoordinates().forEach((function(Gr){pe.push(Gr)})):pe.push(Nt.getCoordinates()),Ye.push(Nt.toGeoJSON())}if(Ye.length>1){var Qt=this.newFeature({type:E.FEATURE,properties:Ye[0].properties,geometry:{type:"Multi"+Et,coordinates:pe}});this.addFeature(Qt),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Qt.id]),this.map.fire(k.COMBINE_FEATURES,{createdFeatures:[Qt.toGeoJSON()],deletedFeatures:Ye})}this.fireActionable()}},ki.onUncombineFeatures=function(){var K=this,pe=this.getSelected();if(pe.length!==0){for(var Ye=[],Et=[],Ut=function(Qt){var Gr=pe[Qt];K.isInstanceOf("MultiFeature",Gr)&&(Gr.getFeatures().forEach((function(on){K.addFeature(on),on.properties=Gr.properties,Ye.push(on.toGeoJSON()),K.select([on.id])})),K.deleteFeature(Gr.id,{silent:!0}),Et.push(Gr.toGeoJSON()))},Nt=0;Nt<pe.length;Nt++)Ut(Nt);Ye.length>1&&this.map.fire(k.UNCOMBINE_FEATURES,{createdFeatures:Ye,deletedFeatures:Et}),this.fireActionable()}};var bl=Pr(N.VERTEX),zo=Pr(N.MIDPOINT),xi={fireUpdate:function(){this.map.fire(k.UPDATE,{action:L.CHANGE_COORDINATES,features:this.getSelected().map((function(K){return K.toGeoJSON()}))})},fireActionable:function(K){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:K.selectedCoordPaths.length>0})},startDragging:function(K,pe){this.map.dragPan.disable(),K.canDragMove=!0,K.dragMoveLocation=pe.lngLat},stopDragging:function(K){this.map.dragPan.enable(),K.dragMoving=!1,K.canDragMove=!1,K.dragMoveLocation=null},onVertex:function(K,pe){this.startDragging(K,pe);var Ye=pe.featureTarget.properties,Et=K.selectedCoordPaths.indexOf(Ye.coord_path);Gt(pe)||Et!==-1?Gt(pe)&&Et===-1&&K.selectedCoordPaths.push(Ye.coord_path):K.selectedCoordPaths=[Ye.coord_path];var Ut=this.pathsToCoordinates(K.featureId,K.selectedCoordPaths);this.setSelectedCoordinates(Ut)},onMidpoint:function(K,pe){this.startDragging(K,pe);var Ye=pe.featureTarget.properties;K.feature.addCoordinate(Ye.coord_path,Ye.lng,Ye.lat),this.fireUpdate(),K.selectedCoordPaths=[Ye.coord_path]},pathsToCoordinates:function(K,pe){return pe.map((function(Ye){return{feature_id:K,coord_path:Ye}}))},onFeature:function(K,pe){K.selectedCoordPaths.length===0?this.startDragging(K,pe):this.stopDragging(K)},dragFeature:function(K,pe,Ye){Xs(this.getSelected(),Ye),K.dragMoveLocation=pe.lngLat},dragVertex:function(K,pe,Ye){for(var Et=K.selectedCoordPaths.map((function(Gr){return K.feature.getCoordinate(Gr)})),Ut=Ya(Et.map((function(Gr){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:Gr}}})),Ye),Nt=0;Nt<Et.length;Nt++){var Qt=Et[Nt];K.feature.updateCoordinate(K.selectedCoordPaths[Nt],Qt[0]+Ut.lng,Qt[1]+Ut.lat)}},clickNoTarget:function(){this.changeMode(P.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(P.SIMPLE_SELECT)},clickActiveFeature:function(K){K.selectedCoordPaths=[],this.clearSelectedCoordinates(),K.feature.changed()},onSetup:function(K){var pe=K.featureId,Ye=this.getFeature(pe);if(!Ye)throw new Error("You must provide a featureId to enter direct_select mode");if(Ye.type===E.POINT)throw new TypeError("direct_select mode doesn't handle point features");var Et={featureId:pe,feature:Ye,dragMoveLocation:K.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:K.coordPath?[K.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(pe,Et.selectedCoordPaths)),this.setSelected(pe),jt.disable(this),this.setActionableState({trash:!0}),Et},onStop:function(){jt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(K,pe,Ye){K.featureId===pe.properties.id?(pe.properties.active=M.ACTIVE,Ye(pe),Zt(pe,{map:this.map,midpoints:!0,selectedPaths:K.selectedCoordPaths}).forEach(Ye)):(pe.properties.active=M.INACTIVE,Ye(pe)),this.fireActionable(K)},onTrash:function(K){K.selectedCoordPaths.sort((function(pe,Ye){return Ye.localeCompare(pe,"en",{numeric:!0})})).forEach((function(pe){return K.feature.removeCoordinate(pe)})),this.fireUpdate(),K.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(K),K.feature.isValid()===!1&&(this.deleteFeature([K.featureId]),this.changeMode(P.SIMPLE_SELECT,{}))},onMouseMove:function(K,pe){var Ye=fr(pe),Et=bl(pe),Ut=zo(pe),Nt=K.selectedCoordPaths.length===0;return Ye&&Nt||Et&&!Nt?this.updateUIClasses({mouse:v.MOVE}):this.updateUIClasses({mouse:v.NONE}),(Et||Ye||Ut)&&K.dragMoving&&this.fireUpdate(),this.stopDragging(K),!0},onMouseOut:function(K){return K.dragMoving&&this.fireUpdate(),!0}};xi.onTouchStart=xi.onMouseDown=function(K,pe){return bl(pe)?this.onVertex(K,pe):fr(pe)?this.onFeature(K,pe):zo(pe)?this.onMidpoint(K,pe):void 0},xi.onDrag=function(K,pe){if(K.canDragMove===!0){K.dragMoving=!0,pe.originalEvent.stopPropagation();var Ye={lng:pe.lngLat.lng-K.dragMoveLocation.lng,lat:pe.lngLat.lat-K.dragMoveLocation.lat};K.selectedCoordPaths.length>0?this.dragVertex(K,pe,Ye):this.dragFeature(K,pe,Ye),K.dragMoveLocation=pe.lngLat}},xi.onClick=function(K,pe){return or(pe)?this.clickNoTarget(K,pe):fr(pe)?this.clickActiveFeature(K,pe):Nr(pe)?this.clickInactive(K,pe):void this.stopDragging(K)},xi.onTap=function(K,pe){return or(pe)?this.clickNoTarget(K,pe):fr(pe)?this.clickActiveFeature(K,pe):Nr(pe)?this.clickInactive(K,pe):void 0},xi.onTouchEnd=xi.onMouseUp=function(K){K.dragMoving&&this.fireUpdate(),this.stopDragging(K)};var So={};function Fs(K,pe){return!!K.lngLat&&K.lngLat.lng===pe[0]&&K.lngLat.lat===pe[1]}So.onSetup=function(){var K=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:[]}});return this.addFeature(K),this.clearSelectedFeatures(),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.POINT),this.setActionableState({trash:!0}),{point:K}},So.stopDrawingAndRemove=function(K){this.deleteFeature([K.point.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)},So.onTap=So.onClick=function(K,pe){this.updateUIClasses({mouse:v.MOVE}),K.point.updateCoordinate("",pe.lngLat.lng,pe.lngLat.lat),this.map.fire(k.CREATE,{features:[K.point.toGeoJSON()]}),this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.point.id]})},So.onStop=function(K){this.activateUIButton(),K.point.getCoordinate().length||this.deleteFeature([K.point.id],{silent:!0})},So.toDisplayFeatures=function(K,pe,Ye){var Et=pe.properties.id===K.point.id;if(pe.properties.active=Et?M.ACTIVE:M.INACTIVE,!Et)return Ye(pe)},So.onTrash=So.stopDrawingAndRemove,So.onKeyUp=function(K,pe){if(Tt(pe)||Oe(pe))return this.stopDrawingAndRemove(K,pe)};var Mo={onSetup:function(){var K=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.POLYGON,coordinates:[[]]}});return this.addFeature(K),this.clearSelectedFeatures(),jt.disable(this),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.POLYGON),this.setActionableState({trash:!0}),{polygon:K,currentVertexPosition:0}},clickAnywhere:function(K,pe){if(K.currentVertexPosition>0&&Fs(pe,K.polygon.coordinates[0][K.currentVertexPosition-1]))return this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.polygon.id]});this.updateUIClasses({mouse:v.ADD}),K.polygon.updateCoordinate("0."+K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),K.currentVertexPosition++,K.polygon.updateCoordinate("0."+K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(K){return this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.polygon.id]})},onMouseMove:function(K,pe){K.polygon.updateCoordinate("0."+K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),er(pe)&&this.updateUIClasses({mouse:v.POINTER})}};Mo.onTap=Mo.onClick=function(K,pe){return er(pe)?this.clickOnVertex(K,pe):this.clickAnywhere(K,pe)},Mo.onKeyUp=function(K,pe){Tt(pe)?(this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)):Oe(pe)&&this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.polygon.id]})},Mo.onStop=function(K){this.updateUIClasses({mouse:v.NONE}),jt.enable(this),this.activateUIButton(),this.getFeature(K.polygon.id)!==void 0&&(K.polygon.removeCoordinate("0."+K.currentVertexPosition),K.polygon.isValid()?this.map.fire(k.CREATE,{features:[K.polygon.toGeoJSON()]}):(this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT,{},{silent:!0})))},Mo.toDisplayFeatures=function(K,pe,Ye){var Et=pe.properties.id===K.polygon.id;if(pe.properties.active=Et?M.ACTIVE:M.INACTIVE,!Et)return Ye(pe);if(pe.geometry.coordinates.length!==0){var Ut=pe.geometry.coordinates[0].length;if(!(Ut<3)){if(pe.properties.meta=N.FEATURE,Ye(Bt(K.polygon.id,pe.geometry.coordinates[0][0],"0.0",!1)),Ut>3){var Nt=pe.geometry.coordinates[0].length-3;Ye(Bt(K.polygon.id,pe.geometry.coordinates[0][Nt],"0."+Nt,!1))}if(Ut<=4){var Qt=[[pe.geometry.coordinates[0][0][0],pe.geometry.coordinates[0][0][1]],[pe.geometry.coordinates[0][1][0],pe.geometry.coordinates[0][1][1]]];if(Ye({type:E.FEATURE,properties:pe.properties,geometry:{coordinates:Qt,type:E.LINE_STRING}}),Ut===3)return}return Ye(pe)}}},Mo.onTrash=function(K){this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)};var so={onSetup:function(K){var pe,Ye,Et=(K=K||{}).featureId,Ut="forward";if(Et){if(!(pe=this.getFeature(Et)))throw new Error("Could not find a feature with the provided featureId");var Nt=K.from;if(Nt&&Nt.type==="Feature"&&Nt.geometry&&Nt.geometry.type==="Point"&&(Nt=Nt.geometry),Nt&&Nt.type==="Point"&&Nt.coordinates&&Nt.coordinates.length===2&&(Nt=Nt.coordinates),!Nt||!Array.isArray(Nt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Qt=pe.coordinates.length-1;if(pe.coordinates[Qt][0]===Nt[0]&&pe.coordinates[Qt][1]===Nt[1])Ye=Qt+1,pe.addCoordinate.apply(pe,[Ye].concat(pe.coordinates[Qt]));else{if(pe.coordinates[0][0]!==Nt[0]||pe.coordinates[0][1]!==Nt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Ut="backwards",Ye=0,pe.addCoordinate.apply(pe,[Ye].concat(pe.coordinates[0]))}}else pe=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.LINE_STRING,coordinates:[]}}),Ye=0,this.addFeature(pe);return this.clearSelectedFeatures(),jt.disable(this),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.LINE),this.setActionableState({trash:!0}),{line:pe,currentVertexPosition:Ye,direction:Ut}},clickAnywhere:function(K,pe){if(K.currentVertexPosition>0&&Fs(pe,K.line.coordinates[K.currentVertexPosition-1])||K.direction==="backwards"&&Fs(pe,K.line.coordinates[K.currentVertexPosition+1]))return this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.line.id]});this.updateUIClasses({mouse:v.ADD}),K.line.updateCoordinate(K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),K.direction==="forward"?(K.currentVertexPosition++,K.line.updateCoordinate(K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)):K.line.addCoordinate(0,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(K){return this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.line.id]})},onMouseMove:function(K,pe){K.line.updateCoordinate(K.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),er(pe)&&this.updateUIClasses({mouse:v.POINTER})}};so.onTap=so.onClick=function(K,pe){if(er(pe))return this.clickOnVertex(K,pe);this.clickAnywhere(K,pe)},so.onKeyUp=function(K,pe){Oe(pe)?this.changeMode(P.SIMPLE_SELECT,{featureIds:[K.line.id]}):Tt(pe)&&(this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT))},so.onStop=function(K){jt.enable(this),this.activateUIButton(),this.getFeature(K.line.id)!==void 0&&(K.line.removeCoordinate(""+K.currentVertexPosition),K.line.isValid()?this.map.fire(k.CREATE,{features:[K.line.toGeoJSON()]}):(this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT,{},{silent:!0})))},so.onTrash=function(K){this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)},so.toDisplayFeatures=function(K,pe,Ye){var Et=pe.properties.id===K.line.id;if(pe.properties.active=Et?M.ACTIVE:M.INACTIVE,!Et)return Ye(pe);pe.geometry.coordinates.length<2||(pe.properties.meta=N.FEATURE,Ye(Bt(K.line.id,pe.geometry.coordinates[K.direction==="forward"?pe.geometry.coordinates.length-2:1],""+(K.direction==="forward"?pe.geometry.coordinates.length-2:1),!1)),Ye(pe))};var xl={simple_select:ki,direct_select:xi,draw_point:So,draw_polygon:Mo,draw_line_string:so},Za={defaultMode:P.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Mr,modes:xl,controls:{},userProperties:!1},Lc={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},cc={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Yo(K,pe){return K.map((function(Ye){return Ye.source?Ye:br(Ye,{id:Ye.id+"."+pe,source:pe==="hot"?b.HOT:b.COLD})}))}var Bs={exports:{}};(function(K,pe){var Ye="__lodash_hash_undefined__",Et=9007199254740991,Ut="[object Arguments]",Nt="[object Array]",Qt="[object Boolean]",Gr="[object Date]",on="[object Error]",en="[object Function]",hn="[object Map]",nn="[object Number]",Xn="[object Object]",En="[object Promise]",$n="[object RegExp]",Ln="[object Set]",$r="[object String]",xn="[object Symbol]",si="[object WeakMap]",Li="[object ArrayBuffer]",wi="[object DataView]",Vi=/^\[object .+?Constructor\]$/,Bi=/^(?:0|[1-9]\d*)$/,Pn={};Pn["[object Float32Array]"]=Pn["[object Float64Array]"]=Pn["[object Int8Array]"]=Pn["[object Int16Array]"]=Pn["[object Int32Array]"]=Pn["[object Uint8Array]"]=Pn["[object Uint8ClampedArray]"]=Pn["[object Uint16Array]"]=Pn["[object Uint32Array]"]=!0,Pn[Ut]=Pn[Nt]=Pn[Li]=Pn[Qt]=Pn[wi]=Pn[Gr]=Pn[on]=Pn[en]=Pn[hn]=Pn[nn]=Pn[Xn]=Pn[$n]=Pn[Ln]=Pn[$r]=Pn[si]=!1;var $a=typeof Np=="object"&&Np&&Np.Object===Object&&Np,ii=typeof self=="object"&&self&&self.Object===Object&&self,Wn=$a||ii||Function("return this")(),ws=pe&&!pe.nodeType&&pe,In=ws&&K&&!K.nodeType&&K,Sl=In&&In.exports===ws,Na=Sl&&$a.process,Ys=(function(){try{return Na&&Na.binding&&Na.binding("util")}catch{}})(),lo=Ys&&Ys.isTypedArray;function iu(tr,ur){for(var mn=-1,Tn=tr==null?0:tr.length;++mn<Tn;)if(ur(tr[mn],mn,tr))return!0;return!1}function os(tr){var ur=-1,mn=Array(tr.size);return tr.forEach((function(Tn,yi){mn[++ur]=[yi,Tn]})),mn}function ss(tr){var ur=-1,mn=Array(tr.size);return tr.forEach((function(Tn){mn[++ur]=Tn})),mn}var zl,Zs,Ja,uo=Array.prototype,sa=Function.prototype,La=Object.prototype,se=Wn["__core-js_shared__"],qe=sa.toString,dt=La.hasOwnProperty,Vt=(zl=/[^.]+$/.exec(se&&se.keys&&se.keys.IE_PROTO||""))?"Symbol(src)_1."+zl:"",sr=La.toString,Vr=RegExp("^"+qe.call(dt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rn=Sl?Wn.Buffer:void 0,kn=Wn.Symbol,Vn=Wn.Uint8Array,ci=La.propertyIsEnumerable,Ti=uo.splice,li=kn?kn.toStringTag:void 0,$i=Object.getOwnPropertySymbols,Si=rn?rn.isBuffer:void 0,Ii=(Zs=Object.keys,Ja=Object,function(tr){return Zs(Ja(tr))}),Aa=co(Wn,"DataView"),ca=co(Wn,"Map"),ba=co(Wn,"Promise"),Ss=co(Wn,"Set"),Ks=co(Wn,"WeakMap"),Su=co(Object,"create"),Es=jo(Aa),Eu=jo(ca),xa=jo(ba),Js=jo(Ss),au=jo(Ks),Ts=kn?kn.prototype:void 0,Da=Ts?Ts.valueOf:void 0;function To(tr){var ur=-1,mn=tr==null?0:tr.length;for(this.clear();++ur<mn;){var Tn=tr[ur];this.set(Tn[0],Tn[1])}}function ha(tr){var ur=-1,mn=tr==null?0:tr.length;for(this.clear();++ur<mn;){var Tn=tr[ur];this.set(Tn[0],Tn[1])}}function Qs(tr){var ur=-1,mn=tr==null?0:tr.length;for(this.clear();++ur<mn;){var Tn=tr[ur];this.set(Tn[0],Tn[1])}}function jl(tr){var ur=-1,mn=tr==null?0:tr.length;for(this.__data__=new Qs;++ur<mn;)this.add(tr[ur])}function wa(tr){var ur=this.__data__=new ha(tr);this.size=ur.size}function Tu(tr,ur){var mn=tl(tr),Tn=!mn&&Ia(tr),yi=!mn&&!Tn&&rl(tr),Rn=!mn&&!Tn&&!yi&&su(tr),A=mn||Tn||yi||Rn,y=A?(function(U,re){for(var ye=-1,ke=Array(U);++ye<U;)ke[ye]=re(ye);return ke})(tr.length,String):[],_=y.length;for(var I in tr)!dt.call(tr,I)||A&&(I=="length"||yi&&(I=="offset"||I=="parent")||Rn&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||ql(I,_))||y.push(I);return y}function Ul(tr,ur){for(var mn=tr.length;mn--;)if(El(tr[mn][0],ur))return mn;return-1}function el(tr){return tr==null?tr===void 0?"[object Undefined]":"[object Null]":li&&li in Object(tr)?(function(ur){var mn=dt.call(ur,li),Tn=ur[li];try{ur[li]=void 0;var yi=!0}catch{}var Rn=sr.call(ur);return yi&&(mn?ur[li]=Tn:delete ur[li]),Rn})(tr):(function(ur){return sr.call(ur)})(tr)}function Qa(tr){return nl(tr)&&el(tr)==Ut}function Ro(tr,ur,mn,Tn,yi){return tr===ur||(tr==null||ur==null||!nl(tr)&&!nl(ur)?tr!=tr&&ur!=ur:(function(Rn,A,y,_,I,U){var re=tl(Rn),ye=tl(A),ke=re?Nt:Ao(Rn),Ke=ye?Nt:Ao(A),yt=(ke=ke==Ut?Xn:ke)==Xn,rr=(Ke=Ke==Ut?Xn:Ke)==Xn,gr=ke==Ke;if(gr&&rl(Rn)){if(!rl(A))return!1;re=!0,yt=!1}if(gr&&!yt)return U||(U=new wa),re||su(Rn)?Vl(Rn,A,y,_,I,U):(function(jn,Bn,zi,Ri,ho,fo,Zo){switch(zi){case wi:if(jn.byteLength!=Bn.byteLength||jn.byteOffset!=Bn.byteOffset)return!1;jn=jn.buffer,Bn=Bn.buffer;case Li:return!(jn.byteLength!=Bn.byteLength||!fo(new Vn(jn),new Vn(Bn)));case Qt:case Gr:case nn:return El(+jn,+Bn);case on:return jn.name==Bn.name&&jn.message==Bn.message;case $n:case $r:return jn==Bn+"";case hn:var Ko=os;case Ln:var Hl=1&Ri;if(Ko||(Ko=ss),jn.size!=Bn.size&&!Hl)return!1;var lu=Zo.get(jn);if(lu)return lu==Bn;Ri|=2,Zo.set(jn,Bn);var il=Vl(Ko(jn),Ko(Bn),Ri,ho,fo,Zo);return Zo.delete(jn),il;case xn:if(Da)return Da.call(jn)==Da.call(Bn)}return!1})(Rn,A,ke,y,_,I,U);if(!(1&y)){var Wr=yt&&dt.call(Rn,"__wrapped__"),wn=rr&&dt.call(A,"__wrapped__");if(Wr||wn){var Un=Wr?Rn.value():Rn,Kn=wn?A.value():A;return U||(U=new wa),I(Un,Kn,y,_,U)}}return gr?(U||(U=new wa),(function(jn,Bn,zi,Ri,ho,fo){var Zo=1&zi,Ko=$l(jn),Hl=Ko.length,lu=$l(Bn).length;if(Hl!=lu&&!Zo)return!1;for(var il=Hl;il--;){var Cs=Ko[il];if(!(Zo?Cs in Bn:dt.call(Bn,Cs)))return!1}var dc=fo.get(jn);if(dc&&fo.get(Bn))return dc==Bn;var As=!0;fo.set(jn,Bn),fo.set(Bn,jn);for(var qa=Zo;++il<Hl;){var us=jn[Cs=Ko[il]],Zu=Bn[Cs];if(Ri)var Ci=Zo?Ri(Zu,us,Cs,Bn,jn,fo):Ri(us,Zu,Cs,jn,Bn,fo);if(!(Ci===void 0?us===Zu||ho(us,Zu,zi,Ri,fo):Ci)){As=!1;break}qa||(qa=Cs=="constructor")}if(As&&!qa){var uu=jn.constructor,pc=Bn.constructor;uu==pc||!("constructor"in jn)||!("constructor"in Bn)||typeof uu=="function"&&uu instanceof uu&&typeof pc=="function"&&pc instanceof pc||(As=!1)}return fo.delete(jn),fo.delete(Bn),As})(Rn,A,y,_,I,U)):!1})(tr,ur,mn,Tn,Ro,yi))}function hc(tr){return!(!Yu(tr)||(function(ur){return!!Vt&&Vt in ur})(tr))&&(ls(tr)?Vr:Vi).test(jo(tr))}function fc(tr){if(mn=(ur=tr)&&ur.constructor,Tn=typeof mn=="function"&&mn.prototype||La,ur!==Tn)return Ii(tr);var ur,mn,Tn,yi=[];for(var Rn in Object(tr))dt.call(tr,Rn)&&Rn!="constructor"&&yi.push(Rn);return yi}function Vl(tr,ur,mn,Tn,yi,Rn){var A=1&mn,y=tr.length,_=ur.length;if(y!=_&&!(A&&_>y))return!1;var I=Rn.get(tr);if(I&&Rn.get(ur))return I==ur;var U=-1,re=!0,ye=2&mn?new jl:void 0;for(Rn.set(tr,ur),Rn.set(ur,tr);++U<y;){var ke=tr[U],Ke=ur[U];if(Tn)var yt=A?Tn(Ke,ke,U,ur,tr,Rn):Tn(ke,Ke,U,tr,ur,Rn);if(yt!==void 0){if(yt)continue;re=!1;break}if(ye){if(!iu(ur,(function(rr,gr){if(Wr=gr,!ye.has(Wr)&&(ke===rr||yi(ke,rr,mn,Tn,Rn)))return ye.push(gr);var Wr}))){re=!1;break}}else if(ke!==Ke&&!yi(ke,Ke,mn,Tn,Rn)){re=!1;break}}return Rn.delete(tr),Rn.delete(ur),re}function $l(tr){return(function(ur,mn,Tn){var yi=mn(ur);return tl(ur)?yi:(function(Rn,A){for(var y=-1,_=A.length,I=Rn.length;++y<_;)Rn[I+y]=A[y];return Rn})(yi,Tn(ur))})(tr,Au,Cu)}function Co(tr,ur){var mn,Tn,yi=tr.__data__;return((Tn=typeof(mn=ur))=="string"||Tn=="number"||Tn=="symbol"||Tn=="boolean"?mn!=="__proto__":mn===null)?yi[typeof ur=="string"?"string":"hash"]:yi.map}function co(tr,ur){var mn=(function(Tn,yi){return Tn?.[yi]})(tr,ur);return hc(mn)?mn:void 0}To.prototype.clear=function(){this.__data__=Su?Su(null):{},this.size=0},To.prototype.delete=function(tr){var ur=this.has(tr)&&delete this.__data__[tr];return this.size-=ur?1:0,ur},To.prototype.get=function(tr){var ur=this.__data__;if(Su){var mn=ur[tr];return mn===Ye?void 0:mn}return dt.call(ur,tr)?ur[tr]:void 0},To.prototype.has=function(tr){var ur=this.__data__;return Su?ur[tr]!==void 0:dt.call(ur,tr)},To.prototype.set=function(tr,ur){var mn=this.__data__;return this.size+=this.has(tr)?0:1,mn[tr]=Su&&ur===void 0?Ye:ur,this},ha.prototype.clear=function(){this.__data__=[],this.size=0},ha.prototype.delete=function(tr){var ur=this.__data__,mn=Ul(ur,tr);return!(mn<0)&&(mn==ur.length-1?ur.pop():Ti.call(ur,mn,1),--this.size,!0)},ha.prototype.get=function(tr){var ur=this.__data__,mn=Ul(ur,tr);return mn<0?void 0:ur[mn][1]},ha.prototype.has=function(tr){return Ul(this.__data__,tr)>-1},ha.prototype.set=function(tr,ur){var mn=this.__data__,Tn=Ul(mn,tr);return Tn<0?(++this.size,mn.push([tr,ur])):mn[Tn][1]=ur,this},Qs.prototype.clear=function(){this.size=0,this.__data__={hash:new To,map:new(ca||ha),string:new To}},Qs.prototype.delete=function(tr){var ur=Co(this,tr).delete(tr);return this.size-=ur?1:0,ur},Qs.prototype.get=function(tr){return Co(this,tr).get(tr)},Qs.prototype.has=function(tr){return Co(this,tr).has(tr)},Qs.prototype.set=function(tr,ur){var mn=Co(this,tr),Tn=mn.size;return mn.set(tr,ur),this.size+=mn.size==Tn?0:1,this},jl.prototype.add=jl.prototype.push=function(tr){return this.__data__.set(tr,Ye),this},jl.prototype.has=function(tr){return this.__data__.has(tr)},wa.prototype.clear=function(){this.__data__=new ha,this.size=0},wa.prototype.delete=function(tr){var ur=this.__data__,mn=ur.delete(tr);return this.size=ur.size,mn},wa.prototype.get=function(tr){return this.__data__.get(tr)},wa.prototype.has=function(tr){return this.__data__.has(tr)},wa.prototype.set=function(tr,ur){var mn=this.__data__;if(mn instanceof ha){var Tn=mn.__data__;if(!ca||Tn.length<199)return Tn.push([tr,ur]),this.size=++mn.size,this;mn=this.__data__=new Qs(Tn)}return mn.set(tr,ur),this.size=mn.size,this};var Cu=$i?function(tr){return tr==null?[]:(tr=Object(tr),(function(ur,mn){for(var Tn=-1,yi=ur==null?0:ur.length,Rn=0,A=[];++Tn<yi;){var y=ur[Tn];mn(y,Tn,ur)&&(A[Rn++]=y)}return A})($i(tr),(function(ur){return ci.call(tr,ur)})))}:function(){return[]},Ao=el;function ql(tr,ur){return!!(ur=ur??Et)&&(typeof tr=="number"||Bi.test(tr))&&tr>-1&&tr%1==0&&tr<ur}function jo(tr){if(tr!=null){try{return qe.call(tr)}catch{}try{return tr+""}catch{}}return""}function El(tr,ur){return tr===ur||tr!=tr&&ur!=ur}(Aa&&Ao(new Aa(new ArrayBuffer(1)))!=wi||ca&&Ao(new ca)!=hn||ba&&Ao(ba.resolve())!=En||Ss&&Ao(new Ss)!=Ln||Ks&&Ao(new Ks)!=si)&&(Ao=function(tr){var ur=el(tr),mn=ur==Xn?tr.constructor:void 0,Tn=mn?jo(mn):"";if(Tn)switch(Tn){case Es:return wi;case Eu:return hn;case xa:return En;case Js:return Ln;case au:return si}return ur});var Ia=Qa((function(){return arguments})())?Qa:function(tr){return nl(tr)&&dt.call(tr,"callee")&&!ci.call(tr,"callee")},tl=Array.isArray,rl=Si||function(){return!1};function ls(tr){if(!Yu(tr))return!1;var ur=el(tr);return ur==en||ur=="[object GeneratorFunction]"||ur=="[object AsyncFunction]"||ur=="[object Proxy]"}function ou(tr){return typeof tr=="number"&&tr>-1&&tr%1==0&&tr<=Et}function Yu(tr){var ur=typeof tr;return tr!=null&&(ur=="object"||ur=="function")}function nl(tr){return tr!=null&&typeof tr=="object"}var su=lo?(function(tr){return function(ur){return tr(ur)}})(lo):function(tr){return nl(tr)&&ou(tr.length)&&!!Pn[el(tr)]};function Au(tr){return(ur=tr)!=null&&ou(ur.length)&&!ls(ur)?Tu(tr):fc(tr);var ur}K.exports=function(tr,ur){return Ro(tr,ur)}})(Bs,Bs.exports);var Ka=n(Bs.exports);function Eo(K,pe){return K.length===pe.length&&JSON.stringify(K.map((function(Ye){return Ye})).sort())===JSON.stringify(pe.map((function(Ye){return Ye})).sort())}var Va={Polygon:Re,LineString:Me,Point:_e,MultiPolygon:tt,MultiLineString:tt,MultiPoint:tt},wl=Object.freeze({__proto__:null,CommonSelectors:Be,constrainFeatureMovement:Ya,createMidPoint:At,createSupplementaryPoints:Zt,createVertex:Bt,doubleClickZoom:jt,euclideanDistance:Pe,featuresAt:ae,getFeatureAtAndSetCursors:de,isClick:me,isEventAtCoordinates:Fs,isTap:Ee,mapEventToBoundingBox:J,ModeHandler:r,moveFeatures:Xs,sortFeatures:ie,stringSetsAreEqual:Eo,StringSet:H,theme:Mr,toDenseArray:at}),xu=function(K,pe){var Ye={options:K=(function(Ut){Ut===void 0&&(Ut={});var Nt=br(Ut);return Ut.controls||(Nt.controls={}),Ut.displayControlsDefault===!1?Nt.controls=br(cc,Ut.controls):Nt.controls=br(Lc,Ut.controls),(Nt=br(Za,Nt)).styles=Yo(Nt.styles,"cold").concat(Yo(Nt.styles,"hot")),Nt})(K)};pe=(function(Ut,Nt){return Nt.modes=P,Nt.getFeatureIdsAt=function(Qt){return ae.click({point:Qt},null,Ut).map((function(Gr){return Gr.properties.id}))},Nt.getSelectedIds=function(){return Ut.store.getSelectedIds()},Nt.getSelected=function(){return{type:E.FEATURE_COLLECTION,features:Ut.store.getSelectedIds().map((function(Qt){return Ut.store.get(Qt)})).map((function(Qt){return Qt.toGeoJSON()}))}},Nt.getSelectedPoints=function(){return{type:E.FEATURE_COLLECTION,features:Ut.store.getSelectedCoordinates().map((function(Qt){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:Qt.coordinates}}}))}},Nt.set=function(Qt){if(Qt.type===void 0||Qt.type!==E.FEATURE_COLLECTION||!Array.isArray(Qt.features))throw new Error("Invalid FeatureCollection");var Gr=Ut.store.createRenderBatch(),on=Ut.store.getAllIds().slice(),en=Nt.add(Qt),hn=new H(en);return(on=on.filter((function(nn){return!hn.has(nn)}))).length&&Nt.delete(on),Gr(),en},Nt.add=function(Qt){var Gr=JSON.parse(JSON.stringify(Lr(Qt))).features.map((function(on){if(on.id=on.id||ce(),on.geometry===null)throw new Error("Invalid geometry: null");if(Ut.store.get(on.id)===void 0||Ut.store.get(on.id).type!==on.geometry.type){var en=Va[on.geometry.type];if(en===void 0)throw new Error("Invalid geometry type: "+on.geometry.type+".");var hn=new en(Ut,on);Ut.store.add(hn)}else{var nn=Ut.store.get(on.id);nn.properties=on.properties,Ka(nn.properties,on.properties)||Ut.store.featureChanged(nn.id),Ka(nn.getCoordinates(),on.geometry.coordinates)||nn.incomingCoords(on.geometry.coordinates)}return on.id}));return Ut.store.render(),Gr},Nt.get=function(Qt){var Gr=Ut.store.get(Qt);if(Gr)return Gr.toGeoJSON()},Nt.getAll=function(){return{type:E.FEATURE_COLLECTION,features:Ut.store.getAll().map((function(Qt){return Qt.toGeoJSON()}))}},Nt.delete=function(Qt){return Ut.store.delete(Qt,{silent:!0}),Nt.getMode()!==P.DIRECT_SELECT||Ut.store.getSelectedIds().length?Ut.store.render():Ut.events.changeMode(P.SIMPLE_SELECT,void 0,{silent:!0}),Nt},Nt.deleteAll=function(){return Ut.store.delete(Ut.store.getAllIds(),{silent:!0}),Nt.getMode()===P.DIRECT_SELECT?Ut.events.changeMode(P.SIMPLE_SELECT,void 0,{silent:!0}):Ut.store.render(),Nt},Nt.changeMode=function(Qt,Gr){return Gr===void 0&&(Gr={}),Qt===P.SIMPLE_SELECT&&Nt.getMode()===P.SIMPLE_SELECT?(Eo(Gr.featureIds||[],Ut.store.getSelectedIds())||(Ut.store.setSelected(Gr.featureIds,{silent:!0}),Ut.store.render()),Nt):(Qt===P.DIRECT_SELECT&&Nt.getMode()===P.DIRECT_SELECT&&Gr.featureId===Ut.store.getSelectedIds()[0]||Ut.events.changeMode(Qt,Gr,{silent:!0}),Nt)},Nt.getMode=function(){return Ut.events.getMode()},Nt.trash=function(){return Ut.events.trash({silent:!0}),Nt},Nt.combineFeatures=function(){return Ut.events.combineFeatures({silent:!0}),Nt},Nt.uncombineFeatures=function(){return Ut.events.uncombineFeatures({silent:!0}),Nt},Nt.setFeatureProperty=function(Qt,Gr,on){return Ut.store.setFeatureProperty(Qt,Gr,on),Nt},Nt})(Ye,pe),Ye.api=pe;var Et=mr(Ye);return pe.onAdd=Et.onAdd,pe.onRemove=Et.onRemove,pe.types=S,pe.options=K,pe};function wu(K){xu(K,this)}return wu.modes=xl,wu.constants=q,wu.lib=wl,wu}))})(ww)),ww.exports}var m2e=g2e();const _9=ad(m2e);function y2e(){const t=Gb(r=>r.breakpoints.down("md"));return[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.3}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":3}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":4}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":t?5:4,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?8:6,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?7:5,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?10:9,"circle-opacity":1,"circle-color":"#009EE0"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?7.5:6.5,"circle-color":"#009EE0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":t?11:10,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":t?8.5:7.5,"circle-color":"#009EE0"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":t?8.5:6.5,"circle-color":"#404040"}}]}const Nk=t=>{const e=ee.useRef(null),r=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=ee.useRef(!1),[i,a]=ee.useState(!1),[s,o]=ee.useState(),u=y2e(),h=ee.useCallback(f=>{console.log("MlFeatureEditor mode change to "+f.mode),typeof t.onFinish=="function"&&f.mode==="simple_select"&&t.onFinish()},[t.onFinish]);return ee.useEffect(()=>{r.map&&!n.current&&(n.current=!0,r.map.map.style&&r.map.map.getSource("mapbox-gl-draw-cold")&&e.current&&e.current?.remove(),e.current=new _9({displayControlsDefault:!1,defaultMode:t.mode||"simple_select",modes:Object.assign({},_9.modes),userProperties:!0,styles:u}),r.map.addControl(e.current,"top-left",r.componentId),r.map.on("draw.modechange",h,r.componentId),a(!0))},[r.map,t,n,h]),ee.useEffect(()=>{if(!r.map||!i)return;const f=()=>{if(e.current){const d=e.current.getAll?.();o(d?.features),typeof t.onChange=="function"&&t.onChange(d?.features)}};return r.map.on("mouseup",f),r.map.on("touchend",f),()=>{r.map&&(r.map.map.off("mouseup",f),r.map.map.off("touchend",f))}},[i,r.map]),ee.useEffect(()=>{e.current&&t.geojson?.geometry&&e.current.set({type:"FeatureCollection",features:[t.geojson]})},[t.geojson,i]),ee.useEffect(()=>{t.mode&&e.current&&e.current?.getMode?.()!==t.mode&&(e.current?.changeMode?.(t.mode),t.mode!=="simple_select"&&t.mode!=="direct_select"&&e.current.set({type:"FeatureCollection",features:[]}))},[t.mode,r.map]),{feature:s,drawToolsReady:i,draw:e.current}};try{Nk.displayName="useFeatureEditor",Nk.__docgenInfo={description:"GeoJson Feature editor that allows to create or manipulate GeoJson data",displayName:"useFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const _S=t=>(Nk({mode:t.mode,geojson:t.geojson,onChange:t.onChange,onFinish:t.onFinish,mapId:t.mapId}),Z.jsx(Z.Fragment,{}));try{_S.displayName="MlFeatureEditor",_S.__docgenInfo={description:"",displayName:"MlFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const b9=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function v2e(t){return typeof t.options.source=="string"?{source:t.options.source}:t.geojson&&(!t.options?.source||typeof t?.options?.source!="string"&&t.options?.source?.attribution&&!t.options?.source?.type)?{source:{type:"geojson",data:t.geojson||"",attribution:typeof t?.options?.source!="string"&&t.options.source?.attribution?t.options.source?.attribution:""}}:{}}function _2e(t,e){if(t?.insertBeforeLayer)return t.insertBeforeLayer;if(t?.insertBeforeFirstSymbolLayer)return e?.map?.firstSymbolLayer}function Kd(t){const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(""),n=ee.useRef(""),i=ee.useRef(""),[a,s]=ee.useState(),o=ee.useRef(t.layerId||(t.idPrefix?t.idPrefix:"Layer-")+e.componentId),u=ee.useCallback(()=>{if(!e.map||e?.map.cancelled||(e.map.map.getLayer(o.current)&&e.cleanup(),typeof t?.options?.source!="string"&&e.map.map.getSource(o.current)&&e.map.map.removeSource(o.current),typeof t.options.source=="string"&&(t.options.source===""||!e.map.map.getSource(t.options.source)))||typeof t?.options?.source!="string"&&!t.geojson&&!t?.options?.source?.data&&t?.options?.type!=="background"||typeof t.options.type>"u")return;try{e.map.addLayer({...t.options,...v2e(t),id:o.current},_2e(t,e),e.componentId)}catch(d){console.error("Failed to add layer:",d)}s(()=>e.map?.map.getLayer(o.current));const h=()=>{e.map?.map.getLayer(o.current)||u()};e.map.on("styledata",h,e.componentId);const f=(d,b,{source_id:v})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===v&&u()};e.map.wrapper.on("addsource",f,e.componentId),n.current=JSON.stringify(t.options?.paint),i.current=JSON.stringify(t.options?.layout),r.current=t.options.type},[t,e]);return ee.useEffect(()=>{e.map&&(!t.geojson&&!t.options.source&&t?.options?.type!=="background"||e.map?.cancelled===!1&&e?.map?.map?.getLayer?.(o.current)&&(b9.indexOf(t.options.type)===-1||b9.indexOf(t.options.type)!==-1&&t.options.type===r.current)||u())},[e.map,e.mapIsReady,t,u]),ee.useEffect(()=>{e.map?.cancelled===!0||!e.map?.map?.getSource?.(o.current)||e.map.map.getSource(o.current)?.setData?.(t.geojson)},[t.geojson,e.map,t.options.type]),ee.useEffect(()=>{if(e.map?.cancelled===!0||!e.map||!e.map?.map?.getLayer?.(o.current)||t.options.type!==r.current)return;let h;const f=JSON.stringify(t.options.layout);if(t.options.layout&&f!==i.current){const b=JSON.parse(i.current);for(h in t.options.layout)t.options.layout?.[h]&&t.options.layout[h]!==b[h]&&e.map.map.setLayoutProperty(o.current,h,t.options.layout[h]);i.current=f}const d=JSON.stringify(t.options.paint);if(d!==n.current){const b=JSON.parse(n.current);for(h in t.options.paint)t.options.paint?.[h]&&t.options.paint[h]!==b[h]&&e.map.map.setPaintProperty(o.current,h,t.options.paint[h]);n.current=d}},[t.options,e.map]),ee.useEffect(()=>{!t.insertBeforeLayer||!e.map||!e.map.getLayer(t.insertBeforeLayer)||!e.map.getLayer(o.current)||e.map.moveLayer(o.current,t.insertBeforeLayer)},[e.map,t.insertBeforeLayer]),ee.useEffect(()=>()=>{e.cleanup()},[]),ee.useEffect(()=>{if(typeof t?.options?.source!="string"||!e.map)return;const h=()=>{typeof t?.options?.source=="string"&&e?.map?.getSource?.(t.options.source)&&!e.map.getLayer(o.current)&&u()};e.map.on("sourcedataloading",h);const f=(d,b,{source_id:v})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===v&&u()};return e.map.wrapper.on("addsource",f),()=>{e?.map&&(e.map.off("sourcedataloading",h),e.map.wrapper.off("addsource",f))}},[e.map,t.options?.source]),ee.useEffect(()=>{if(!t.onClick||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onClick;return e.map?.on("click",o.current,h),()=>{h&&e?.map&&e.map?.off("click",o.current,h)}},[e.map,t.onClick]),ee.useEffect(()=>{if(!t.onHover||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onHover;return e.map?.on("mousemove",o.current,h),()=>{h&&e?.map&&e.map?.off("mousemove",o.current,h)}},[e.map,t.onHover]),ee.useEffect(()=>{if(!t.onLeave||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onLeave;return e.map?.on("mouseleave",o.current,h),()=>{h&&e?.map&&e.map?.off("mouseleave",o.current,h)}},[e.map,t.onLeave]),{map:e.map,layer:a,layerId:o.current,componentId:e.componentId,mapHook:e}}Kd.defaultProps={};const Lk=t=>(Kd({mapId:t.mapId,layerId:t.layerId||"MlFillExtrusionLayer-"+Ec(),options:{id:"",type:"fill-extrusion",source:t.sourceId||"openmaptiles","source-layer":t.sourceLayer||"building",minzoom:t.minZoom||6,paint:{...t.paint}},insertBeforeFirstSymbolLayer:!0}),Z.jsx(Z.Fragment,{}));Lk.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}};try{Lk.displayName="MlFillExtrusionLayer",Lk.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId",displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component",name:"layerId",required:!1,type:{name:"string | undefined"}},paint:{defaultValue:{value:`{
		'fill-extrusion-color': 'hsl(196, 61%, 83%)',
		'fill-extrusion-height': {
			property: 'render_height',
			type: 'identity',
		},
		'fill-extrusion-base': {
			property: 'render_min_height',
			type: 'identity',
		},
		'fill-extrusion-opacity': 1,
	}`},description:`Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All
available properties are documented in the MapLibreGl documentation
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion`,name:"paint",required:!1,type:{name:"object | undefined"}},sourceId:{defaultValue:null,description:`Source id of a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceId",required:!1,type:{name:"string | undefined"}},sourceLayer:{defaultValue:null,description:`Layer id from a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceLayer",required:!1,type:{name:"string | undefined"}},minZoom:{defaultValue:null,description:`This layer will be hidden for zoom levels lower than defined on this property
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom`,name:"minZoom",required:!1,type:{name:"number | undefined"}}}}}catch{}const GZ=(t,e)=>{switch(t){case"fill":return e?.fill?e.fill:{"fill-color":"#009EE0","fill-outline-color":"#009EE0"};case"line":return e?.line?(console.log(e.line),e.line):{"line-color":"#009EE0","line-width":4,"line-blur":0};case"circle":return e?.circle?e.circle:{"circle-color":"#009EE0","circle-stroke-color":"#fff","circle-stroke-width":2,"circle-radius":5};default:return{}}},x9={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},bS=t=>t?.type==="Feature"?x9?.[t?.geometry?.type]?x9[t.geometry.type]:"circle":t?.type==="FeatureCollection"?t.features.length?bS(t.features[0]):"circle":"fill";function iN(t){const e=pa({mapId:t.mapId}),[r,n]=ee.useState(),i=ee.useRef(t.sourceId||(t.idPrefix?t.idPrefix:"Source-")+e.componentId),a=ee.useCallback(()=>{if(e.map&&e.map?.style?._layers){for(const[o,u]of Object.entries(e.map.style._layers))u.source===i.current&&e.map.removeLayer(o);e.map.getSource(i.current)&&e.map.removeSource(i.current)}},[e.map]),s=ee.useCallback(()=>{e.map&&(t.source.type==="geojson"&&!t.source.data||(e.map.map.getSource(i.current)&&a(),e.map?.addSource(i.current,{...t.source}),n(e.map.map.getSource(i.current))))},[t,e,a]);return ee.useEffect(()=>{e.map?.map?.getSource(i.current)&&e.map.map.getSource(i.current)?.setData?.(t.source.data)},[t.source?.data]),ee.useEffect(()=>{e?.map?.map?.getSource?.(t.sourceId)&&t.sourceId===i.current||(i.current=t.sourceId,s())},[e.map,t,s]),ee.useEffect(()=>{if(!e.map)return;const o=()=>{e?.map?.getSource?.(t.sourceId)||s()};return e.map.on("styledata",o),()=>{e?.map&&e.map.off("styledata",o)}},[e.map,s]),ee.useEffect(()=>()=>{a()},[a]),{map:e.map,source:r,componentId:e.componentId,mapHook:e}}const Ac=t=>{const e=t.type||bS(t.geojson),r=ee.useRef(t.layerId||"MlGeoJsonLayer-"+Ec()),n=`label-${r.current}`;return ee.useEffect(()=>{t.layerId?r.current=t.layerId:r.current="MlGeoJsonLayer-"+Ec()},[t.layerId]),iN({mapId:t.mapId,sourceId:"source-"+r.current,source:{type:"geojson",data:t.geojson,...typeof t?.options?.source<"u"&&typeof t?.options?.source!="string"?t.options.source:{}}}),Kd({mapId:t.mapId,layerId:r.current,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},paint:{...t.paint||GZ(e,t.defaultPaintOverrides),...t?.options?.paint},layout:{...t?.layout||{},...t?.options?.layout},type:e},insertBeforeLayer:t.insertBeforeLayer,onHover:t.onHover,onClick:t.onClick,onLeave:t.onLeave}),Kd({mapId:t.mapId,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},id:n,type:"symbol",maxzoom:24,minzoom:1,...t?.labelOptions?t.labelOptions:{},...t?.options?.filter?{filter:t.options.filter}:{},layout:{"text-font":["Open Sans Regular"],"text-field":`{${t.labelProp}}`,"text-size":12,"text-anchor":"top",...t?.labelOptions?.layout?t.labelOptions.layout:{},visibility:t?.layout?.visibility??t?.options?.layout?.visibility??"visible"},paint:{"text-halo-width":1,"text-halo-color":"#fefefe","text-color":"#121212",...t?.labelOptions?.paint?t.labelOptions.paint:{}}}}),Z.jsx(Z.Fragment,{})};try{Ac.displayName="MlGeoJsonLayer",Ac.__docgenInfo={description:"Adds source and layer to display GeoJSON data on the map.",displayName:"MlGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"circle"'},{value:'"line"'},{value:'"background"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: "none" | "visible" | undefined; } | { "fill-sort-key"?: DataDrivenPropertyValueSpecification<...> | undefined; visibility?: "none" | ... 1 more ... | undefined; } | ... 8 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ......'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}}}}}catch{}const aN=Yi(Z.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),Dk=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(!1),[i,a]=ee.useState(),[s,o]=ee.useState(!1),[u,h]=ee.useState(),[f,d]=ee.useState(0),b=ee.useRef(!1),v=ee.useCallback(k=>{if(!e.map||((!t.centerUserPosition&&!b.current||t.centerUserPosition)&&(t.useFlyTo?e.map.map.flyTo({center:[k.coords.longitude,k.coords.latitude],zoom:18,speed:1,curve:1}):e.map.map.setCenter([k.coords.longitude,k.coords.latitude]),b.current=!0),t.showUserLocation!==void 0&&!t.showUserLocation))return;const L=Mh([k.coords.longitude,k.coords.latitude]);a(L),h(WZ(L,k.coords.accuracy/1e3))},[e.map,t]),S=()=>{console.log("Access of user location denied"),o(!0)},E=ee.useMemo(()=>{if(!i)return;const k=.02,L=f-15,N=f+15,B=Qxe(i,k,L,N,{steps:65});return B.geometry.coordinates.push(i.geometry.coordinates),B.geometry.coordinates.slice(0,0),B},[f,i]),P=k=>{k?.alpha&&d(-k.alpha)};return ee.useEffect(()=>{if(r){const k=P;return window.addEventListener("deviceorientation",k),()=>{window.removeEventListener("deviceorientation",k)}}else b.current=!1},[r]),ee.useEffect(()=>{if(e.map&&r){const k=navigator.geolocation.watchPosition(v,S);return()=>{navigator.geolocation.clearWatch(k)}}},[e.map,r,v]),ee.useEffect(()=>{if(u?.type){const k=e.map?.getBounds(),L=[k?._ne.lng,k?._ne.lat,k?._sw.lng,k?._sw.lat],N=ah(u);$be(zz(L),zz(N))||e.map?.fitBounds(N,{padding:{top:25,bottom:25}})}},[u]),Z.jsxs(Z.Fragment,{children:[r&&i&&Z.jsx(Ac,{geojson:u,type:"fill",paint:{"fill-color":"#cbd300","fill-opacity":.3,...t.accuracyPaint},insertBeforeLayer:t.insertBeforeLayer}),r&&E&&Z.jsx(Ac,{geojson:E,type:"fill",paint:{"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3,...t.orientationConePaint},insertBeforeLayer:t.insertBeforeLayer}),r&&i&&Z.jsx(Ac,{geojson:i,type:"circle",paint:{"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1,...t.circlePaint},insertBeforeLayer:t.insertBeforeLayer}),Z.jsx(ra,{variant:"navtools","data-testid":"mlFollowGpsBtn",sx:{zIndex:1002,color:r?k=>k.palette.GPS.GPSActiveColor:k=>k.palette.GPS.GPSInactiveColor,backgroundColor:r?k=>k.palette.GPS.GPSActiveBackgroundColor:k=>k.palette.navigation.navColor},disabled:s,onClick:()=>{n(!r)},children:Z.jsx(aN,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})};try{Dk.displayName="MlFollowGps",Dk.__docgenInfo={description:`Adds a button that makes the map follow the users GPS position using
navigator.geolocation.watchPosition if activated`,displayName:"MlFollowGps",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},showUserLocation:{defaultValue:null,description:"By default a dot will be shown on the map at the user's location. Set to false to disable.",name:"showUserLocation",required:!1,type:{name:"boolean | undefined"}},showOrientation:{defaultValue:null,description:`By default a cone will be shown on the map at the user's location to indicate the device's orientation.
Set to false to disable.`,name:"showOrientation",required:!1,type:{name:"boolean | undefined"}},showAccuracyCircle:{defaultValue:null,description:`By default, if showUserLocation is true, a transparent circle will be drawn around the user location
indicating the accuracy (95% confidence level) of the user's location. Set to false to disable.`,name:"showAccuracyCircle",required:!1,type:{name:"boolean | undefined"}},useFlyTo:{defaultValue:null,description:`Use the MapLibre.flyTo function to center the map to the current users position if true.
Otherwise the MapLibre.setCenter function is used.`,name:"useFlyTo",required:!1,type:{name:"boolean | undefined"}},centerUserPosition:{defaultValue:null,description:`Center map to current position once updated location data is recieved.
"false" will center the map once on component activation and then display the updated user location on the map.`,name:"centerUserPosition",required:!1,type:{name:"boolean | undefined"}},orientationConePaint:{defaultValue:null,description:`Orientation cone paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the orientation cone polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"orientationConePaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 4 more ...; "fill-pattern"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}},circlePaint:{defaultValue:null,description:`Position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the position circle.
Use any available paint prop from layer type "circle".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle`,name:"circlePaint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},accuracyPaint:{defaultValue:null,description:`Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"accuracyPaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 4 more ...; "fill-pattern"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}}}}}catch{}const w9=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(),i=ee.useRef(t.imageId||"img_"+Ec()),a=ee.useRef(t.layerId||"MlImageMarkerLayer-"+e.componentId);Kd({geojson:t.options?.source?.data,layerId:a.current,options:{type:"symbol",layout:{...t.options?.layout,"icon-image":r||i.current},paint:{...t.options?.paint}}});const s=(o,u)=>{o.map&&u.imgSrc&&!o.map.map.hasImage(i.current)&&o.map.map.loadImage(u.imgSrc).then(function(h){if(!h?.data){console.log("image "+u.imgSrc+"could not be loaded");return}!o.map||o.map.map.hasImage(i.current)||(o.map.addImage(i.current,h.data,o.componentId),n(i.current))})};return ee.useEffect(()=>{e.map&&t.imgSrc&&s(e,t)},[t,e]),Z.jsx(Z.Fragment,{})};try{w9.displayName="MlImageMarkerLayer",w9.__docgenInfo={description:"",displayName:"MlImageMarkerLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},imageId:{defaultValue:null,description:"Id of the image that will be added by this component to the maplibre-gl instance",name:"imageId",required:!1,type:{name:"string | undefined"}},imgSrc:{defaultValue:null,description:"Path or URL to a supported raster image",name:"imgSrc",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"{ source?: { type?: string | undefined; data: Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined; } | undefined; layout?: { ...; } | undefined; paint?: { ...; } | undefined; } | undefined"}}}}}catch{}function b2e(t){switch(t){case"meters":return 1;case"millimeters":return 1e3;case"centimeters":return 100;case"kilometers":return .001;case"miles":return 1/1609.344;case"nauticalmiles":return 1/1852;case"inches":return 39.3701;case"yards":return 1.09361;case"feet":return 3.28084;default:return 1}}function S9(t){switch(t){case"miles":return"mi";case"acres":return"ac";case"kilometers":return"km";case"meters":return"m";case"millimeters":return"mm";case"centimeters":return"cm";case"nauticalmiles":return"nm";case"inches":return"in";case"yards":return"yd";case"feet":return"ft";case"hectares":return"ha";default:return"m"}}const Fk=t=>{const[e,r]=ee.useState({value:0,label:""}),[n,i]=ee.useState([]);return ee.useEffect(()=>{if(n[0]){let a=0;if(t.measureType==="polygon"){if(a=kbe(n[0]),t.unit){const s=t.unit;s==="acres"?a=a/4046.8564224:s==="hectares"?a=a/1e4:a=a*b2e(t.unit)**2}}else a=hb(n[0],{units:t.unit});typeof t.onChange=="function"&&t.onChange({value:a,unit:t.unit,geojson:n[0]}),a>=.1&&r({value:a,label:S9(t.unit)})}},[t.unit,n]),Z.jsxs(Z.Fragment,{children:[Z.jsx(_S,{onChange:a=>{a&&i(a)},mode:t.measureType==="polygon"?"draw_polygon":"draw_line_string",onFinish:t.onFinish}),e.value.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," ",S9(t.unit),e.label&&t.measureType==="polygon"&&!["hectares","acres"].includes(t.unit||"")?" ²":""]})};try{Fk.displayName="MlMeasureTool",Fk.__docgenInfo={description:"",displayName:"MlMeasureTool",props:{measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: MlMeasureToolOnChangeOptions) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const XZ=Yi(Z.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"})),YZ=Yi(Z.jsx("path",{d:"m2 9 4 12h12l4-12-10-7z"})),x2e=Br(ff)({marginTop:"15px"});function Bk(t){return Z.jsx(x2e,{children:t?.children})}try{Bk.displayName="LayerList",Bk.__docgenInfo={description:"",displayName:"LayerList",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const nx=Yi(Z.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),oN=Yi(Z.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),ZZ=Yi(Z.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),xS=Yi(Z.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),w2e=Fm(Ah)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),S2e=Fm(Q1)({minWidth:"30px"}),E2e=Fm(th)({marginRight:"0px",padding:"0px"}),T2e=Fm(t0)({padding:0,marginRight:"5px"}),C2e=Fm(Wy)(({open:t})=>({display:t?"block":"none"})),A2e=Fm(ff)({marginLeft:"50px"});function zk({visible:t=!0,name:e,children:r,setVisible:n}){const[i,a]=ee.useState(!1),[s,o]=ee.useState(!0),u=ee.useMemo(()=>t?s:!1,[t,s]),h=ee.useMemo(()=>r?Array.isArray(r)?r.map(f=>ht.cloneElement(f,{visible:u})):ht.cloneElement(r,{visible:u}):Z.jsx(Z.Fragment,{}),[u]);return Z.jsxs(Z.Fragment,{children:[Z.jsxs(w2e,{children:[Z.jsxs(S2e,{children:[Z.jsx(E2e,{edge:"end","aria-label":"open",onClick:()=>a(!i),children:i?Z.jsx(xS,{}):Z.jsx(ZZ,{})}),Z.jsx(T2e,{disabled:n?!1:!t,checked:n?t:s,onClick:()=>{n?n(f=>!f):o(f=>!f)}})]}),Z.jsx(mh,{primary:e,variant:"layerlist"})]}),Z.jsx(C2e,{open:i,children:Z.jsx(A2e,{disablePadding:!0,children:h})})]})}try{zk.displayName="LayerListFolder",zk.__docgenInfo={description:"",displayName:"LayerListFolder",props:{visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"ReactNode"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!1,type:{name:"((visible: boolean | ((val: unknown) => boolean)) => void) | undefined"}}}}}catch{}var vc={},Oy={},lA,E9;function KZ(){if(E9)return lA;E9=1;var t=typeof Np=="object"&&Np&&Np.Object===Object&&Np;return lA=t,lA}var uA,T9;function ud(){if(T9)return uA;T9=1;var t=KZ(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return uA=r,uA}var cA,C9;function ix(){if(C9)return cA;C9=1;var t=ud(),e=t.Symbol;return cA=e,cA}var hA,A9;function I2e(){if(A9)return hA;A9=1;var t=ix(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),u=s[i];try{s[i]=void 0;var h=!0}catch{}var f=n.call(s);return h&&(o?s[i]=u:delete s[i]),f}return hA=a,hA}var fA,I9;function P2e(){if(I9)return fA;I9=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return fA=r,fA}var dA,P9;function $m(){if(P9)return dA;P9=1;var t=ix(),e=I2e(),r=P2e(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return dA=s,dA}var pA,k9;function gf(){if(k9)return pA;k9=1;var t=Array.isArray;return pA=t,pA}var gA,M9;function np(){if(M9)return gA;M9=1;function t(e){return e!=null&&typeof e=="object"}return gA=t,gA}var mA,R9;function k2e(){if(R9)return mA;R9=1;var t=$m(),e=gf(),r=np(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&r(a)&&t(a)==n}return mA=i,mA}var yA,O9;function M2e(){if(O9)return yA;O9=1;function t(e){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),u=o.length;u--;){var h=o[e?u:++a];if(n(s[h],h,s)===!1)break}return r}}return yA=t,yA}var vA,N9;function R2e(){if(N9)return vA;N9=1;var t=M2e(),e=t();return vA=e,vA}var _A,L9;function O2e(){if(L9)return _A;L9=1;function t(e,r){for(var n=-1,i=Array(e);++n<e;)i[n]=r(n);return i}return _A=t,_A}var bA,D9;function N2e(){if(D9)return bA;D9=1;var t=$m(),e=np(),r="[object Arguments]";function n(i){return e(i)&&t(i)==r}return bA=n,bA}var xA,F9;function JZ(){if(F9)return xA;F9=1;var t=N2e(),e=np(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=t((function(){return arguments})())?t:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return xA=a,xA}var r1={exports:{}},wA,B9;function L2e(){if(B9)return wA;B9=1;function t(){return!1}return wA=t,wA}r1.exports;var z9;function sN(){return z9||(z9=1,(function(t,e){var r=ud(),n=L2e(),i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,u=o?o.isBuffer:void 0,h=u||n;t.exports=h})(r1,r1.exports)),r1.exports}var SA,j9;function QZ(){if(j9)return SA;j9=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return SA=r,SA}var EA,U9;function lN(){if(U9)return EA;U9=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return EA=e,EA}var TA,V9;function D2e(){if(V9)return TA;V9=1;var t=$m(),e=lN(),r=np(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",h="[object Map]",f="[object Number]",d="[object Object]",b="[object RegExp]",v="[object Set]",S="[object String]",E="[object WeakMap]",P="[object ArrayBuffer]",k="[object DataView]",L="[object Float32Array]",N="[object Float64Array]",M="[object Int8Array]",z="[object Int16Array]",B="[object Int32Array]",q="[object Uint8Array]",W="[object Uint8ClampedArray]",G="[object Uint16Array]",ie="[object Uint32Array]",J={};J[L]=J[N]=J[M]=J[z]=J[B]=J[q]=J[W]=J[G]=J[ie]=!0,J[n]=J[i]=J[P]=J[a]=J[k]=J[s]=J[o]=J[u]=J[h]=J[f]=J[d]=J[b]=J[v]=J[S]=J[E]=!1;function H(ne){return r(ne)&&e(ne.length)&&!!J[t(ne)]}return TA=H,TA}var CA,$9;function uN(){if($9)return CA;$9=1;function t(e){return function(r){return e(r)}}return CA=t,CA}var n1={exports:{}};n1.exports;var q9;function cN(){return q9||(q9=1,(function(t,e){var r=KZ(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o})(n1,n1.exports)),n1.exports}var AA,H9;function eK(){if(H9)return AA;H9=1;var t=D2e(),e=uN(),r=cN(),n=r&&r.isTypedArray,i=n?e(n):t;return AA=i,AA}var IA,W9;function tK(){if(W9)return IA;W9=1;var t=O2e(),e=JZ(),r=gf(),n=sN(),i=QZ(),a=eK(),s=Object.prototype,o=s.hasOwnProperty;function u(h,f){var d=r(h),b=!d&&e(h),v=!d&&!b&&n(h),S=!d&&!b&&!v&&a(h),E=d||b||v||S,P=E?t(h.length,String):[],k=P.length;for(var L in h)(f||o.call(h,L))&&!(E&&(L=="length"||v&&(L=="offset"||L=="parent")||S&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||i(L,k)))&&P.push(L);return P}return IA=u,IA}var PA,G9;function hN(){if(G9)return PA;G9=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||t;return r===i}return PA=e,PA}var kA,X9;function rK(){if(X9)return kA;X9=1;function t(e,r){return function(n){return e(r(n))}}return kA=t,kA}var MA,Y9;function F2e(){if(Y9)return MA;Y9=1;var t=rK(),e=t(Object.keys,Object);return MA=e,MA}var RA,Z9;function B2e(){if(Z9)return RA;Z9=1;var t=hN(),e=F2e(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!t(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return RA=i,RA}var OA,K9;function D0(){if(K9)return OA;K9=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return OA=t,OA}var NA,J9;function nK(){if(J9)return NA;J9=1;var t=$m(),e=D0(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var u=t(o);return u==n||u==i||u==r||u==a}return NA=s,NA}var LA,Q9;function bT(){if(Q9)return LA;Q9=1;var t=nK(),e=lN();function r(n){return n!=null&&e(n.length)&&!t(n)}return LA=r,LA}var DA,ej;function ax(){if(ej)return DA;ej=1;var t=tK(),e=B2e(),r=bT();function n(i){return r(i)?t(i):e(i)}return DA=n,DA}var FA,tj;function iK(){if(tj)return FA;tj=1;var t=R2e(),e=ax();function r(n,i){return n&&t(n,i,e)}return FA=r,FA}var BA,rj;function aK(){if(rj)return BA;rj=1;function t(e){return e}return BA=t,BA}var zA,nj;function z2e(){if(nj)return zA;nj=1;var t=aK();function e(r){return typeof r=="function"?r:t}return zA=e,zA}var jA,ij;function fN(){if(ij)return jA;ij=1;var t=iK(),e=z2e();function r(n,i){return n&&t(n,e(i))}return jA=r,jA}var UA,aj;function dN(){if(aj)return UA;aj=1;var t=rK(),e=t(Object.getPrototypeOf,Object);return UA=e,UA}var VA,oj;function j2e(){if(oj)return VA;oj=1;var t=$m(),e=dN(),r=np(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,u=s.call(Object);function h(f){if(!r(f)||t(f)!=n)return!1;var d=e(f);if(d===null)return!0;var b=o.call(d,"constructor")&&d.constructor;return typeof b=="function"&&b instanceof b&&s.call(b)==u}return VA=h,VA}var $A,sj;function oK(){if(sj)return $A;sj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return $A=t,$A}var qA,lj;function U2e(){if(lj)return qA;lj=1;function t(){this.__data__=[],this.size=0}return qA=t,qA}var HA,uj;function pN(){if(uj)return HA;uj=1;function t(e,r){return e===r||e!==e&&r!==r}return HA=t,HA}var WA,cj;function xT(){if(cj)return WA;cj=1;var t=pN();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return WA=e,WA}var GA,hj;function V2e(){if(hj)return GA;hj=1;var t=xT(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return GA=n,GA}var XA,fj;function $2e(){if(fj)return XA;fj=1;var t=xT();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return XA=e,XA}var YA,dj;function q2e(){if(dj)return YA;dj=1;var t=xT();function e(r){return t(this.__data__,r)>-1}return YA=e,YA}var ZA,pj;function H2e(){if(pj)return ZA;pj=1;var t=xT();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return ZA=e,ZA}var KA,gj;function wT(){if(gj)return KA;gj=1;var t=U2e(),e=V2e(),r=$2e(),n=q2e(),i=H2e();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,KA=a,KA}var JA,mj;function W2e(){if(mj)return JA;mj=1;var t=wT();function e(){this.__data__=new t,this.size=0}return JA=e,JA}var QA,yj;function G2e(){if(yj)return QA;yj=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return QA=t,QA}var e5,vj;function X2e(){if(vj)return e5;vj=1;function t(e){return this.__data__.get(e)}return e5=t,e5}var t5,_j;function Y2e(){if(_j)return t5;_j=1;function t(e){return this.__data__.has(e)}return t5=t,t5}var r5,bj;function Z2e(){if(bj)return r5;bj=1;var t=ud(),e=t["__core-js_shared__"];return r5=e,r5}var n5,xj;function K2e(){if(xj)return n5;xj=1;var t=Z2e(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return n5=r,n5}var i5,wj;function sK(){if(wj)return i5;wj=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return i5=r,i5}var a5,Sj;function J2e(){if(Sj)return a5;Sj=1;var t=nK(),e=K2e(),r=D0(),n=sK(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,u=s.toString,h=o.hasOwnProperty,f=RegExp("^"+u.call(h).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(b){if(!r(b)||e(b))return!1;var v=t(b)?f:a;return v.test(n(b))}return a5=d,a5}var o5,Ej;function Q2e(){if(Ej)return o5;Ej=1;function t(e,r){return e?.[r]}return o5=t,o5}var s5,Tj;function qm(){if(Tj)return s5;Tj=1;var t=J2e(),e=Q2e();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return s5=r,s5}var l5,Cj;function gN(){if(Cj)return l5;Cj=1;var t=qm(),e=ud(),r=t(e,"Map");return l5=r,l5}var u5,Aj;function ST(){if(Aj)return u5;Aj=1;var t=qm(),e=t(Object,"create");return u5=e,u5}var c5,Ij;function ewe(){if(Ij)return c5;Ij=1;var t=ST();function e(){this.__data__=t?t(null):{},this.size=0}return c5=e,c5}var h5,Pj;function twe(){if(Pj)return h5;Pj=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return h5=t,h5}var f5,kj;function rwe(){if(kj)return f5;kj=1;var t=ST(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return f5=i,f5}var d5,Mj;function nwe(){if(Mj)return d5;Mj=1;var t=ST(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return d5=n,d5}var p5,Rj;function iwe(){if(Rj)return p5;Rj=1;var t=ST(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return p5=r,p5}var g5,Oj;function awe(){if(Oj)return g5;Oj=1;var t=ewe(),e=twe(),r=rwe(),n=nwe(),i=iwe();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,g5=a,g5}var m5,Nj;function owe(){if(Nj)return m5;Nj=1;var t=awe(),e=wT(),r=gN();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return m5=n,m5}var y5,Lj;function swe(){if(Lj)return y5;Lj=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return y5=t,y5}var v5,Dj;function ET(){if(Dj)return v5;Dj=1;var t=swe();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return v5=e,v5}var _5,Fj;function lwe(){if(Fj)return _5;Fj=1;var t=ET();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return _5=e,_5}var b5,Bj;function uwe(){if(Bj)return b5;Bj=1;var t=ET();function e(r){return t(this,r).get(r)}return b5=e,b5}var x5,zj;function cwe(){if(zj)return x5;zj=1;var t=ET();function e(r){return t(this,r).has(r)}return x5=e,x5}var w5,jj;function hwe(){if(jj)return w5;jj=1;var t=ET();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return w5=e,w5}var S5,Uj;function mN(){if(Uj)return S5;Uj=1;var t=owe(),e=lwe(),r=uwe(),n=cwe(),i=hwe();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,S5=a,S5}var E5,Vj;function fwe(){if(Vj)return E5;Vj=1;var t=wT(),e=gN(),r=mN(),n=200;function i(a,s){var o=this.__data__;if(o instanceof t){var u=o.__data__;if(!e||u.length<n-1)return u.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(u)}return o.set(a,s),this.size=o.size,this}return E5=i,E5}var T5,$j;function yN(){if($j)return T5;$j=1;var t=wT(),e=W2e(),r=G2e(),n=X2e(),i=Y2e(),a=fwe();function s(o){var u=this.__data__=new t(o);this.size=u.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,T5=s,T5}var C5,qj;function dwe(){if(qj)return C5;qj=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return C5=e,C5}var A5,Hj;function pwe(){if(Hj)return A5;Hj=1;function t(e){return this.__data__.has(e)}return A5=t,A5}var I5,Wj;function gwe(){if(Wj)return I5;Wj=1;var t=mN(),e=dwe(),r=pwe();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new t;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,I5=n,I5}var P5,Gj;function mwe(){if(Gj)return P5;Gj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(e[n],n,e))return!0;return!1}return P5=t,P5}var k5,Xj;function ywe(){if(Xj)return k5;Xj=1;function t(e,r){return e.has(r)}return k5=t,k5}var M5,Yj;function lK(){if(Yj)return M5;Yj=1;var t=gwe(),e=mwe(),r=ywe(),n=1,i=2;function a(s,o,u,h,f,d){var b=u&n,v=s.length,S=o.length;if(v!=S&&!(b&&S>v))return!1;var E=d.get(s),P=d.get(o);if(E&&P)return E==o&&P==s;var k=-1,L=!0,N=u&i?new t:void 0;for(d.set(s,o),d.set(o,s);++k<v;){var M=s[k],z=o[k];if(h)var B=b?h(z,M,k,o,s,d):h(M,z,k,s,o,d);if(B!==void 0){if(B)continue;L=!1;break}if(N){if(!e(o,function(q,W){if(!r(N,W)&&(M===q||f(M,q,u,h,d)))return N.push(W)})){L=!1;break}}else if(!(M===z||f(M,z,u,h,d))){L=!1;break}}return d.delete(s),d.delete(o),L}return M5=a,M5}var R5,Zj;function uK(){if(Zj)return R5;Zj=1;var t=ud(),e=t.Uint8Array;return R5=e,R5}var O5,Kj;function vwe(){if(Kj)return O5;Kj=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i,a){n[++r]=[a,i]}),n}return O5=t,O5}var N5,Jj;function _we(){if(Jj)return N5;Jj=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i){n[++r]=i}),n}return N5=t,N5}var L5,Qj;function bwe(){if(Qj)return L5;Qj=1;var t=ix(),e=uK(),r=pN(),n=lK(),i=vwe(),a=_we(),s=1,o=2,u="[object Boolean]",h="[object Date]",f="[object Error]",d="[object Map]",b="[object Number]",v="[object RegExp]",S="[object Set]",E="[object String]",P="[object Symbol]",k="[object ArrayBuffer]",L="[object DataView]",N=t?t.prototype:void 0,M=N?N.valueOf:void 0;function z(B,q,W,G,ie,J,H){switch(W){case L:if(B.byteLength!=q.byteLength||B.byteOffset!=q.byteOffset)return!1;B=B.buffer,q=q.buffer;case k:return!(B.byteLength!=q.byteLength||!J(new e(B),new e(q)));case u:case h:case b:return r(+B,+q);case f:return B.name==q.name&&B.message==q.message;case v:case E:return B==q+"";case d:var ne=i;case S:var ae=G&s;if(ne||(ne=a),B.size!=q.size&&!ae)return!1;var ue=H.get(B);if(ue)return ue==q;G|=o,H.set(B,q);var de=n(ne(B),ne(q),G,ie,J,H);return H.delete(B),de;case P:if(M)return M.call(B)==M.call(q)}return!1}return L5=z,L5}var D5,e7;function cK(){if(e7)return D5;e7=1;function t(e,r){for(var n=-1,i=r.length,a=e.length;++n<i;)e[a+n]=r[n];return e}return D5=t,D5}var F5,t7;function hK(){if(t7)return F5;t7=1;var t=cK(),e=gf();function r(n,i,a){var s=i(n);return e(n)?s:t(s,a(n))}return F5=r,F5}var B5,r7;function xwe(){if(r7)return B5;r7=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];r(o,n,e)&&(s[a++]=o)}return s}return B5=t,B5}var z5,n7;function fK(){if(n7)return z5;n7=1;function t(){return[]}return z5=t,z5}var j5,i7;function vN(){if(i7)return j5;i7=1;var t=xwe(),e=fK(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),t(i(s),function(o){return n.call(s,o)}))}:e;return j5=a,j5}var U5,a7;function dK(){if(a7)return U5;a7=1;var t=hK(),e=vN(),r=ax();function n(i){return t(i,r,e)}return U5=n,U5}var V5,o7;function wwe(){if(o7)return V5;o7=1;var t=dK(),e=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,u,h,f){var d=o&e,b=t(a),v=b.length,S=t(s),E=S.length;if(v!=E&&!d)return!1;for(var P=v;P--;){var k=b[P];if(!(d?k in s:n.call(s,k)))return!1}var L=f.get(a),N=f.get(s);if(L&&N)return L==s&&N==a;var M=!0;f.set(a,s),f.set(s,a);for(var z=d;++P<v;){k=b[P];var B=a[k],q=s[k];if(u)var W=d?u(q,B,k,s,a,f):u(B,q,k,a,s,f);if(!(W===void 0?B===q||h(B,q,o,u,f):W)){M=!1;break}z||(z=k=="constructor")}if(M&&!z){var G=a.constructor,ie=s.constructor;G!=ie&&"constructor"in a&&"constructor"in s&&!(typeof G=="function"&&G instanceof G&&typeof ie=="function"&&ie instanceof ie)&&(M=!1)}return f.delete(a),f.delete(s),M}return V5=i,V5}var $5,s7;function Swe(){if(s7)return $5;s7=1;var t=qm(),e=ud(),r=t(e,"DataView");return $5=r,$5}var q5,l7;function Ewe(){if(l7)return q5;l7=1;var t=qm(),e=ud(),r=t(e,"Promise");return q5=r,q5}var H5,u7;function Twe(){if(u7)return H5;u7=1;var t=qm(),e=ud(),r=t(e,"Set");return H5=r,H5}var W5,c7;function Cwe(){if(c7)return W5;c7=1;var t=qm(),e=ud(),r=t(e,"WeakMap");return W5=r,W5}var G5,h7;function TT(){if(h7)return G5;h7=1;var t=Swe(),e=gN(),r=Ewe(),n=Twe(),i=Cwe(),a=$m(),s=sK(),o="[object Map]",u="[object Object]",h="[object Promise]",f="[object Set]",d="[object WeakMap]",b="[object DataView]",v=s(t),S=s(e),E=s(r),P=s(n),k=s(i),L=a;return(t&&L(new t(new ArrayBuffer(1)))!=b||e&&L(new e)!=o||r&&L(r.resolve())!=h||n&&L(new n)!=f||i&&L(new i)!=d)&&(L=function(N){var M=a(N),z=M==u?N.constructor:void 0,B=z?s(z):"";if(B)switch(B){case v:return b;case S:return o;case E:return h;case P:return f;case k:return d}return M}),G5=L,G5}var X5,f7;function Awe(){if(f7)return X5;f7=1;var t=yN(),e=lK(),r=bwe(),n=wwe(),i=TT(),a=gf(),s=sN(),o=eK(),u=1,h="[object Arguments]",f="[object Array]",d="[object Object]",b=Object.prototype,v=b.hasOwnProperty;function S(E,P,k,L,N,M){var z=a(E),B=a(P),q=z?f:i(E),W=B?f:i(P);q=q==h?d:q,W=W==h?d:W;var G=q==d,ie=W==d,J=q==W;if(J&&s(E)){if(!s(P))return!1;z=!0,G=!1}if(J&&!G)return M||(M=new t),z||o(E)?e(E,P,k,L,N,M):r(E,P,q,k,L,N,M);if(!(k&u)){var H=G&&v.call(E,"__wrapped__"),ne=ie&&v.call(P,"__wrapped__");if(H||ne){var ae=H?E.value():E,ue=ne?P.value():P;return M||(M=new t),N(ae,ue,k,L,M)}}return J?(M||(M=new t),n(E,P,k,L,N,M)):!1}return X5=S,X5}var Y5,d7;function pK(){if(d7)return Y5;d7=1;var t=Awe(),e=np();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:t(n,i,a,s,r,o)}return Y5=r,Y5}var Z5,p7;function Iwe(){if(p7)return Z5;p7=1;var t=yN(),e=pK(),r=1,n=2;function i(a,s,o,u){var h=o.length,f=h,d=!u;if(a==null)return!f;for(a=Object(a);h--;){var b=o[h];if(d&&b[2]?b[1]!==a[b[0]]:!(b[0]in a))return!1}for(;++h<f;){b=o[h];var v=b[0],S=a[v],E=b[1];if(d&&b[2]){if(S===void 0&&!(v in a))return!1}else{var P=new t;if(u)var k=u(S,E,v,a,s,P);if(!(k===void 0?e(E,S,r|n,u,P):k))return!1}}return!0}return Z5=i,Z5}var K5,g7;function gK(){if(g7)return K5;g7=1;var t=D0();function e(r){return r===r&&!t(r)}return K5=e,K5}var J5,m7;function Pwe(){if(m7)return J5;m7=1;var t=gK(),e=ax();function r(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,t(o)]}return i}return J5=r,J5}var Q5,y7;function mK(){if(y7)return Q5;y7=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return Q5=t,Q5}var e4,v7;function kwe(){if(v7)return e4;v7=1;var t=Iwe(),e=Pwe(),r=mK();function n(i){var a=e(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||t(s,i,a)}}return e4=n,e4}var t4,_7;function _N(){if(_7)return t4;_7=1;var t=$m(),e=np(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return t4=n,t4}var r4,b7;function bN(){if(b7)return r4;b7=1;var t=gf(),e=_N(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return r4=i,r4}var n4,x7;function Mwe(){if(x7)return n4;x7=1;var t=mN(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],u=a.cache;if(u.has(o))return u.get(o);var h=n.apply(this,s);return a.cache=u.set(o,h)||u,h};return a.cache=new(r.Cache||t),a}return r.Cache=t,n4=r,n4}var i4,w7;function Rwe(){if(w7)return i4;w7=1;var t=Mwe(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return i4=r,i4}var a4,S7;function Owe(){if(S7)return a4;S7=1;var t=Rwe(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,u,h){a.push(u?h.replace(r,"$1"):o||s)}),a});return a4=n,a4}var o4,E7;function Nwe(){if(E7)return o4;E7=1;var t=ix(),e=oK(),r=gf(),n=_N(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var u=o+"";return u=="0"&&1/o==-1/0?"-0":u}return o4=s,o4}var s4,T7;function Lwe(){if(T7)return s4;T7=1;var t=Nwe();function e(r){return r==null?"":t(r)}return s4=e,s4}var l4,C7;function yK(){if(C7)return l4;C7=1;var t=gf(),e=bN(),r=Owe(),n=Lwe();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return l4=i,l4}var u4,A7;function CT(){if(A7)return u4;A7=1;var t=_N();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return u4=e,u4}var c4,I7;function vK(){if(I7)return c4;I7=1;var t=yK(),e=CT();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return c4=r,c4}var h4,P7;function Dwe(){if(P7)return h4;P7=1;var t=vK();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return h4=e,h4}var f4,k7;function Fwe(){if(k7)return f4;k7=1;function t(e,r){return e!=null&&r in Object(e)}return f4=t,f4}var d4,M7;function Bwe(){if(M7)return d4;M7=1;var t=yK(),e=JZ(),r=gf(),n=QZ(),i=lN(),a=CT();function s(o,u,h){u=t(u,o);for(var f=-1,d=u.length,b=!1;++f<d;){var v=a(u[f]);if(!(b=o!=null&&h(o,v)))break;o=o[v]}return b||++f!=d?b:(d=o==null?0:o.length,!!d&&i(d)&&n(v,d)&&(r(o)||e(o)))}return d4=s,d4}var p4,R7;function zwe(){if(R7)return p4;R7=1;var t=Fwe(),e=Bwe();function r(n,i){return n!=null&&e(n,i,t)}return p4=r,p4}var g4,O7;function jwe(){if(O7)return g4;O7=1;var t=pK(),e=Dwe(),r=zwe(),n=bN(),i=gK(),a=mK(),s=CT(),o=1,u=2;function h(f,d){return n(f)&&i(d)?a(s(f),d):function(b){var v=e(b,f);return v===void 0&&v===d?r(b,f):t(d,v,o|u)}}return g4=h,g4}var m4,N7;function Uwe(){if(N7)return m4;N7=1;function t(e){return function(r){return r?.[e]}}return m4=t,m4}var y4,L7;function Vwe(){if(L7)return y4;L7=1;var t=vK();function e(r){return function(n){return t(n,r)}}return y4=e,y4}var v4,D7;function $we(){if(D7)return v4;D7=1;var t=Uwe(),e=Vwe(),r=bN(),n=CT();function i(a){return r(a)?t(n(a)):e(a)}return v4=i,v4}var _4,F7;function qwe(){if(F7)return _4;F7=1;var t=kwe(),e=jwe(),r=aK(),n=gf(),i=$we();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?e(s[0],s[1]):t(s):i(s)}return _4=a,_4}var b4,B7;function Hwe(){if(B7)return b4;B7=1;var t=bT();function e(r,n){return function(i,a){if(i==null)return i;if(!t(i))return r(i,a);for(var s=i.length,o=n?s:-1,u=Object(i);(n?o--:++o<s)&&a(u[o],o,u)!==!1;);return i}}return b4=e,b4}var x4,z7;function Wwe(){if(z7)return x4;z7=1;var t=iK(),e=Hwe(),r=e(t);return x4=r,x4}var w4,j7;function Gwe(){if(j7)return w4;j7=1;var t=Wwe(),e=bT();function r(n,i){var a=-1,s=e(n)?Array(n.length):[];return t(n,function(o,u,h){s[++a]=i(o,u,h)}),s}return w4=r,w4}var S4,U7;function Xwe(){if(U7)return S4;U7=1;var t=oK(),e=qwe(),r=Gwe(),n=gf();function i(a,s){var o=n(a)?t:r;return o(a,e(s,3))}return S4=i,S4}var V7;function Ywe(){if(V7)return Oy;V7=1,Object.defineProperty(Oy,"__esModule",{value:!0}),Oy.flattenNames=void 0;var t=k2e(),e=u(t),r=fN(),n=u(r),i=j2e(),a=u(i),s=Xwe(),o=u(s);function u(f){return f&&f.__esModule?f:{default:f}}var h=Oy.flattenNames=function f(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=[];return(0,o.default)(d,function(v){Array.isArray(v)?f(v).map(function(S){return b.push(S)}):(0,a.default)(v)?(0,n.default)(v,function(S,E){S===!0&&b.push(E),b.push(E+"-"+S)}):(0,e.default)(v)&&b.push(v)}),b};return Oy.default=h,Oy}var Ny={},E4,$7;function Zwe(){if($7)return E4;$7=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i&&r(e[n],n,e)!==!1;);return e}return E4=t,E4}var T4,q7;function Kwe(){if(q7)return T4;q7=1;var t=qm(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return T4=e,T4}var C4,H7;function _K(){if(H7)return C4;H7=1;var t=Kwe();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return C4=e,C4}var A4,W7;function bK(){if(W7)return A4;W7=1;var t=_K(),e=pN(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var u=a[s];(!(n.call(a,s)&&e(u,o))||o===void 0&&!(s in a))&&t(a,s,o)}return A4=i,A4}var I4,G7;function AT(){if(G7)return I4;G7=1;var t=bK(),e=_K();function r(n,i,a,s){var o=!a;a||(a={});for(var u=-1,h=i.length;++u<h;){var f=i[u],d=s?s(a[f],n[f],f,a,n):void 0;d===void 0&&(d=n[f]),o?e(a,f,d):t(a,f,d)}return a}return I4=r,I4}var P4,X7;function Jwe(){if(X7)return P4;X7=1;var t=AT(),e=ax();function r(n,i){return n&&t(i,e(i),n)}return P4=r,P4}var k4,Y7;function Qwe(){if(Y7)return k4;Y7=1;function t(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}return k4=t,k4}var M4,Z7;function eSe(){if(Z7)return M4;Z7=1;var t=D0(),e=hN(),r=Qwe(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!t(s))return r(s);var o=e(s),u=[];for(var h in s)h=="constructor"&&(o||!i.call(s,h))||u.push(h);return u}return M4=a,M4}var R4,K7;function xN(){if(K7)return R4;K7=1;var t=tK(),e=eSe(),r=bT();function n(i){return r(i)?t(i,!0):e(i)}return R4=n,R4}var O4,J7;function tSe(){if(J7)return O4;J7=1;var t=AT(),e=xN();function r(n,i){return n&&t(i,e(i),n)}return O4=r,O4}var i1={exports:{}};i1.exports;var Q7;function rSe(){return Q7||(Q7=1,(function(t,e){var r=ud(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function u(h,f){if(f)return h.slice();var d=h.length,b=o?o(d):new h.constructor(d);return h.copy(b),b}t.exports=u})(i1,i1.exports)),i1.exports}var N4,eU;function nSe(){if(eU)return N4;eU=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return N4=t,N4}var L4,tU;function iSe(){if(tU)return L4;tU=1;var t=AT(),e=vN();function r(n,i){return t(n,e(n),i)}return L4=r,L4}var D4,rU;function xK(){if(rU)return D4;rU=1;var t=cK(),e=dN(),r=vN(),n=fK(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)t(o,r(s)),s=e(s);return o}:n;return D4=a,D4}var F4,nU;function aSe(){if(nU)return F4;nU=1;var t=AT(),e=xK();function r(n,i){return t(n,e(n),i)}return F4=r,F4}var B4,iU;function oSe(){if(iU)return B4;iU=1;var t=hK(),e=xK(),r=xN();function n(i){return t(i,r,e)}return B4=n,B4}var z4,aU;function sSe(){if(aU)return z4;aU=1;var t=Object.prototype,e=t.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return z4=r,z4}var j4,oU;function wN(){if(oU)return j4;oU=1;var t=uK();function e(r){var n=new r.constructor(r.byteLength);return new t(n).set(new t(r)),n}return j4=e,j4}var U4,sU;function lSe(){if(sU)return U4;sU=1;var t=wN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return U4=e,U4}var V4,lU;function uSe(){if(lU)return V4;lU=1;var t=/\w*$/;function e(r){var n=new r.constructor(r.source,t.exec(r));return n.lastIndex=r.lastIndex,n}return V4=e,V4}var $4,uU;function cSe(){if(uU)return $4;uU=1;var t=ix(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return $4=n,$4}var q4,cU;function hSe(){if(cU)return q4;cU=1;var t=wN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return q4=e,q4}var H4,hU;function fSe(){if(hU)return H4;hU=1;var t=wN(),e=lSe(),r=uSe(),n=cSe(),i=hSe(),a="[object Boolean]",s="[object Date]",o="[object Map]",u="[object Number]",h="[object RegExp]",f="[object Set]",d="[object String]",b="[object Symbol]",v="[object ArrayBuffer]",S="[object DataView]",E="[object Float32Array]",P="[object Float64Array]",k="[object Int8Array]",L="[object Int16Array]",N="[object Int32Array]",M="[object Uint8Array]",z="[object Uint8ClampedArray]",B="[object Uint16Array]",q="[object Uint32Array]";function W(G,ie,J){var H=G.constructor;switch(ie){case v:return t(G);case a:case s:return new H(+G);case S:return e(G,J);case E:case P:case k:case L:case N:case M:case z:case B:case q:return i(G,J);case o:return new H;case u:case d:return new H(G);case h:return r(G);case f:return new H;case b:return n(G)}}return H4=W,H4}var W4,fU;function dSe(){if(fU)return W4;fU=1;var t=D0(),e=Object.create,r=(function(){function n(){}return function(i){if(!t(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return W4=r,W4}var G4,dU;function pSe(){if(dU)return G4;dU=1;var t=dSe(),e=dN(),r=hN();function n(i){return typeof i.constructor=="function"&&!r(i)?t(e(i)):{}}return G4=n,G4}var X4,pU;function gSe(){if(pU)return X4;pU=1;var t=TT(),e=np(),r="[object Map]";function n(i){return e(i)&&t(i)==r}return X4=n,X4}var Y4,gU;function mSe(){if(gU)return Y4;gU=1;var t=gSe(),e=uN(),r=cN(),n=r&&r.isMap,i=n?e(n):t;return Y4=i,Y4}var Z4,mU;function ySe(){if(mU)return Z4;mU=1;var t=TT(),e=np(),r="[object Set]";function n(i){return e(i)&&t(i)==r}return Z4=n,Z4}var K4,yU;function vSe(){if(yU)return K4;yU=1;var t=ySe(),e=uN(),r=cN(),n=r&&r.isSet,i=n?e(n):t;return K4=i,K4}var J4,vU;function _Se(){if(vU)return J4;vU=1;var t=yN(),e=Zwe(),r=bK(),n=Jwe(),i=tSe(),a=rSe(),s=nSe(),o=iSe(),u=aSe(),h=dK(),f=oSe(),d=TT(),b=sSe(),v=fSe(),S=pSe(),E=gf(),P=sN(),k=mSe(),L=D0(),N=vSe(),M=ax(),z=xN(),B=1,q=2,W=4,G="[object Arguments]",ie="[object Array]",J="[object Boolean]",H="[object Date]",ne="[object Error]",ae="[object Function]",ue="[object GeneratorFunction]",de="[object Map]",Pe="[object Number]",me="[object Object]",Ee="[object RegExp]",we="[object Set]",Ae="[object String]",ce="[object Symbol]",xe="[object WeakMap]",_e="[object ArrayBuffer]",Me="[object DataView]",Re="[object Float32Array]",He="[object Float64Array]",Fe="[object Int8Array]",tt="[object Int16Array]",Ze="[object Int32Array]",Qe="[object Uint8Array]",Ie="[object Uint8ClampedArray]",Lt="[object Uint16Array]",at="[object Uint32Array]",Ve={};Ve[G]=Ve[ie]=Ve[_e]=Ve[Me]=Ve[J]=Ve[H]=Ve[Re]=Ve[He]=Ve[Fe]=Ve[tt]=Ve[Ze]=Ve[de]=Ve[Pe]=Ve[me]=Ve[Ee]=Ve[we]=Ve[Ae]=Ve[ce]=Ve[Qe]=Ve[Ie]=Ve[Lt]=Ve[at]=!0,Ve[ne]=Ve[ae]=Ve[xe]=!1;function nr(Yt,yr,mt,br,Tr,mr){var Mr,Pr=yr&B,ar=yr&q,fr=yr&W;if(mt&&(Mr=Tr?mt(Yt,br,Tr,mr):mt(Yt)),Mr!==void 0)return Mr;if(!L(Yt))return Yt;var Nr=E(Yt);if(Nr){if(Mr=b(Yt),!Pr)return s(Yt,Mr)}else{var or=d(Yt),Dr=or==ae||or==ue;if(P(Yt))return a(Yt,Pr);if(or==me||or==G||Dr&&!Tr){if(Mr=ar||Dr?{}:S(Yt),!Pr)return ar?u(Yt,i(Mr,Yt)):o(Yt,n(Mr,Yt))}else{if(!Ve[or])return Tr?Yt:{};Mr=v(Yt,or,Pr)}}mr||(mr=new t);var er=mr.get(Yt);if(er)return er;mr.set(Yt,Mr),N(Yt)?Yt.forEach(function(Oe){Mr.add(nr(Oe,yr,mt,Oe,Yt,mr))}):k(Yt)&&Yt.forEach(function(Oe,Be){Mr.set(Be,nr(Oe,yr,mt,Be,Yt,mr))});var Gt=fr?ar?f:h:ar?z:M,Tt=Nr?void 0:Gt(Yt);return e(Tt||Yt,function(Oe,Be){Tt&&(Be=Oe,Oe=Yt[Be]),r(Mr,Be,nr(Oe,yr,mt,Be,Yt,mr))}),Mr}return J4=nr,J4}var Q4,_U;function bSe(){if(_U)return Q4;_U=1;var t=_Se(),e=1,r=4;function n(i){return t(i,e|r)}return Q4=n,Q4}var bU;function xSe(){if(bU)return Ny;bU=1,Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.mergeClasses=void 0;var t=fN(),e=a(t),r=bSe(),n=a(r),i=Object.assign||function(o){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(o[f]=h[f])}return o};function a(o){return o&&o.__esModule?o:{default:o}}var s=Ny.mergeClasses=function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],f=u.default&&(0,n.default)(u.default)||{};return h.map(function(d){var b=u[d];return b&&(0,e.default)(b,function(v,S){f[S]||(f[S]={}),f[S]=i({},f[S],b[S])}),d}),f};return Ny.default=s,Ny}var Ly={},xU;function wSe(){if(xU)return Ly;xU=1,Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.autoprefix=void 0;var t=fN(),e=n(t),r=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s};function n(s){return s&&s.__esModule?s:{default:s}}var i={borderRadius:function(o){return{msBorderRadius:o,MozBorderRadius:o,OBorderRadius:o,WebkitBorderRadius:o,borderRadius:o}},boxShadow:function(o){return{msBoxShadow:o,MozBoxShadow:o,OBoxShadow:o,WebkitBoxShadow:o,boxShadow:o}},userSelect:function(o){return{WebkitTouchCallout:o,KhtmlUserSelect:o,MozUserSelect:o,msUserSelect:o,WebkitUserSelect:o,userSelect:o}},flex:function(o){return{WebkitBoxFlex:o,MozBoxFlex:o,WebkitFlex:o,msFlex:o,flex:o}},flexBasis:function(o){return{WebkitFlexBasis:o,flexBasis:o}},justifyContent:function(o){return{WebkitJustifyContent:o,justifyContent:o}},transition:function(o){return{msTransition:o,MozTransition:o,OTransition:o,WebkitTransition:o,transition:o}},transform:function(o){return{msTransform:o,MozTransform:o,OTransform:o,WebkitTransform:o,transform:o}},absolute:function(o){var u=o&&o.split(" ");return{position:"absolute",top:u&&u[0],right:u&&u[1],bottom:u&&u[2],left:u&&u[3]}},extend:function(o,u){var h=u[o];return h||{extend:o}}},a=Ly.autoprefix=function(o){var u={};return(0,e.default)(o,function(h,f){var d={};(0,e.default)(h,function(b,v){var S=i[v];S?d=r({},d,S(b)):d[v]=b}),u[f]=d}),u};return Ly.default=a,Ly}var Dy={},wU;function SSe(){if(wU)return Dy;wU=1,Object.defineProperty(Dy,"__esModule",{value:!0}),Dy.hover=void 0;var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h];for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(u[d]=f[d])}return u},e=Nb(),r=n(e);function n(u){return u&&u.__esModule?u:{default:u}}function i(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function a(u,h){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:u}function s(u,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);u.prototype=Object.create(h&&h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(u,h):u.__proto__=h)}var o=Dy.hover=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(d){s(b,d);function b(){var v,S,E,P;i(this,b);for(var k=arguments.length,L=Array(k),N=0;N<k;N++)L[N]=arguments[N];return P=(S=(E=a(this,(v=b.__proto__||Object.getPrototypeOf(b)).call.apply(v,[this].concat(L))),E),E.state={hover:!1},E.handleMouseOver=function(){return E.setState({hover:!0})},E.handleMouseOut=function(){return E.setState({hover:!1})},E.render=function(){return r.default.createElement(f,{onMouseOver:E.handleMouseOver,onMouseOut:E.handleMouseOut},r.default.createElement(h,t({},E.props,E.state)))},S),a(E,P)}return b})(r.default.Component)};return Dy.default=o,Dy}var Fy={},SU;function ESe(){if(SU)return Fy;SU=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.active=void 0;var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h];for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(u[d]=f[d])}return u},e=Nb(),r=n(e);function n(u){return u&&u.__esModule?u:{default:u}}function i(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function a(u,h){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:u}function s(u,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);u.prototype=Object.create(h&&h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(u,h):u.__proto__=h)}var o=Fy.active=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(d){s(b,d);function b(){var v,S,E,P;i(this,b);for(var k=arguments.length,L=Array(k),N=0;N<k;N++)L[N]=arguments[N];return P=(S=(E=a(this,(v=b.__proto__||Object.getPrototypeOf(b)).call.apply(v,[this].concat(L))),E),E.state={active:!1},E.handleMouseDown=function(){return E.setState({active:!0})},E.handleMouseUp=function(){return E.setState({active:!1})},E.render=function(){return r.default.createElement(f,{onMouseDown:E.handleMouseDown,onMouseUp:E.handleMouseUp},r.default.createElement(h,t({},E.props,E.state)))},S),a(E,P)}return b})(r.default.Component)};return Fy.default=o,Fy}var M2={},EU;function TSe(){if(EU)return M2;EU=1,Object.defineProperty(M2,"__esModule",{value:!0});var t=function(r,n){var i={},a=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i[o]=u};return r===0&&a("first-child"),r===n-1&&a("last-child"),(r===0||r%2===0)&&a("even"),Math.abs(r%2)===1&&a("odd"),a("nth-child",r),i};return M2.default=t,M2}var TU;function CSe(){if(TU)return vc;TU=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.ReactCSS=vc.loop=vc.handleActive=vc.handleHover=vc.hover=void 0;var t=Ywe(),e=b(t),r=xSe(),n=b(r),i=wSe(),a=b(i),s=SSe(),o=b(s),u=ESe(),h=b(u),f=TSe(),d=b(f);function b(S){return S&&S.__esModule?S:{default:S}}vc.hover=o.default,vc.handleHover=o.default,vc.handleActive=h.default,vc.loop=d.default;var v=vc.ReactCSS=function(E){for(var P=arguments.length,k=Array(P>1?P-1:0),L=1;L<P;L++)k[L-1]=arguments[L];var N=(0,e.default)(k),M=(0,n.default)(E,N);return(0,a.default)(M)};return vc.default=v,vc}var SN=CSe();const Di=ad(SN);var ASe=function(e,r,n,i,a){var s=a.clientWidth,o=a.clientHeight,u=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,h=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=u-(a.getBoundingClientRect().left+window.pageXOffset),d=h-(a.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var b=void 0;if(d<0?b=0:d>o?b=1:b=Math.round(d*100/o)/100,r.a!==b)return{h:r.h,s:r.s,l:r.l,a:b,source:"rgb"}}else{var v=void 0;if(f<0?v=0:f>s?v=1:v=Math.round(f*100/s)/100,i!==v)return{h:r.h,s:r.s,l:r.l,a:v,source:"rgb"}}return null},eI={},ISe=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var a=i?new i:document.createElement("canvas");a.width=n*2,a.height=n*2;var s=a.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,a.width,a.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),a.toDataURL()):null},PSe=function(e,r,n,i){var a=e+"-"+r+"-"+n+(i?"-server":"");if(eI[a])return eI[a];var s=ISe(e,r,n,i);return eI[a]=s,s},CU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},F0=function(e){var r=e.white,n=e.grey,i=e.size,a=e.renderers,s=e.borderRadius,o=e.boxShadow,u=e.children,h=Di({default:{grid:{borderRadius:s,boxShadow:o,absolute:"0px 0px 0px 0px",background:"url("+PSe(r,n,i,a.canvas)+") center left"}}});return ee.isValidElement(u)?ht.cloneElement(u,CU({},u.props,{style:CU({},u.props.style,h.grid)})):ht.createElement("div",{style:h.grid})};F0.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var kSe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function RSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function OSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var EN=(function(t){OSe(e,t);function e(){var r,n,i,a;RSe(this,e);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=(n=(i=AU(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var f=ASe(h,i.props.hsl,i.props.direction,i.props.a,i.container);f&&typeof i.props.onChange=="function"&&i.props.onChange(f,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),AU(i,a)}return MSe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,a=Di({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:kSe({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return ht.createElement("div",{style:a.alpha},ht.createElement("div",{style:a.checkboard},ht.createElement(F0,{renderers:this.props.renderers})),ht.createElement("div",{style:a.gradient}),ht.createElement("div",{style:a.container,ref:function(o){return n.container=o},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("div",{style:a.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:a.slider}))))}}]),e})(ee.PureComponent||ee.Component),NSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function LSe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FSe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function BSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var zSe=1,wK=38,jSe=40,USe=[wK,jSe],VSe=function(e){return USe.indexOf(e)>-1},$Se=function(e){return Number(String(e).replace(/%/g,""))},qSe=1,va=(function(t){BSe(e,t);function e(r){DSe(this,e);var n=FSe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var a=$Se(i.target.value);if(!isNaN(a)&&VSe(i.keyCode)){var s=n.getArrowOffset(),o=i.keyCode===wK?a+s:a-s;n.setUpdatedValue(o,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var a=Math.round(n.props.value+i.movementX);a>=0&&a<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(a),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+qSe++,n}return NSe(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return LSe({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||zSe}},{key:"setUpdatedValue",value:function(n,i){var a=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(a,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Di({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return ht.createElement("div",{style:i.wrap},ht.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?ht.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e})(ee.PureComponent||ee.Component),HSe=function(e,r,n,i){var a=i.clientWidth,s=i.clientHeight,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,u=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(i.getBoundingClientRect().left+window.pageXOffset),f=u-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var d=void 0;if(f<0)d=359;else if(f>s)d=0;else{var b=-(f*100/s)+100;d=360*b/100}if(n.h!==d)return{h:d,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var v=void 0;if(h<0)v=0;else if(h>a)v=359;else{var S=h*100/a;v=360*S/100}if(n.h!==v)return{h:v,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},WSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function GSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function XSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var B0=(function(t){XSe(e,t);function e(){var r,n,i,a;GSe(this,e);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=(n=(i=IU(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var f=HSe(h,i.props.direction,i.props.hsl,i.container);f&&typeof i.props.onChange=="function"&&i.props.onChange(f,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),IU(i,a)}return WSe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,a=i===void 0?"horizontal":i,s=Di({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:a==="vertical"});return ht.createElement("div",{style:s.hue},ht.createElement("div",{className:"hue-"+a,style:s.container,ref:function(u){return n.container=u},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),ht.createElement("div",{style:s.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:s.slider}))))}}]),e})(ee.PureComponent||ee.Component);function YSe(){this.__data__=[],this.size=0}function ox(t,e){return t===e||t!==t&&e!==e}function IT(t,e){for(var r=t.length;r--;)if(ox(t[r][0],e))return r;return-1}var ZSe=Array.prototype,KSe=ZSe.splice;function JSe(t){var e=this.__data__,r=IT(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():KSe.call(e,r,1),--this.size,!0}function QSe(t){var e=this.__data__,r=IT(e,t);return r<0?void 0:e[r][1]}function eEe(t){return IT(this.__data__,t)>-1}function tEe(t,e){var r=this.__data__,n=IT(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function ip(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ip.prototype.clear=YSe;ip.prototype.delete=JSe;ip.prototype.get=QSe;ip.prototype.has=eEe;ip.prototype.set=tEe;function rEe(){this.__data__=new ip,this.size=0}function nEe(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function iEe(t){return this.__data__.get(t)}function aEe(t){return this.__data__.has(t)}var SK=typeof global=="object"&&global&&global.Object===Object&&global,oEe=typeof self=="object"&&self&&self.Object===Object&&self,mf=SK||oEe||Function("return this")(),ng=mf.Symbol,EK=Object.prototype,sEe=EK.hasOwnProperty,lEe=EK.toString,T_=ng?ng.toStringTag:void 0;function uEe(t){var e=sEe.call(t,T_),r=t[T_];try{t[T_]=void 0;var n=!0}catch{}var i=lEe.call(t);return n&&(e?t[T_]=r:delete t[T_]),i}var cEe=Object.prototype,hEe=cEe.toString;function fEe(t){return hEe.call(t)}var dEe="[object Null]",pEe="[object Undefined]",PU=ng?ng.toStringTag:void 0;function Hm(t){return t==null?t===void 0?pEe:dEe:PU&&PU in Object(t)?uEe(t):fEe(t)}function Rh(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var gEe="[object AsyncFunction]",mEe="[object Function]",yEe="[object GeneratorFunction]",vEe="[object Proxy]";function TN(t){if(!Rh(t))return!1;var e=Hm(t);return e==mEe||e==yEe||e==gEe||e==vEe}var tI=mf["__core-js_shared__"],kU=(function(){var t=/[^.]+$/.exec(tI&&tI.keys&&tI.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function _Ee(t){return!!kU&&kU in t}var bEe=Function.prototype,xEe=bEe.toString;function Wm(t){if(t!=null){try{return xEe.call(t)}catch{}try{return t+""}catch{}}return""}var wEe=/[\\^$.*+?()[\]{}|]/g,SEe=/^\[object .+?Constructor\]$/,EEe=Function.prototype,TEe=Object.prototype,CEe=EEe.toString,AEe=TEe.hasOwnProperty,IEe=RegExp("^"+CEe.call(AEe).replace(wEe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function PEe(t){if(!Rh(t)||_Ee(t))return!1;var e=TN(t)?IEe:SEe;return e.test(Wm(t))}function kEe(t,e){return t?.[e]}function Gm(t,e){var r=kEe(t,e);return PEe(r)?r:void 0}var fb=Gm(mf,"Map"),db=Gm(Object,"create");function MEe(){this.__data__=db?db(null):{},this.size=0}function REe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var OEe="__lodash_hash_undefined__",NEe=Object.prototype,LEe=NEe.hasOwnProperty;function DEe(t){var e=this.__data__;if(db){var r=e[t];return r===OEe?void 0:r}return LEe.call(e,t)?e[t]:void 0}var FEe=Object.prototype,BEe=FEe.hasOwnProperty;function zEe(t){var e=this.__data__;return db?e[t]!==void 0:BEe.call(e,t)}var jEe="__lodash_hash_undefined__";function UEe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=db&&e===void 0?jEe:e,this}function Em(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Em.prototype.clear=MEe;Em.prototype.delete=REe;Em.prototype.get=DEe;Em.prototype.has=zEe;Em.prototype.set=UEe;function VEe(){this.size=0,this.__data__={hash:new Em,map:new(fb||ip),string:new Em}}function $Ee(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function PT(t,e){var r=t.__data__;return $Ee(e)?r[typeof e=="string"?"string":"hash"]:r.map}function qEe(t){var e=PT(this,t).delete(t);return this.size-=e?1:0,e}function HEe(t){return PT(this,t).get(t)}function WEe(t){return PT(this,t).has(t)}function GEe(t,e){var r=PT(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function ap(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ap.prototype.clear=VEe;ap.prototype.delete=qEe;ap.prototype.get=HEe;ap.prototype.has=WEe;ap.prototype.set=GEe;var XEe=200;function YEe(t,e){var r=this.__data__;if(r instanceof ip){var n=r.__data__;if(!fb||n.length<XEe-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new ap(n)}return r.set(t,e),this.size=r.size,this}function Jf(t){var e=this.__data__=new ip(t);this.size=e.size}Jf.prototype.clear=rEe;Jf.prototype.delete=nEe;Jf.prototype.get=iEe;Jf.prototype.has=aEe;Jf.prototype.set=YEe;var wS=(function(){try{var t=Gm(Object,"defineProperty");return t({},"",{}),t}catch{}})();function CN(t,e,r){e=="__proto__"&&wS?wS(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function jk(t,e,r){(r!==void 0&&!ox(t[e],r)||r===void 0&&!(e in t))&&CN(t,e,r)}function ZEe(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var u=s[++i];if(r(a[u],u,a)===!1)break}return e}}var TK=ZEe(),CK=typeof exports=="object"&&exports&&!exports.nodeType&&exports,MU=CK&&typeof module=="object"&&module&&!module.nodeType&&module,KEe=MU&&MU.exports===CK,RU=KEe?mf.Buffer:void 0;RU&&RU.allocUnsafe;function JEe(t,e){return t.slice()}var SS=mf.Uint8Array;function QEe(t){var e=new t.constructor(t.byteLength);return new SS(e).set(new SS(t)),e}function eTe(t,e){var r=QEe(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function tTe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var OU=Object.create,rTe=(function(){function t(){}return function(e){if(!Rh(e))return{};if(OU)return OU(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function AK(t,e){return function(r){return t(e(r))}}var IK=AK(Object.getPrototypeOf,Object),nTe=Object.prototype;function AN(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||nTe;return t===r}function iTe(t){return typeof t.constructor=="function"&&!AN(t)?rTe(IK(t)):{}}function ig(t){return t!=null&&typeof t=="object"}var aTe="[object Arguments]";function NU(t){return ig(t)&&Hm(t)==aTe}var PK=Object.prototype,oTe=PK.hasOwnProperty,sTe=PK.propertyIsEnumerable,ES=NU((function(){return arguments})())?NU:function(t){return ig(t)&&oTe.call(t,"callee")&&!sTe.call(t,"callee")},oh=Array.isArray,lTe=9007199254740991;function IN(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=lTe}function z0(t){return t!=null&&IN(t.length)&&!TN(t)}function uTe(t){return ig(t)&&z0(t)}function cTe(){return!1}var kK=typeof exports=="object"&&exports&&!exports.nodeType&&exports,LU=kK&&typeof module=="object"&&module&&!module.nodeType&&module,hTe=LU&&LU.exports===kK,DU=hTe?mf.Buffer:void 0,fTe=DU?DU.isBuffer:void 0,TS=fTe||cTe,dTe="[object Object]",pTe=Function.prototype,gTe=Object.prototype,MK=pTe.toString,mTe=gTe.hasOwnProperty,yTe=MK.call(Object);function vTe(t){if(!ig(t)||Hm(t)!=dTe)return!1;var e=IK(t);if(e===null)return!0;var r=mTe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&MK.call(r)==yTe}var _Te="[object Arguments]",bTe="[object Array]",xTe="[object Boolean]",wTe="[object Date]",STe="[object Error]",ETe="[object Function]",TTe="[object Map]",CTe="[object Number]",ATe="[object Object]",ITe="[object RegExp]",PTe="[object Set]",kTe="[object String]",MTe="[object WeakMap]",RTe="[object ArrayBuffer]",OTe="[object DataView]",NTe="[object Float32Array]",LTe="[object Float64Array]",DTe="[object Int8Array]",FTe="[object Int16Array]",BTe="[object Int32Array]",zTe="[object Uint8Array]",jTe="[object Uint8ClampedArray]",UTe="[object Uint16Array]",VTe="[object Uint32Array]",qo={};qo[NTe]=qo[LTe]=qo[DTe]=qo[FTe]=qo[BTe]=qo[zTe]=qo[jTe]=qo[UTe]=qo[VTe]=!0;qo[_Te]=qo[bTe]=qo[RTe]=qo[xTe]=qo[OTe]=qo[wTe]=qo[STe]=qo[ETe]=qo[TTe]=qo[CTe]=qo[ATe]=qo[ITe]=qo[PTe]=qo[kTe]=qo[MTe]=!1;function $Te(t){return ig(t)&&IN(t.length)&&!!qo[Hm(t)]}function qTe(t){return function(e){return t(e)}}var RK=typeof exports=="object"&&exports&&!exports.nodeType&&exports,R1=RK&&typeof module=="object"&&module&&!module.nodeType&&module,HTe=R1&&R1.exports===RK,rI=HTe&&SK.process,FU=(function(){try{var t=R1&&R1.require&&R1.require("util").types;return t||rI&&rI.binding&&rI.binding("util")}catch{}})(),BU=FU&&FU.isTypedArray,PN=BU?qTe(BU):$Te;function Uk(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var WTe=Object.prototype,GTe=WTe.hasOwnProperty;function XTe(t,e,r){var n=t[e];(!(GTe.call(t,e)&&ox(n,r))||r===void 0&&!(e in t))&&CN(t,e,r)}function YTe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],u=void 0;u===void 0&&(u=t[o]),i?CN(r,o,u):XTe(r,o,u)}return r}function ZTe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var KTe=9007199254740991,JTe=/^(?:0|[1-9]\d*)$/;function kN(t,e){var r=typeof t;return e=e??KTe,!!e&&(r=="number"||r!="symbol"&&JTe.test(t))&&t>-1&&t%1==0&&t<e}var QTe=Object.prototype,eCe=QTe.hasOwnProperty;function OK(t,e){var r=oh(t),n=!r&&ES(t),i=!r&&!n&&TS(t),a=!r&&!n&&!i&&PN(t),s=r||n||i||a,o=s?ZTe(t.length,String):[],u=o.length;for(var h in t)(e||eCe.call(t,h))&&!(s&&(h=="length"||i&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||kN(h,u)))&&o.push(h);return o}function tCe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var rCe=Object.prototype,nCe=rCe.hasOwnProperty;function iCe(t){if(!Rh(t))return tCe(t);var e=AN(t),r=[];for(var n in t)n=="constructor"&&(e||!nCe.call(t,n))||r.push(n);return r}function NK(t){return z0(t)?OK(t,!0):iCe(t)}function aCe(t){return YTe(t,NK(t))}function oCe(t,e,r,n,i,a,s){var o=Uk(t,r),u=Uk(e,r),h=s.get(u);if(h){jk(t,r,h);return}var f=a?a(o,u,r+"",t,e,s):void 0,d=f===void 0;if(d){var b=oh(u),v=!b&&TS(u),S=!b&&!v&&PN(u);f=u,b||v||S?oh(o)?f=o:uTe(o)?f=tTe(o):v?(d=!1,f=JEe(u)):S?(d=!1,f=eTe(u)):f=[]:vTe(u)||ES(u)?(f=o,ES(o)?f=aCe(o):(!Rh(o)||TN(o))&&(f=iTe(u))):d=!1}d&&(s.set(u,f),i(f,u,n,a,s),s.delete(u)),jk(t,r,f)}function LK(t,e,r,n,i){t!==e&&TK(e,function(a,s){if(i||(i=new Jf),Rh(a))oCe(t,e,s,r,LK,n,i);else{var o=n?n(Uk(t,s),a,s+"",t,e,i):void 0;o===void 0&&(o=a),jk(t,s,o)}},NK)}function kT(t){return t}function sCe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var zU=Math.max;function lCe(t,e,r){return e=zU(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=zU(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),sCe(t,this,o)}}function uCe(t){return function(){return t}}var cCe=wS?function(t,e){return wS(t,"toString",{configurable:!0,enumerable:!1,value:uCe(e),writable:!0})}:kT,hCe=800,fCe=16,dCe=Date.now;function pCe(t){var e=0,r=0;return function(){var n=dCe(),i=fCe-(n-r);if(r=n,i>0){if(++e>=hCe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var gCe=pCe(cCe);function mCe(t,e){return gCe(lCe(t,e,kT),t+"")}function yCe(t,e,r){if(!Rh(r))return!1;var n=typeof e;return(n=="number"?z0(r)&&kN(e,r.length):n=="string"&&e in r)?ox(r[e],t):!1}function vCe(t){return mCe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,s&&yCe(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,a)}return e})}var Rc=vCe(function(t,e,r){LK(t,e,r)}),sx=function(e){var r=e.zDepth,n=e.radius,i=e.background,a=e.children,s=e.styles,o=s===void 0?{}:s,u=Di(Rc({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},o),{"zDepth-1":r===1});return ht.createElement("div",{style:u.wrap},ht.createElement("div",{style:u.bg}),ht.createElement("div",{style:u.content},a))};sx.propTypes={background:On.string,zDepth:On.oneOf([0,1,2,3,4,5]),radius:On.number,styles:On.object};sx.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var nI=function(){return mf.Date.now()},_Ce=/\s/;function bCe(t){for(var e=t.length;e--&&_Ce.test(t.charAt(e)););return e}var xCe=/^\s+/;function wCe(t){return t&&t.slice(0,bCe(t)+1).replace(xCe,"")}var SCe="[object Symbol]";function MT(t){return typeof t=="symbol"||ig(t)&&Hm(t)==SCe}var jU=NaN,ECe=/^[-+]0x[0-9a-f]+$/i,TCe=/^0b[01]+$/i,CCe=/^0o[0-7]+$/i,ACe=parseInt;function UU(t){if(typeof t=="number")return t;if(MT(t))return jU;if(Rh(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Rh(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=wCe(t);var r=TCe.test(t);return r||CCe.test(t)?ACe(t.slice(2),r?2:8):ECe.test(t)?jU:+t}var ICe="Expected a function",PCe=Math.max,kCe=Math.min;function DK(t,e,r){var n,i,a,s,o,u,h=0,f=!1,d=!1,b=!0;if(typeof t!="function")throw new TypeError(ICe);e=UU(e)||0,Rh(r)&&(f=!!r.leading,d="maxWait"in r,a=d?PCe(UU(r.maxWait)||0,e):a,b="trailing"in r?!!r.trailing:b);function v(B){var q=n,W=i;return n=i=void 0,h=B,s=t.apply(W,q),s}function S(B){return h=B,o=setTimeout(k,e),f?v(B):s}function E(B){var q=B-u,W=B-h,G=e-q;return d?kCe(G,a-W):G}function P(B){var q=B-u,W=B-h;return u===void 0||q>=e||q<0||d&&W>=a}function k(){var B=nI();if(P(B))return L(B);o=setTimeout(k,E(B))}function L(B){return o=void 0,b&&n?v(B):(n=i=void 0,s)}function N(){o!==void 0&&clearTimeout(o),h=0,n=u=i=o=void 0}function M(){return o===void 0?s:L(nI())}function z(){var B=nI(),q=P(B);if(n=arguments,i=this,u=B,q){if(o===void 0)return S(u);if(d)return clearTimeout(o),o=setTimeout(k,e),v(u)}return o===void 0&&(o=setTimeout(k,e)),s}return z.cancel=N,z.flush=M,z}var MCe="Expected a function";function RCe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(MCe);return Rh(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),DK(t,e,{leading:n,maxWait:e,trailing:i})}var OCe=function(e,r,n){var i=n.getBoundingClientRect(),a=i.width,s=i.height,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,u=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(n.getBoundingClientRect().left+window.pageXOffset),f=u-(n.getBoundingClientRect().top+window.pageYOffset);h<0?h=0:h>a&&(h=a),f<0?f=0:f>s&&(f=s);var d=h/a,b=1-f/s;return{h:r.h,s:d,v:b,a:r.a,source:"hsv"}},NCe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function LCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DCe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function FCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var RT=(function(t){FCe(e,t);function e(r){LCe(this,e);var n=DCe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,OCe(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var a=n.getContainerRenderWindow();a.addEventListener("mousemove",n.handleChange),a.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=RCe(function(i,a,s){i(a,s)},50),n}return NCe(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},a=i.color,s=i.white,o=i.black,u=i.pointer,h=i.circle,f=Di({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:s,black:o,pointer:u,circle:h}},{custom:!!this.props.style});return ht.createElement("div",{style:f.color,ref:function(b){return n.container=b},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),ht.createElement("div",{style:f.white,className:"saturation-white"},ht.createElement("div",{style:f.black,className:"saturation-black"}),ht.createElement("div",{style:f.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:f.circle}))))}}]),e})(ee.PureComponent||ee.Component);function BCe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var zCe=AK(Object.keys,Object),jCe=Object.prototype,UCe=jCe.hasOwnProperty;function VCe(t){if(!AN(t))return zCe(t);var e=[];for(var r in Object(t))UCe.call(t,r)&&r!="constructor"&&e.push(r);return e}function MN(t){return z0(t)?OK(t):VCe(t)}function $Ce(t,e){return t&&TK(t,e,MN)}function qCe(t,e){return function(r,n){if(r==null)return r;if(!z0(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var FK=qCe($Ce);function HCe(t){return typeof t=="function"?t:kT}function WCe(t,e){var r=oh(t)?BCe:FK;return r(t,HCe(e))}function CS(t){"@babel/helpers - typeof";return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CS(t)}var GCe=/^\s+/,XCe=/\s+$/;function oi(t,e){if(t=t||"",e=e||{},t instanceof oi)return t;if(!(this instanceof oi))return new oi(t,e);var r=YCe(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}oi.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,a,s,o;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*s+.0722*o},setAlpha:function(e){return this._a=BK(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=$U(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=$U(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=VU(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=VU(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return qU(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return QCe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ns(this._r,255)*100)+"%",g:Math.round(ns(this._g,255)*100)+"%",b:Math.round(ns(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ns(this._r,255)*100)+"%, "+Math.round(ns(this._g,255)*100)+"%, "+Math.round(ns(this._b,255)*100)+"%)":"rgba("+Math.round(ns(this._r,255)*100)+"%, "+Math.round(ns(this._g,255)*100)+"%, "+Math.round(ns(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:h3e[qU(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+HU(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var a=oi(e);n="#"+HU(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return oi(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(n3e,arguments)},brighten:function(){return this._applyModification(i3e,arguments)},darken:function(){return this._applyModification(a3e,arguments)},desaturate:function(){return this._applyModification(e3e,arguments)},saturate:function(){return this._applyModification(t3e,arguments)},greyscale:function(){return this._applyModification(r3e,arguments)},spin:function(){return this._applyModification(o3e,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(u3e,arguments)},complement:function(){return this._applyCombination(s3e,arguments)},monochromatic:function(){return this._applyCombination(c3e,arguments)},splitcomplement:function(){return this._applyCombination(l3e,arguments)},triad:function(){return this._applyCombination(WU,[3])},tetrad:function(){return this._applyCombination(WU,[4])}};oi.fromRatio=function(t,e){if(CS(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=a1(t[n]));t=r}return oi(t,e)};function YCe(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return typeof t=="string"&&(t=g3e(t)),CS(t)=="object"&&(Id(t.r)&&Id(t.g)&&Id(t.b)?(e=ZCe(t.r,t.g,t.b),s=!0,o=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Id(t.h)&&Id(t.s)&&Id(t.v)?(n=a1(t.s),i=a1(t.v),e=JCe(t.h,n,i),s=!0,o="hsv"):Id(t.h)&&Id(t.s)&&Id(t.l)&&(n=a1(t.s),a=a1(t.l),e=KCe(t.h,n,a),s=!0,o="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=BK(r),{ok:s,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function ZCe(t,e,r){return{r:ns(t,255)*255,g:ns(e,255)*255,b:ns(r,255)*255}}function VU(t,e,r){t=ns(t,255),e=ns(e,255),r=ns(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=(n+i)/2;if(n==i)a=s=0;else{var u=n-i;switch(s=o>.5?u/(2-n-i):u/(n+i),n){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s,l:o}}function KCe(t,e,r){var n,i,a;t=ns(t,360),e=ns(e,100),r=ns(r,100);function s(h,f,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?h+(f-h)*6*d:d<1/2?f:d<2/3?h+(f-h)*(2/3-d)*6:h}if(e===0)n=i=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,u=2*r-o;n=s(u,o,t+1/3),i=s(u,o,t),a=s(u,o,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function $U(t,e,r){t=ns(t,255),e=ns(e,255),r=ns(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=n,u=n-i;if(s=n===0?0:u/n,n==i)a=0;else{switch(n){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s,v:o}}function JCe(t,e,r){t=ns(t,360)*6,e=ns(e,100),r=ns(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),s=r*(1-i*e),o=r*(1-(1-i)*e),u=n%6,h=[r,s,a,a,o,r][u],f=[o,r,r,s,a,a][u],d=[a,a,o,r,r,s][u];return{r:h*255,g:f*255,b:d*255}}function qU(t,e,r,n){var i=[tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function QCe(t,e,r,n,i){var a=[tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16)),tf(zK(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function HU(t,e,r,n){var i=[tf(zK(n)),tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16))];return i.join("")}oi.equals=function(t,e){return!t||!e?!1:oi(t).toRgbString()==oi(e).toRgbString()};oi.random=function(){return oi.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function e3e(t,e){e=e===0?0:e||10;var r=oi(t).toHsl();return r.s-=e/100,r.s=OT(r.s),oi(r)}function t3e(t,e){e=e===0?0:e||10;var r=oi(t).toHsl();return r.s+=e/100,r.s=OT(r.s),oi(r)}function r3e(t){return oi(t).desaturate(100)}function n3e(t,e){e=e===0?0:e||10;var r=oi(t).toHsl();return r.l+=e/100,r.l=OT(r.l),oi(r)}function i3e(t,e){e=e===0?0:e||10;var r=oi(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),oi(r)}function a3e(t,e){e=e===0?0:e||10;var r=oi(t).toHsl();return r.l-=e/100,r.l=OT(r.l),oi(r)}function o3e(t,e){var r=oi(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,oi(r)}function s3e(t){var e=oi(t).toHsl();return e.h=(e.h+180)%360,oi(e)}function WU(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=oi(t).toHsl(),n=[oi(t)],i=360/e,a=1;a<e;a++)n.push(oi({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function l3e(t){var e=oi(t).toHsl(),r=e.h;return[oi(t),oi({h:(r+72)%360,s:e.s,l:e.l}),oi({h:(r+216)%360,s:e.s,l:e.l})]}function u3e(t,e,r){e=e||6,r=r||30;var n=oi(t).toHsl(),i=360/r,a=[oi(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(oi(n));return a}function c3e(t,e){e=e||6;for(var r=oi(t).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/e;e--;)s.push(oi({h:n,s:i,v:a})),a=(a+o)%1;return s}oi.mix=function(t,e,r){r=r===0?0:r||50;var n=oi(t).toRgb(),i=oi(e).toRgb(),a=r/100,s={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return oi(s)};oi.readability=function(t,e){var r=oi(t),n=oi(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};oi.isReadable=function(t,e,r){var n=oi.readability(t,e),i,a;switch(a=!1,i=m3e(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};oi.mostReadable=function(t,e,r){var n=null,i=0,a,s,o,u;r=r||{},s=r.includeFallbackColors,o=r.level,u=r.size;for(var h=0;h<e.length;h++)a=oi.readability(t,e[h]),a>i&&(i=a,n=oi(e[h]));return oi.isReadable(t,n,{level:o,size:u})||!s?n:(r.includeFallbackColors=!1,oi.mostReadable(t,["#fff","#000"],r))};var Vk=oi.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},h3e=oi.hexNames=f3e(Vk);function f3e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function BK(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function ns(t,e){d3e(t)&&(t="100%");var r=p3e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function OT(t){return Math.min(1,Math.max(0,t))}function Gc(t){return parseInt(t,16)}function d3e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function p3e(t){return typeof t=="string"&&t.indexOf("%")!=-1}function tf(t){return t.length==1?"0"+t:""+t}function a1(t){return t<=1&&(t=t*100+"%"),t}function zK(t){return Math.round(parseFloat(t)*255).toString(16)}function GU(t){return Gc(t)/255}var Yh=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Id(t){return!!Yh.CSS_UNIT.exec(t)}function g3e(t){t=t.replace(GCe,"").replace(XCe,"").toLowerCase();var e=!1;if(Vk[t])t=Vk[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Yh.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=Yh.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Yh.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=Yh.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Yh.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=Yh.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Yh.hex8.exec(t))?{r:Gc(r[1]),g:Gc(r[2]),b:Gc(r[3]),a:GU(r[4]),format:e?"name":"hex8"}:(r=Yh.hex6.exec(t))?{r:Gc(r[1]),g:Gc(r[2]),b:Gc(r[3]),format:e?"name":"hex"}:(r=Yh.hex4.exec(t))?{r:Gc(r[1]+""+r[1]),g:Gc(r[2]+""+r[2]),b:Gc(r[3]+""+r[3]),a:GU(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=Yh.hex3.exec(t))?{r:Gc(r[1]+""+r[1]),g:Gc(r[2]+""+r[2]),b:Gc(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function m3e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var XU=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return WCe(r,function(a){if(e[a]&&(n+=1,isNaN(e[a])||(i+=1),a==="s"||a==="l")){var s=/^\d+%$/;s.test(e[a])&&(i+=1)}}),n===i?e:!1},o1=function(e,r){var n=e.hex?oi(e.hex):oi(e),i=n.toHsl(),a=n.toHsv(),s=n.toRgb(),o=n.toHex();i.s===0&&(i.h=r||0,a.h=r||0);var u=o==="000000"&&s.a===0;return{hsl:i,hex:u?"transparent":"#"+o,rgb:s,hsv:a,oldHue:e.h||r||i.h,source:e.source}},dg=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&oi(e).isValid()},RN=function(e){if(!e)return"#fff";var r=o1(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},iI=function(e,r){var n=e.replace("°","");return oi(r+" ("+n+")")._ok},C_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y3e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function v3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _3e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function b3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Oc=function(e){var r=(function(n){b3e(i,n);function i(a){v3e(this,i);var s=_3e(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(o,u){var h=XU(o);if(h){var f=o1(o,o.h||s.state.oldHue);s.setState(f),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,f,u),s.props.onChange&&s.props.onChange(f,u)}},s.handleSwatchHover=function(o,u){var h=XU(o);if(h){var f=o1(o,o.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(f,u)}},s.state=C_({},o1(a.color,0)),s.debounce=DK(function(o,u,h){o(u,h)},100),s}return y3e(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),ht.createElement(e,C_({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,o){return C_({},o1(s.color,o.oldHue))}}]),i})(ee.PureComponent||ee.Component);return r.propTypes=C_({},e.propTypes),r.defaultProps=C_({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},x3e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},w3e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function S3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function E3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var T3e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(n){E3e(i,n);function i(){var a,s,o,u;S3e(this,i);for(var h=arguments.length,f=Array(h),d=0;d<h;d++)f[d]=arguments[d];return u=(s=(o=YU(this,(a=i.__proto__||Object.getPrototypeOf(i)).call.apply(a,[this].concat(f))),o),o.state={focus:!1},o.handleFocus=function(){return o.setState({focus:!0})},o.handleBlur=function(){return o.setState({focus:!1})},s),YU(o,u)}return w3e(i,[{key:"render",value:function(){return ht.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},ht.createElement(e,x3e({},this.props,this.state)))}}]),i})(ht.Component)},ZU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},C3e=13,A3e=function(e){var r=e.color,n=e.style,i=e.onClick,a=i===void 0?function(){}:i,s=e.onHover,o=e.title,u=o===void 0?r:o,h=e.children,f=e.focus,d=e.focusStyle,b=d===void 0?{}:d,v=r==="transparent",S=Di({default:{swatch:ZU({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,f?b:{})}}),E=function(M){return a(r,M)},P=function(M){return M.keyCode===C3e&&a(r,M)},k=function(M){return s(r,M)},L={};return s&&(L.onMouseOver=k),ht.createElement("div",ZU({style:S.swatch,onClick:E,title:u,tabIndex:0,onKeyDown:P},L),h,v&&ht.createElement(F0,{borderRadius:S.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Xm=T3e(A3e);var I3e=function(e){var r=e.direction,n=Di({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return ht.createElement("div",{style:n.picker})},P3e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jK=function(e){var r=e.rgb,n=e.hsl,i=e.width,a=e.height,s=e.onChange,o=e.direction,u=e.style,h=e.renderers,f=e.pointer,d=e.className,b=d===void 0?"":d,v=Di({default:{picker:{position:"relative",width:i,height:a},alpha:{radius:"2px",style:u}}});return ht.createElement("div",{style:v.picker,className:"alpha-picker "+b},ht.createElement(EN,P3e({},v.alpha,{rgb:r,hsl:n,pointer:f,renderers:h,onChange:s,direction:o})))};jK.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:I3e};Oc(jK);function UK(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var k3e="__lodash_hash_undefined__";function M3e(t){return this.__data__.set(t,k3e),this}function R3e(t){return this.__data__.has(t)}function AS(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new ap;++e<r;)this.add(t[e])}AS.prototype.add=AS.prototype.push=M3e;AS.prototype.has=R3e;function O3e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function N3e(t,e){return t.has(e)}var L3e=1,D3e=2;function VK(t,e,r,n,i,a){var s=r&L3e,o=t.length,u=e.length;if(o!=u&&!(s&&u>o))return!1;var h=a.get(t),f=a.get(e);if(h&&f)return h==e&&f==t;var d=-1,b=!0,v=r&D3e?new AS:void 0;for(a.set(t,e),a.set(e,t);++d<o;){var S=t[d],E=e[d];if(n)var P=s?n(E,S,d,e,t,a):n(S,E,d,t,e,a);if(P!==void 0){if(P)continue;b=!1;break}if(v){if(!O3e(e,function(k,L){if(!N3e(v,L)&&(S===k||i(S,k,r,n,a)))return v.push(L)})){b=!1;break}}else if(!(S===E||i(S,E,r,n,a))){b=!1;break}}return a.delete(t),a.delete(e),b}function F3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function B3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var z3e=1,j3e=2,U3e="[object Boolean]",V3e="[object Date]",$3e="[object Error]",q3e="[object Map]",H3e="[object Number]",W3e="[object RegExp]",G3e="[object Set]",X3e="[object String]",Y3e="[object Symbol]",Z3e="[object ArrayBuffer]",K3e="[object DataView]",KU=ng?ng.prototype:void 0,aI=KU?KU.valueOf:void 0;function J3e(t,e,r,n,i,a,s){switch(r){case K3e:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Z3e:return!(t.byteLength!=e.byteLength||!a(new SS(t),new SS(e)));case U3e:case V3e:case H3e:return ox(+t,+e);case $3e:return t.name==e.name&&t.message==e.message;case W3e:case X3e:return t==e+"";case q3e:var o=F3e;case G3e:var u=n&z3e;if(o||(o=B3e),t.size!=e.size&&!u)return!1;var h=s.get(t);if(h)return h==e;n|=j3e,s.set(t,e);var f=VK(o(t),o(e),n,i,a,s);return s.delete(t),f;case Y3e:if(aI)return aI.call(t)==aI.call(e)}return!1}function Q3e(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function eAe(t,e,r){var n=e(t);return oh(t)?n:Q3e(n,r(t))}function tAe(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function rAe(){return[]}var nAe=Object.prototype,iAe=nAe.propertyIsEnumerable,JU=Object.getOwnPropertySymbols,aAe=JU?function(t){return t==null?[]:(t=Object(t),tAe(JU(t),function(e){return iAe.call(t,e)}))}:rAe;function QU(t){return eAe(t,MN,aAe)}var oAe=1,sAe=Object.prototype,lAe=sAe.hasOwnProperty;function uAe(t,e,r,n,i,a){var s=r&oAe,o=QU(t),u=o.length,h=QU(e),f=h.length;if(u!=f&&!s)return!1;for(var d=u;d--;){var b=o[d];if(!(s?b in e:lAe.call(e,b)))return!1}var v=a.get(t),S=a.get(e);if(v&&S)return v==e&&S==t;var E=!0;a.set(t,e),a.set(e,t);for(var P=s;++d<u;){b=o[d];var k=t[b],L=e[b];if(n)var N=s?n(L,k,b,e,t,a):n(k,L,b,t,e,a);if(!(N===void 0?k===L||i(k,L,r,n,a):N)){E=!1;break}P||(P=b=="constructor")}if(E&&!P){var M=t.constructor,z=e.constructor;M!=z&&"constructor"in t&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof z=="function"&&z instanceof z)&&(E=!1)}return a.delete(t),a.delete(e),E}var $k=Gm(mf,"DataView"),qk=Gm(mf,"Promise"),Hk=Gm(mf,"Set"),Wk=Gm(mf,"WeakMap"),eV="[object Map]",cAe="[object Object]",tV="[object Promise]",rV="[object Set]",nV="[object WeakMap]",iV="[object DataView]",hAe=Wm($k),fAe=Wm(fb),dAe=Wm(qk),pAe=Wm(Hk),gAe=Wm(Wk),Pp=Hm;($k&&Pp(new $k(new ArrayBuffer(1)))!=iV||fb&&Pp(new fb)!=eV||qk&&Pp(qk.resolve())!=tV||Hk&&Pp(new Hk)!=rV||Wk&&Pp(new Wk)!=nV)&&(Pp=function(t){var e=Hm(t),r=e==cAe?t.constructor:void 0,n=r?Wm(r):"";if(n)switch(n){case hAe:return iV;case fAe:return eV;case dAe:return tV;case pAe:return rV;case gAe:return nV}return e});var mAe=1,aV="[object Arguments]",oV="[object Array]",R2="[object Object]",yAe=Object.prototype,sV=yAe.hasOwnProperty;function vAe(t,e,r,n,i,a){var s=oh(t),o=oh(e),u=s?oV:Pp(t),h=o?oV:Pp(e);u=u==aV?R2:u,h=h==aV?R2:h;var f=u==R2,d=h==R2,b=u==h;if(b&&TS(t)){if(!TS(e))return!1;s=!0,f=!1}if(b&&!f)return a||(a=new Jf),s||PN(t)?VK(t,e,r,n,i,a):J3e(t,e,u,r,n,i,a);if(!(r&mAe)){var v=f&&sV.call(t,"__wrapped__"),S=d&&sV.call(e,"__wrapped__");if(v||S){var E=v?t.value():t,P=S?e.value():e;return a||(a=new Jf),i(E,P,r,n,a)}}return b?(a||(a=new Jf),uAe(t,e,r,n,i,a)):!1}function ON(t,e,r,n,i){return t===e?!0:t==null||e==null||!ig(t)&&!ig(e)?t!==t&&e!==e:vAe(t,e,r,n,ON,i)}var _Ae=1,bAe=2;function xAe(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],u=t[o],h=s[1];if(s[2]){if(u===void 0&&!(o in t))return!1}else{var f=new Jf,d;if(!(d===void 0?ON(h,u,_Ae|bAe,n,f):d))return!1}}return!0}function $K(t){return t===t&&!Rh(t)}function wAe(t){for(var e=MN(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,$K(i)]}return e}function qK(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function SAe(t){var e=wAe(t);return e.length==1&&e[0][2]?qK(e[0][0],e[0][1]):function(r){return r===t||xAe(r,t,e)}}var EAe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,TAe=/^\w*$/;function NN(t,e){if(oh(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||MT(t)?!0:TAe.test(t)||!EAe.test(t)||e!=null&&t in Object(e)}var CAe="Expected a function";function LN(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(CAe);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(LN.Cache||ap),r}LN.Cache=ap;var AAe=500;function IAe(t){var e=LN(t,function(n){return r.size===AAe&&r.clear(),n}),r=e.cache;return e}var PAe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kAe=/\\(\\)?/g,MAe=IAe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(PAe,function(r,n,i,a){e.push(i?a.replace(kAe,"$1"):n||r)}),e}),lV=ng?ng.prototype:void 0,uV=lV?lV.toString:void 0;function HK(t){if(typeof t=="string")return t;if(oh(t))return UK(t,HK)+"";if(MT(t))return uV?uV.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function RAe(t){return t==null?"":HK(t)}function WK(t,e){return oh(t)?t:NN(t,e)?[t]:MAe(RAe(t))}function NT(t){if(typeof t=="string"||MT(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function GK(t,e){e=WK(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[NT(e[r++])];return r&&r==n?t:void 0}function OAe(t,e,r){var n=t==null?void 0:GK(t,e);return n===void 0?r:n}function NAe(t,e){return t!=null&&e in Object(t)}function LAe(t,e,r){e=WK(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=NT(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&IN(i)&&kN(s,i)&&(oh(t)||ES(t)))}function DAe(t,e){return t!=null&&LAe(t,e,NAe)}var FAe=1,BAe=2;function zAe(t,e){return NN(t)&&$K(e)?qK(NT(t),e):function(r){var n=OAe(r,t);return n===void 0&&n===e?DAe(r,t):ON(e,n,FAe|BAe)}}function jAe(t){return function(e){return e?.[t]}}function UAe(t){return function(e){return GK(e,t)}}function VAe(t){return NN(t)?jAe(NT(t)):UAe(t)}function $Ae(t){return typeof t=="function"?t:t==null?kT:typeof t=="object"?oh(t)?zAe(t[0],t[1]):SAe(t):VAe(t)}function qAe(t,e){var r=-1,n=z0(t)?Array(t.length):[];return FK(t,function(i,a,s){n[++r]=e(i,a,s)}),n}function Ym(t,e){var r=oh(t)?UK:qAe;return r(t,$Ae(e))}var HAe=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,a=Di({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return ht.createElement("div",{style:a.swatches},Ym(r,function(s){return ht.createElement(Xm,{key:s,color:s,style:a.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),ht.createElement("div",{style:a.clear}))},DN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,u=e.styles,h=u===void 0?{}:u,f=e.className,d=f===void 0?"":f,b=i==="transparent",v=function(P,k){dg(P)&&r({hex:P,source:"hex"},k)},S=Di(Rc({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:RN(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},h),{"hide-triangle":o==="hide"});return ht.createElement("div",{style:S.card,className:"block-picker "+d},ht.createElement("div",{style:S.triangle}),ht.createElement("div",{style:S.head},b&&ht.createElement(F0,{borderRadius:"6px 6px 0 0"}),ht.createElement("div",{style:S.label},i)),ht.createElement("div",{style:S.body},ht.createElement(HAe,{colors:a,onClick:v,onSwatchHover:n}),ht.createElement(va,{style:{input:S.input},value:i,onChange:v})))};DN.propTypes={width:On.oneOfType([On.string,On.number]),colors:On.arrayOf(On.string),triangle:On.oneOf(["top","hide"]),styles:On.object};DN.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};Oc(DN);var Qy={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},ev={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},tv={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},rv={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},nv={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},iv={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},av={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},ov={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},sv={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},s1={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},lv={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},uv={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},cv={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},hv={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},fv={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},dv={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},pv={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},gv={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},XK=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,a=e.hover,s=e.active,o=e.circleSize,u=e.circleSpacing,h=Di({default:{swatch:{width:o,height:o,marginRight:u,marginBottom:u,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(o/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:a,active:s});return ht.createElement("div",{style:h.swatch},ht.createElement(Xm,{style:h.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+r}}))};XK.defaultProps={circleSize:28,circleSpacing:14};const WAe=SN.handleHover(XK);var FN=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,a=e.colors,s=e.hex,o=e.circleSize,u=e.styles,h=u===void 0?{}:u,f=e.circleSpacing,d=e.className,b=d===void 0?"":d,v=Di(Rc({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-f,marginBottom:-f}}},h)),S=function(P,k){return n({hex:P,source:"hex"},k)};return ht.createElement("div",{style:v.card,className:"circle-picker "+b},Ym(a,function(E){return ht.createElement(WAe,{key:E,color:E,onClick:S,onSwatchHover:i,active:s===E.toLowerCase(),circleSize:o,circleSpacing:f})}))};FN.propTypes={width:On.oneOfType([On.string,On.number]),circleSize:On.number,circleSpacing:On.number,styles:On.object};FN.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Qy[500],ev[500],tv[500],rv[500],nv[500],iv[500],av[500],ov[500],sv[500],s1[500],lv[500],uv[500],cv[500],hv[500],fv[500],dv[500],pv[500],gv[500]],styles:{}};Oc(FN);function cV(t){return t===void 0}var O2={},hV;function GAe(){if(hV)return O2;hV=1,Object.defineProperty(O2,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s},e=Nb(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var u={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(u[h]=s[h]);return u}var a=24;return O2.default=function(s){var o=s.fill,u=o===void 0?"currentColor":o,h=s.width,f=h===void 0?a:h,d=s.height,b=d===void 0?a:d,v=s.style,S=v===void 0?{}:v,E=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:u,width:f,height:b},S)},E),r.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},O2}var XAe=GAe();const YAe=ad(XAe);var ZAe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function KAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function QAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var YK=(function(t){QAe(e,t);function e(r){KAe(this,e);var n=JAe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,a){i.hex?dg(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},a):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},a):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},a)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(cV(i.s)?n.props.hsl.s:i.s),l:Number(cV(i.l)?n.props.hsl.l:i.l),source:"hsl"},a))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return ZAe(e,[{key:"render",value:function(){var n=this,i=Di({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return this.state.view==="hex"?a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),ht.createElement("div",{style:i.alpha},ht.createElement(va,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(va,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),ht.createElement("div",{style:i.alpha},ht.createElement(va,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),ht.createElement("div",{style:i.wrap,className:"flexbox-fix"},a,ht.createElement("div",{style:i.toggle},ht.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(o){return n.icon=o}},ht.createElement(YAe,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e})(ht.Component);YK.defaultProps={view:"hex"};var fV=function(){var e=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return ht.createElement("div",{style:e.picker})},e5e=function(){var e=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return ht.createElement("div",{style:e.picker})},BN=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,a=e.rgb,s=e.hsl,o=e.hsv,u=e.hex,h=e.renderers,f=e.styles,d=f===void 0?{}:f,b=e.className,v=b===void 0?"":b,S=e.defaultView,E=Di(Rc({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},d),{disableAlpha:i});return ht.createElement("div",{style:E.picker,className:"chrome-picker "+v},ht.createElement("div",{style:E.saturation},ht.createElement(RT,{style:E.Saturation,hsl:s,hsv:o,pointer:e5e,onChange:n})),ht.createElement("div",{style:E.body},ht.createElement("div",{style:E.controls,className:"flexbox-fix"},ht.createElement("div",{style:E.color},ht.createElement("div",{style:E.swatch},ht.createElement("div",{style:E.active}),ht.createElement(F0,{renderers:h}))),ht.createElement("div",{style:E.toggles},ht.createElement("div",{style:E.hue},ht.createElement(B0,{style:E.Hue,hsl:s,pointer:fV,onChange:n})),ht.createElement("div",{style:E.alpha},ht.createElement(EN,{style:E.Alpha,rgb:a,hsl:s,pointer:fV,renderers:h,onChange:n})))),ht.createElement(YK,{rgb:a,hsl:s,hex:u,view:S,onChange:n,disableAlpha:i})))};BN.propTypes={width:On.oneOfType([On.string,On.number]),disableAlpha:On.bool,styles:On.object,defaultView:On.oneOf(["hex","rgb","hsl"])};BN.defaultProps={width:225,disableAlpha:!1,styles:{}};const t5e=Oc(BN);var r5e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.active,o=Di({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:RN(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return ht.createElement(Xm,{style:o.color,color:r,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},ht.createElement("div",{style:o.dot}))},n5e=function(e){var r=e.hex,n=e.rgb,i=e.onChange,a=Di({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(u,h){u.r||u.g||u.b?i({r:u.r||n.r,g:u.g||n.g,b:u.b||n.b,source:"rgb"},h):i({hex:u.hex,source:"hex"},h)};return ht.createElement("div",{style:a.fields,className:"flexbox-fix"},ht.createElement("div",{style:a.active}),ht.createElement(va,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"hex",value:r,onChange:s}),ht.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:s}),ht.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:s}),ht.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:s}))},zN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,s=e.rgb,o=e.styles,u=o===void 0?{}:o,h=e.className,f=h===void 0?"":h,d=Di(Rc({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},u)),b=function(S,E){S.hex?dg(S.hex)&&r({hex:S.hex,source:"hex"},E):r(S,E)};return ht.createElement(sx,{style:d.Compact,styles:u},ht.createElement("div",{style:d.compact,className:"compact-picker "+f},ht.createElement("div",null,Ym(i,function(v){return ht.createElement(r5e,{key:v,color:v,active:v.toLowerCase()===a,onClick:b,onSwatchHover:n})}),ht.createElement("div",{style:d.clear})),ht.createElement(n5e,{hex:a,rgb:s,onChange:b})))};zN.propTypes={colors:On.arrayOf(On.string),styles:On.object};zN.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};Oc(zN);var i5e=function(e){var r=e.hover,n=e.color,i=e.onClick,a=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},o=Di({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return ht.createElement("div",{style:o.swatch},ht.createElement(Xm,{color:n,onClick:i,onHover:a,focusStyle:s}))};const a5e=SN.handleHover(i5e);var jN=function(e){var r=e.width,n=e.colors,i=e.onChange,a=e.onSwatchHover,s=e.triangle,o=e.styles,u=o===void 0?{}:o,h=e.className,f=h===void 0?"":h,d=Di(Rc({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},u),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),b=function(S,E){return i({hex:S,source:"hex"},E)};return ht.createElement("div",{style:d.card,className:"github-picker "+f},ht.createElement("div",{style:d.triangleShadow}),ht.createElement("div",{style:d.triangle}),Ym(n,function(v){return ht.createElement(a5e,{color:v,key:v,onClick:b,onSwatchHover:a})}))};jN.propTypes={width:On.oneOfType([On.string,On.number]),colors:On.arrayOf(On.string),triangle:On.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:On.object};jN.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};Oc(jN);var o5e=function(e){var r=e.direction,n=Di({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return ht.createElement("div",{style:n.picker})},s5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},UN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.hsl,s=e.direction,o=e.pointer,u=e.styles,h=u===void 0?{}:u,f=e.className,d=f===void 0?"":f,b=Di(Rc({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},h)),v=function(E){return i({a:1,h:E.h,l:.5,s:1})};return ht.createElement("div",{style:b.picker,className:"hue-picker "+d},ht.createElement(B0,s5e({},b.hue,{hsl:a,pointer:o,onChange:v,direction:s})))};UN.propTypes={styles:On.object};UN.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:o5e,styles:{}};Oc(UN);var l5e=function(e){var r=e.onChange,n=e.hex,i=e.rgb,a=e.styles,s=a===void 0?{}:a,o=e.className,u=o===void 0?"":o,h=Di(Rc({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),f=function(b,v){b.hex?dg(b.hex)&&r({hex:b.hex,source:"hex"},v):(b.r||b.g||b.b)&&r({r:b.r||i.r,g:b.g||i.g,b:b.b||i.b,source:"rgb"},v)};return ht.createElement(sx,{styles:s},ht.createElement("div",{style:h.material,className:"material-picker "+u},ht.createElement(va,{style:{wrap:h.HEXwrap,input:h.HEXinput,label:h.HEXlabel},label:"hex",value:n,onChange:f}),ht.createElement("div",{style:h.split,className:"flexbox-fix"},ht.createElement("div",{style:h.third},ht.createElement(va,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"r",value:i.r,onChange:f})),ht.createElement("div",{style:h.third},ht.createElement(va,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"g",value:i.g,onChange:f})),ht.createElement("div",{style:h.third},ht.createElement(va,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"b",value:i.b,onChange:f})))))};Oc(l5e);var u5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,a=e.hex,s=Di({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),o=function(h,f){h["#"]?dg(h["#"])&&r({hex:h["#"],source:"hex"},f):h.r||h.g||h.b?r({r:h.r||n.r,g:h.g||n.g,b:h.b||n.b,source:"rgb"},f):(h.h||h.s||h.v)&&r({h:h.h||i.h,s:h.s||i.s,v:h.v||i.v,source:"hsv"},f)};return ht.createElement("div",{style:s.fields},ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:o}),ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:o}),ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:o}),ht.createElement("div",{style:s.divider}),ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),ht.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}),ht.createElement("div",{style:s.divider}),ht.createElement(va,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:a.replace("#",""),onChange:o}),ht.createElement("div",{style:s.fieldSymbols},ht.createElement("div",{style:s.symbol},"°"),ht.createElement("div",{style:s.symbol},"%"),ht.createElement("div",{style:s.symbol},"%")))},c5e=function(e){var r=e.hsl,n=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return ht.createElement("div",{style:n.picker})},h5e=function(){var e=Di({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return ht.createElement("div",{style:e.pointer},ht.createElement("div",{style:e.left},ht.createElement("div",{style:e.leftInside})),ht.createElement("div",{style:e.right},ht.createElement("div",{style:e.rightInside})))},dV=function(e){var r=e.onClick,n=e.label,i=e.children,a=e.active,s=Di({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:a});return ht.createElement("div",{style:s.button,onClick:r},n||i)},f5e=function(e){var r=e.rgb,n=e.currentColor,i=Di({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return ht.createElement("div",null,ht.createElement("div",{style:i.label},"new"),ht.createElement("div",{style:i.swatches},ht.createElement("div",{style:i.new}),ht.createElement("div",{style:i.current})),ht.createElement("div",{style:i.label},"current"))},d5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function p5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g5e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function m5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var VN=(function(t){m5e(e,t);function e(r){p5e(this,e);var n=g5e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return d5e(e,[{key:"render",value:function(){var n=this.props,i=n.styles,a=i===void 0?{}:i,s=n.className,o=s===void 0?"":s,u=Di(Rc({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},a));return ht.createElement("div",{style:u.picker,className:"photoshop-picker "+o},ht.createElement("div",{style:u.head},this.props.header),ht.createElement("div",{style:u.body,className:"flexbox-fix"},ht.createElement("div",{style:u.saturation},ht.createElement(RT,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:c5e,onChange:this.props.onChange})),ht.createElement("div",{style:u.hue},ht.createElement(B0,{direction:"vertical",hsl:this.props.hsl,pointer:h5e,onChange:this.props.onChange})),ht.createElement("div",{style:u.controls},ht.createElement("div",{style:u.top,className:"flexbox-fix"},ht.createElement("div",{style:u.previews},ht.createElement(f5e,{rgb:this.props.rgb,currentColor:this.state.currentColor})),ht.createElement("div",{style:u.actions},ht.createElement(dV,{label:"OK",onClick:this.props.onAccept,active:!0}),ht.createElement(dV,{label:"Cancel",onClick:this.props.onCancel}),ht.createElement(u5e,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e})(ht.Component);VN.propTypes={header:On.string,styles:On.object};VN.defaultProps={header:"Color Picker",styles:{}};Oc(VN);var y5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.disableAlpha,o=Di({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),u=function(f,d){f.hex?dg(f.hex)&&r({hex:f.hex,source:"hex"},d):f.r||f.g||f.b?r({r:f.r||n.r,g:f.g||n.g,b:f.b||n.b,a:n.a,source:"rgb"},d):f.a&&(f.a<0?f.a=0:f.a>100&&(f.a=100),f.a/=100,r({h:i.h,s:i.s,l:i.l,a:f.a,source:"rgb"},d))};return ht.createElement("div",{style:o.fields,className:"flexbox-fix"},ht.createElement("div",{style:o.double},ht.createElement(va,{style:{input:o.input,label:o.label},label:"hex",value:a.replace("#",""),onChange:u})),ht.createElement("div",{style:o.single},ht.createElement(va,{style:{input:o.input,label:o.label},label:"r",value:n.r,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.single},ht.createElement(va,{style:{input:o.input,label:o.label},label:"g",value:n.g,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.single},ht.createElement(va,{style:{input:o.input,label:o.label},label:"b",value:n.b,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.alpha},ht.createElement(va,{style:{input:o.input,label:o.label},label:"a",value:Math.round(n.a*100),onChange:u,dragLabel:"true",dragMax:"100"})))},v5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZK=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=Di({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),o=function(h,f){i({hex:h,source:"hex"},f)};return ht.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(u){var h=typeof u=="string"?{color:u}:u,f=""+h.color+(h.title||"");return ht.createElement("div",{key:f,style:s.swatchWrap},ht.createElement(Xm,v5e({},h,{style:s.swatch,onClick:o,onHover:a,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+h.color}})))}))};ZK.propTypes={colors:On.arrayOf(On.oneOfType([On.string,On.shape({color:On.string,title:On.string})])).isRequired};var _5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$N=function(e){var r=e.width,n=e.rgb,i=e.hex,a=e.hsv,s=e.hsl,o=e.onChange,u=e.onSwatchHover,h=e.disableAlpha,f=e.presetColors,d=e.renderers,b=e.styles,v=b===void 0?{}:b,S=e.className,E=S===void 0?"":S,P=Di(Rc({default:_5e({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},v),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},v),{disableAlpha:h});return ht.createElement("div",{style:P.picker,className:"sketch-picker "+E},ht.createElement("div",{style:P.saturation},ht.createElement(RT,{style:P.Saturation,hsl:s,hsv:a,onChange:o})),ht.createElement("div",{style:P.controls,className:"flexbox-fix"},ht.createElement("div",{style:P.sliders},ht.createElement("div",{style:P.hue},ht.createElement(B0,{style:P.Hue,hsl:s,onChange:o})),ht.createElement("div",{style:P.alpha},ht.createElement(EN,{style:P.Alpha,rgb:n,hsl:s,renderers:d,onChange:o}))),ht.createElement("div",{style:P.color},ht.createElement(F0,null),ht.createElement("div",{style:P.activeColor}))),ht.createElement(y5e,{rgb:n,hsl:s,hex:i,onChange:o,disableAlpha:h}),ht.createElement(ZK,{colors:f,onClick:o,onSwatchHover:u}))};$N.propTypes={disableAlpha:On.bool,width:On.oneOfType([On.string,On.number]),styles:On.object};$N.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};Oc($N);var A_=function(e){var r=e.hsl,n=e.offset,i=e.onClick,a=i===void 0?function(){}:i,s=e.active,o=e.first,u=e.last,h=Di({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:o,last:u}),f=function(b){return a({h:r.h,s:.5,l:n,source:"hsl"},b)};return ht.createElement("div",{style:h.swatch,onClick:f})},b5e=function(e){var r=e.onClick,n=e.hsl,i=Di({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),a=.1;return ht.createElement("div",{style:i.swatches},ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<a&&Math.abs(n.s-.5)<a,onClick:r,first:!0})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<a&&Math.abs(n.s-.5)<a,onClick:r,last:!0})),ht.createElement("div",{style:i.clear}))},x5e=function(){var e=Di({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return ht.createElement("div",{style:e.picker})},qN=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,a=e.styles,s=a===void 0?{}:a,o=e.className,u=o===void 0?"":o,h=Di(Rc({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return ht.createElement("div",{style:h.wrap||{},className:"slider-picker "+u},ht.createElement("div",{style:h.hue},ht.createElement(B0,{style:h.Hue,hsl:r,pointer:i,onChange:n})),ht.createElement("div",{style:h.swatches},ht.createElement(b5e,{hsl:r,onClick:n})))};qN.propTypes={styles:On.object};qN.defaultProps={pointer:x5e,styles:{}};Oc(qN);var N2={},pV;function w5e(){if(pV)return N2;pV=1,Object.defineProperty(N2,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s},e=Nb(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var u={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(u[h]=s[h]);return u}var a=24;return N2.default=function(s){var o=s.fill,u=o===void 0?"currentColor":o,h=s.width,f=h===void 0?a:h,d=s.height,b=d===void 0?a:d,v=s.style,S=v===void 0?{}:v,E=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:u,width:f,height:b},S)},E),r.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},N2}var S5e=w5e();const E5e=ad(S5e);var T5e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.first,o=e.last,u=e.active,h=Di({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:RN(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:o,active:u,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return ht.createElement(Xm,{color:r,style:h.color,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},ht.createElement("div",{style:h.check},ht.createElement(E5e,null)))},C5e=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,a=e.active,s=Di({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return ht.createElement("div",{style:s.group},Ym(i,function(o,u){return ht.createElement(T5e,{key:o,color:o,active:o.toLowerCase()===a,first:u===0,last:u===i.length-1,onClick:r,onSwatchHover:n})}))},HN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.onSwatchHover,s=e.colors,o=e.hex,u=e.styles,h=u===void 0?{}:u,f=e.className,d=f===void 0?"":f,b=Di(Rc({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},h)),v=function(E,P){return i({hex:E,source:"hex"},P)};return ht.createElement("div",{style:b.picker,className:"swatches-picker "+d},ht.createElement(sx,null,ht.createElement("div",{style:b.overflow},ht.createElement("div",{style:b.body},Ym(s,function(S){return ht.createElement(C5e,{key:S.toString(),group:S,active:o,onClick:v,onSwatchHover:a})}),ht.createElement("div",{style:b.clear})))))};HN.propTypes={width:On.oneOfType([On.string,On.number]),height:On.oneOfType([On.string,On.number]),colors:On.arrayOf(On.arrayOf(On.string)),styles:On.object};HN.defaultProps={width:320,height:240,colors:[[Qy[900],Qy[700],Qy[500],Qy[300],Qy[100]],[ev[900],ev[700],ev[500],ev[300],ev[100]],[tv[900],tv[700],tv[500],tv[300],tv[100]],[rv[900],rv[700],rv[500],rv[300],rv[100]],[nv[900],nv[700],nv[500],nv[300],nv[100]],[iv[900],iv[700],iv[500],iv[300],iv[100]],[av[900],av[700],av[500],av[300],av[100]],[ov[900],ov[700],ov[500],ov[300],ov[100]],[sv[900],sv[700],sv[500],sv[300],sv[100]],["#194D33",s1[700],s1[500],s1[300],s1[100]],[lv[900],lv[700],lv[500],lv[300],lv[100]],[uv[900],uv[700],uv[500],uv[300],uv[100]],[cv[900],cv[700],cv[500],cv[300],cv[100]],[hv[900],hv[700],hv[500],hv[300],hv[100]],[fv[900],fv[700],fv[500],fv[300],fv[100]],[dv[900],dv[700],dv[500],dv[300],dv[100]],[pv[900],pv[700],pv[500],pv[300],pv[100]],[gv[900],gv[700],gv[500],gv[300],gv[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};Oc(HN);var WN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,u=e.styles,h=u===void 0?{}:u,f=e.className,d=f===void 0?"":f,b=Di(Rc({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},h),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right"}),v=function(E,P){dg(E)&&r({hex:E,source:"hex"},P)};return ht.createElement("div",{style:b.card,className:"twitter-picker "+d},ht.createElement("div",{style:b.triangleShadow}),ht.createElement("div",{style:b.triangle}),ht.createElement("div",{style:b.body},Ym(a,function(S,E){return ht.createElement(Xm,{key:E,color:S,hex:S,style:b.swatch,onClick:v,onHover:n,focusStyle:{boxShadow:"0 0 4px "+S}})}),ht.createElement("div",{style:b.hash},"#"),ht.createElement(va,{label:null,style:{input:b.input},value:i.replace("#",""),onChange:v}),ht.createElement("div",{style:b.clear})))};WN.propTypes={width:On.oneOfType([On.string,On.number]),triangle:On.oneOf(["hide","top-left","top-right"]),colors:On.arrayOf(On.string),styles:On.object};WN.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};Oc(WN);var GN=function(e){var r=Di({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return ht.createElement("div",{style:r.picker})};GN.propTypes={hsl:On.shape({h:On.number,s:On.number,l:On.number,a:On.number})};GN.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var XN=function(e){var r=Di({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return ht.createElement("div",{style:r.picker})};XN.propTypes={hsl:On.shape({h:On.number,s:On.number,l:On.number,a:On.number})};XN.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var A5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.hsv,o=function(v,S){if(v.hex)dg(v.hex)&&r({hex:v.hex,source:"hex"},S);else if(v.rgb){var E=v.rgb.split(",");iI(v.rgb,"rgb")&&r({r:E[0],g:E[1],b:E[2],a:1,source:"rgb"},S)}else if(v.hsv){var P=v.hsv.split(",");iI(v.hsv,"hsv")&&(P[2]=P[2].replace("%",""),P[1]=P[1].replace("%",""),P[0]=P[0].replace("°",""),P[1]==1?P[1]=.01:P[2]==1&&(P[2]=.01),r({h:Number(P[0]),s:Number(P[1]),v:Number(P[2]),source:"hsv"},S))}else if(v.hsl){var k=v.hsl.split(",");iI(v.hsl,"hsl")&&(k[2]=k[2].replace("%",""),k[1]=k[1].replace("%",""),k[0]=k[0].replace("°",""),d[1]==1?d[1]=.01:d[2]==1&&(d[2]=.01),r({h:Number(k[0]),s:Number(k[1]),v:Number(k[2]),source:"hsl"},S))}},u=Di({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),h=n.r+", "+n.g+", "+n.b,f=Math.round(i.h)+"°, "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",d=Math.round(s.h)+"°, "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return ht.createElement("div",{style:u.wrap,className:"flexbox-fix"},ht.createElement("div",{style:u.fields},ht.createElement("div",{style:u.double},ht.createElement(va,{style:{input:u.input,label:u.label},label:"hex",value:a,onChange:o})),ht.createElement("div",{style:u.column},ht.createElement("div",{style:u.single},ht.createElement(va,{style:{input:u.input2,label:u.label2},label:"rgb",value:h,onChange:o})),ht.createElement("div",{style:u.single},ht.createElement(va,{style:{input:u.input2,label:u.label2},label:"hsv",value:d,onChange:o})),ht.createElement("div",{style:u.single},ht.createElement(va,{style:{input:u.input2,label:u.label2},label:"hsl",value:f,onChange:o})))))},YN=function(e){var r=e.width,n=e.onChange,i=e.rgb,a=e.hsl,s=e.hsv,o=e.hex,u=e.header,h=e.styles,f=h===void 0?{}:h,d=e.className,b=d===void 0?"":d,v=Di(Rc({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},f));return ht.createElement("div",{style:v.picker,className:"google-picker "+b},ht.createElement("div",{style:v.head},u),ht.createElement("div",{style:v.swatch}),ht.createElement("div",{style:v.saturation},ht.createElement(RT,{hsl:a,hsv:s,pointer:GN,onChange:n})),ht.createElement("div",{style:v.body},ht.createElement("div",{style:v.controls,className:"flexbox-fix"},ht.createElement("div",{style:v.hue},ht.createElement(B0,{style:v.Hue,hsl:a,radius:"4px",pointer:XN,onChange:n}))),ht.createElement(A5e,{rgb:i,hsl:a,hex:o,hsv:s,onChange:n})))};YN.propTypes={width:On.oneOfType([On.string,On.number]),styles:On.object,header:On.string};YN.defaultProps={width:652,styles:{},header:"Color picker"};Oc(YN);const l1={rgba:t=>`rgba(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}, ${t.rgb.a})`,rgb:t=>`rgb(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b})`,hex:t=>t.hex,rgba_rgb:t=>t.rgb.a===1?l1.rgb(t):l1.rgba(t),rgba_hex:t=>t.rgb.a===1?l1.hex(t):l1.rgba(t)},pb=({convert:t,...e})=>{const[r,n]=ee.useState(!1),i=e?.value||"";return Z.jsxs(Z.Fragment,{children:[Z.jsx(Bd,{container:!0,sx:{flexWrap:"nowrap"},children:Z.jsx(Bd,{size:12,children:Z.jsxs(ra,{variant:"outlined",onClick:()=>n(!0),sx:{minWidth:"100%",padding:"5px",marginBottom:"10px",justifyContent:"flex-start",borderColor:a=>a.palette.text.primary,color:a=>a.palette.text.primary},children:[Z.jsx("div",{style:{width:"25px",height:"25px",marginRight:"10px",backgroundColor:i}}),i]})})}),r&&Z.jsx("div",{style:{position:"relative",marginTop:0},children:Z.jsxs("div",{style:{position:"absolute",zIndex:1e3},children:[Z.jsx("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{n(!1)}}),Z.jsx(t5e,{color:i,onChange:a=>{const s=l1[t](a);e?.onChange?.(s)}})]})})]})};pb.defaultProps={convert:"rgba_hex",label:"Color",name:"color"};try{pb.displayName="ColorPicker",pb.__docgenInfo={description:"",displayName:"ColorPicker",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},convert:{defaultValue:{value:"rgba_hex"},description:"",name:"convert",required:!1,type:{name:"enum",value:[{value:'"rgb"'},{value:'"rgba"'},{value:'"rgba_hex"'},{value:'"hex"'},{value:'"rgba_rgb"'}]}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}}}}}catch{}function Gk({propKey:t,value:e,setPaintProps:r}){return Z.jsx(pb,{value:e,label:"Color",onChange:n=>{r(i=>({...i,[t]:n}))}})}try{Gk.displayName="PaintPropsColorPicker",Gk.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},propKey:{defaultValue:null,description:"",name:"propKey",required:!0,type:{name:"string"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}}}}}catch{}const I5e=Br(Eh)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),P5e=Br(Ho)({marginLeft:"61px"}),KK={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},k5e=Object.keys(KK),M5e={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function IS({paintProps:t={},setPaintProps:e}){const r=ee.useRef(Math.round(Math.random()*1e10)),n=ee.useCallback(i=>{if(k5e.indexOf(i)!==-1&&(typeof t[i]=="number"||typeof t[i]=="string")){const a=Z.jsx(bs,{id:i+"_label",gutterBottom:!0,children:i});switch(KK[i]){case"slider":return Z.jsxs(ht.Fragment,{children:[a,Z.jsx(cO,{...M5e[i],value:t[i],valueLabelDisplay:"auto",onChange:(s,o)=>{o&&e(u=>({...u,[i]:o}))}})]},i);case"numberfield":return Z.jsxs(ht.Fragment,{children:[a,Z.jsx(iT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:t[i],onChange:s=>{s?.target?.value&&e(o=>({...o,[i]:parseInt(s.target.value)}))}})]},i);case"colorpicker":return Z.jsxs(ht.Fragment,{children:[a,Z.jsx(Ho,{sx:{"& > div":{width:"initial !important"}},children:Z.jsx(Gk,{value:t[i],propKey:i,setPaintProps:e},i)})]},i)}}return null},[t]);return Z.jsx(Z.Fragment,{children:Z.jsx(I5e,{children:Z.jsx(Ah,{children:Z.jsx(P5e,{children:Object.keys(t).map(i=>n(i))})},r+"_paintPropForm")})})}try{IS.displayName="LayerPropertyForm",IS.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{paintProps:{defaultValue:{value:"{}"},description:"",name:"paintProps",required:!1,type:{name:"paintPropsType"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}},layerType:{defaultValue:null,description:"",name:"layerType",required:!0,type:{name:"string"}}}}}catch{}const PS=Br(Ah)(t=>({paddingRight:t?"56px":0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"})),R5e=Br(th)({padding:"4px",marginTop:"-3px"}),Nd=Br(Q1)({minWidth:"30px"}),Ld=Br(t0)({padding:0});function kS({configurable:t,vtProps:e,setVtProps:r,id:n,...i}){const[a,s]=ee.useState(!1),[o,u]=ee.useState(!0),[h,f]=ee.useState(e.layers[n].paint);return ee.useEffect(()=>{if(!r||typeof e.layers[n]?.layout?.visibility>"u"&&o||!o&&e.layers[n]?.layout?.visibility==="none"||o&&e.layers[n]?.layout?.visibility==="visible")return;const d=[...e.layers];d[n].layout?d[n].layout.visibility=o?"visible":"none":d[n].layout={visibility:o?"visible":"none"},r({...e,layers:d})},[o,n,r,e]),ee.useEffect(()=>{u(!!i.visibleMaster)},[i.visibleMaster]),ee.useEffect(()=>{if(r&&JSON.stringify(h)!==JSON.stringify(e.layers[n].paint)){const d={...h},b=[...e.layers];b[n].paint=d,r({...e,layers:b})}},[h,n,r,e]),Z.jsxs(Z.Fragment,{children:[Z.jsxs(PS,{secondaryAction:t?Z.jsx(R5e,{edge:"end","aria-label":"comments",onClick:()=>{s(d=>!d)},children:Z.jsx(oN,{})}):void 0,children:[Z.jsx(Nd,{children:Z.jsx(Ld,{checked:o,onClick:()=>{u(d=>!d)}})}),Z.jsx(mh,{primary:e.layers[n].id,variant:"layerlist"})]},n),t&&a&&Z.jsx(IS,{paintProps:h,setPaintProps:f,layerType:e.layers[n].type})]})}kS.defaultProps={configurable:!0};try{PS.displayName="ListItemStyled",PS.__docgenInfo={description:"",displayName:"ListItemStyled",props:{}}}catch{}try{Nd.displayName="CheckboxListItemIcon",Nd.__docgenInfo={description:"",displayName:"CheckboxListItemIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<unknown> | undefined"}}}}}catch{}try{Ld.displayName="CheckboxStyled",Ld.__docgenInfo={description:"",displayName:"CheckboxStyled",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<CheckboxSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<SwitchBaseProps, keyof IntrinsicElements>, CheckboxRootSlotPropsOverrides, CheckboxOwnerState> | undefined; input?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}try{kS.displayName="LayerListItemVectorLayer",kS.__docgenInfo={description:"",displayName:"LayerListItemVectorLayer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},configurable:{defaultValue:{value:"true"},description:"",name:"configurable",required:!1,type:{name:"boolean | undefined"}},vtProps:{defaultValue:null,description:"",name:"vtProps",required:!0,type:{name:"MlVectorTileLayerProps"}},setVtProps:{defaultValue:null,description:"",name:"setVtProps",required:!0,type:{name:"((state: unknown) => void) | undefined"}},visibleMaster:{defaultValue:null,description:"",name:"visibleMaster",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function f0(t){return Z.jsx(Z.Fragment,{children:Z.jsxs(nO,{open:t.open,onClose:t.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Z.jsx(Bm,{id:"alert-dialog-title",children:t.title}),Z.jsx(iO,{children:Z.jsx(Tfe,{id:"alert-dialog-description",children:t.text})}),Z.jsxs(Wb,{children:[Z.jsx(ra,{onClick:t.onCancel,children:"Cancel"}),Z.jsx(ra,{onClick:t.onConfirm,autoFocus:!0,children:"Confirm"})]})]})})}f0.defaultProps={title:"Confirm",text:"Are you sure?"};try{f0.displayName="ConfirmDialog",f0.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},title:{defaultValue:{value:"Confirm"},description:"",name:"title",required:!1,type:{name:"string"}},text:{defaultValue:{value:"Are you sure?"},description:"",name:"text",required:!1,type:{name:"string"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}function O5e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ee.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const LT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function j0(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function ZN(t){return"nodeType"in t}function Nc(t){var e,r;return t?j0(t)?t:ZN(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function KN(t){const{Document:e}=Nc(t);return t instanceof e}function lx(t){return j0(t)?!1:t instanceof Nc(t).HTMLElement}function JK(t){return t instanceof Nc(t).SVGElement}function U0(t){return t?j0(t)?t.document:ZN(t)?KN(t)?t:lx(t)||JK(t)?t.ownerDocument:document:document:document}const nd=LT?ee.useLayoutEffect:ee.useEffect;function JN(t){const e=ee.useRef(t);return nd(()=>{e.current=t}),ee.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function N5e(){const t=ee.useRef(null),e=ee.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=ee.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function gb(t,e){e===void 0&&(e=[t]);const r=ee.useRef(t);return nd(()=>{r.current!==t&&(r.current=t)},e),r}function ux(t,e){const r=ee.useRef();return ee.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function MS(t){const e=JN(t),r=ee.useRef(null),n=ee.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function Xk(t){const e=ee.useRef();return ee.useEffect(()=>{e.current=t},[t]),e.current}let oI={};function cx(t,e){return ee.useMemo(()=>{if(e)return e;const r=oI[t]==null?0:oI[t]+1;return oI[t]=r,t+"-"+r},[t,e])}function QK(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,s)=>{const o=Object.entries(s);for(const[u,h]of o){const f=a[u];f!=null&&(a[u]=f+t*h)}return a},{...e})}}const $v=QK(1),RS=QK(-1);function L5e(t){return"clientX"in t&&"clientY"in t}function QN(t){if(!t)return!1;const{KeyboardEvent:e}=Nc(t.target);return e&&t instanceof e}function D5e(t){if(!t)return!1;const{TouchEvent:e}=Nc(t.target);return e&&t instanceof e}function Yk(t){if(D5e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return L5e(t)?{x:t.clientX,y:t.clientY}:null}const mb=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[mb.Translate.toString(t),mb.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),gV="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function F5e(t){return t.matches(gV)?t:t.querySelector(gV)}const B5e={display:"none"};function z5e(t){let{id:e,value:r}=t;return ht.createElement("div",{id:e,style:B5e},r)}function j5e(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ht.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function U5e(){const[t,e]=ee.useState("");return{announce:ee.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const eJ=ee.createContext(null);function V5e(t){const e=ee.useContext(eJ);ee.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function $5e(){const[t]=ee.useState(()=>new Set),e=ee.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[ee.useCallback(n=>{let{type:i,event:a}=n;t.forEach(s=>{var o;return(o=s[i])==null?void 0:o.call(s,a)})},[t]),e]}const q5e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},H5e={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function W5e(t){let{announcements:e=H5e,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=q5e}=t;const{announce:a,announcement:s}=U5e(),o=cx("DndLiveRegion"),[u,h]=ee.useState(!1);if(ee.useEffect(()=>{h(!0)},[]),V5e(ee.useMemo(()=>({onDragStart(d){let{active:b}=d;a(e.onDragStart({active:b}))},onDragMove(d){let{active:b,over:v}=d;e.onDragMove&&a(e.onDragMove({active:b,over:v}))},onDragOver(d){let{active:b,over:v}=d;a(e.onDragOver({active:b,over:v}))},onDragEnd(d){let{active:b,over:v}=d;a(e.onDragEnd({active:b,over:v}))},onDragCancel(d){let{active:b,over:v}=d;a(e.onDragCancel({active:b,over:v}))}}),[a,e])),!u)return null;const f=ht.createElement(ht.Fragment,null,ht.createElement(z5e,{id:n,value:i.draggable}),ht.createElement(j5e,{id:o,announcement:s}));return r?Fd.createPortal(f,r):f}var Nl;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Nl||(Nl={}));function OS(){}function mV(t,e){return ee.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function G5e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ee.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const uf=Object.freeze({x:0,y:0});function X5e(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Y5e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function Z5e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function K5e(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function yV(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const J5e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=yV(e,e.left,e.top),a=[];for(const s of n){const{id:o}=s,u=r.get(o);if(u){const h=X5e(yV(u),i);a.push({id:o,data:{droppableContainer:s,value:h}})}}return a.sort(Y5e)};function Q5e(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),s=i-n,o=a-r;if(n<i&&r<a){const u=e.width*e.height,h=t.width*t.height,f=s*o,d=f/(u+h-f);return Number(d.toFixed(4))}return 0}const e4e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:s}=a,o=r.get(s);if(o){const u=Q5e(o,e);u>0&&i.push({id:s,data:{droppableContainer:a,value:u}})}}return i.sort(Z5e)};function t4e(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function tJ(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:uf}function r4e(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((s,o)=>({...s,top:s.top+t*o.y,bottom:s.bottom+t*o.y,left:s.left+t*o.x,right:s.right+t*o.x}),{...r})}}const n4e=r4e(1);function i4e(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function a4e(t,e,r){const n=i4e(e);if(!n)return t;const{scaleX:i,scaleY:a,x:s,y:o}=n,u=t.left-s-(1-i)*parseFloat(r),h=t.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),f=i?t.width/i:t.width,d=a?t.height/a:t.height;return{width:f,height:d,top:h,right:u+f,bottom:h+d,left:u}}const o4e={ignoreTransform:!1};function V0(t,e){e===void 0&&(e=o4e);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:h,transformOrigin:f}=Nc(t).getComputedStyle(t);h&&(r=a4e(r,h,f))}const{top:n,left:i,width:a,height:s,bottom:o,right:u}=r;return{top:n,left:i,width:a,height:s,bottom:o,right:u}}function vV(t){return V0(t,{ignoreTransform:!0})}function s4e(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function l4e(t,e){return e===void 0&&(e=Nc(t).getComputedStyle(t)),e.position==="fixed"}function u4e(t,e){e===void 0&&(e=Nc(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function eL(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(KN(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!lx(i)||JK(i)||r.includes(i))return r;const a=Nc(t).getComputedStyle(i);return i!==t&&u4e(i,a)&&r.push(i),l4e(i,a)?r:n(i.parentNode)}return t?n(t):r}function rJ(t){const[e]=eL(t,1);return e??null}function sI(t){return!LT||!t?null:j0(t)?t:ZN(t)?KN(t)||t===U0(t).scrollingElement?window:lx(t)?t:null:null}function nJ(t){return j0(t)?t.scrollX:t.scrollLeft}function iJ(t){return j0(t)?t.scrollY:t.scrollTop}function Zk(t){return{x:nJ(t),y:iJ(t)}}var Ql;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Ql||(Ql={}));function aJ(t){return!LT||!t?!1:t===document.scrollingElement}function oJ(t){const e={x:0,y:0},r=aJ(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,s=t.scrollTop>=n.y,o=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:s,isRight:o,maxScroll:n,minScroll:e}}const c4e={x:.2,y:.2};function h4e(t,e,r,n,i){let{top:a,left:s,right:o,bottom:u}=r;n===void 0&&(n=10),i===void 0&&(i=c4e);const{isTop:h,isBottom:f,isLeft:d,isRight:b}=oJ(t),v={x:0,y:0},S={x:0,y:0},E={height:e.height*i.y,width:e.width*i.x};return!h&&a<=e.top+E.height?(v.y=Ql.Backward,S.y=n*Math.abs((e.top+E.height-a)/E.height)):!f&&u>=e.bottom-E.height&&(v.y=Ql.Forward,S.y=n*Math.abs((e.bottom-E.height-u)/E.height)),!b&&o>=e.right-E.width?(v.x=Ql.Forward,S.x=n*Math.abs((e.right-E.width-o)/E.width)):!d&&s<=e.left+E.width&&(v.x=Ql.Backward,S.x=n*Math.abs((e.left+E.width-s)/E.width)),{direction:v,speed:S}}function f4e(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:s}=window;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function sJ(t){return t.reduce((e,r)=>$v(e,Zk(r)),uf)}function d4e(t){return t.reduce((e,r)=>e+nJ(r),0)}function p4e(t){return t.reduce((e,r)=>e+iJ(r),0)}function g4e(t,e){if(e===void 0&&(e=V0),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);rJ(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const m4e=[["x",["left","right"],d4e],["y",["top","bottom"],p4e]];class tL{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=eL(r),i=sJ(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,s,o]of m4e)for(const u of s)Object.defineProperty(this,u,{get:()=>{const h=o(n),f=i[a]-h;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class O1{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function y4e(t){const{EventTarget:e}=Nc(t);return t instanceof e?t:U0(t)}function lI(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var ph;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(ph||(ph={}));function _V(t){t.preventDefault()}function v4e(t){t.stopPropagation()}var ja;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(ja||(ja={}));const lJ={start:[ja.Space,ja.Enter],cancel:[ja.Esc],end:[ja.Space,ja.Enter,ja.Tab]},_4e=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case ja.Right:return{...r,x:r.x+25};case ja.Left:return{...r,x:r.x-25};case ja.Down:return{...r,y:r.y+25};case ja.Up:return{...r,y:r.y-25}}};class uJ{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new O1(U0(r)),this.windowListeners=new O1(Nc(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ph.Resize,this.handleCancel),this.windowListeners.add(ph.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ph.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&g4e(n),r(uf)}handleKeyDown(e){if(QN(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=lJ,coordinateGetter:s=_4e,scrollBehavior:o="smooth"}=i,{code:u}=e;if(a.end.includes(u)){this.handleEnd(e);return}if(a.cancel.includes(u)){this.handleCancel(e);return}const{collisionRect:h}=n.current,f=h?{x:h.left,y:h.top}:uf;this.referenceCoordinates||(this.referenceCoordinates=f);const d=s(e,{active:r,context:n.current,currentCoordinates:f});if(d){const b=RS(d,f),v={x:0,y:0},{scrollableAncestors:S}=n.current;for(const E of S){const P=e.code,{isTop:k,isRight:L,isLeft:N,isBottom:M,maxScroll:z,minScroll:B}=oJ(E),q=f4e(E),W={x:Math.min(P===ja.Right?q.right-q.width/2:q.right,Math.max(P===ja.Right?q.left:q.left+q.width/2,d.x)),y:Math.min(P===ja.Down?q.bottom-q.height/2:q.bottom,Math.max(P===ja.Down?q.top:q.top+q.height/2,d.y))},G=P===ja.Right&&!L||P===ja.Left&&!N,ie=P===ja.Down&&!M||P===ja.Up&&!k;if(G&&W.x!==d.x){const J=E.scrollLeft+b.x,H=P===ja.Right&&J<=z.x||P===ja.Left&&J>=B.x;if(H&&!b.y){E.scrollTo({left:J,behavior:o});return}H?v.x=E.scrollLeft-J:v.x=P===ja.Right?E.scrollLeft-z.x:E.scrollLeft-B.x,v.x&&E.scrollBy({left:-v.x,behavior:o});break}else if(ie&&W.y!==d.y){const J=E.scrollTop+b.y,H=P===ja.Down&&J<=z.y||P===ja.Up&&J>=B.y;if(H&&!b.x){E.scrollTo({top:J,behavior:o});return}H?v.y=E.scrollTop-J:v.y=P===ja.Down?E.scrollTop-z.y:E.scrollTop-B.y,v.y&&E.scrollBy({top:-v.y,behavior:o});break}}this.handleMove(e,$v(RS(d,this.referenceCoordinates),v))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}uJ.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=lJ,onActivation:i}=e,{active:a}=r;const{code:s}=t.nativeEvent;if(n.start.includes(s)){const o=a.activatorNode.current;return o&&t.target!==o?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function bV(t){return!!(t&&"distance"in t)}function xV(t){return!!(t&&"delay"in t)}class rL{constructor(e,r,n){var i;n===void 0&&(n=y4e(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:s}=a;this.props=e,this.events=r,this.document=U0(s),this.documentListeners=new O1(this.document),this.listeners=new O1(n),this.windowListeners=new O1(Nc(s)),this.initialCoordinates=(i=Yk(a))!=null?i:uf,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ph.Resize,this.handleCancel),this.windowListeners.add(ph.DragStart,_V),this.windowListeners.add(ph.VisibilityChange,this.handleCancel),this.windowListeners.add(ph.ContextMenu,_V),this.documentListeners.add(ph.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(xV(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(bV(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(ph.Click,v4e,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ph.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:s,options:{activationConstraint:o}}=a;if(!i)return;const u=(r=Yk(e))!=null?r:uf,h=RS(i,u);if(!n&&o){if(bV(o)){if(o.tolerance!=null&&lI(h,o.tolerance))return this.handleCancel();if(lI(h,o.distance))return this.handleStart()}if(xV(o)&&lI(h,o.tolerance))return this.handleCancel();this.handlePending(o,h);return}e.cancelable&&e.preventDefault(),s(u)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===ja.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const b4e={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class nL extends rL{constructor(e){const{event:r}=e,n=U0(r.target);super(e,b4e,n)}}nL.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const x4e={move:{name:"mousemove"},end:{name:"mouseup"}};var Kk;(function(t){t[t.RightClick=2]="RightClick"})(Kk||(Kk={}));class cJ extends rL{constructor(e){super(e,x4e,U0(e.event.target))}}cJ.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===Kk.RightClick?!1:(n?.({event:r}),!0)}}];const uI={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class w4e extends rL{constructor(e){super(e,uI)}static setup(){return window.addEventListener(uI.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(uI.move.name,e)};function e(){}}}w4e.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var N1;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(N1||(N1={}));var NS;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(NS||(NS={}));function S4e(t){let{acceleration:e,activator:r=N1.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:s=5,order:o=NS.TreeOrder,pointerCoordinates:u,scrollableAncestors:h,scrollableAncestorRects:f,delta:d,threshold:b}=t;const v=T4e({delta:d,disabled:!a}),[S,E]=N5e(),P=ee.useRef({x:0,y:0}),k=ee.useRef({x:0,y:0}),L=ee.useMemo(()=>{switch(r){case N1.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case N1.DraggableRect:return i}},[r,i,u]),N=ee.useRef(null),M=ee.useCallback(()=>{const B=N.current;if(!B)return;const q=P.current.x*k.current.x,W=P.current.y*k.current.y;B.scrollBy(q,W)},[]),z=ee.useMemo(()=>o===NS.TreeOrder?[...h].reverse():h,[o,h]);ee.useEffect(()=>{if(!a||!h.length||!L){E();return}for(const B of z){if(n?.(B)===!1)continue;const q=h.indexOf(B),W=f[q];if(!W)continue;const{direction:G,speed:ie}=h4e(B,W,L,e,b);for(const J of["x","y"])v[J][G[J]]||(ie[J]=0,G[J]=0);if(ie.x>0||ie.y>0){E(),N.current=B,S(M,s),P.current=ie,k.current=G;return}}P.current={x:0,y:0},k.current={x:0,y:0},E()},[e,M,n,E,a,s,JSON.stringify(L),JSON.stringify(v),S,h,z,f,JSON.stringify(b)])}const E4e={x:{[Ql.Backward]:!1,[Ql.Forward]:!1},y:{[Ql.Backward]:!1,[Ql.Forward]:!1}};function T4e(t){let{delta:e,disabled:r}=t;const n=Xk(e);return ux(i=>{if(r||!n||!i)return E4e;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Ql.Backward]:i.x[Ql.Backward]||a.x===-1,[Ql.Forward]:i.x[Ql.Forward]||a.x===1},y:{[Ql.Backward]:i.y[Ql.Backward]||a.y===-1,[Ql.Forward]:i.y[Ql.Forward]||a.y===1}}},[r,e,n])}function C4e(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return ux(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function A4e(t,e){return ee.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,n)}));return[...r,...a]},[]),[t,e])}var yb;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(yb||(yb={}));var Jk;(function(t){t.Optimized="optimized"})(Jk||(Jk={}));const wV=new Map;function I4e(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,s]=ee.useState(null),{frequency:o,measure:u,strategy:h}=i,f=ee.useRef(t),d=P(),b=gb(d),v=ee.useCallback(function(k){k===void 0&&(k=[]),!b.current&&s(L=>L===null?k:L.concat(k.filter(N=>!L.includes(N))))},[b]),S=ee.useRef(null),E=ux(k=>{if(d&&!r)return wV;if(!k||k===wV||f.current!==t||a!=null){const L=new Map;for(let N of t){if(!N)continue;if(a&&a.length>0&&!a.includes(N.id)&&N.rect.current){L.set(N.id,N.rect.current);continue}const M=N.node.current,z=M?new tL(u(M),M):null;N.rect.current=z,z&&L.set(N.id,z)}return L}return k},[t,a,r,d,u]);return ee.useEffect(()=>{f.current=t},[t]),ee.useEffect(()=>{d||v()},[r,d]),ee.useEffect(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),ee.useEffect(()=>{d||typeof o!="number"||S.current!==null||(S.current=setTimeout(()=>{v(),S.current=null},o))},[o,d,v,...n]),{droppableRects:E,measureDroppableContainers:v,measuringScheduled:a!=null};function P(){switch(h){case yb.Always:return!1;case yb.BeforeDragging:return r;default:return!r}}}function hJ(t,e){return ux(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function P4e(t,e){return hJ(t,e)}function k4e(t){let{callback:e,disabled:r}=t;const n=JN(e),i=ee.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return ee.useEffect(()=>()=>i?.disconnect(),[i]),i}function DT(t){let{callback:e,disabled:r}=t;const n=JN(e),i=ee.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return ee.useEffect(()=>()=>i?.disconnect(),[i]),i}function M4e(t){return new tL(V0(t),t)}function SV(t,e,r){e===void 0&&(e=M4e);const[n,i]=ee.useState(null);function a(){i(u=>{if(!t)return null;if(t.isConnected===!1){var h;return(h=u??r)!=null?h:null}const f=e(t);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const s=k4e({callback(u){if(t)for(const h of u){const{type:f,target:d}=h;if(f==="childList"&&d instanceof HTMLElement&&d.contains(t)){a();break}}}}),o=DT({callback:a});return nd(()=>{a(),t?(o?.observe(t),s?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),s?.disconnect())},[t]),n}function R4e(t){const e=hJ(t);return tJ(t,e)}const EV=[];function O4e(t){const e=ee.useRef(t),r=ux(n=>t?n&&n!==EV&&t&&e.current&&t.parentNode===e.current.parentNode?n:eL(t):EV,[t]);return ee.useEffect(()=>{e.current=t},[t]),r}function N4e(t){const[e,r]=ee.useState(null),n=ee.useRef(t),i=ee.useCallback(a=>{const s=sI(a.target);s&&r(o=>o?(o.set(s,Zk(s)),new Map(o)):null)},[]);return ee.useEffect(()=>{const a=n.current;if(t!==a){s(a);const o=t.map(u=>{const h=sI(u);return h?(h.addEventListener("scroll",i,{passive:!0}),[h,Zk(h)]):null}).filter(u=>u!=null);r(o.length?new Map(o):null),n.current=t}return()=>{s(t),s(a)};function s(o){o.forEach(u=>{const h=sI(u);h?.removeEventListener("scroll",i)})}},[i,t]),ee.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,s)=>$v(a,s),uf):sJ(t):uf,[t,e])}function TV(t,e){e===void 0&&(e=[]);const r=ee.useRef(null);return ee.useEffect(()=>{r.current=null},e),ee.useEffect(()=>{const n=t!==uf;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?RS(t,r.current):uf}function L4e(t){ee.useEffect(()=>{if(!LT)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function D4e(t,e){return ee.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=s=>{a(s,e)},r},{}),[t,e])}function fJ(t){return ee.useMemo(()=>t?s4e(t):null,[t])}const CV=[];function F4e(t,e){e===void 0&&(e=V0);const[r]=t,n=fJ(r?Nc(r):null),[i,a]=ee.useState(CV);function s(){a(()=>t.length?t.map(u=>aJ(u)?n:new tL(e(u),u)):CV)}const o=DT({callback:s});return nd(()=>{o?.disconnect(),s(),t.forEach(u=>o?.observe(u))},[t]),i}function B4e(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return lx(e)?e:t}function z4e(t){let{measure:e}=t;const[r,n]=ee.useState(null),i=ee.useCallback(h=>{for(const{target:f}of h)if(lx(f)){n(d=>{const b=e(f);return d?{...d,width:b.width,height:b.height}:b});break}},[e]),a=DT({callback:i}),s=ee.useCallback(h=>{const f=B4e(h);a?.disconnect(),f&&a?.observe(f),n(f?e(f):null)},[e,a]),[o,u]=MS(s);return ee.useMemo(()=>({nodeRef:o,rect:r,setRef:u}),[r,o,u])}const j4e=[{sensor:nL,options:{}},{sensor:uJ,options:{}}],U4e={current:{}},Sw={draggable:{measure:vV},droppable:{measure:vV,strategy:yb.WhileDragging,frequency:Jk.Optimized},dragOverlay:{measure:V0}};class L1 extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const V4e={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new L1,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:OS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Sw,measureDroppableContainers:OS,windowRect:null,measuringScheduled:!1},$4e={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:OS,draggableNodes:new Map,over:null,measureDroppableContainers:OS},FT=ee.createContext($4e),dJ=ee.createContext(V4e);function q4e(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new L1}}}function H4e(t,e){switch(e.type){case Nl.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Nl.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Nl.DragEnd:case Nl.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Nl.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new L1(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Nl.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const s=new L1(t.droppable.containers);return s.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Nl.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new L1(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function W4e(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=ee.useContext(FT),a=Xk(n),s=Xk(r?.id);return ee.useEffect(()=>{if(!e&&!n&&a&&s!=null){if(!QN(a)||document.activeElement===a.target)return;const o=i.get(s);if(!o)return;const{activatorNode:u,node:h}=o;if(!u.current&&!h.current)return;requestAnimationFrame(()=>{for(const f of[u.current,h.current]){if(!f)continue;const d=F5e(f);if(d){d.focus();break}}})}},[n,e,i,s,a]),null}function G4e(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function X4e(t){return ee.useMemo(()=>({draggable:{...Sw.draggable,...t?.draggable},droppable:{...Sw.droppable,...t?.droppable},dragOverlay:{...Sw.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Y4e(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=ee.useRef(!1),{x:s,y:o}=typeof i=="boolean"?{x:i,y:i}:i;nd(()=>{if(!s&&!o||!e){a.current=!1;return}if(a.current||!n)return;const h=e?.node.current;if(!h||h.isConnected===!1)return;const f=r(h),d=tJ(f,n);if(s||(d.x=0),o||(d.y=0),a.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const b=rJ(h);b&&b.scrollBy({top:d.y,left:d.x})}},[e,s,o,n,r])}const pJ=ee.createContext({...uf,scaleX:1,scaleY:1});var kp;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(kp||(kp={}));const Z4e=ee.memo(function(e){var r,n,i,a;let{id:s,accessibility:o,autoScroll:u=!0,children:h,sensors:f=j4e,collisionDetection:d=e4e,measuring:b,modifiers:v,...S}=e;const E=ee.useReducer(H4e,void 0,q4e),[P,k]=E,[L,N]=$5e(),[M,z]=ee.useState(kp.Uninitialized),B=M===kp.Initialized,{draggable:{active:q,nodes:W,translate:G},droppable:{containers:ie}}=P,J=q!=null?W.get(q):null,H=ee.useRef({initial:null,translated:null}),ne=ee.useMemo(()=>{var jt;return q!=null?{id:q,data:(jt=J?.data)!=null?jt:U4e,rect:H}:null},[q,J]),ae=ee.useRef(null),[ue,de]=ee.useState(null),[Pe,me]=ee.useState(null),Ee=gb(S,Object.values(S)),we=cx("DndDescribedBy",s),Ae=ee.useMemo(()=>ie.getEnabled(),[ie]),ce=X4e(b),{droppableRects:xe,measureDroppableContainers:_e,measuringScheduled:Me}=I4e(Ae,{dragging:B,dependencies:[G.x,G.y],config:ce.droppable}),Re=C4e(W,q),He=ee.useMemo(()=>Pe?Yk(Pe):null,[Pe]),Fe=Zt(),tt=P4e(Re,ce.draggable.measure);Y4e({activeNode:q!=null?W.get(q):null,config:Fe.layoutShiftCompensation,initialRect:tt,measure:ce.draggable.measure});const Ze=SV(Re,ce.draggable.measure,tt),Qe=SV(Re?Re.parentElement:null),Ie=ee.useRef({activatorEvent:null,active:null,activeNode:Re,collisionRect:null,collisions:null,droppableRects:xe,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:ie,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Lt=ie.getNodeFor((r=Ie.current.over)==null?void 0:r.id),at=z4e({measure:ce.dragOverlay.measure}),Ve=(n=at.nodeRef.current)!=null?n:Re,nr=B?(i=at.rect)!=null?i:Ze:null,Yt=!!(at.nodeRef.current&&at.rect),yr=R4e(Yt?null:Ze),mt=fJ(Ve?Nc(Ve):null),br=O4e(B?Lt??Re:null),Tr=F4e(br),mr=G4e(v,{transform:{x:G.x-yr.x,y:G.y-yr.y,scaleX:1,scaleY:1},activatorEvent:Pe,active:ne,activeNodeRect:Ze,containerNodeRect:Qe,draggingNodeRect:nr,over:Ie.current.over,overlayNodeRect:at.rect,scrollableAncestors:br,scrollableAncestorRects:Tr,windowRect:mt}),Mr=He?$v(He,G):null,Pr=N4e(br),ar=TV(Pr),fr=TV(Pr,[Ze]),Nr=$v(mr,ar),or=nr?n4e(nr,mr):null,Dr=ne&&or?d({active:ne,collisionRect:or,droppableRects:xe,droppableContainers:Ae,pointerCoordinates:Mr}):null,er=K5e(Dr,"id"),[Gt,Tt]=ee.useState(null),Oe=Yt?mr:$v(mr,fr),Be=t4e(Oe,(a=Gt?.rect)!=null?a:null,Ze),Ne=ee.useRef(null),rt=ee.useCallback((jt,St)=>{let{sensor:Xt,options:Ct}=St;if(ae.current==null)return;const Lr=W.get(ae.current);if(!Lr)return;const qt=jt.nativeEvent,Zr=new Xt({active:ae.current,activeNode:Lr,event:qt,options:Ct,context:Ie,onAbort(vn){if(!W.get(vn))return;const{onDragAbort:Ue}=Ee.current,ft={id:vn};Ue?.(ft),L({type:"onDragAbort",event:ft})},onPending(vn,Ce,Ue,ft){if(!W.get(vn))return;const{onDragPending:xr}=Ee.current,Kr={id:vn,constraint:Ce,initialCoordinates:Ue,offset:ft};xr?.(Kr),L({type:"onDragPending",event:Kr})},onStart(vn){const Ce=ae.current;if(Ce==null)return;const Ue=W.get(Ce);if(!Ue)return;const{onDragStart:ft}=Ee.current,Mt={activatorEvent:qt,active:{id:Ce,data:Ue.data,rect:H}};Fd.unstable_batchedUpdates(()=>{ft?.(Mt),z(kp.Initializing),k({type:Nl.DragStart,initialCoordinates:vn,active:Ce}),L({type:"onDragStart",event:Mt}),de(Ne.current),me(qt)})},onMove(vn){k({type:Nl.DragMove,coordinates:vn})},onEnd:jr(Nl.DragEnd),onCancel:jr(Nl.DragCancel)});Ne.current=Zr;function jr(vn){return async function(){const{active:Ue,collisions:ft,over:Mt,scrollAdjustedTranslate:xr}=Ie.current;let Kr=null;if(Ue&&xr){const{cancelDrop:Rr}=Ee.current;Kr={activatorEvent:qt,active:Ue,collisions:ft,delta:xr,over:Mt},vn===Nl.DragEnd&&typeof Rr=="function"&&await Promise.resolve(Rr(Kr))&&(vn=Nl.DragCancel)}ae.current=null,Fd.unstable_batchedUpdates(()=>{k({type:vn}),z(kp.Uninitialized),Tt(null),de(null),me(null),Ne.current=null;const Rr=vn===Nl.DragEnd?"onDragEnd":"onDragCancel";if(Kr){const di=Ee.current[Rr];di?.(Kr),L({type:Rr,event:Kr})}})}}},[W]),pt=ee.useCallback((jt,St)=>(Xt,Ct)=>{const Lr=Xt.nativeEvent,qt=W.get(Ct);if(ae.current!==null||!qt||Lr.dndKit||Lr.defaultPrevented)return;const Zr={active:qt};jt(Xt,St.options,Zr)===!0&&(Lr.dndKit={capturedBy:St.sensor},ae.current=Ct,rt(Xt,St))},[W,rt]),Rt=A4e(f,pt);L4e(f),nd(()=>{Ze&&M===kp.Initializing&&z(kp.Initialized)},[Ze,M]),ee.useEffect(()=>{const{onDragMove:jt}=Ee.current,{active:St,activatorEvent:Xt,collisions:Ct,over:Lr}=Ie.current;if(!St||!Xt)return;const qt={active:St,activatorEvent:Xt,collisions:Ct,delta:{x:Nr.x,y:Nr.y},over:Lr};Fd.unstable_batchedUpdates(()=>{jt?.(qt),L({type:"onDragMove",event:qt})})},[Nr.x,Nr.y]),ee.useEffect(()=>{const{active:jt,activatorEvent:St,collisions:Xt,droppableContainers:Ct,scrollAdjustedTranslate:Lr}=Ie.current;if(!jt||ae.current==null||!St||!Lr)return;const{onDragOver:qt}=Ee.current,Zr=Ct.get(er),jr=Zr&&Zr.rect.current?{id:Zr.id,rect:Zr.rect.current,data:Zr.data,disabled:Zr.disabled}:null,vn={active:jt,activatorEvent:St,collisions:Xt,delta:{x:Lr.x,y:Lr.y},over:jr};Fd.unstable_batchedUpdates(()=>{Tt(jr),qt?.(vn),L({type:"onDragOver",event:vn})})},[er]),nd(()=>{Ie.current={activatorEvent:Pe,active:ne,activeNode:Re,collisionRect:or,collisions:Dr,droppableRects:xe,draggableNodes:W,draggingNode:Ve,draggingNodeRect:nr,droppableContainers:ie,over:Gt,scrollableAncestors:br,scrollAdjustedTranslate:Nr},H.current={initial:nr,translated:or}},[ne,Re,Dr,or,W,Ve,nr,xe,ie,Gt,br,Nr]),S4e({...Fe,delta:G,draggingRect:or,pointerCoordinates:Mr,scrollableAncestors:br,scrollableAncestorRects:Tr});const Bt=ee.useMemo(()=>({active:ne,activeNode:Re,activeNodeRect:Ze,activatorEvent:Pe,collisions:Dr,containerNodeRect:Qe,dragOverlay:at,draggableNodes:W,droppableContainers:ie,droppableRects:xe,over:Gt,measureDroppableContainers:_e,scrollableAncestors:br,scrollableAncestorRects:Tr,measuringConfiguration:ce,measuringScheduled:Me,windowRect:mt}),[ne,Re,Ze,Pe,Dr,Qe,at,W,ie,xe,Gt,_e,br,Tr,ce,Me,mt]),At=ee.useMemo(()=>({activatorEvent:Pe,activators:Rt,active:ne,activeNodeRect:Ze,ariaDescribedById:{draggable:we},dispatch:k,draggableNodes:W,over:Gt,measureDroppableContainers:_e}),[Pe,Rt,ne,Ze,k,we,W,Gt,_e]);return ht.createElement(eJ.Provider,{value:N},ht.createElement(FT.Provider,{value:At},ht.createElement(dJ.Provider,{value:Bt},ht.createElement(pJ.Provider,{value:Be},h)),ht.createElement(W4e,{disabled:o?.restoreFocus===!1})),ht.createElement(W5e,{...o,hiddenTextDescribedById:we}));function Zt(){const jt=ue?.autoScrollEnabled===!1,St=typeof u=="object"?u.enabled===!1:u===!1,Xt=B&&!jt&&!St;return typeof u=="object"?{...u,enabled:Xt}:{enabled:Xt}}}),K4e=ee.createContext(null),AV="button",J4e="Draggable";function Q4e(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=cx(J4e),{activators:s,activatorEvent:o,active:u,activeNodeRect:h,ariaDescribedById:f,draggableNodes:d,over:b}=ee.useContext(FT),{role:v=AV,roleDescription:S="draggable",tabIndex:E=0}=i??{},P=u?.id===e,k=ee.useContext(P?pJ:K4e),[L,N]=MS(),[M,z]=MS(),B=D4e(s,e),q=gb(r);nd(()=>(d.set(e,{id:e,key:a,node:L,activatorNode:M,data:q}),()=>{const G=d.get(e);G&&G.key===a&&d.delete(e)}),[d,e]);const W=ee.useMemo(()=>({role:v,tabIndex:E,"aria-disabled":n,"aria-pressed":P&&v===AV?!0:void 0,"aria-roledescription":S,"aria-describedby":f.draggable}),[n,v,E,P,S,f.draggable]);return{active:u,activatorEvent:o,activeNodeRect:h,attributes:W,isDragging:P,listeners:n?void 0:B,node:L,over:b,setNodeRef:N,setActivatorNodeRef:z,transform:k}}function eIe(){return ee.useContext(dJ)}const tIe="Droppable",rIe={timeout:25};function nIe(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=cx(tIe),{active:s,dispatch:o,over:u,measureDroppableContainers:h}=ee.useContext(FT),f=ee.useRef({disabled:r}),d=ee.useRef(!1),b=ee.useRef(null),v=ee.useRef(null),{disabled:S,updateMeasurementsFor:E,timeout:P}={...rIe,...i},k=gb(E??n),L=ee.useCallback(()=>{if(!d.current){d.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(k.current)?k.current:[k.current]),v.current=null},P)},[P]),N=DT({callback:L,disabled:S||!s}),M=ee.useCallback((W,G)=>{N&&(G&&(N.unobserve(G),d.current=!1),W&&N.observe(W))},[N]),[z,B]=MS(M),q=gb(e);return ee.useEffect(()=>{!N||!z.current||(N.disconnect(),d.current=!1,N.observe(z.current))},[z,N]),ee.useEffect(()=>(o({type:Nl.RegisterDroppable,element:{id:n,key:a,disabled:r,node:z,rect:b,data:q}}),()=>o({type:Nl.UnregisterDroppable,key:a,id:n})),[n]),ee.useEffect(()=>{r!==f.current.disabled&&(o({type:Nl.SetDroppableDisabled,id:n,key:a,disabled:r}),f.current.disabled=r)},[n,a,r,o]),{active:s,rect:b,isOver:u?.id===n,node:z,over:u,setNodeRef:B}}function gJ(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function iIe(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function L2(t){return t!==null&&t>=0}function aIe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function oIe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const mJ=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=gJ(e,n,r),s=e[i],o=a[i];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},D2={scaleX:1,scaleY:1},sIe=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:s}=t;const o=(e=a[r])!=null?e:n;if(!o)return null;if(i===r){const h=a[s];return h?{x:0,y:r<s?h.top+h.height-(o.top+o.height):h.top-o.top,...D2}:null}const u=lIe(a,i,r);return i>r&&i<=s?{x:0,y:-o.height-u,...D2}:i<r&&i>=s?{x:0,y:o.height+u,...D2}:{x:0,y:0,...D2}};function lIe(t,e,r){const n=t[e],i=t[e-1],a=t[e+1];return n?r<e?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const yJ="Sortable",vJ=ht.createContext({activeIndex:-1,containerId:yJ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:mJ,disabled:{draggable:!1,droppable:!1}});function uIe(t){let{children:e,id:r,items:n,strategy:i=mJ,disabled:a=!1}=t;const{active:s,dragOverlay:o,droppableRects:u,over:h,measureDroppableContainers:f}=eIe(),d=cx(yJ,r),b=o.rect!==null,v=ee.useMemo(()=>n.map(B=>typeof B=="object"&&"id"in B?B.id:B),[n]),S=s!=null,E=s?v.indexOf(s.id):-1,P=h?v.indexOf(h.id):-1,k=ee.useRef(v),L=!aIe(v,k.current),N=P!==-1&&E===-1||L,M=oIe(a);nd(()=>{L&&S&&f(v)},[L,v,S,f]),ee.useEffect(()=>{k.current=v},[v]);const z=ee.useMemo(()=>({activeIndex:E,containerId:d,disabled:M,disableTransforms:N,items:v,overIndex:P,useDragOverlay:b,sortedRects:iIe(v,u),strategy:i}),[E,d,M.draggable,M.droppable,N,v,P,u,b,i]);return ht.createElement(vJ.Provider,{value:z},e)}const cIe=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return gJ(r,n,i).indexOf(e)},hIe=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:s,previousItems:o,previousContainerId:u,transition:h}=t;return!h||!n||o!==a&&i===s?!1:r?!0:s!==i&&e===u},fIe={duration:200,easing:"ease"},_J="transform",dIe=mb.Transition.toString({property:_J,duration:0,easing:"linear"}),pIe={roleDescription:"sortable"};function gIe(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,s]=ee.useState(null),o=ee.useRef(r);return nd(()=>{if(!e&&r!==o.current&&n.current){const u=i.current;if(u){const h=V0(n.current,{ignoreTransform:!0}),f={x:u.left-h.left,y:u.top-h.top,scaleX:u.width/h.width,scaleY:u.height/h.height};(f.x||f.y)&&s(f)}}r!==o.current&&(o.current=r)},[e,r,n,i]),ee.useEffect(()=>{a&&s(null)},[a]),a}function mIe(t){let{animateLayoutChanges:e=hIe,attributes:r,disabled:n,data:i,getNewIndex:a=cIe,id:s,strategy:o,resizeObserverConfig:u,transition:h=fIe}=t;const{items:f,containerId:d,activeIndex:b,disabled:v,disableTransforms:S,sortedRects:E,overIndex:P,useDragOverlay:k,strategy:L}=ee.useContext(vJ),N=yIe(n,v),M=f.indexOf(s),z=ee.useMemo(()=>({sortable:{containerId:d,index:M,items:f},...i}),[d,i,M,f]),B=ee.useMemo(()=>f.slice(f.indexOf(s)),[f,s]),{rect:q,node:W,isOver:G,setNodeRef:ie}=nIe({id:s,data:z,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:B,...u}}),{active:J,activatorEvent:H,activeNodeRect:ne,attributes:ae,setNodeRef:ue,listeners:de,isDragging:Pe,over:me,setActivatorNodeRef:Ee,transform:we}=Q4e({id:s,data:z,attributes:{...pIe,...r},disabled:N.draggable}),Ae=O5e(ie,ue),ce=!!J,xe=ce&&!S&&L2(b)&&L2(P),_e=!k&&Pe,Me=_e&&xe?we:null,He=xe?Me??(o??L)({rects:E,activeNodeRect:ne,activeIndex:b,overIndex:P,index:M}):null,Fe=L2(b)&&L2(P)?a({id:s,items:f,activeIndex:b,overIndex:P}):M,tt=J?.id,Ze=ee.useRef({activeId:tt,items:f,newIndex:Fe,containerId:d}),Qe=f!==Ze.current.items,Ie=e({active:J,containerId:d,isDragging:Pe,isSorting:ce,id:s,index:M,items:f,newIndex:Ze.current.newIndex,previousItems:Ze.current.items,previousContainerId:Ze.current.containerId,transition:h,wasDragging:Ze.current.activeId!=null}),Lt=gIe({disabled:!Ie,index:M,node:W,rect:q});return ee.useEffect(()=>{ce&&Ze.current.newIndex!==Fe&&(Ze.current.newIndex=Fe),d!==Ze.current.containerId&&(Ze.current.containerId=d),f!==Ze.current.items&&(Ze.current.items=f)},[ce,Fe,d,f]),ee.useEffect(()=>{if(tt===Ze.current.activeId)return;if(tt!=null&&Ze.current.activeId==null){Ze.current.activeId=tt;return}const Ve=setTimeout(()=>{Ze.current.activeId=tt},50);return()=>clearTimeout(Ve)},[tt]),{active:J,activeIndex:b,attributes:ae,data:z,rect:q,index:M,newIndex:Fe,items:f,isOver:G,isSorting:ce,isDragging:Pe,listeners:de,node:W,overIndex:P,over:me,setNodeRef:Ae,setActivatorNodeRef:Ee,setDroppableNodeRef:ie,setDraggableNodeRef:ue,transform:Lt??He,transition:at()};function at(){if(Lt||Qe&&Ze.current.newIndex===M)return dIe;if(!(_e&&!QN(H)||!h)&&(ce||Ie))return mb.Transition.toString({...h,property:_J})}}function yIe(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}ja.Down,ja.Right,ja.Up,ja.Left;function LS({children:t,layerId:e}){const{attributes:r,listeners:n,setNodeRef:i,transform:a}=mIe({id:e}),s={transform:mb.Transform.toString(a)};return Z.jsx("li",{ref:i,style:s,...r,...n,children:t})}try{LS.displayName="SortableContainer",LS.__docgenInfo={description:"",displayName:"SortableContainer",props:{layerId:{defaultValue:null,description:"",name:"layerId",required:!0,type:{name:"string"}}}}}catch{}const vIe=Br(th)({padding:"4px",marginTop:"-3px"}),_Ie=Br(th)({marginLeft:"20px"});function zd({layerComponent:t,visible:e,type:r,name:n,description:i,configurable:a,setLayerState:s,...o}){const[u,h]=ee.useState(!0),[f,d]=ee.useState(!1),[b,v]=ee.useState(!1),S=ee.useRef(!1),E=ee.useRef(e),[P,k]=ee.useState(t?.props?.paint||t?.props?.options?.paint||GZ(t?.props?.type||bS(t.props.geojson))),L=ee.useMemo(()=>e?u:!1,[e,u]);ee.useEffect(()=>{if(!s||!t?.props?.layers||L===E.current)return;E.current=L;const B={...t?.props};switch(t.type.name){case"MlWmsLayer":break;case"MlVectorTileLayer":t?.props?.layers&&!S.current&&(B.layers=t?.props?.layers.map(q=>(q.layout?q.layout.visibility=L?"visible":"none":q.layout={visibility:L?"visible":"none"},q)),console.log("setLayerState",B.layers),s(B));break}},[L,s,t]),ee.useEffect(()=>{!s||S.current||!P||t?.props?.layers||JSON.stringify(P)!==JSON.stringify(t.props?.paint)&&s({...t.props,paint:P})},[P,s,t.props?.paint]);const N=ee.useMemo(()=>{if(t&&r==="layer")switch(t.type.displayName){case"MlWmsLayer":return ht.cloneElement(t,{...t?.props,visible:L});case"MlVectorTileLayer":return ht.cloneElement(t,{...t?.props});default:case"MlGeoJsonLayer":return ht.cloneElement(t,{layout:{visibility:L?"visible":"none"},options:{...t?.props?.options,...s?{}:{paint:P}}})}return Z.jsx(Z.Fragment,{})},[r,t,P,L,t?.props?.layers,s]),M=ee.useMemo(()=>{if(t&&r==="layer"){if(t.props.type)return t.props.type;if(t.props.geojson)return bS(t.props.geojson)}},[t]),z=Z.jsxs(PS,{sx:{...o.listItemSx},secondaryAction:a&&Object.keys(P)?.length>0?Z.jsxs(Z.Fragment,{children:[o?.buttons,Z.jsx(vIe,{edge:"end","aria-label":"settings",onClick:()=>{d(B=>!B)},children:Z.jsx(oN,{})})]}):void 0,children:[Z.jsx(Nd,{children:Z.jsx(Ld,{disabled:!e,checked:u,onClick:()=>{h(B=>!B)}})}),Z.jsx(mh,{variant:"layerlist",primary:n,secondary:i,primaryTypographyProps:{overflow:"hidden"}})]});return Z.jsxs(Z.Fragment,{children:[o.sortable&&o.layerId&&!t?.props?.layers&&Z.jsx(LS,{layerId:o.layerId,children:z}),!o.sortable&&!t?.props?.layers&&z,N,!t?.props?.layers&&Object.keys(P).length>0&&a&&f&&Z.jsxs(Z.Fragment,{children:[o.showDeleteButton&&Z.jsxs(Z.Fragment,{children:[Z.jsx(_Ie,{edge:"end","aria-label":"delete",onClick:()=>{typeof s=="function"&&v(!0)},children:Z.jsx(nx,{})}),b&&Z.jsx(f0,{open:b,onConfirm:()=>{typeof s=="function"&&(S.current=!0,s(!1),v(!1))},onCancel:()=>{v(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),Z.jsx(IS,{paintProps:P,setPaintProps:k,layerType:M})]}),t?.props?.layers&&Z.jsx(zk,{visible:u,setVisible:h,name:n,children:t?.props?.layers?.map?.((B,q)=>Z.jsx(kS,{vtProps:t?.props,setVtProps:s,id:""+q,visibleMaster:L},""+q))})]})}zd.defaultProps={type:"layer",visible:!0,showDeleteButton:!1,buttons:Z.jsx(Z.Fragment,{})};try{zd.displayName="LayerListItem",zd.__docgenInfo={description:"",displayName:"LayerListItem",props:{layerComponent:{defaultValue:null,description:"",name:"layerComponent",required:!0,type:{name:"Element"}},visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!0,type:{name:"boolean"}},type:{defaultValue:{value:"layer"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"Dispatch<any> | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:{value:"<></>"},description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const bIe=Yi(Z.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),xIe=Br("div")(()=>({display:"flex",alignItems:"center"})),wIe=56,SIe=Br(Ho)(({theme:t})=>({width:30,height:6,backgroundColor:t.palette.text.primary,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)"}));function Qk({drawerPaperProps:t,drawerHeaderProps:e,setOpen:r,...n}){const i=Gb(u=>u.breakpoints.down("sm")),[a,s]=ee.useState(!1),o=n.drawerBleeding?n.drawerBleeding:wIe;return Z.jsxs(Z.Fragment,{children:[i?Z.jsxs(Ho,{sx:{display:{xs:"flex",sm:"none"}},children:[Z.jsx(CW,{styles:{".MuiDrawer-root > .MuiPaper-root":{height:`calc(50% - ${o}px)`,overflow:"visible"}}}),Z.jsxs(Ige,{anchor:"bottom",open:typeof n.open>"u"?a:n.open,onClose:r?()=>{r?.(!1)}:()=>{s(!1)},onOpen:r?()=>{r?.(!0)}:()=>{s(!0)},swipeAreaWidth:o,disableSwipeToOpen:!1,hideBackdrop:!0,ModalProps:{keepMounted:!0,sx:{top:"calc(90%)"}},children:[Z.jsxs(Eh,{sx:{position:"absolute",top:-o,borderTopLeftRadius:8,borderTopRightRadius:8,visibility:"visible",right:0,left:0},children:[Z.jsx(SIe,{}),Z.jsx(bs,{variant:"h6",sx:{p:"13px"},children:n.name})]}),Z.jsx(Eh,{sx:{px:"15px",pb:"15px",height:"100%",overflow:"auto",paddingTop:"20px"},children:n.children})]})]}):Z.jsx(Ho,{sx:{display:{xs:"none",sm:"flex"},mr:1},children:Z.jsxs(aO,{transitionDuration:0,variant:"persistent",anchor:"left",open:typeof n.open>"u"?a:n.open,PaperProps:{...t,sx:{maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},padding:{sm:"84px 20px 20px 20px",xs:"74px 10px 10px 10px"},width:{xs:"80%",sm:"60%",md:"350px",lg:"350px"},boxSizing:"border-box",...t?.sx}},sx:{flexGrow:1,zIndex:105,position:"absolute",bottom:0,display:"flex",flexDirection:"column",maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},...a?{}:{left:i?"-90vw":"-20vw"}},...n,children:[Z.jsxs(xIe,{...e,children:[Z.jsx(bs,{variant:"h6",children:n.name}),Z.jsx(th,{onClick:r?()=>{r?.(!1)}:()=>{s(!1)},sx:{position:"absolute",right:"20px"},children:Z.jsx(bIe,{})})]}),Z.jsx(Ho,{children:n.children})]})}),";"]})}try{Qk.displayName="Sidebar",Qk.__docgenInfo={description:"",displayName:"Sidebar",props:{drawerPaperProps:{defaultValue:null,description:"",name:"drawerPaperProps",required:!1,type:{name:"PaperProps | undefined"}},drawerHeaderProps:{defaultValue:null,description:"",name:"drawerHeaderProps",required:!1,type:{name:"Headers | undefined"}},children:{defaultValue:null,description:"The content of the component.",name:"children",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"If `true`, the component is shown.",name:"open",required:!1,type:{name:"boolean | undefined"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!1,type:{name:"((val: boolean) => void) | undefined"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},drawerBleeding:{defaultValue:null,description:"",name:"drawerBleeding",required:!1,type:{name:"number | undefined"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<DrawerSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<ModalProps, keyof IntrinsicElements>, DrawerRootSlotPropsOverrides, DrawerOwnerState> | undefined; backdrop?: SlotProps<...> | undefined; docked?: SlotProps<...> | undefined; paper?: SlotProps<...> | undefined; transition?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}const IV=t=>{const[e,r]=ee.useState(!0),[n,i]=ee.useState(t.measureType),[a,s]=ee.useState(),o=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[u,h]=ee.useState(),[f,d]=ee.useState("kilometers"),[b,v]=ee.useState([]),[S,E]=ee.useState(!1),P=()=>{f==="kilometers"&&d("miles"),f==="miles"&&d("kilometers")},k=N=>{v(M=>{const z=[...M];return z.splice(N,1),s(void 0),z})},L=N=>{h({measure:N.value,unit:N.unit,geojson:N.geojson})};return ee.useEffect(()=>{S&&(E(!1),u&&v(N=>{const M=[...N];return M.push(u),M}))},[S]),ee.useEffect(()=>{h(void 0)},[f]),Z.jsx(Z.Fragment,{children:Z.jsxs(Qk,{open:e,setOpen:r,name:"Multi Measure Tool",children:[Z.jsxs(Ho,{sx:{flexGrow:1},children:[Z.jsx("br",{}),Z.jsxs(Bd,{container:!0,spacing:4,justifyContent:"flex-start",children:[Z.jsx(Bd,{size:3,children:Z.jsx(Dp,{title:"Measure Area",children:Z.jsx(ra,{variant:"outlined",sx:{backgroundColor:n==="polygon"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="polygon"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("polygon"),h(void 0),E(!0)},children:Z.jsx(YZ,{})})})}),Z.jsx(Bd,{size:3,children:Z.jsx(Dp,{title:"Measure Distance",children:Z.jsx(ra,{variant:"outlined",sx:{backgroundColor:n==="line"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="line"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("line"),h(void 0),E(!0)},children:Z.jsx(XZ,{})})})})]})]}),Z.jsx("br",{}),Z.jsx(Bd,{size:4,children:Z.jsxs(Kc,{children:[Z.jsx(qp,{id:"unit-select-label",children:"Unit"}),Z.jsxs(Hp,{labelId:"unit-select-label",id:"unit-select",value:f,label:"Unit",onChange:N=>{d(N.target.value),h(void 0),E(!0)},children:[Z.jsx(im,{value:"kilometers",children:"Kilometers"}),Z.jsx(im,{value:"miles",children:"Miles"})]})]})}),Z.jsx("br",{}),!S&&Z.jsx(Fk,{measureType:n,unit:f,onChange:L,...P,onFinish:()=>{E(!0)}}),Z.jsxs(Bk,{children:[b?.map((N,M)=>Z.jsx(Z.Fragment,{children:Z.jsxs(Ho,{sx:{display:"flex",flexDirection:"column"},children:[Z.jsx("br",{}),Z.jsx(Ho,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{s(N.geojson)},onMouseLeave:()=>{s(void 0)},children:Z.jsxs(ee.Fragment,{children:[Z.jsx(zd,{layerComponent:Z.jsx(Ac,{mapId:t.mapId,geojson:N.geojson}),visible:!0,configurable:!0,type:"layer",name:N.geojson.geometry?.type==="LineString"?N.measure.toFixed(3).toString()+" "+N.unit:N.measure.toFixed(3).toString()+" "+N.unit+"²"},N.measure),Z.jsx(Dp,{title:"Delete",children:Z.jsxs(ra,{onClick:()=>k(M),children:[" ",Z.jsx(nx,{})," "]})}),Z.jsx(Dp,{title:"Center Location",children:Z.jsx(ra,{onClick:()=>{o?.map?.map.setCenter(N.geojson.geometry.type==="Point"?N.geojson.geometry.coordinates:nN(N.geojson).geometry.coordinates)},children:Z.jsx(aN,{})})})]},N.measure+"-"+M)})]},N.measure)})),a&&Z.jsx(Ac,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[a]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#dd9900","circle-opacity":.4,"circle-radius":10},line:{"line-color":"#dd9900","line-opacity":.4,"line-width":10},fill:{"fill-color":"#dd9900","fill-opacity":.4}}})]})]})})};try{IV.displayName="MlMultiMeasureTool",IV.__docgenInfo={description:"",displayName:"MlMultiMeasureTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},multiType:{defaultValue:null,description:"Boolean which decides if the user can switch between measure modes",name:"multiType",required:!1,type:{name:"boolean | undefined"}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: { value: number; unit?: string | undefined; geojson: Feature<Geometry, GeoJsonProperties>; geometries?: [] | undefined; }) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const EIe=Yi(Z.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),TIe=Yi(Z.jsx("path",{d:"M19 13H5v-2h14z"})),eM=({className:t="",title:e,onClick:r,style:n})=>Z.jsxs("svg",{width:"52",height:"53",viewBox:"0 0 52 53",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&Z.jsx("title",{children:e}),Z.jsx("circle",{cx:"26.0001",cy:"26.1843",r:"24",fill:"white",stroke:"#009EE0",strokeWidth:"2"}),Z.jsx("path",{d:"M26.4915 7.59161C26.3524 8.07338 25.6698 8.07338 25.5307 7.59161L24.2998 3.3276C24.2075 3.0079 24.4474 2.68893 24.7802 2.68893H27.242C27.5748 2.68893 27.8147 3.0079 27.7224 3.3276L26.4915 7.59161Z",fill:"#009EE0"}),Z.jsx("path",{d:"M25.5085 44.7598C25.6476 44.278 26.3302 44.278 26.4693 44.7598L27.7002 49.0238C27.7925 49.3435 27.5526 49.6625 27.2198 49.6625H24.758C24.4252 49.6625 24.1853 49.3435 24.2776 49.0238L25.5085 44.7598Z",fill:"#009EE0"}),Z.jsx("path",{d:"M44.6641 26.4915C44.1823 26.3524 44.1823 25.6698 44.6641 25.5307L48.9281 24.2998C49.2478 24.2075 49.5668 24.4474 49.5668 24.7802V27.242C49.5668 27.5747 49.2478 27.8147 48.9281 27.7224L44.6641 26.4915Z",fill:"#009EE0"}),Z.jsx("path",{d:"M7.3959 25.6085C7.87766 25.7476 7.87766 26.4302 7.3959 26.5693L3.13189 27.8002C2.81218 27.8925 2.49321 27.6526 2.49321 27.3198L2.49321 24.858C2.49321 24.5253 2.81218 24.2853 3.13189 24.3776L7.3959 25.6085Z",fill:"#009EE0"})]});try{eM.displayName="CompassBackground",eM.__docgenInfo={description:"",displayName:"CompassBackground",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const tM=({className:t="",title:e,onClick:r,style:n})=>Z.jsxs("svg",{width:"10",height:"40",viewBox:"0 0 10 40",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&Z.jsx("title",{children:e}),Z.jsxs("g",{transform:"translate(0.67544,-1.25e-5)",children:[Z.jsx("path",{d:"m 3.34715,4.52028 c 0.22737,-1.05154 1.72745,-1.05154 1.95482,0 L 8.64912,20 H 0 Z",fill:"#cf003d"}),Z.jsx("path",{d:"m 3.34715,35.4797 c 0.22737,1.0516 1.72745,1.0516 1.95482,0 L 8.64912,20 H 0 Z",fill:"#d3dcf0"})]})]});try{tM.displayName="CompassNeedle",tM.__docgenInfo={description:"",displayName:"CompassNeedle",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const CIe=Br(Ho)(({theme:t})=>({zIndex:1e3,cursor:"pointer",transform:"scale(1)",[t.breakpoints.down("md")]:{transform:"scale(1.6)"}})),AIe=Br(Ho)(({theme:t})=>({position:"absolute",right:"-10px",top:"-52px",width:"52px",height:"52px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",[t.breakpoints.down("md")]:{right:"0px",top:"-52px"},circle:{fill:t.palette.compass.compColor,stroke:t.palette.compass.compStroke},path:{fill:t.palette.compass.compStroke},"&:hover circle":{fill:t.palette.compass.compHover}})),IIe=Br(Ho)(({theme:t})=>({display:"flex",flexDirection:"row","path:nth-of-type(2)":{fill:t.palette.compass.compSouth},"path:nth-of-type(1)":{fill:t.palette.compass.compNorth}})),rM=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(0),i=()=>{e.map?.map?.getBearing&&n(Math.round(e.map.map.getBearing()))};ee.useEffect(()=>{if(e.map)return e.map.on("rotate",i,e.componentId),i(),()=>{e.map?.map.off("rotate",i)}},[e.map,t.mapId]);const a=()=>{r==0?e.map?.map.setBearing(-90):r==-90?e.map?.map.setBearing(180):r==180?e.map?.map.setBearing(90):e.map?.map.setBearing(0)};return Z.jsx(Z.Fragment,{children:Z.jsx(CIe,{sx:{...t.style},children:Z.jsxs(AIe,{onClick:a,sx:{...t.backgroundStyle},children:[Z.jsx(eM,{style:{position:"absolute",top:0,left:0}}),Z.jsx(IIe,{onClick:a,sx:{...t.needleStyle},children:Z.jsx(tM,{style:{transform:"rotate("+(r>0?"-"+r:-1*r)+"deg)"}})})]})})})};try{rM.displayName="MlNavigationCompass",rM.__docgenInfo={description:`Navigation component that displays a compass component which indicates the current oriantation of the map it is registered for and offers controls to turn the bearing 90° left/right or reset north to point up.

All style props are applied using`,displayName:"MlNavigationCompass",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},backgroundStyle:{defaultValue:null,description:"Style object to adjust css definitions of the background.",name:"backgroundStyle",required:!1,type:{name:"CSSProperties | undefined"}},needleStyle:{defaultValue:null,description:"Style object to adjust css definitions of the compass needle.",name:"needleStyle",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const PIe=Yi(Z.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"})),kIe=Yi(Z.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),MIe=Br(ra)(({theme:t})=>({zIndex:1e3,color:t.palette.navigation.buttonColor,transform:"scale(1)"})),nM=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(t.mode||"mercator");ee.useEffect(()=>{e.map?.map.getProjection?.()?.type!==r&&e.map?.setProjection({type:r})},[e.map]);const i=()=>{if(!e.map)return;const a=r==="globe"?"mercator":"globe";e.map.setProjection({type:a}),n(a)};return Z.jsx(Z.Fragment,{children:Z.jsx(MIe,{variant:"navtools",onClick:i,style:t.style,children:r==="globe"?Z.jsx(kIe,{"data-testid":"PublicIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}}):Z.jsx(PIe,{"data-testid":"MapIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{nM.displayName="MlGlobeButton",nM.__docgenInfo={description:"",displayName:"MlGlobeButton",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},mode:{defaultValue:null,description:"Initial projection mode of the map.",name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"globe"'},{value:'"mercator"'}]}}}}}catch{}const iM=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(0),i=Gb(h=>h.breakpoints.down("md")),a=kc();ee.useEffect(()=>{e.map&&(e.map.on("pitchend",()=>{e.map&&n(e.map.getPitch())},e.componentId),n(e.map.getPitch()))},[e.map,t.mapId]);const s=ee.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()+.5})},[e.map]),o=ee.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()-.5})},[e.map]),u=ee.useCallback(()=>{if(!e.map)return;n(e.map.getPitch());const h=e.map.getPitch()!==0?0:60;e.map.easeTo({pitch:h})},[e.map]);return Z.jsxs(Ho,{sx:{zIndex:501,position:"absolute",display:"flex",flexDirection:"column",right:i?"15px":"25px",bottom:i?"20px":"40px",...i?{margin:"80px 10px 50px 10px"}:{marginTop:"50px"},...t.sx},children:[Z.jsx(rM,{}),t.show3DButton&&Z.jsx(ra,{variant:"navtools",onClick:u,sx:{color:h=>h.palette.navigation.buttonColor},children:r<29?"2D":"3D"}),t.showGlobeButton&&Z.jsx(nM,{}),t.showFollowGpsButton&&Z.jsx(Dk,{}),t.showCenterLocationButton&&Z.jsx(VP,{}),Z.jsx(BP,{orientation:"vertical",sx:{border:"none",Button:{minWidth:"20px !important",color:a.palette.navigation.buttonColor},"Button:hover":{border:"none"}},children:t.showZoomButtons&&Z.jsxs(Z.Fragment,{children:[Z.jsx(ra,{variant:"navtools",onClick:s,sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0,position:"relative"},children:Z.jsx(EIe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})}),Z.jsx(Eh,{sx:{backgroundColor:"#fff"},children:Z.jsx(zP,{sx:{marginLeft:"6px",marginRight:"6px"}})}),Z.jsx(ra,{variant:"navtools",onClick:o,sx:{margin:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:Z.jsx(TIe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})}),t.children&&ht.cloneElement(t.children,{})]})};try{iM.displayName="MlNavigationTools",iM.__docgenInfo={description:"",displayName:"MlNavigationTools",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},show3DButton:{defaultValue:null,description:"Show 3D button",name:"show3DButton",required:!1,type:{name:"boolean | undefined"}},showGlobeButton:{defaultValue:null,description:"Show global button",name:"showGlobeButton",required:!1,type:{name:"boolean | undefined"}},showZoomButtons:{defaultValue:null,description:"Show zoom button",name:"showZoomButtons",required:!1,type:{name:"boolean | undefined"}},showFollowGpsButton:{defaultValue:null,description:"Show follow GPS button",name:"showFollowGpsButton",required:!1,type:{name:"boolean | undefined"}},showCenterLocationButton:{defaultValue:null,description:"Show center on current position button",name:"showCenterLocationButton",required:!1,type:{name:"boolean | undefined"}},children:{defaultValue:null,description:"Additional JSX Elements to be rendered below MlNavigationTools buttons",name:"children",required:!1,type:{name:"Element | undefined"}},sx:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"sx",required:!1,type:{name:"SxProps | undefined"}},mediaIsMobile:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"mediaIsMobile",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const DS=t=>(Kd({idPrefix:"MlLayer-",layerId:t.layerId,mapId:t.mapId,geojson:t.geojson||void 0,options:{type:"background",paint:{...t?.options?.type&&t.options.type!=="background"?{}:{"background-color":"rgba(0,0,0,0)"}},...t.options},insertBeforeLayer:t.insertBeforeLayer}),Z.jsx(Z.Fragment,{}));try{DS.displayName="MlLayer",DS.__docgenInfo={description:"Basic layer component that create a layer in a MapLibre-gl instance and keeps it updated according to it attribute configuration.",displayName:"MlLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}}}}}catch{}const PV=t=>{const e=ee.useRef(0),r=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[n,i]=ee.useState(0),[a,s]=ee.useState(""),o=ee.useCallback(()=>{if(!r.map||r.map?.map.getZoom()===e.current)return;e.current=r.map?.map.getZoom();const d=t.maxWidth||100,b=r.map.map._container.clientHeight/2,v=r.map.map.unproject([0,b]),S=r.map.map.unproject([d,b]),E=v.distanceTo(S);if(t.unit==="imperial"){const P=3.2808*E;if(P>5280){const k=P/5280;u(d,k,r.map.map._getUIString("ScaleControl.Miles"))}else u(d,P,r.map.map._getUIString("ScaleControl.Feet"))}else if(t.unit==="nautical"){const P=E/1852;u(d,P,r.map.map._getUIString("ScaleControl.NauticalMiles"))}else E>=1e3?u(d,E/1e3,r.map.map._getUIString("ScaleControl.Kilometers")):u(d,E,r.map.map._getUIString("ScaleControl.Meters"))},[r.map,t.unit,t.maxWidth]);ee.useEffect(()=>{if(!r.map)return;const d=o;return r.map.on("move",d,r.componentId),o(),()=>{r.map?.map.off("move",d)}},[r.map,o]);const u=(d,b,v)=>{const S=f(b),E=S/b;i(d*E),s(S+"&nbsp;"+v)},h=d=>{const b=Math.pow(10,Math.ceil(-Math.log(d)/Math.LN10));return Math.round(d*b)/b},f=d=>{const b=Math.pow(10,`${Math.floor(d)}`.length-1);let v=d/b;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:v>=1?1:h(v),b*v};return Z.jsx(Z.Fragment,{children:Z.jsx("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:n+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:a}})})};try{PV.displayName="MlScaleReference",PV.__docgenInfo={description:"",displayName:"MlScaleReference",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number | undefined"}},unit:{defaultValue:null,description:"",name:"unit",required:!1,type:{name:"string | undefined"}}}}}catch{}var cI,kV;function RIe(){if(kV)return cI;kV=1;function t(r,n){var i=r.getCenter(),a=r.getZoom(),s=r.getBearing(),o=r.getPitch();n.forEach(function(u){u.jumpTo({center:i,zoom:a,bearing:s,pitch:o})})}function e(){var r,n=arguments.length;if(n===1)r=arguments[0];else{r=[];for(var i=0;i<n;i++)r.push(arguments[i])}var a=[];r.forEach(function(h,f){a[f]=u.bind(null,h,r.filter(function(d,b){return b!==f}))});function s(){r.forEach(function(h,f){h.on("move",a[f])})}function o(){r.forEach(function(h,f){h.off("move",a[f])})}function u(h,f){o(),t(h,f),s()}return s(),function(){o(),a=[],r=[]}}return cI=e,cI}var OIe=RIe();const bJ=ad(OIe),MV=t=>{const e=ee.useContext(sg),r=ee.useRef(!1),n=ee.useRef(()=>{}),[i,a]=ee.useState(50),s=ee.useRef(50),[o,u]=ee.useState(50),h=ee.useRef(50),f=ee.useMemo(()=>t.magnifierRadius||200,[t.magnifierRadius]),d=ee.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[t,e]),b=ee.useRef(()=>{d()&&S({clientX:s.current,clientY:h.current})});ee.useEffect(()=>{window.addEventListener("resize",b.current);const N=b.current;return()=>{window.removeEventListener("resize",N),n.current()}},[]);const v=ee.useCallback(N=>{if(!d())return;const M=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let z=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientX:0,B=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientY:0;z-=M.x,B-=M.y;const q=parseFloat((z/M.width*100).toFixed(2)),W=parseFloat((B/M.height*100).toFixed(2));(s.current!==q||h.current!==W)&&(a(q),s.current=q,u(W),h.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${f}px at `+s.current*M.width/100+"px "+h.current*M.height/100+"px)")},[e,d,t,f]),S=ee.useCallback(N=>{if(!d())return;const M=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let z=N.clientX,B=N.clientY;z-=M.x,B-=M.y;const q=parseFloat((z/M.width*100).toFixed(2)),W=parseFloat((B/M.height*100).toFixed(2));(s.current!==q||h.current!==W)&&(a(q),s.current=q,u(W),h.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${f}px at `+s.current*M.width/100+"px "+h.current*M.height/100+"px)")},[e,d,t,f]);ee.useEffect(()=>{!d()||r.current||(r.current=!0,n.current=bJ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),S({clientX:s.current,clientY:h.current}),S({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2,clientY:e.maps[t.map1Id].getCanvas().clientHeight/2}))},[e.mapIds,e,d,t,S]);const E=N=>{N.nativeEvent instanceof TouchEvent?(document.addEventListener("touchmove",v),document.addEventListener("touchend",P)):(document.addEventListener("mousemove",S),document.addEventListener("mouseup",k))},P=()=>{document.removeEventListener("touchmove",v),document.removeEventListener("touchend",P)},k=()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",k)},L=N=>{const M=new WheelEvent(N.type,N);e.map?.map.getCanvas().dispatchEvent(M)};return Z.jsx("div",{style:{position:"absolute",left:i+"%",top:o+"%",borderRadius:"50%",width:f*2-2+"px",height:f*2-2+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:f*-1-1+"px",marginTop:f*-1-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.magnifierStyle},onTouchStart:E,onMouseDown:E,onWheel:L})};try{MV.displayName="MlLayerMagnify",MV.__docgenInfo={description:`
Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals
the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id`,displayName:"MlLayerMagnify",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance",name:"map2Id",required:!0,type:{name:"string"}},magnifierRadius:{defaultValue:null,description:'Size of the "magnifier"-circle',name:"magnifierRadius",required:!1,type:{name:"number | undefined"}},magnifierStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the magnifier default style",name:"magnifierStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const aM=({className:t="",title:e,onClick:r,style:n,color:i})=>Z.jsxs("svg",{viewBox:"0 0 47 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,color:i,children:[Z.jsx("path",{d:"M29.5 21.25L35.75 15L29.5 8.75V21.25Z",fill:"#009EE0"}),Z.jsx("path",{d:"M17.5 8.75L11.25 15L17.5 21.25V8.75Z",fill:"#009EE0"})]});try{aM.displayName="SwipeIcon",aM.__docgenInfo={description:"",displayName:"SwipeIcon",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string | undefined"}}}}}catch{}const RV=t=>{const e=ee.useContext(sg),r=ee.useRef(!1),[n,i]=ee.useState(50),a=ee.useRef(0),s=ee.useRef(()=>{}),o=ee.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[e,t.map1Id,t.map2Id]),u=()=>{s.current()},h=ee.useCallback(E=>{if(!o())return;const P=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let k=typeof E.touches<"u"&&typeof E.touches[0]<"u"?E.touches[0].clientX:0;k-=P.x;const L=parseFloat((k/P.width*100).toFixed(2));if(a.current!==L){i(L),a.current=L;const N="rect(0, "+a.current*P.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]),f=ee.useCallback(E=>{if(!o())return;const P=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let k=E.clientX;k-=P.x;const L=parseFloat((k/P.width*100).toFixed(2));if(a.current!==L){i(L),a.current=L;const N="rect(0, "+a.current*P.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]);ee.useEffect(()=>u,[]),ee.useEffect(()=>{!o()||r.current||(r.current=!0,s.current=bJ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),f({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2}))},[e.mapIds,e,t,f,o]);const d=E=>{window?.TouchEvent&&E.nativeEvent instanceof window.TouchEvent?(document.addEventListener("touchmove",h),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",f),document.addEventListener("mouseup",v))},b=()=>{document.removeEventListener("touchmove",h),document.removeEventListener("touchend",b)},v=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v)};function S(){const E=parseFloat(e.maps[t.map2Id].getContainer().style.clip.split(",")[1].replace("px","")),P=e.maps[t.map1Id].getCanvas().getBoundingClientRect().width;if(E<P){const k=parseFloat((E/P*100).toFixed(2));i(k)}else{const k="rect(0, "+P/2+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=k,i(50)}}return ee.useEffect(()=>(window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}),[e]),Z.jsx("div",{style:{position:"absolute",left:n+"%",top:"50%",borderRadius:"50%",width:"65px",height:"65px",background:"rgba(234, 235, 241, 0.75)",border:"2px solid rgba(0, 158, 224, 0.75)",cursor:"pointer",zIndex:"110",marginLeft:"-35px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.buttonStyle},onTouchStart:d,onMouseDown:d,children:Z.jsx(aM,{color:"#0066ff",style:{width:"65px",height:"65px",justifyContent:"center",zIndex:1100}})})};try{RV.displayName="MlLayerSwipe",RV.__docgenInfo={description:"creates a split view of 2 synchronised maplibre instances",displayName:"MlLayerSwipe",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance.",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance.",name:"map2Id",required:!0,type:{name:"string"}},buttonStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the button default style",name:"buttonStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const xJ=function(t,e,r,n,i,a,s,o,u){if(typeof n.current[a.current]<"u"){const h=a.current+1===n.current.length?t.geojson:mu([...i.current,...n.current[a.current].geometry.coordinates]);u(h),typeof t.onTransitionFrame=="function"&&t.onTransitionFrame(h),a.current++,r.current&&a.current<n.current.length?o.current=setTimeout(()=>xJ(...arguments),s):(typeof t.onTransitionEnd=="function"&&t.onTransitionEnd(t.geojson),r.current=!1)}},NIe=(t,e,r,n,i,a,s,o,u,h)=>{const f=[],d=[];let b=[],v=[];e.current=[];const S=i.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},E=t.geojson;let P=E,k=S,L=!1;if(typeof P.geometry>"u"&&typeof k.geometry<"u"&&k.geometry.coordinates.length>1)P=mu(k.geometry.coordinates.slice(0,2));else if(typeof k.geometry>"u"&&typeof P.geometry<"u"&&P.geometry.coordinates.length>1)k=mu(P.geometry.coordinates.slice(0,2));else if(typeof k.geometry>"u"&&typeof P.geometry>"u")return;if(P.geometry.coordinates.length<k.geometry.coordinates.length&&(P=S,k=E,L=!0),P&&k)for(let ae=0,ue=P.geometry.coordinates.length;ae<ue;ae++)typeof k.geometry.coordinates[ae]<"u"&&P.geometry.coordinates[ae][0]===k.geometry.coordinates[ae][0]&&P.geometry.coordinates[ae][1]===k.geometry.coordinates[ae][1]?e.current.push(P.geometry.coordinates[ae]):(typeof P.geometry.coordinates[ae]<"u"&&d.push(P.geometry.coordinates[ae]),typeof k.geometry.coordinates[ae]<"u"&&f.push(k.geometry.coordinates[ae]));if(L?(b=f,v=d):(b=d,v=f),b.length<2&&v<2)return;const N=t.transitionTime/a,M=v.length>1?Math.round(hb(mu(v))):0,z=b.length>1?Math.round(hb(mu(b))):0,B=z+M,q=M/B,W=Math.round(N*q),G=Math.round(M/W*100)/100,ie=z/B,J=Math.round(N*ie),H=Math.round(z/J*100)/100;let ne;ne=[...OV(v,G,W)],ne.reverse(),ne=[...ne,...OV(b,H,J)],ne.push(E),r.current=ne,s.current=1,n.current=!0,u.current=setTimeout(()=>xJ(t,o,n,r,e,s,a,u,h),a)},OV=(t,e,r)=>{const n=[];if(t.length>1){const i=t2e(mu(t),e);let a=i.features[0];for(let s=0;s<r&&(n.push(a),typeof i.features[s]<"u");s++)a=mu([...a.geometry.coordinates,...i.features[s].geometry.coordinates])}return n},LIe=50,NV=t=>{const{geojson:e,...r}=t,n=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),i=ee.useRef(!1),a=ee.useRef(null),s=ee.useRef(!1),o=ee.useRef(void 0),u=ee.useRef(!1),h=ee.useRef([]),f=ee.useRef([]),[d,b]=ee.useState(Zd([]));ee.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const v=ee.useCallback(()=>{NIe(t,f,h,s,a,LIe,u,n.map,o,b)},[t,n.map]);ee.useEffect(()=>{!n.map||!i.current||(typeof t.transitionTime<"u"&&t.type==="line"&&a.current&&(s.current=!1,u.current=!1,h.current=[],f.current=[],v()),t.geojson&&(a.current=t.geojson))},[n.map,v,t]);const S=ee.useCallback(()=>{t.type==="line"&&typeof t.transitionTime<"u"&&t.transitionTime&&typeof t.geojson<"u"&&JSON.stringify(a.current)!==JSON.stringify(t.geojson)&&(v(),a.current=t.geojson)},[t,v]);return ee.useEffect(()=>{!n.mapIsReady||!t.geojson||(i.current=!0,S())},[n.mapIsReady,S,t]),Z.jsx(Z.Fragment,{children:Z.jsx(Ac,{...r,geojson:d})})};try{NV.displayName="MlTransitionGeoJsonLayer",NV.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.',displayName:"MlTransitionGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"circle"'},{value:'"line"'},{value:'"background"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: "none" | "visible" | undefined; } | { "fill-sort-key"?: DataDrivenPropertyValueSpecification<...> | undefined; visibility?: "none" | ... 1 more ... | undefined; } | ... 8 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ......'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},transitionTime:{defaultValue:null,description:"",name:"transitionTime",required:!1,type:{name:"number | undefined"}}}}}catch{}const DIe=(t="top")=>{switch(t){case"bottom":return"translate(-50%, 0%)";case"left":return"translate(-100%, -50%)";case"right":return"translate(0%, -50%)";case"top-left":return"translate(-100%, -100%)";case"top-right":return"translate(0%, -100%)";case"bottom-left":return"translate(-100%, 0%)";case"bottom-right":return"translate(0%, 0%)";default:case"top":return"translate(-50%, -100%)"}};function FIe(t,e,r){const n=parseInt(String(r?.width||14),10),i=parseInt(String(r?.height||14),10),a={};switch(t){case"bottom":a.marginTop=`${e}px`;break;case"left":a.marginLeft=`-${e}px`;break;case"right":a.marginLeft=`${n+e}px`;break;case"top-left":a.marginTop=`-${i+e}px`,a.marginLeft=`-${e}px`;break;case"top-right":a.marginTop=`-${i+e}px`,a.marginLeft=`${n+e}px`;break;case"bottom-left":a.marginTop=`${e}px`,a.marginLeft=`-${e}px`;break;case"bottom-right":a.marginTop=`${e}px`,a.marginLeft=`${n+e}px`;break;case"top":default:a.marginTop=`-${i+e}px`;break}return a}const oM=({passEventsThrough:t=!0,contentOffset:e=5,...r})=>{const n=pa({mapId:r.mapId,waitForLayer:r.insertBeforeLayer}),[i,a]=ee.useState(null),s=ee.useRef(null),o=ee.useRef(null);ee.useEffect(()=>{if(!n.map)return;s.current=document.createElement("div");const f={...{width:"12px",height:"12px",background:"linear-gradient(135deg, rgb(186, 208, 218) 0%, rgb(96, 209, 253) 100%)",border:"1px solid rgba(255, 255, 255, 0.7)",boxShadow:"0 2px 6px rgba(90, 0, 0, 0.2), 0 0 0 2px rgba(240, 147, 251, 0.2)",borderRadius:"50%"},...r.markerStyle},d=new pP.Marker({element:s.current,anchor:"center"}).setLngLat([r.lng,r.lat]).addTo(n.map.map);a(d);const b=document.createElement("div");return Object.entries(f).forEach(([v,S])=>{b.style.setProperty(v.replace(/([A-Z])/g,"-$1").toLowerCase(),String(S))}),s.current.appendChild(b),()=>{b.remove(),d.remove(),s.current?.remove()}},[n.map,r.lng,r.lat,r.markerStyle,r.anchor]),ee.useEffect(()=>{i&&i.setLngLat([r.lng,r.lat])},[i,r.lng,r.lat]);function u(){const h=o.current?.contentWindow?.document;if(h&&o.current?.parentElement){const f=h.documentElement.scrollHeight;o.current.parentElement.style.height=`${f}px`}}return s.current&&Fd.createPortal(Z.jsx(Ho,{sx:{position:"absolute",display:"flex",width:"300px",maxHeight:"500px",opacity:t?1:.7,zIndex:-1,transform:DIe(r.anchor),...FIe(r.anchor,e,r.markerStyle),pointerEvents:t?"none":"auto","&:hover":{opacity:1},...r.containerStyle},children:Z.jsx("iframe",{ref:o,onLoad:u,style:{width:"100%",borderStyle:"none",...r.iframeStyle},srcDoc:`<div>
	<style>
		body {
			${Object.entries(r.iframeBodyStyle||{}).map(([h,f])=>`${h.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${f};`).join(" ")}
		}
	</style>
	${r.content||""}
</div>`,sandbox:"allow-same-origin allow-popups-to-escape-sandbox allow-scripts",title:n.componentId})}),s.current)};try{oM.displayName="MlMarker",oM.__docgenInfo={description:"",displayName:"MlMarker",props:{mapId:{defaultValue:null,description:"ID of the map to add the marker to",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"Layer ID before which to insert the marker",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},lng:{defaultValue:null,description:"Longitude of the marker position",name:"lng",required:!0,type:{name:"number"}},lat:{defaultValue:null,description:"Latitude of the marker position",name:"lat",required:!0,type:{name:"number"}},content:{defaultValue:null,description:"HTML content for the marker popup",name:"content",required:!1,type:{name:"string | undefined"}},markerStyle:{defaultValue:null,description:"CSS properties to apply to the marker dot",name:"markerStyle",required:!1,type:{name:"CSSProperties | undefined"}},containerStyle:{defaultValue:null,description:"CSS properties to apply to the content container",name:"containerStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeStyle:{defaultValue:null,description:"CSS properties to apply to the iframe element",name:"iframeStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeBodyStyle:{defaultValue:null,description:"CSS properties to apply to the body of the iframe",name:"iframeBodyStyle",required:!1,type:{name:"CSSProperties | undefined"}},contentOffset:{defaultValue:{value:"5"},description:"Offset in pixels between the marker and its content",name:"contentOffset",required:!1,type:{name:"number | undefined"}},passEventsThrough:{defaultValue:{value:"true"},description:"Whether mouse events pass through the marker content",name:"passEventsThrough",required:!1,type:{name:"boolean | undefined"}},anchor:{defaultValue:null,description:"Anchor position of the marker relative to its coordinates",name:"anchor",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}}}}}catch{}var ya={},Zl={},LV;function $0(){if(LV)return Zl;LV=1;function t(k,L,N){if(N===void 0&&(N=Array.prototype),k&&typeof N.find=="function")return N.find.call(k,L);for(var M=0;M<k.length;M++)if(r(k,M)){var z=k[M];if(L.call(void 0,z,M,k))return z}}function e(k,L){return L===void 0&&(L=Object),L&&typeof L.getOwnPropertyDescriptors=="function"&&(k=L.create(null,L.getOwnPropertyDescriptors(k))),L&&typeof L.freeze=="function"?L.freeze(k):k}function r(k,L){return Object.prototype.hasOwnProperty.call(k,L)}function n(k,L){if(k===null||typeof k!="object")throw new TypeError("target is not an object");for(var N in L)r(L,N)&&(k[N]=L[N]);return k}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function a(k){return r(i,k.toLowerCase())}var s=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o(k){return r(s,k.toLowerCase())}var u=e({script:!1,style:!1,textarea:!0,title:!0});function h(k){var L=k.toLowerCase();return r(u,L)&&!u[L]}function f(k){var L=k.toLowerCase();return r(u,L)&&u[L]}function d(k){return k===v.HTML}function b(k){return d(k)||k===v.XML_XHTML_APPLICATION}var v=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),S=Object.keys(v).map(function(k){return v[k]});function E(k){return S.indexOf(k)>-1}var P=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Zl.assign=n,Zl.find=t,Zl.freeze=e,Zl.HTML_BOOLEAN_ATTRIBUTES=i,Zl.HTML_RAW_TEXT_ELEMENTS=u,Zl.HTML_VOID_ELEMENTS=s,Zl.hasDefaultHTMLNamespace=b,Zl.hasOwn=r,Zl.isHTMLBooleanAttribute=a,Zl.isHTMLRawTextElement=h,Zl.isHTMLEscapableRawTextElement=f,Zl.isHTMLMimeType=d,Zl.isHTMLVoidElement=o,Zl.isValidMimeType=E,Zl.MIME_TYPE=v,Zl.NAMESPACE=P,Zl}var By={},DV;function BT(){if(DV)return By;DV=1;var t=$0();function e(b,v){b.prototype=Object.create(Error.prototype,{constructor:{value:b},name:{value:b.name,enumerable:!0,writable:v}})}var r=t.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),n=Object.keys(r);function i(b){return typeof b=="number"&&b>=1&&b<=25}function a(b){return typeof b=="string"&&b.substring(b.length-r.Error.length)===r.Error}function s(b,v){i(b)?(this.name=n[b],this.message=v||""):(this.message=b,this.name=a(v)?v:r.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}e(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var b=n.indexOf(this.name);return i(b)?b:0}}});for(var o={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},u=Object.entries(o),h=0;h<u.length;h++){var f=u[h][0];s[f]=u[h][1]}function d(b,v){this.message=b,this.locator=v,Error.captureStackTrace&&Error.captureStackTrace(this,d)}return e(d),By.DOMException=s,By.DOMExceptionName=r,By.ExceptionCode=o,By.ParseError=d,By}var ks={},ea={},FV;function wJ(){if(FV)return ea;FV=1;function t(Xt){try{typeof Xt!="function"&&(Xt=RegExp);var Ct=new Xt("𝌆","u").exec("𝌆");return!!Ct&&Ct[0].length===2}catch{}return!1}var e=t();function r(Xt){if(Xt.source[0]!=="[")throw new Error(Xt+" can not be used with chars");return Xt.source.slice(1,Xt.source.lastIndexOf("]"))}function n(Xt,Ct){if(Xt.source[0]!=="[")throw new Error("/"+Xt.source+"/ can not be used with chars_without");if(!Ct||typeof Ct!="string")throw new Error(JSON.stringify(Ct)+" is not a valid search");if(Xt.source.indexOf(Ct)===-1)throw new Error('"'+Ct+'" is not is /'+Xt.source+"/");if(Ct==="-"&&Xt.source.indexOf(Ct)!==1)throw new Error('"'+Ct+'" is not at the first postion of /'+Xt.source+"/");return new RegExp(Xt.source.replace(Ct,""),e?"u":"")}function i(Xt){var Ct=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(Lr){var qt=typeof Lr=="string";if(qt&&Ct===void 0&&Lr==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return qt?Lr:Lr.source}).join(""),e?"mu":"m")}function a(Xt){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var s="�",o=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(o=i("[",r(o),"\\u{10000}-\\u{10FFFF}","]"));var u=/[\x20\x09\x0D\x0A]/,h=r(u),f=i(u,"+"),d=i(u,"*"),b=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(b=i("[",r(b),"\\u{10000}-\\u{10FFFF}","]"));var v=r(b),S=i("[",v,r(/[-.0-9\xB7]/),r(/[\u0300-\u036F\u203F-\u2040]/),"]"),E=i(b,S,"*"),P=i(S,"+"),k=i("&",E,";"),L=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),N=a(k,"|",L),M=i("%",E,";"),z=a(i('"',a(/[^%&"]/,"|",M,"|",N),"*",'"'),"|",i("'",a(/[^%&']/,"|",M,"|",N),"*","'")),B=a('"',a(/[^<&"]/,"|",N),"*",'"',"|","'",a(/[^<&']/,"|",N),"*","'"),q=n(b,":"),W=n(S,":"),G=i(q,W,"*"),ie=i(G,a(":",G),"?"),J=i("^",ie,"$"),H=i("(",ie,")"),ne=a(/"[^"]*"|'[^']*'/),ae=i(/^<\?/,"(",E,")",a(f,"(",o,"*?)"),"?",/\?>/),ue=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,de=a('"',ue,'*"',"|","'",n(ue,"'"),"*'"),Pe="<!--",me="-->",Ee=i(Pe,a(n(o,"-"),"|",i("-",n(o,"-"))),"*",me),we="#PCDATA",Ae=a(i(/\(/,d,we,a(d,/\|/,d,ie),"*",d,/\)\*/),"|",i(/\(/,d,we,d,/\)/)),ce=/[?*+]?/,xe=i(/\([^>]+\)/,ce),_e=a("EMPTY","|","ANY","|",Ae,"|",xe),Me="<!ELEMENT",Re=i(Me,f,a(ie,"|",M),f,a(_e,"|",M),d,">"),He=i("NOTATION",f,/\(/,d,E,a(d,/\|/,d,E),"*",d,/\)/),Fe=i(/\(/,d,P,a(d,/\|/,d,P),"*",d,/\)/),tt=a(He,"|",Fe),Ze=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",tt),Qe=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",f),"?",B)),Ie=a(f,E,f,Ze,f,Qe),Lt="<!ATTLIST",at=i(Lt,f,E,Ie,"*",d,">"),Ve="about:legacy-compat",nr=a('"'+Ve+'"',"|","'"+Ve+"'"),Yt="SYSTEM",yr="PUBLIC",mt=a(a(Yt,f,ne),"|",a(yr,f,de,f,ne)),br=i("^",a(a(Yt,f,"(?<SystemLiteralOnly>",ne,")"),"|",a(yr,f,"(?<PubidLiteral>",de,")",f,"(?<SystemLiteral>",ne,")"))),Tr=a(f,"NDATA",f,E),mr=a(z,"|",a(mt,Tr,"?")),Mr="<!ENTITY",Pr=i(Mr,f,E,f,mr,d,">"),ar=a(z,"|",mt),fr=i(Mr,f,"%",f,E,f,ar,d,">"),Nr=a(Pr,"|",fr),or=i(yr,f,de),Dr=i("<!NOTATION",f,E,f,a(mt,"|",or),d,">"),er=i(d,"=",d),Gt=/1[.]\d+/,Tt=i(f,"version",er,a("'",Gt,"'","|",'"',Gt,'"')),Oe=/[A-Za-z][-A-Za-z0-9._]*/,Be=a(f,"encoding",er,a('"',Oe,'"',"|","'",Oe,"'")),Ne=a(f,"standalone",er,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),rt=i(/^<\?xml/,Tt,Be,"?",Ne,"?",d,/\?>/),pt="<!DOCTYPE",Rt="<![CDATA[",Bt="]]>",At=/<!\[CDATA\[/,Zt=/\]\]>/,jt=i(o,"*?",Zt),St=i(At,jt);return ea.chars=r,ea.chars_without=n,ea.detectUnicodeSupport=t,ea.reg=i,ea.regg=a,ea.ABOUT_LEGACY_COMPAT=Ve,ea.ABOUT_LEGACY_COMPAT_SystemLiteral=nr,ea.AttlistDecl=at,ea.CDATA_START=Rt,ea.CDATA_END=Bt,ea.CDSect=St,ea.Char=o,ea.Comment=Ee,ea.COMMENT_START=Pe,ea.COMMENT_END=me,ea.DOCTYPE_DECL_START=pt,ea.elementdecl=Re,ea.EntityDecl=Nr,ea.EntityValue=z,ea.ExternalID=mt,ea.ExternalID_match=br,ea.Name=E,ea.NotationDecl=Dr,ea.Reference=N,ea.PEReference=M,ea.PI=ae,ea.PUBLIC=yr,ea.PubidLiteral=de,ea.QName=ie,ea.QName_exact=J,ea.QName_group=H,ea.S=f,ea.SChar_s=h,ea.S_OPT=d,ea.SYSTEM=Yt,ea.SystemLiteral=ne,ea.UNICODE_REPLACEMENT_CHARACTER=s,ea.UNICODE_SUPPORT=e,ea.XMLDecl=rt,ea}var BV;function SJ(){if(BV)return ks;BV=1;var t=$0(),e=t.find,r=t.hasDefaultHTMLNamespace,n=t.hasOwn,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.isHTMLVoidElement,o=t.MIME_TYPE,u=t.NAMESPACE,h=Symbol(),f=BT(),d=f.DOMException,b=f.DOMExceptionName,v=wJ();function S(Ce){if(Ce!==h)throw new TypeError("Illegal constructor")}function E(Ce){return Ce!==""}function P(Ce){return Ce?Ce.split(/[\t\n\f\r ]+/).filter(E):[]}function k(Ce,Ue){return n(Ce,Ue)||(Ce[Ue]=!0),Ce}function L(Ce){if(!Ce)return[];var Ue=P(Ce);return Object.keys(Ue.reduce(k,{}))}function N(Ce){return function(Ue){return Ce&&Ce.indexOf(Ue)!==-1}}function M(Ce){if(!v.QName_exact.test(Ce))throw new d(d.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+Ce+'"')}function z(Ce,Ue){M(Ue),Ce=Ce||null;var ft=null,Mt=Ue;if(Ue.indexOf(":")>=0){var xr=Ue.split(":");ft=xr[0],Mt=xr[1]}if(ft!==null&&Ce===null)throw new d(d.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(ft==="xml"&&Ce!==t.NAMESPACE.XML)throw new d(d.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((ft==="xmlns"||Ue==="xmlns")&&Ce!==t.NAMESPACE.XMLNS)throw new d(d.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(Ce===t.NAMESPACE.XMLNS&&ft!=="xmlns"&&Ue!=="xmlns")throw new d(d.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[Ce,ft,Mt]}function B(Ce,Ue){for(var ft in Ce)n(Ce,ft)&&(Ue[ft]=Ce[ft])}function q(Ce,Ue){var ft=Ce.prototype;if(!(ft instanceof Ue)){let Mt=function(){};Mt.prototype=Ue.prototype,Mt=new Mt,B(ft,Mt),Ce.prototype=ft=Mt}ft.constructor!=Ce&&(typeof Ce!="function"&&console.error("unknown Class:"+Ce),ft.constructor=Ce)}var W={},G=W.ELEMENT_NODE=1,ie=W.ATTRIBUTE_NODE=2,J=W.TEXT_NODE=3,H=W.CDATA_SECTION_NODE=4,ne=W.ENTITY_REFERENCE_NODE=5,ae=W.ENTITY_NODE=6,ue=W.PROCESSING_INSTRUCTION_NODE=7,de=W.COMMENT_NODE=8,Pe=W.DOCUMENT_NODE=9,me=W.DOCUMENT_TYPE_NODE=10,Ee=W.DOCUMENT_FRAGMENT_NODE=11,we=W.NOTATION_NODE=12,Ae=t.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function ce(Ce,Ue){if(Ue.length<Ce.length)return ce(Ue,Ce);var ft=null;for(var Mt in Ce){if(Ce[Mt]!==Ue[Mt])return ft;ft=Ce[Mt]}return ft}function xe(Ce){return Ce.guid||(Ce.guid=Math.random()),Ce.guid}function _e(){}_e.prototype={length:0,item:function(Ce){return Ce>=0&&Ce<this.length?this[Ce]:null},toString:function(Ce){for(var Ue=[],ft=0;ft<this.length;ft++)qt(this[ft],Ue,Ce);return Ue.join("")},filter:function(Ce){return Array.prototype.filter.call(this,Ce)},indexOf:function(Ce){return Array.prototype.indexOf.call(this,Ce)}},_e.prototype[Symbol.iterator]=function(){var Ce=this,Ue=0;return{next:function(){return Ue<Ce.length?{value:Ce[Ue++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Me(Ce,Ue){this._node=Ce,this._refresh=Ue,Re(this)}function Re(Ce){var Ue=Ce._node._inc||Ce._node.ownerDocument._inc;if(Ce._inc!==Ue){var ft=Ce._refresh(Ce._node);if(vn(Ce,"length",ft.length),!Ce.$$length||ft.length<Ce.$$length)for(var Mt=ft.length;Mt in Ce;Mt++)n(Ce,Mt)&&delete Ce[Mt];B(ft,Ce),Ce._inc=Ue}}Me.prototype.item=function(Ce){return Re(this),this[Ce]||null},q(Me,_e);function He(){}function Fe(Ce,Ue){for(var ft=0;ft<Ce.length;){if(Ce[ft]===Ue)return ft;ft++}}function tt(Ce,Ue,ft,Mt){if(Mt?Ue[Fe(Ue,Mt)]=ft:(Ue[Ue.length]=ft,Ue.length++),Ce){ft.ownerElement=Ce;var xr=Ce.ownerDocument;xr&&(Mt&&Yt(xr,Ce,Mt),nr(xr,Ce,ft))}}function Ze(Ce,Ue,ft){var Mt=Fe(Ue,ft);if(Mt>=0){for(var xr=Ue.length-1;Mt<=xr;)Ue[Mt]=Ue[++Mt];if(Ue.length=xr,Ce){var Kr=Ce.ownerDocument;Kr&&Yt(Kr,Ce,ft),ft.ownerElement=null}}}He.prototype={length:0,item:_e.prototype.item,getNamedItem:function(Ce){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(Ce=Ce.toLowerCase());for(var Ue=0;Ue<this.length;){var ft=this[Ue];if(ft.nodeName===Ce)return ft;Ue++}return null},setNamedItem:function(Ce){var Ue=Ce.ownerElement;if(Ue&&Ue!==this._ownerElement)throw new d(d.INUSE_ATTRIBUTE_ERR);var ft=this.getNamedItemNS(Ce.namespaceURI,Ce.localName);return ft===Ce?Ce:(tt(this._ownerElement,this,Ce,ft),ft)},setNamedItemNS:function(Ce){return this.setNamedItem(Ce)},removeNamedItem:function(Ce){var Ue=this.getNamedItem(Ce);if(!Ue)throw new d(d.NOT_FOUND_ERR,Ce);return Ze(this._ownerElement,this,Ue),Ue},removeNamedItemNS:function(Ce,Ue){var ft=this.getNamedItemNS(Ce,Ue);if(!ft)throw new d(d.NOT_FOUND_ERR,Ce?Ce+" : "+Ue:Ue);return Ze(this._ownerElement,this,ft),ft},getNamedItemNS:function(Ce,Ue){Ce||(Ce=null);for(var ft=0;ft<this.length;){var Mt=this[ft];if(Mt.localName===Ue&&Mt.namespaceURI===Ce)return Mt;ft++}return null}},He.prototype[Symbol.iterator]=function(){var Ce=this,Ue=0;return{next:function(){return Ue<Ce.length?{value:Ce[Ue++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Qe(){}Qe.prototype={hasFeature:function(Ce,Ue){return!0},createDocument:function(Ce,Ue,ft){var Mt=o.XML_APPLICATION;Ce===u.HTML?Mt=o.XML_XHTML_APPLICATION:Ce===u.SVG&&(Mt=o.XML_SVG_IMAGE);var xr=new Ve(h,{contentType:Mt});if(xr.implementation=this,xr.childNodes=new _e,xr.doctype=ft||null,ft&&xr.appendChild(ft),Ue){var Kr=xr.createElementNS(Ce,Ue);xr.appendChild(Kr)}return xr},createDocumentType:function(Ce,Ue,ft,Mt){M(Ce);var xr=new pt(h);return xr.name=Ce,xr.nodeName=Ce,xr.publicId=Ue||"",xr.systemId=ft||"",xr.internalSubset=Mt||"",xr.childNodes=new _e,xr},createHTMLDocument:function(Ce){var Ue=new Ve(h,{contentType:o.HTML});if(Ue.implementation=this,Ue.childNodes=new _e,Ce!==!1){Ue.doctype=this.createDocumentType("html"),Ue.doctype.ownerDocument=Ue,Ue.appendChild(Ue.doctype);var ft=Ue.createElement("html");Ue.appendChild(ft);var Mt=Ue.createElement("head");if(ft.appendChild(Mt),typeof Ce=="string"){var xr=Ue.createElement("title");xr.appendChild(Ue.createTextNode(Ce)),Mt.appendChild(xr)}ft.appendChild(Ue.createElement("body"))}return Ue}};function Ie(Ce){S(Ce)}Ie.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var Ce=this.getRootNode();return Ce&&Ce.nodeType===Ce.DOCUMENT_NODE},contains:function(Ce){if(!Ce)return!1;var Ue=Ce;do{if(this===Ue)return!0;Ue=Ce.parentNode}while(Ue);return!1},getRootNode:function(Ce){var Ue=this;do{if(!Ue.parentNode)return Ue;Ue=Ue.parentNode}while(Ue)},isEqualNode:function(Ce){if(!Ce||this.nodeType!==Ce.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==Ce.name||this.publicId!==Ce.publicId||this.systemId!==Ce.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==Ce.namespaceURI||this.prefix!==Ce.prefix||this.localName!==Ce.localName||this.attributes.length!==Ce.attributes.length)return!1;for(var Ue=0;Ue<this.attributes.length;Ue++){var ft=this.attributes.item(Ue);if(!ft.isEqualNode(Ce.getAttributeNodeNS(ft.namespaceURI,ft.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==Ce.namespaceURI||this.localName!==Ce.localName||this.value!==Ce.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==Ce.target||this.data!==Ce.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==Ce.data)return!1;break}if(this.childNodes.length!==Ce.childNodes.length)return!1;for(var Ue=0;Ue<this.childNodes.length;Ue++)if(!this.childNodes[Ue].isEqualNode(Ce.childNodes[Ue]))return!1;return!0},isSameNode:function(Ce){return this===Ce},insertBefore:function(Ce,Ue){return er(this,Ce,Ue)},replaceChild:function(Ce,Ue){er(this,Ce,Ue,Dr),Ue&&this.removeChild(Ue)},removeChild:function(Ce){return mt(this,Ce)},appendChild:function(Ce){return this.insertBefore(Ce,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(Ce){return jr(this.ownerDocument||this,this,Ce)},normalize:function(){for(var Ce=this.firstChild;Ce;){var Ue=Ce.nextSibling;Ue&&Ue.nodeType==J&&Ce.nodeType==J?(this.removeChild(Ue),Ce.appendData(Ue.data)):(Ce.normalize(),Ce=Ue)}},isSupported:function(Ce,Ue){return this.ownerDocument.implementation.hasFeature(Ce,Ue)},lookupPrefix:function(Ce){for(var Ue=this;Ue;){var ft=Ue._nsMap;if(ft){for(var Mt in ft)if(n(ft,Mt)&&ft[Mt]===Ce)return Mt}Ue=Ue.nodeType==ie?Ue.ownerDocument:Ue.parentNode}return null},lookupNamespaceURI:function(Ce){for(var Ue=this;Ue;){var ft=Ue._nsMap;if(ft&&n(ft,Ce))return ft[Ce];Ue=Ue.nodeType==ie?Ue.ownerDocument:Ue.parentNode}return null},isDefaultNamespace:function(Ce){var Ue=this.lookupPrefix(Ce);return Ue==null},compareDocumentPosition:function(Ce){if(this===Ce)return 0;var Ue=Ce,ft=this,Mt=null,xr=null;if(Ue instanceof Tt&&(Mt=Ue,Ue=Mt.ownerElement),ft instanceof Tt&&(xr=ft,ft=xr.ownerElement,Mt&&Ue&&ft===Ue))for(var Kr=0,Rr;Rr=ft.attributes[Kr];Kr++){if(Rr===Mt)return Ae.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Ae.DOCUMENT_POSITION_PRECEDING;if(Rr===xr)return Ae.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Ae.DOCUMENT_POSITION_FOLLOWING}if(!Ue||!ft||ft.ownerDocument!==Ue.ownerDocument)return Ae.DOCUMENT_POSITION_DISCONNECTED+Ae.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(xe(ft.ownerDocument)>xe(Ue.ownerDocument)?Ae.DOCUMENT_POSITION_FOLLOWING:Ae.DOCUMENT_POSITION_PRECEDING);if(xr&&Ue===ft)return Ae.DOCUMENT_POSITION_CONTAINS+Ae.DOCUMENT_POSITION_PRECEDING;if(Mt&&Ue===ft)return Ae.DOCUMENT_POSITION_CONTAINED_BY+Ae.DOCUMENT_POSITION_FOLLOWING;for(var di=[],ti=Ue.parentNode;ti;){if(!xr&&ti===ft)return Ae.DOCUMENT_POSITION_CONTAINED_BY+Ae.DOCUMENT_POSITION_FOLLOWING;di.push(ti),ti=ti.parentNode}di.reverse();for(var bi=[],Ui=ft.parentNode;Ui;){if(!Mt&&Ui===Ue)return Ae.DOCUMENT_POSITION_CONTAINS+Ae.DOCUMENT_POSITION_PRECEDING;bi.push(Ui),Ui=Ui.parentNode}bi.reverse();var Xr=ce(di,bi);for(var _n in Xr.childNodes){var Fn=Xr.childNodes[_n];if(Fn===ft)return Ae.DOCUMENT_POSITION_FOLLOWING;if(Fn===Ue)return Ae.DOCUMENT_POSITION_PRECEDING;if(bi.indexOf(Fn)>=0)return Ae.DOCUMENT_POSITION_FOLLOWING;if(di.indexOf(Fn)>=0)return Ae.DOCUMENT_POSITION_PRECEDING}return 0}};function Lt(Ce){return Ce=="<"&&"&lt;"||Ce==">"&&"&gt;"||Ce=="&"&&"&amp;"||Ce=='"'&&"&quot;"||"&#"+Ce.charCodeAt()+";"}B(W,Ie),B(W,Ie.prototype),B(Ae,Ie),B(Ae,Ie.prototype);function at(Ce,Ue){if(Ue(Ce))return!0;if(Ce=Ce.firstChild)do if(at(Ce,Ue))return!0;while(Ce=Ce.nextSibling)}function Ve(Ce,Ue){S(Ce);var ft=Ue||{};this.ownerDocument=this,this.contentType=ft.contentType||o.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function nr(Ce,Ue,ft){Ce&&Ce._inc++;var Mt=ft.namespaceURI;Mt===u.XMLNS&&(Ue._nsMap[ft.prefix?ft.localName:""]=ft.value)}function Yt(Ce,Ue,ft,Mt){Ce&&Ce._inc++;var xr=ft.namespaceURI;xr===u.XMLNS&&delete Ue._nsMap[ft.prefix?ft.localName:""]}function yr(Ce,Ue,ft){if(Ce&&Ce._inc){Ce._inc++;var Mt=Ue.childNodes;if(ft&&!ft.nextSibling)Mt[Mt.length++]=ft;else{for(var xr=Ue.firstChild,Kr=0;xr;)Mt[Kr++]=xr,xr=xr.nextSibling;Mt.length=Kr,delete Mt[Mt.length]}}}function mt(Ce,Ue){if(Ce!==Ue.parentNode)throw new d(d.NOT_FOUND_ERR,"child's parent is not parent");var ft=Ue.previousSibling,Mt=Ue.nextSibling;return ft?ft.nextSibling=Mt:Ce.firstChild=Mt,Mt?Mt.previousSibling=ft:Ce.lastChild=ft,yr(Ce.ownerDocument,Ce),Ue.parentNode=null,Ue.previousSibling=null,Ue.nextSibling=null,Ue}function br(Ce){return Ce&&(Ce.nodeType===Ie.DOCUMENT_NODE||Ce.nodeType===Ie.DOCUMENT_FRAGMENT_NODE||Ce.nodeType===Ie.ELEMENT_NODE)}function Tr(Ce){return Ce&&(Ce.nodeType===Ie.CDATA_SECTION_NODE||Ce.nodeType===Ie.COMMENT_NODE||Ce.nodeType===Ie.DOCUMENT_FRAGMENT_NODE||Ce.nodeType===Ie.DOCUMENT_TYPE_NODE||Ce.nodeType===Ie.ELEMENT_NODE||Ce.nodeType===Ie.PROCESSING_INSTRUCTION_NODE||Ce.nodeType===Ie.TEXT_NODE)}function mr(Ce){return Ce&&Ce.nodeType===Ie.DOCUMENT_TYPE_NODE}function Mr(Ce){return Ce&&Ce.nodeType===Ie.ELEMENT_NODE}function Pr(Ce){return Ce&&Ce.nodeType===Ie.TEXT_NODE}function ar(Ce,Ue){var ft=Ce.childNodes||[];if(e(ft,Mr)||mr(Ue))return!1;var Mt=e(ft,mr);return!(Ue&&Mt&&ft.indexOf(Mt)>ft.indexOf(Ue))}function fr(Ce,Ue){var ft=Ce.childNodes||[];function Mt(Kr){return Mr(Kr)&&Kr!==Ue}if(e(ft,Mt))return!1;var xr=e(ft,mr);return!(Ue&&xr&&ft.indexOf(xr)>ft.indexOf(Ue))}function Nr(Ce,Ue,ft){if(!br(Ce))throw new d(d.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+Ce.nodeType);if(ft&&ft.parentNode!==Ce)throw new d(d.NOT_FOUND_ERR,"child not in parent");if(!Tr(Ue)||mr(Ue)&&Ce.nodeType!==Ie.DOCUMENT_NODE)throw new d(d.HIERARCHY_REQUEST_ERR,"Unexpected node type "+Ue.nodeType+" for parent node type "+Ce.nodeType)}function or(Ce,Ue,ft){var Mt=Ce.childNodes||[],xr=Ue.childNodes||[];if(Ue.nodeType===Ie.DOCUMENT_FRAGMENT_NODE){var Kr=xr.filter(Mr);if(Kr.length>1||e(xr,Pr))throw new d(d.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Kr.length===1&&!ar(Ce,ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Mr(Ue)&&!ar(Ce,ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(mr(Ue)){if(e(Mt,mr))throw new d(d.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Rr=e(Mt,Mr);if(ft&&Mt.indexOf(Rr)<Mt.indexOf(ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!ft&&Rr)throw new d(d.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function Dr(Ce,Ue,ft){var Mt=Ce.childNodes||[],xr=Ue.childNodes||[];if(Ue.nodeType===Ie.DOCUMENT_FRAGMENT_NODE){var Kr=xr.filter(Mr);if(Kr.length>1||e(xr,Pr))throw new d(d.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Kr.length===1&&!fr(Ce,ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Mr(Ue)&&!fr(Ce,ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(mr(Ue)){if(e(Mt,function(ti){return mr(ti)&&ti!==ft}))throw new d(d.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Rr=e(Mt,Mr);if(ft&&Mt.indexOf(Rr)<Mt.indexOf(ft))throw new d(d.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function er(Ce,Ue,ft,Mt){Nr(Ce,Ue,ft),Ce.nodeType===Ie.DOCUMENT_NODE&&(Mt||or)(Ce,Ue,ft);var xr=Ue.parentNode;if(xr&&xr.removeChild(Ue),Ue.nodeType===Ee){var Kr=Ue.firstChild;if(Kr==null)return Ue;var Rr=Ue.lastChild}else Kr=Rr=Ue;var di=ft?ft.previousSibling:Ce.lastChild;Kr.previousSibling=di,Rr.nextSibling=ft,di?di.nextSibling=Kr:Ce.firstChild=Kr,ft==null?Ce.lastChild=Rr:ft.previousSibling=Rr;do Kr.parentNode=Ce;while(Kr!==Rr&&(Kr=Kr.nextSibling));return yr(Ce.ownerDocument||Ce,Ce,Ue),Ue.nodeType==Ee&&(Ue.firstChild=Ue.lastChild=null),Ue}Ve.prototype={implementation:null,nodeName:"#document",nodeType:Pe,doctype:null,documentElement:null,_inc:1,insertBefore:function(Ce,Ue){if(Ce.nodeType===Ee){for(var ft=Ce.firstChild;ft;){var Mt=ft.nextSibling;this.insertBefore(ft,Ue),ft=Mt}return Ce}return er(this,Ce,Ue),Ce.ownerDocument=this,this.documentElement===null&&Ce.nodeType===G&&(this.documentElement=Ce),Ce},removeChild:function(Ce){var Ue=mt(this,Ce);return Ue===this.documentElement&&(this.documentElement=null),Ue},replaceChild:function(Ce,Ue){er(this,Ce,Ue,Dr),Ce.ownerDocument=this,Ue&&this.removeChild(Ue),Mr(Ce)&&(this.documentElement=Ce)},importNode:function(Ce,Ue){return Zr(this,Ce,Ue)},getElementById:function(Ce){var Ue=null;return at(this.documentElement,function(ft){if(ft.nodeType==G&&ft.getAttribute("id")==Ce)return Ue=ft,!0}),Ue},createElement:function(Ce){var Ue=new Gt(h);Ue.ownerDocument=this,this.type==="html"&&(Ce=Ce.toLowerCase()),r(this.contentType)&&(Ue.namespaceURI=u.HTML),Ue.nodeName=Ce,Ue.tagName=Ce,Ue.localName=Ce,Ue.childNodes=new _e;var ft=Ue.attributes=new He;return ft._ownerElement=Ue,Ue},createDocumentFragment:function(){var Ce=new Zt(h);return Ce.ownerDocument=this,Ce.childNodes=new _e,Ce},createTextNode:function(Ce){var Ue=new Be(h);return Ue.ownerDocument=this,Ue.childNodes=new _e,Ue.appendData(Ce),Ue},createComment:function(Ce){var Ue=new Ne(h);return Ue.ownerDocument=this,Ue.childNodes=new _e,Ue.appendData(Ce),Ue},createCDATASection:function(Ce){var Ue=new rt(h);return Ue.ownerDocument=this,Ue.childNodes=new _e,Ue.appendData(Ce),Ue},createProcessingInstruction:function(Ce,Ue){var ft=new jt(h);return ft.ownerDocument=this,ft.childNodes=new _e,ft.nodeName=ft.target=Ce,ft.nodeValue=ft.data=Ue,ft},createAttribute:function(Ce){if(!v.QName_exact.test(Ce))throw new d(d.INVALID_CHARACTER_ERR,'invalid character in name "'+Ce+'"');return this.type==="html"&&(Ce=Ce.toLowerCase()),this._createAttribute(Ce)},_createAttribute:function(Ce){var Ue=new Tt(h);return Ue.ownerDocument=this,Ue.childNodes=new _e,Ue.name=Ce,Ue.nodeName=Ce,Ue.localName=Ce,Ue.specified=!0,Ue},createEntityReference:function(Ce){if(!v.Name.test(Ce))throw new d(d.INVALID_CHARACTER_ERR,'not a valid xml name "'+Ce+'"');if(this.type==="html")throw new d("document is an html document",b.NotSupportedError);var Ue=new At(h);return Ue.ownerDocument=this,Ue.childNodes=new _e,Ue.nodeName=Ce,Ue},createElementNS:function(Ce,Ue){var ft=z(Ce,Ue),Mt=new Gt(h),xr=Mt.attributes=new He;return Mt.childNodes=new _e,Mt.ownerDocument=this,Mt.nodeName=Ue,Mt.tagName=Ue,Mt.namespaceURI=ft[0],Mt.prefix=ft[1],Mt.localName=ft[2],xr._ownerElement=Mt,Mt},createAttributeNS:function(Ce,Ue){var ft=z(Ce,Ue),Mt=new Tt(h);return Mt.ownerDocument=this,Mt.childNodes=new _e,Mt.nodeName=Ue,Mt.name=Ue,Mt.specified=!0,Mt.namespaceURI=ft[0],Mt.prefix=ft[1],Mt.localName=ft[2],Mt}},q(Ve,Ie);function Gt(Ce){S(Ce),this._nsMap=Object.create(null)}Gt.prototype={nodeType:G,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===u.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(Ce){return!!this.getAttributeNode(Ce)},getAttribute:function(Ce){var Ue=this.getAttributeNode(Ce);return Ue?Ue.value:null},getAttributeNode:function(Ce){return this._isInHTMLDocumentAndNamespace()&&(Ce=Ce.toLowerCase()),this.attributes.getNamedItem(Ce)},setAttribute:function(Ce,Ue){this._isInHTMLDocumentAndNamespace()&&(Ce=Ce.toLowerCase());var ft=this.getAttributeNode(Ce);ft?ft.value=ft.nodeValue=""+Ue:(ft=this.ownerDocument._createAttribute(Ce),ft.value=ft.nodeValue=""+Ue,this.setAttributeNode(ft))},removeAttribute:function(Ce){var Ue=this.getAttributeNode(Ce);Ue&&this.removeAttributeNode(Ue)},setAttributeNode:function(Ce){return this.attributes.setNamedItem(Ce)},setAttributeNodeNS:function(Ce){return this.attributes.setNamedItemNS(Ce)},removeAttributeNode:function(Ce){return this.attributes.removeNamedItem(Ce.nodeName)},removeAttributeNS:function(Ce,Ue){var ft=this.getAttributeNodeNS(Ce,Ue);ft&&this.removeAttributeNode(ft)},hasAttributeNS:function(Ce,Ue){return this.getAttributeNodeNS(Ce,Ue)!=null},getAttributeNS:function(Ce,Ue){var ft=this.getAttributeNodeNS(Ce,Ue);return ft?ft.value:null},setAttributeNS:function(Ce,Ue,ft){var Mt=z(Ce,Ue),xr=Mt[2],Kr=this.getAttributeNodeNS(Ce,xr);Kr?Kr.value=Kr.nodeValue=""+ft:(Kr=this.ownerDocument.createAttributeNS(Ce,Ue),Kr.value=Kr.nodeValue=""+ft,this.setAttributeNode(Kr))},getAttributeNodeNS:function(Ce,Ue){return this.attributes.getNamedItemNS(Ce,Ue)},getElementsByClassName:function(Ce){var Ue=L(Ce);return new Me(this,function(ft){var Mt=[];return Ue.length>0&&at(ft,function(xr){if(xr!==ft&&xr.nodeType===G){var Kr=xr.getAttribute("class");if(Kr){var Rr=Ce===Kr;if(!Rr){var di=L(Kr);Rr=Ue.every(N(di))}Rr&&Mt.push(xr)}}}),Mt})},getElementsByTagName:function(Ce){var Ue=(this.nodeType===Pe?this:this.ownerDocument).type==="html",ft=Ce.toLowerCase();return new Me(this,function(Mt){var xr=[];return at(Mt,function(Kr){if(!(Kr===Mt||Kr.nodeType!==G))if(Ce==="*")xr.push(Kr);else{var Rr=Kr.getQualifiedName(),di=Ue&&Kr.namespaceURI===u.HTML?ft:Ce;Rr===di&&xr.push(Kr)}}),xr})},getElementsByTagNameNS:function(Ce,Ue){return new Me(this,function(ft){var Mt=[];return at(ft,function(xr){xr!==ft&&xr.nodeType===G&&(Ce==="*"||xr.namespaceURI===Ce)&&(Ue==="*"||xr.localName==Ue)&&Mt.push(xr)}),Mt})}},Ve.prototype.getElementsByClassName=Gt.prototype.getElementsByClassName,Ve.prototype.getElementsByTagName=Gt.prototype.getElementsByTagName,Ve.prototype.getElementsByTagNameNS=Gt.prototype.getElementsByTagNameNS,q(Gt,Ie);function Tt(Ce){S(Ce),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}Tt.prototype.nodeType=ie,q(Tt,Ie);function Oe(Ce){S(Ce)}Oe.prototype={data:"",substringData:function(Ce,Ue){return this.data.substring(Ce,Ce+Ue)},appendData:function(Ce){Ce=this.data+Ce,this.nodeValue=this.data=Ce,this.length=Ce.length},insertData:function(Ce,Ue){this.replaceData(Ce,0,Ue)},deleteData:function(Ce,Ue){this.replaceData(Ce,Ue,"")},replaceData:function(Ce,Ue,ft){var Mt=this.data.substring(0,Ce),xr=this.data.substring(Ce+Ue);ft=Mt+ft+xr,this.nodeValue=this.data=ft,this.length=ft.length}},q(Oe,Ie);function Be(Ce){S(Ce)}Be.prototype={nodeName:"#text",nodeType:J,splitText:function(Ce){var Ue=this.data,ft=Ue.substring(Ce);Ue=Ue.substring(0,Ce),this.data=this.nodeValue=Ue,this.length=Ue.length;var Mt=this.ownerDocument.createTextNode(ft);return this.parentNode&&this.parentNode.insertBefore(Mt,this.nextSibling),Mt}},q(Be,Oe);function Ne(Ce){S(Ce)}Ne.prototype={nodeName:"#comment",nodeType:de},q(Ne,Oe);function rt(Ce){S(Ce)}rt.prototype={nodeName:"#cdata-section",nodeType:H},q(rt,Be);function pt(Ce){S(Ce)}pt.prototype.nodeType=me,q(pt,Ie);function Rt(Ce){S(Ce)}Rt.prototype.nodeType=we,q(Rt,Ie);function Bt(Ce){S(Ce)}Bt.prototype.nodeType=ae,q(Bt,Ie);function At(Ce){S(Ce)}At.prototype.nodeType=ne,q(At,Ie);function Zt(Ce){S(Ce)}Zt.prototype.nodeName="#document-fragment",Zt.prototype.nodeType=Ee,q(Zt,Ie);function jt(Ce){S(Ce)}jt.prototype.nodeType=ue,q(jt,Oe);function St(){}St.prototype.serializeToString=function(Ce,Ue){return Xt.call(Ce,Ue)},Ie.prototype.toString=Xt;function Xt(Ce){var Ue=[],ft=this.nodeType===Pe&&this.documentElement||this,Mt=ft.prefix,xr=ft.namespaceURI;if(xr&&Mt==null){var Mt=ft.lookupPrefix(xr);if(Mt==null)var Kr=[{namespace:xr,prefix:null}]}return qt(this,Ue,Ce,Kr),Ue.join("")}function Ct(Ce,Ue,ft){var Mt=Ce.prefix||"",xr=Ce.namespaceURI;if(!xr||Mt==="xml"&&xr===u.XML||xr===u.XMLNS)return!1;for(var Kr=ft.length;Kr--;){var Rr=ft[Kr];if(Rr.prefix===Mt)return Rr.namespace!==xr}return!0}function Lr(Ce,Ue,ft){Ce.push(" ",Ue,'="',ft.replace(/[<>&"\t\n\r]/g,Lt),'"')}function qt(Ce,Ue,ft,Mt){Mt||(Mt=[]);var xr=Ce.nodeType===Pe?Ce:Ce.ownerDocument,Kr=xr.type==="html";if(ft)if(Ce=ft(Ce),Ce){if(typeof Ce=="string"){Ue.push(Ce);return}}else return;switch(Ce.nodeType){case G:var Rr=Ce.attributes,di=Rr.length,_a=Ce.firstChild,ti=Ce.tagName,bi=ti;if(!Kr&&!Ce.prefix&&Ce.namespaceURI){for(var Ui,Xr=0;Xr<Rr.length;Xr++)if(Rr.item(Xr).name==="xmlns"){Ui=Rr.item(Xr).value;break}if(!Ui)for(var _n=Mt.length-1;_n>=0;_n--){var Fn=Mt[_n];if(Fn.prefix===""&&Fn.namespace===Ce.namespaceURI){Ui=Fn.namespace;break}}if(Ui!==Ce.namespaceURI)for(var _n=Mt.length-1;_n>=0;_n--){var Fn=Mt[_n];if(Fn.namespace===Ce.namespaceURI){Fn.prefix&&(bi=Fn.prefix+":"+ti);break}}}Ue.push("<",bi);for(var na=0;na<di;na++){var Ca=Rr.item(na);Ca.prefix=="xmlns"?Mt.push({prefix:Ca.localName,namespace:Ca.value}):Ca.nodeName=="xmlns"&&Mt.push({prefix:"",namespace:Ca.value})}for(var na=0;na<di;na++){var Ca=Rr.item(na);if(Ct(Ca,Kr,Mt)){var ua=Ca.prefix||"",Mn=Ca.namespaceURI;Lr(Ue,ua?"xmlns:"+ua:"xmlns",Mn),Mt.push({prefix:ua,namespace:Mn})}qt(Ca,Ue,ft,Mt)}if(ti===bi&&Ct(Ce,Kr,Mt)){var ua=Ce.prefix||"",Mn=Ce.namespaceURI;Lr(Ue,ua?"xmlns:"+ua:"xmlns",Mn),Mt.push({prefix:ua,namespace:Mn})}var oo=!_a;if(oo&&(Kr||Ce.namespaceURI===u.HTML)&&(oo=s(ti)),oo)Ue.push("/>");else{if(Ue.push(">"),Kr&&a(ti))for(;_a;)_a.data?Ue.push(_a.data):qt(_a,Ue,ft,Mt.slice()),_a=_a.nextSibling;else for(;_a;)qt(_a,Ue,ft,Mt.slice()),_a=_a.nextSibling;Ue.push("</",bi,">")}return;case Pe:case Ee:for(var _a=Ce.firstChild;_a;)qt(_a,Ue,ft,Mt.slice()),_a=_a.nextSibling;return;case ie:return Lr(Ue,Ce.name,Ce.value);case J:return Ue.push(Ce.data.replace(/[<&>]/g,Lt));case H:return Ue.push(v.CDATA_START,Ce.data,v.CDATA_END);case de:return Ue.push(v.COMMENT_START,Ce.data,v.COMMENT_END);case me:var Hi=Ce.publicId,Ya=Ce.systemId;Ue.push(v.DOCTYPE_DECL_START," ",Ce.name),Hi?(Ue.push(" ",v.PUBLIC," ",Hi),Ya&&Ya!=="."&&Ue.push(" ",Ya)):Ya&&Ya!=="."&&Ue.push(" ",v.SYSTEM," ",Ya),Ce.internalSubset&&Ue.push(" [",Ce.internalSubset,"]"),Ue.push(">");return;case ue:return Ue.push("<?",Ce.target," ",Ce.data,"?>");case ne:return Ue.push("&",Ce.nodeName,";");default:Ue.push("??",Ce.nodeName)}}function Zr(Ce,Ue,ft){var Mt;switch(Ue.nodeType){case G:Mt=Ue.cloneNode(!1),Mt.ownerDocument=Ce;case Ee:break;case ie:ft=!0;break}if(Mt||(Mt=Ue.cloneNode(!1)),Mt.ownerDocument=Ce,Mt.parentNode=null,ft)for(var xr=Ue.firstChild;xr;)Mt.appendChild(Zr(Ce,xr,ft)),xr=xr.nextSibling;return Mt}function jr(Ce,Ue,ft){var Mt=new Ue.constructor(h);for(var xr in Ue)if(n(Ue,xr)){var Kr=Ue[xr];typeof Kr!="object"&&Kr!=Mt[xr]&&(Mt[xr]=Kr)}switch(Ue.childNodes&&(Mt.childNodes=new _e),Mt.ownerDocument=Ce,Mt.nodeType){case G:var Rr=Ue.attributes,di=Mt.attributes=new He,ti=Rr.length;di._ownerElement=Mt;for(var bi=0;bi<ti;bi++)Mt.setAttributeNode(jr(Ce,Rr.item(bi),!0));break;case ie:ft=!0}if(ft)for(var Ui=Ue.firstChild;Ui;)Mt.appendChild(jr(Ce,Ui,ft)),Ui=Ui.nextSibling;return Mt}function vn(Ce,Ue,ft){Ce[Ue]=ft}try{if(Object.defineProperty){let Ce=function(Ue){switch(Ue.nodeType){case G:case Ee:var ft=[];for(Ue=Ue.firstChild;Ue;)Ue.nodeType!==7&&Ue.nodeType!==8&&ft.push(Ce(Ue)),Ue=Ue.nextSibling;return ft.join("");default:return Ue.nodeValue}};Object.defineProperty(Me.prototype,"length",{get:function(){return Re(this),this.$$length}}),Object.defineProperty(Ie.prototype,"textContent",{get:function(){return Ce(this)},set:function(Ue){switch(this.nodeType){case G:case Ee:for(;this.firstChild;)this.removeChild(this.firstChild);(Ue||String(Ue))&&this.appendChild(this.ownerDocument.createTextNode(Ue));break;default:this.data=Ue,this.value=Ue,this.nodeValue=Ue}}}),vn=function(Ue,ft,Mt){Ue["$$"+ft]=Mt}}}catch{}return ks._updateLiveList=Re,ks.Attr=Tt,ks.CDATASection=rt,ks.CharacterData=Oe,ks.Comment=Ne,ks.Document=Ve,ks.DocumentFragment=Zt,ks.DocumentType=pt,ks.DOMImplementation=Qe,ks.Element=Gt,ks.Entity=Bt,ks.EntityReference=At,ks.LiveNodeList=Me,ks.NamedNodeMap=He,ks.Node=Ie,ks.NodeList=_e,ks.Notation=Rt,ks.Text=Be,ks.ProcessingInstruction=jt,ks.XMLSerializer=St,ks}var Og={},hI={},zV;function BIe(){return zV||(zV=1,(function(t){var e=$0().freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES})(hI)),hI}var I_={},jV;function zIe(){if(jV)return I_;jV=1;var t=$0(),e=wJ(),r=BT(),n=t.isHTMLEscapableRawTextElement,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.hasOwn,o=t.NAMESPACE,u=r.ParseError,h=r.DOMException,f=0,d=1,b=2,v=3,S=4,E=5,P=6,k=7;function L(){}L.prototype={parse:function(ue,de,Pe){var me=this.domBuilder;me.startDocument(),G(de,de=Object.create(null)),M(ue,de,Pe,me,this.errorHandler),me.endDocument()}};var N=/&#?\w+;?/g;function M(ue,de,Pe,me,Ee){var we=i(me.mimeType);ue.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&Ee.warning("Unicode replacement character detected, source encoding issues?");function Ae(er){if(er>65535){er-=65536;var Gt=55296+(er>>10),Tt=56320+(er&1023);return String.fromCharCode(Gt,Tt)}else return String.fromCharCode(er)}function ce(er){var Gt=er[er.length-1]===";"?er:er+";";if(!we&&Gt!==er)return Ee.error("EntityRef: expecting ;"),er;var Tt=e.Reference.exec(Gt);if(!Tt||Tt[0].length!==Gt.length)return Ee.error("entity not matching Reference production: "+er),er;var Oe=Gt.slice(1,-1);return s(Pe,Oe)?Pe[Oe]:Oe.charAt(0)==="#"?Ae(parseInt(Oe.substring(1).replace("x","0x"))):(Ee.error("entity not found:"+er),er)}function xe(er){if(er>Qe){var Gt=ue.substring(Qe,er).replace(N,ce);He&&Fe(Qe),me.characters(Gt,0,er-Qe),Qe=er}}var _e=0,Me=0,Re=/\r\n?|\n|$/g,He=me.locator;function Fe(er,Gt){for(;er>=Me&&(Gt=Re.exec(ue));)_e=Me,Me=Gt.index+Gt[0].length,He.lineNumber++;He.columnNumber=er-_e+1}for(var tt=[{currentNSMap:de}],Ze=[],Qe=0;;){try{var Ie=ue.indexOf("<",Qe);if(Ie<0){if(!we&&Ze.length>0)return Ee.fatalError("unclosed xml tag(s): "+Ze.join(", "));if(!ue.substring(Qe).match(/^\s*$/)){var Lt=me.doc,at=Lt.createTextNode(ue.substring(Qe));if(Lt.documentElement)return Ee.error("Extra content at the end of the document");Lt.appendChild(at),me.currentElement=at}return}if(Ie>Qe){var Ve=ue.substring(Qe,Ie);!we&&Ze.length===0&&(Ve=Ve.replace(new RegExp(e.S_OPT.source,"g"),""),Ve&&Ee.error("Unexpected content outside root element: '"+Ve+"'")),xe(Ie)}switch(ue.charAt(Ie+1)){case"/":var ar=ue.indexOf(">",Ie+2),nr=ue.substring(Ie+2,ar>0?ar:void 0);if(!nr)return Ee.fatalError("end tag name missing");var Yt=ar>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(nr);if(!Yt)return Ee.fatalError('end tag name contains invalid characters: "'+nr+'"');if(!me.currentElement&&!me.doc.documentElement)return;var yr=Ze[Ze.length-1]||me.currentElement.tagName||me.doc.documentElement.tagName||"";if(yr!==Yt[1]){var mt=Yt[1].toLowerCase();if(!we||yr.toLowerCase()!==mt)return Ee.fatalError('Opening and ending tag mismatch: "'+yr+'" != "'+nr+'"')}var br=tt.pop();Ze.pop();var Tr=br.localNSMap;if(me.endElement(br.uri,br.localName,yr),Tr)for(var mr in Tr)s(Tr,mr)&&me.endPrefixMapping(mr);ar++;break;case"?":He&&Fe(Ie),ar=ne(ue,Ie,me,Ee);break;case"!":He&&Fe(Ie),ar=H(ue,Ie,me,Ee,we);break;default:He&&Fe(Ie);var Mr=new ae,Pr=tt[tt.length-1].currentNSMap,ar=B(ue,Ie,Mr,Pr,ce,Ee,we),fr=Mr.length;if(Mr.closed||(we&&t.isHTMLVoidElement(Mr.tagName)?Mr.closed=!0:Ze.push(Mr.tagName)),He&&fr){for(var Nr=z(He,{}),or=0;or<fr;or++){var Dr=Mr[or];Fe(Dr.offset),Dr.locator=z(He,{})}me.locator=Nr,q(Mr,me,Pr)&&tt.push(Mr),me.locator=He}else q(Mr,me,Pr)&&tt.push(Mr);we&&!Mr.closed?ar=W(ue,ar,Mr.tagName,ce,me):ar++}}catch(er){if(er instanceof u)throw er;if(er instanceof h)throw new u(er.name+": "+er.message,me.locator,er);Ee.error("element parse error: "+er),ar=-1}ar>Qe?Qe=ar:xe(Math.max(Ie,Qe)+1)}}function z(ue,de){return de.lineNumber=ue.lineNumber,de.columnNumber=ue.columnNumber,de}function B(ue,de,Pe,me,Ee,we,Ae){function ce(Fe,tt,Ze){if(s(Pe.attributeNames,Fe))return we.fatalError("Attribute "+Fe+" redefined");if(!Ae&&tt.indexOf("<")>=0)return we.fatalError("Unescaped '<' not allowed in attributes values");Pe.addValue(Fe,tt.replace(/[\t\n\r]/g," ").replace(N,Ee),Ze)}for(var xe,_e,Me=++de,Re=f;;){var He=ue.charAt(Me);switch(He){case"=":if(Re===d)xe=ue.slice(de,Me),Re=v;else if(Re===b)Re=v;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Re===v||Re===d)if(Re===d&&(we.warning('attribute value must after "="'),xe=ue.slice(de,Me)),de=Me+1,Me=ue.indexOf(He,de),Me>0)_e=ue.slice(de,Me),ce(xe,_e,de-1),Re=E;else throw new Error("attribute value no end '"+He+"' match");else if(Re==S)_e=ue.slice(de,Me),ce(xe,_e,de),we.warning('attribute "'+xe+'" missed start quot('+He+")!!"),de=Me+1,Re=E;else throw new Error('attribute value must after "="');break;case"/":switch(Re){case f:Pe.setTagName(ue.slice(de,Me));case E:case P:case k:Re=k,Pe.closed=!0;case S:case d:break;case b:Pe.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return we.error("unexpected end of input"),Re==f&&Pe.setTagName(ue.slice(de,Me)),Me;case">":switch(Re){case f:Pe.setTagName(ue.slice(de,Me));case E:case P:case k:break;case S:case d:_e=ue.slice(de,Me),_e.slice(-1)==="/"&&(Pe.closed=!0,_e=_e.slice(0,-1));case b:Re===b&&(_e=xe),Re==S?(we.warning('attribute "'+_e+'" missed quot(")!'),ce(xe,_e,de)):(Ae||we.warning('attribute "'+_e+'" missed value!! "'+_e+'" instead!!'),ce(_e,_e,de));break;case v:if(!Ae)return we.fatalError(`AttValue: ' or " expected`)}return Me;case"":He=" ";default:if(He<=" ")switch(Re){case f:Pe.setTagName(ue.slice(de,Me)),Re=P;break;case d:xe=ue.slice(de,Me),Re=b;break;case S:var _e=ue.slice(de,Me);we.warning('attribute "'+_e+'" missed quot(")!!'),ce(xe,_e,de);case E:Re=P;break}else switch(Re){case b:Ae||we.warning('attribute "'+xe+'" missed value!! "'+xe+'" instead2!!'),ce(xe,xe,de),de=Me,Re=d;break;case E:we.warning('attribute space is required"'+xe+'"!!');case P:Re=d,de=Me;break;case v:Re=S,de=Me;break;case k:throw new Error("elements closed character '/' and '>' must be connected to")}}Me++}}function q(ue,de,Pe){for(var me=ue.tagName,Ee=null,Re=ue.length;Re--;){var we=ue[Re],Ae=we.qName,ce=we.value,He=Ae.indexOf(":");if(He>0)var xe=we.prefix=Ae.slice(0,He),_e=Ae.slice(He+1),Me=xe==="xmlns"&&_e;else _e=Ae,xe=null,Me=Ae==="xmlns"&&"";we.localName=_e,Me!==!1&&(Ee==null&&(Ee=Object.create(null),G(Pe,Pe=Object.create(null))),Pe[Me]=Ee[Me]=ce,we.uri=o.XMLNS,de.startPrefixMapping(Me,ce))}for(var Re=ue.length;Re--;)we=ue[Re],we.prefix&&(we.prefix==="xml"&&(we.uri=o.XML),we.prefix!=="xmlns"&&(we.uri=Pe[we.prefix]));var He=me.indexOf(":");He>0?(xe=ue.prefix=me.slice(0,He),_e=ue.localName=me.slice(He+1)):(xe=null,_e=ue.localName=me);var Fe=ue.uri=Pe[xe||""];if(de.startElement(Fe,_e,me,ue),ue.closed){if(de.endElement(Fe,_e,me),Ee)for(xe in Ee)s(Ee,xe)&&de.endPrefixMapping(xe)}else return ue.currentNSMap=Pe,ue.localNSMap=Ee,!0}function W(ue,de,Pe,me,Ee){var we=n(Pe);if(we||a(Pe)){var Ae=ue.indexOf("</"+Pe+">",de),ce=ue.substring(de+1,Ae);return we&&(ce=ce.replace(N,me)),Ee.characters(ce,0,ce.length),Ae}return de+1}function G(ue,de){for(var Pe in ue)s(ue,Pe)&&(de[Pe]=ue[Pe])}function ie(ue,de){var Pe=de;function me(Me){return Me=Me||0,ue.charAt(Pe+Me)}function Ee(Me){Me=Me||1,Pe+=Me}function we(){for(var Me=0;Pe<ue.length;){var Re=me();if(Re!==" "&&Re!==`
`&&Re!=="	"&&Re!=="\r")return Me;Me++,Ee()}return-1}function Ae(){return ue.substring(Pe)}function ce(Me){return ue.substring(Pe,Pe+Me.length)===Me}function xe(Me){return ue.substring(Pe,Pe+Me.length).toUpperCase()===Me.toUpperCase()}function _e(Me){var Re=e.reg("^",Me),He=Re.exec(Ae());return He?(Ee(He[0].length),He[0]):null}return{char:me,getIndex:function(){return Pe},getMatch:_e,getSource:function(){return ue},skip:Ee,skipBlanks:we,substringFromIndex:Ae,substringStartsWith:ce,substringStartsWithCaseInsensitive:xe}}function J(ue,de){function Pe(ce,xe){var _e=e.PI.exec(ce.substringFromIndex());return _e?_e[1].toLowerCase()==="xml"?xe.fatalError("xml declaration is only allowed at the start of the document, but found at position "+ce.getIndex()):(ce.skip(_e[0].length),_e[0]):xe.fatalError("processing instruction is not well-formed at position "+ce.getIndex())}var me=ue.getSource();if(ue.char()==="["){ue.skip(1);for(var Ee=ue.getIndex();ue.getIndex()<me.length;){if(ue.skipBlanks(),ue.char()==="]"){var we=me.substring(Ee,ue.getIndex());return ue.skip(1),we}var Ae=null;if(ue.char()==="<"&&ue.char(1)==="!")switch(ue.char(2)){case"E":ue.char(3)==="L"?Ae=ue.getMatch(e.elementdecl):ue.char(3)==="N"&&(Ae=ue.getMatch(e.EntityDecl));break;case"A":Ae=ue.getMatch(e.AttlistDecl);break;case"N":Ae=ue.getMatch(e.NotationDecl);break;case"-":Ae=ue.getMatch(e.Comment);break}else if(ue.char()==="<"&&ue.char(1)==="?")Ae=Pe(ue,de);else if(ue.char()==="%")Ae=ue.getMatch(e.PEReference);else return de.fatalError("Error detected in Markup declaration");if(!Ae)return de.fatalError("Error in internal subset at position "+ue.getIndex())}return de.fatalError("doctype internal subset is not well-formed, missing ]")}}function H(ue,de,Pe,me,Ee){var we=ie(ue,de);switch(Ee?we.char(2).toUpperCase():we.char(2)){case"-":var Ae=we.getMatch(e.Comment);return Ae?(Pe.comment(Ae,e.COMMENT_START.length,Ae.length-e.COMMENT_START.length-e.COMMENT_END.length),we.getIndex()):me.fatalError("comment is not well-formed at position "+we.getIndex());case"[":var ce=we.getMatch(e.CDSect);return ce?!Ee&&!Pe.currentElement?me.fatalError("CDATA outside of element"):(Pe.startCDATA(),Pe.characters(ce,e.CDATA_START.length,ce.length-e.CDATA_START.length-e.CDATA_END.length),Pe.endCDATA(),we.getIndex()):me.fatalError("Invalid CDATA starting at position "+de);case"D":{if(Pe.doc&&Pe.doc.documentElement)return me.fatalError("Doctype not allowed inside or after documentElement at position "+we.getIndex());if(Ee?!we.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!we.substringStartsWith(e.DOCTYPE_DECL_START))return me.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+we.getIndex());if(we.skip(e.DOCTYPE_DECL_START.length),we.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+we.getIndex());var xe={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(xe.name=we.getMatch(e.Name),!xe.name)return me.fatalError("doctype name missing or contains unexpected characters at position "+we.getIndex());if(Ee&&xe.name.toLowerCase()!=="html"&&me.warning("Unexpected DOCTYPE in HTML document at position "+we.getIndex()),we.skipBlanks(),we.substringStartsWith(e.PUBLIC)||we.substringStartsWith(e.SYSTEM)){var _e=e.ExternalID_match.exec(we.substringFromIndex());if(!_e)return me.fatalError("doctype external id is not well-formed at position "+we.getIndex());_e.groups.SystemLiteralOnly!==void 0?xe.systemId=_e.groups.SystemLiteralOnly:(xe.systemId=_e.groups.SystemLiteral,xe.publicId=_e.groups.PubidLiteral),we.skip(_e[0].length)}else if(Ee&&we.substringStartsWithCaseInsensitive(e.SYSTEM)){if(we.skip(e.SYSTEM.length),we.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+we.getIndex());if(xe.systemId=we.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!xe.systemId)return me.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+we.getIndex())}return Ee&&xe.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(xe.systemId)&&me.warning("Unexpected doctype.systemId in HTML document at position "+we.getIndex()),Ee||(we.skipBlanks(),xe.internalSubset=J(we,me)),we.skipBlanks(),we.char()!==">"?me.fatalError("doctype not terminated with > at position "+we.getIndex()):(we.skip(1),Pe.startDTD(xe.name,xe.publicId,xe.systemId,xe.internalSubset),Pe.endDTD(),we.getIndex())}default:return me.fatalError('Not well-formed XML starting with "<!" at position '+de)}}function ne(ue,de,Pe,me){var Ee=ue.substring(de).match(e.PI);if(!Ee)return me.fatalError("Invalid processing instruction starting at position "+de);if(Ee[1].toLowerCase()==="xml"){if(de>0)return me.fatalError("processing instruction at position "+de+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(ue.substring(de)))return me.fatalError("xml declaration is not well-formed")}return Pe.processingInstruction(Ee[1],Ee[2]),de+Ee[0].length}function ae(){this.attributeNames=Object.create(null)}return ae.prototype={setTagName:function(ue){if(!e.QName_exact.test(ue))throw new Error("invalid tagName:"+ue);this.tagName=ue},addValue:function(ue,de,Pe){if(!e.QName_exact.test(ue))throw new Error("invalid attribute:"+ue);this.attributeNames[ue]=this.length,this[this.length++]={qName:ue,value:de,offset:Pe}},length:0,getLocalName:function(ue){return this[ue].localName},getLocator:function(ue){return this[ue].locator},getQName:function(ue){return this[ue].qName},getURI:function(ue){return this[ue].uri},getValue:function(ue){return this[ue].value}},I_.XMLReader=L,I_.parseUtils=ie,I_.parseDoctypeCommentOrCData=H,I_}var UV;function jIe(){if(UV)return Og;UV=1;var t=$0(),e=SJ(),r=BT(),n=BIe(),i=zIe(),a=e.DOMImplementation,s=t.hasDefaultHTMLNamespace,o=t.isHTMLMimeType,u=t.isValidMimeType,h=t.MIME_TYPE,f=t.NAMESPACE,d=r.ParseError,b=i.XMLReader;function v(B){return B.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function S(B){if(B=B||{},B.locator===void 0&&(B.locator=!0),this.assign=B.assign||t.assign,this.domHandler=B.domHandler||E,this.onError=B.onError||B.errorHandler,B.errorHandler&&typeof B.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");B.errorHandler&&B.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=B.normalizeLineEndings||v,this.locator=!!B.locator,this.xmlns=this.assign(Object.create(null),B.xmlns)}S.prototype.parseFromString=function(B,q){if(!u(q))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+q+'" is not valid.');var W=this.assign(Object.create(null),this.xmlns),G=n.XML_ENTITIES,ie=W[""]||null;s(q)?(G=n.HTML_ENTITIES,ie=f.HTML):q===h.XML_SVG_IMAGE&&(ie=f.SVG),W[""]=ie,W.xml=W.xml||f.XML;var J=new this.domHandler({mimeType:q,defaultNamespace:ie,onError:this.onError}),H=this.locator?{}:void 0;this.locator&&J.setDocumentLocator(H);var ne=new b;ne.errorHandler=J,ne.domBuilder=J;var ae=!t.isHTMLMimeType(q);return ae&&typeof B!="string"&&ne.errorHandler.fatalError("source is not a string"),ne.parse(this.normalizeLineEndings(String(B)),W,G),J.doc.documentElement||ne.errorHandler.fatalError("missing root element"),J.doc};function E(B){var q=B||{};this.mimeType=q.mimeType||h.XML_APPLICATION,this.defaultNamespace=q.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=q.onError}function P(B,q){q.lineNumber=B.lineNumber,q.columnNumber=B.columnNumber}E.prototype={startDocument:function(){var B=new a;this.doc=o(this.mimeType)?B.createHTMLDocument(!1):B.createDocument(this.defaultNamespace,"")},startElement:function(B,q,W,G){var ie=this.doc,J=ie.createElementNS(B,W||q),H=G.length;N(this,J),this.currentElement=J,this.locator&&P(this.locator,J);for(var ne=0;ne<H;ne++){var B=G.getURI(ne),ae=G.getValue(ne),W=G.getQName(ne),ue=ie.createAttributeNS(B,W);this.locator&&P(G.getLocator(ne),ue),ue.value=ue.nodeValue=ae,J.setAttributeNode(ue)}},endElement:function(B,q,W){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(B,q){},endPrefixMapping:function(B){},processingInstruction:function(B,q){var W=this.doc.createProcessingInstruction(B,q);this.locator&&P(this.locator,W),N(this,W)},ignorableWhitespace:function(B,q,W){},characters:function(B,q,W){if(B=L.apply(this,arguments),B){if(this.cdata)var G=this.doc.createCDATASection(B);else var G=this.doc.createTextNode(B);this.currentElement?this.currentElement.appendChild(G):/^\s*$/.test(B)&&this.doc.appendChild(G),this.locator&&P(this.locator,G)}},skippedEntity:function(B){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(B){B&&(B.lineNumber=0),this.locator=B},comment:function(B,q,W){B=L.apply(this,arguments);var G=this.doc.createComment(B);this.locator&&P(this.locator,G),N(this,G)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(B,q,W,G){var ie=this.doc.implementation;if(ie&&ie.createDocumentType){var J=ie.createDocumentType(B,q,W,G);this.locator&&P(this.locator,J),N(this,J),this.doc.doctype=J}},reportError:function(B,q){if(typeof this.onError=="function")try{this.onError(B,q,this)}catch(W){throw new d("Reporting "+B+' "'+q+'" caused '+W,this.locator)}else console.error("[xmldom "+B+"]	"+q,k(this.locator))},warning:function(B){this.reportError("warning",B)},error:function(B){this.reportError("error",B)},fatalError:function(B){throw this.reportError("fatalError",B),new d(B,this.locator)}};function k(B){if(B)return`
@#[line:`+B.lineNumber+",col:"+B.columnNumber+"]"}function L(B,q,W){return typeof B=="string"?B.substr(q,W):B.length>=q+W||q?new java.lang.String(B,q,W)+"":B}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(B){E.prototype[B]=function(){return null}});function N(B,q){B.currentElement?B.currentElement.appendChild(q):B.doc.appendChild(q)}function M(B){if(B==="error")throw"onErrorStopParsing"}function z(){throw"onWarningStopParsing"}return Og.__DOMHandler=E,Og.DOMParser=S,Og.normalizeLineEndings=v,Og.onErrorStopParsing=M,Og.onWarningStopParsing=z,Og}var VV;function UIe(){if(VV)return ya;VV=1;var t=$0();ya.assign=t.assign,ya.hasDefaultHTMLNamespace=t.hasDefaultHTMLNamespace,ya.isHTMLMimeType=t.isHTMLMimeType,ya.isValidMimeType=t.isValidMimeType,ya.MIME_TYPE=t.MIME_TYPE,ya.NAMESPACE=t.NAMESPACE;var e=BT();ya.DOMException=e.DOMException,ya.DOMExceptionName=e.DOMExceptionName,ya.ExceptionCode=e.ExceptionCode,ya.ParseError=e.ParseError;var r=SJ();ya.Attr=r.Attr,ya.CDATASection=r.CDATASection,ya.CharacterData=r.CharacterData,ya.Comment=r.Comment,ya.Document=r.Document,ya.DocumentFragment=r.DocumentFragment,ya.DocumentType=r.DocumentType,ya.DOMImplementation=r.DOMImplementation,ya.Element=r.Element,ya.Entity=r.Entity,ya.EntityReference=r.EntityReference,ya.LiveNodeList=r.LiveNodeList,ya.NamedNodeMap=r.NamedNodeMap,ya.Node=r.Node,ya.NodeList=r.NodeList,ya.Notation=r.Notation,ya.ProcessingInstruction=r.ProcessingInstruction,ya.Text=r.Text,ya.XMLSerializer=r.XMLSerializer;var n=jIe();return ya.DOMParser=n.DOMParser,ya.normalizeLineEndings=n.normalizeLineEndings,ya.onErrorStopParsing=n.onErrorStopParsing,ya.onWarningStopParsing=n.onWarningStopParsing,ya}var VIe=UIe();const EJ=(function(){const t=/\s*/g,e=/^\s*|\s*$/g,r=/\s+/;function n(M){if(!M||!M.length)return 0;for(var z=0,B=0;z<M.length;z++)B=(B<<5)-B+M.charCodeAt(z)|0;return B}function i(M,z){return M.getElementsByTagName(z)}function a(M,z){return M.getAttribute(z)}function s(M,z){return parseFloat(a(M,z))}function o(M,z){const B=i(M,z);return B.length?B[0]:null}function u(M){return M.normalize&&M.normalize(),M}function h(M){for(var z=0,B=[];z<M.length;z++)B[z]=parseFloat(M[z]);return B}function f(M){return M&&u(M),M&&M.textContent||""}function d(M,z){let B={},q,W;for(W=0;W<z.length;W++)q=o(M,z[W]),q&&(B[z[W]]=f(q));return B}function b(M,z){for(const B in z)M[B]=z[B]}function v(M){return h(M.replace(t,"").split(","))}function S(M){const z=M.replace(e,"").split(r),B=[];for(let q=0;q<z.length;q++)B.push(v(z[q]));return B}function E(M){let z=[s(M,"lon"),s(M,"lat")],B=o(M,"ele"),q=o(M,"gpxtpx:hr")||o(M,"hr"),W=o(M,"time"),G;return B&&(G=parseFloat(f(B)),isNaN(G)||z.push(G)),{coordinates:z,time:W?f(W):null,heartRate:q?parseFloat(f(q)):null}}function P(){return{type:"FeatureCollection",features:[]}}let k;if(typeof XMLSerializer<"u")k=new XMLSerializer;else{const M=typeof process=="object"&&!process.browser,z=typeof Titanium=="object";if(typeof exports=="object"&&(M||z))k=VIe.XMLSerializer;else throw new Error("Unable to initialize serializer")}function L(M){return M.xml!==void 0?M.xml:k.serializeToString(M)}return{kml:function(M){const z=P(),B={},q={},W={},G=["Polygon","LineString","Point","Track","gx:Track"],ie=i(M,"Placemark"),J=i(M,"Style"),H=i(M,"StyleMap");for(let me=0;me<J.length;me++){const Ee=n(L(J[me])).toString(16);B["#"+a(J[me],"id")]=Ee,q[Ee]=J[me]}for(let me=0;me<H.length;me++){B["#"+a(H[me],"id")]=n(L(H[me])).toString(16);const Ee=i(H[me],"Pair"),we={};for(let Ae=0;Ae<Ee.length;Ae++)we[f(o(Ee[Ae],"key"))]=f(o(Ee[Ae],"styleUrl"));W["#"+a(H[me],"id")]=we}for(let me=0;me<ie.length;me++)z.features=z.features.concat(Pe(ie[me]));function ne(me){let Ee,we;return me=me||"",me.substr(0,1)==="#"&&(me=me.substr(1)),(me.length===6||me.length===3)&&(Ee=me),me.length===8&&(we=parseInt(me.substr(0,2),16)/255,Ee="#"+me.substr(6,2)+me.substr(4,2)+me.substr(2,2)),[Ee,isNaN(we)?void 0:we]}function ae(me){return h(me.split(" "))}function ue(me){let Ee=i(me,"coord"),we=[],Ae=[];Ee.length===0&&(Ee=i(me,"gx:coord"));for(let xe=0;xe<Ee.length;xe++)we.push(ae(f(Ee[xe])));const ce=i(me,"when");for(let xe=0;xe<ce.length;xe++)Ae.push(f(ce[xe]));return{coords:we,times:Ae}}function de(me){let Ee,we,Ae,ce,xe,_e=[],Me=[];if(o(me,"MultiGeometry"))return de(o(me,"MultiGeometry"));if(o(me,"MultiTrack"))return de(o(me,"MultiTrack"));if(o(me,"gx:MultiTrack"))return de(o(me,"gx:MultiTrack"));for(Ae=0;Ae<G.length;Ae++)if(we=i(me,G[Ae]),we){for(ce=0;ce<we.length;ce++)if(Ee=we[ce],G[Ae]==="Point")_e.push({type:"Point",coordinates:v(f(o(Ee,"coordinates")))});else if(G[Ae]==="LineString")_e.push({type:"LineString",coordinates:S(f(o(Ee,"coordinates")))});else if(G[Ae]==="Polygon"){const Re=i(Ee,"LinearRing"),He=[];for(xe=0;xe<Re.length;xe++)He.push(S(f(o(Re[xe],"coordinates"))));_e.push({type:"Polygon",coordinates:He})}else if(G[Ae]==="Track"||G[Ae]==="gx:Track"){const Re=ue(Ee);_e.push({type:"LineString",coordinates:Re.coords}),Re.times.length&&Me.push(Re.times)}}return{geoms:_e,coordTimes:Me}}function Pe(me){let Ee=de(me),we,Ae={},ce=f(o(me,"name")),xe=f(o(me,"address")),_e=f(o(me,"styleUrl")),Me=f(o(me,"description")),Re=o(me,"TimeSpan"),He=o(me,"TimeStamp"),Fe=o(me,"ExtendedData"),tt=o(me,"LineStyle"),Ze=o(me,"PolyStyle"),Qe=o(me,"visibility");if(!Ee.geoms.length)return[];if(ce&&(Ae.name=ce),xe&&(Ae.address=xe),_e){_e[0]!=="#"&&(_e="#"+_e),Ae.styleUrl=_e,B[_e]&&(Ae.styleHash=B[_e]),W[_e]&&(Ae.styleMapHash=W[_e],Ae.styleHash=B[W[_e].normal]);const Lt=q[Ae.styleHash];if(Lt){tt||(tt=o(Lt,"LineStyle")),Ze||(Ze=o(Lt,"PolyStyle"));const at=o(Lt,"IconStyle");if(at){const Ve=o(at,"Icon");if(Ve){const nr=f(o(Ve,"href"));nr&&(Ae.icon=nr)}}}}if(Me&&(Ae.description=Me),Re){const Lt=f(o(Re,"begin")),at=f(o(Re,"end"));Ae.timespan={begin:Lt,end:at}}if(He&&(Ae.timestamp=f(o(He,"when"))),tt){const Lt=ne(f(o(tt,"color"))),at=Lt[0],Ve=Lt[1],nr=parseFloat(f(o(tt,"width")));at&&(Ae.stroke=at),isNaN(Ve)||(Ae["stroke-opacity"]=Ve),isNaN(nr)||(Ae["stroke-width"]=nr)}if(Ze){const Lt=ne(f(o(Ze,"color"))),at=Lt[0],Ve=Lt[1],nr=f(o(Ze,"fill")),Yt=f(o(Ze,"outline"));at&&(Ae.fill=at),isNaN(Ve)||(Ae["fill-opacity"]=Ve),nr&&(Ae["fill-opacity"]=nr==="1"?Ae["fill-opacity"]||1:0),Yt&&(Ae["stroke-opacity"]=Yt==="1"?Ae["stroke-opacity"]||1:0)}if(Fe){const Lt=i(Fe,"Data"),at=i(Fe,"SimpleData");for(we=0;we<Lt.length;we++)Ae[Lt[we].getAttribute("name")]=f(o(Lt[we],"value"));for(we=0;we<at.length;we++)Ae[at[we].getAttribute("name")]=f(at[we])}Qe&&(Ae.visibility=f(Qe)),Ee.coordTimes.length&&(Ae.coordTimes=Ee.coordTimes.length===1?Ee.coordTimes[0]:Ee.coordTimes);const Ie={type:"Feature",geometry:Ee.geoms.length===1?Ee.geoms[0]:{type:"GeometryCollection",geometries:Ee.geoms},properties:Ae};return a(me,"id")&&(Ie.id=a(me,"id")),[Ie]}return z},gpx:function(M){let z,B=i(M,"trk"),q=i(M,"rte"),W=i(M,"wpt"),G=P(),ie;for(z=0;z<B.length;z++)ie=ne(B[z]),ie&&G.features.push(ie);for(z=0;z<q.length;z++)ie=ae(q[z]),ie&&G.features.push(ie);for(z=0;z<W.length;z++)G.features.push(ue(W[z]));function J(me,Ee){for(let we=0;we<Ee;we++)me.push(null);return me}function H(me,Ee){const we=i(me,Ee),Ae=[],ce=[],xe=[],_e=we.length;if(_e<2)return{};for(let Me=0;Me<_e;Me++){const Re=E(we[Me]);Ae.push(Re.coordinates),Re.time&&ce.push(Re.time),(Re.heartRate||xe.length)&&(xe.length||J(xe,Me),xe.push(Re.heartRate||null))}return{line:Ae,times:ce,heartRates:xe}}function ne(me){let Ee=i(me,"trkseg"),we=[],Ae=[],ce=[],xe;for(let Me=0;Me<Ee.length;Me++)if(xe=H(Ee[Me],"trkpt"),xe&&(xe.line&&we.push(xe.line),xe.times&&xe.times.length&&Ae.push(xe.times),ce.length||xe.heartRates&&xe.heartRates.length)){if(!ce.length)for(let Re=0;Re<Me;Re++)ce.push(J([],we[Re].length));xe.heartRates&&xe.heartRates.length?ce.push(xe.heartRates):ce.push(J([],xe.line.length||0))}if(we.length===0)return;const _e=Pe(me);return b(_e,de(o(me,"extensions"))),Ae.length&&(_e.coordTimes=we.length===1?Ae[0]:Ae),ce.length&&(_e.heartRates=we.length===1?ce[0]:ce),{type:"Feature",properties:_e,geometry:{type:we.length===1?"LineString":"MultiLineString",coordinates:we.length===1?we[0]:we}}}function ae(me){const Ee=H(me,"rtept");if(!Ee.line)return;const we=Pe(me);return b(we,de(o(me,"extensions"))),{type:"Feature",properties:we,geometry:{type:"LineString",coordinates:Ee.line}}}function ue(me){const Ee=Pe(me);return b(Ee,d(me,["sym"])),{type:"Feature",properties:Ee,geometry:{type:"Point",coordinates:E(me).coordinates}}}function de(me){const Ee={};if(me){const we=o(me,"line");if(we){const Ae=f(o(we,"color")),ce=parseFloat(f(o(we,"opacity"))),xe=parseFloat(f(o(we,"width")));Ae&&(Ee.stroke=Ae),isNaN(ce)||(Ee["stroke-opacity"]=ce),isNaN(xe)||(Ee["stroke-width"]=xe*96/25.4)}}return Ee}function Pe(me){const Ee=d(me,["name","cmt","desc","type","time","keywords"]),we=i(me,"link");we.length&&(Ee.links=[]);for(let Ae=0,ce;Ae<we.length;Ae++)ce={href:a(we[Ae],"href")},b(ce,d(we[Ae],["text","type"])),Ee.links.push(ce);return Ee}return G}}})(),FS=t=>{const[e,r]=ee.useState(),[n,i]=ee.useState([]),a=s=>{try{i([]);const u=new DOMParser().parseFromString(s,"application/xml");u.querySelector("metadata")?.childNodes.forEach(d=>{let b=d.textContent;const v=d.nodeName;if(d.nodeName==="link"&&(b=d.getAttribute("href")??""),b?.trim().length){const S={title:v,value:b,id:new Date().getTime()};i(E=>[...E,S])}});const f=EJ.gpx(u);r(f)}catch(o){console.log(o)}};return ee.useEffect(()=>{t.data&&a(t.data)},[t.data]),{geojson:e,metadata:n}};FS.defaultProps={data:void 0};try{FS.displayName="useGpx",FS.__docgenInfo={description:"useGpx hook converts GPX data to GeoJSON",displayName:"useGpx",props:{data:{defaultValue:{value:"undefined"},description:"a string containing GPX data that is supposed to be parsed and converted to GeoJSON by this hook",name:"data",required:!1,type:{name:"string | undefined"}}}}}catch{}const BS=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.layerId}),r=ee.useRef(new ME.Popup({closeButton:!1,closeOnClick:!0}));return ee.useEffect(()=>{!e.map||!t.layerId||e.map.on("mouseenter",t.layerId,n=>{if(!e.map)return;const i=n?.features?.[0].geometry.coordinates.slice();let a="";if(n?.features?.[0]&&typeof t.getPopupContent=="function"&&(a=t.getPopupContent(n.features[0])),i?.[0]){for(;Math.abs(n.lngLat.lng-i[0])>180;)i[0]+=n.lngLat.lng>i[0]?360:-360;r.current.setLngLat(i).setHTML(a).addTo(e.map.map)}},e.componentId)},[e.map]),Z.jsx(Z.Fragment,{})};BS.defaultProps={mapId:void 0};try{BS.displayName="LayerHoverPopup",BS.__docgenInfo={description:"useLayerHoverPopup hook registers a mouseenter event to display feature properties in a MapLibre popup if a feature on the configured layer is hovered",displayName:"LayerHoverPopup",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of an existing layer in the mapLibre instance this event will be registered to",name:"layerId",required:!1,type:{name:"string | undefined"}},getPopupContent:{defaultValue:null,description:"",name:"getPopupContent",required:!0,type:{name:"(feature: Feature<Geometry, GeoJsonProperties>) => string"}}}}}catch{}const $V=t=>{const e=FS({data:t.gpxData}),r=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=ee.useRef("gpx-viewer-source-"+Ec()),i=ee.useRef("importer-layer-lines-"+Ec()),a=ee.useRef("importer-layer-points-"+Ec());return BS({layerId:a.current,getPopupContent:s=>s?.properties?.name}),iN({mapId:t.mapId,sourceId:n.current,source:{type:"geojson",data:e.geojson||Zd([])}}),Kd({layerId:i.current,options:{type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"},source:n.current},insertBeforeLayer:t.insertBeforeLayer}),Kd({layerId:a.current,options:{type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"],source:n.current},insertBeforeLayer:t.insertBeforeLayer}),ee.useEffect(()=>{if(!r.map||!e.geojson)return;typeof t.onParseGpxData=="function"&&t.onParseGpxData(e);const s=ah(e.geojson);r.map.map.fitBounds(s)},[e]),Z.jsx(Z.Fragment,{})};try{$V.displayName="MlGpxViewer",$V.__docgenInfo={description:"MlGpxViewer visualizes a given GPX Track on the map",displayName:"MlGpxViewer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},gpxData:{defaultValue:null,description:"",name:"gpxData",required:!0,type:{name:"string | undefined"}},onParseGpxData:{defaultValue:null,description:"",name:"onParseGpxData",required:!0,type:{name:"(arg0: { geojson: FeatureCollection<Geometry, GeoJsonProperties> | undefined; metadata: MetadataType[]; }) => void"}}}}}catch{}const $Ie=ht.createContext({}),qIe=$Ie.Provider,qV=({children:t})=>{const[e,r]=ee.useState({type:"FeatureCollection",features:[]}),i={data:e,setData:r,getEmptyFeatureCollection:()=>({type:"FeatureCollection",features:[]})};return Z.jsx(qIe,{value:i,children:t})};try{qV.displayName="GeoJsonProvider",qV.__docgenInfo={description:"",displayName:"GeoJsonProvider",props:{}}}catch{}const sM=()=>{const t=Object.fromEntries(new URLSearchParams(window.location.search));return t.layers=JSON.parse(t?.layers?t.layers:"[]"),t},fI=sM(),HV=t=>{const e=ee.useContext(sg),r=ee.useRef(!1),n=ee.useRef(null),[i,a]=ee.useState(void 0),s=ee.useRef({}),o=ee.useRef((t.idPrefix?t.idPrefix:"MlShareMapState-")+Ec()),u=YE({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),h=ee.useRef(!1),f=ee.useRef(null),d=ee.useRef({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:{...s}}),b=ee.useRef({}),v=ee.useCallback(()=>{if(!t.active)return;const P=[];for(const N in u.layers)P.push({id:u.layers[N]?.id,type:u.layers[N]?.type,visible:u.layers[N]?.visible});S();const k=new URLSearchParams({...sM(),...b.current,layers:JSON.stringify(P)});JSON.parse(Object.fromEntries(k).layers).forEach(N=>{s.current[N.id]=!1});const L=new URLSearchParams(window.location.search);k.toString()!==L.toString()&&window.history.pushState({...b.current},document.title,"?"+k.toString())},[u.layers,t.active]);ee.useEffect(()=>{const P=o.current;return b.current=sM(),()=>{n.current&&(n.current.cleanup(P),n.current=null),r.current=!1}},[]),ee.useEffect(()=>{n.current&&v()},[v]),ee.useEffect(()=>{if(!n.current)return;const P=v;return n.current.on("moveend",P,o.current),()=>{n.current?.map.off("moveend",P)}},[v,i]),ee.useEffect(()=>{!e?.mapExists?.(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),a(n.current),b.current.lat&&b.current.lng&&E())},[e.mapIds,e,t.mapId,t.active]),ee.useEffect(()=>{if(u?.layers?.length){typeof f.current>"u"&&(f.current=null,fI?.layers?.forEach(P=>{f.current?.[P.id]&&(f.current[P.id]=!1)}));for(const P in f.current){let k=!0;if(f.current[P]===!1&&(k=!1),k)return}fI.layers&&fI.layers.forEach(P=>{n.current?.map.getLayer(P.id)&&f.current?.[P.id]===!1&&(f.current[P.id]=!0,n.current.map?.getLayer(P.id)?.setLayoutProperty("visibility",P.visible?"visible":"none"))})}},[u.layers,t.mapId,t.active]),ee.useEffect(()=>{i&&u.layers&&(t.active||i.cleanup(o.current))},[t.active,i,u.layers]);const S=()=>{b.current.lat=n.current?.map.getCenter().lat,b.current.lng=n.current?.map.getCenter().lng,b.current.zoom=n.current?.map.getZoom(),b.current.bearing=n.current?.map.getBearing(),b.current.pitch=n.current?.map.getPitch()},E=()=>{d.current.viewport.center||(d.current.viewport.center=!0,b.current.lng&&b.current.lat&&n.current?.map.setCenter([b.current.lng,b.current.lat]),b.current.zoom&&n.current?.map.setZoom(b.current.zoom),b.current.bearing&&n.current?.map.setBearing(b.current.bearing),b.current.pitch&&n.current?.map.setPitch(b.current.pitch)),h.current=!0};return window.onpopstate=P=>{P.state&&P.state.lng&&P.state.lat&&P.state.zoom&&n.current?.map.easeTo({zoom:P.state.zoom,center:[P.state.lng,P.state.lat]})},Z.jsx(Z.Fragment,{})};try{HV.displayName="MlShareMapState",HV.__docgenInfo={description:"",displayName:"MlShareMapState",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"",name:"idPrefix",required:!1,type:{name:"string | undefined"}},active:{defaultValue:null,description:"",name:"active",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function HIe(t,e){const r=(s,o,u,h,f)=>{const d=mu([[s,o],[h,f]]),b=u2e(d,5,{units:"meters"}),v=b.geometry.coordinates[0][0],S=b.geometry.coordinates[0][1],E=b.geometry.coordinates[1][0],P=b.geometry.coordinates[1][1];return mT([[[s,o],[h,f],[E,P],[v,S],[s,o]]],{height:u*e})},n=(s,o,u)=>s*(1-u)+o*u,i=[];return t.line.geometry.coordinates.forEach((s,o)=>{if(t.line.geometry.coordinates[o+1]&&Array.isArray(s)){let h=~~(yT([s[0],s[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})*1e3/10);h=h<1?1:h;for(let f=0;f<h;f++){const d=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],f/h),b=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],f/h),v=n(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,f/h),S=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(f+1)/h),E=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(f+1)/h),P=r(d,b,v,S,E);i.push(P)}}}),Zd(i)}const WV=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],GV=t=>{const e=ee.useRef("elevationprofile-"+Ec()),r=ee.useRef("elevationprofile-layer-"+Ec()),n=t.elevationFactor||1,i=ee.useMemo(()=>{if(!t?.geojson?.features)return;const o=t.geojson.features?.find(d=>d.geometry.type==="LineString");if(!o||!o.geometry)return;const u=o.geometry.coordinates.map(d=>d[2]),h=Math.min(...u);let f=Math.max(...u)-h;return f=f===0?1:f,{max:f,min:h,line:o}},[t.geojson]),a=ee.useMemo(()=>i?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",i.max*n,"rgb(255,0,0)"]:WV,[i,t.elevationFactor]),s=ee.useMemo(()=>!t.geojson?.features||!i?void 0:HIe(i,n),[i,n]);return iN({mapId:t.mapId,sourceId:e.current,source:{type:"geojson",data:s||Zd([])}}),Kd({layerId:r.current,options:{source:e.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":a||WV}},insertBeforeLayer:t.insertBeforeLayer}),Z.jsx(Z.Fragment,{})};try{GV.displayName="MlSpatialElevationProfile",GV.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties> | geojson | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:null,description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const qv=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(t.layerId||"MlVectorTileLayer-"+e.componentId),n=ee.useRef({}),i=ee.useRef({}),a=ee.useRef(!1),s=ee.useCallback(()=>{e.map&&(a.current=!0,e.map.map.getSource(r.current)&&e.cleanup(),e.map.map.getSource(r.current)||e.map.addSource(r.current,{type:"vector",tiles:[t.url||""],attribution:"",minzoom:0,maxzoom:14,...t.sourceOptions},e.componentId),t.layers.forEach(u=>{e.map&&(e.map.addLayer({source:r.current,minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2},...u},t.insertBeforeLayer,e.componentId),n.current[u.id]=JSON.stringify(u.paint),i.current[u.id]=JSON.stringify(u.layout),e.map.on("styledata",()=>{a.current&&!e.map?.map.getSource(r.current)&&(console.log("Recreate Layer "+r.current),s())},e.componentId))}))},[e.map,t]),o=ee.useCallback(()=>{a.current&&t.layers.forEach(u=>{if(e.map&&e.map.map.getLayer(u.id)){const h=JSON.stringify(u.paint);if(h!==n.current[u.id])for(const d in u.paint)e.map.setPaintProperty(u.id,d,u.paint[d]);n.current[u.id]=h;const f=JSON.stringify(u.layout);if(f!==i.current[u.id])for(const d in u.layout)e.map.setLayoutProperty(u.id,d,u.layout[d]);i.current[u.id]=f}})},[e.map,t.layers]);return ee.useEffect(()=>{a.current||s()},[s]),ee.useEffect(()=>{!e.map||!a.current||s()},[t.layers.length,e.map]),ee.useEffect(()=>{!e.map||!a.current||o()},[t.layers,e.map]),Z.jsx(Z.Fragment,{})};try{qv.displayName="MlVectorTileLayer",qv.__docgenInfo={description:`Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by
props.mapId`,displayName:"MlVectorTileLayer",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"VectorSourceSpecification | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"ExtendedLayerSpecification[]"}}}}}catch{}const XV=t=>{const[e,r]=ee.useState(),n=pa({mapId:t.mapId}),i=ee.useRef(t.mlGeoJsonLayerProps?.layerId||"MlOgcApiFeature-"+n.componentId),a=()=>{const s=new URL(t.ogcApiUrl);if(t.ogcApiFeatureParams&&Object.entries(t.ogcApiFeatureParams).forEach(([o,u])=>{u!=null&&s.searchParams.append(o,u.toString())}),t.reloadFeaturesOnMapMove){const o=n?.map?.getBounds().getSouthWest(),u=n?.map?.getBounds().getNorthEast(),h=`${o?.lng},${o?.lat},${u?.lng},${u?.lat}`;s.searchParams.append("bbox",h)}return s.toString()};return ee.useEffect(()=>{if(!n.map)return;const s=()=>{const o=a();fetch(o).then(u=>{if(!u.ok)throw new Error("Error fetching OGC features");return u.json()}).then(u=>{r(u)}).catch(u=>{console.log(u),r(void 0)})};return s(),t.reloadFeaturesOnMapMove&&n.map.on("moveend",s),()=>{n?.map?.off&&n.map.off("moveend",s)}},[n.map,t.ogcApiFeatureParams,t.ogcApiUrl]),ee.useEffect(()=>{!n.map||!n.map.map.style.getLayer(i.current)||(t.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))},[t.visible,n.map]),Z.jsx(Z.Fragment,{children:e&&Z.jsx(Ac,{geojson:e,layerId:i.current,...t.mlGeoJsonLayerProps})})};try{XV.displayName="MlOgcApiFeatures",XV.__docgenInfo={description:"",displayName:"MlOgcApiFeatures",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},ogcApiUrl:{defaultValue:null,description:"The url of OGC API",name:"ogcApiUrl",required:!0,type:{name:"URL"}},ogcApiFeatureParams:{defaultValue:null,description:"The additional query parameters of OGC API",name:"ogcApiFeatureParams",required:!1,type:{name:"OgcApiFeaturesParamsTypes | undefined"}},reloadFeaturesOnMapMove:{defaultValue:null,description:"Fetches the features everytime (based on the current bbox) when the map gets moved",name:"reloadFeaturesOnMapMove",required:!1,type:{name:"boolean | undefined"}},mlGeoJsonLayerProps:{defaultValue:null,description:"Geojson Layer props. But omit 'geojson' because it gets set from the OGC API Feature call",name:"mlGeoJsonLayerProps",required:!1,type:{name:'Omit<MlGeoJsonLayerProps, "geojson"> | undefined'}}}}}catch{}const YV=t=>{const e=ee.useContext(sg),r=ee.useRef(!1),n=ee.useRef(void 0),i=ee.useRef("MlWmsFeatureInfoPopup-"+Ec());return ee.useEffect(()=>{const a=i.current;return()=>{n.current&&(n.current.cleanup(a),n.current=void 0),r.current=!1}},[]),ee.useEffect(()=>{!e.mapExists(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))},[e.mapIds,e,t.mapId]),Z.jsx(Z.Fragment,{})};try{YV.displayName="MlWmsFeatureInfoPopup",YV.__docgenInfo={description:"TODO: Add short & useful description",displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const WIe={urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:"256",height:"256",styles:""}},zS=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(!1),n=ee.useRef(t.layerId||"MlWmsLayer-"+e.componentId),i=ee.useMemo(()=>{let s,o=t.url;t.url.indexOf("?")!==-1&&(s=t.url.split("?"),o=s[0]);const u=new URLSearchParams(s?.[1]),h={...WIe.urlParameters,...Object.fromEntries(u),...t.urlParameters},f=new URLSearchParams(h),d=decodeURIComponent(f.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");return o+"?"+d},[t.urlParameters,t.url]),a=ee.useCallback(()=>{e.map&&(r.current=!0,e.map.map.getLayer(n.current)&&e.cleanup(),e.map.addSource(n.current,{type:"raster",tiles:[i],tileSize:256,attribution:t.attribution??"",...t.sourceOptions},e.componentId),e.map.addLayer({id:n.current,type:"raster",source:n.current,...t.layerOptions},t.insertBeforeLayer,e.componentId),e.map.on("styledata",()=>{r.current&&!e.map?.map.getLayer(n.current)&&(console.log("Recreate Layer "+n.current),a())},e.componentId),t.visible===!1&&e.map.map.setLayoutProperty(n.current,"visibility","none"))},[e.map,t,i]);return ee.useEffect(()=>{r.current||a()},[a]),ee.useEffect(()=>{if(!e.map||!e.map?.map?.style?.sourceCaches?.[n.current]||!r.current)return;const s=e.map.map.getSource(n.current);s.tiles=[i],e.map.map.style.sourceCaches[n.current].clearTiles(),e.map.map.style.sourceCaches[n.current].update(e.map.map.transform),e.map.map.triggerRepaint()},[e.map,i]),ee.useEffect(()=>{!e.map||!r.current||(t.visible===void 0||t.visible?e.map.map.setLayoutProperty(n.current,"visibility","visible"):e.map.map.setLayoutProperty(n.current,"visibility","none"))},[t.visible,e.map]),Z.jsx(Z.Fragment,{})};try{zS.displayName="MlWmsLayer",zS.__docgenInfo={description:"Adds a WMS raster source & layer to the maplibre-gl instance",displayName:"MlWmsLayer",props:{urlParameters:{defaultValue:null,description:"",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:null,description:"",name:"attribution",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"RasterSourceSpecification | undefined"}},layerOptions:{defaultValue:null,description:"",name:"layerOptions",required:!1,type:{name:"RasterLayerSpecification | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}}}}}catch{}/**
 * wms-capabilities @0.6.0
 * @description WMS service Capabilities > JSON, based on openlayers 
 * @license BSD-2-Clause
 * @preserve
 */var la=t=>t!==void 0,TJ=(t,e,r)=>e in t?t[e]:t[e]=r;const vb={ELEMENT:1,TEXT:3,CDATA_SECTION:4};class GIe{constructor(e){this._parser=new e}toDocument(e){return this._parser.parseFromString(e,"application/xml")}getAllTextContent(e,r){return zT(e,r).join("")}}function zT(t,e){return CJ(t,e,[]).join("")}function CJ(t,e,r){if(t.nodeType===vb.CDATA_SECTION||t.nodeType===vb.TEXT)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)CJ(n,e,r)}return r}function XIe(t,e,r,n){for(var i=YIe(e);i;i=ZIe(i)){var a=i.namespaceURI||null,s=t[a];if(la(s)){var o=s[i.localName];la(o)&&o.call(n,i,r)}}}function YIe(t){let e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==vb.ELEMENT;)e=e.nextSibling;return e}function ZIe(t){let e=t.nextElementSibling||t.nextSibling;for(;e&&e.nodeType!==vb.ELEMENT;)e=e.nextSibling;return e}function _u(t,e,r){return KIe(t,e,r)}function KIe(t,e,r){var n=la(r)?r:{},i,a;for(i=0,a=t.length;i<a;++i)n[t[i]]=e;return n}function AJ(t,e){return(function(r,n){var i=t.call(la(e)?e:this,r,n);if(la(i)){var a=n[n.length-1];a.push(i)}})}function nu(t,e,r,n,i){return n.push(t),XIe(e,r,n,i),n.pop()}function ai(t,e,r){return(function(n,i){let a=t.call(la(r)?r:this,n,i);if(la(a)){var s=i[i.length-1],o=la(e)?e:n.localName;s[o]=a}})}function _c(t,e,r){return(function(n,i){var a=t.call(la(r)?r:this,n,i);if(la(a)){var s=i[i.length-1],o=la(e)?e:n.localName,u=TJ(s,o,[]);u.push(a)}})}const JIe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function QIe(t){return t.replace(JIe,"")}function sm(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return la(e[1])||!1}function Cv(t){return jd(zT(t,!1))}function jd(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function dI(t){return jS(zT(t,!1))}function jS(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Oa(t){return QIe(zT(t,!1))}const ePe="http://www.w3.org/1999/xlink";function iL(t){return t.getAttributeNS(ePe,"href")}function tPe(t,e){return nu({},IPe,t,e)}function IJ(t){return[jd(t.getAttribute("minx")),jd(t.getAttribute("miny")),jd(t.getAttribute("maxx")),jd(t.getAttribute("maxy"))]}function rPe(t,e){const r=IJ(t),n=[jd(t.getAttribute("resx")),jd(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:r,res:n}}function nPe(t,e){const r=IJ(t);if(!(!la(r[0])||!la(r[1])||!la(r[2])||!la(r[3])))return r}function iPe(t,e){const r=parseFloat(t.getAttribute("min")),n=parseFloat(t.getAttribute("max"));return{min:r,max:n}}function aPe(t,e){const r=nu({},PPe,t,e);if(!la(r))return;const n=r.westBoundLongitude,i=r.southBoundLatitude,a=r.eastBoundLongitude,s=r.northBoundLatitude;if(!(!la(n)||!la(i)||!la(a)||!la(s)))return[n,i,a,s]}function oPe(t,e){return nu({},wPe,t,e)}function sPe(t,e){return nu({},SPe,t,e)}function lPe(t,e){return nu({},EPe,t,e)}function uPe(t,e){return nu({},TPe,t,e)}function cPe(t,e){return nu({},CPe,t,e)}function hPe(t,e){return nu([],APe,t,e)}function fPe(t,e){const r=sm(t.getAttribute("queryable"));return nu({queryable:la(r)?r:!1},MJ,t,e)}function dPe(t,e){var r=e[e.length-1];const n=nu({},MJ,t,e);if(!la(n))return;let i=sm(t.getAttribute("queryable"));la(i)||(i=r.queryable),n.queryable=la(i)?i:!1;let a=jS(t.getAttribute("cascaded"));la(a)||(a=r.cascaded),n.cascaded=a;let s=sm(t.getAttribute("opaque"));la(s)||(s=r.opaque),n.opaque=la(s)?s:!1;let o=sm(t.getAttribute("noSubsets"));la(o)||(o=r.noSubsets),n.noSubsets=la(o)?o:!1;let u=jd(t.getAttribute("fixedWidth"));la(u)||(u=r.fixedWidth),n.fixedWidth=u;let h=jd(t.getAttribute("fixedHeight"));la(h)||(h=r.fixedHeight),n.fixedHeight=h;const f=["Style","CRS","AuthorityURL"];for(let b=0,v=f.length;b<v;b++){const S=f[b],E=r[S];if(la(E)){let P=TJ(n,S,[]);P=P.concat(E),n[S]=P}}const d=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];for(let b=0,v=d.length;b<v;b++){const S=d[b],E=n[S];if(!la(E)){const P=r[S];n[S]=P}}return n}function pPe(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:sm(t.getAttribute("multipleValues")),nearestValue:sm(t.getAttribute("nearestValue")),current:sm(t.getAttribute("current")),values:Oa(t)}}function Jd(t,e){return nu({},LPe,t,e)}function gPe(t,e){return nu({},kPe,t,e)}function mPe(t,e){return nu({},RPe,t,e)}function yPe(t,e){return nu({},OPe,t,e)}function pI(t,e){return nu({},MPe,t,e)}function PJ(t,e){var r=Jd(t,e);if(la(r)){const n=[jS(t.getAttribute("width")),jS(t.getAttribute("height"))];return r.size=n,r}}function vPe(t,e){var r=Jd(t,e);if(la(r))return r.name=t.getAttribute("name"),r}function _Pe(t,e){var r=Jd(t,e);if(la(r))return r.type=t.getAttribute("type"),r}function bPe(t,e){return nu({},NPe,t,e)}function kJ(t,e){return nu([],DPe,t,e)}const bu=[null,"http://www.opengis.net/wms"],xPe=_u(bu,{Service:ai(sPe),Capability:ai(oPe)}),wPe=_u(bu,{Request:ai(gPe),Exception:ai(hPe),Layer:ai(fPe)}),SPe=_u(bu,{Name:ai(Oa),Title:ai(Oa),Abstract:ai(Oa),KeywordList:ai(kJ),OnlineResource:ai(iL),ContactInformation:ai(lPe),Fees:ai(Oa),AccessConstraints:ai(Oa),LayerLimit:ai(dI),MaxWidth:ai(dI),MaxHeight:ai(dI)}),EPe=_u(bu,{ContactPersonPrimary:ai(uPe),ContactPosition:ai(Oa),ContactAddress:ai(cPe),ContactVoiceTelephone:ai(Oa),ContactFacsimileTelephone:ai(Oa),ContactElectronicMailAddress:ai(Oa)}),TPe=_u(bu,{ContactPerson:ai(Oa),ContactOrganization:ai(Oa)}),CPe=_u(bu,{AddressType:ai(Oa),Address:ai(Oa),City:ai(Oa),StateOrProvince:ai(Oa),PostCode:ai(Oa),Country:ai(Oa)}),APe=_u(bu,{Format:AJ(Oa)}),MJ=_u(bu,{Name:ai(Oa),Title:ai(Oa),Abstract:ai(Oa),KeywordList:ai(kJ),CRS:_c(Oa),SRS:_c(Oa),EX_GeographicBoundingBox:ai(aPe),LatLonBoundingBox:ai(nPe),BoundingBox:_c(rPe),Dimension:_c(pPe),Attribution:ai(tPe),AuthorityURL:_c(vPe),Identifier:_c(Oa),MetadataURL:_c(_Pe),DataURL:_c(Jd),FeatureListURL:_c(Jd),Style:_c(bPe),MinScaleDenominator:ai(Cv),MaxScaleDenominator:ai(Cv),ScaleHint:ai(iPe),Layer:_c(dPe)}),IPe=_u(bu,{Title:ai(Oa),OnlineResource:ai(iL),LogoURL:ai(PJ)}),PPe=_u(bu,{westBoundLongitude:ai(Cv),eastBoundLongitude:ai(Cv),southBoundLatitude:ai(Cv),northBoundLatitude:ai(Cv)}),kPe=_u(bu,{GetCapabilities:ai(pI),GetMap:ai(pI),GetFeatureInfo:ai(pI)}),MPe=_u(bu,{Format:_c(Oa),DCPType:_c(mPe)}),RPe=_u(bu,{HTTP:ai(yPe)}),OPe=_u(bu,{Get:ai(Jd),Post:ai(Jd)}),NPe=_u(bu,{Name:ai(Oa),Title:ai(Oa),Abstract:ai(Oa),LegendURL:_c(PJ),StyleSheetURL:ai(Jd),StyleURL:ai(Jd)}),LPe=_u(bu,{Format:ai(Oa),OnlineResource:ai(iL)}),DPe=_u(bu,{Keyword:AJ(Oa)});class FPe{constructor(e,r){!r&&typeof window<"u"&&(r=window.DOMParser),this.version=void 0,this._parser=new GIe(r),this._data=e}data(e){return this._data=e,this}toJSON(e){return e=e||this._data,this.parse(e)}parse(e){return this.readFromDocument(this._parser.toDocument(e))}readFromDocument(e){for(let r=e.firstChild;r;r=r.nextSibling)if(r.nodeType==vb.ELEMENT)return this.readFromNode(r);return null}readFromNode(e){return this.version=e.getAttribute("version"),nu({version:this.version},xPe,e,[])||null}}function RJ(t){const[e,r]=ee.useState(),[n,i]=ee.useState(t.url),[a,s]=ee.useState(""),[o,u]=ee.useState(),[h,f]=ee.useState(),d=()=>{r(void 0),u(void 0),s("")};return ee.useEffect(()=>{if(d(),f(void 0),!n)return;let b,v=n;n.indexOf("?")!==-1&&(b=n.split("?"),v=b[0]);const S=new URLSearchParams(b?.[1]),E={...Object.fromEntries(S),...t.urlParameters},P=new URLSearchParams(E),k=decodeURIComponent(P.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(v+"?"+k).then(L=>{if(L.ok)return L.text();throw Error(L.statusText+" ("+L.status+" - "+L.type+")")}).then(L=>{u(new FPe(L,window.DOMParser).toJSON())}).catch(L=>{d(),console.log(L),f(L.message)})},[n,t.urlParameters]),ee.useEffect(()=>{o?.Service&&(s(o.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource),r(o.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource))},[o]),{capabilities:o,getFeatureInfoUrl:e,wmsUrl:a,error:h,setUrl:i}}RJ.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"}};const ZV=Yi(Z.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),KV=2*Math.PI*6378137/2,JV=function(t,e={enable:!0,decimal:1}){const r=t.lng,n=t.lat;let i=r*KV/180,a=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return a=a*KV/180,e.enable&&(i=Number(i.toFixed(e.decimal)),a=Number(a.toFixed(e.decimal))),[i,a]},US=t=>{const{capabilities:e,error:r,setUrl:n,getFeatureInfoUrl:i,wmsUrl:a}=RJ({urlParameters:t.urlParameters}),[s,o]=ee.useState(t?.config?.open||!1),[u,h]=ee.useState(t?.config?.visible||!0),[f,d]=ee.useState(!1),b=pa({mapId:t?.mapId}),[v,S]=ee.useState(t?.config?.layers||[]),[E,P]=ee.useState(!1),[k,L]=ee.useState(),[N,M]=ee.useState(void 0);ee.useEffect(()=>{t.config||n(t.url)},[t.url]);const z=ee.useMemo(()=>t?.config?.wmsUrl||a,[t?.config?.wmsUrl,a]),B=ee.useMemo(()=>t?.config?.getFeatureInfoUrl||i,[t?.config?.getFeatureInfoUrl,i]),q=ee.useMemo(()=>e,[e]),W=ee.useMemo(()=>t?.name||t?.config?.name||q?.Service?.Title,[t?.name,t?.config?.name,q?.Service?.Title]),G=ee.useMemo(()=>t?.setLayers&&t?.config?.layers||v,[t?.config?.layers,v]),ie=ee.useMemo(()=>t?.setLayers||S,[t?.setLayers,S]);ee.useEffect(()=>{t?.onConfigChange?.({layers:G,getFeatureInfoUrl:B,wmsUrl:z,visible:u,open:s,name:W})},[G,q,B,z,u,s,W]);const J=ee.useMemo(()=>G.filter(de=>de.visible&&de?.Attribution?.Title).map(de=>de?.Attribution?.Title).filter((de,Pe,me)=>me.indexOf(de)===Pe).join(" "),[G]),H=function(){L(void 0),M(void 0)},ne=ee.useCallback(de=>{if(!b.map)return;H();const Pe=b.map.unproject([de.point.x,de.point.y]),me=Mh([Pe.lng,Pe.lat]),Ee=Mxe(me,50,{units:"meters"}),we=Ee&&ah(Ee),Ae=we&&JV({lng:we[0],lat:we[1]}),ce=we&&JV({lng:we[2],lat:we[3]}),_e={REQUEST:"GetFeatureInfo",BBOX:(Ae&&ce&&[Ae[0],Ae[1],ce[0],ce[1]])?.join(","),SERVICE:"WMS",INFO_FORMAT:q?.Capability?.Request?.GetFeatureInfo.Format.indexOf("text/html")!==-1?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:G.map(Ze=>Ze.visible&&Ze.queryable?Ze.Name:void 0).filter(Ze=>Ze),QUERY_LAYERS:G.map(Ze=>Ze.visible&&Ze.queryable?Ze.Name:void 0).filter(Ze=>Ze),WIDTH:100,HEIGHT:100,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:50,Y:50,I:50,J:50,buffer:"50"};let Me=B,Re;Me?.indexOf?.("?")!==-1&&(Re=t.url.split("?"),Me=Re[0]);const He=new URLSearchParams(Re?.[1]),Fe={...Object.fromEntries(He),..._e},tt=new URLSearchParams(Fe);fetch(t.url+"?"+tt.toString()).then(Ze=>{if(!Ze.ok)throw new Error("FeatureInfo could not be fetched");return Ze.text()}).then(Ze=>{L(de.lngLat),M(Ze)}).catch(Ze=>console.log(Ze))},[q,B,t,b,G]),ae=ee.useMemo(()=>(typeof t?.featureInfoActive<"u"&&t.featureInfoActive||E)&&G?.some(de=>de.visible&&de.queryable)&&!!b.map,[t?.featureInfoActive,E,G,b.map]);ee.useEffect(()=>{if(!ae){H();return}const de=ne;return b.map.map.on("click",de),()=>{b.map?.map.off?.("click",de)}},[ae,ne,b.map]),ee.useEffect(()=>{if(q?.Service)if(q?.Capability?.Layer?.CRS?.indexOf?.("EPSG:3857")===-1&&q?.Capability?.Layer?.CRS?.indexOf?.("CRS:84")===-1)console.log("MlWmsLoader ("+q.Service.Title+"): No WGS 84/Pseudo-Mercator support");else{console.log("MlWmsLoader ("+q.Service.Title+"): WGS 84/Pseudo-Mercator supported");let de=[],Pe=q?.Capability?.Layer?.Layer.filter(me=>!me.Layer?.length).map((me,Ee)=>(Ee===0&&(de=me.EX_GeographicBoundingBox),{visible:q?.Capability?.Layer?.Layer?.length>2?Ee>1:!0,Attribution:{Title:""},...(({CRS:we,...Ae})=>Ae)(me)}));q?.Capability?.Layer?.Layer.forEach(me=>{const Ee=me?.Layer?.filter(we=>we.CRS.length).map((we,Ae)=>(Ae===0&&(de=we.EX_GeographicBoundingBox),{visible:!1,Attribution:{Title:""},...(({CRS:ce,...xe})=>xe)(we)}));Ee&&(Pe=[...Pe,...Ee])}),ie(Pe),t.zoomToExtent&&b?.map&&de.length>3&&b?.map.fitBounds([[de[0],de[1]],[de[2],de[3]]])}},[q,b.map]);const ue=Z.jsxs(Ah,{secondaryAction:Z.jsxs(Z.Fragment,{children:[t.buttons,t.featureInfoEnabled&&Z.jsx(th,{sx:{padding:"4px",marginTop:"-3px",marginRight:"4px",background:de=>G?.some(Pe=>Pe.visible&&Pe.queryable)?ae?de.palette.info.light:de.palette.grey[300]:"initial"},"aria-label":"featureinfo",onClick:()=>{typeof t?.setFeatureInfoActive=="function"?t.setFeatureInfoActive(de=>!de):P(de=>!de)},disabled:!G?.some(de=>de.visible&&de.queryable),children:Z.jsx(ZV,{})}),Z.jsx(th,{edge:t.showDeleteButton?!1:"end",sx:{padding:"4px",marginTop:"-3px",...t.showDeleteButton?{marginRight:"4px"}:{}},"aria-label":"open",onClick:()=>o(de=>!de),children:s?Z.jsx(ZZ,{}):Z.jsx(xS,{})}),t.showDeleteButton&&Z.jsxs(Z.Fragment,{children:[Z.jsx(th,{"aria-label":"delete",edge:"end",onClick:()=>{typeof t.onConfigChange=="function"&&d(!0)},sx:{padding:"4px",marginTop:"-3px"},children:Z.jsx(nx,{})}),f&&Z.jsx(f0,{open:f,onConfirm:()=>{typeof t.onConfigChange=="function"&&t.onConfigChange(!1)},onCancel:()=>{d(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]})]}),sx:{paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"},children:[Z.jsx(Q1,{sx:{minWidth:"30px"},children:Z.jsx(t0,{sx:{padding:0},checked:u,onClick:()=>{h(de=>!de)}})}),Z.jsx(mh,{primary:W,variant:"layerlist"})]});return Z.jsxs(Z.Fragment,{children:[r&&Z.jsx(mge,{children:Z.jsx(Ho,{children:r})}),z&&Z.jsxs(Z.Fragment,{children:[t.layerId&&t.sortable&&Z.jsx(LS,{layerId:t.layerId,children:ue}),t.layerId&&!t.sortable&&ue,Z.jsxs(Ho,{sx:{display:s?"block":"none"},children:[Z.jsx(ff,{dense:!0,component:"div",disablePadding:!0,sx:{paddingLeft:"18px"},children:z&&G?.map?.((de,Pe)=>de?.Name?Z.jsxs(Ah,{secondaryAction:Z.jsx(Z.Fragment,{children:de?.queryable&&Z.jsx(ZV,{})}),children:[Z.jsx(Q1,{sx:{minWidth:"30px"},children:Z.jsx(t0,{checked:de.visible,sx:{padding:0},onClick:()=>{const me=[...G];me[Pe].visible=!me[Pe].visible,ie([...me])}})}),Z.jsx(mh,{primary:de?.Title,variant:"layerlist"})]},de.Name+Pe):Z.jsx(Z.Fragment,{}))}),z&&G?.length&&Z.jsx(zS,{url:z,attribution:J,visible:u,urlParameters:{...t.wmsUrlParameters,layers:G?.filter?.(de=>de.visible).map(de=>de.Name).reverse().join(",")},insertBeforeLayer:t?.insertBeforeLayer},b.componentId)]}),t.featureInfoEnabled&&k&&Z.jsx(oM,{...k,content:N})]})]})};US.defaultProps={mapId:void 0,url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"},featureInfoEnabled:!0,zoomToExtent:!1,showDeleteButton:!1};try{US.displayName="MlWmsLoader",US.__docgenInfo={description:`Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is
offered by the WMS.`,displayName:"MlWmsLoader",props:{url:{defaultValue:{value:""},description:"WMS URL",name:"url",required:!1,type:{name:"string"}},mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},urlParameters:{defaultValue:{value:`{
		SERVICE: 'WMS',
		VERSION: '1.3.0',
		REQUEST: 'GetCapabilities',
	}`},description:"URL parameters that will be used in the getCapabilities request",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},wmsUrlParameters:{defaultValue:{value:`{
		TRANSPARENT: 'TRUE',
	}`},description:"URL parameters that will be added when requesting WMS capabilities",name:"wmsUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},zoomToExtent:{defaultValue:{value:"false"},description:"If true, zooms to the extent of the WMS layer after loading the getCapabilities response",name:"zoomToExtent",required:!1,type:{name:"boolean | undefined"}},name:{defaultValue:null,description:"The name of the ListItem element representing the WmsLoader",name:"name",required:!1,type:{name:"string | undefined"}},featureInfoEnabled:{defaultValue:{value:"true"},description:"If true, enables the feature info functionality",name:"featureInfoEnabled",required:!1,type:{name:"boolean | undefined"}},featureInfoActive:{defaultValue:null,description:"If true, the feature info functionality is active",name:"featureInfoActive",required:!1,type:{name:"boolean | undefined"}},setFeatureInfoActive:{defaultValue:null,description:"A function to set the feature info active state",name:"setFeatureInfoActive",required:!1,type:{name:"((val: boolean | ((current: boolean) => boolean)) => void) | undefined"}},config:{defaultValue:null,description:"The WMS configuration object",name:"config",required:!1,type:{name:"WmsConfig | undefined"}},onConfigChange:{defaultValue:null,description:"A function to handle changes to the WMS configuration",name:"onConfigChange",required:!1,type:{name:"((config: false | WmsConfig) => void) | undefined"}},setLayers:{defaultValue:null,description:"A function to update a LayerType config array that is passed to this component at props.config.layers",name:"setLayers",required:!1,type:{name:"((layers: LayerType[]) => void) | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"If true, shows the delete button for the WMSLoader",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},buttons:{defaultValue:null,description:"Custom buttons to display for the WMSLoader",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function lM(t){const e={"circle-color":"rgba(0,0,0,0)"},r={"fill-color":"rgba(0,0,0,0)","fill-outline-color":"rgba(0,0,0,0)"},n={"line-color":"rgba(0,0,0,0)"},i=["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,0,t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],a=["interpolate",["linear"],["get",t.timeField],t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],s={"fill-color":t.featuresColor,"fill-opacity":i,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,"rgba(255, 0, 0, 0)",t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},o={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,1,t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":i},u={"line-color":t.featuresColor,"line-width":3,"line-opacity":i},h={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":a},f={"fill-color":t.featuresColor,"fill-opacity":a,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},d={"line-color":t.featuresColor,"line-width":3,"line-opacity":a};if(t.userPaint!==void 0)return t.userPaint;switch(t.type){case"circle":return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o;case"fill":return t.currentVal===t.minVal&&!t.isPlaying?r:t.accumulate?f:s;case"line":return t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?d:u;case void 0:return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o}}try{lM.displayName="paintPicker",lM.__docgenInfo={description:"",displayName:"paintPicker",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},userPaint:{defaultValue:null,description:"",name:"userPaint",required:!0,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | { ...; } | { ...; } | undefined'}}}}}catch{}function uM(t){const e=t.currentVal-t.fadeIn*t.step,r=t.currentVal+t.fadeIn*t.step,n={"text-color":"rgba(0,0,0,0)"},i={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],e,0,t.currentVal,1,r,0]},a={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],t.currentVal,1,r,0]},s=()=>t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?a:i,o={"text-field":["get",t.labelField],"text-font":["Metropolis Regular"]};return Z.jsx(DS,{options:{type:"symbol",layout:t.labelLayout||o,paint:t.labelPaint||s()},geojson:t.data,layerId:"timeControllerLabels"})}try{uM.displayName="MlTemporalControllerLabels",uM.__docgenInfo={description:"",displayName:"MlTemporalControllerLabels",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},labelField:{defaultValue:null,description:"",name:"labelField",required:!0,type:{name:"string"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},labelLayout:{defaultValue:null,description:"",name:"labelLayout",required:!1,type:{name:"SymbolLayoutProps | undefined"}},labelPaint:{defaultValue:null,description:"",name:"labelPaint",required:!1,type:{name:"SymbolLayerSpecification | undefined"}}}}}catch{}const BPe=Yi(Z.jsx("path",{d:"M8 5v14l11-7z"})),zPe=Yi(Z.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),jPe=Yi(Z.jsx("path",{d:"M6 6h12v12H6z"})),UPe=Yi(Z.jsx("path",{d:"m4 18 8.5-6L4 6zm9-12v12l8.5-6z"})),VPe=Yi(Z.jsx("path",{d:"M11 18V6l-8.5 6zm.5-6 8.5 6V6z"})),$Pe={marginLeft:"15%",marginBottom:"3%",width:"70%",height:"90px",alignItems:"center"},qPe={top:"10%",height:"100px",alignItems:"center"};function cM(t){const[e,r]=ee.useState(t.currentVal),[n,i]=ee.useState(t.isPlaying),a=t.maxVal-t.minVal,s=ee.useRef(null),o=Gb(S=>S.breakpoints.down("md"));ee.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),ee.useEffect(()=>{t.returnCurrent(e),t.returnPlaying(n)},[e,n]);const u=ht.useCallback(()=>{let S=e-t.minVal;s.current&&clearInterval(s.current),s.current=setInterval(function(){S>=a?(s.current&&clearInterval(s.current),i(!1)):r(E=>E+t.step),S=S+t.step},t.interval)},[t.step,t.maxVal,e]),h=()=>{n?(i(!1),n&&s.current&&clearInterval(s.current)):(i(!0),u())},f=()=>{s.current&&clearInterval(s.current),r(t.minVal),i(!1)},d=()=>{n?(s.current&&clearInterval(s.current),r(e-a/10),u()):r(e-a/10)},b=()=>{n?(s.current&&clearInterval(s.current),r(e+a/10),u()):r(e+a/10)},v=(S,E)=>{n?S&&(s.current&&clearInterval(s.current),r(E),u()):r(E)};return Z.jsx(Z.Fragment,{children:Z.jsxs(aO,{anchor:"bottom",open:t.open||!0,variant:"persistent",sx:{flexShrink:0,"& .MuiDrawer-paper":o?qPe:$Pe},children:[Z.jsxs(Bd,{container:!0,alignItems:"center",justifyContent:"space-between",children:[Z.jsxs(Bd,{item:!0,xs:12,sm:10,textAlign:"center",children:[Z.jsx(ra,{onClick:d,children:Z.jsx(VPe,{})}),Z.jsx(ra,{onClick:f,children:Z.jsx(jPe,{})}),Z.jsx(ra,{onClick:h,children:n?Z.jsx(zPe,{}):Z.jsx(BPe,{})}),Z.jsx(ra,{onClick:b,children:Z.jsx(UPe,{})})]}),t.display&&!o&&Z.jsx(Bd,{item:!0,xs:12,sm:5,textAlign:"right",children:Z.jsx(bs,{variant:"h5",sx:{paddingRight:"25px"},children:Math.floor(e)})})]}),Z.jsx(cO,{sx:{position:"flex",width:"95%",paddingTop:"10px",alignSelf:"center"},"aria-label":"Custom marks",defaultValue:t.minVal,value:e,step:t.step,onChange:v,min:t.minVal,max:t.maxVal}),o&&t.display&&Z.jsx(bs,{variant:"body1",textAlign:"right",children:Math.floor(e)})]})})}try{cM.displayName="TemporalControllerPlayer",cM.__docgenInfo={description:"",displayName:"TemporalControllerPlayer",props:{currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},interval:{defaultValue:null,description:"",name:"interval",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!0,type:{name:"number"}},returnCurrent:{defaultValue:null,description:"",name:"returnCurrent",required:!0,type:{name:"Dispatch<SetStateAction<number>>"}},returnPlaying:{defaultValue:null,description:"",name:"returnPlaying",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},labels:{defaultValue:null,description:"",name:"labels",required:!0,type:{name:"boolean"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},labelFadeIn:{defaultValue:null,description:"",name:"labelFadeIn",required:!0,type:{name:"number"}},labelFadeOut:{defaultValue:null,description:"",name:"labelFadeOut",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"boolean"}}}}}catch{}function HPe(t,e){if(t?.features){const r=[...t.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?1:-1),r[r.length-1]?.properties?.[e]||0}return 0}function WPe(t,e){if(t?.features){const r=[...t?.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?-1:1),r[r.length-1]?.properties?.[e]||0}return 0}function hM(t){const e=pa({mapId:t.mapId}),r=ee.useMemo(()=>t.minVal?t.minVal:HPe(t.geojson,t.timeField),[t.minVal,t.geojson,t.timeField]),n=ee.useMemo(()=>t.maxVal?t.maxVal:WPe(t.geojson,t.timeField),[t.maxVal,t.geojson,t.timeField]);return{filteredData:ee.useMemo(()=>{if(t.geojson!==void 0&&e.map&&r&&n)return Zd(t.geojson.features.filter(a=>a.properties?.[t.timeField]>=r&&a.properties?.[t.timeField]<=n))},[t.geojson,e.map,t.timeField]),minVal:r,maxVal:n}}try{hM.displayName="useFilterData",hM.__docgenInfo={description:"",displayName:"useFilterData",props:{geojson:{defaultValue:null,description:"",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},initialVal:{defaultValue:null,description:"",name:"initialVal",required:!1,type:{name:"number | undefined"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!1,type:{name:"number | undefined"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!1,type:{name:"number | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string | undefined"}}}}}catch{}const QV=({mapId:t=void 0,insertBeforeLayer:e,geojson:r,ownLayer:n=!0,attribution:i="",type:a="circle",timeField:s,minVal:o,maxVal:u,initialVal:h,accumulate:f=!1,fitBounds:d=!0,paint:b,featuresColor:v,step:S=1,interval:E=200,fadeIn:P=5,fadeOut:k=5,label:L=!0,labelColor:N,labelField:M=[],labelFadeIn:z=5,labelFadeOut:B=5,displayCurrentValue:q=!1,onClick:W,onHover:G,onLeave:ie,onStateChange:J})=>{const H=pa({mapId:t,waitForLayer:e}),{filteredData:ne,minVal:ae,maxVal:ue}=hM({geojson:r,timeField:s,minVal:o,maxVal:u,mapId:t}),de=kc(),[Pe,me]=ee.useState(h||ae),Ee=v||de.palette.primary.main,we=N||de.palette.text.primary,[Ae,ce]=ee.useState(!1),xe=lM({type:a,timeField:s,currentVal:Pe,minVal:ae,isPlaying:Ae,fadeIn:P,fadeOut:k,step:S,featuresColor:Ee,accumulate:f,userPaint:b});return ee.useEffect(()=>{!h&&ae?me(ae):h&&me(h)},[]),ee.useEffect(()=>{typeof J=="function"&&J({current:Pe,paint:xe})},[J]),ee.useEffect(()=>{if(d&&typeof ne<"u"){const _e=ah(ne);H.map?.map.fitBounds(_e)}},[ne]),ee.useEffect(()=>{if(!H.map)return;let _e,Me,Re;return W&&(_e=W,H.map?.on("click","timeController",_e)),G&&(Me=G,H.map?.on("mouseenter","timeController",Me)),ie&&(Re=ie,H.map?.on("mouseleave","timeController",Re)),()=>{_e&&H.map?.off("click","timeController",_e),Me&&H.map?.off("mouseenter","timeController",Me),Re&&H.map?.off("mouseleave","timeController",Re)}},[H.map,W,G,ie]),Z.jsxs(Z.Fragment,{children:[ne&&n&&Z.jsx(Ac,{type:a,mapId:t,options:{source:{type:"geojson",attribution:i,data:ne},paint:{...b||xe},layout:{visibility:"visible"}}}),ne&&L&&Z.jsx(uM,{data:ne,currentVal:Pe,fadeIn:z,fadeOut:B,step:S,labelField:M,labelColor:we,timeField:s,minVal:ae,accumulate:f,isPlaying:Ae}),Z.jsx(cM,{currentVal:Pe,isPlaying:Ae,step:S,interval:E,minVal:ae,maxVal:ue,returnCurrent:me,returnPlaying:ce,open:!1,fadeIn:P,fadeOut:k,featuresColor:Ee,labels:L,labelColor:we,labelFadeIn:z,labelFadeOut:B,accumulate:f,display:q})]})};try{QV.displayName="MlTemporalController",QV.__docgenInfo={description:"",displayName:"MlTemporalController",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order.
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},ownLayer:{defaultValue:{value:"true"},description:"If true,the component creates and loads a MlGeoJsonLayer to show the data.",name:"ownLayer",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:{value:""},description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible",name:"attribution",required:!1,type:{name:"string | undefined"}},type:{defaultValue:{value:"circle"},description:`Type of the layer that will be added to the MapLibre instance.
Possible values: "line", "circle", "fill"`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"Property field where the time informations is available.",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:`Lowest time value to be shown in the time line.
By default, it is set to the lowest value in the time field.`,name:"minVal",required:!1,type:{name:"number | undefined"}},label:{defaultValue:{value:"true"},description:'When true, a label layer will be added by the component. In that case, the "labelField" propertie is mandatory.',name:"label",required:!1,type:{name:"boolean | undefined"}},labelField:{defaultValue:{value:"[]"},description:"Property field where the label information is available.",name:"labelField",required:!1,type:{name:"string | undefined"}},maxVal:{defaultValue:null,description:`Highest time value to be shown in the time line.
By default, it is set to the highest value in the time field.`,name:"maxVal",required:!1,type:{name:"number | undefined"}},initialVal:{defaultValue:null,description:`the value at which the component is to be loaded.
If not specified, the component starts at the minimum value.`,name:"initialVal",required:!1,type:{name:"number | undefined"}},accumulate:{defaultValue:{value:"false"},description:`When true, the features will be accumulated in the map.
This option ist by default false.`,name:"accumulate",required:!1,type:{name:"boolean | undefined"}},fitBounds:{defaultValue:{value:"true"},description:`When true, the component will fit the map bounds to the shown features.
This option ist by default true.`,name:"fitBounds",required:!1,type:{name:"boolean | undefined"}},showControls:{defaultValue:null,description:"Boolean value that disables and enables the controls drawer.",name:"showControls",required:!1,type:{name:"boolean | undefined"}},paint:{defaultValue:null,description:`Paint property object for the features layer.
Possible props depend on the layer type.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | { ...; } | { ...; } | undefined'}},featuresColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"featuresColor",required:!1,type:{name:"string | undefined"}},step:{defaultValue:{value:"1"},description:`How many units the timeline runs through at each step.
By default it is set to 1.`,name:"step",required:!1,type:{name:"number | undefined"}},interval:{defaultValue:{value:"200"},description:`The time between each addition to the counter, expressed in milliseconds.
By default, 200 ms.`,name:"interval",required:!1,type:{name:"number | undefined"}},fadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the feature starts to appear.
By default it is set to 5 steps.`,name:"fadeIn",required:!1,type:{name:"number | undefined"}},fadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the feature fades out after it proper time value.
By default it is set to 5 steps.`,name:"fadeOut",required:!1,type:{name:"number | undefined"}},labelColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"labelColor",required:!1,type:{name:"string | undefined"}},labelLayout:{defaultValue:null,description:`Layout property object, that is passed to the labels layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelLayout",required:!1,type:{name:"SymbolLayoutProps | undefined"}},labelPaint:{defaultValue:null,description:`Paint property object for the features layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelPaint",required:!1,type:{name:"SymbolPaintProps | undefined"}},labelFadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the labels start to appear.
By default it is set to 5 steps.`,name:"labelFadeIn",required:!1,type:{name:"number | undefined"}},labelFadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the labels fade out after their proper time value.
By default it is set to 5 steps.`,name:"labelFadeOut",required:!1,type:{name:"number | undefined"}},displayCurrentValue:{defaultValue:{value:"false"},description:"If true, the current time value will be displayed in the controlls panel.",name:"displayCurrentValue",required:!1,type:{name:"boolean | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onHover:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onStateChange:{defaultValue:null,description:"Callback function defined by the user to recive the current time value and paint property in the parent component.",name:"onStateChange",required:!1,type:{name:"Dispatch<SetStateAction<TemporalControllerValues | undefined>> | undefined"}}}}}catch{}const VS=t=>{const e=t?.layerIds.toReversed();return Z.jsx(Z.Fragment,{children:e&&e.map((r,n)=>{const i=n>0?e[n-1]:t.insertBeforeLayer;return Z.jsx(DS,{layerId:r,insertBeforeLayer:i},r)})})};try{VS.displayName="MlOrderLayers",VS.__docgenInfo={description:"Creates an invisible layer for each entry in props.layerIds with the id `order-{entry}` and a reliable order",displayName:"MlOrderLayers",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerIds:{defaultValue:null,description:"",name:"layerIds",required:!0,type:{name:"string[]"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const e$=t=>{const e=pa({mapId:"map_1"});return ee.useEffect(()=>{if(e.map)return e.map.map.getSource("terrain")||e.map.map.addSource("terrain",{type:"raster-dem",encoding:"mapbox",maxzoom:12,minzoom:4,...t.sourceOptions}),e.map.map.setTerrain({source:"terrain",exaggeration:1,...t.terrainOptions}),e.map.addLayer({id:"hills",type:"hillshade",source:"terrain",layout:{visibility:"visible"},paint:{"hillshade-shadow-color":"rgba(71,59,36,0.4)"}}),()=>{e.map?.map.setTerrain(null),e.map?.map.getSource("terrain")&&(e.map.map.removeLayer("hills"),e.map.map.removeSource("terrain"))}},[e.map,t.sourceOptions,t.terrainOptions]),Z.jsx(Z.Fragment,{})};try{e$.displayName="MlTerrainLayer",e$.__docgenInfo={description:"Create Terrain Layer Component",displayName:"MlTerrainLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"Source of tiles with possibles options",name:"sourceOptions",required:!1,type:{name:"object | undefined"}},terrainOptions:{defaultValue:null,description:"Options for new exaggeration value",name:"terrainOptions",required:!1,type:{name:"TerrainSpecification | undefined"}}}}}catch{}const GPe=Yi(Z.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),XPe=Yi([Z.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),Z.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),Z.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),YPe=[{name:"Point",mode:"draw_point",icon:Z.jsx(XPe,{})},{name:"LineString",mode:"draw_line_string",icon:Z.jsx(XZ,{})},{name:"Polygon",mode:"draw_polygon",icon:Z.jsx(YZ,{})}],t$=t=>{const e=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(),[i,a]=ee.useState({activeGeometryIndex:void 0,selectedGeoJson:void 0,geometries:[],drawMode:void 0});console.log(i),ee.useEffect(()=>{typeof t.onChange=="function"&&t.onChange(i)},[i,t.onChange]);const s={...t.buttonStyleOverride},o=d=>{let b;a(v=>(b=v.drawMode,{...v,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0})),requestAnimationFrame(()=>{a(v=>(b==="draw_polygon"||b==="draw_line_string")&&d==="draw_point"?{...v,drawMode:void 0}:{...v,drawMode:d})})},u=d=>{a(b=>{const v=[...b.geometries];return v.splice(v.indexOf(d),1),{...b,drawMode:void 0,geometries:v,activeGeometryIndex:b.activeGeometryIndex?b.activeGeometryIndex-1:void 0}})},h=d=>{t.onShowInstructionChange?.(d.target.checked)},f=()=>Z.jsx(Z.Fragment,{children:YPe.map(d=>{const b=S=>i.drawMode===d.mode?S.palette.primary.main:S.palette.navigation.navColor,v=S=>i.drawMode!==d.mode?S.palette.primary.main:S.palette.navigation.navColor;return Z.jsx(Z.Fragment,{children:Z.jsx(Dp,{title:d.name,children:Z.jsx(ra,{sx:{color:v,backgroundColor:b,"&:hover":{backgroundColor:b},...s},onClick:()=>o(d.mode),children:d.icon},d.name)})})})});return Z.jsxs(Z.Fragment,{children:[Z.jsx(Wy,{sx:{zIndex:104},children:Z.jsx(BP,{children:Z.jsx(f,{})})}),Z.jsx(Wy,{sx:{marginTop:"10px"},children:Z.jsx(NG,{children:Z.jsx(jP,{control:Z.jsx(t0,{size:"small",checked:t.showInstruction,onChange:h}),label:"Show instructions"})})}),i.drawMode&&Z.jsx(_S,{mode:i.drawMode,geojson:i.selectedGeoJson,onChange:d=>{console.log("Features: ",d),d?.[0]&&a(b=>{const v=[...i.geometries];if(typeof b.activeGeometryIndex>"u"){const E=d[0];E&&E.properties?E.properties.id=E.id:console.error("tempFeature or tempFeature.properties is null or undefined"),b.activeGeometryIndex=v.length,v.push(E)}else v[b.activeGeometryIndex]=d[0];return(()=>{if(b.selectedGeoJson&&typeof b.activeGeometryIndex<"u"&&b.geometries[b.activeGeometryIndex]&&b.geometries[b.activeGeometryIndex].geometry.type==="Point"){const E=b.selectedGeoJson?.geometry?.coordinates,P=b.geometries[b.activeGeometryIndex]?.geometry?.coordinates;return JSON.stringify(E)!==JSON.stringify(P)}return!1})()&&(b.drawMode=void 0),{...b,geometries:v}})},onFinish:()=>{a(d=>({...d,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0}))}}),Z.jsxs(ff,{sx:{zIndex:105,marginBottom:"-10px"},children:[i.geometries.map((d,b)=>Z.jsxs(Wy,{sx:{display:"flex",flexDirection:"column"},children:[Z.jsx("br",{}),Z.jsxs(Wy,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{n(d)},onMouseLeave:()=>{n(void 0)},children:[!d.properties?.customName&&Z.jsx("input",{type:"text",value:d.properties?.name||"",placeholder:"Assign name",onChange:v=>{const S=v.target.value;a(E=>{const P=[...E.geometries];return P[b].properties||(P[b].properties={}),P[b].properties.name=S,{...E,geometries:P}})},style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",outline:"none"},onFocus:v=>v.target.style.borderColor="#009ee0",onBlur:v=>{v.target.style.borderColor="#ccc",a(S=>{const E=[...S.geometries];return E[b].properties||(E[b].properties={}),E[b].properties.customName=!0,{...S,geometries:E}})}}),Z.jsx(zd,{listItemSx:s,configurable:!0,visible:!0,layerComponent:Z.jsx(Ac,{mapId:t.mapId,geojson:d,layerId:String(d.id),defaultPaintOverrides:{fill:{"fill-opacity":.5}}}),type:"layer",name:Z.jsx(bs,{onClick:()=>{a(v=>{const S=[...v.geometries];return S[b].properties||(S[b].properties={}),S[b].properties.customName=!1,{...v,geometries:S}})},sx:{cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap"},children:d.properties?.name||String(d.id)}),description:d.geometry.type}),Z.jsx(Wy,{sx:{padding:"3px 30px"},children:Z.jsxs(BP,{size:"small",children:[Z.jsx(Dp,{title:"Center",children:Z.jsx(ra,{sx:{color:v=>v.palette.primary.main,backgroundColor:v=>v.palette.navigation.navColor,...s},onClick:()=>{e?.map?.map.setCenter(d.geometry.type==="Point"?d.geometry.coordinates:nN(d).geometry.coordinates)},children:Z.jsx(aN,{})})}),Z.jsx(Dp,{title:"Edit",children:Z.jsx(ra,{sx:{color:v=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===d.id?v.palette.navigation.navColor:v.palette.primary.main,backgroundColor:v=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===d.id?v.palette.primary.main:v.palette.navigation.navColor,...s},onClick:()=>{a(v=>{const S=v.drawMode==="simple_select"&&v.selectedGeoJson?.id===d.id?void 0:"simple_select";return{...v,selectedGeoJson:d,activeGeometryIndex:v.geometries.indexOf(d),drawMode:S}})},children:Z.jsx(GPe,{})})}),Z.jsx(Dp,{title:"Delete",children:Z.jsx(ra,{sx:{color:v=>v.palette.primary.main,backgroundColor:v=>v.palette.navigation.navColor,...s},onClick:()=>{u(d),n(void 0)},children:Z.jsx(nx,{})})})]})})]})]},d.id)),r&&Z.jsx(Ac,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[r]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#000000","circle-opacity":.2,"circle-radius":10},line:{"line-color":"#000000","line-opacity":.2,"line-width":10},fill:{"fill-color":"#000000","fill-opacity":.2}}})]})]})};try{t$.displayName="MlSketchTool",t$.__docgenInfo={description:"Component template",displayName:"MlSketchTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},onChange:{defaultValue:null,description:"Callback function that is called each time GeoJson data has changed within MlSketchTool.\nFirst parameter contains all geometries in the `geometries` prop.",name:"onChange",required:!1,type:{name:"((para: SketchStateType) => void) | undefined"}},showInstruction:{defaultValue:null,description:"Determines whether the instruction text should be shown.",name:"showInstruction",required:!1,type:{name:"boolean | undefined"}},onShowInstructionChange:{defaultValue:null,description:'Callback function triggered when the "Show instructions" checkbox is toggled.',name:"onShowInstructionChange",required:!1,type:{name:"((value: boolean) => void) | undefined"}}}}}catch{}const fM=t=>{const e=ee.useRef(!1),r=ee.useRef(t.pause),n=ee.useRef(t.zoom),i=ee.useRef(t.pitch),a=ee.useRef(1),s=ee.useRef(t.speed),o=ee.useRef(null),u=t.kmPerStep||.01,h=hb(t.route),f=t.stepDuration||70,d=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer});ee.useEffect(()=>{r.current=t.pause,r.current||E()},[t.pause]),ee.useEffect(()=>{d.map&&(n.current=t.zoom,typeof n.current<"u"&&d.map.map.getZoom()!==n.current&&d.map.map.setZoom(n.current))},[d.map,t.zoom]),ee.useEffect(()=>{d.map&&(i.current=t.pitch,typeof i.current<"u"&&i.current!==d.map.map.getPitch()&&d.map.map.setPitch(i.current))},[d.map,t.pitch]),ee.useEffect(()=>{s.current=t.speed},[t.speed]);const b=ee.useCallback(()=>{d.map&&(d.map.map.scrollZoom.disable(),d.map.map.boxZoom.disable(),d.map.map.dragRotate.disable(),d.map.map.dragPan.disable(),d.map.map.keyboard.disable(),d.map.map.doubleClickZoom.disable(),d.map.map.touchZoomRotate.disable())},[d.map]),v=ee.useCallback(()=>{d.map&&(d.map.map.scrollZoom.enable(),d.map.map.boxZoom.enable(),d.map.map.dragRotate.enable(),d.map.map.dragPan.enable(),d.map.map.keyboard.enable(),d.map.map.doubleClickZoom.enable(),d.map.map.touchZoomRotate.enable())},[d.map]);function S(){if(!d.map||!t.route)return;const k=ah(t.route);let L;k&&k.length>3&&(L=[[k[0],k[1]],[k[2],k[3]]],d.map.map.fitBounds(L,{padding:100}))}function E(){if(d.map)if(r.current)v();else{b(),typeof n.current<"u"&&d.map.map.getZoom()!==n.current&&d.map.map.setZoom(n.current);const k=Cbe(t.route,a.current*u).geometry.coordinates;a.current*u<h?(d.map.map.easeTo({center:k,bearing:lb(Mh([d.map.map.getCenter().lng,d.map.map.getCenter().lat]),Mh(k)),duration:f,essential:!0}),typeof s.current<"u"?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout(()=>{E()},100)):(d.map.map.setPitch(0),S(),v(),console.log("ENABLE CONTROLS"),a.current=1)}}function P(){d.map&&(S(),v(),a.current=1)}return ee.useEffect(()=>{!d.map||e.current||(e.current=!0,S())},[d.map]),ee.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{play:E,reset:P}};fM.defaultProps={mapId:void 0,zoom:18};try{fM.displayName="useCameraFollowPath",fM.__docgenInfo={description:"Component template",displayName:"useCameraFollowPath",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},pause:{defaultValue:null,description:"",name:"pause",required:!1,type:{name:"boolean | undefined"}},zoom:{defaultValue:{value:"18"},description:"",name:"zoom",required:!1,type:{name:"number | undefined"}},pitch:{defaultValue:null,description:"",name:"pitch",required:!1,type:{name:"number | undefined"}},speed:{defaultValue:null,description:"",name:"speed",required:!1,type:{name:"number | undefined"}},kmPerStep:{defaultValue:null,description:"",name:"kmPerStep",required:!1,type:{name:"number | undefined"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"any"}},stepDuration:{defaultValue:null,description:"",name:"stepDuration",required:!1,type:{name:"number | undefined"}},timeoutId:{defaultValue:null,description:"",name:"timeoutId",required:!1,type:{name:"number | undefined"}}}}}catch{}const ZPe=()=>ee.useContext(VR),$S=t=>(ee.useEffect(()=>{if(!(!t.protocol||typeof t.handler!="function"))return pP.addProtocol(t.protocol,t.handler),()=>{pP.removeProtocol(t.protocol)}},[t]),{});$S.defaultProps={mapId:void 0};try{$S.displayName="useAddProtocol",$S.__docgenInfo={description:"Enables the use of custom protocols (basically custom tile load functions) in the maplibre-gl-js library.",displayName:"useAddProtocol",props:{protocol:{defaultValue:null,description:"the protocol string, for example `mbtiles`\nIn this example the handler function is called for all tile requests that start with the string `mbtiles://`",name:"protocol",required:!0,type:{name:"string"}},handler:{defaultValue:null,description:"Custom load tile function that will be called when using a source that starts with a custom url schema.",name:"handler",required:!0,type:{name:"AddProtocolAction"}}}}}catch{}function OJ(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function KPe(t,e){var r=OJ(t);return function(n,i){return e(r(n),i,t)}}function JPe(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function aL(t){var e=new RegExp('["'+t+`
]`),r=t.charCodeAt(0);function n(h,f){var d,b,v=i(h,function(S,E){if(d)return d(S,E-1);b=S,d=f?KPe(S,f):OJ(S)});return v.columns=b,v}function i(h,f){var d={},b={},v=[],S=h.length,E=0,P=0,k,L;function N(){if(E>=S)return b;if(L)return L=!1,d;var z=E,B;if(h.charCodeAt(z)===34){for(var q=z;q++<S;)if(h.charCodeAt(q)===34){if(h.charCodeAt(q+1)!==34)break;++q}return E=q+2,B=h.charCodeAt(q+1),B===13?(L=!0,h.charCodeAt(q+2)===10&&++E):B===10&&(L=!0),h.slice(z+1,q).replace(/""/g,'"')}for(;E<S;){var W=1;if(B=h.charCodeAt(E++),B===10)L=!0;else if(B===13)L=!0,h.charCodeAt(E)===10&&(++E,++W);else if(B!==r)continue;return h.slice(z,E-W)}return h.slice(z)}for(;(k=N())!==b;){for(var M=[];k!==d&&k!==b;)M.push(k),k=N();f&&(M=f(M,P++))==null||v.push(M)}return v}function a(h,f){return f==null&&(f=JPe(h)),[f.map(u).join(t)].concat(h.map(function(d){return f.map(function(b){return u(d[b])}).join(t)})).join(`
`)}function s(h){return h.map(o).join(`
`)}function o(h){return h.map(u).join(t)}function u(h){return h==null?"":e.test(h+="")?'"'+h.replace(/\"/g,'""')+'"':h}return{parse:n,parseRows:i,format:a,formatRows:s}}var jT=aL(","),QPe=jT.parse,eke=jT.parseRows,tke=jT.format,rke=jT.formatRows,UT=aL("	"),nke=UT.parse,ike=UT.parseRows,ake=UT.format,oke=UT.formatRows;const ske=Object.freeze(Object.defineProperty({__proto__:null,csvFormat:tke,csvFormatRows:rke,csvParse:QPe,csvParseRows:eke,dsvFormat:aL,tsvFormat:ake,tsvFormatRows:oke,tsvParse:nke,tsvParseRows:ike},Symbol.toStringTag,{value:"Module"})),lke=hW(ske);var Ng={exports:{}},r$;function uke(){if(r$)return Ng.exports;r$=1,Ng.exports=t,Ng.exports.pair=a,Ng.exports.format=r,Ng.exports.formatPair=e,Ng.exports.coordToDMS=n;function t(o,u){var h=i(o,u);return h===null?null:h.val}function e(o){return r(o.lat,"lat")+" "+r(o.lon,"lon")}function r(o,u){var h=n(o,u);return h.whole+"° "+(h.minutes?h.minutes+"' ":"")+(h.seconds?h.seconds+'" ':"")+h.dir}function n(o,u){var h={lat:["N","S"],lon:["E","W"]}[u]||"",f=h[o>=0?0:1],d=Math.abs(o),b=Math.floor(d),v=d-b,S=v*60,E=Math.floor(S),P=Math.floor((S-E)*60);return{whole:b,minutes:E,seconds:P,dir:f}}function i(o,u){if(u||(u="NSEW"),typeof o!="string")return null;o=o.toUpperCase();var h=/^[\s\,]*([NSEW])?\s*([\-|\—|\―]?[0-9.]+)[°º˚]?\s*(?:([0-9.]+)['’′‘]\s*)?(?:([0-9.]+)(?:''|"|”|″)\s*)?([NSEW])?/,f=o.match(h);if(!f)return null;var d=f[0],b;if(f[1]&&f[5]?(b=f[1],d=d.slice(0,-1)):b=f[1]||f[5],b&&u.indexOf(b)===-1)return null;var v=f[2]?parseFloat(f[2]):0,S=f[3]?parseFloat(f[3])/60:0,E=f[4]?parseFloat(f[4])/3600:0,P=v<0?-1:1;return(b==="S"||b==="W")&&(P*=-1),{val:(Math.abs(v)+S+E)*P,dim:b,matched:d,remain:o.slice(d.length)}}function a(o,u){o=o.trim();var h=i(o,u);if(!h)return null;o=h.remain.trim();var f=i(o,u);return!f||f.remain?null:h.dim?s(h.val,f.val,h.dim):[h.val,f.val]}function s(o,u,h){if(h==="N"||h==="S")return[o,u];if(h==="W"||h==="E")return[u,o]}return Ng.exports}var gI,n$;function cke(){if(n$)return gI;n$=1;var t=lke,e=uke(),r=/(Lat)(itude)?/gi,n=/(L)(on|ng)(gitude)?/i;function i(P,k){var L,N,M;for(var z in P)N=z.match(k),N&&(!L||N[0].length/z.length>M)&&(M=N[0].length/z.length,L=z);return L}function a(P){return i(P,r)}function s(P){return i(P,n)}function o(P){return!!P.match(r)}function u(P){return!!P.match(n)}function h(P){return typeof P=="object"?Object.keys(P).length:0}function f(P){var k=[",",";","	","|"],L=[];return k.forEach(function(N){var M=t.dsvFormat(N).parse(P);if(M.length>=1){for(var z=h(M[0]),B=0;B<M.length;B++)if(h(M[B])!==z)return;L.push({delimiter:N,arity:Object.keys(M[0]).length})}}),L.length?L.sort(function(N,M){return M.arity-N.arity})[0].delimiter:null}function d(P){return delete P.columns,P}function b(P){var k=f(P);return k?d(t.dsvFormat(k).parse(P)):null}function v(P,k,L){L||(L=k,k={}),k.delimiter=k.delimiter||",";var N=k.latfield||"",M=k.lonfield||"",z=k.crs||"",B=[],q={type:"FeatureCollection",features:B};if(z!==""&&(q.crs={type:"name",properties:{name:z}}),k.delimiter==="auto"&&typeof P=="string"&&(k.delimiter=f(P),!k.delimiter)){L({type:"Error",message:"Could not autodetect delimiter"});return}var W=k.numericFields?k.numericFields.split(","):null,G=typeof P=="string"?t.dsvFormat(k.delimiter).parse(P,function(me){if(W)for(var Ee in me)W.includes(Ee)&&(me[Ee]=+me[Ee]);return me}):P;if(!G.length){L(null,q);return}var ie=[],J;N||(N=a(G[0])),M||(M=s(G[0]));var H=!N||!M;if(H){for(J=0;J<G.length;J++)B.push({type:"Feature",properties:G[J],geometry:null});L(ie.length?ie:null,q);return}for(J=0;J<G.length;J++)if(G[J][M]!==void 0&&G[J][N]!==void 0){var ne=G[J][M],ae=G[J][N],ue,de,Pe;Pe=e(ne,"EW"),Pe&&(ne=Pe),Pe=e(ae,"NS"),Pe&&(ae=Pe),ue=parseFloat(ne),de=parseFloat(ae),isNaN(ue)||isNaN(de)?ie.push({message:"A row contained an invalid value for latitude or longitude",row:G[J],index:J}):(k.includeLatLon||(delete G[J][M],delete G[J][N]),B.push({type:"Feature",properties:G[J],geometry:{type:"Point",coordinates:[parseFloat(ue),parseFloat(de)]}}))}L(ie.length?ie:null,q)}function S(P){for(var k=P.features,L={type:"Feature",geometry:{type:"LineString",coordinates:[]}},N=0;N<k.length;N++)L.geometry.coordinates.push(k[N].geometry.coordinates);return L.properties=k.reduce(function(M,z){for(var B in z.properties)M[B]||(M[B]=[]),M[B].push(z.properties[B]);return M},{}),{type:"FeatureCollection",features:[L]}}function E(P){for(var k=P.features,L={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},N=0;N<k.length;N++)L.geometry.coordinates[0].push(k[N].geometry.coordinates);return L.properties=k.reduce(function(M,z){for(var B in z.properties)M[B]||(M[B]=[]),M[B].push(z.properties[B]);return M},{}),{type:"FeatureCollection",features:[L]}}return gI={isLon:u,isLat:o,guessLatHeader:a,guessLonHeader:s,csv:t.csvParse,tsv:t.tsvParse,dsv:t,auto:b,csv2geojson:v,toLine:S,toPolygon:E},gI}var hke=cke();function VT(t){const e=t.split("?"),r=e[0].split("://"),n=r[0],s=(r.length>2?r[1]+"://"+r[2]:r[1]).split("/").join("/"),o=decodeURI(e[1]),u=Object.fromEntries(new URLSearchParams(o));return{protocolId:n,filename:s,options:u}}async function $T(t){try{return await(await fetch(t)).text()}catch(e){return console.error("File could not be loaded: ",e),e}}async function fke(t,e){return await new Promise((n,i)=>{const a=e||{};t.substring(t.length-3)==="tsv"&&(e.delimiter="	"),$T(t).then(o=>{hke.csv2geojson(o,a,(u,h)=>{u?i(u):n(h)})})})}const dke=async t=>{const e=VT(t.url),r=await fke(e.filename,e.options);if(r!==void 0)return{data:r};throw new Error("CSV not found "+e.filename)};var nc={},i$;function hx(){if(i$)return nc;i$=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.purgeProps=t,nc.first=e,nc.last=r,nc.coordsToKey=n,nc.addToMap=i,nc.removeFromMap=a,nc.getFirstFromMap=s,nc.isRing=o,nc.ringDirection=u,nc.pointInsidePolygon=h,nc.strArrayArrayToFloat=f,nc.strArrayToFloat=d;function t(b,v){if(b){const S=Object.assign({},b);if(v)for(const E of v)delete S[E];return S}return{}}function e(b){return b[0]}function r(b){return b[b.length-1]}function n(b){return b.join(",")}function i(b,v,S){const E=b[v];E?E.push(S):b[v]=[S]}function a(b,v,S){const E=b[v];let P=-1;E&&(P=E.indexOf(S)),P>=0&&E.splice(P,1)}function s(b,v){const S=b[v];return S&&S.length>0?S[0]:null}function o(b){return b.length>3&&n(e(b))===n(r(b))}function u(b,v,S){v=v||0,S=S||1;const E=b.reduce((G,ie,J)=>b[G][v||0]>ie[v||0]?G:J,0),P=E<=0?b.length-2:E-1,k=E>=b.length-1?1:E+1,L=b[P][v],N=b[E][v],M=b[k][v],z=b[P][S],B=b[E][S],q=b[k][S];return(N-L)*(q-z)-(M-L)*(B-z)<0?"clockwise":"counterclockwise"}function h(b,v,S,E){S=S||0,E=E||1;let P=!1;for(let k=0,L=v.length-1;k<v.length;L=k++)(v[k][S]<=b[S]&&b[S]<v[L][S]||v[L][S]<=b[S]&&b[S]<v[k][S])&&b[E]<(v[L][E]-v[k][E])*(b[S]-v[k][S])/(v[L][S]-v[k][S])+v[k][E]&&(P=!P);return P}function f(b){return b.map(d)}function d(b){return b.map(parseFloat)}return nc}var P_={},a$;function pke(){if(a$)return P_;a$=1,Object.defineProperty(P_,"__esModule",{value:!0}),P_.XmlParser=void 0;function t(i){return i.match(/^(.+?)\[(.+?)\]>$/g)!==null}function e(i){const a=/^(.+?)\[(.+?)\]>$/g.exec(i);return a?{evt:a[1]+">",exp:a[2]}:{evt:i}}function r(i){const a="return "+i.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",a)}class n{constructor(a){this.queryParent=!1,this.progressive=!1,this.parentMap=new WeakMap,a&&(this.queryParent=!!a.queryParent,this.progressive=a.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(a,s,o){o=o?o+".":"";const u=/<([^ >\/]+)(.*?)>/mg,h=[];let f=u.exec(a);for(;f;){const d=f[1],b={$tag:d},v=o+d,S=f[2].trim();let E=!1;(S.endsWith("/")||d.startsWith("?")||d.startsWith("!"))&&(E=!0);const P=/([^ ]+?)="(.+?)"/g,k=/([^ ]+?)='(.+?)'/g;let L=P.exec(S),N=!1;for(;L;)N=!0,b[L[1]]=L[2],L=P.exec(S);if(!N)for(L=k.exec(S);L;)N=!0,b[L[1]]=L[2],L=k.exec(S);if(!N&&S!==""&&(b.text=S),this.progressive&&this.emit(`<${v}>`,b,s),!E){const M=new RegExp(`([^]+?)</${d}>`,"g");M.lastIndex=u.lastIndex;const z=M.exec(a);if(z&&z[1]){u.lastIndex=M.lastIndex;const B=this.parse(z[1],b,v);B.length>0?b.$innerNodes=B:b.$innerText=z[1]}}this.queryParent&&s&&this.parentMap.set(b,s),this.progressive&&this.emit(`</${v}>`,b,s),h.push(b),f=u.exec(a)}return h}getParent(a){return this.queryParent?this.parentMap.get(a):null}addListener(a,s){if(t(a)){const o=e(a);o.exp&&(s.condition=r(o.exp)),a=o.evt}this.$addListener(a,s)}removeListener(a,s){t(a)&&(a=e(a).evt),this.$removeListener(a,s)}on(a,s){this.addListener(a,s)}off(a,s){this.removeListener(a,s)}$addListener(a,s){const o=this.evtListeners[a];o?o.push(s):this.evtListeners[a]=[s]}$removeListener(a,s){const o=this.evtListeners[a];let u=-1;o&&(u=o.indexOf(s)),u>=0&&o.splice(u,1)}emit(a,...s){const o=this.evtListeners[a];if(o)for(const u of o)u.condition?u.condition.apply(null,s)===!0&&u.apply(null,s):u.apply(null,s)}}return P_.XmlParser=n,P_}var k_={},M_={},o$;function oL(){if(o$)return M_;o$=1,Object.defineProperty(M_,"__esModule",{value:!0}),M_.OsmObject=void 0;class t{constructor(r,n,i){this.type=r,this.id=n,this.refElems=i,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,i&&i.add(this.getCompositeId(),this)}addTags(r){this.tags=Object.assign(this.tags,r),this.hasTag=!0}addTag(r,n){this.tags[r]=n,this.hasTag=!0}addProp(r,n){this.props[r]=n}addProps(r){this.props=Object.assign(this.props,r)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}}return M_.OsmObject=t,M_}var s$;function NJ(){if(s$)return k_;s$=1,Object.defineProperty(k_,"__esModule",{value:!0}),k_.Node=void 0;const t=oL(),e=hx();class r extends t.OsmObject{constructor(i,a){super("node",i,a)}setLatLng(i){this.latLng=i}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:(0,e.strArrayToFloat)([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}return k_.Node=r,k_}var Lg={},R_={},l$;function LJ(){if(l$)return R_;l$=1,Object.defineProperty(R_,"__esModule",{value:!0}),R_.LateBinder=void 0;class t{constructor(r,n,i,a){this.container=r,this.valueFunc=n,this.ctx=i,this.args=a}bind(){const r=this.valueFunc.apply(this.ctx,this.args),n=this.container.indexOf(this);if(n<0)return;const i=[n,1];r&&i.push(r),Array.prototype.splice.apply(this.container,i)}}return R_.LateBinder=t,R_}const gke={},mke={whitelist:["services","rest_area","escape","elevator"]},yke={blacklist:["coastline","cliff","ridge","arete","tree_row"]},vke={},_ke={whitelist:["riverbank","dock","boatyard","dam"]},bke={},xke={},wke={whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},Ske={whitelist:["station","turntable","roundhouse","platform"]},Eke={},Tke={},Cke={blacklist:["cutline","embankment","pipeline"]},Ake={whitelist:["plant","substation","generator","transformer"]},Ike={},Pke={},kke={blacklist:["taxiway"]},Mke={},Rke={},Oke={},Nke={},Lke={},Dke={},Fke={},Bke={},zke={},jke={building:gke,highway:mke,natural:yke,landuse:vke,waterway:_ke,amenity:bke,leisure:xke,barrier:wke,railway:Ske,area:Eke,boundary:Tke,man_made:Cke,power:Ake,place:Ike,shop:Pke,aeroway:kke,tourism:Mke,historic:Rke,public_transport:Oke,office:Nke,"building:part":{},military:Lke,ruins:Dke,"area:highway":{},craft:Fke,golf:Bke,indoor:zke};var u$;function DJ(){if(u$)return Lg;u$=1;var t=Lg&&Lg.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.Way=void 0;const e=oL(),r=LJ(),n=hx(),i=t(jke);class a extends e.OsmObject{constructor(o,u){super("way",o,u),this.latLngArray=[],this.isPolygon=!1}addLatLng(o){this.latLngArray.push(o)}setLatLngArray(o){this.latLngArray=o}addNodeRef(o){const u=new r.LateBinder(this.latLngArray,h=>{const f=this.refElems.get(`node/${h}`);if(f)return f.refCount++,f.getLatLng()},this,[o]);this.latLngArray.push(u),this.refElems.addBinder(u)}addTags(o){super.addTags(o);for(const[u,h]of Object.entries(o))this.analyzeTag(u,h)}addTag(o,u){super.addTag(o,u),this.analyzeTag(o,u)}toCoordsArray(){return this.latLngArray.map(o=>[o.lon,o.lat])}toFeatureArray(){let o=this.toCoordsArray();if(o.length>1){const u=(0,n.strArrayArrayToFloat)(o),h={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:u}};return this.isPolygon&&(0,n.isRing)(u)?((0,n.ringDirection)(u)!=="counterclockwise"&&u.reverse(),h.geometry={type:"Polygon",coordinates:[u]},[h]):[h]}return[]}analyzeTag(o,u){const h=i.default[o];h&&(this.isPolygon=!0,h.whitelist?this.isPolygon=h.whitelist.indexOf(u)>=0:h.blacklist&&(this.isPolygon=!(h.blacklist.indexOf(u)>=0)))}}return Lg.Way=a,Lg}var O_={},N_={},c$;function Uke(){if(c$)return N_;c$=1,Object.defineProperty(N_,"__esModule",{value:!0}),N_.WayCollection=void 0;const t=hx();class e extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(n){const i=n.toCoordsArray();i.length>0&&(this.push(i),(0,t.addToMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.addToMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i))}mergeWays(){const n=[];let i=this.shift();for(;i;){(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i);let a=i,s;do{let o=this.getNextWay(a);s=o.next;let u=o.mergeType;if(s)switch(this.splice(this.indexOf(s),1),(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(s)),s),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(s)),s),u){case 0:a=a.concat(s.slice(1));break;case 1:s.reverse(),a=a.concat(s.slice(1));break;case 2:a.reverse(),a=a.concat(s.slice(1));break;case 3:a=s.concat(a.slice(1));break}}while(s);n.push((0,t.strArrayArrayToFloat)(a)),i=this.shift()}return n}getNextWay(n){const i=(0,t.coordsToKey)((0,t.last)(n)),a=(0,t.coordsToKey)((0,t.first)(n));let s=this.length>0?this[0]:null;if(s){const o=(0,t.coordsToKey)((0,t.first)(s)),u=(0,t.coordsToKey)((0,t.last)(s));if(i===o)return{next:s,mergeType:0};if(i===u)return{next:s,mergeType:1};if(a===o)return{next:s,mergeType:2};if(a===u)return{next:s,mergeType:3}}return s=(0,t.getFirstFromMap)(this.firstMap,i),s?{next:s,mergeType:0}:(s=(0,t.getFirstFromMap)(this.lastMap,i),{next:s,mergeType:1})}toRings(n){const i=this.mergeWays(),a=[];let s=i.shift();for(;s;)(0,t.isRing)(s)&&((0,t.ringDirection)(s)!==n&&s.reverse(),a.push(s)),s=i.shift();return a}}return N_.WayCollection=e,N_}var h$;function Vke(){if(h$)return O_;h$=1,Object.defineProperty(O_,"__esModule",{value:!0}),O_.Relation=void 0;const t=oL(),e=DJ(),r=NJ(),n=Uke(),i=LJ(),a=hx();class s extends t.OsmObject{constructor(u,h){super("relation",u,h),this.relations=[],this.nodes=[],this.bounds=void 0,this.ways=[],this.roles=[]}setBounds(u){this.bounds=u}addMember(u){switch(u.type){case"relation":let h=new i.LateBinder(this.relations,d=>{const b=this.refElems.get(`relation/${d}`);if(b)return b.refCount++,b},this,[u.ref]);this.relations.push(h),this.refElems.addBinder(h);break;case"way":if(u.role||(u.role=""),u.geometry){const d=new e.Way(u.ref,this.refElems);d.setLatLngArray(u.geometry),d.refCount++,this.ways.push(d),this.roles.push(u.role)}else if(u.nodes){const d=new e.Way(u.ref,this.refElems);for(const b of u.nodes)d.addNodeRef(b);d.refCount++,this.ways.push(d),this.roles.push(u.role)}else{let d=new i.LateBinder(this.ways,b=>{const v=this.refElems.get(`way/${b}`);if(v)return v.refCount++,v},this,[u.ref]);this.ways.push(d),this.roles.push(u.role),this.refElems.addBinder(d)}break;case"node":let f=null;if(u.lat&&u.lon){f=new r.Node(u.ref,this.refElems),f.setLatLng({lon:u.lon,lat:u.lat}),u.tags&&f.addTags(u.tags);for(const[d,b]of Object.entries(u))["id","type","lat","lon"].indexOf(d)<0&&f.addProp(d,b);f.refCount++,this.nodes.push(f)}else{let d=new i.LateBinder(this.nodes,b=>{const v=this.refElems.get(`node/${b}`);if(v)return v.refCount++,v},this,[u.ref]);this.nodes.push(d),this.refElems.addBinder(d)}break}}constructStringGeometry(u){const h=u?u.mergeWays():[];return h.length===0?null:{type:"MultiLineString",coordinates:h}}constructPolygonGeometry(u,h){const f=u?u.toRings("counterclockwise"):[],d=h?h.toRings("clockwise"):[];if(f.length>0){const b=[];let v;for(v of f)b.push([v]);for(v=d.shift();v;){for(const S in f)if((0,a.pointInsidePolygon)((0,a.first)(v),f[S])){b[S].push(v);break}v=d.shift()}return b.length===1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}return null}toFeatureArray(){const u=[],h=[];let f=[];for(const b of this.relations)if(b)for(let v=0;v<b.ways.length;v++){const S=b.ways[v];this.ways.push(S),this.roles.push(b.roles[v])}let d={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps(),geometry:null};if(this.bounds||delete d.bbox,this.roles.some(b=>b==="outer")){const b=new n.WayCollection,v=new n.WayCollection;for(let P=0;P<this.ways.length;P++){const k=this.ways[P],L=this.roles[P];L==="outer"?b.addWay(k):L==="inner"&&v.addWay(k)}let S=Object.assign({},d),E=this.constructPolygonGeometry(b,v);E&&(S.geometry=E,u.push(S))}else{const b=new n.WayCollection;for(let S of this.ways)b.addWay(S);let v=this.constructStringGeometry(b);if(v){let S=Object.assign({},d);S.geometry=v,h.push(S)}}for(let b of this.nodes)f=f.concat(b.toFeatureArray());return[...u,...h,...f]}}return O_.Relation=s,O_}var L_={},f$;function $ke(){if(f$)return L_;f$=1,Object.defineProperty(L_,"__esModule",{value:!0}),L_.RefElements=void 0;class t extends Map{constructor(){super(),this.binders=[]}add(r,n){this.set(r,n)}addBinder(r){this.binders.push(r)}bindAll(){this.binders.forEach(r=>r.bind())}}return L_.RefElements=t,L_}var mI,d$;function qke(){if(d$)return mI;d$=1;const t=hx(),e=pke(),r=NJ(),n=DJ(),i=Vke(),a=$ke();function s(d){if(!d)return{completeFeature:!1,renderTagged:!1,excludeWay:!0};let b=d.excludeWay===void 0||d.excludeWay,v=!!d.completeFeature,S=!!d.renderTagged;return{completeFeature:v,renderTagged:S,excludeWay:b}}function o(d){return d.elements?"json":d.indexOf("<osm")>=0?"xml":d.trim().startsWith("{")?"json-raw":"invalid"}function u(d,b){for(const v of d.elements)switch(v.type){case"node":const S=new r.Node(v.id,b);v.tags&&S.addTags(v.tags),S.addProps((0,t.purgeProps)(v,["id","type","tags","lat","lon"])),S.setLatLng(v);break;case"way":const E=new n.Way(v.id,b);if(v.tags&&E.addTags(v.tags),E.addProps((0,t.purgeProps)(v,["id","type","tags","nodes","geometry"])),v.geometry)E.setLatLngArray(v.geometry);else if(v.nodes)for(const k of v.nodes)E.addNodeRef(k);break;case"relation":const P=new i.Relation(v.id,b);if(v.bounds&&P.setBounds([parseFloat(v.bounds.minlon),parseFloat(v.bounds.minlat),parseFloat(v.bounds.maxlon),parseFloat(v.bounds.maxlat)]),v.tags&&P.addTags(v.tags),P.addProps((0,t.purgeProps)(v,["id","type","tags","bounds","members"])),v.members)for(const k of v.members)P.addMember(k)}}function h(d,b){const v=new e.XmlParser({progressive:!0});v.on("</osm.node>",S=>{const E=new r.Node(S.id,b);for(const[P,k]of Object.entries(S))!P.startsWith("$")&&["id","lon","lat"].indexOf(P)<0&&E.addProp(P,k);if(E.setLatLng(S),S.$innerNodes)for(const P of S.$innerNodes)P.$tag==="tag"&&E.addTag(P.k,P.v)}),v.on("</osm.way>",S=>{const E=new n.Way(S.id,b);for(const[P,k]of Object.entries(S))!P.startsWith("$")&&["id"].indexOf(P)<0&&E.addProp(P,k);if(S.$innerNodes)for(const P of S.$innerNodes)P.$tag==="nd"?P.lon&&P.lat?E.addLatLng(P):P.ref&&E.addNodeRef(P.ref):P.$tag==="tag"&&E.addTag(P.k,P.v)}),v.on("<osm.relation>",S=>new i.Relation(S.id,b)),v.on("</osm.relation.member>",(S,E)=>{const P=b.get(`relation/${E?.id}`),k={type:S.type,role:S.role?S.role:"",ref:S.ref};if(S.lat&&S.lon){k.lat=S.lat,k.lon=S.lon,k.tags={};for(const[L,N]of Object.entries(S))!L.startsWith("$")&&["type","lat","lon"].indexOf(L)<0&&(k[L]=N)}if(S.$innerNodes){const L=[],N=[];for(const M of S.$innerNodes)M.lat&&M.lon?L.push(M):M.ref&&N.push(M.ref);L.length>0?k.geometry=L:N.length>0&&(k.nodes=N)}P.addMember(k)}),v.on("</osm.relation.bounds>",(S,E)=>{b.get(`relation/${E?.id}`).setBounds([parseFloat(S.minlon),parseFloat(S.minlat),parseFloat(S.maxlon),parseFloat(S.maxlat)])}),v.on("</osm.relation.tag>",(S,E)=>{b.get(`relation/${E?.id}`).addTag(S.k,S.v)}),v.parse(d)}function f(d,b){let{completeFeature:v,renderTagged:S,excludeWay:E}=s(b),P=o(d);const k=new a.RefElements;let L=[];P==="json-raw"&&(d=JSON.parse(d),d.elements?P="json":P="invalid"),P==="json"?u(d,k):P==="xml"&&h(d,k),k.bindAll();for(const N of k.values()){if(N.refCount>0&&(!N.hasTag||!S||N instanceof n.Way&&E))continue;const M=N.toFeatureArray();if(N instanceof i.Relation&&!v&&M.length>0)return M[0].geometry;L=L.concat(M)}return{type:"FeatureCollection",features:L}}return mI=f,mI}var Hke=qke();const Wke=ad(Hke);async function Gke(t){const e=t.options||{};return await new Promise((n,i)=>{$T(t.filename).then(a=>{const s=Wke(a,e);s?n(s):i("Conversion failed")})})}const Xke=async t=>{const e=VT(t.url),r=await Gke(e);if(r!==void 0)return{data:r};throw new Error("OSM File not found "+e.filename)};function Yke(t){const e=[];return t.features.forEach(r=>{r.features?r.features.forEach(n=>{e.push({type:n.type,geometry:n.geometry,properties:n.properties})}):e.push({type:r.type,geometry:r.geometry,properties:r.properties})}),e}async function Zke(t){return await new Promise(r=>{let n={type:"Topology",objects:{key:""},arcs:[]};$T(t.filename).then(i=>{try{n=JSON.parse(i)}catch(s){throw console.error("Error converting topojson",s),"Invalid TopoJson"}let a={type:"FeatureCollection",features:[]};if(n.type==="Topology"&&n.objects!==void 0){const s=n.objects;Object.keys(n.objects).map(o=>{s?.[o].type==="GeometryCollection"?s?.[o].geometries?.forEach(u=>u.properties={fromObject:o,...u.properties}):s?.[o]&&s?.[o]?.type!=="GeometryCollection"&&(s[o].properties={fromObject:o,...s?.[o].properties})}),a={type:"FeatureCollection",features:Object.keys(n.objects).map(o=>Kxe(n,o))},a.features=Yke(a)}r(a)})})}const Kke=async t=>{const e=VT(t.url),r=await Zke(e);if(r!==void 0)return{data:r};throw new Error("Topojson not found "+e.filename)};function Hs(t,e){return Array.from(t.getElementsByTagName(e))}function qS(t){return t[0]==="#"?t:`#${t}`}function Jke(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function xs(t){return t?.normalize(),t?.textContent||""}function Xo(t,e,r){const n=t.getElementsByTagName(e),i=n.length?n[0]:null;return i&&r&&r(i),i}function sh(t,e,r){const n={};if(!t)return n;const i=t.getElementsByTagName(e),a=i.length?i[0]:null;return a&&r?r(a,n):n}function Tm(t,e,r){const n=xs(Xo(t,e));return n&&r?r(n)||{}:{}}function p$(t,e,r){const n=Number.parseFloat(xs(Xo(t,e)));if(!Number.isNaN(n))return n&&r?r(n)||{}:{}}function yu(t,e,r){const n=Number.parseFloat(xs(Xo(t,e)));if(!Number.isNaN(n))return r&&r(n),n}function Cm(t,e){const r={};for(const n of e)Tm(t,n,i=>{r[n]=i});return r}function fx(t){return t?.nodeType===1}function FJ(t){let e=[];if(t===null)return e;for(const r of Array.from(t.childNodes)){if(!fx(r))continue;const n=Qke(r.nodeName);if(n==="gpxtpx:TrackPointExtension")e=e.concat(FJ(r));else{const i=xs(r);e.push([n,eMe(i)])}}return e}function Qke(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function eMe(t){const e=Number.parseFloat(t);return Number.isNaN(e)?t:e}function BJ(t){const e=[Number.parseFloat(t.getAttribute("lon")||""),Number.parseFloat(t.getAttribute("lat")||"")];if(Number.isNaN(e[0])||Number.isNaN(e[1]))return null;yu(t,"ele",n=>{e.push(n)});const r=Xo(t,"time");return{coordinates:e,time:r?xs(r):null,extendedValues:FJ(Xo(t,"extensions"))}}function zJ(t){return sh(t,"line",e=>Object.assign({},Tm(e,"color",n=>({stroke:`#${n}`})),p$(e,"opacity",n=>({"stroke-opacity":n})),p$(e,"width",n=>({"stroke-width":n*96/25.4}))))}function sL(t,e){const r=Cm(e,["name","cmt","desc","type","time","keywords"]);for(const[i,a]of t)for(const s of Array.from(e.getElementsByTagNameNS(a,"*")))r[s.tagName.replace(":","_")]=xs(s)?.trim();const n=Hs(e,"link");return n.length&&(r.links=n.map(i=>Object.assign({href:i.getAttribute("href")},Cm(i,["text","type"])))),r}function jJ(t,e){const r=Hs(t,e),n=[],i=[],a={};for(let s=0;s<r.length;s++){const o=BJ(r[s]);if(o){n.push(o.coordinates),o.time&&i.push(o.time);for(const[u,h]of o.extendedValues){const f=u==="heart"?u:`${u.replace("gpxtpx:","")}s`;a[f]||(a[f]=Array(r.length).fill(null)),a[f][s]=h}}}if(!(n.length<2))return{line:n,times:i,extendedValues:a}}function tMe(t,e){const r=jJ(e,"rtept");if(r)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},sL(t,e),zJ(Xo(e,"extensions"))),geometry:{type:"LineString",coordinates:r.line}}}function rMe(t,e){const r=Hs(e,"trkseg"),n=[],i=[],a=[];for(const u of r){const h=jJ(u,"trkpt");h&&(a.push(h),h.times?.length&&i.push(h.times))}if(a.length===0)return null;const s=a.length>1,o=Object.assign({_gpxType:"trk"},sL(t,e),zJ(Xo(e,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let u=0;u<a.length;u++){const h=a[u];n.push(h.line),o.coordinateProperties||(o.coordinateProperties={});const f=o.coordinateProperties;for(const[d,b]of Object.entries(h.extendedValues))s?(f[d]||(f[d]=a.map(v=>new Array(v.line.length).fill(null))),f[d][u]=b):f[d]=b}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function nMe(t,e){const r=Object.assign(sL(t,e),Cm(e,["sym"])),n=BJ(e);return n?{type:"Feature",properties:r,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*UJ(t){const e=t,r="gpxx",n="http://www.garmin.com/xmlschemas/GpxExtensions/v3",i=[[r,n]],a=e.getElementsByTagName("gpx")[0]?.attributes;if(a)for(const s of Array.from(a))s.name?.startsWith("xmlns:")&&s.value!==n&&i.push([s.name,s.value]);for(const s of Hs(e,"trk")){const o=rMe(i,s);o&&(yield o)}for(const s of Hs(e,"rte")){const o=tMe(i,s);o&&(yield o)}for(const s of Hs(e,"wpt")){const o=nMe(i,s);o&&(yield o)}}function iMe(t){return{type:"FeatureCollection",features:Array.from(UJ(t))}}const aMe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",oMe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],sMe=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function VJ(t,e){const r=[];for(const[n,i]of e){let a=Xo(t,n);if(!a){const o=t.getElementsByTagNameNS(aMe,n);o.length&&(a=o[0])}const s=Number.parseFloat(xs(a));Number.isNaN(s)||r.push([i,s])}return r}function lMe(t){const e=[yu(t,"LongitudeDegrees"),yu(t,"LatitudeDegrees")];if(e[0]===void 0||Number.isNaN(e[0])||e[1]===void 0||Number.isNaN(e[1]))return null;const r=Xo(t,"HeartRateBpm"),n=xs(Xo(t,"Time"));return Xo(t,"AltitudeMeters",i=>{const a=Number.parseFloat(xs(i));Number.isNaN(a)||e.push(a)}),{coordinates:e,time:n||null,heartRate:r?Number.parseFloat(xs(r)):null,extensions:VJ(t,oMe)}}function uMe(t){const e=Hs(t,"Trackpoint"),r=[],n=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let o=0;o<e.length;o++){const u=lMe(e[o]);if(u===null)continue;r.push(u.coordinates);const{time:h,heartRate:f,extensions:d}=u;h&&n.push(h),f&&i.push(f);for(const[b,v]of d)a[b]||(a[b]=Array(e.length).fill(null)),a[b][o]=v}return r.length<2?null:Object.assign(s,{line:r,times:n,heartRates:i})}function g$(t){const e=Hs(t,"Track"),r=[],n=[],i=[],a=[];let s;const o=Object.assign(Object.fromEntries(VJ(t,sMe)),sh(t,"Name",u=>({name:xs(u)})));for(const u of e)s=uMe(u),s&&(r.push(s.line),s.times.length&&n.push(s.times),s.heartRates.length&&i.push(s.heartRates),a.push(s.extendedProperties));for(let u=0;u<a.length;u++){const h=a[u];for(const f in h)e.length===1?s&&(o[f]=s.extendedProperties[f]):(o[f]||(o[f]=r.map(d=>Array(d.length).fill(null))),o[f][u]=h[f])}return r.length===0?null:((n.length||i.length)&&(o.coordinateProperties=Object.assign(n.length?{times:r.length===1?n[0]:n}:{},i.length?{heart:r.length===1?i[0]:i}:{})),{type:"Feature",properties:o,geometry:r.length===1?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*$J(t){for(const e of Hs(t,"Lap")){const r=g$(e);r&&(yield r)}for(const e of Hs(t,"Courses")){const r=g$(e);r&&(yield r)}}function cMe(t){return{type:"FeatureCollection",features:Array.from($J(t))}}function qJ(t,e){const r={},n=e==="stroke"||e==="fill"?e:`${e}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[n]=`#${t}`:t.length===8&&(r[`${e}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,r[n]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),r}function HS(t,e,r){const n={};return yu(t,e,i=>{n[r]=i}),n}function lL(t,e){return sh(t,"color",r=>qJ(xs(r),e))}function uL(t){return sh(t,"Icon",(e,r)=>(Tm(e,"href",n=>{r.icon=n}),r))}function hMe(t){return sh(t,"IconStyle",e=>Object.assign(lL(e,"icon"),HS(e,"scale","icon-scale"),HS(e,"heading","icon-heading"),sh(e,"hotSpot",r=>{const n=Number.parseFloat(r.getAttribute("x")||""),i=Number.parseFloat(r.getAttribute("y")||""),a=r.getAttribute("xunits")||"",s=r.getAttribute("yunits")||"";return!Number.isNaN(n)&&!Number.isNaN(i)?{"icon-offset":[n,i],"icon-offset-units":[a,s]}:{}}),uL(e)))}function fMe(t){return sh(t,"LabelStyle",e=>Object.assign(lL(e,"label"),HS(e,"scale","label-scale")))}function dMe(t){return sh(t,"LineStyle",e=>Object.assign(lL(e,"stroke"),HS(e,"width","stroke-width")))}function pMe(t){return sh(t,"PolyStyle",(e,r)=>Object.assign(r,sh(e,"color",n=>qJ(xs(n),"fill")),Tm(e,"fill",n=>{if(n==="0")return{"fill-opacity":0}}),Tm(e,"outline",n=>{if(n==="0")return{"stroke-opacity":0}})))}function qT(t){return Object.assign({},pMe(t),dMe(t),fMe(t),hMe(t))}const gMe=/\s*/g,mMe=/^\s*|\s*$/g,yMe=/\s+/;function HJ(t){return t.replace(gMe,"").split(",").map(Number.parseFloat).filter(e=>!Number.isNaN(e)).slice(0,3)}function dM(t){return t.replace(mMe,"").split(yMe).map(HJ).filter(e=>e.length>=2)}function vMe(t){let e=Hs(t,"coord");e.length===0&&(e=Jke(t,"coord","*"));const r=e.map(n=>xs(n).split(" ").map(Number.parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:Hs(t,"when").map(n=>xs(n))}}function WJ(t){if(t.length===0)return t;const e=t[0],r=t[t.length-1];let n=!0;for(let i=0;i<Math.max(e.length,r.length);i++)if(e[i]!==r[i]){n=!1;break}return n?t:t.concat([t[0]])}function Ew(t){return xs(Xo(t,"coordinates"))}function GJ(t){let e=[],r=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes.item(n);if(fx(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const a=GJ(i);e=e.concat(a.geometries),r=r.concat(a.coordTimes);break}case"Point":{const a=HJ(Ew(i));a.length>=2&&e.push({type:"Point",coordinates:a});break}case"LinearRing":case"LineString":{const a=dM(Ew(i));a.length>=2&&e.push({type:"LineString",coordinates:a});break}case"Polygon":{const a=[];for(const s of Hs(i,"LinearRing")){const o=WJ(dM(Ew(s)));o.length>=4&&a.push(o)}a.length&&e.push({type:"Polygon",coordinates:a});break}case"Track":case"gx:Track":{const a=vMe(i);if(!a)break;const{times:s,geometry:o}=a;e.push(o),s.length&&r.push(s);break}}}return{geometries:e,coordTimes:r}}const zy=t=>Number(t),pM={string:t=>t,int:zy,uint:zy,short:zy,ushort:zy,float:zy,double:zy,bool:t=>!!t};function cL(t,e){return sh(t,"ExtendedData",(r,n)=>{for(const i of Hs(r,"Data"))n[i.getAttribute("name")||""]=xs(Xo(i,"value"));for(const i of Hs(r,"SimpleData")){const a=i.getAttribute("name")||"",s=e[a]||pM.string;n[a]=s(xs(i))}return n})}function hL(t){const e=Xo(t,"description");for(const r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:xs(r)}};return{}}function fL(t){return sh(t,"TimeSpan",e=>({timespan:{begin:xs(Xo(e,"begin")),end:xs(Xo(e,"end"))}}))}function dL(t){return sh(t,"TimeStamp",e=>({timestamp:xs(Xo(e,"when"))}))}function pL(t,e){return Tm(t,"styleUrl",r=>(r=qS(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var hh;(function(t){t.ABSOLUTE="absolute",t.RELATIVE_TO_GROUND="relativeToGround",t.CLAMP_TO_GROUND="clampToGround",t.CLAMP_TO_SEAFLOOR="clampToSeaFloor",t.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(hh||(hh={}));function _Me(t){switch(t?.textContent){case hh.ABSOLUTE:return hh.ABSOLUTE;case hh.CLAMP_TO_GROUND:return hh.CLAMP_TO_GROUND;case hh.CLAMP_TO_SEAFLOOR:return hh.CLAMP_TO_SEAFLOOR;case hh.RELATIVE_TO_GROUND:return hh.RELATIVE_TO_GROUND;case hh.RELATIVE_TO_SEAFLOOR:return hh.RELATIVE_TO_SEAFLOOR}return null}function bMe(t){return Xo(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[WJ(dM(Ew(t)))]}}:SMe(t)}const xMe=Math.PI/180;function wMe(t,e,r){const n=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const a=i[1]-n[1],s=i[0]-n[0],o=Math.sqrt(a**2+s**2),u=Math.atan2(a,s)+r*xMe;return[n[0]+Math.cos(u)*o,n[1]+Math.sin(u)*o]})]}function SMe(t){const e=Xo(t,"LatLonBox");if(e){const r=yu(e,"north"),n=yu(e,"west"),i=yu(e,"east"),a=yu(e,"south"),s=yu(e,"rotation");if(typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number"){const o=[n,a,i,r];let u=[[[n,r],[i,r],[i,a],[n,a],[n,r]]];return typeof s=="number"&&(u=wMe(o,u,s)),{bbox:o,geometry:{type:"Polygon",coordinates:u}}}}return null}function XJ(t,e,r,n){const i=bMe(t),a=i?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},Cm(t,["name","address","visibility","open","phoneNumber","description"]),hL(t),pL(t,e),qT(t),uL(t),cL(t,r),fL(t),dL(t))};i?.bbox&&(s.bbox=i.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function EMe(t){const e=Xo(t,"Region");return e?{coordinateBox:CMe(e),lod:TMe(t)}:null}function TMe(t){const e=Xo(t,"Lod");return e?[yu(e,"minLodPixels")??-1,yu(e,"maxLodPixels")??-1,yu(e,"minFadeExtent")??null,yu(e,"maxFadeExtent")??null]:null}function CMe(t){const e=Xo(t,"LatLonAltBox");if(e){const r=yu(e,"north"),n=yu(e,"west"),i=yu(e,"east"),a=yu(e,"south");if(_Me(Xo(e,"altitudeMode")||Xo(e,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number")return{bbox:[n,a,i,r],geometry:{type:"Polygon",coordinates:[[[n,r],[i,r],[i,a],[n,a],[n,r]]]}}}return null}function AMe(t){const e=Xo(t,"Link");return e?Cm(e,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function YJ(t,e,r,n){const i=EMe(t),a=i?.coordinateBox?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"networklink"},Cm(t,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),hL(t),pL(t,e),qT(t),uL(t),cL(t,r),fL(t),dL(t),AMe(t),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(s.bbox=i.coordinateBox.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function IMe(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function ZJ(t,e,r,n){const{coordTimes:i,geometries:a}=GJ(t),s=IMe(a);if(!s&&n.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign(Cm(t,["name","address","visibility","open","phoneNumber","description"]),hL(t),pL(t,e),qT(t),cL(t,r),fL(t),dL(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};o.properties?.visibility!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const u=t.getAttribute("id");return u!==null&&u!==""&&(o.id=u),o}function PMe(t){let e=t.getAttribute("id");const r=t.parentNode;return!e&&fx(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),qS(e||"")}function KJ(t){const e={};for(const r of Hs(t,"Style"))e[PMe(r)]=qT(r);for(const r of Hs(t,"StyleMap")){const n=qS(r.getAttribute("id")||"");Tm(r,"styleUrl",i=>{i=qS(i),e[i]&&(e[n]=e[i])})}return e}function JJ(t){const e={};for(const r of Hs(t,"SimpleField"))e[r.getAttribute("name")||""]=pM[r.getAttribute("type")||""]||pM.string;return e}const kMe=["name","visibility","open","address","description","phoneNumber","visibility"];function MMe(t){const e={};for(const r of Array.from(t.childNodes))fx(r)&&kMe.includes(r.tagName)&&(e[r.tagName]=xs(r));return{type:"folder",meta:e,children:[]}}function RMe(t,e={skipNullGeometry:!1}){const r=t,n=KJ(r),i=JJ(r),a={type:"root",children:[]};function s(o,u,h){if(fx(o))switch(o.tagName){case"GroundOverlay":{const f=XJ(o,n,i,h);f&&u.children.push(f);break}case"Placemark":{const f=ZJ(o,n,i,h);f&&u.children.push(f);break}case"Folder":{const f=MMe(o);u.children.push(f),u=f;break}case"NetworkLink":{const f=YJ(o,n,i,h);f&&u.children.push(f);break}}if(o.childNodes)for(let f=0;f<o.childNodes.length;f++)s(o.childNodes[f],u,h)}return s(r,a,e),a}function*QJ(t,e={skipNullGeometry:!1}){const r=t,n=KJ(r),i=JJ(r);for(const a of Hs(r,"Placemark")){const s=ZJ(a,n,i,e);s&&(yield s)}for(const a of Hs(r,"GroundOverlay")){const s=XJ(a,n,i,e);s&&(yield s)}for(const a of Hs(r,"NetworkLink")){const s=YJ(a,n,i,e);s&&(yield s)}}function OMe(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(QJ(t,e))}}const NMe=Object.freeze(Object.defineProperty({__proto__:null,gpx:iMe,gpxGen:UJ,kml:OMe,kmlGen:QJ,kmlWithFolders:RMe,tcx:cMe,tcxGen:$J},Symbol.toStringTag,{value:"Module"}));async function LMe(t){return await new Promise((r,n)=>{$T(t.filename).then(i=>{const a=()=>t.protocolId==="tcx"?NMe[t.protocolId](new DOMParser().parseFromString(i,"text/xml")):EJ[t.protocolId](new DOMParser().parseFromString(i,"text/xml"));a()?r(a()):n("Conversion failed")})})}const yI=async t=>{const e=VT(t.url),r=await LMe(e);if(r!==void 0)return{data:r};throw new Error("XML not found "+e.filename)},gM=t=>{const e=pa({mapId:void 0}),r=ee.useRef(!1);ee.useEffect(()=>{if(!(!e.map||r.current))return e.map?.loadImage(t.imagePath).then(function(n){if(!n?.data){console.log("image "+t.imagePath+"could not be loaded");return}e.map?.addImage(t.imageId,n.data)}),()=>{e.map?.removeImage(t.imageId)}},[e.map,t])};gM.defaultProps={mapId:void 0};try{gM.displayName="useAddImage",gM.__docgenInfo={description:"",displayName:"useAddImage",props:{imageId:{defaultValue:null,description:"",name:"imageId",required:!0,type:{name:"string"}},imagePath:{defaultValue:null,description:"",name:"imagePath",required:!0,type:{name:"string"}}}}}catch{}const DMe=ht.createContext({}),mM=DMe.Provider;try{mM.displayName="SimpleDataContextProvider",mM.__docgenInfo={description:"",displayName:"SimpleDataContextProvider",props:{}}}catch{}var FMe={value:()=>{}};function eQ(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Tw(r)}function Tw(t){this._=t}function BMe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Tw.prototype=eQ.prototype={constructor:Tw,on:function(t,e){var r=this._,n=BMe(t+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(t=n[a]).type)&&(i=zMe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=n[a]).type)r[i]=m$(r[i],t.name,e);else if(e==null)for(i in r)r[i]=m$(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Tw(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,i=a.length;n<i;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};function zMe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function m$(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=FMe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var yM="http://www.w3.org/1999/xhtml";const y$={svg:"http://www.w3.org/2000/svg",xhtml:yM,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function HT(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),y$.hasOwnProperty(e)?{space:y$[e],local:t}:t}function jMe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===yM&&e.documentElement.namespaceURI===yM?e.createElement(t):e.createElementNS(r,t)}}function UMe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tQ(t){var e=HT(t);return(e.local?UMe:jMe)(e)}function VMe(){}function gL(t){return t==null?VMe:function(){return this.querySelector(t)}}function $Me(t){typeof t!="function"&&(t=gL(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=new Array(s),u,h,f=0;f<s;++f)(u=a[f])&&(h=t.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),o[f]=h);return new cf(n,this._parents)}function qMe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function HMe(){return[]}function rQ(t){return t==null?HMe:function(){return this.querySelectorAll(t)}}function WMe(t){return function(){return qMe(t.apply(this,arguments))}}function GMe(t){typeof t=="function"?t=WMe(t):t=rQ(t);for(var e=this._groups,r=e.length,n=[],i=[],a=0;a<r;++a)for(var s=e[a],o=s.length,u,h=0;h<o;++h)(u=s[h])&&(n.push(t.call(u,u.__data__,h,s)),i.push(u));return new cf(n,i)}function nQ(t){return function(){return this.matches(t)}}function iQ(t){return function(e){return e.matches(t)}}var XMe=Array.prototype.find;function YMe(t){return function(){return XMe.call(this.children,t)}}function ZMe(){return this.firstElementChild}function KMe(t){return this.select(t==null?ZMe:YMe(typeof t=="function"?t:iQ(t)))}var JMe=Array.prototype.filter;function QMe(){return Array.from(this.children)}function eRe(t){return function(){return JMe.call(this.children,t)}}function tRe(t){return this.selectAll(t==null?QMe:eRe(typeof t=="function"?t:iQ(t)))}function rRe(t){typeof t!="function"&&(t=nQ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],u,h=0;h<s;++h)(u=a[h])&&t.call(u,u.__data__,h,a)&&o.push(u);return new cf(n,this._parents)}function aQ(t){return new Array(t.length)}function nRe(){return new cf(this._enter||this._groups.map(aQ),this._parents)}function WS(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}WS.prototype={constructor:WS,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function iRe(t){return function(){return t}}function aRe(t,e,r,n,i,a){for(var s=0,o,u=e.length,h=a.length;s<h;++s)(o=e[s])?(o.__data__=a[s],n[s]=o):r[s]=new WS(t,a[s]);for(;s<u;++s)(o=e[s])&&(i[s]=o)}function oRe(t,e,r,n,i,a,s){var o,u,h=new Map,f=e.length,d=a.length,b=new Array(f),v;for(o=0;o<f;++o)(u=e[o])&&(b[o]=v=s.call(u,u.__data__,o,e)+"",h.has(v)?i[o]=u:h.set(v,u));for(o=0;o<d;++o)v=s.call(t,a[o],o,a)+"",(u=h.get(v))?(n[o]=u,u.__data__=a[o],h.delete(v)):r[o]=new WS(t,a[o]);for(o=0;o<f;++o)(u=e[o])&&h.get(b[o])===u&&(i[o]=u)}function sRe(t){return t.__data__}function lRe(t,e){if(!arguments.length)return Array.from(this,sRe);var r=e?oRe:aRe,n=this._parents,i=this._groups;typeof t!="function"&&(t=iRe(t));for(var a=i.length,s=new Array(a),o=new Array(a),u=new Array(a),h=0;h<a;++h){var f=n[h],d=i[h],b=d.length,v=uRe(t.call(f,f&&f.__data__,h,n)),S=v.length,E=o[h]=new Array(S),P=s[h]=new Array(S),k=u[h]=new Array(b);r(f,d,E,P,k,v,e);for(var L=0,N=0,M,z;L<S;++L)if(M=E[L]){for(L>=N&&(N=L+1);!(z=P[N])&&++N<S;);M._next=z||null}}return s=new cf(s,n),s._enter=o,s._exit=u,s}function uRe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function cRe(){return new cf(this._exit||this._groups.map(aQ),this._parents)}function hRe(t,e,r){var n=this.enter(),i=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function fRe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),u=0;u<s;++u)for(var h=r[u],f=n[u],d=h.length,b=o[u]=new Array(d),v,S=0;S<d;++S)(v=h[S]||f[S])&&(b[S]=v);for(;u<i;++u)o[u]=r[u];return new cf(o,this._parents)}function dRe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function pRe(t){t||(t=gRe);function e(d,b){return d&&b?t(d.__data__,b.__data__):!d-!b}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,u=i[a]=new Array(o),h,f=0;f<o;++f)(h=s[f])&&(u[f]=h);u.sort(e)}return new cf(i,this._parents).order()}function gRe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mRe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function yRe(){return Array.from(this)}function vRe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function _Re(){let t=0;for(const e of this)++t;return t}function bRe(){return!this.node()}function xRe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function wRe(t){return function(){this.removeAttribute(t)}}function SRe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ERe(t,e){return function(){this.setAttribute(t,e)}}function TRe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function CRe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function ARe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function IRe(t,e){var r=HT(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?SRe:wRe:typeof e=="function"?r.local?ARe:CRe:r.local?TRe:ERe)(r,e))}function oQ(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function PRe(t){return function(){this.style.removeProperty(t)}}function kRe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function MRe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function RRe(t,e,r){return arguments.length>1?this.each((e==null?PRe:typeof e=="function"?MRe:kRe)(t,e,r??"")):d0(this.node(),t)}function d0(t,e){return t.style.getPropertyValue(e)||oQ(t).getComputedStyle(t,null).getPropertyValue(e)}function ORe(t){return function(){delete this[t]}}function NRe(t,e){return function(){this[t]=e}}function LRe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function DRe(t,e){return arguments.length>1?this.each((e==null?ORe:typeof e=="function"?LRe:NRe)(t,e)):this.node()[t]}function sQ(t){return t.trim().split(/^|\s+/)}function mL(t){return t.classList||new lQ(t)}function lQ(t){this._node=t,this._names=sQ(t.getAttribute("class")||"")}lQ.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function uQ(t,e){for(var r=mL(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function cQ(t,e){for(var r=mL(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function FRe(t){return function(){uQ(this,t)}}function BRe(t){return function(){cQ(this,t)}}function zRe(t,e){return function(){(e.apply(this,arguments)?uQ:cQ)(this,t)}}function jRe(t,e){var r=sQ(t+"");if(arguments.length<2){for(var n=mL(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?zRe:e?FRe:BRe)(r,e))}function URe(){this.textContent=""}function VRe(t){return function(){this.textContent=t}}function $Re(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function qRe(t){return arguments.length?this.each(t==null?URe:(typeof t=="function"?$Re:VRe)(t)):this.node().textContent}function HRe(){this.innerHTML=""}function WRe(t){return function(){this.innerHTML=t}}function GRe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function XRe(t){return arguments.length?this.each(t==null?HRe:(typeof t=="function"?GRe:WRe)(t)):this.node().innerHTML}function YRe(){this.nextSibling&&this.parentNode.appendChild(this)}function ZRe(){return this.each(YRe)}function KRe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function JRe(){return this.each(KRe)}function QRe(t){var e=typeof t=="function"?t:tQ(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function eOe(){return null}function tOe(t,e){var r=typeof t=="function"?t:tQ(t),n=e==null?eOe:typeof e=="function"?e:gL(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function rOe(){var t=this.parentNode;t&&t.removeChild(this)}function nOe(){return this.each(rOe)}function iOe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function aOe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function oOe(t){return this.select(t?aOe:iOe)}function sOe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function lOe(t){return function(e){t.call(this,e,this.__data__)}}function uOe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function cOe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,a;r<i;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function hOe(t,e,r){return function(){var n=this.__on,i,a=lOe(e);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=e;return}}this.addEventListener(t.type,a,r),i={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(i):this.__on=[i]}}function fOe(t,e,r){var n=uOe(t+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var u=0,h=o.length,f;u<h;++u)for(i=0,f=o[u];i<a;++i)if((s=n[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?hOe:cOe,i=0;i<a;++i)this.each(o(n[i],e,r));return this}function hQ(t,e,r){var n=oQ(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dOe(t,e){return function(){return hQ(this,t,e)}}function pOe(t,e){return function(){return hQ(this,t,e.apply(this,arguments))}}function gOe(t,e){return this.each((typeof e=="function"?pOe:dOe)(t,e))}function*mOe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var yOe=[null];function cf(t,e){this._groups=t,this._parents=e}function dx(){return new cf([[document.documentElement]],yOe)}function vOe(){return this}cf.prototype=dx.prototype={constructor:cf,select:$Me,selectAll:GMe,selectChild:KMe,selectChildren:tRe,filter:rRe,data:lRe,enter:nRe,exit:cRe,join:hRe,merge:fRe,selection:vOe,order:dRe,sort:pRe,call:mRe,nodes:yRe,node:vRe,size:_Re,empty:bRe,each:xRe,attr:IRe,style:RRe,property:DRe,classed:jRe,text:qRe,html:XRe,raise:ZRe,lower:JRe,append:QRe,insert:tOe,remove:nOe,clone:oOe,datum:sOe,on:fOe,dispatch:gOe,[Symbol.iterator]:mOe};function yL(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function fQ(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function px(){}var _b=.7,GS=1/_b,Hv="\\s*([+-]?\\d+)\\s*",bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_Oe=/^#([0-9a-f]{3,8})$/,bOe=new RegExp(`^rgb\\(${Hv},${Hv},${Hv}\\)$`),xOe=new RegExp(`^rgb\\(${Qf},${Qf},${Qf}\\)$`),wOe=new RegExp(`^rgba\\(${Hv},${Hv},${Hv},${bb}\\)$`),SOe=new RegExp(`^rgba\\(${Qf},${Qf},${Qf},${bb}\\)$`),EOe=new RegExp(`^hsl\\(${bb},${Qf},${Qf}\\)$`),TOe=new RegExp(`^hsla\\(${bb},${Qf},${Qf},${bb}\\)$`),v$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yL(px,xb,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:_$,formatHex:_$,formatHex8:COe,formatHsl:AOe,formatRgb:b$,toString:b$});function _$(){return this.rgb().formatHex()}function COe(){return this.rgb().formatHex8()}function AOe(){return dQ(this).formatHsl()}function b$(){return this.rgb().formatRgb()}function xb(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=_Oe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?x$(e):r===3?new wc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?F2(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?F2(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bOe.exec(t))?new wc(e[1],e[2],e[3],1):(e=xOe.exec(t))?new wc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=wOe.exec(t))?F2(e[1],e[2],e[3],e[4]):(e=SOe.exec(t))?F2(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=EOe.exec(t))?E$(e[1],e[2]/100,e[3]/100,1):(e=TOe.exec(t))?E$(e[1],e[2]/100,e[3]/100,e[4]):v$.hasOwnProperty(t)?x$(v$[t]):t==="transparent"?new wc(NaN,NaN,NaN,0):null}function x$(t){return new wc(t>>16&255,t>>8&255,t&255,1)}function F2(t,e,r,n){return n<=0&&(t=e=r=NaN),new wc(t,e,r,n)}function IOe(t){return t instanceof px||(t=xb(t)),t?(t=t.rgb(),new wc(t.r,t.g,t.b,t.opacity)):new wc}function vM(t,e,r,n){return arguments.length===1?IOe(t):new wc(t,e,r,n??1)}function wc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}yL(wc,vM,fQ(px,{brighter(t){return t=t==null?GS:Math.pow(GS,t),new wc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_b:Math.pow(_b,t),new wc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new wc(lm(this.r),lm(this.g),lm(this.b),XS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w$,formatHex:w$,formatHex8:POe,formatRgb:S$,toString:S$}));function w$(){return`#${Jg(this.r)}${Jg(this.g)}${Jg(this.b)}`}function POe(){return`#${Jg(this.r)}${Jg(this.g)}${Jg(this.b)}${Jg((isNaN(this.opacity)?1:this.opacity)*255)}`}function S$(){const t=XS(this.opacity);return`${t===1?"rgb(":"rgba("}${lm(this.r)}, ${lm(this.g)}, ${lm(this.b)}${t===1?")":`, ${t})`}`}function XS(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function lm(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jg(t){return t=lm(t),(t<16?"0":"")+t.toString(16)}function E$(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Jh(t,e,r,n)}function dQ(t){if(t instanceof Jh)return new Jh(t.h,t.s,t.l,t.opacity);if(t instanceof px||(t=xb(t)),!t)return new Jh;if(t instanceof Jh)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,u=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=u<.5?a+i:2-a-i,s*=60):o=u>0&&u<1?0:s,new Jh(s,o,u,t.opacity)}function kOe(t,e,r,n){return arguments.length===1?dQ(t):new Jh(t,e,r,n??1)}function Jh(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}yL(Jh,kOe,fQ(px,{brighter(t){return t=t==null?GS:Math.pow(GS,t),new Jh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_b:Math.pow(_b,t),new Jh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new wc(vI(t>=240?t-240:t+120,i,n),vI(t,i,n),vI(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Jh(T$(this.h),B2(this.s),B2(this.l),XS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=XS(this.opacity);return`${t===1?"hsl(":"hsla("}${T$(this.h)}, ${B2(this.s)*100}%, ${B2(this.l)*100}%${t===1?")":`, ${t})`}`}}));function T$(t){return t=(t||0)%360,t<0?t+360:t}function B2(t){return Math.max(0,Math.min(1,t||0))}function vI(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const pQ=t=>()=>t;function MOe(t,e){return function(r){return t+r*e}}function ROe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function OOe(t){return(t=+t)==1?gQ:function(e,r){return r-e?ROe(e,r,t):pQ(isNaN(e)?r:e)}}function gQ(t,e){var r=e-t;return r?MOe(t,r):pQ(isNaN(t)?e:t)}const C$=(function t(e){var r=OOe(e);function n(i,a){var s=r((i=vM(i)).r,(a=vM(a)).r),o=r(i.g,a.g),u=r(i.b,a.b),h=gQ(i.opacity,a.opacity);return function(f){return i.r=s(f),i.g=o(f),i.b=u(f),i.opacity=h(f),i+""}}return n.gamma=t,n})(1);function Mp(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var _M=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_I=new RegExp(_M.source,"g");function NOe(t){return function(){return t}}function LOe(t){return function(e){return t(e)+""}}function DOe(t,e){var r=_M.lastIndex=_I.lastIndex=0,n,i,a,s=-1,o=[],u=[];for(t=t+"",e=e+"";(n=_M.exec(t))&&(i=_I.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,u.push({i:s,x:Mp(n,i)})),r=_I.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?u[0]?LOe(u[0].x):NOe(e):(e=u.length,function(h){for(var f=0,d;f<e;++f)o[(d=u[f]).i]=d.x(h);return o.join("")})}var A$=180/Math.PI,bM={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mQ(t,e,r,n,i,a){var s,o,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*r+e*n)&&(r-=t*u,n-=e*u),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,u/=o),t*n<e*r&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*A$,skewX:Math.atan(u)*A$,scaleX:s,scaleY:o}}var z2;function FOe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?bM:mQ(e.a,e.b,e.c,e.d,e.e,e.f)}function BOe(t){return t==null||(z2||(z2=document.createElementNS("http://www.w3.org/2000/svg","g")),z2.setAttribute("transform",t),!(t=z2.transform.baseVal.consolidate()))?bM:(t=t.matrix,mQ(t.a,t.b,t.c,t.d,t.e,t.f))}function yQ(t,e,r,n){function i(h){return h.length?h.pop()+" ":""}function a(h,f,d,b,v,S){if(h!==d||f!==b){var E=v.push("translate(",null,e,null,r);S.push({i:E-4,x:Mp(h,d)},{i:E-2,x:Mp(f,b)})}else(d||b)&&v.push("translate("+d+e+b+r)}function s(h,f,d,b){h!==f?(h-f>180?f+=360:f-h>180&&(h+=360),b.push({i:d.push(i(d)+"rotate(",null,n)-2,x:Mp(h,f)})):f&&d.push(i(d)+"rotate("+f+n)}function o(h,f,d,b){h!==f?b.push({i:d.push(i(d)+"skewX(",null,n)-2,x:Mp(h,f)}):f&&d.push(i(d)+"skewX("+f+n)}function u(h,f,d,b,v,S){if(h!==d||f!==b){var E=v.push(i(v)+"scale(",null,",",null,")");S.push({i:E-4,x:Mp(h,d)},{i:E-2,x:Mp(f,b)})}else(d!==1||b!==1)&&v.push(i(v)+"scale("+d+","+b+")")}return function(h,f){var d=[],b=[];return h=t(h),f=t(f),a(h.translateX,h.translateY,f.translateX,f.translateY,d,b),s(h.rotate,f.rotate,d,b),o(h.skewX,f.skewX,d,b),u(h.scaleX,h.scaleY,f.scaleX,f.scaleY,d,b),h=f=null,function(v){for(var S=-1,E=b.length,P;++S<E;)d[(P=b[S]).i]=P.x(v);return d.join("")}}}var zOe=yQ(FOe,"px, ","px)","deg)"),jOe=yQ(BOe,", ",")",")"),p0=0,u1=0,D_=0,vQ=1e3,YS,c1,ZS=0,Am=0,WT=0,wb=typeof performance=="object"&&performance.now?performance:Date,_Q=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function vL(){return Am||(_Q(UOe),Am=wb.now()+WT)}function UOe(){Am=0}function KS(){this._call=this._time=this._next=null}KS.prototype=bQ.prototype={constructor:KS,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?vL():+r)+(e==null?0:+e),!this._next&&c1!==this&&(c1?c1._next=this:YS=this,c1=this),this._call=t,this._time=r,xM()},stop:function(){this._call&&(this._call=null,this._time=1/0,xM())}};function bQ(t,e,r){var n=new KS;return n.restart(t,e,r),n}function VOe(){vL(),++p0;for(var t=YS,e;t;)(e=Am-t._time)>=0&&t._call.call(void 0,e),t=t._next;--p0}function I$(){Am=(ZS=wb.now())+WT,p0=u1=0;try{VOe()}finally{p0=0,qOe(),Am=0}}function $Oe(){var t=wb.now(),e=t-ZS;e>vQ&&(WT-=e,ZS=t)}function qOe(){for(var t,e=YS,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:YS=r);c1=t,xM(n)}function xM(t){if(!p0){u1&&(u1=clearTimeout(u1));var e=t-Am;e>24?(t<1/0&&(u1=setTimeout(I$,t-wb.now()-WT)),D_&&(D_=clearInterval(D_))):(D_||(ZS=wb.now(),D_=setInterval($Oe,vQ)),p0=1,_Q(I$))}}function P$(t,e,r){var n=new KS;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var HOe=eQ("start","end","cancel","interrupt"),WOe=[],xQ=0,k$=1,wM=2,Cw=3,M$=4,SM=5,Aw=6;function GT(t,e,r,n,i,a){var s=t.__transition;if(!s)t.__transition={};else if(r in s)return;GOe(t,r,{name:e,index:n,group:i,on:HOe,tween:WOe,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:xQ})}function _L(t,e){var r=yf(t,e);if(r.state>xQ)throw new Error("too late; already scheduled");return r}function cd(t,e){var r=yf(t,e);if(r.state>Cw)throw new Error("too late; already running");return r}function yf(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function GOe(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=bQ(a,0,r.time);function a(h){r.state=k$,r.timer.restart(s,r.delay,r.time),r.delay<=h&&s(h-r.delay)}function s(h){var f,d,b,v;if(r.state!==k$)return u();for(f in n)if(v=n[f],v.name===r.name){if(v.state===Cw)return P$(s);v.state===M$?(v.state=Aw,v.timer.stop(),v.on.call("interrupt",t,t.__data__,v.index,v.group),delete n[f]):+f<e&&(v.state=Aw,v.timer.stop(),v.on.call("cancel",t,t.__data__,v.index,v.group),delete n[f])}if(P$(function(){r.state===Cw&&(r.state=M$,r.timer.restart(o,r.delay,r.time),o(h))}),r.state=wM,r.on.call("start",t,t.__data__,r.index,r.group),r.state===wM){for(r.state=Cw,i=new Array(b=r.tween.length),f=0,d=-1;f<b;++f)(v=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(i[++d]=v);i.length=d+1}}function o(h){for(var f=h<r.duration?r.ease.call(null,h/r.duration):(r.timer.restart(u),r.state=SM,1),d=-1,b=i.length;++d<b;)i[d].call(t,f);r.state===SM&&(r.on.call("end",t,t.__data__,r.index,r.group),u())}function u(){r.state=Aw,r.timer.stop(),delete n[e];for(var h in n)return;delete t.__transition}}function XOe(t,e){var r=t.__transition,n,i,a=!0,s;if(r){e=e==null?null:e+"";for(s in r){if((n=r[s]).name!==e){a=!1;continue}i=n.state>wM&&n.state<SM,n.state=Aw,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]}a&&delete t.__transition}}function YOe(t){return this.each(function(){XOe(this,t)})}function ZOe(t,e){var r,n;return function(){var i=cd(this,t),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function KOe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=cd(this,t),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:e,value:r},u=0,h=i.length;u<h;++u)if(i[u].name===e){i[u]=o;break}u===h&&i.push(o)}a.tween=i}}function JOe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=yf(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===t)return s.value;return null}return this.each((e==null?ZOe:KOe)(r,t,e))}function bL(t,e,r){var n=t._id;return t.each(function(){var i=cd(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return yf(i,n).value[e]}}function wQ(t,e){var r;return(typeof e=="number"?Mp:e instanceof xb?C$:(r=xb(e))?(e=r,C$):DOe)(t,e)}function QOe(t){return function(){this.removeAttribute(t)}}function eNe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===n?a:a=e(n=s,r)}}function rNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===n?a:a=e(n=s,r)}}function nNe(t,e,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o)))}}function iNe(t,e,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o)))}}function aNe(t,e){var r=HT(t),n=r==="transform"?jOe:wQ;return this.attrTween(t,typeof e=="function"?(r.local?iNe:nNe)(r,n,bL(this,"attr."+t,e)):e==null?(r.local?eNe:QOe)(r):(r.local?rNe:tNe)(r,n,e))}function oNe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function sNe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function lNe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&sNe(t,a)),r}return i._value=e,i}function uNe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&oNe(t,a)),r}return i._value=e,i}function cNe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=HT(t);return this.tween(r,(n.local?lNe:uNe)(n,e))}function hNe(t,e){return function(){_L(this,t).delay=+e.apply(this,arguments)}}function fNe(t,e){return e=+e,function(){_L(this,t).delay=e}}function dNe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?hNe:fNe)(e,t)):yf(this.node(),e).delay}function pNe(t,e){return function(){cd(this,t).duration=+e.apply(this,arguments)}}function gNe(t,e){return e=+e,function(){cd(this,t).duration=e}}function mNe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?pNe:gNe)(e,t)):yf(this.node(),e).duration}function yNe(t,e){if(typeof e!="function")throw new Error;return function(){cd(this,t).ease=e}}function vNe(t){var e=this._id;return arguments.length?this.each(yNe(e,t)):yf(this.node(),e).ease}function _Ne(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;cd(this,t).ease=r}}function bNe(t){if(typeof t!="function")throw new Error;return this.each(_Ne(this._id,t))}function xNe(t){typeof t!="function"&&(t=nQ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],u,h=0;h<s;++h)(u=a[h])&&t.call(u,u.__data__,h,a)&&o.push(u);return new Qd(n,this._parents,this._name,this._id)}function wNe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var u=e[o],h=r[o],f=u.length,d=s[o]=new Array(f),b,v=0;v<f;++v)(b=u[v]||h[v])&&(d[v]=b);for(;o<n;++o)s[o]=e[o];return new Qd(s,this._parents,this._name,this._id)}function SNe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function ENe(t,e,r){var n,i,a=SNe(e)?_L:cd;return function(){var s=a(this,t),o=s.on;o!==n&&(i=(n=o).copy()).on(e,r),s.on=i}}function TNe(t,e){var r=this._id;return arguments.length<2?yf(this.node(),r).on.on(t):this.each(ENe(r,t,e))}function CNe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function ANe(){return this.on("end.remove",CNe(this._id))}function INe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=gL(t));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],u=o.length,h=a[s]=new Array(u),f,d,b=0;b<u;++b)(f=o[b])&&(d=t.call(f,f.__data__,b,o))&&("__data__"in f&&(d.__data__=f.__data__),h[b]=d,GT(h[b],e,r,b,h,yf(f,r)));return new Qd(a,this._parents,e,r)}function PNe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=rQ(t));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var u=n[o],h=u.length,f,d=0;d<h;++d)if(f=u[d]){for(var b=t.call(f,f.__data__,d,u),v,S=yf(f,r),E=0,P=b.length;E<P;++E)(v=b[E])&&GT(v,e,r,E,b,S);a.push(b),s.push(f)}return new Qd(a,s,e,r)}var kNe=dx.prototype.constructor;function MNe(){return new kNe(this._groups,this._parents)}function RNe(t,e){var r,n,i;return function(){var a=d0(this,t),s=(this.style.removeProperty(t),d0(this,t));return a===s?null:a===r&&s===n?i:i=e(r=a,n=s)}}function SQ(t){return function(){this.style.removeProperty(t)}}function ONe(t,e,r){var n,i=r+"",a;return function(){var s=d0(this,t);return s===i?null:s===n?a:a=e(n=s,r)}}function NNe(t,e,r){var n,i,a;return function(){var s=d0(this,t),o=r(this),u=o+"";return o==null&&(u=o=(this.style.removeProperty(t),d0(this,t))),s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o))}}function LNe(t,e){var r,n,i,a="style."+e,s="end."+a,o;return function(){var u=cd(this,t),h=u.on,f=u.value[a]==null?o||(o=SQ(e)):void 0;(h!==r||i!==f)&&(n=(r=h).copy()).on(s,i=f),u.on=n}}function DNe(t,e,r){var n=(t+="")=="transform"?zOe:wQ;return e==null?this.styleTween(t,RNe(t,n)).on("end.style."+t,SQ(t)):typeof e=="function"?this.styleTween(t,NNe(t,n,bL(this,"style."+t,e))).each(LNe(this._id,t)):this.styleTween(t,ONe(t,n,e),r).on("end.style."+t,null)}function FNe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function BNe(t,e,r){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&FNe(t,s,r)),n}return a._value=e,a}function zNe(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,BNe(t,e,r??""))}function jNe(t){return function(){this.textContent=t}}function UNe(t){return function(){var e=t(this);this.textContent=e??""}}function VNe(t){return this.tween("text",typeof t=="function"?UNe(bL(this,"text",t)):jNe(t==null?"":t+""))}function $Ne(t){return function(e){this.textContent=t.call(this,e)}}function qNe(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&$Ne(i)),e}return n._value=t,n}function HNe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,qNe(t))}function WNe(){for(var t=this._name,e=this._id,r=EQ(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,h=0;h<o;++h)if(u=s[h]){var f=yf(u,e);GT(u,t,r,h,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Qd(n,this._parents,t,r)}function GNe(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},u={value:function(){--i===0&&a()}};r.each(function(){var h=cd(this,n),f=h.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(u)),h.on=e}),i===0&&a()})}var XNe=0;function Qd(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function EQ(){return++XNe}var Pd=dx.prototype;Qd.prototype={constructor:Qd,select:INe,selectAll:PNe,selectChild:Pd.selectChild,selectChildren:Pd.selectChildren,filter:xNe,merge:wNe,selection:MNe,transition:WNe,call:Pd.call,nodes:Pd.nodes,node:Pd.node,size:Pd.size,empty:Pd.empty,each:Pd.each,on:TNe,attr:aNe,attrTween:cNe,style:DNe,styleTween:zNe,text:VNe,textTween:HNe,remove:ANe,tween:JOe,delay:dNe,duration:mNe,ease:vNe,easeVarying:bNe,end:GNe,[Symbol.iterator]:Pd[Symbol.iterator]};function YNe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ZNe={time:null,delay:0,duration:250,ease:YNe};function KNe(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function JNe(t){var e,r;t instanceof Qd?(e=t._id,t=t._name):(e=EQ(),(r=ZNe).time=vL(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,h=0;h<o;++h)(u=s[h])&&GT(u,t,e,h,s,r||KNe(u,e));return new Qd(n,this._parents,t,e)}dx.prototype.interrupt=YOe;dx.prototype.transition=JNe;var R$={},bI={},xI=34,F_=10,wI=13;function TQ(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function QNe(t,e){var r=TQ(t);return function(n,i){return e(r(n),i,t)}}function O$(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function bc(t,e){var r=t+"",n=r.length;return n<e?new Array(e-n+1).join(0)+r:r}function eLe(t){return t<0?"-"+bc(-t,6):t>9999?"+"+bc(t,6):bc(t,4)}function tLe(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":eLe(t.getUTCFullYear())+"-"+bc(t.getUTCMonth()+1,2)+"-"+bc(t.getUTCDate(),2)+(i?"T"+bc(e,2)+":"+bc(r,2)+":"+bc(n,2)+"."+bc(i,3)+"Z":n?"T"+bc(e,2)+":"+bc(r,2)+":"+bc(n,2)+"Z":r||e?"T"+bc(e,2)+":"+bc(r,2)+"Z":"")}function rLe(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function n(d,b){var v,S,E=i(d,function(P,k){if(v)return v(P,k-1);S=P,v=b?QNe(P,b):TQ(P)});return E.columns=S||[],E}function i(d,b){var v=[],S=d.length,E=0,P=0,k,L=S<=0,N=!1;d.charCodeAt(S-1)===F_&&--S,d.charCodeAt(S-1)===wI&&--S;function M(){if(L)return bI;if(N)return N=!1,R$;var B,q=E,W;if(d.charCodeAt(q)===xI){for(;E++<S&&d.charCodeAt(E)!==xI||d.charCodeAt(++E)===xI;);return(B=E)>=S?L=!0:(W=d.charCodeAt(E++))===F_?N=!0:W===wI&&(N=!0,d.charCodeAt(E)===F_&&++E),d.slice(q+1,B-1).replace(/""/g,'"')}for(;E<S;){if((W=d.charCodeAt(B=E++))===F_)N=!0;else if(W===wI)N=!0,d.charCodeAt(E)===F_&&++E;else if(W!==r)continue;return d.slice(q,B)}return L=!0,d.slice(q,S)}for(;(k=M())!==bI;){for(var z=[];k!==R$&&k!==bI;)z.push(k),k=M();b&&(z=b(z,P++))==null||v.push(z)}return v}function a(d,b){return d.map(function(v){return b.map(function(S){return f(v[S])}).join(t)})}function s(d,b){return b==null&&(b=O$(d)),[b.map(f).join(t)].concat(a(d,b)).join(`
`)}function o(d,b){return b==null&&(b=O$(d)),a(d,b).join(`
`)}function u(d){return d.map(h).join(`
`)}function h(d){return d.map(f).join(t)}function f(d){return d==null?"":d instanceof Date?tLe(d):e.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:n,parseRows:i,format:s,formatBody:o,formatRows:u,formatRow:h,formatValue:f}}var nLe=rLe(","),iLe=nLe.parse;function aLe(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function CQ(t,e){return fetch(t,e).then(aLe)}function oLe(t){return function(e,r,n){return arguments.length===2&&typeof r=="function"&&(n=r,r=void 0),CQ(e,r).then(function(i){return t(i,n)})}}var sLe=oLe(iLe);function lLe(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function uLe(t,e){return fetch(t,e).then(lLe)}function cLe(t){return(e,r)=>CQ(e,r).then(n=>new DOMParser().parseFromString(n,t))}const hLe=cLe("application/xml");function h1(t,e,r){this.k=t,this.x=e,this.y=r}h1.prototype={constructor:h1,scale:function(t){return t===1?this:new h1(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new h1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};h1.prototype;const N$=t=>{const[e,r]=ee.useState();ee.useEffect(()=>{if(!t.url)return;let i=null;t.format==="json"?i=uLe(t.url):t.format==="csv"?i=sLe(t.url):t.format==="xml"&&(i=hLe(t.url)),i&&i.then(a=>{if(t.format==="xml"){if(t.nodeType){const s=[];a.querySelectorAll(t.nodeType).forEach(o=>{typeof t.formatData=="function"&&s.push(t.formatData(o))}),r(s)}}else{let s=a;t.data_property&&(s=a[t.data_property]),typeof t.formatData=="function"?r(s.map(t.formatData)):r(s)}typeof t.onData=="function"&&t.onData()})},[t.url,t]);const n={data:e,setData:r};return Z.jsx(mM,{value:n,children:t.children})};try{N$.displayName="SimpleDataProvider",N$.__docgenInfo={description:"",displayName:"SimpleDataProvider",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},format:{defaultValue:null,description:"",name:"format",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"csv"'},{value:'"xml"'}]}},nodeType:{defaultValue:null,description:"",name:"nodeType",required:!0,type:{name:"string"}},data_property:{defaultValue:null,description:"",name:"data_property",required:!0,type:{name:"string"}},formatData:{defaultValue:null,description:"",name:"formatData",required:!1,type:{name:"((data: any) => any) | undefined"}},onData:{defaultValue:null,description:"",name:"onData",required:!0,type:{name:"() => void"}}}}}catch{}const Iw=Yi(Z.jsx("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"})),Pw=Yi(Z.jsx("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"})),SI=Yi(Z.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),fLe=t=>{let{transform:e}=t;return{...e,x:0}},kd=Br(th)({padding:"4px",marginTop:"-3px",background:"none","&:hover":{background:"none"}});function EM(t){const e=ZPe(),r=pa({mapId:void 0});function n(d){const b=d.id&&r.map?.getLayer(d.id)?.source?r.map?.getLayer(d.id)?.source:void 0;let v=null;switch(d.type){case"geojson":if(d.config?.geojson)r.map?.fitBounds(ah(d.config?.geojson),t.fitBoundsOptions);else{if(!b)return;const S={type:"FeatureCollection",features:r.map?.querySourceFeatures(b)};S.features.length===0&&(r.map?.zoomTo(1),S.features=r.map?.querySourceFeatures(b)),v=ah(S)}break;case"vt":console.log("vt");break;case"wms":v=d?.config?.config?.layers?.[0]?.EX_GeographicBoundingBox;break;default:return}v&&r.map?.fitBounds(v,t.fitBoundsOptions)}const i=ee.useMemo(()=>["order-background",...[...e.layers].map((b,v)=>"content_order_"+v),"order-labels"].reverse(),[e.layers]),a=ee.useMemo(()=>t.layers?t.layers:e?.layers?e.layers:[],[t.layers,e.layers]),s=ee.useMemo(()=>t.setLayers?t.setLayers:e.setLayers,[t.setLayers,e.setLayers]),o=mV(nL,{activationConstraint:{distance:5}}),u=mV(cJ,{activationConstraint:{distance:5}}),h=G5e(u,o);function f(d){const b=d.active.id,v=d.over?.data?.current?.sortable.index;e.moveLayer(String(b),()=>v)}return Z.jsxs(Z.Fragment,{children:[Z.jsx(VS,{layerIds:i,insertBeforeLayer:"_background"}),e?.symbolLayers?.length>0&&Z.jsx(zd,{layerComponent:Z.jsx(qv,{...e.vtLayerConfig,layers:e.symbolLayers,mapId:t?.mapId,insertBeforeLayer:"order-labels"}),setLayerState:d=>e.setSymbolLayers(d?.layers),visible:!0,configurable:!0,type:"layer",name:"Labels"},"background_labels"),Z.jsx(Z4e,{collisionDetection:J5e,sensors:h,onDragEnd:d=>f(d),modifiers:[fLe],children:Z.jsxs(uIe,{items:a,strategy:sIe,children:[[...a].map((d,b)=>{if(!d?.id)return null;switch(d.type){case"geojson":return Z.jsx(zd,{layerId:d.id,sortable:t.sortable,name:d?.name||d?.config?.type+" layer"||"unnamed layer",layerComponent:Z.jsx(Ac,{...d.config,mapId:t?.mapId,layerId:d.id,insertBeforeLayer:"content_order_"+(a.length-1-b)}),buttons:Z.jsxs(Z.Fragment,{children:[Z.jsx(kd,{disabled:b===a.length-1,onClick:()=>{e.moveDown(d.id||"")},children:Z.jsx(Iw,{})}),Z.jsx(kd,{disabled:b===0,onClick:()=>{e.moveUp(d.id||"")},children:Z.jsx(Pw,{})}),Z.jsx(kd,{onClick:()=>n(d),children:Z.jsx(SI,{})})]}),setLayerState:v=>s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config=v,E}),configurable:!0,showDeleteButton:!0},d.id);case"wms":return Z.jsx(Z.Fragment,{children:ee.createElement(US,{...d.config,key:d.id,layerId:d.id,sortable:t.sortable,mapId:t?.mapId,insertBeforeLayer:"content_order_"+(a.length-1-b),onConfigChange:v=>{s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config.config=v,E})},featureInfoActive:d?.config?.featureInfoActive||!1,setFeatureInfoActive:v=>{s?.(S=>{const E=[...S];return typeof v=="function"&&(E[b].config.featureInfoActive=v(E[b].config?.featureInfoActive||!1)),E})},showDeleteButton:!0,buttons:Z.jsxs(Z.Fragment,{children:[Z.jsx(kd,{disabled:b===a.length-1,onClick:()=>{e.moveDown(d.id||"")},children:Z.jsx(Iw,{})}),Z.jsx(kd,{disabled:b===0,onClick:()=>{e.moveUp(d.id||"")},children:Z.jsx(Pw,{})}),Z.jsx(kd,{onClick:()=>n(d),children:Z.jsx(SI,{})})]})})});case"vt":return Z.jsx(ht.Fragment,{children:Z.jsx(zd,{name:d?.name||d?.type+" layer"||"unnamed layer",layerComponent:Z.jsx(qv,{layers:d?.config?.layers||[],mapId:d?.config.mapId,sourceOptions:d?.config?.sourceOptions,layerId:d.id,url:d?.config?.url},d.id),buttons:Z.jsxs(Z.Fragment,{children:[Z.jsx(kd,{disabled:b===a.length-1,onClick:()=>{e.moveDown(d.id||"")},children:Z.jsx(Iw,{})},d.id+"_button1"),Z.jsx(kd,{disabled:b===0,onClick:()=>{e.moveUp(d.id||"")},children:Z.jsx(Pw,{})},d.id+"_button2"),Z.jsx(kd,{onClick:()=>n(d),children:Z.jsx(SI,{})})]}),setLayerState:v=>s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config=v,E}),configurable:!0,showDeleteButton:!0},d.id)},d?.id+"_listItem");default:return null}}),e?.backgroundLayers?.length>0&&Z.jsx(zd,{layerComponent:Z.jsx(qv,{...e.vtLayerConfig,layers:e.backgroundLayers,mapId:t?.mapId,insertBeforeLayer:"order-background"}),setLayerState:d=>{e.setBackgroundLayers(d?.layers)},visible:!0,configurable:!0,type:"layer",name:"Background"},"background_geometry")]})})]})}EM.defaultProps={mapId:void 0};try{EM.displayName="LayerListItemFactory",EM.__docgenInfo={description:"",displayName:"LayerListItemFactory",props:{mapId:{defaultValue:{value:"undefined"},description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"LayerConfig[]"}},setLayers:{defaultValue:null,description:"",name:"setLayers",required:!1,type:{name:"((layers: LayerConfig[] | ((state: LayerConfig[]) => LayerConfig[])) => void) | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},fitBoundsOptions:{defaultValue:null,description:"",name:"fitBoundsOptions",required:!1,type:{name:"FitBoundsOptions | undefined"}}}}}catch{}const dLe=Yi(Z.jsx("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"})),pLe=["fill","line","circle"];function TM(t){const[e,r]=ht.useState({type:"circle"}),n=ee.useMemo(()=>!(!e?.type||!e?.geojson),[e]);return Z.jsxs(Z.Fragment,{children:[Z.jsx(Bm,{children:"GeoJSON layer"}),Z.jsxs(Kc,{fullWidth:!0,children:[Z.jsx(qp,{id:"type-label",children:"Type"}),Z.jsx(Hp,{labelId:"type-label",value:e.type,label:"Type",onChange:i=>r(a=>({...a,type:i.target.value})),children:pLe.map(i=>Z.jsx(im,{value:i,children:i},i))})]}),Z.jsx(Kc,{fullWidth:!0,children:Z.jsxs(ra,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Upload File",Z.jsx("input",{type:"file",hidden:!0,onChange:i=>{i.target.files?.[0].text().then(a=>r(s=>({...s,geojson:JSON.parse(a)})))}})]})}),Z.jsxs(Wb,{children:[Z.jsx(ra,{onClick:t.onCancel,children:"Cancel"}),Z.jsx(ra,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{TM.displayName="GeoJsonLayerForm",TM.__docgenInfo={description:"",displayName:"GeoJsonLayerForm",props:{config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const gLe=Yi([Z.jsx("path",{d:"M8 8H6v7c0 1.1.9 2 2 2h9v-2H8z"},"0"),Z.jsx("path",{d:"M20 3h-8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 8h-8V7h8zM4 12H2v7c0 1.1.9 2 2 2h9v-2H4z"},"1")]),JS=t=>Z.jsxs(Z.Fragment,{children:[Z.jsx(Bm,{children:t.layerTypes.length>1?"Select a layer type":"Load new layer"}),Z.jsx(ff,{children:t.layerTypes.map((e,r)=>Z.jsx(Ah,{disableGutters:!0,children:Z.jsxs(DG,{autoFocus:!0,onClick:()=>{t.onSelect(e)},children:[Z.jsx(BG,{children:Z.jsx(EG,{children:Z.jsx(gLe,{})})}),Z.jsx(mh,{primary:e})]})},r))})]});JS.defaultProps={};try{JS.displayName="LayerTypeForm",JS.__docgenInfo={description:"",displayName:"LayerTypeForm",props:{onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: string) => void"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}}}}}catch{}function CM(t){const[e,r]=ht.useState({url:""}),n=ee.useMemo(()=>!!e?.url,[e]);return Z.jsxs(Z.Fragment,{children:[Z.jsx(Bm,{children:"WMS layer"}),Z.jsx(iO,{children:Z.jsxs(Kc,{fullWidth:!0,sx:{marginTop:"10px"},children:[Z.jsx(qp,{htmlFor:"wms-url-input",children:"WMS URL"}),Z.jsx(nT,{id:"wms-url-input",label:"WMS URL",value:e.url,onChange:i=>r({...e,url:i.target.value})})]})}),Z.jsxs(Wb,{children:[Z.jsx(ra,{onClick:t.onCancel,children:"Cancel"}),Z.jsx(ra,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{CM.displayName="WmsLayerForm",CM.__docgenInfo={description:"",displayName:"WmsLayerForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: wmsConfig) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const AQ=Yi(Z.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),IQ=Yi(Z.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),mLe=["latfield","lonfield","delimiter"];function AM(t){const[e,r]=ee.useState(!1);return Z.jsxs(Z.Fragment,{children:[Z.jsx(bs,{children:" Options "}),Z.jsx(ra,{onClick:()=>r(!e),children:e?Z.jsx(IQ,{}):Z.jsx(AQ,{})}),Z.jsx(ff,{children:e&&mLe?.map(n=>Z.jsxs(Z.Fragment,{children:[Z.jsx(Ah,{children:Z.jsxs(bs,{children:[" ",n," "]})}),Z.jsx(Ah,{children:Z.jsx(iT,{size:"small",onChange:i=>{const a={};a[n]=i.target.value,t.setter(a)}})})]}))})]})}try{AM.displayName="CSVOptionsFormular",AM.__docgenInfo={description:"",displayName:"CSVOptionsFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const yLe=["completeFeature","allFeatures","renderTagged","excludeWay","suppressWay"];function IM(t){const[e,r]=ee.useState(!1);return Z.jsxs(Z.Fragment,{children:[Z.jsx(bs,{children:" Options "}),Z.jsx(ra,{onClick:()=>r(!e),children:e?Z.jsx(IQ,{}):Z.jsx(AQ,{})}),Z.jsx(ff,{children:e&&yLe?.map(n=>Z.jsx(Z.Fragment,{children:Z.jsxs(Ah,{children:[Z.jsxs(bs,{children:[" ",n," "]}),Z.jsx(t0,{onChange:i=>{const a={};a[n]=i.target.value==="on",t.setter(a)}})]})}))})]})}try{IM.displayName="OsmOptionsFomular",IM.__docgenInfo={description:"",displayName:"OsmOptionsFomular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const vLe={csv:dke,topojson:Kke,osm:Xke,gpx:yI,kml:yI,tcx:yI},_Le=["fill","line","circle"];function PM(t){const[e,r]=ee.useState({type:"circle"}),[n,i]=ee.useState(),[a,s]=ee.useState(),[o,u]=ee.useState({}),h=pa({mapId:t.mapId}),f="?"+new URLSearchParams(o).toString();$S({protocol:t.originType,handler:vLe[t.originType]});const d=ee.useMemo(()=>e?.type?!!(a&&n):!1,[e,a,n]);ee.useEffect(()=>(typeof n<"u"&&typeof a<"u"&&(h.map?.getSource(n)||h.map?.addSource(n,{type:"geojson",data:o?t.originType+"://"+a+f:t.originType+"://"+a}),e.options={source:n}),()=>{}),[n,h.map,a]),ee.useEffect(()=>{a&&n&&h.map?.getLayer(n)&&URL.revokeObjectURL(a)},[n,a,h.map]);function b(v){const S={...o,...v};return u(S)}return Z.jsxs(Z.Fragment,{children:[Z.jsxs(Bm,{children:["Layer from ",t.originType]}),Z.jsxs(Kc,{fullWidth:!0,children:[Z.jsx(qp,{id:"type-label",children:"Type"}),Z.jsx(Hp,{labelId:"type-label",value:e.type,label:"Type",onChange:v=>r(S=>({...S,type:v.target.value})),children:_Le.map(v=>Z.jsx(im,{value:v,children:v},v))})]}),Z.jsxs(Kc,{fullWidth:!0,children:[Z.jsxs(ra,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",Z.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:v=>{if(i(v.target.files?.[0].name),v.target.files?.[0]){const S=URL.createObjectURL(v.target.files?.[0]);s(S)}}})]}),t.originType==="csv"&&Z.jsx(AM,{setter:b}),t.originType==="osm"&&Z.jsx(IM,{setter:b})]}),Z.jsxs(Wb,{children:[Z.jsx(ra,{onClick:t.onCancel,children:"Cancel"}),Z.jsx(ra,{disabled:!d,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{PM.displayName="ProtocolHandlerLayerForm",PM.__docgenInfo={description:"",displayName:"ProtocolHandlerLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const bLe=["id","type","metadata","source","source-layer","layout","paint","options"];function kM(t){const[e,r]=ee.useState([]),n={},i=["paint","layout","options","metadata"];ee.useEffect(()=>{t.setter(e)},[e]);const a=()=>Z.jsx(Z.Fragment,{children:bLe.map(o=>Z.jsx(ht.Fragment,{children:Z.jsx(iT,{label:o,onChange:u=>n[o]=u.target.value})},o+"_fragment"))});function s(){i.map(o=>{if(typeof n[o]<"u")try{n[o]=JSON.parse(n[o])}catch{alert("Invalid JSON format, try again")}}),r(o=>o.length>0?[n,...o]:[n])}return Z.jsxs(Z.Fragment,{children:[Z.jsx(Kc,{fullWidth:!0,children:Z.jsx(a,{})}),Z.jsx(ra,{onClick:s,children:" Add"})]})}try{kM.displayName="MbtilesLayerPropFormular",kM.__docgenInfo={description:"",displayName:"MbtilesLayerPropFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"Dispatch<SetStateAction<LayerSpecification[]>>"}}}}}catch{}const xLe=Yi(Z.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),wLe=Yi(Z.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function MM(t){const[e,r]=ht.useState(t.config),[n,i]=ee.useState(),[a,s]=ee.useState(),[o,u]=ee.useState([]),h=pa({mapId:t.mapId}),[f,d]=ee.useState(!1);console.log(o);const b=()=>Z.jsx(Z.Fragment,{children:o.map((S,E)=>Z.jsxs(bs,{variant:"body2",children:[E+1,": ",JSON.stringify(S)]},E))}),v=ee.useMemo(()=>!!n,[n]);return ee.useEffect(()=>{typeof n<"u"&&typeof a<"u"&&r({url:"mbtiles://"+a+"/{z}/{x}/{y}",layers:o,layerId:n,sourceOptions:{type:"vector",minzoom:0,maxzoom:1}})},[n,h.map,a,o]),Z.jsxs(Z.Fragment,{children:[Z.jsx(Bm,{children:" Layer from mbtiles file"}),Z.jsxs(iO,{children:[Z.jsxs(ra,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",Z.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:S=>{if(i(S.target.files?.[0].name),S.target.files?.[0]){const E=URL.createObjectURL(S.target.files?.[0]);s(E)}}})]}),Z.jsxs(qle,{expanded:f,children:[Z.jsxs(cue,{"aria-controls":"panel1d-content",id:"panel1d-header",children:[Z.jsx(bs,{children:"MB-Tile Layer properties"}),Z.jsx(ra,{onClick:()=>d(!f),children:f?Z.jsx(wLe,{}):Z.jsx(xLe,{})})]}),Z.jsx(bs,{variant:"body1",children:" Layers"}),o.length>0?Z.jsx(b,{}):Z.jsx(bs,{variant:"body2",children:" 0 "}),Z.jsx(kM,{setter:u})]})]}),Z.jsxs(Wb,{children:[Z.jsx(ra,{onClick:t.onCancel,children:"Cancel"}),Z.jsx(ra,{disabled:!v,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{MM.displayName="MbtilesLayerForm",MM.__docgenInfo={description:"",displayName:"MbtilesLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"MlVectorTileLayerProps"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlVectorTileLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const QS=t=>{const[e,r]=ee.useState(t?.config),[n,i]=ee.useState(),a=t.layerTypes,s=a.filter(d=>d!=="wms"&&d!=="geojson"&&d!=="mbtiles"),o=["wms","geojson","vt","csv","mbtiles","topojson","osm","gpx","kml","tcx"],u=d=>{i(d),s.includes(d)?r({type:"geojson",config:{}}):r(d==="mbtiles"?{type:"vt",config:{layers:[]}}:{type:d,config:{}})},h=()=>{t.setOpen(!1),r(void 0)},f=()=>Z.jsx(Z.Fragment,{children:s.map((d,b)=>Z.jsx(Z.Fragment,{children:e?.type==="geojson"&&n===d&&Z.jsx(PM,{originType:d,onSubmit:v=>{t?.onComplete?.({...e,config:v,type:"geojson"}),h()},onCancel:h},b)}))});return Z.jsxs(nO,{open:t.open,onClose:h,children:[!e?.type&&Z.jsx(JS,{onSelect:d=>{o.includes(d)&&u(d)},layerTypes:a}),e?.type==="geojson"&&n==="geojson"&&Z.jsx(TM,{onSubmit:d=>{t?.onComplete?.({...e,config:d}),h()},onCancel:h}),e?.type==="wms"&&Z.jsx(CM,{onSubmit:d=>{t?.onComplete?.({...e,config:d}),h()},onCancel:h}),e?.type==="vt"&&n!==void 0&&Z.jsx(MM,{config:e,originType:n,onSubmit:d=>{e&&(t?.onComplete?.({...e,config:d}),h())},onCancel:h}),Z.jsx(f,{},"protocol")]})};QS.defaultProps={};try{QS.displayName="AddLayerPopup",QS.__docgenInfo={description:"",displayName:"AddLayerPopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"LayerConfig | undefined"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const RM=t=>{const[e,r]=ht.useState(!1),n=t.layerTypes||["geojson","wms","csv","topojson","osm","gpx","kml","tcx"];return Z.jsxs(Z.Fragment,{children:[Z.jsx(ra,{variant:"contained",sx:{marginTop:"10px",...t.sx},onClick:()=>r(!0),children:Z.jsx(dLe,{})}),Z.jsx(QS,{open:e,setOpen:r,onComplete:t?.onComplete,layerTypes:n})]})};RM.defaultProps={};try{RM.displayName="AddLayerButton",RM.__docgenInfo={description:"",displayName:"AddLayerButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},layerTypes:{defaultValue:null,description:`An string array, to filter the supported file types that would be shown to the user
Default is: ['geojson', 'wms', 'csv', 'topojson', 'osm', 'gpx', 'kml', 'tcx']`,name:"layerTypes",required:!1,type:{name:"string[] | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const SLe=Yi(Z.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),xL="https://mapcomponents.github.io/react-map-components-maplibre/react-maplibre/",ELe=xL+"assets/WG-MapComponents-Logo_rgb.svg",TLe=xL+"assets/WG-MapComponents-Logo_rgb-weisse-schrift.svg",CLe=xL+"assets/mapcomponents_logo.png";function L$(t){const e=kc(),[r,n]=ee.useState(null),i=s=>{n(s.currentTarget)},a=()=>{n(null)};return Z.jsx(Rue,{sx:{minHeight:"62px",position:"absolute",zIndex:1300,top:0},children:Z.jsxs(Rge,{disableGutters:!0,children:[t.logo||Z.jsxs(Z.Fragment,{children:[Z.jsx(Ho,{sx:{marginLeft:"25px",display:{xs:"none",md:"flex"},flexGrow:{md:"30"}},children:Z.jsx("img",{src:e.palette.mode==="dark"?TLe:ELe,style:{width:"100%",maxWidth:"250px"}})}),Z.jsx(Ho,{sx:{marginLeft:"25px",display:{xs:"flex",sm:"flex",md:"none"},flexGrow:{xs:"500"},mr:{sm:"0px"}},children:Z.jsx("img",{src:CLe,width:"50px",height:"50px"})})]}),Z.jsx(Ho,{sx:{flexGrow:1,display:{xs:"flex"}},children:t.unmovableButtons}),t.buttons?Z.jsxs(Ho,{sx:{flexGrow:22,display:{xs:"flex",sm:"none"}},children:[Z.jsx(th,{onClick:i,children:Z.jsx(SLe,{})}),Z.jsx(UG,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!r,onClose:a,PaperProps:{elevation:24,sx:{overflow:"visible",mt:"15px"}},sx:{display:{xs:"block",sm:"none"}},children:Z.jsx(Ho,{sx:{paddingLeft:"10px",paddingRight:"10px"},onClick:a,children:t.buttons})})]}):"",Z.jsx(Ho,{sx:{marginRight:"25px",display:{xs:"none",sm:"flex"}},children:t.buttons})]})})}try{L$.displayName="TopToolbar",L$.__docgenInfo={description:"",displayName:"TopToolbar",props:{unmovableButtons:{defaultValue:null,description:"",name:"unmovableButtons",required:!1,type:{name:"ReactNode"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ReactNode"}},logo:{defaultValue:null,description:"",name:"logo",required:!1,type:{name:"ReactNode"}}}}}catch{}const ALe=Yi(Z.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function D$(t){const e=ee.useRef(null),r=()=>{if(!e.current)return!1;const i=e.current?.files?.[0];if(!i)return!1;const a=new FileReader;a.onload=s=>{s&&typeof t.setData=="function"&&t.setData(s.currentTarget?.result)},a.readAsText(i)},n=()=>{e.current&&e.current.click()};return Z.jsxs(Z.Fragment,{children:[t.buttonComponent?ht.cloneElement(t.buttonComponent,{onClick:n}):Z.jsx(ra,{onClick:n,children:Z.jsx(ALe,{})}),Z.jsx("input",{ref:e,onChange:r,type:"file",accept:t.accept,id:"input",multiple:!0,style:{display:"none"}})]})}try{D$.displayName="UploadButton",D$.__docgenInfo={description:"",displayName:"UploadButton",props:{setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"(data: string) => void"}},buttonComponent:{defaultValue:null,description:"",name:"buttonComponent",required:!0,type:{name:"any"}},accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string | undefined"}}}}}catch{}const eE=t=>{const e=()=>{t.setOpen(!1)};return Z.jsxs(nO,{open:t.open,onClose:e,PaperProps:{sx:{padding:"20px"}},children:[Z.jsx(Bm,{children:"Select a style"}),Z.jsx(ff,{children:t?.styles?.map(r=>Z.jsx(Ah,{disableGutters:!0,children:Z.jsxs(DG,{autoFocus:!0,onClick:()=>{t?.onSelect?.(r)},children:[Z.jsx(BG,{children:Z.jsx(EG,{sx:{width:"50px",height:"50px"},alt:r.name,src:r?.name&&t?.styleThumbnailPaths?.[r.name]})}),Z.jsx(mh,{primary:r.name})]})},r.name))})]})};eE.defaultProps={styleThumbnailPaths:{}};try{eE.displayName="SelectStylePopup",eE.__docgenInfo={description:"",displayName:"SelectStylePopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((style: StyleSpecification) => void) | undefined"}},styleThumbnailPaths:{defaultValue:{value:"{}"},description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}const ILe=Yi(Z.jsx("path",{d:"M4 4h7V2H4c-1.1 0-2 .9-2 2v7h2zm6 9-4 5h12l-3-4-2.03 2.71zm7-4.5c0-.83-.67-1.5-1.5-1.5S14 7.67 14 8.5s.67 1.5 1.5 1.5S17 9.33 17 8.5M20 2h-7v2h7v7h2V4c0-1.1-.9-2-2-2m0 18h-7v2h7c1.1 0 2-.9 2-2v-7h-2zM4 13H2v7c0 1.1.9 2 2 2h7v-2H4z"})),PLe={version:8,name:"Monokai",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:Gu.source_openmaptiles_url}},sprite:Gu.sprite,glyphs:Gu.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#75715E"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#837f6e"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#918d7e"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#A6C22E","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(166,194,46,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#e0ebad"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FD971F"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(253,151,31,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(18,5,68,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#A6E22E","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#A6C22E","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#A6C22E","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#66D9EF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#21c8e8"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#E6DB74","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#eee69f","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#fb70a2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(249,38,114,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(249,38,114,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#e60657","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(249,38,114,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fc89b2","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(18,5,68,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(18,5,68,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#E69F66","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#E69F66","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},kLe={version:8,name:"Solarized",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:Gu.source_openmaptiles_url}},sprite:Gu.sprite,glyphs:Gu.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#073642"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#657b83"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#74888f"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#84959c"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#859900","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(133,153,0,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#f2ff99"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#d30102"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(211,1,2,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(58,63,144,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#2aa198","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#859900","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#859900","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#268bd2","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#1a6091"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#eee8d5","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fdfcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#a3a6da","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(108,113,196,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(108,113,196,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#484fb5","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(108,113,196,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e58ab6","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(58,63,144,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(58,63,144,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#268bd2","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},MLe={version:8,name:"Oceanic Next",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:Gu.source_openmaptiles_url}},sprite:Gu.sprite,glyphs:Gu.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#a3be8c"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#acc598"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#b5cba3"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#a3be8c","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(163,19,14,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#cbdabe"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#b48ead"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(18,142,173,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#81a1c1","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#a3be8c","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#a3be8c","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#8fbcbb","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5f9f9e"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#65737e","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#7e8d98","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#8fbcbb","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},RLe={version:8,name:"Medieval Kingdom",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:Gu.source_openmaptiles_url}},sprite:Gu.sprite,glyphs:Gu.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#ffd1a8"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#bfa677"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#c5af85"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#ccb892"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#556B2F","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(85,107,47,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#d1e0b8"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FFC0CB"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(255,192,203,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(149,46,46,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#228B22","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#556B2F","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#556B2F","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#1E90FF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#006ad1"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#f9e9cb","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fefcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#d98383","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#df9797","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(139,94,6,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(205,92,92,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#bc3a3a","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(205,92,92,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e5aaaa","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(149,46,46,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(149,46,46,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#A0522D","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#A0522D","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},OLe={version:8,name:"Gruvbox",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:Gu.source_openmaptiles_url}},sprite:Gu.sprite,glyphs:Gu.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#b8bb26"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#bfc23c"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#c6c951"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#b8bb26","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(184,187,38,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#eceeaa"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#fe8019"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(254,128,25,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#83a598","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#b8bb26","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#b8bb26","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#83a598","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5c7f72"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#928374","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#a89c91","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#fb4934","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fb4934","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#83a598","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},B_="https://mapcomponents.github.io/react-map-components-maplibre/assets/style_thumbnails/",F$=({sx:t,styles:e=[],defaultStyles:r=!0,styleThumbnailPaths:n})=>{const i=ht.useContext(VR),[a,s]=ht.useState(!1);return Z.jsxs(Z.Fragment,{children:[Z.jsx(ra,{variant:"contained",sx:{marginTop:"10px",...t},onClick:()=>s(!0),children:Z.jsx(ILe,{})}),Z.jsx(eE,{styles:[...r?[PLe,kLe,MLe,RLe,OLe]:[],...e||[]],styleThumbnailPaths:{...n,...r?{Monokai:B_+"monokai.png",Gruvbox:B_+"gruvbox.png","Oceanic Next":B_+"oceanic_next.png",Solarized:B_+"solarized.png","Medieval Kingdom":B_+"medieval_kingdom.png"}:{}},open:a,setOpen:s,onSelect:o=>{i.setBackgroundLayers([]),setTimeout(()=>{i.updateStyle(o)},100),s(!1)}})]})};try{F$.displayName="SelectStyleButton",F$.__docgenInfo={description:"",displayName:"SelectStyleButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: StyleSpecification[]) => void) | undefined"}},styles:{defaultValue:{value:"[]"},description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},defaultStyles:{defaultValue:{value:"true"},description:"",name:"defaultStyles",required:!1,type:{name:"boolean | undefined"}},styleThumbnailPaths:{defaultValue:null,description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}var EI={exports:{}},TI={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B$;function NLe(){if(B$)return TI;B$=1;var t=Nb();function e(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,s=t.useMemo,o=t.useDebugValue;return TI.useSyncExternalStoreWithSelector=function(u,h,f,d,b){var v=i(null);if(v.current===null){var S={hasValue:!1,value:null};v.current=S}else S=v.current;v=s(function(){function P(z){if(!k){if(k=!0,L=z,z=d(z),b!==void 0&&S.hasValue){var B=S.value;if(b(B,z))return N=B}return N=z}if(B=N,r(L,z))return B;var q=d(z);return b!==void 0&&b(B,q)?(L=z,B):(L=z,N=q)}var k=!1,L,N,M=f===void 0?null:f;return[function(){return P(h())},M===null?void 0:function(){return P(M())}]},[h,f,d,b]);var E=n(u,v[0],v[1]);return a(function(){S.hasValue=!0,S.value=E},[E]),o(E),E},TI}var z$;function LLe(){return z$||(z$=1,EI.exports=NLe()),EI.exports}var DLe=LLe(),FLe=Symbol.for("react-redux-context"),BLe=typeof globalThis<"u"?globalThis:{};function zLe(){if(!ee.createContext)return{};const t=BLe[FLe]??=new Map;let e=t.get(ee.createContext);return e||(e=ee.createContext(null),t.set(ee.createContext,e)),e}var Im=zLe();function wL(t=Im){return function(){return ee.useContext(t)}}var PQ=wL();function kQ(t=Im){const e=t===Im?PQ:wL(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var jLe=kQ();function ULe(t=Im){const e=t===Im?jLe:kQ(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var MQ=ULe(),VLe=(t,e)=>t===e;function $Le(t=Im){const e=t===Im?PQ:wL(t),r=(n,i={})=>{const{equalityFn:a=VLe}=typeof i=="function"?{equalityFn:i}:i,s=e(),{store:o,subscription:u,getServerState:h}=s;ee.useRef(!0);const f=ee.useCallback({[n.name](b){return n(b)}}[n.name],[n]),d=DLe.useSyncExternalStoreWithSelector(u.addNestedSub,o.getState,h||o.getState,f,a);return ee.useDebugValue(d),d};return Object.assign(r,{withTypes:()=>r}),r}var um=$Le();function pu(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var qLe=typeof Symbol=="function"&&Symbol.observable||"@@observable",j$=qLe,CI=()=>Math.random().toString(36).substring(7).split("").join("."),HLe={INIT:`@@redux/INIT${CI()}`,REPLACE:`@@redux/REPLACE${CI()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${CI()}`},tE=HLe;function SL(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function RQ(t,e,r){if(typeof t!="function")throw new Error(pu(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pu(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pu(1));return r(RQ)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,u=!1;function h(){s===a&&(s=new Map,a.forEach((P,k)=>{s.set(k,P)}))}function f(){if(u)throw new Error(pu(3));return i}function d(P){if(typeof P!="function")throw new Error(pu(4));if(u)throw new Error(pu(5));let k=!0;h();const L=o++;return s.set(L,P),function(){if(k){if(u)throw new Error(pu(6));k=!1,h(),s.delete(L),a=null}}}function b(P){if(!SL(P))throw new Error(pu(7));if(typeof P.type>"u")throw new Error(pu(8));if(typeof P.type!="string")throw new Error(pu(17));if(u)throw new Error(pu(9));try{u=!0,i=n(i,P)}finally{u=!1}return(a=s).forEach(L=>{L()}),P}function v(P){if(typeof P!="function")throw new Error(pu(10));n=P,b({type:tE.REPLACE})}function S(){const P=d;return{subscribe(k){if(typeof k!="object"||k===null)throw new Error(pu(11));function L(){const M=k;M.next&&M.next(f())}return L(),{unsubscribe:P(L)}},[j$](){return this}}}return b({type:tE.INIT}),{dispatch:b,subscribe:d,getState:f,replaceReducer:v,[j$]:S}}function WLe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:tE.INIT})>"u")throw new Error(pu(12));if(typeof r(void 0,{type:tE.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(pu(13))})}function GLe(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{WLe(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let u=!1;const h={};for(let f=0;f<n.length;f++){const d=n[f],b=r[d],v=s[d],S=b(v,o);if(typeof S>"u")throw o&&o.type,new Error(pu(14));h[d]=S,u=u||S!==v}return u=u||n.length!==Object.keys(s).length,u?h:s}}function rE(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function XLe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(pu(15))};const s={getState:i.getState,dispatch:(u,...h)=>a(u,...h)},o=t.map(u=>u(s));return a=rE(...o)(i.dispatch),{...i,dispatch:a}}}function YLe(t){return SL(t)&&"type"in t&&typeof t.type=="string"}var OQ=Symbol.for("immer-nothing"),U$=Symbol.for("immer-draftable"),lh=Symbol.for("immer-state");function Qh(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var g0=Object.getPrototypeOf;function Pm(t){return!!t&&!!t[lh]}function ep(t){return t?NQ(t)||Array.isArray(t)||!!t[U$]||!!t.constructor?.[U$]||gx(t)||YT(t):!1}var ZLe=Object.prototype.constructor.toString();function NQ(t){if(!t||typeof t!="object")return!1;const e=g0(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ZLe}function nE(t,e){XT(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function XT(t){const e=t[lh];return e?e.type_:Array.isArray(t)?1:gx(t)?2:YT(t)?3:0}function OM(t,e){return XT(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function LQ(t,e,r){const n=XT(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function KLe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function gx(t){return t instanceof Map}function YT(t){return t instanceof Set}function Ug(t){return t.copy_||t.base_}function NM(t,e){if(gx(t))return new Map(t);if(YT(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=NQ(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[lh];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(g0(t),n)}else{const n=g0(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function EL(t,e=!1){return ZT(t)||Pm(t)||!ep(t)||(XT(t)>1&&Object.defineProperties(t,{set:{value:j2},add:{value:j2},clear:{value:j2},delete:{value:j2}}),Object.freeze(t),e&&Object.values(t).forEach(r=>EL(r,!0))),t}function j2(){Qh(2)}function ZT(t){return Object.isFrozen(t)}var JLe={};function km(t){const e=JLe[t];return e||Qh(0,t),e}var Sb;function DQ(){return Sb}function QLe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function V$(t,e){e&&(km("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function LM(t){DM(t),t.drafts_.forEach(eDe),t.drafts_=null}function DM(t){t===Sb&&(Sb=t.parent_)}function $$(t){return Sb=QLe(Sb,t)}function eDe(t){const e=t[lh];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function q$(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[lh].modified_&&(LM(e),Qh(4)),ep(t)&&(t=iE(e,t),e.parent_||aE(e,t)),e.patches_&&km("Patches").generateReplacementPatches_(r[lh].base_,t,e.patches_,e.inversePatches_)):t=iE(e,r,[]),LM(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==OQ?t:void 0}function iE(t,e,r){if(ZT(e))return e;const n=e[lh];if(!n)return nE(e,(i,a)=>H$(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return aE(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),nE(a,(o,u)=>H$(t,n,i,o,u,r,s)),aE(t,i,!1),r&&t.patches_&&km("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function H$(t,e,r,n,i,a,s){if(Pm(i)){const o=a&&e&&e.type_!==3&&!OM(e.assigned_,n)?a.concat(n):void 0,u=iE(t,i,o);if(LQ(r,n,u),Pm(u))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(ep(i)&&!ZT(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;iE(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(gx(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&aE(t,i)}}function aE(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&EL(e,r)}function tDe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:DQ(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=TL;r&&(i=[n],a=Eb);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var TL={get(t,e){if(e===lh)return t;const r=Ug(t);if(!OM(r,e))return rDe(t,r,e);const n=r[e];return t.finalized_||!ep(n)?n:n===AI(t.base_,e)?(II(t),t.copy_[e]=BM(n,t)):n},has(t,e){return e in Ug(t)},ownKeys(t){return Reflect.ownKeys(Ug(t))},set(t,e,r){const n=FQ(Ug(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=AI(Ug(t),e),a=i?.[lh];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(KLe(r,i)&&(r!==void 0||OM(t.base_,e)))return!0;II(t),FM(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return AI(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,II(t),FM(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Ug(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Qh(11)},getPrototypeOf(t){return g0(t.base_)},setPrototypeOf(){Qh(12)}},Eb={};nE(TL,(t,e)=>{Eb[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Eb.deleteProperty=function(t,e){return Eb.set.call(this,t,e,void 0)};Eb.set=function(t,e,r){return TL.set.call(this,t[0],e,r,t[0])};function AI(t,e){const r=t[lh];return(r?Ug(r):t)[e]}function rDe(t,e,r){const n=FQ(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function FQ(t,e){if(!(e in t))return;let r=g0(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=g0(r)}}function FM(t){t.modified_||(t.modified_=!0,t.parent_&&FM(t.parent_))}function II(t){t.copy_||(t.copy_=NM(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var nDe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(u=a,...h){return s.produce(u,f=>r.call(this,f,...h))}}typeof r!="function"&&Qh(6),n!==void 0&&typeof n!="function"&&Qh(7);let i;if(ep(e)){const a=$$(this),s=BM(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?LM(a):DM(a)}return V$(a,n),q$(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===OQ&&(i=void 0),this.autoFreeze_&&EL(i,!0),n){const a=[],s=[];km("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Qh(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,u=>e(u,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){ep(t)||Qh(8),Pm(t)&&(t=iDe(t));const e=$$(this),r=BM(t,void 0);return r[lh].isManual_=!0,DM(e),r}finishDraft(t,e){const r=t&&t[lh];(!r||!r.isManual_)&&Qh(9);const{scope_:n}=r;return V$(n,e),q$(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=km("Patches").applyPatches_;return Pm(t)?n(t,e):this.produce(t,i=>n(i,e))}};function BM(t,e){const r=gx(t)?km("MapSet").proxyMap_(t,e):YT(t)?km("MapSet").proxySet_(t,e):tDe(t,e);return(e?e.scope_:DQ()).drafts_.push(r),r}function iDe(t){return Pm(t)||Qh(10,t),BQ(t)}function BQ(t){if(!ep(t)||ZT(t))return t;const e=t[lh];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=NM(t,e.scope_.immer_.useStrictShallowCopy_)}else r=NM(t,!0);return nE(r,(n,i)=>{LQ(r,n,BQ(i))}),e&&(e.finalized_=!1),r}var aDe=new nDe,zQ=aDe.produce;function jQ(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var oDe=jQ(),sDe=jQ,lDe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?rE:rE.apply(null,arguments)};function W$(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(qd(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>YLe(n)&&n.type===t,r}var UQ=class f1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,f1.prototype)}static get[Symbol.species](){return f1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new f1(...e[0].concat(this)):new f1(...e.concat(this))}};function G$(t){return ep(t)?zQ(t,()=>{}):t}function U2(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function uDe(t){return typeof t=="boolean"}var cDe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new UQ;return r&&(uDe(r)?s.push(oDe):s.push(sDe(r.extraArgument))),s},hDe="RTK_autoBatch",X$=t=>e=>{setTimeout(e,t)},fDe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:X$(10):t.type==="callback"?t.queueNotification:X$(t.timeout),h=()=>{s=!1,a&&(a=!1,o.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const d=()=>i&&f(),b=n.subscribe(d);return o.add(f),()=>{b(),o.delete(f)}},dispatch(f){try{return i=!f?.meta?.[hDe],a=!i,a&&(s||(s=!0,u(h))),n.dispatch(f)}finally{i=!0}}})},dDe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new UQ(t);return n&&i.push(fDe(typeof n=="object"?n:void 0)),i};function pDe(t){const e=cDe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(SL(r))o=GLe(r);else throw new Error(qd(1));let u;typeof n=="function"?u=n(e):u=e();let h=rE;i&&(h=lDe({trace:!1,...typeof i=="object"&&i}));const f=XLe(...u),d=dDe(f);let b=typeof s=="function"?s(d):d();const v=h(...b);return RQ(o,a,v)}function VQ(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(qd(28));if(o in e)throw new Error(qd(29));return e[o]=s,i},addAsyncThunk(a,s){return s.pending&&(e[a.pending.type]=s.pending),s.rejected&&(e[a.rejected.type]=s.rejected),s.fulfilled&&(e[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function gDe(t){return typeof t=="function"}function mDe(t,e){let[r,n,i]=VQ(e),a;if(gDe(t))a=()=>G$(t());else{const o=G$(t);a=()=>o}function s(o=a(),u){let h=[r[u.type],...n.filter(({matcher:f})=>f(u)).map(({reducer:f})=>f)];return h.filter(f=>!!f).length===0&&(h=[i]),h.reduce((f,d)=>{if(d)if(Pm(f)){const v=d(f,u);return v===void 0?f:v}else{if(ep(f))return zQ(f,b=>d(b,u));{const b=d(f,u);if(b===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return f},o)}return s.getInitialState=a,s}var yDe=Symbol.for("rtk-slice-createasyncthunk");function vDe(t,e){return`${t}/${e}`}function _De({creators:t}={}){const e=t?.asyncThunk?.[yDe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(qd(11));const s=(typeof n.reducers=="function"?n.reducers(wDe()):n.reducers)||{},o=Object.keys(s),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(N,M){const z=typeof N=="string"?N:N.type;if(!z)throw new Error(qd(12));if(z in u.sliceCaseReducersByType)throw new Error(qd(13));return u.sliceCaseReducersByType[z]=M,h},addMatcher(N,M){return u.sliceMatchers.push({matcher:N,reducer:M}),h},exposeAction(N,M){return u.actionCreators[N]=M,h},exposeCaseReducer(N,M){return u.sliceCaseReducersByName[N]=M,h}};o.forEach(N=>{const M=s[N],z={reducerName:N,type:vDe(i,N),createNotation:typeof n.reducers=="function"};EDe(M)?CDe(z,M,h,e):SDe(z,M,h)});function f(){const[N={},M=[],z=void 0]=typeof n.extraReducers=="function"?VQ(n.extraReducers):[n.extraReducers],B={...N,...u.sliceCaseReducersByType};return mDe(n.initialState,q=>{for(let W in B)q.addCase(W,B[W]);for(let W of u.sliceMatchers)q.addMatcher(W.matcher,W.reducer);for(let W of M)q.addMatcher(W.matcher,W.reducer);z&&q.addDefaultCase(z)})}const d=N=>N,b=new Map,v=new WeakMap;let S;function E(N,M){return S||(S=f()),S(N,M)}function P(){return S||(S=f()),S.getInitialState()}function k(N,M=!1){function z(q){let W=q[N];return typeof W>"u"&&M&&(W=U2(v,z,P)),W}function B(q=d){const W=U2(b,M,()=>new WeakMap);return U2(W,q,()=>{const G={};for(const[ie,J]of Object.entries(n.selectors??{}))G[ie]=bDe(J,q,()=>U2(v,q,P),M);return G})}return{reducerPath:N,getSelectors:B,get selectors(){return B(z)},selectSlice:z}}const L={name:i,reducer:E,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:P,...k(a),injectInto(N,{reducerPath:M,...z}={}){const B=M??a;return N.inject({reducerPath:B,reducer:E},z),{...L,...k(B,!0)}}};return L}}function bDe(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var xDe=_De();function wDe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function SDe({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!TDe(n))throw new Error(qd(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?W$(t,s):W$(t))}function EDe(t){return t._reducerDefinitionType==="asyncThunk"}function TDe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function CDe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(qd(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:u,settled:h,options:f}=r,d=i(t,a,f);n.exposeAction(e,d),s&&n.addCase(d.fulfilled,s),o&&n.addCase(d.pending,o),u&&n.addCase(d.rejected,u),h&&n.addMatcher(d.settled,h),n.exposeCaseReducer(e,{fulfilled:s||V2,pending:o||V2,rejected:u||V2,settled:h||V2})}function V2(){}function qd(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}function $Q(t,e,r){e.forEach(n=>{t(n,r),n.layers&&n.layers.length>0&&$Q(t,n.layers,n)})}const ADe={mapConfigs:{}},qQ=xDe({name:"mapConfig",initialState:ADe,reducers:{setMapConfig:(t,e)=>{const r=e.payload.mapConfig,n=e.payload.key;t.mapConfigs[n]=r},removeMapConfig:(t,e)=>{delete t.mapConfigs[e.payload.key]},setLayerInMapConfig:(t,e)=>{const{mapConfigKey:r,layer:n}=e.payload,i=t.mapConfigs[r];if(i){for(let a=0;a<i.layers.length;a++)if(i.layers[a].uuid===n.uuid){i.layers[a]=n;break}}},removeLayerFromMapConfig:(t,e)=>{const{mapConfigKey:r,layerUuid:n}=e.payload,i=t.mapConfigs[r];if(i){const a=i.layers.findIndex(s=>s.uuid===n);a!==-1&&(delete i.layers[a],$Q(function(s,o){o&&o.layers&&(o.layers=o.layers.filter(u=>u.uuid!==n))},i.layerOrder))}},updateLayerOrder:(t,e)=>{const{mapConfigKey:r,newOrder:n}=e.payload,i=t.mapConfigs[r];i&&(i.layerOrder=n)},setMasterVisible(t,e){const{mapConfigKey:r,layerId:n,masterVisible:i}=e.payload,a=t.mapConfigs[r];if(a){const s=a.layers.findIndex(o=>o.uuid===n);if(s!==-1){const o=a.layers[s];if(o){const u=[...a.layers];o.type==="folder"&&a.layerOrder.forEach(h=>{h.uuid===n&&h.layers?.forEach(f=>{const d=a.layers.findIndex(v=>v.uuid===f.uuid),b=u[d];u[d]={...b,masterVisible:i},b?.type==="vt"&&b?.config?.layers&&(b.config.layers=b.config.layers.map(v=>({...v,masterVisible:i})))})}),o.type==="vt"&&o?.config?.layers&&(o.config.layers=o.config.layers.map(h=>({...h,masterVisible:i}))),t.mapConfigs[r].layers=u}}}}}}),HQ=(t,e)=>{const r=t.mapConfigs;for(const n in r){const i=r[n],a=i.layers.findIndex(o=>o.uuid===e),s=i.layers[a];if(s)return s}return null},IDe=(t,e)=>{const r=t.mapConfig.mapConfigs[e];if(!r)return[];const n=r.layerOrder,i=[];function a(s){s.forEach(o=>{i.push(o.uuid),o.layers&&o.layers.length>0&&a(o.layers)})}return a(n),i};pDe({reducer:{mapConfig:qQ.reducer}});const{setMapConfig:CWe,removeMapConfig:AWe,setLayerInMapConfig:WQ,removeLayerFromMapConfig:IWe,updateLayerOrder:PDe,setMasterVisible:kDe}=qQ.actions,Y$=Yi(Z.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}));function zM(t){return Z.jsx(pb,{value:t.value,label:"Color",onChange:e=>{typeof t.onChange=="function"&&t.onChange(e)}})}try{zM.displayName="PaintPropsColorPicker",zM.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const MDe=Br(Eh)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),RDe=Br(Ho)({marginLeft:"61px"}),GQ={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},ODe=Object.keys(GQ),NDe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function jM(t){const e=ee.useRef(Math.round(Math.random()*1e10)),r=HQ(um(o=>o.mapConfig),t.layerUuid),n=MQ(),i=ee.useMemo(()=>r?.config?.options?.paint?r?.config?.options?.paint:{},[r?.config?.options?.paint]),a=(o,u)=>{const h={...r,config:{...r?.config,options:{...r?.config?.options,paint:{...r?.config?.options?.paint,[o]:u}}}};n(WQ({mapConfigKey:t.mapConfigKey,layer:h}))},s=ee.useCallback(o=>{if(i?.[o]&&ODe.indexOf(o)!==-1&&(typeof i[o]=="number"||typeof i[o]=="string")){const u=Z.jsx(bs,{id:o+"_label",gutterBottom:!0,children:o});switch(GQ[o]){case"slider":return Z.jsxs(ht.Fragment,{children:[u,Z.jsx(cO,{...NDe[o],value:i[o],valueLabelDisplay:"auto",onChange:(h,f)=>{f&&typeof f=="number"&&a(o,f)}})]},o);case"numberfield":return Z.jsxs(ht.Fragment,{children:[u,Z.jsx(iT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:i[o],onChange:h=>{h?.target?.value&&a(o,parseInt(h.target.value))}})]},o);case"colorpicker":return Z.jsxs(ht.Fragment,{children:[u,Z.jsx(Ho,{sx:{"& > div":{width:"initial !important"}},children:Z.jsx(zM,{value:i[o],onChange:h=>{a(o,h)}},o)})]},o)}}return null},[i]);return Z.jsx(Z.Fragment,{children:Z.jsx(MDe,{children:Z.jsx(Ah,{children:Z.jsx(RDe,{children:i&&Object.keys(i).map(o=>s(o))})},e.current+"_paintPropForm")})})}try{jM.displayName="LayerPropertyForm",jM.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{layerUuid:{defaultValue:null,description:"",name:"layerUuid",required:!0,type:{name:"string"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}const LDe=Br(th)({padding:"4px",marginTop:"-3px"}),DDe=Br(th)({marginLeft:"20px"}),z_=Br(Ah)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),PI=Br(Q1)({minWidth:"30px"}),$2=Br(th)({marginRight:"0px",padding:"0px"}),Z$=Br(Ho)(({open:t})=>({display:t?"block":"none"})),K$=Br(ff)({marginLeft:"50px"});function oE(t){const[e,r]=ee.useState(!1),[n,i]=ee.useState(!1),a=HQ(um(P=>P.mapConfig),t.layerOrderConfig.uuid),[s,o]=ee.useState(!1),u=MQ(),h=um(P=>P.mapConfig.mapConfigs[t.mapConfigKey]);function f(P,k){const L=JSON.parse(JSON.stringify(h.layerOrder)),N=M=>{let z=!1;return M.forEach((B,q)=>{if(!z)if(B.uuid===P){const W=k(q);if(W<0||W>=M.length)throw new Error("New position is out of bounds");const[G]=M.splice(q,1);M.splice(W,0,G),z=!0}else B.layers&&N(B.layers)&&(z=!0)}),z};N(L),u(PDe({mapConfigKey:t.mapConfigKey,newOrder:L}))}const d=P=>{f(P,k=>k+1)},b=P=>{f(P,k=>k-1)};function v(P,k=""){const L=!P;a&&(S(a,L,k),(a.type==="folder"||a.type==="vt"&&k==="")&&u(kDe({mapConfigKey:t.mapConfigKey,layerId:a.uuid,masterVisible:L})))}function S(P,k,L){let N={...P};if(P?.type==="folder")N={...P,visible:!P.visible};else switch(P?.type){case"geojson":{N={...P,config:{...P.config,options:{...P?.config?.options,layout:{...P?.config?.options?.layout,visibility:k?"visible":"none"}}}};break}case"vt":{let M=!1;const z=P.config.layers.map(B=>B.id===L?(M=!0,{...B,layout:{...B.layout,visibility:k?"visible":"none"}}):B);M?N={...P,config:{...P.config,layers:z}}:N={...P,visible:k,config:{...P.config,layers:z}};break}case"wms":{N={...P,visible:k,config:{...P.config,visible:k}};break}}return u(WQ({mapConfigKey:t.mapConfigKey,layer:N})),N}function E(P){let k=!0;if(P?.type==="geojson")return k=P?.config?.options?.layout?.visibility!=="none",Z.jsxs(Z.Fragment,{children:[Z.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:Z.jsxs(Z.Fragment,{children:[t?.buttons,Z.jsx($2,{disabled:!1,onClick:()=>{d(P.uuid)},children:Z.jsx(Iw,{})}),Z.jsx($2,{disabled:!1,onClick:()=>{b(P.uuid)},children:Z.jsx(Pw,{})}),P.configurable&&Z.jsx(Z.Fragment,{children:Z.jsx(LDe,{edge:"end","aria-label":"settings",onClick:()=>{r(L=>!L)},children:Z.jsx(oN,{})})})]}),children:[Z.jsx(Nd,{children:Z.jsx(Ld,{checked:k,disabled:P.masterVisible===!1,onClick:()=>v(k)})}),Z.jsx(mh,{variant:"layerlist",primary:P.name||"",secondary:t.description,primaryTypographyProps:{overflow:"hidden"}}),t.buttons]},P.uuid),P.configurable&&e&&Z.jsxs(Z.Fragment,{children:[t.showDeleteButton&&Z.jsxs(Z.Fragment,{children:[Z.jsx(DDe,{edge:"end","aria-label":"delete",onClick:()=>{},children:Z.jsx(nx,{})}),n&&Z.jsx(f0,{open:n,onConfirm:()=>{i(!1)},onCancel:()=>{i(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),Z.jsx(jM,{layerUuid:P.uuid,mapConfigKey:t.mapConfigKey})]})]});if(P?.type==="vt")return Z.jsxs(Z.Fragment,{children:[Z.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[Z.jsxs(PI,{children:[Z.jsx($2,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?Z.jsx(xS,{}):Z.jsx(Y$,{})}),Z.jsx(Nd,{children:Z.jsx(Ld,{checked:P.visible,disabled:P.masterVisible===!1,onClick:()=>v(P.visible??!1)})})]}),Z.jsx(mh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid),Z.jsx(Z$,{open:s,children:Z.jsx(K$,{disablePadding:!0,children:P.config?.layers?.map(L=>Z.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[" ",Z.jsx(PI,{children:Z.jsx(Nd,{children:Z.jsx(Ld,{checked:(L?.layout?.visibility??"visible")==="visible",disabled:L?.masterVisible===!1,onClick:()=>v(L?.layout?.visibility==="visible",L.id)})})}),Z.jsx(mh,{variant:"layerlist",primary:L["source-layer"],primaryTypographyProps:{overflow:"hidden"}},L.id)]},L.id))})},P.uuid+"_list")]});if(P?.type==="wms"){const L=P.config?.visible??!0;return Z.jsx(Z.Fragment,{children:Z.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[Z.jsx(Nd,{children:Z.jsx(Ld,{checked:L,disabled:P.masterVisible===!1,onClick:()=>v(L)})}),Z.jsx(mh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid)})}return P.type==="folder"?Z.jsxs(Z.Fragment,{children:[Z.jsxs(z_,{sx:{...t.listItemSx},children:[Z.jsxs(PI,{children:[Z.jsx($2,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?Z.jsx(xS,{}):Z.jsx(Y$,{})}),Z.jsx(Nd,{children:Z.jsx(Ld,{checked:P.visible,disabled:P.masterVisible,onClick:()=>v(P.visible?P.visible:!1)})})]}),Z.jsx(mh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid),Z.jsx(Z$,{open:s,children:Z.jsx(K$,{disablePadding:!0,children:t?.layerOrderConfig?.layers?.map(L=>Z.jsx(oE,{layerOrderConfig:L,mapConfigKey:t.mapConfigKey},L.uuid))})},P.uuid+"_list")]}):Z.jsx(Z.Fragment,{})}return Z.jsx(Z.Fragment,{children:a&&E(a)})}try{oE.displayName="LayerTreeListItem",oE.__docgenInfo={description:"",displayName:"LayerTreeListItem",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"((state: unknown) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},layerOrderConfig:{defaultValue:null,description:"",name:"layerOrderConfig",required:!0,type:{name:"LayerOrderItem"}}}}}catch{}const FDe=Br(ff)({marginTop:"15px"});function J$(t){const e=um(r=>r.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder);return Z.jsx(FDe,{children:e?.map?.(r=>Z.jsx(oE,{layerOrderConfig:r,mapConfigKey:t.mapConfigKey},r.uuid))})}try{J$.displayName="LayerTree",J$.__docgenInfo={description:"",displayName:"LayerTree",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}function Q$(t){const e=um(u=>u.mapConfig.mapConfigs?.[t.mapConfigKey]?.layers),r=um(u=>u.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder),n=pa({mapId:t?.mapId}),i=um(u=>IDe(u,t.mapConfigKey)),a=ee.useRef([]);ee.useEffect(()=>{if(!n.map||!r)return;const u=(f,d,b)=>{for(let v=0;v<f.length;v++){const S=f[v],E=d?d[v]:null;if(S.uuid!==E?.uuid&&b.getLayer(S.uuid)){const P=v>0?f[v-1].uuid:void 0;b.moveLayer(S.uuid,P)}if(S.layers&&S.layers.length>0){const P=E?.layers||[];u(S.layers,P,b)}}},h=a.current;u(r,h,n.map),a.current=r},[r,n.map]);const s=ee.useMemo(()=>["order-background",...i.map(h=>"layer_id_"+h),"order-labels"],[i]);function o(u){const h=e.findIndex(d=>d.uuid===u.uuid),f=e[h];switch(f?.type){case"geojson":return Z.jsx(Ac,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,...f.config,options:{...f.config.options,layout:{...f?.config?.options?.layout,visibility:f.masterVisible===!1?"none":f?.config?.options?.layout?.visibility?f?.config?.options?.layout?.visibility:"visible"}}},f.uuid);case"vt":{const d=f.config.layers.map(b=>{const v={...b};return v.layout&&(v.layout={...v.layout,visibility:v.masterVisible===!1?"none":v.layout.visibility??"visible"}),v});return Z.jsx(qv,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,url:f.config.url,layers:d},f.uuid)}case"wms":{const d=f.masterVisible===!1?!1:f.config?.visible;return Z.jsx(zS,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,url:f.config?.url||"",urlParameters:f.config?.urlParameters,visible:d},f.uuid)}case"folder":return u?.layers?u.layers.map(d=>o(d)):Z.jsx(Z.Fragment,{});default:return null}}return Z.jsxs(Z.Fragment,{children:[Z.jsx(VS,{layerIds:s}),r?.map?.(u=>o(u))]})}try{Q$.displayName="LayerOnMap",Q$.__docgenInfo={description:"",displayName:"LayerOnMap",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const BDe=[(t,e)=>{const r=ee.useMemo(()=>nG(e?.globals?.theme),[e?.globals?.theme]);return Z.jsx("div",{className:"fullscreen_map",children:Z.jsx(TP,{children:Z.jsxs(rG,{theme:r,children:[Z.jsx(t,{}),Z.jsx(aG,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"}),Z.jsx(iM,{sx:{bottom:"25px",right:"5px"},showZoomButtons:!1,mapId:"map_1"})]})})})}];function sE(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const CL=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),eq=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);eq&&parseFloat(eq[1]);const tq=globalThis,rq=globalThis.process||{},zDe=globalThis.navigator||{};function XQ(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const r=typeof navigator<"u"&&navigator.userAgent;return!!(r&&r.indexOf("Electron")>=0)}function Zm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||XQ()}function jDe(t){return Zm()?XQ()?"Electron":(zDe.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const YQ="4.1.0";function UDe(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}class VDe{constructor(e,r,n="sessionStorage"){this.storage=UDe(n),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){const r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}function $De(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function qDe(t,e=8){const r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var lE;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(lE||(lE={}));const HDe=10;function nq(t){return typeof t!="string"?t:(t=t.toUpperCase(),lE[t]||lE.WHITE)}function WDe(t,e,r){return!Zm&&typeof t=="string"&&(e&&(t=`\x1B[${nq(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${nq(r)+HDe}m${t}\x1B[49m`)),t}function GDe(t,e=["constructor"]){const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=t;for(const a of n){const s=i[a];typeof s=="function"&&(e.find(o=>a===o)||(i[a]=s.bind(t)))}}function AL(t,e){if(!t)throw new Error("Assertion failed")}function jy(){let t;if(Zm()&&tq.performance)t=tq?.performance?.now?.();else if("hrtime"in rq){const e=rq?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const Uy={debug:Zm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},XDe={enabled:!0,level:0};function Vy(){}const iq={},aq={once:!0};class mx{constructor({id:e}={id:""}){this.VERSION=YQ,this._startTs=jy(),this._deltaTs=jy(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new VDe(`__probe-${this.id}__`,XDe),this.timeStamp(`${this.id} started`),GDe(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((jy()-this._startTs).toPrecision(10))}getDelta(){return Number((jy()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Uy.warn,arguments,aq)}error(e){return this._getLogFunction(0,e,Uy.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,Uy.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,Uy.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,Uy.debug||Uy.info,arguments,aq)}table(e,r,n){return r?this._getLogFunction(e,r,console.table||Vy,n&&[n],{tag:ZDe(r)}):Vy}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||Vy)}group(e,r,n={collapsed:!1}){const i=oq({logLevel:e,message:r,opts:n}),{collapsed:a}=n;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,r,n={}){return this.group(e,r,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Vy)}withGroup(e,r,n){this.group(e,r)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ZQ(e)}_getLogFunction(e,r,n,i,a){if(this._shouldLog(e)){a=oq({logLevel:e,message:r,args:i,opts:a}),n=n||a.method,AL(n),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=jy();const s=a.tag||a.message;if(a.once&&s)if(!iq[s])iq[s]=jy();else return Vy;return r=YDe(this.id,a.message,a),n.bind(console,r,...a.args)}return Vy}}mx.VERSION=YQ;function ZQ(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return AL(Number.isFinite(e)&&e>=0),e}function oq(t){const{logLevel:e,message:r}=t;t.logLevel=ZQ(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return AL(i==="string"||i==="object"),Object.assign(t,{args:n},t.opts)}function YDe(t,e,r){if(typeof e=="string"){const n=r.time?qDe($De(r.total)):"";e=r.time?`${t}: ${n}  ${e}`:`${t}: ${e}`,e=WDe(e,r.color,r.background)}return e}function ZDe(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}const kI="4.3.3",KDe=kI[0]>="0"&&kI[0]<="9"?`v${kI}`:"";function JDe(){const t=new mx({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=KDe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const QDe=JDe();function e6e(t,e){return KQ(t||{},e)}function KQ(t,e,r=0){if(r>3)return e;const n={...t};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?n[i]=KQ(n[i]||{},e[i],r+1):n[i]=e[i];return n}const t6e="latest";function r6e(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const n6e=r6e();function ag(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const cm=typeof process!="object"||String(process)!=="[object process]"||process.browser,i6e=typeof window<"u"&&typeof window.orientation<"u",sq=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);sq&&parseFloat(sq[1]);class a6e{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){ag(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ag(this.isRunning),this.isRunning=!1,this._reject(e)}}class MI{terminate(){}}const RI=new Map;function o6e(t){ag(t.source&&!t.url||!t.source&&t.url);let e=RI.get(t.source||t.url);return e||(t.url&&(e=s6e(t.url),RI.set(t.url,e)),t.source&&(e=JQ(t.source),RI.set(t.source,e))),ag(e),e}function s6e(t){if(!t.startsWith("http"))return t;const e=l6e(t);return JQ(e)}function JQ(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function l6e(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function QQ(t,e=!0,r){const n=r||new Set;if(t){if(lq(t))n.add(t);else if(lq(t.buffer))n.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)QQ(t[i],e,n)}}return r===void 0?Array.from(n):[]}function lq(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const OI=()=>{};class UM{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&cm||typeof MI<"u"&&!cm}constructor(e){const{name:r,source:n,url:i}=e;ag(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=OI,this.onError=a=>console.log(a),this.worker=cm?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=OI,this.onError=OI,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||QQ(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=o6e({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new MI(n,{eval:!1})}else if(this.source)e=new MI(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}}class u6e{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return UM.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(i,a,s)=>i.done(s),n=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:r,onError:n,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});const n=new a6e(r.name,e);e.onMessage=i=>r.onMessage(n,i.type,i.payload),e.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!cm||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new UM({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return i6e?this.maxMobileConcurrency:this.maxConcurrency}}const c6e={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Op{props;workerPools=new Map;static _workerFarm;static isSupported(){return UM.isSupported()}static getWorkerFarm(e={}){return Op._workerFarm=Op._workerFarm||new Op({}),Op._workerFarm.setProps(e),Op._workerFarm}constructor(e){this.props={...c6e},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:r,source:n,url:i}=e;let a=this.workerPools.get(r);return a||(a=new u6e({name:r,source:n,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function h6e(t,e={}){const r=e[t.id]||{},n=cm?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=r.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(cm?i=`modules/${t.module}/dist/${n}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let a=t.version;a==="latest"&&(a=t6e);const s=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${n}`}return ag(i),i}function f6e(t,e=n6e){ag(t,"no worker provided");const r=t.version;return!(!e||!r)}function d6e(t,e){return!Op.isSupported()||!cm&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function p6e(t,e,r,n,i){const a=t.id,s=h6e(t,r),u=Op.getWorkerFarm(r).getWorkerPool({name:a,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const h=await u.startJob("process-on-worker",g6e.bind(null,i));return h.postMessage("process",{input:e,options:r,context:n}),await(await h.result).result}async function g6e(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:a,options:s}=n;try{const o=await t(a,s);e.postMessage("done",{id:i,result:o})}catch(o){const u=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function m6e(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}function y6e(...t){return v6e(t)}function v6e(t){const e=t.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=e.reduce((a,s)=>a+s.byteLength,0),n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.byteLength;return n.buffer}async function _6e(t){const e=[];for await(const r of t)e.push(r);return y6e(...e)}function uq(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class cq{constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=uq(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(uq()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class KT{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const r of Object.values(this.stats))e(r)}getTable(){const e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){const{name:r,type:n}=e;let i=this.stats[r];return i||(e instanceof cq?i=e:i=new cq(r,n),this.stats[r]=i),i}}let b6e="";const hq={};function x6e(t){for(const e in hq)if(t.startsWith(e)){const r=hq[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${b6e}${t}`),t}function w6e(t){return t&&typeof t=="object"&&t.isBuffer}function eee(t){if(w6e(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function tee(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function S6e(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const E6e=t=>typeof t=="boolean",D1=t=>typeof t=="function",yx=t=>t!==null&&typeof t=="object",fq=t=>yx(t)&&t.constructor==={}.constructor,T6e=t=>!!t&&typeof t[Symbol.iterator]=="function",C6e=t=>t&&typeof t[Symbol.asyncIterator]=="function",Km=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Jm=t=>typeof Blob<"u"&&t instanceof Blob,A6e=t=>t&&typeof t=="object"&&t.isBuffer,I6e=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||yx(t)&&D1(t.tee)&&D1(t.cancel)&&D1(t.getReader),P6e=t=>yx(t)&&D1(t.read)&&D1(t.pipe)&&E6e(t.readable),ree=t=>I6e(t)||P6e(t);class k6e extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response}const M6e=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,R6e=/^([-\w.]+\/[-\w.+]+)/;function dq(t,e){return t.toLowerCase()===e.toLowerCase()}function O6e(t){const e=R6e.exec(t);return e?e[1]:t}function pq(t){const e=M6e.exec(t);return e?e[1]:""}const nee=/\?.*/;function N6e(t){const e=t.match(nee);return e&&e[0]}function IL(t){return t.replace(nee,"")}function L6e(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function JT(t){return Km(t)?t.url:Jm(t)?t.name||"":typeof t=="string"?t:""}function PL(t){if(Km(t)){const e=t,r=e.headers.get("content-type")||"",n=IL(e.url);return O6e(r)||pq(n)}return Jm(t)?t.type||"":typeof t=="string"?pq(t):""}function D6e(t){return Km(t)?t.headers["content-length"]||-1:Jm(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function iee(t){if(Km(t))return t;const e={},r=D6e(t);r>=0&&(e["content-length"]=String(r));const n=JT(t),i=PL(t);i&&(e["content-type"]=i);const a=await z6e(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function F6e(t){if(!t.ok)throw await B6e(t)}async function B6e(t){const e=L6e(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");n.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new k6e(r,n)}async function z6e(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const r=t.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=a=>n(a?.target?.result),i.readAsDataURL(r)})}if(t instanceof ArrayBuffer){const r=t.slice(0,5);return`data:base64,${j6e(r)}`}return null}function j6e(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}function U6e(t){return!V6e(t)&&!$6e(t)}function V6e(t){return t.startsWith("http:")||t.startsWith("https:")}function $6e(t){return t.startsWith("data:")}async function gq(t,e){if(typeof t=="string"){const r=x6e(t);return U6e(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await iee(t)}const mq=new mx({id:"loaders.gl"});class q6e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class H6e{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const aee={fetch:null,mimeType:void 0,nothrow:!1,log:new H6e,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:CL,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},W6e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function oee(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function see(){const t=oee();return t.globalOptions=t.globalOptions||{...aee},t.globalOptions}function G6e(t,e,r,n){return r=r||[],r=Array.isArray(r)?r:[r],X6e(t,r),Z6e(e,t,n)}function X6e(t,e){yq(t,null,aee,W6e,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},a=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};yq(n,r.id,i,a,e)}}function yq(t,e,r,n,i){const a=e||"Top level",s=e?`${e}.`:"";for(const o in t){const u=!e&&yx(t[o]),h=o==="baseUri"&&!e,f=o==="workerUrl"&&e;if(!(o in r)&&!h&&!f){if(o in n)mq.warn(`${a} loader option '${s}${o}' no longer supported, use '${n[o]}'`)();else if(!u){const d=Y6e(o,i);mq.warn(`${a} loader option '${s}${o}' not recognized. ${d}`)()}}}}function Y6e(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const a in i.options){if(t===a)return`Did you mean '${i.id}.${a}'?`;const s=a.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${a}'?`)}return n}function Z6e(t,e,r){const i={...t.options||{}};return K6e(i,r),i.log===null&&(i.log=new q6e),vq(i,see()),vq(i,e),i}function vq(t,e){for(const r in e)if(r in e){const n=e[r];fq(n)&&fq(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function K6e(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function kL(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function ML(t){sE(t,"null loader"),sE(kL(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const lee=()=>{const t=oee();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function J6e(t){const e=lee();t=Array.isArray(t)?t:[t];for(const r of t){const n=ML(r);e.find(i=>n===i)||e.unshift(n)}}function Q6e(){return lee()}const eFe=/\.([^.]+)$/;async function tFe(t,e=[],r,n){if(!uee(t))return null;let i=_q(t,e,{...r,nothrow:!0},n);if(i)return i;if(Jm(t)&&(t=await t.slice(0,10).arrayBuffer(),i=_q(t,e,r,n)),!i&&!r?.nothrow)throw new Error(cee(t));return i}function _q(t,e=[],r,n){if(!uee(t))return null;if(e&&!Array.isArray(e))return ML(e);let i=[];e&&(i=i.concat(e)),r?.ignoreRegisteredLoaders||i.push(...Q6e()),nFe(i);const a=rFe(t,i,r,n);if(!a&&!r?.nothrow)throw new Error(cee(t));return a}function rFe(t,e,r,n){const i=JT(t),a=PL(t),s=IL(i)||n?.url;let o=null,u="";return r?.mimeType&&(o=NI(e,r?.mimeType),u=`match forced by supplied MIME type ${r?.mimeType}`),o=o||iFe(e,s),u=u||(o?`matched url ${s}`:""),o=o||NI(e,a),u=u||(o?`matched MIME type ${a}`:""),o=o||oFe(e,t),u=u||(o?`matched initial data ${hee(t)}`:""),r?.fallbackMimeType&&(o=o||NI(e,r?.fallbackMimeType),u=u||(o?`matched fallback MIME type ${a}`:"")),u&&QDe.log(1,`selectLoader selected ${o?.name}: ${u}.`),o}function uee(t){return!(t instanceof Response&&t.status===204)}function cee(t){const e=JT(t),r=PL(t);let n="No valid loader found (";n+=e?`${tee(e)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=t?hee(t):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function nFe(t){for(const e of t)ML(e)}function iFe(t,e){const r=e&&eFe.exec(e),n=r&&r[1];return n?aFe(t,n):null}function aFe(t,e){e=e.toLowerCase();for(const r of t)for(const n of r.extensions)if(n.toLowerCase()===e)return r;return null}function NI(t,e){for(const r of t)if(r.mimeTypes?.some(n=>dq(e,n))||dq(e,`application/x.${r.id}`))return r;return null}function oFe(t,e){if(!e)return null;for(const r of t)if(typeof e=="string"){if(sFe(e,r))return r}else if(ArrayBuffer.isView(e)){if(bq(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&bq(e,0,r))return r;return null}function sFe(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>t.startsWith(n))}function bq(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>lFe(t,e,r,i))}function lFe(t,e,r,n){if(n instanceof ArrayBuffer)return m6e(n,t,n.byteLength);switch(typeof n){case"function":return n(t);case"string":const i=VM(t,e,n.length);return n===i;default:return!1}}function hee(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?VM(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?VM(t,0,e):""}function VM(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(e+a));return i}const uFe=256*1024;function*cFe(t,e){const r=e?.chunkSize||uFe;let n=0;const i=new TextEncoder;for(;n<t.length;){const a=Math.min(t.length-n,r),s=t.slice(n,n+a);n+=a,yield i.encode(s)}}const hFe=256*1024;function*fFe(t,e={}){const{chunkSize:r=hFe}=e;let n=0;for(;n<t.byteLength;){const i=Math.min(t.byteLength-n,r),a=new ArrayBuffer(i),s=new Uint8Array(t,n,i);new Uint8Array(a).set(s),n+=i,yield a}}const dFe=1024*1024;async function*pFe(t,e){const r=e?.chunkSize||dFe;let n=0;for(;n<t.size;){const i=n+r,a=await t.slice(n,i).arrayBuffer();n=i,yield a}}function xq(t,e){return CL?gFe(t,e):mFe(t)}async function*gFe(t,e){const r=t.getReader();let n;try{for(;;){const i=n||r.read();e?._streamReadAhead&&(n=r.read());const{done:a,value:s}=await i;if(a)return;yield eee(s)}}catch{r.releaseLock()}}async function*mFe(t,e){for await(const r of t)yield eee(r)}function yFe(t,e){if(typeof t=="string")return cFe(t,e);if(t instanceof ArrayBuffer)return fFe(t,e);if(Jm(t))return pFe(t,e);if(ree(t))return xq(t,e);if(Km(t))return xq(t.body,e);throw new Error("makeIterator")}const fee="Cannot convert supplied data type";function vFe(t,e,r){if(e.text&&typeof t=="string")return t;if(A6e(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(fee)}async function _Fe(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||n)return vFe(t,e);if(Jm(t)&&(t=await iee(t)),Km(t)){const i=t;return await F6e(i),e.binary?await i.arrayBuffer():await i.text()}if(ree(t)&&(t=yFe(t,r)),T6e(t)||C6e(t))return _6e(t);throw new Error(fee)}function dee(t,e){const r=see(),n=t||r;return typeof n.fetch=="function"?n.fetch:yx(n.fetch)?i=>gq(i,n.fetch):e?.fetch?e?.fetch:gq}function bFe(t,e,r){if(r)return r;const n={fetch:dee(e,t),...t};if(n.url){const i=IL(n.url);n.baseUrl=i,n.queryString=N6e(n.url),n.filename=tee(i),n.baseUrl=S6e(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function xFe(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function uE(t,e,r,n){e&&!Array.isArray(e)&&!kL(e)&&(n=void 0,r=e,e=void 0),t=await t,r=r||{};const i=JT(t),s=xFe(e,n),o=await tFe(t,s,r);return o?(r=G6e(r,o,s,i),n=bFe({url:i,_parse:uE,loaders:s},r,n||null),await wFe(o,t,r,n)):null}async function wFe(t,e,r,n){if(f6e(t),r=e6e(t.options,r),Km(e)){const a=e,{ok:s,redirected:o,status:u,statusText:h,type:f,url:d}=a,b=Object.fromEntries(a.headers.entries());n.response={headers:b,ok:s,redirected:o,status:u,statusText:h,type:f,url:d}}e=await _Fe(e,t,r);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,r,n);if(d6e(t,r))return await p6e(t,e,r,n,uE);if(i.parseText&&typeof e=="string")return await i.parseText(e,r,n);if(i.parse)return await i.parse(e,r,n);throw ag(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function $M(t,e,r,n){let i,a;!Array.isArray(e)&&!kL(e)?(i=[],a=e):(i=e,a=r);const s=dee(a);let o=t;return typeof t=="string"&&(o=await s(t)),Jm(t)&&(o=await s(t)),Array.isArray(i)?await uE(o,i,a):await uE(o,i,a)}const SFe="4.3.3",EFe=globalThis.loaders?.parseImageNode,qM=typeof Image<"u",HM=typeof ImageBitmap<"u",TFe=!!EFe,WM=CL?!0:TFe;function CFe(t){switch(t){case"auto":return HM||qM||WM;case"imagebitmap":return HM;case"image":return qM;case"data":return WM;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function AFe(){if(HM)return"imagebitmap";if(qM)return"image";if(WM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function IFe(t){const e=kFe(t);if(!e)throw new Error("Not an image");return e}function PFe(t){switch(IFe(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function kFe(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const MFe=/^data:image\/svg\+xml/,RFe=/\.svg((\?|#).*)?$/;function RL(t){return t&&(MFe.test(t)||RFe.test(t))}function OFe(t,e){if(RL(e)){let n=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return pee(t,e)}function pee(t,e){if(RL(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function gee(t,e,r){const n=OFe(t,r),i=self.URL||self.webkitURL,a=typeof n!="string"&&i.createObjectURL(n);try{return await NFe(a||n,e)}finally{a&&i.revokeObjectURL(a)}}async function NFe(t,e){const r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=a=>{const s=a instanceof Error?a.message:"error";i(new Error(s))}}catch(a){i(a)}})}const LFe={};let wq=!0;async function DFe(t,e,r){let n;RL(r)?n=await gee(t,e,r):n=pee(t,r);const i=e&&e.imagebitmap;return await FFe(n,i)}async function FFe(t,e=null){if((BFe(e)||!wq)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),wq=!1}return await createImageBitmap(t)}function BFe(t){for(const e in t||LFe)return!1;return!0}function zFe(t){return!$Fe(t,"ftyp",4)||(t[8]&96)===0?null:jFe(t)}function jFe(t){switch(UFe(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function UFe(t,e,r){return String.fromCharCode(...t.slice(e,r))}function VFe(t){return[...t].map(e=>e.charCodeAt(0))}function $Fe(t,e,r=0){const n=VFe(e);for(let i=0;i<n.length;++i)if(n[i]!==t[i+r])return!1;return!0}const $f=!1,F1=!0;function mee(t){const e=vx(t);return HFe(e)||XFe(e)||WFe(e)||GFe(e)||qFe(e)}function qFe(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),r=zFe(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function HFe(t){const e=vx(t);return e.byteLength>=24&&e.getUint32(0,$f)===2303741511?{mimeType:"image/png",width:e.getUint32(16,$f),height:e.getUint32(20,$f)}:null}function WFe(t){const e=vx(t);return e.byteLength>=10&&e.getUint32(0,$f)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,F1),height:e.getUint16(8,F1)}:null}function GFe(t){const e=vx(t);return e.byteLength>=14&&e.getUint16(0,$f)===16973&&e.getUint32(2,F1)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,F1),height:e.getUint32(22,F1)}:null}function XFe(t){const e=vx(t);if(!(e.byteLength>=3&&e.getUint16(0,$f)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=YFe();let a=2;for(;a+9<e.byteLength;){const s=e.getUint16(a,$f);if(i.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,$f),width:e.getUint16(a+7,$f)};if(!n.has(s))return null;a+=2,a+=e.getUint16(a,$f)}return null}function YFe(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function vx(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function ZFe(t,e){const{mimeType:r}=mee(t)||{},n=globalThis.loaders?.parseImageNode;return sE(n),await n(t,r)}async function KFe(t,e,r){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=r||{},s=JFe(i);let o;switch(s){case"imagebitmap":o=await DFe(t,e,a);break;case"image":o=await gee(t,e,a);break;case"data":o=await ZFe(t);break;default:sE(!1)}return i==="data"&&(o=PFe(o)),o}function JFe(t){switch(t){case"auto":case"data":return AFe();default:return CFe(t),t}}const QFe=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],e8e=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],t8e={image:{type:"auto",decode:!0}},r8e={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:SFe,mimeTypes:e8e,extensions:QFe,parse:KFe,tests:[t=>!!mee(new DataView(t))],options:t8e},Xa=new mx({id:"deck"});let GM={};function n8e(t){GM=t}function Hu(t,e,r,n){Xa.level>0&&GM[t]&&GM[t].call(null,e,r,n)}function i8e(t){const e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}const a8e={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:i8e,parseTextSync:JSON.parse};function o8e(){const t="9.1.14",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(Xa.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Xa,_registerLoggers:n8e},J6e([a8e,[r8e,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const s8e=o8e();function OL(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const LI={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function l8e(t){const e={};for(const[r,n]of Object.entries(t))e[r]=u8e(n);return e}function u8e(t){let e=Sq(t);if(e!=="object")return{value:t,...LI[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...LI[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=Sq(t.value),{...t,...LI[e],type:e}):{type:"object",value:null};throw new Error("props")}function Sq(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const c8e=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,h8e=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,f8e={vertex:c8e,fragment:h8e},Eq=/void\s+main\s*\([^)]*\)\s*\{\n?/,Tq=/}\n?[^{}]*$/,DI=[],kw="__LUMA_INJECT_DECLARATIONS__";function d8e(t){const e={vertex:{},fragment:{}};for(const r in t){let n=t[r];const i=p8e(r);typeof n=="string"&&(n={order:0,injection:n}),e[i][r]=n}return e}function p8e(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function cE(t,e,r,n=!1){const i=e==="vertex";for(const a in r){const s=r[a];s.sort((u,h)=>u.order-h.order),DI.length=s.length;for(let u=0,h=s.length;u<h;++u)DI[u]=s[u].injection;const o=`${DI.join(`
`)}
`;switch(a){case"vs:#decl":i&&(t=t.replace(kw,o));break;case"vs:#main-start":i&&(t=t.replace(Eq,u=>u+o));break;case"vs:#main-end":i&&(t=t.replace(Tq,u=>o+u));break;case"fs:#decl":i||(t=t.replace(kw,o));break;case"fs:#main-start":i||(t=t.replace(Eq,u=>u+o));break;case"fs:#main-end":i||(t=t.replace(Tq,u=>o+u));break;default:t=t.replace(a,u=>u+o)}}return t=t.replace(kw,""),n&&(t=t.replace(/\}\s*$/,a=>a+f8e[e])),t}function hE(t){t.map(e=>g8e(e))}function g8e(t){if(t.instance)return;hE(t.dependencies||[]);const{propTypes:e={},deprecations:r=[],inject:n={}}=t,i={normalizedInjections:d8e(n),parsedDeprecations:m8e(r)};e&&(i.propValidators=l8e(e)),t.instance=i;let a={};e&&(a=Object.entries(e).reduce((s,[o,u])=>{const h=u?.value;return h&&(s[o]=h),s},{})),t.defaultUniforms={...t.defaultUniforms,...a}}function yee(t,e,r){t.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function m8e(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function NL(t){hE(t);const e={},r={};vee({modules:t,level:0,moduleMap:e,moduleDepth:r});const n=Object.keys(r).sort((i,a)=>r[a]-r[i]).map(i=>e[i]);return hE(n),n}function vee(t){const{modules:e,level:r,moduleMap:n,moduleDepth:i}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)n[a.name]=a,(i[a.name]===void 0||i[a.name]<r)&&(i[a.name]=r);for(const a of e)a.dependencies&&vee({modules:a.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function y8e(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function v8e(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=Cq(t,_8e),t;case"fragment":return t=Cq(t,b8e),t;default:throw new Error(e)}}const _ee=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],_8e=[..._ee,[XM("attribute"),"in $1"],[XM("varying"),"out $1"]],b8e=[..._ee,[XM("varying"),"in $1"]];function Cq(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}function XM(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function bee(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),e[n]){const a=e[n];a.sort((s,o)=>s.order-o.order);for(const s of a)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function xee(t){const e={vertex:{},fragment:{}};for(const r of t){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();const[a,s]=i.split(":"),o=i.replace(/\(.+/,""),u=Object.assign(n,{signature:s});switch(a){case"vs":e.vertex[o]=u;break;case"fs":e.fragment[o]=u;break;default:throw new Error(a)}}return e}function x8e(t,e){return{name:w8e(t,e),language:"glsl",version:S8e(t)}}function w8e(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function S8e(t){let e=100;const r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){const n=parseInt(r[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const wee=`

${kw}
`,E8e=`precision highp float;
`;function T8e(t){const e=NL(t.modules||[]);return{source:A8e(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:See(e)}}function C8e(t){const{vs:e,fs:r}=t,n=NL(t.modules||[]);return{vs:Aq(t.platformInfo,{...t,source:e,stage:"vertex",modules:n}),fs:Aq(t.platformInfo,{...t,source:r,stage:"fragment",modules:n}),getUniforms:See(n)}}function A8e(t,e){const{source:r,stage:n,modules:i,hookFunctions:a=[],inject:s={},log:o}=e;OL(typeof r=="string","shader source must be a string");const u=r;let h="";const f=xee(a),d={},b={},v={};for(const E in s){const P=typeof s[E]=="string"?{injection:s[E],order:0}:s[E],k=/^(v|f)s:(#)?([\w-]+)$/.exec(E);if(k){const L=k[2],N=k[3];L?N==="decl"?b[E]=[P]:v[E]=[P]:d[E]=[P]}else v[E]=[P]}const S=i;for(const E of S){o&&yee(E,u,o);const P=Eee(E,"wgsl");h+=P;const k=E.injections?.[n]||{};for(const L in k){const N=/^(v|f)s:#([\w-]+)$/.exec(L);if(N){const z=N[2]==="decl"?b:v;z[L]=z[L]||[],z[L].push(k[L])}else d[L]=d[L]||[],d[L].push(k[L])}}return h+=wee,h=cE(h,n,b),h+=bee(f[n],d),h+=u,h=cE(h,n,v),h}function Aq(t,e){const{id:r,source:n,stage:i,language:a="glsl",modules:s,defines:o={},hookFunctions:u=[],inject:h={},prologue:f=!0,log:d}=e;OL(typeof n=="string","shader source must be a string");const b=a==="glsl"?x8e(n).version:-1,v=t.shaderLanguageVersion,S=b===100?"#version 100":"#version 300 es",P=n.split(`
`).slice(1).join(`
`),k={};s.forEach(q=>{Object.assign(k,q.defines)}),Object.assign(k,o);let L="";switch(a){case"wgsl":break;case"glsl":L=f?`${S}

// ----- PROLOGUE -------------------------
${I8e({id:r,source:n,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${y8e(t)}
${i==="fragment"?E8e:""}

// ----- APPLICATION DEFINES -------------------------

${P8e(k)}

`:`${S}
`;break}const N=xee(u),M={},z={},B={};for(const q in h){const W=typeof h[q]=="string"?{injection:h[q],order:0}:h[q],G=/^(v|f)s:(#)?([\w-]+)$/.exec(q);if(G){const ie=G[2],J=G[3];ie?J==="decl"?z[q]=[W]:B[q]=[W]:M[q]=[W]}else B[q]=[W]}for(const q of s){d&&yee(q,P,d);const W=Eee(q,i);L+=W;const G=q.instance?.normalizedInjections[i]||{};for(const ie in G){const J=/^(v|f)s:#([\w-]+)$/.exec(ie);if(J){const ne=J[2]==="decl"?z:B;ne[ie]=ne[ie]||[],ne[ie].push(G[ie])}else M[ie]=M[ie]||[],M[ie].push(G[ie])}}return L+="// ----- MAIN SHADER SOURCE -------------------------",L+=wee,L=cE(L,i,z),L+=bee(N[i],M),L+=P,L=cE(L,i,B),a==="glsl"&&b!==v&&(L=v8e(L,i)),L.trim()}function See(t){return function(r){const n={};for(const i of t){const a=i.getUniforms?.(r,n);Object.assign(n,a)}return n}}function I8e(t){const{id:e,source:r,stage:n}=t;return e&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${n}`:""}function P8e(t={}){let e="";for(const r in t){const n=t[r];(n||Number.isFinite(n))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function Eee(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:OL(!1)}if(!t.name)throw new Error("Shader module must have a name");const n=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}const k8e=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,M8e=/^\s*\#\s*endif\s*$/;function R8e(t,e){const r=t.split(`
`),n=[];let i=!0,a=null;for(const s of r){const o=s.match(k8e),u=s.match(M8e);o?(a=o[1],i=!!e?.defines?.[a]):u?i=!0:i&&n.push(s)}return n.join(`
`)}class Qg{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Qg.defaultShaderAssembler=Qg.defaultShaderAssembler||new Qg,Qg.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const r=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:a}=T8e({...e,source:e.source,modules:r,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?R8e(i):i,getUniforms:a,modules:r}}assembleGLSLShaderPair(e){const r=this._getModuleList(e.modules),n=this._hookFunctions;return{...C8e({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(e=[]){const r=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let a=0,s=this._defaultModules.length;a<s;++a){const o=this._defaultModules[a],u=o.name;r[i++]=o,n[u]=!0}for(let a=0,s=e.length;a<s;++a){const o=e[a],u=o.name;n[u]||(r[i++]=o,n[u]=!0)}return r.length=i,hE(r),r}}const O8e=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,N8e=`#version 300 es
${O8e}`;function L8e(t){const{input:e,inputChannels:r,output:n}={};if(!e)return N8e;if(!r)throw new Error("inputChannels");const i=D8e(r),a=F8e(e,r);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${a};
}`}function D8e(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function F8e(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class B8e{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new KT({id:e})),this.stats.get(e)}}const Tee=new B8e,yn=new mx({id:"luma.gl"}),FI={};function QT(t="id"){FI[t]=FI[t]||1;const e=FI[t]++;return`${t}-${e}`}let wo=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,n){if(!e)throw new Error("no device");this._device=e,this.props=z8e(r,n);const i=this.props.id!=="undefined"?this.props.id:QT(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}};function z8e(t,e){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}class Fo extends wo{static defaultProps={...wo.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){const n={...r};(r.usage||0)&Fo.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,Fo.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,r){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,n){const i=ArrayBuffer.isView(e)?e.buffer:e,a=Math.min(e?e.byteLength:n,Fo.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(a):r===0&&n===i.byteLength?this.debugData=i.slice(0,a):this.debugData=i.slice(r,r+a)}}function Cee(t){const e=Iq[t],r=j8e(e),n=t.includes("norm"),i=!n&&!t.startsWith("float"),a=t.startsWith("s");return{dataType:Iq[t],byteLength:r,integer:i,signed:a,normalized:n}}function j8e(t){return U8e[t]}const Iq={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},U8e={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},ju="texture-compression-bc",vo="texture-compression-astc",Lf="texture-compression-etc2",V8e="texture-compression-etc1-webgl",q2="texture-compression-pvrtc-webgl",BI="texture-compression-atc-webgl",H2="float32-renderable-webgl",zI="float16-renderable-webgl",$8e="rgb9e5ufloat-renderable-webgl",jI="snorm8-renderable-webgl",j_="norm16-renderable-webgl",UI="snorm16-renderable-webgl",W2="float32-filterable",Pq="float16-filterable-webgl";function Aee(t){const e=q8e[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const q8e={r8unorm:{},r8snorm:{render:jI},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:jI},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:zI,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:j_},"r16snorm-webgl":{f:UI},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:jI},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:zI,filter:Pq},"rg16unorm-webgl":{render:j_},"rg16snorm-webgl":{render:UI},r32uint:{},r32sint:{},r32float:{render:H2,filter:W2},rgb9e5ufloat:{channels:"rgb",packed:!0,render:$8e},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:H2},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:j_},"rgb16snorm-webgl":{f:j_},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:W2},rgba16uint:{},rgba16sint:{},rgba16float:{render:zI,filter:Pq},"rgba16unorm-webgl":{render:j_},"rgba16snorm-webgl":{render:UI},"rgb32float-webgl":{render:H2,filter:W2},rgba32uint:{},rgba32sint:{},rgba32float:{render:H2,filter:W2},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:ju},"bc1-rgb-unorm-srgb-webgl":{f:ju},"bc1-rgba-unorm":{f:ju},"bc1-rgba-unorm-srgb":{f:ju},"bc2-rgba-unorm":{f:ju},"bc2-rgba-unorm-srgb":{f:ju},"bc3-rgba-unorm":{f:ju},"bc3-rgba-unorm-srgb":{f:ju},"bc4-r-unorm":{f:ju},"bc4-r-snorm":{f:ju},"bc5-rg-unorm":{f:ju},"bc5-rg-snorm":{f:ju},"bc6h-rgb-ufloat":{f:ju},"bc6h-rgb-float":{f:ju},"bc7-rgba-unorm":{f:ju},"bc7-rgba-unorm-srgb":{f:ju},"etc2-rgb8unorm":{f:Lf},"etc2-rgb8unorm-srgb":{f:Lf},"etc2-rgb8a1unorm":{f:Lf},"etc2-rgb8a1unorm-srgb":{f:Lf},"etc2-rgba8unorm":{f:Lf},"etc2-rgba8unorm-srgb":{f:Lf},"eac-r11unorm":{f:Lf},"eac-r11snorm":{f:Lf},"eac-rg11unorm":{f:Lf},"eac-rg11snorm":{f:Lf},"astc-4x4-unorm":{f:vo},"astc-4x4-unorm-srgb":{f:vo},"astc-5x4-unorm":{f:vo},"astc-5x4-unorm-srgb":{f:vo},"astc-5x5-unorm":{f:vo},"astc-5x5-unorm-srgb":{f:vo},"astc-6x5-unorm":{f:vo},"astc-6x5-unorm-srgb":{f:vo},"astc-6x6-unorm":{f:vo},"astc-6x6-unorm-srgb":{f:vo},"astc-8x5-unorm":{f:vo},"astc-8x5-unorm-srgb":{f:vo},"astc-8x6-unorm":{f:vo},"astc-8x6-unorm-srgb":{f:vo},"astc-8x8-unorm":{f:vo},"astc-8x8-unorm-srgb":{f:vo},"astc-10x5-unorm":{f:vo},"astc-10x5-unorm-srgb":{f:vo},"astc-10x6-unorm":{f:vo},"astc-10x6-unorm-srgb":{f:vo},"astc-10x8-unorm":{f:vo},"astc-10x8-unorm-srgb":{f:vo},"astc-10x10-unorm":{f:vo},"astc-10x10-unorm-srgb":{f:vo},"astc-12x10-unorm":{f:vo},"astc-12x10-unorm-srgb":{f:vo},"astc-12x12-unorm":{f:vo},"astc-12x12-unorm-srgb":{f:vo},"pvrtc-rgb4unorm-webgl":{f:q2},"pvrtc-rgba4unorm-webgl":{f:q2},"pvrtc-rbg2unorm-webgl":{f:q2},"pvrtc-rgba2unorm-webgl":{f:q2},"etc1-rbg-unorm-webgl":{f:V8e},"atc-rgb-unorm-webgl":{f:BI},"atc-rgba-unorm-webgl":{f:BI},"atc-rgbai-unorm-webgl":{f:BI}},H8e=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],W8e=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function Iee(t){return H8e.some(e=>t.startsWith(e))}function LL(t){let e=G8e(t);if(Iee(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=X8e(t);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const r=W8e.exec(t);if(r){const[,n,i,a,s,o]=r,u=`${a}${i}`,h=Cee(u),f=h.byteLength*8,d=n.length,b=[f,d>=2?f:0,d>=3?f:0,d>=4?f:0];e={format:t,attachment:e.attachment,dataType:h.dataType,components:d,channels:n,integer:h.integer,signed:h.signed,normalized:h.normalized,bitsPerChannel:b,bytesPerPixel:h.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function G8e(t){const e=Aee(t),r=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function X8e(t){const r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){const[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function Y8e(t){const e=Aee(t),r={format:t,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},n=LL(t),i=t.startsWith("depth")||t.startsWith("stencil"),a=n?.signed,s=n?.integer,o=n?.webgl;return r.render&&=!a,r.filter&&=!i&&!a&&!s&&!o,r}class Z8e{}class K8e{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class Gp{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>yn.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:yn.get("debug")||void 0,debugShaders:yn.get("debug-shaders")||void 0,debugFramebuffers:!!yn.get("debug-framebuffers"),debugWebGL:!!yn.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...Gp.defaultProps,...e},this.id=this.props.id||QT(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=Tee;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const r=Y8e(e),n=s=>(typeof s=="string"?this.features.has(s):s)??!0,i=n(r.create),a={format:e,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)};return this._getDeviceSpecificTextureFormatCapabilities(a)}isTextureFormatSupported(e,r){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Iee(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const r={...e};return(e.usage||0)&Fo.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array?r.indexType="uint16":yn.warn("indices buffer content must be of integer type")()),r}}const J8e=Zm()&&typeof document<"u",Q8e=()=>J8e&&document.readyState==="complete",eBe="set luma.log.level=1 (or higher) to trace rendering",kq="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class Av{static defaultProps={...Gp.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=tBe().then(()=>{yn.probe(2,"DOM is loaded")()});stats=Tee;log=yn;VERSION="9.1.9";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw yn.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),yn.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");yn.error("This version of luma.gl has already been initialized")()}yn.log(1,`${this.VERSION} - ${eBe}`)(),globalThis.luma=this}registerAdapters(e){for(const r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){const r=this.getAdapterMap(e);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapter(e=[]){const r=this.getAdapterMap(e);return r.get("webgpu")?.isSupported?.()?"webgpu":r.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(Av.defaultProps,e)}async createDevice(e={}){e={...Av.defaultProps,...e},e.waitForPageLoad&&await Av.pageLoaded;const r=this.getAdapterMap(e.adapters);let n=e.type||"";n==="best-available"&&(n=this.getBestAvailableAdapter(e.adapters)||n);const s=await(this.getAdapterMap(e.adapters)||r).get(n)?.create?.(e);if(s)return s;throw new Error(kq)}async attachDevice(e){const r=this.getAdapterMap(e.adapters);let n="";e.handle instanceof WebGL2RenderingContext&&(n="webgl"),e.createCanvasContext&&await Av.pageLoaded,e.handle===null&&(n="unknown");const a=await r.get(n)?.attach?.(null);if(a)return a;throw new Error(kq)}enforceWebGL2(e=!0,r=[]){const i=this.getAdapterMap(r).get("webgl");i||yn.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const r=new Map(this.preregisteredAdapters);for(const n of e)r.set(n.type,n);return r}registerDevices(e){yn.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const r of e){const n=r.adapter;n&&this.preregisteredAdapters.set(n.type,n)}}}const YM=new Av;function tBe(){return Q8e()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}class rBe{}class DL{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...DL.defaultProps,...e},e=this.props,!Zm()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=iBe(e.canvas):this.canvas=e.canvas;else{const r=aBe(e),n=nBe(e?.container||null);n.insertBefore(r,n.firstChild),this.canvas=r,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(const n of r)n.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*e,r.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,r]=this.getPixelSize();return e/r}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return r?e/r:1}catch{return 1}}cssToDevicePixels(e,r=!0){const n=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return oBe(e,n,i,a,r)}setDevicePixelRatio(e,r={}){if(!this.htmlCanvas)return;let n="width"in r?r.width:this.htmlCanvas.clientWidth,i="height"in r?r.height:this.htmlCanvas.clientHeight;(!n||!i)&&(yn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const a=this._canvasSizeInfo;if(a.clientWidth!==n||a.clientHeight!==i||a.devicePixelRatio!==e){let s=e;const o=Math.floor(n*s),u=Math.floor(i*s);if(this.htmlCanvas.width=o,this.htmlCanvas.height=u,this.device.gl){const[f,d]=this.getDrawingBufferSize();(f!==o||d!==u)&&(s=Math.min(f/n,d/i),this.htmlCanvas.width=Math.floor(n*s),this.htmlCanvas.height=Math.floor(i*s),yn.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}function nBe(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function iBe(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function aBe(t){const{width:e,height:r}=t,n=document.createElement("canvas");return n.id=QT("lumagl-auto-created-canvas"),n.width=e||1,n.height=r||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}function oBe(t,e,r,n,i){const a=t,s=Mq(a[0],e,r);let o=Rq(a[1],e,n,i),u=Mq(a[0]+1,e,r);const h=u===r-1?u:u-1;u=Rq(a[1]+1,e,n,i);let f;return i?(u=u===0?u:u+1,f=o,o=u):f=u===n-1?u:u-1,{x:s,y:o,width:Math.max(h-s+1,1),height:Math.max(f-o+1,1)}}function Mq(t,e,r){return Math.min(Math.round(t*e),r-1)}function Rq(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}class _o extends wo{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...wo.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,r){if(r=_o.normalizeProps(e,r),super(e,r,_o.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const n=_o.getTextureDataSize(this.props.data);this.width=n?.width||1,this.height=n?.height||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?_o.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement||typeof VideoFrame<"u"&&e instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if(typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if(typeof VideoFrame<"u"&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const r=e?.data;return ArrayBuffer.isView(r)}static getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return _o.getTextureDataSize(e[0]);if(_o.isExternalImage(e))return _o.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,r){let n;return ArrayBuffer.isView(e)?n=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?n=e:n=[e],n}static getMipLevelCount(e,r){return Math.floor(Math.log2(Math.max(e,r)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,r){const n={...r},i=e?.props?._resourceDefaults?.texture||{};Object.assign(n,i);const{width:a,height:s}=n;return typeof a=="number"&&(n.width=Math.max(1,Math.ceil(a))),typeof s=="number"&&(n.height=Math.max(1,Math.ceil(s))),n}}class eC extends wo{static defaultProps={...wo.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,eC.defaultProps)}}function sBe(t,e,r){let n="";const i=e.split(/\r?\n/),a=t.slice().sort((s,o)=>s.lineNum-o.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let o=1;o<=i.length;o++)for(n+=Pee(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){const u=a[s++];n+=Oq(u,i,u.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of t)n+=Oq(o,i,o.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function Oq(t,e,r,n){if(n?.inlineSource){const a=lBe(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${a}${s}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function lBe(t,e,r){let n="";for(let i=e-2;i<=e;i++){const a=t[i-1];a!==void 0&&(n+=Pee(a,e,r))}return n}function Pee(t,e,r){const n=r?.html?cBe(t):t;return`${uBe(String(e),4)}: ${n}${r?.html?"<br/>":`
`}`}function uBe(t,e){let r="";for(let n=t.length;n<e;++n)r+=" ";return r+t}function cBe(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class tC extends wo{static defaultProps={...wo.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:hBe(r),...r},tC.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(e){if(typeof document>"u"||!document?.createElement)return;const r=kee(this.source),n=`${this.stage} ${r}`;let i=sBe(e,this.source,{showSourceCode:"all",html:!0});const a=this.getTranslatedSource();a&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${a}</pre></code>`);const s=document.createElement("Button");s.innerHTML=`
<h1>Shader Compilation Error in ${n}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,s.style.top="10px",s.style.left="10px",s.style.position="absolute",s.style.zIndex="9999",s.style.width="100%",s.style.textAlign="left",document.body.appendChild(s),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),s.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}}function hBe(t){return kee(t.source)||t.id||QT(`unnamed ${t.stage}-shader`)}function kee(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}class Tb extends wo{static defaultProps={...wo.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=Tb.normalizeProps(e,r),super(e,r,Tb.defaultProps)}static normalizeProps(e,r){const n=e?.props?._resourceDefaults?.sampler||{};return{...r,...n}}}class rC extends wo{static defaultProps={...wo.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,rC.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const r=this.colorAttachments.map(i=>i.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(e){let r=!e;if(e){const[n,i]=Array.isArray(e)?e:[e.width,e.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(yn.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){const i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof _o?r.view:r});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof _o?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:_o.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:_o.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.colorAttachments[n].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}class m0 extends wo{static defaultProps={...wo.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,m0.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}class Xg extends wo{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...wo.defaultProps,framebuffer:null,parameters:void 0,clearColor:Xg.defaultClearColor,clearColors:void 0,clearDepth:Xg.defaultClearDepth,clearStencil:Xg.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=Xg.normalizeProps(e,r),super(e,r,Xg.defaultProps)}static normalizeProps(e,r){return{...e.props._resourceDefaults?.renderPass,...r}}}class fE extends wo{static defaultProps={...wo.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,fE.defaultProps),this.shaderLayout=r.shaderLayout}}class FL extends wo{static defaultProps={...wo.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,FL.defaultProps)}}class BL extends wo{static defaultProps={...wo.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,BL.defaultProps)}}function fBe(t){const[e,r]=pBe[t],n=e==="i32"||e==="u32",i=e!=="u32",a=gBe[e]*r,s=dBe(e,r);return{dataType:e,components:r,defaultVertexFormat:s,byteLength:a,integer:n,signed:i}}function dBe(t,e){let r;switch(t){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?r:`${r}x${e}`}const pBe={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},gBe={f32:4,f16:2,i32:4,u32:4};function Mee(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[r,n]=t.split("x"),i=r,a=n?parseInt(n):1,s=Cee(i),o={type:i,components:a,byteLength:s.byteLength*a,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(o.webglOnly=!0),o}function Ree(t,e){const r={};for(const n of t.attributes){const i=yBe(t,e,n.name);i&&(r[n.name]=i)}return r}function mBe(t,e,r=16){const n=Ree(t,e),i=new Array(r).fill(null);for(const a of Object.values(n))i[a.location]=a;return i}function yBe(t,e,r){const n=vBe(t,r),i=_Be(e,r);if(!n)return null;const a=fBe(n.type),s=i?.vertexFormat||a.defaultVertexFormat,o=Mee(s);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,shaderDataType:a.dataType,shaderComponents:a.components,vertexFormat:s,bufferDataType:o.type,bufferComponents:o.components,normalized:o.normalized,integer:a.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function vBe(t,e){const r=t.attributes.find(n=>n.name===e);return r||yn.warn(`shader layout attribute "${e}" not present in shader`),r||null}function _Be(t,e){bBe(t);let r=xBe(t,e);return r||(r=wBe(t,e),r)?r:(yn.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function bBe(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&yn.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function xBe(t,e){for(const r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function wBe(t,e){for(const r of t){let n=r.byteStride;if(typeof r.byteStride!="number")for(const a of r.attributes||[]){const s=Mee(a.format);n+=s.byteLength}const i=r.attributes?.find(a=>a.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}class zL extends wo{static defaultProps={...wo.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,zL.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:i}=r.renderPipeline||{};if(!n||!i)throw new Error("VertexArray");this.attributeInfos=mBe(n,i,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"))}}class jL extends wo{static defaultProps={...wo.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,jL.defaultProps)}}class UL extends wo{static defaultProps={...wo.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,UL.defaultProps)}}const SBe={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function EBe(t){return SBe[t]}function TBe(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let G2;function Oee(t){return(!G2||G2.byteLength<t)&&(G2=new ArrayBuffer(t)),G2}function CBe(t,e){const r=Oee(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}function ABe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function dE(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":ABe(t)}const Nq=1024;class IBe{layout={};byteLength;constructor(e){let r=0;for(const[i,a]of Object.entries(e)){const s=EBe(a),{type:o,components:u}=s;r=TBe(r,u);const h=r;r+=u,this.layout[i]={type:o,size:u,offset:h}}r+=(4-r%4)%4;const n=r*4;this.byteLength=Math.max(n,Nq)}getData(e){const r=Math.max(this.byteLength,Nq),n=Oee(r),i={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(const[a,s]of Object.entries(e)){const o=this.layout[a];if(!o){yn.warn(`Supplied uniform value ${a} not present in uniform block layout`)();continue}const{type:u,size:h,offset:f}=o,d=i[u];if(h===1){if(typeof s!="number"&&typeof s!="boolean"){yn.warn(`Supplied value for single component uniform ${a} is not a number: ${s}`)();continue}d[f]=Number(s)}else{if(!dE(s)){yn.warn(`Supplied value for multi component / array uniform ${a} is not a numeric array: ${s}`)();continue}d.set(s,f)}}return new Uint8Array(n)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function PBe(t,e,r=16){if(t!==e)return!1;const n=t,i=e;if(!dE(n))return!1;if(dE(i)&&n.length===i.length){for(let a=0;a<n.length;++a)if(i[a]!==n[a])return!1}return!0}function kBe(t){return dE(t)?t.slice():t}class MBe{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const r=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!r)throw new Error(e?.name);const n=r;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[r,n]of Object.entries(e))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){PBe(this.uniforms[e],r)||(this.uniforms[e]=kBe(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}class RBe{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[r,n]of Object.entries(e)){const i=r,a=new IBe(n.uniformTypes||{});this.uniformBufferLayouts.set(i,a);const s=new MBe({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[r,n]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(r),a=e.createBuffer({usage:Fo.UNIFORM|Fo.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return a.write(s),a}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){const n=this.getUniformBufferByteLength(r),i=e.createBuffer({usage:Fo.UNIFORM|Fo.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(const r of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(r);e||=n}return e&&yn.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const r=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;const a=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(a);const s=this.uniformBlocks.get(e)?.getAllUniforms();yn.log(4,`Writing to uniform buffer ${String(e)}`,a,s)()}return i}}function Nee(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Lee(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function OBe(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);const n=e;let i=Nee(t);if(i==="uint8"&&r&&n===1)return"unorm8-webgl";if(i==="uint8"&&r&&n===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}if(i==="uint16"||i==="sint16"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}return n===1?i:`${i}x${n}`}class VI{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){const n=[...e];for(const i of r){const a=n.findIndex(s=>s.name===i.name);a<0?n.push(i):n[a]=i}return n}getBufferIndex(e){const r=this.bufferLayouts.findIndex(n=>n.name===e);return r===-1&&yn.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}}function NBe(t,e){const r=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,a)=>{const s=i.attributes?i.attributes.map(f=>f.attribute):[i.name],o=a.attributes?a.attributes.map(f=>f.attribute):[a.name],u=Math.min(...s.map(f=>r[f])),h=Math.min(...o.map(f=>r[f]));return u-h}),n}class xh{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class Lq{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class jp extends xh{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class Xp extends xh{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class ZM extends xh{constructor(e,r,n){super(e,n),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class Mm extends xh{constructor(e,r,n,i){super(e,n),this.format=r,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var Rp;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(Rp||(Rp={}));class X2{constructor(e,r,n,i,a,s,o){this.name=e,this.type=r,this.group=n,this.binding=i,this.attributes=a,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class LBe{constructor(e,r){this.name=e,this.type=r}}class DBe{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}}class Dq{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i}}class FBe{constructor(e,r,n,i){this.name=e,this.type=r,this.attributes=n,this.id=i}}class BBe{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n}}class zBe{constructor(e,r=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=n}}class jBe{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function UBe(t){var e=(32768&t)>>15,r=(31744&t)>>10,n=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}const Dee=new Float32Array(1),VBe=new Int32Array(Dee.buffer),Uu=new Uint16Array(1);function $Be(t){Dee[0]=t;const e=VBe[0],r=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return Uu[0]=r<<15|31744|(i!==0?512:0),Uu[0];if(n===0){if(i===0)return Uu[0]=r<<15,Uu[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return n=127-a,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),Uu[0]=r<<15|n<<10|i>>13,Uu[0]):(Uu[0]=r<<15,Uu[0])}return n=n-127+15,n>=31?(Uu[0]=r<<15|31744,Uu[0]):n<=0?n<-10?(Uu[0]=r<<15,Uu[0]):(i=(8388608|i)>>1-n,Uu[0]=r<<15|i>>13,Uu[0]):(i>>=13,Uu[0]=r<<15|n<<10|i,Uu[0])}const VL=new Uint32Array(1),Fee=new Float32Array(VL.buffer,0,1);function Fq(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return VL[0]=e,Fee[0]}function qBe(t,e,r,n,i,a,s,o,u){const h=n*(s>>=i)*(a>>=i)+r*s+e*o;switch(u){case"r8unorm":return[Fa(t,h,"8unorm",1)[0]];case"r8snorm":return[Fa(t,h,"8snorm",1)[0]];case"r8uint":return[Fa(t,h,"8uint",1)[0]];case"r8sint":return[Fa(t,h,"8sint",1)[0]];case"rg8unorm":{const f=Fa(t,h,"8unorm",2);return[f[0],f[1]]}case"rg8snorm":{const f=Fa(t,h,"8snorm",2);return[f[0],f[1]]}case"rg8uint":{const f=Fa(t,h,"8uint",2);return[f[0],f[1]]}case"rg8sint":{const f=Fa(t,h,"8sint",2);return[f[0],f[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const f=Fa(t,h,"8unorm",4);return[f[0],f[1],f[2],f[3]]}case"rgba8snorm":{const f=Fa(t,h,"8snorm",4);return[f[0],f[1],f[2],f[3]]}case"rgba8uint":{const f=Fa(t,h,"8uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba8sint":{const f=Fa(t,h,"8sint",4);return[f[0],f[1],f[2],f[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const f=Fa(t,h,"8unorm",4);return[f[2],f[1],f[0],f[3]]}case"r16uint":return[Fa(t,h,"16uint",1)[0]];case"r16sint":return[Fa(t,h,"16sint",1)[0]];case"r16float":return[Fa(t,h,"16float",1)[0]];case"rg16uint":{const f=Fa(t,h,"16uint",2);return[f[0],f[1]]}case"rg16sint":{const f=Fa(t,h,"16sint",2);return[f[0],f[1]]}case"rg16float":{const f=Fa(t,h,"16float",2);return[f[0],f[1]]}case"rgba16uint":{const f=Fa(t,h,"16uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba16sint":{const f=Fa(t,h,"16sint",4);return[f[0],f[1],f[2],f[3]]}case"rgba16float":{const f=Fa(t,h,"16float",4);return[f[0],f[1],f[2],f[3]]}case"r32uint":return[Fa(t,h,"32uint",1)[0]];case"r32sint":return[Fa(t,h,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[Fa(t,h,"32float",1)[0]];case"rg32uint":{const f=Fa(t,h,"32uint",2);return[f[0],f[1]]}case"rg32sint":{const f=Fa(t,h,"32sint",2);return[f[0],f[1]]}case"rg32float":{const f=Fa(t,h,"32float",2);return[f[0],f[1]]}case"rgba32uint":{const f=Fa(t,h,"32uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba32sint":{const f=Fa(t,h,"32sint",4);return[f[0],f[1],f[2],f[3]]}case"rgba32float":{const f=Fa(t,h,"32float",4);return[f[0],f[1],f[2],f[3]]}case"rg11b10ufloat":{const f=new Uint32Array(t.buffer,h,1)[0],d=(4192256&f)>>11,b=(4290772992&f)>>22;return[Fq(2047&f),Fq(d),(function(v){const S=112+(v>>5&31)<<23|(31&v)<<18;return VL[0]=S,Fee[0]})(b),1]}}return null}function Fa(t,e,r,n){const i=[0,0,0,0];for(let a=0;a<n;++a)switch(r){case"8unorm":i[a]=t[e]/255,e++;break;case"8snorm":i[a]=t[e]/255*2-1,e++;break;case"8uint":i[a]=t[e],e++;break;case"8sint":i[a]=t[e]-127,e++;break;case"16uint":i[a]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[a]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[a]=UBe(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[a]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[a]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function Ga(t,e,r,n,i){for(let a=0;a<n;++a)switch(r){case"8unorm":t[e]=255*i[a],e++;break;case"8snorm":t[e]=.5*(i[a]+1)*255,e++;break;case"8uint":t[e]=i[a],e++;break;case"8sint":t[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const s=$Be(i[a]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[a],e+=4}return i}const $I={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Dh{constructor(){this.id=Dh._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(pE.instance);for(const n of e)n instanceof Array?this.searchBlock(n,r):n.search(r);r(gE.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Dh._id=0;class pE extends Dh{}pE.instance=new pE;class gE extends Dh{}gE.instance=new gE;const Bee=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class as extends Dh{constructor(){super()}}class Cb extends as{constructor(e,r,n,i,a,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=n,this.body=i,this.startLine=a,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const r of this.attributes)e(r);e(this);for(const r of this.args)e(r);this.searchBlock(this.body,e)}}class HBe extends as{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class zee extends as{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class KM extends as{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class jee extends as{constructor(e,r,n,i){super(),this.init=e,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var r,n,i;(r=this.init)===null||r===void 0||r.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class Dd extends as{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class $L extends as{constructor(e,r,n){super(),this.attributes=null,this.name=e,this.type=r,this.value=n}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class B1 extends as{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class Mw extends as{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}var Iv,d1,Ir,cr;(t=>{t.increment="++",t.decrement="--"})(Iv||(Iv={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(Iv||(Iv={}));class Uee extends as{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(d1||(d1={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(d1||(d1={}));class Vee extends as{constructor(e,r,n){super(),this.operator=e,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class qL extends as{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return Bee.has(this.name)}search(e){for(const r of this.args)r.search(e);e(this)}}class $ee extends as{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}}class qee extends as{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(const r of this.cases)r.search(e)}}class Hee extends as{constructor(e,r,n,i){super(),this.condition=e,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Wee extends as{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class WBe extends as{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class GBe extends as{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Gee extends as{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}}class HL extends as{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}}class XBe extends as{constructor(){super()}get astNodeType(){return"discard"}}class Xee extends as{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Yee extends as{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class tn extends as{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=tn._priority.get(r.name);tn._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?tn.i32:r}getTypeName(){return this.name}}tn.x32=new tn("x32"),tn.f32=new tn("f32"),tn.i32=new tn("i32"),tn.u32=new tn("u32"),tn.f16=new tn("f16"),tn.bool=new tn("bool"),tn.void=new tn("void"),tn._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Bq extends tn{constructor(e){super(e)}}class Rd extends tn{constructor(e,r,n,i){super(e),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(const r of this.members)e(r)}}class pr extends tn{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}pr.vec2f=new pr("vec2",tn.f32,null),pr.vec3f=new pr("vec3",tn.f32,null),pr.vec4f=new pr("vec4",tn.f32,null),pr.vec2i=new pr("vec2",tn.i32,null),pr.vec3i=new pr("vec3",tn.i32,null),pr.vec4i=new pr("vec4",tn.i32,null),pr.vec2u=new pr("vec2",tn.u32,null),pr.vec3u=new pr("vec3",tn.u32,null),pr.vec4u=new pr("vec4",tn.u32,null),pr.vec2h=new pr("vec2",tn.f16,null),pr.vec3h=new pr("vec3",tn.f16,null),pr.vec4h=new pr("vec4",tn.f16,null),pr.vec2b=new pr("vec2",tn.bool,null),pr.vec3b=new pr("vec3",tn.bool,null),pr.vec4b=new pr("vec4",tn.bool,null),pr.mat2x2f=new pr("mat2x2",tn.f32,null),pr.mat2x3f=new pr("mat2x3",tn.f32,null),pr.mat2x4f=new pr("mat2x4",tn.f32,null),pr.mat3x2f=new pr("mat3x2",tn.f32,null),pr.mat3x3f=new pr("mat3x3",tn.f32,null),pr.mat3x4f=new pr("mat3x4",tn.f32,null),pr.mat4x2f=new pr("mat4x2",tn.f32,null),pr.mat4x3f=new pr("mat4x3",tn.f32,null),pr.mat4x4f=new pr("mat4x4",tn.f32,null),pr.mat2x2h=new pr("mat2x2",tn.f16,null),pr.mat2x3h=new pr("mat2x3",tn.f16,null),pr.mat2x4h=new pr("mat2x4",tn.f16,null),pr.mat3x2h=new pr("mat3x2",tn.f16,null),pr.mat3x3h=new pr("mat3x3",tn.f16,null),pr.mat3x4h=new pr("mat3x4",tn.f16,null),pr.mat4x2h=new pr("mat4x2",tn.f16,null),pr.mat4x3h=new pr("mat4x3",tn.f16,null),pr.mat4x4h=new pr("mat4x4",tn.f16,null),pr.mat2x2i=new pr("mat2x2",tn.i32,null),pr.mat2x3i=new pr("mat2x3",tn.i32,null),pr.mat2x4i=new pr("mat2x4",tn.i32,null),pr.mat3x2i=new pr("mat3x2",tn.i32,null),pr.mat3x3i=new pr("mat3x3",tn.i32,null),pr.mat3x4i=new pr("mat3x4",tn.i32,null),pr.mat4x2i=new pr("mat4x2",tn.i32,null),pr.mat4x3i=new pr("mat4x3",tn.i32,null),pr.mat4x4i=new pr("mat4x4",tn.i32,null),pr.mat2x2u=new pr("mat2x2",tn.u32,null),pr.mat2x3u=new pr("mat2x3",tn.u32,null),pr.mat2x4u=new pr("mat2x4",tn.u32,null),pr.mat3x2u=new pr("mat3x2",tn.u32,null),pr.mat3x3u=new pr("mat3x3",tn.u32,null),pr.mat3x4u=new pr("mat3x4",tn.u32,null),pr.mat4x2u=new pr("mat4x2",tn.u32,null),pr.mat4x3u=new pr("mat4x3",tn.u32,null),pr.mat4x4u=new pr("mat4x4",tn.u32,null);class Rw extends tn{constructor(e,r,n,i){super(e),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class z1 extends tn{constructor(e,r,n,i){super(e),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class p1 extends tn{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"sampler"}}class vf extends Dh{constructor(){super(),this.postfix=null}}class Rm extends vf{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class zf extends vf{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}}class WL extends vf{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Bee.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(const r of this.args)r.search(e);e(this)}}class Yc extends vf{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}}class Zee extends vf{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}}class Rl extends vf{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof lr}get isVector(){return this.value instanceof Pt||this.value instanceof Ai}get scalarValue(){return this.value instanceof lr?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Pt||this.value instanceof Ai?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Kee extends vf{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class y0 extends vf{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Jee extends vf{constructor(){super()}}class gl extends Jee{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Zh extends Jee{constructor(e,r,n){super(),this.operator=e,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?tn.f32:e.name==="u32"||r.name==="u32"?tn.u32:tn.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Qee extends Dh{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class Ow extends vf{constructor(){super()}get astNodeType(){return"default"}}class ete extends Qee{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class tte extends Qee{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class zq extends Dh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"argument"}}class YBe extends Dh{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class jq extends Dh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"member"}}class rte extends Dh{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}}class Oh{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=Oh._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Oh._id=0;class JM extends Oh{constructor(){super(new xh("void",null),null)}toString(){return"void"}}JM.void=new JM;class $y extends Oh{constructor(e){super(new ZM("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,n,i){this.reference.setDataValue(e,r,n,i)}getSubData(e,r,n){return r?this.reference.getSubData(e,r,n):this}toString(){return`&${this.reference.toString()}`}}class lr extends Oh{constructor(e,r,n=null){super(r,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new lr(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new lr(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new lr(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(r instanceof lr))return void console.error("SetDataValue: Invalid value",r);let a=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,r,n){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}}function ZBe(t,e,r){const n=e.length;return n===2?r==="f32"?new Pt(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new Pt(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new Pt(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new Pt(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):n===3?r==="f32"?new Pt(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new Pt(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new Pt(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new Pt(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):n===4?r==="f32"?new Pt(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new Pt(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new Pt(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new Pt(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class Pt extends Oh{constructor(e,r,n=null){if(super(r,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new Pt(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Pt(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Pt(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,n,i){n instanceof Rm?console.error("TODO: Set vector postfix"):r instanceof Pt?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof Mm)i=this.typeInfo.format||i;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?i=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?i=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?i=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?i=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let a=this;for(;r!==null&&a!==null;){if(r instanceof y0){const s=r.index;let o=-1;if(s instanceof Rl){if(!(s.value instanceof lr))return console.error(`GetSubData: Invalid array index ${s.value}`),null;o=s.value.value}else{const u=e.evalExpression(s,n);if(!(u instanceof lr))return console.error("GetSubData: Unknown index type",s),null;o=u.value}if(o<0||o>=a.data.length)return console.error("GetSubData: Index out of range",o),null;if(a.data instanceof Float32Array){const u=new Float32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new lr(u,i)}if(a.data instanceof Int32Array){const u=new Int32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new lr(u,i)}if(a.data instanceof Uint32Array){const u=new Uint32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new lr(u,i)}throw"GetSubData: Invalid data type"}if(!(r instanceof Rm))return console.error("GetSubData: Unknown postfix",r),null;{const s=r.value.toLowerCase();if(s.length===1){let u=0;if(s==="x"||s==="r")u=0;else if(s==="y"||s==="g")u=1;else if(s==="z"||s==="b")u=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;u=3}if(this.data instanceof Float32Array){let h=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new lr(h,i,this)}if(this.data instanceof Int32Array){let h=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new lr(h,i,this)}if(this.data instanceof Uint32Array){let h=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new lr(h,i,this)}}const o=[];for(const u of s)u==="x"||u==="r"?o.push(this.data[0]):u==="y"||u==="g"?o.push(this.data[1]):u==="z"||u==="b"?o.push(this.data[2]):u==="w"||u==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);a=ZBe(e,o,i.name)}r=r.postfix}return a}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ai extends Oh{constructor(e,r,n=null){super(r,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ai(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,n,i){n instanceof Rm?console.error("TODO: Set matrix postfix"):r instanceof Ai?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof Mm)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(r instanceof y0){const a=r.index;let s=-1;if(a instanceof Rl){if(!(a.value instanceof lr))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;s=a.value.value}else{const h=e.evalExpression(a,n);if(!(h instanceof lr))return console.error("GetDataValue: Unknown index type",a),null;s=h.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=i.endsWith("h")?"h":"f";let u;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")u=new Pt(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")u=new Pt(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;u=new Pt(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${o}`))}return r.postfix?u.getSubData(e,r.postfix,n):u}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ds extends Oh{constructor(e,r,n=0,i=null){super(r,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Ds(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,n,i){if(r===null)return void console.log("setDataValue: NULL data.");let a=this.offset,s=this.typeInfo;for(;n;){if(n instanceof y0)if(s instanceof Xp){const o=n.index;if(o instanceof Rl){if(!(o.value instanceof lr))return void console.error(`SetDataValue: Invalid index type ${o.value}`);a+=o.value.value*s.stride}else{const u=e.evalExpression(o,i);if(!(u instanceof lr))return void console.error("SetDataValue: Unknown index type",o);a+=u.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(n instanceof Rm))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(s instanceof jp){let u=!1;for(const h of s.members)if(h.name===o){a+=h.offset,s=h.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${o} not found`)}else if(s instanceof xh){const u=s.getTypeName();let h=0;if(o==="x"||o==="r")h=0;else if(o==="y"||o==="g")h=1;else if(o==="z"||o==="b")h=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);h=3}if(!(r instanceof lr))return void console.error("SetDataValue: Invalid value",r);const f=r.value;return u==="vec2f"?void(new Float32Array(this.buffer,a,2)[h]=f):u==="vec3f"?void(new Float32Array(this.buffer,a,3)[h]=f):u==="vec4f"?void(new Float32Array(this.buffer,a,4)[h]=f):u==="vec2i"?void(new Int32Array(this.buffer,a,2)[h]=f):u==="vec3i"?void(new Int32Array(this.buffer,a,3)[h]=f):u==="vec4i"?void(new Int32Array(this.buffer,a,4)[h]=f):u==="vec2u"?void(new Uint32Array(this.buffer,a,2)[h]=f):u==="vec3u"?void(new Uint32Array(this.buffer,a,3)[h]=f):u==="vec4u"?void(new Uint32Array(this.buffer,a,4)[h]=f):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}n=n.postfix}this.setData(e,r,s,a,i)}setData(e,r,n,i,a){const s=n.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof Pt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11],o[12]=r.data[12],o[13]=r.data[13],o[14]=r.data[14],o[15]=r.data[15]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]))}if(r instanceof Ds){if(n===r.typeInfo)return void new Uint8Array(this.buffer,i,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof lr&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof lr&&(new Uint32Array(this.buffer,i,1)[0]=r.value);else r instanceof lr&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof lr&&(new Float32Array(this.buffer,i,1)[0]=r.value)}getSubData(e,r,n){var i,a,s;if(r===null)return this;let o=this.offset,u=this.typeInfo;for(;r;){if(r instanceof y0){const f=r.index,d=f instanceof vf?e.evalExpression(f,n):f;let b=0;if(d instanceof lr?b=d.value:typeof d=="number"?b=d:console.error("GetDataValue: Invalid index type",f),u instanceof Xp)o+=b*u.stride,u=u.format;else{const v=u.getTypeName();v==="mat4x4"||v==="mat4x4f"||v==="mat4x4h"?(o+=16*b,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(r instanceof Rm))return console.error("GetDataValue: Unknown postfix type",r),null;{const f=r.value;if(u instanceof jp){let d=!1;for(const b of u.members)if(b.name===f){o+=b.offset,u=b.type,d=!0;break}if(!d)return console.error(`GetDataValue: Member ${f} not found`),null}else if(u instanceof xh){const d=u.getTypeName();if(d==="vec2f"||d==="vec3f"||d==="vec4f"||d==="vec2i"||d==="vec3i"||d==="vec4i"||d==="vec2u"||d==="vec3u"||d==="vec4u"||d==="vec2b"||d==="vec3b"||d==="vec4b"||d==="vec2h"||d==="vec3h"||d==="vec4h"||d==="vec2"||d==="vec3"||d==="vec4"){if(f.length>0&&f.length<5){let b="f";const v=[];for(let S=0;S<f.length;++S){const E=f[S].toLowerCase();let P=0;if(E==="x"||E==="r")P=0;else if(E==="y"||E==="g")P=1;else if(E==="z"||E==="b")P=2;else{if(E!=="w"&&E!=="a")return console.error(`Unknown member ${f}`),null;P=3}if(f.length===1){if(d.endsWith("f"))return this.buffer.byteLength<o+4*P+4?(console.log("Insufficient buffer data"),null):new lr(new Float32Array(this.buffer,o+4*P,1),e.getTypeInfo("f32"),this);if(d.endsWith("h"))return new lr(new Float32Array(this.buffer,o+4*P,1),e.getTypeInfo("f16"),this);if(d.endsWith("i"))return new lr(new Int32Array(this.buffer,o+4*P,1),e.getTypeInfo("i32"),this);if(d.endsWith("b"))return new lr(new Int32Array(this.buffer,o+4*P,1),e.getTypeInfo("bool"),this);if(d.endsWith("u"))return new lr(new Uint32Array(this.buffer,o+4*P,1),e.getTypeInfo("i32"),this)}if(d==="vec2f")v.push(new Float32Array(this.buffer,o,2)[P]);else if(d==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const k=new Float32Array(this.buffer,o,3);v.push(k[P])}else if(d==="vec4f")v.push(new Float32Array(this.buffer,o,4)[P]);else if(d==="vec2i")b="i",v.push(new Int32Array(this.buffer,o,2)[P]);else if(d==="vec3i")b="i",v.push(new Int32Array(this.buffer,o,3)[P]);else if(d==="vec4i")b="i",v.push(new Int32Array(this.buffer,o,4)[P]);else if(d==="vec2u"){b="u";const k=new Uint32Array(this.buffer,o,2);v.push(k[P])}else d==="vec3u"?(b="u",v.push(new Uint32Array(this.buffer,o,3)[P])):d==="vec4u"&&(b="u",v.push(new Uint32Array(this.buffer,o,4)[P]))}return v.length===2?u=e.getTypeInfo(`vec2${b}`):v.length===3?u=e.getTypeInfo(`vec3${b}`):v.length===4?u=e.getTypeInfo(`vec4${b}`):console.error(`GetDataValue: Invalid vector length ${v.length}`),new Pt(v,u,null)}return console.error(`GetDataValue: Unknown member ${f}`),null}return console.error(`GetDataValue: Type ${d} is not a struct`),null}}}r=r.postfix}const h=u.getTypeName();return h==="f32"?new lr(new Float32Array(this.buffer,o,1),u,this):h==="i32"?new lr(new Int32Array(this.buffer,o,1),u,this):h==="u32"?new lr(new Uint32Array(this.buffer,o,1),u,this):h==="vec2f"?new Pt(new Float32Array(this.buffer,o,2),u,this):h==="vec3f"?new Pt(new Float32Array(this.buffer,o,3),u,this):h==="vec4f"?new Pt(new Float32Array(this.buffer,o,4),u,this):h==="vec2i"?new Pt(new Int32Array(this.buffer,o,2),u,this):h==="vec3i"?new Pt(new Int32Array(this.buffer,o,3),u,this):h==="vec4i"?new Pt(new Int32Array(this.buffer,o,4),u,this):h==="vec2u"?new Pt(new Uint32Array(this.buffer,o,2),u,this):h==="vec3u"?new Pt(new Uint32Array(this.buffer,o,3),u,this):h==="vec4u"?new Pt(new Uint32Array(this.buffer,o,4),u,this):u instanceof Mm&&u.name==="atomic"?((i=u.format)===null||i===void 0?void 0:i.name)==="u32"?new lr(new Uint32Array(this.buffer,o,1)[0],u.format,this):((a=u.format)===null||a===void 0?void 0:a.name)==="i32"?new lr(new Int32Array(this.buffer,o,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=u.format)===null||s===void 0?void 0:s.name}`),null):new Ds(this.buffer,u,o,this)}toString(){let e="";if(this.typeInfo instanceof Xp)if(this.typeInfo.format.name==="f32"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="i32"){const r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="u32"){const r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="vec2f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let n=1;n<r.length/2;++n)e+=`, [${r[2*n]}, ${r[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}, ${r[n+3]}]`}else e="[...]";else this.typeInfo instanceof jp?e+="{...}":e="[...]";return e}}class Od extends Oh{constructor(e,r,n,i){super(r,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new Od(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.width)!==null&&r!==void 0?r:0}get height(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const r=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<r.length;++n)r[n]=Math.max(1,r[n]>>e);return r}get texelByteSize(){const e=this.format,r=$I[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,r=$I[e];return!!r&&r.isDepthStencil}getGpuSize(){const e=this.format,r=$I[e],n=this.width;if(!e||n<=0||!r)return-1;const i=this.height,a=this.depthOrArrayLayers,s=this.dimension;return n/r.blockWidth*(s==="1d"?1:i/r.blockHeight)*r.bytesPerBlock*a}getPixel(e,r,n=0,i=0){const a=this.texelByteSize,s=this.bytesPerRow,o=this.height,u=this.data[i];return qBe(new Uint8Array(u),e,r,n,i,o,s,a,this.format)}setPixel(e,r,n,i,a){const s=this.texelByteSize,o=this.bytesPerRow,u=this.height,h=this.data[i];(function(f,d,b,v,S,E,P,k,L,N){const M=v*(P>>=S)*(E>>=S)+b*P+d*k;switch(L){case"r8unorm":return void Ga(f,M,"8unorm",1,N);case"r8snorm":return void Ga(f,M,"8snorm",1,N);case"r8uint":return void Ga(f,M,"8uint",1,N);case"r8sint":return void Ga(f,M,"8sint",1,N);case"rg8unorm":return void Ga(f,M,"8unorm",2,N);case"rg8snorm":return void Ga(f,M,"8snorm",2,N);case"rg8uint":return void Ga(f,M,"8uint",2,N);case"rg8sint":return void Ga(f,M,"8sint",2,N);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Ga(f,M,"8unorm",4,N);case"rgba8snorm":return void Ga(f,M,"8snorm",4,N);case"rgba8uint":return void Ga(f,M,"8uint",4,N);case"rgba8sint":return void Ga(f,M,"8sint",4,N);case"r16uint":return void Ga(f,M,"16uint",1,N);case"r16sint":return void Ga(f,M,"16sint",1,N);case"r16float":return void Ga(f,M,"16float",1,N);case"rg16uint":return void Ga(f,M,"16uint",2,N);case"rg16sint":return void Ga(f,M,"16sint",2,N);case"rg16float":return void Ga(f,M,"16float",2,N);case"rgba16uint":return void Ga(f,M,"16uint",4,N);case"rgba16sint":return void Ga(f,M,"16sint",4,N);case"rgba16float":return void Ga(f,M,"16float",4,N);case"r32uint":return void Ga(f,M,"32uint",1,N);case"r32sint":return void Ga(f,M,"32sint",1,N);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Ga(f,M,"32float",1,N);case"rg32uint":return void Ga(f,M,"32uint",2,N);case"rg32sint":return void Ga(f,M,"32sint",2,N);case"rg32float":return void Ga(f,M,"32float",2,N);case"rgba32uint":return void Ga(f,M,"32uint",4,N);case"rgba32sint":return void Ga(f,M,"32sint",4,N);case"rgba32float":return void Ga(f,M,"32float",4,N);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(h),e,r,n,i,u,o,s,this.format,a)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(cr||(cr={}));class hr{constructor(e,r,n){this.name=e,this.type=r,this.rule=n}toString(){return this.name}}class gt{}Ir=gt,gt.none=new hr("",cr.reserved,""),gt.eof=new hr("EOF",cr.token,""),gt.reserved={asm:new hr("asm",cr.reserved,"asm"),bf16:new hr("bf16",cr.reserved,"bf16"),do:new hr("do",cr.reserved,"do"),enum:new hr("enum",cr.reserved,"enum"),f16:new hr("f16",cr.reserved,"f16"),f64:new hr("f64",cr.reserved,"f64"),handle:new hr("handle",cr.reserved,"handle"),i8:new hr("i8",cr.reserved,"i8"),i16:new hr("i16",cr.reserved,"i16"),i64:new hr("i64",cr.reserved,"i64"),mat:new hr("mat",cr.reserved,"mat"),premerge:new hr("premerge",cr.reserved,"premerge"),regardless:new hr("regardless",cr.reserved,"regardless"),typedef:new hr("typedef",cr.reserved,"typedef"),u8:new hr("u8",cr.reserved,"u8"),u16:new hr("u16",cr.reserved,"u16"),u64:new hr("u64",cr.reserved,"u64"),unless:new hr("unless",cr.reserved,"unless"),using:new hr("using",cr.reserved,"using"),vec:new hr("vec",cr.reserved,"vec"),void:new hr("void",cr.reserved,"void")},gt.keywords={array:new hr("array",cr.keyword,"array"),atomic:new hr("atomic",cr.keyword,"atomic"),bool:new hr("bool",cr.keyword,"bool"),f32:new hr("f32",cr.keyword,"f32"),i32:new hr("i32",cr.keyword,"i32"),mat2x2:new hr("mat2x2",cr.keyword,"mat2x2"),mat2x3:new hr("mat2x3",cr.keyword,"mat2x3"),mat2x4:new hr("mat2x4",cr.keyword,"mat2x4"),mat3x2:new hr("mat3x2",cr.keyword,"mat3x2"),mat3x3:new hr("mat3x3",cr.keyword,"mat3x3"),mat3x4:new hr("mat3x4",cr.keyword,"mat3x4"),mat4x2:new hr("mat4x2",cr.keyword,"mat4x2"),mat4x3:new hr("mat4x3",cr.keyword,"mat4x3"),mat4x4:new hr("mat4x4",cr.keyword,"mat4x4"),ptr:new hr("ptr",cr.keyword,"ptr"),sampler:new hr("sampler",cr.keyword,"sampler"),sampler_comparison:new hr("sampler_comparison",cr.keyword,"sampler_comparison"),struct:new hr("struct",cr.keyword,"struct"),texture_1d:new hr("texture_1d",cr.keyword,"texture_1d"),texture_2d:new hr("texture_2d",cr.keyword,"texture_2d"),texture_2d_array:new hr("texture_2d_array",cr.keyword,"texture_2d_array"),texture_3d:new hr("texture_3d",cr.keyword,"texture_3d"),texture_cube:new hr("texture_cube",cr.keyword,"texture_cube"),texture_cube_array:new hr("texture_cube_array",cr.keyword,"texture_cube_array"),texture_multisampled_2d:new hr("texture_multisampled_2d",cr.keyword,"texture_multisampled_2d"),texture_storage_1d:new hr("texture_storage_1d",cr.keyword,"texture_storage_1d"),texture_storage_2d:new hr("texture_storage_2d",cr.keyword,"texture_storage_2d"),texture_storage_2d_array:new hr("texture_storage_2d_array",cr.keyword,"texture_storage_2d_array"),texture_storage_3d:new hr("texture_storage_3d",cr.keyword,"texture_storage_3d"),texture_depth_2d:new hr("texture_depth_2d",cr.keyword,"texture_depth_2d"),texture_depth_2d_array:new hr("texture_depth_2d_array",cr.keyword,"texture_depth_2d_array"),texture_depth_cube:new hr("texture_depth_cube",cr.keyword,"texture_depth_cube"),texture_depth_cube_array:new hr("texture_depth_cube_array",cr.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new hr("texture_depth_multisampled_2d",cr.keyword,"texture_depth_multisampled_2d"),texture_external:new hr("texture_external",cr.keyword,"texture_external"),u32:new hr("u32",cr.keyword,"u32"),vec2:new hr("vec2",cr.keyword,"vec2"),vec3:new hr("vec3",cr.keyword,"vec3"),vec4:new hr("vec4",cr.keyword,"vec4"),bitcast:new hr("bitcast",cr.keyword,"bitcast"),block:new hr("block",cr.keyword,"block"),break:new hr("break",cr.keyword,"break"),case:new hr("case",cr.keyword,"case"),continue:new hr("continue",cr.keyword,"continue"),continuing:new hr("continuing",cr.keyword,"continuing"),default:new hr("default",cr.keyword,"default"),diagnostic:new hr("diagnostic",cr.keyword,"diagnostic"),discard:new hr("discard",cr.keyword,"discard"),else:new hr("else",cr.keyword,"else"),enable:new hr("enable",cr.keyword,"enable"),fallthrough:new hr("fallthrough",cr.keyword,"fallthrough"),false:new hr("false",cr.keyword,"false"),fn:new hr("fn",cr.keyword,"fn"),for:new hr("for",cr.keyword,"for"),function:new hr("function",cr.keyword,"function"),if:new hr("if",cr.keyword,"if"),let:new hr("let",cr.keyword,"let"),const:new hr("const",cr.keyword,"const"),loop:new hr("loop",cr.keyword,"loop"),while:new hr("while",cr.keyword,"while"),private:new hr("private",cr.keyword,"private"),read:new hr("read",cr.keyword,"read"),read_write:new hr("read_write",cr.keyword,"read_write"),return:new hr("return",cr.keyword,"return"),requires:new hr("requires",cr.keyword,"requires"),storage:new hr("storage",cr.keyword,"storage"),switch:new hr("switch",cr.keyword,"switch"),true:new hr("true",cr.keyword,"true"),alias:new hr("alias",cr.keyword,"alias"),type:new hr("type",cr.keyword,"type"),uniform:new hr("uniform",cr.keyword,"uniform"),var:new hr("var",cr.keyword,"var"),override:new hr("override",cr.keyword,"override"),workgroup:new hr("workgroup",cr.keyword,"workgroup"),write:new hr("write",cr.keyword,"write"),r8unorm:new hr("r8unorm",cr.keyword,"r8unorm"),r8snorm:new hr("r8snorm",cr.keyword,"r8snorm"),r8uint:new hr("r8uint",cr.keyword,"r8uint"),r8sint:new hr("r8sint",cr.keyword,"r8sint"),r16uint:new hr("r16uint",cr.keyword,"r16uint"),r16sint:new hr("r16sint",cr.keyword,"r16sint"),r16float:new hr("r16float",cr.keyword,"r16float"),rg8unorm:new hr("rg8unorm",cr.keyword,"rg8unorm"),rg8snorm:new hr("rg8snorm",cr.keyword,"rg8snorm"),rg8uint:new hr("rg8uint",cr.keyword,"rg8uint"),rg8sint:new hr("rg8sint",cr.keyword,"rg8sint"),r32uint:new hr("r32uint",cr.keyword,"r32uint"),r32sint:new hr("r32sint",cr.keyword,"r32sint"),r32float:new hr("r32float",cr.keyword,"r32float"),rg16uint:new hr("rg16uint",cr.keyword,"rg16uint"),rg16sint:new hr("rg16sint",cr.keyword,"rg16sint"),rg16float:new hr("rg16float",cr.keyword,"rg16float"),rgba8unorm:new hr("rgba8unorm",cr.keyword,"rgba8unorm"),rgba8unorm_srgb:new hr("rgba8unorm_srgb",cr.keyword,"rgba8unorm_srgb"),rgba8snorm:new hr("rgba8snorm",cr.keyword,"rgba8snorm"),rgba8uint:new hr("rgba8uint",cr.keyword,"rgba8uint"),rgba8sint:new hr("rgba8sint",cr.keyword,"rgba8sint"),bgra8unorm:new hr("bgra8unorm",cr.keyword,"bgra8unorm"),bgra8unorm_srgb:new hr("bgra8unorm_srgb",cr.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new hr("rgb10a2unorm",cr.keyword,"rgb10a2unorm"),rg11b10float:new hr("rg11b10float",cr.keyword,"rg11b10float"),rg32uint:new hr("rg32uint",cr.keyword,"rg32uint"),rg32sint:new hr("rg32sint",cr.keyword,"rg32sint"),rg32float:new hr("rg32float",cr.keyword,"rg32float"),rgba16uint:new hr("rgba16uint",cr.keyword,"rgba16uint"),rgba16sint:new hr("rgba16sint",cr.keyword,"rgba16sint"),rgba16float:new hr("rgba16float",cr.keyword,"rgba16float"),rgba32uint:new hr("rgba32uint",cr.keyword,"rgba32uint"),rgba32sint:new hr("rgba32sint",cr.keyword,"rgba32sint"),rgba32float:new hr("rgba32float",cr.keyword,"rgba32float"),static_assert:new hr("static_assert",cr.keyword,"static_assert")},gt.tokens={decimal_float_literal:new hr("decimal_float_literal",cr.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new hr("hex_float_literal",cr.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new hr("int_literal",cr.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new hr("uint_literal",cr.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new hr("name",cr.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new hr("ident",cr.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new hr("and",cr.token,"&"),and_and:new hr("and_and",cr.token,"&&"),arrow:new hr("arrow ",cr.token,"->"),attr:new hr("attr",cr.token,"@"),forward_slash:new hr("forward_slash",cr.token,"/"),bang:new hr("bang",cr.token,"!"),bracket_left:new hr("bracket_left",cr.token,"["),bracket_right:new hr("bracket_right",cr.token,"]"),brace_left:new hr("brace_left",cr.token,"{"),brace_right:new hr("brace_right",cr.token,"}"),colon:new hr("colon",cr.token,":"),comma:new hr("comma",cr.token,","),equal:new hr("equal",cr.token,"="),equal_equal:new hr("equal_equal",cr.token,"=="),not_equal:new hr("not_equal",cr.token,"!="),greater_than:new hr("greater_than",cr.token,">"),greater_than_equal:new hr("greater_than_equal",cr.token,">="),shift_right:new hr("shift_right",cr.token,">>"),less_than:new hr("less_than",cr.token,"<"),less_than_equal:new hr("less_than_equal",cr.token,"<="),shift_left:new hr("shift_left",cr.token,"<<"),modulo:new hr("modulo",cr.token,"%"),minus:new hr("minus",cr.token,"-"),minus_minus:new hr("minus_minus",cr.token,"--"),period:new hr("period",cr.token,"."),plus:new hr("plus",cr.token,"+"),plus_plus:new hr("plus_plus",cr.token,"++"),or:new hr("or",cr.token,"|"),or_or:new hr("or_or",cr.token,"||"),paren_left:new hr("paren_left",cr.token,"("),paren_right:new hr("paren_right",cr.token,")"),semicolon:new hr("semicolon",cr.token,";"),star:new hr("star",cr.token,"*"),tilde:new hr("tilde",cr.token,"~"),underscore:new hr("underscore",cr.token,"_"),xor:new hr("xor",cr.token,"^"),plus_equal:new hr("plus_equal",cr.token,"+="),minus_equal:new hr("minus_equal",cr.token,"-="),times_equal:new hr("times_equal",cr.token,"*="),division_equal:new hr("division_equal",cr.token,"/="),modulo_equal:new hr("modulo_equal",cr.token,"%="),and_equal:new hr("and_equal",cr.token,"&="),or_equal:new hr("or_equal",cr.token,"|="),xor_equal:new hr("xor_equal",cr.token,"^="),shift_right_equal:new hr("shift_right_equal",cr.token,">>="),shift_left_equal:new hr("shift_left_equal",cr.token,"<<=")},gt.simpleTokens={"@":Ir.tokens.attr,"{":Ir.tokens.brace_left,"}":Ir.tokens.brace_right,":":Ir.tokens.colon,",":Ir.tokens.comma,"(":Ir.tokens.paren_left,")":Ir.tokens.paren_right,";":Ir.tokens.semicolon},gt.literalTokens={"&":Ir.tokens.and,"&&":Ir.tokens.and_and,"->":Ir.tokens.arrow,"/":Ir.tokens.forward_slash,"!":Ir.tokens.bang,"[":Ir.tokens.bracket_left,"]":Ir.tokens.bracket_right,"=":Ir.tokens.equal,"==":Ir.tokens.equal_equal,"!=":Ir.tokens.not_equal,">":Ir.tokens.greater_than,">=":Ir.tokens.greater_than_equal,">>":Ir.tokens.shift_right,"<":Ir.tokens.less_than,"<=":Ir.tokens.less_than_equal,"<<":Ir.tokens.shift_left,"%":Ir.tokens.modulo,"-":Ir.tokens.minus,"--":Ir.tokens.minus_minus,".":Ir.tokens.period,"+":Ir.tokens.plus,"++":Ir.tokens.plus_plus,"|":Ir.tokens.or,"||":Ir.tokens.or_or,"*":Ir.tokens.star,"~":Ir.tokens.tilde,_:Ir.tokens.underscore,"^":Ir.tokens.xor,"+=":Ir.tokens.plus_equal,"-=":Ir.tokens.minus_equal,"*=":Ir.tokens.times_equal,"/=":Ir.tokens.division_equal,"%=":Ir.tokens.modulo_equal,"&=":Ir.tokens.and_equal,"|=":Ir.tokens.or_equal,"^=":Ir.tokens.xor_equal,">>=":Ir.tokens.shift_right_equal,"<<=":Ir.tokens.shift_left_equal},gt.regexTokens={decimal_float_literal:Ir.tokens.decimal_float_literal,hex_float_literal:Ir.tokens.hex_float_literal,int_literal:Ir.tokens.int_literal,uint_literal:Ir.tokens.uint_literal,ident:Ir.tokens.ident},gt.storage_class=[Ir.keywords.function,Ir.keywords.private,Ir.keywords.workgroup,Ir.keywords.uniform,Ir.keywords.storage],gt.access_mode=[Ir.keywords.read,Ir.keywords.write,Ir.keywords.read_write],gt.sampler_type=[Ir.keywords.sampler,Ir.keywords.sampler_comparison],gt.sampled_texture_type=[Ir.keywords.texture_1d,Ir.keywords.texture_2d,Ir.keywords.texture_2d_array,Ir.keywords.texture_3d,Ir.keywords.texture_cube,Ir.keywords.texture_cube_array],gt.multisampled_texture_type=[Ir.keywords.texture_multisampled_2d],gt.storage_texture_type=[Ir.keywords.texture_storage_1d,Ir.keywords.texture_storage_2d,Ir.keywords.texture_storage_2d_array,Ir.keywords.texture_storage_3d],gt.depth_texture_type=[Ir.keywords.texture_depth_2d,Ir.keywords.texture_depth_2d_array,Ir.keywords.texture_depth_cube,Ir.keywords.texture_depth_cube_array,Ir.keywords.texture_depth_multisampled_2d],gt.texture_external_type=[Ir.keywords.texture_external],gt.any_texture_type=[...Ir.sampled_texture_type,...Ir.multisampled_texture_type,...Ir.storage_texture_type,...Ir.depth_texture_type,...Ir.texture_external_type],gt.texel_format=[Ir.keywords.r8unorm,Ir.keywords.r8snorm,Ir.keywords.r8uint,Ir.keywords.r8sint,Ir.keywords.r16uint,Ir.keywords.r16sint,Ir.keywords.r16float,Ir.keywords.rg8unorm,Ir.keywords.rg8snorm,Ir.keywords.rg8uint,Ir.keywords.rg8sint,Ir.keywords.r32uint,Ir.keywords.r32sint,Ir.keywords.r32float,Ir.keywords.rg16uint,Ir.keywords.rg16sint,Ir.keywords.rg16float,Ir.keywords.rgba8unorm,Ir.keywords.rgba8unorm_srgb,Ir.keywords.rgba8snorm,Ir.keywords.rgba8uint,Ir.keywords.rgba8sint,Ir.keywords.bgra8unorm,Ir.keywords.bgra8unorm_srgb,Ir.keywords.rgb10a2unorm,Ir.keywords.rg11b10float,Ir.keywords.rg32uint,Ir.keywords.rg32sint,Ir.keywords.rg32float,Ir.keywords.rgba16uint,Ir.keywords.rgba16sint,Ir.keywords.rgba16float,Ir.keywords.rgba32uint,Ir.keywords.rgba32sint,Ir.keywords.rgba32float],gt.const_literal=[Ir.tokens.int_literal,Ir.tokens.uint_literal,Ir.tokens.decimal_float_literal,Ir.tokens.hex_float_literal,Ir.keywords.true,Ir.keywords.false],gt.literal_or_ident=[Ir.tokens.ident,Ir.tokens.int_literal,Ir.tokens.uint_literal,Ir.tokens.decimal_float_literal,Ir.tokens.hex_float_literal,Ir.tokens.name],gt.element_count_expression=[Ir.tokens.int_literal,Ir.tokens.uint_literal,Ir.tokens.ident],gt.template_types=[Ir.keywords.vec2,Ir.keywords.vec3,Ir.keywords.vec4,Ir.keywords.mat2x2,Ir.keywords.mat2x3,Ir.keywords.mat2x4,Ir.keywords.mat3x2,Ir.keywords.mat3x3,Ir.keywords.mat3x4,Ir.keywords.mat4x2,Ir.keywords.mat4x3,Ir.keywords.mat4x4,Ir.keywords.atomic,Ir.keywords.bitcast,...Ir.any_texture_type],gt.attribute_name=[Ir.tokens.ident,Ir.keywords.block,Ir.keywords.diagnostic],gt.assignment_operators=[Ir.tokens.equal,Ir.tokens.plus_equal,Ir.tokens.minus_equal,Ir.tokens.times_equal,Ir.tokens.division_equal,Ir.tokens.modulo_equal,Ir.tokens.and_equal,Ir.tokens.or_equal,Ir.tokens.xor_equal,Ir.tokens.shift_right_equal,Ir.tokens.shift_left_equal],gt.increment_operators=[Ir.tokens.plus_plus,Ir.tokens.minus_minus];class Uq{constructor(e,r,n,i,a){this.type=e,this.lexeme=r,this.line=n,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return gt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==gt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class KBe{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Uq(gt.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}const r=gt.simpleTokens[e];if(r)return this._addToken(r),!0;let n=gt.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){const s=gt.keywords[e];if(s)return this._addToken(s),!0}if(i||a)return this._addToken(gt.tokens.ident),!0;for(;;){let s=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(gt.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(gt.tokens.minus_minus),!0;const u=this._tokens.length-1;if((gt.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==gt.tokens.paren_right)&&o!=">")return this._addToken(s),!0}if(e==">"&&(o==">"||o=="=")){let u=!1,h=this._tokens.length-1;for(let f=0;f<5&&h>=0&&gt.assignment_operators.indexOf(this._tokens[h].type)===-1;++f,--h)if(this._tokens[h].type===gt.tokens.less_than){h>0&&this._tokens[h-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(s),!0}if(s===gt.none){let u=e,h=0;const f=2;for(let d=0;d<f;++d)if(u+=this._peekAhead(d),s=this._findType(u),s!==gt.none){h=d;break}if(s===gt.none)return n!==gt.none&&(this._current--,this._addToken(n),!0);e=u,this._current+=h+1}if(n=s,this._isAtEnd())break;e+=this._advance()}return n!==gt.none&&(this._addToken(n),!0)}_findType(e){for(const n in gt.regexTokens){const i=gt.regexTokens[n];if(this._match(e,i.rule))return i}return gt.literalTokens[e]||gt.none}_match(e,r){const n=r.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const r=this._source.substring(this._start,this._current);this._tokens.push(new Uq(e,r,this._line,this._start,this._current))}}function Dn(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const mE=new Float32Array(1),JBe=new Uint32Array(mE.buffer),QBe=new Uint32Array(mE.buffer),yE=new Int32Array(1),eze=new Float32Array(yE.buffer),tze=new Uint32Array(yE.buffer),vE=new Uint32Array(1),rze=new Float32Array(vE.buffer),nze=new Int32Array(vE.buffer);function Vq(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return mE[0]=t,JBe[0];if(r==="u32")return mE[0]=t,QBe[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return yE[0]=t,eze[0];if(r==="u32")return yE[0]=t,tze[0]}else if(e==="u32"){if(r==="f32")return vE[0]=t,rze[0];if(r==="i32"||r==="x32")return vE[0]=t,nze[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}class ize{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Y2{constructor(e,r){this.align=e,this.size=r}}class Wf{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new jBe,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const r of e)r instanceof Cb&&this._functions.set(r.name,new ize(r));for(const r of e)if(r instanceof Rd){const n=this.getTypeInfo(r,null);n instanceof jp&&this.structs.push(n)}for(const r of e)if(r instanceof HL)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof $L){const n=r,i=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new FBe(n.name,a,n.attributes,i));continue}if(this._isUniformVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new X2(n.name,s,i,a,n.attributes,Rp.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),u=new X2(n.name,s,i,a,n.attributes,o?Rp.StorageTexture:Rp.Storage,n.access);u.access||(u.access="read"),this.storage.push(u);continue}if(this._isTextureVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),u=new X2(n.name,s,i,a,n.attributes,o?Rp.StorageTexture:Rp.Texture,n.access);u.access||(u.access="read"),o?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new X2(n.name,s,i,a,n.attributes,Rp.Sampler,n.access);this.samplers.push(o);continue}}for(const r of e)if(r instanceof Cb){const n=this._getAttribute(r,"vertex"),i=this._getAttribute(r,"fragment"),a=this._getAttribute(r,"compute"),s=n||i||a,o=new zBe(r.name,s?.name,r.attributes);o.attributes=r.attributes,o.startLine=r.startLine,o.endLine=r.endLine,this.functions.push(o),this._functions.get(r.name).info=o,s&&(this._functions.get(r.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(r,!!s),o.inputs=this._getInputs(r.args),o.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(o)),o.arguments=r.args.map(u=>new BBe(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),o.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this._functions.values())r.node.search(n=>{var i,a,s;if(n instanceof rte){if(n.value)if(Dn(n.value))for(const o of n.value)for(const u of this.overrides)o===u.name&&((i=r.info)===null||i===void 0||i.overrides.push(u));else for(const o of this.overrides)n.value===o.name&&((a=r.info)===null||a===void 0||a.overrides.push(o))}else if(n instanceof Yc)for(const o of this.overrides)n.name===o.name&&((s=r.info)===null||s===void 0||s.overrides.push(o))});for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(const r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(const r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(const r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var n;for(const i of e.calls){const a=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;a&&r.add(a)}}findResource(e,r,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.vertex)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.fragment)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==r)return i;for(const i of this.storage)if(i.group==e&&i.binding==r)return i;for(const i of this.textures)if(i.group==e&&i.binding==r)return i;for(const i of this.samplers)if(i.group==e&&i.binding==r)return i;return null}_findResource(e){for(const r of this.uniforms)if(r.name==e)return r;for(const r of this.storage)if(r.name==e)return r;for(const r of this.textures)if(r.name==e)return r;for(const r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){const r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){const n=[],i=this,a=[];return e.search(s=>{if(s instanceof pE)a.push({});else if(s instanceof gE)a.pop();else if(s instanceof Dd){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof zf){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type)}else if(s instanceof B1){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof Yc){const o=s;if(a.length>0&&a[a.length-1][o.name])return;const u=i._findResource(o.name);u&&n.push(u)}else if(s instanceof WL){const o=s,u=i._functions.get(o.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,r)),n.push(...u.resources))}else if(s instanceof qL){const o=s,u=i._functions.get(o.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,r)),n.push(...u.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){const e=[];function r(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)r(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof Rd)this._getStructOutputs(e,r);else{const n=this._getOutputInfo(e);n!==null&&r.push(n)}return r}_getStructOutputs(e,r){for(const n of e.members)if(n.type instanceof Rd)this._getStructOutputs(n.type,r);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const a=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),o=new Dq(n.name,a,i.name,s);r.push(o)}}}_getOutputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(r.value);return new Dq("",n,r.name,i)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(const n of e)if(n.type instanceof Rd)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(e,r){for(const n of e.members)if(n.type instanceof Rd)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(r.value),s=new DBe(e.name,i,r.name,a);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(const r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new LBe(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const r of this.structs)if(r.name==e)return r;for(const r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Rw){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,a=new ZM(e.name,i,r);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof z1){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new Xp(i.name,r);return s.format=a,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Rd){const i=e,a=new jp(i.name,r);a.startLine=i.startLine,a.endLine=i.endLine;for(const s of i.members){const o=this.getTypeInfo(s.type,s.attributes);a.members.push(new Lq(s.name,o,s.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof p1){const i=e,a=i.format instanceof tn,s=i.format?a?this.getTypeInfo(i.format,null):new xh(i.format,null):null,o=new Mm(i.name,s,r,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof pr){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,s=new Mm(i.name,a,r,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new xh(e.name,r);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var r,n,i;const a=this._getTypeSize(e);if(e.size=(r=a?.size)!==null&&r!==void 0?r:0,e instanceof Xp&&e.format){const s=this._getTypeSize(e.format);e.stride=Math.max((n=s?.size)!==null&&n!==void 0?n:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof ZM&&this._updateTypeInfo(e.format),e instanceof jp&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let n=0,i=0,a=0,s=0;for(let o=0,u=e.members.length;o<u;++o){const h=e.members[o],f=this._getTypeSize(h);if(!f)continue;(r=this._getAlias(h.type.name))!==null&&r!==void 0||h.type;const d=f.align,b=f.size;n=this._roundUp(d,n+i),i=b,a=n,s=Math.max(s,d),h.offset=n,h.size=b,this._updateTypeInfo(h.type)}e.size=this._roundUp(s,a+i),e.align=s}_getTypeSize(e){var r,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Lq&&(e=e.type),e instanceof xh){const s=this._getAlias(e.name);s!==null&&(e=s)}{const s=Wf._typeInfo[e.name];if(s!==void 0){const o=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new Y2(Math.max(a,s.align/o),Math.max(i,s.size/o))}}{const s=Wf._typeInfo[e.name.substring(0,e.name.length-1)];if(s){const o=e.name[e.name.length-1]==="h"?2:1;return new Y2(Math.max(a,s.align/o),Math.max(i,s.size/o))}}if(e instanceof Xp){let s=e,o=8,u=8;const h=this._getTypeSize(s.format);return h!==null&&(u=h.size,o=h.align),u=s.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,u)),i&&(u=i),new Y2(Math.max(a,o),Math.max(i,u))}if(e instanceof jp){let s=0,o=0,u=0,h=0,f=0;for(const d of e.members){const b=this._getTypeSize(d.type);b!==null&&(s=Math.max(b.align,s),u=this._roundUp(b.align,u+h),h=b.size,f=u)}return o=this._roundUp(s,f+h),new Y2(Math.max(a,s),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof Dd&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Dd&&e.storage=="storage"}_isTextureVar(e){return e instanceof Dd&&e.type!==null&&Wf._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Dd&&e.type!==null&&Wf._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let a of i)if(a.name==r)return a;return null}_getAttributeNum(e,r,n){if(e===null)return n;for(let i of e)if(i.name==r){let a=i!==null&&i.value!==null?i.value:n;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):n}return n}_roundUp(e,r){return Math.ceil(r/e)*e}}Wf._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Wf._textureTypes=gt.any_texture_type.map(t=>t.name),Wf._samplerTypes=gt.sampler_type.map(t=>t.name);let GL=0;class XL{constructor(e,r,n){this.id=GL++,this.name=e,this.value=r,this.node=n}clone(){return new XL(this.name,this.value,this.node)}}class YL{constructor(e){this.id=GL++,this.name=e.name,this.node=e}clone(){return new YL(this.node)}}class ZL{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=GL++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,n){this.variables.set(e,new XL(e,r,n??null))}setVariable(e,r,n){const i=this.getVariable(e);i!==null?i.value=r:this.createVariable(e,r,n)}getVariableValue(e){var r;const n=this.getVariable(e);return(r=n?.value)!==null&&r!==void 0?r:null}clone(){return new ZL(this)}}class aze{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}}class oze{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){const n=this.exec.evalExpression(e.args[0],r);let i=!0;if(n instanceof Pt)return n.data.forEach(a=>{a||(i=!1)}),new lr(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt){const i=n.data.some(a=>a);return new lr(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){const n=this.exec.evalExpression(e.args[2],r);if(!(n instanceof lr))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.evalExpression(n,r);if(i instanceof Ds&&i.typeInfo.size===0){const a=i.typeInfo,s=i.buffer.byteLength/a.stride;return new lr(s,this.getTypeInfo("u32"))}return new lr(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.abs(a)),n.typeInfo);const i=n;return new lr(Math.abs(i.value),i.typeInfo)}Acos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.acos(a)),n.typeInfo);const i=n;return new lr(Math.acos(i.value),n.typeInfo)}Acosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.acosh(a)),n.typeInfo);const i=n;return new lr(Math.acosh(i.value),n.typeInfo)}Asin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.asin(a)),n.typeInfo);const i=n;return new lr(Math.asin(i.value),n.typeInfo)}Asinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.asinh(a)),n.typeInfo);const i=n;return new lr(Math.asinh(i.value),n.typeInfo)}Atan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.atan(a)),n.typeInfo);const i=n;return new lr(Math.atan(i.value),n.typeInfo)}Atanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.atanh(a)),n.typeInfo);const i=n;return new lr(Math.atanh(i.value),n.typeInfo)}Atan2(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((o,u)=>Math.atan2(o,i.data[u])),n.typeInfo);const a=n,s=i;return new lr(Math.atan2(a.value,s.value),n.typeInfo)}Ceil(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.ceil(a)),n.typeInfo);const i=n;return new lr(Math.ceil(i.value),n.typeInfo)}_clamp(e,r,n){return Math.min(Math.max(e,r),n)}Clamp(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Pt&&i instanceof Pt&&a instanceof Pt)return new Pt(n.data.map((h,f)=>this._clamp(h,i.data[f],a.data[f])),n.typeInfo);const s=n,o=i,u=a;return new lr(this._clamp(s.value,o.value,u.value),n.typeInfo)}Cos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.cos(a)),n.typeInfo);const i=n;return new lr(Math.cos(i.value),n.typeInfo)}Cosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.cosh(a)),n.typeInfo);const i=n;return new lr(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.clz32(a)),n.typeInfo);const i=n;return new lr(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>this._countOneBits(a)),n.typeInfo);const i=n;return new lr(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>this._countTrailingZeros(a)),n.typeInfo);const i=n;return new lr(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=n.data,s=i.data;return new Pt([a[1]*s[2]-s[1]*a[2],a[2]*s[0]-s[2]*a[0],a[0]*s[1]-s[0]*a[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){const n=this.exec.evalExpression(e.args[0],r),i=180/Math.PI;return n instanceof Pt?new Pt(n.data.map(a=>a*i),n.typeInfo):new lr(n.value*i,this.getTypeInfo("f32"))}Determinant(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Ai){const i=n.data,a=n.typeInfo.getTypeName(),s=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new lr(i[0]*i[3]-i[1]*i[2],s);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new lr(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new lr(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt){let o=0;for(let u=0;u<n.data.length;++u)o+=(n.data[u]-i.data[u])*(n.data[u]-i.data[u]);return new lr(Math.sqrt(o),this.getTypeInfo("f32"))}const a=n,s=i;return new lr(Math.abs(a.value-s.value),n.typeInfo)}_dot(e,r){let n=0;for(let i=0;i<e.length;++i)n+=r[i]*e[i];return n}Dot(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);return n instanceof Pt&&i instanceof Pt?new lr(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.exp(a)),n.typeInfo);const i=n;return new lr(Math.exp(i.value),n.typeInfo)}Exp2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.pow(2,a)),n.typeInfo);const i=n;return new lr(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const s=i.value,o=a.value;if(n instanceof Pt)return new Pt(n.data.map(h=>h>>s&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const u=n.value;return new lr(u>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Pt&&i instanceof Pt&&a instanceof Pt){const s=this._dot(i.data,a.data);return new Pt(s<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>this._firstLeadingBit(a)),n.typeInfo);const i=n;return new lr(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>this._firstTrailingBit(a)),n.typeInfo);const i=n;return new lr(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.floor(a)),n.typeInfo);const i=n;return new lr(Math.floor(i.value),n.typeInfo)}Fma(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Pt&&i instanceof Pt&&a instanceof Pt)return n.data.length!==i.data.length||n.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Pt(n.data.map((h,f)=>h*i.data[f]+a.data[f]),n.typeInfo);const s=n,o=i,u=a;return new lr(s.value*o.value+u.value,s.typeInfo)}Fract(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>a-Math.floor(a)),n.typeInfo);const i=n;return new lr(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=a.value,u=(1<<s.value)-1<<o,h=~u;if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((b,v)=>b&h|i.data[v]<<o&u),n.typeInfo);const f=n.value,d=i.value;return new lr(f&h|d<<o&u,n.typeInfo)}InverseSqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>1/Math.sqrt(a)),n.typeInfo);const i=n;return new lr(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt){let a=0;return n.data.forEach(s=>{a+=s*s}),new lr(Math.sqrt(a),this.getTypeInfo("f32"))}const i=n;return new lr(Math.abs(i.value),n.typeInfo)}Log(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.log(a)),n.typeInfo);const i=n;return new lr(Math.log(i.value),n.typeInfo)}Log2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.log2(a)),n.typeInfo);const i=n;return new lr(Math.log2(i.value),n.typeInfo)}Max(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((o,u)=>Math.max(o,i.data[u])),n.typeInfo);const a=n,s=i;return new lr(Math.max(a.value,s.value),n.typeInfo)}Min(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((o,u)=>Math.min(o,i.data[u])),n.typeInfo);const a=n,s=i;return new lr(Math.min(a.value,s.value),n.typeInfo)}Mix(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Pt&&i instanceof Pt&&a instanceof Pt)return new Pt(n.data.map((u,h)=>n.data[h]*(1-a.data[h])+i.data[h]*a.data[h]),n.typeInfo);const s=i,o=a;return new lr(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((s,o)=>s%i.data[o]),n.typeInfo);const a=i;return new lr(n.value%a.value,n.typeInfo)}Normalize(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt){const i=this.Length(e,r).value;return new Pt(n.data.map(a=>a/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt)return new Pt(n.data.map((o,u)=>Math.pow(o,i.data[u])),n.typeInfo);const a=n,s=i;return new lr(Math.pow(a.value,s.value),n.typeInfo)}QuantizeToF16(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof Pt?new Pt(n.data.map(i=>i),n.typeInfo):new lr(n.value,n.typeInfo)}Radians(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof Pt?new Pt(n.data.map(i=>i*Math.PI/180),n.typeInfo):new lr(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Pt&&i instanceof Pt){const a=this._dot(n.data,i.data);return new Pt(n.data.map((s,o)=>s-2*a*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Pt&&i instanceof Pt&&a instanceof lr){const s=this._dot(i.data,n.data);return new Pt(n.data.map((o,u)=>{const h=1-a.value*a.value*(1-s*s);if(h<0)return 0;const f=Math.sqrt(h);return a.value*o-(a.value*s+f)*i.data[u]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.round(a)),n.typeInfo);const i=n;return new lr(Math.round(i.value),n.typeInfo)}Saturate(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.min(Math.max(a,0),1)),n.typeInfo);const i=n;return new lr(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.sign(a)),n.typeInfo);const i=n;return new lr(Math.sign(i.value),n.typeInfo)}Sin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.sin(a)),n.typeInfo);const i=n;return new lr(Math.sin(i.value),n.typeInfo)}Sinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.sinh(a)),n.typeInfo);const i=n;return new lr(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,r,n){const i=Math.min(Math.max((n-e)/(r-e),0),1);return i*i*(3-2*i)}SmoothStep(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(a instanceof Pt&&n instanceof Pt&&i instanceof Pt)return new Pt(a.data.map((h,f)=>this._smoothstep(n.data[f],i.data[f],h)),a.typeInfo);const s=n,o=i,u=a;return new lr(this._smoothstep(s.value,o.value,u.value),a.typeInfo)}Sqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.sqrt(a)),n.typeInfo);const i=n;return new lr(Math.sqrt(i.value),n.typeInfo)}Step(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(i instanceof Pt&&n instanceof Pt)return new Pt(i.data.map((s,o)=>s<n.data[o]?0:1),i.typeInfo);const a=n;return new lr(i.value<a.value?0:1,a.typeInfo)}Tan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.tan(a)),n.typeInfo);const i=n;return new lr(Math.tan(i.value),n.typeInfo)}Tanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.tanh(a)),n.typeInfo);const i=n;return new lr(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){const n=this.exec.evalExpression(e.args[0],r);if(!(n instanceof Ai))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const a=n.data;return new Ai([a[0],a[2],a[1],a[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const a=n.data;return new Ai([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const a=n.data;return new Ai([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const a=n.data;return new Ai([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const a=n.data;return new Ai([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Pt)return new Pt(n.data.map(a=>Math.trunc(a)),n.typeInfo);const i=n;return new lr(Math.trunc(i.value),n.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(n instanceof Yc){const a=n.name,s=r.getVariableValue(a);if(s instanceof Od){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=s.getMipLevelSize(i),u=s.dimension;return u==="1d"?new lr(o[0],this.getTypeInfo("u32")):u==="3d"?new Pt(o,this.getTypeInfo("vec3u")):u==="2d"?new Pt(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(i instanceof Pt)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof Yc){const s=n.name,o=r.getVariableValue(s);if(o instanceof Od){const u=Math.floor(i.data[0]),h=Math.floor(i.data[1]);if(u<0||u>=o.width||h<0||h>=o.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;const f=o.getPixel(u,h,0,a);return f===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Pt(f,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){const n=e.args[0];if(n instanceof Yc){const i=n.name,a=r.getVariableValue(i);return a instanceof Od?new lr(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){const n=e.args[0];if(n instanceof Yc){const i=n.name,a=r.getVariableValue(i);return a instanceof Od?new lr(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){const n=e.args[0];if(n instanceof Yc){const i=n.name,a=r.getVariableValue(i);return a instanceof Od?new lr(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof Pt)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof Yc){const o=n.name,u=r.getVariableValue(o);if(u instanceof Od){const h=u.getMipLevelSize(0),f=Math.floor(i.data[0]),d=Math.floor(i.data[1]);return f<0||f>=h[0]||d<0||d>=h[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(u.setPixel(f,d,0,a,Array.from(s)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r);return r.getVariable(i).value.getSubData(this.exec,n.postfix,r)}AtomicStore(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r);return u instanceof lr&&o instanceof lr&&(u.value=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),null}AtomicAdd(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value+=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicSub(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value-=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicMax(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=Math.max(u.value,o.value)),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicMin(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=Math.min(u.value,o.value)),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicAnd(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=u.value&o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicOr(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=u.value|o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicXor(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=u.value^o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicExchange(e,r){let n=e.args[0];n instanceof gl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new lr(u.value,u.typeInfo);return u instanceof lr&&o instanceof lr&&(u.value=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}}const qI={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},ic={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class qu extends aze{constructor(e,r){var n;super(),this.ast=e??[],this.reflection=new Wf,this.reflection.updateAST(this.ast),this.context=(n=r?.clone())!==null&&n!==void 0?n:new ZL,this.builtins=new oze(this),this.typeInfo={bool:this.getTypeInfo(tn.bool),i32:this.getTypeInfo(tn.i32),u32:this.getTypeInfo(tn.u32),f32:this.getTypeInfo(tn.f32),f16:this.getTypeInfo(tn.f16),vec2f:this.getTypeInfo(pr.vec2f),vec2u:this.getTypeInfo(pr.vec2u),vec2i:this.getTypeInfo(pr.vec2i),vec2h:this.getTypeInfo(pr.vec2h),vec3f:this.getTypeInfo(pr.vec3f),vec3u:this.getTypeInfo(pr.vec3u),vec3i:this.getTypeInfo(pr.vec3i),vec3h:this.getTypeInfo(pr.vec3h),vec4f:this.getTypeInfo(pr.vec4f),vec4u:this.getTypeInfo(pr.vec4u),vec4i:this.getTypeInfo(pr.vec4i),vec4h:this.getTypeInfo(pr.vec4h),mat2x2f:this.getTypeInfo(pr.mat2x2f),mat2x3f:this.getTypeInfo(pr.mat2x3f),mat2x4f:this.getTypeInfo(pr.mat2x4f),mat3x2f:this.getTypeInfo(pr.mat3x2f),mat3x3f:this.getTypeInfo(pr.mat3x3f),mat3x4f:this.getTypeInfo(pr.mat3x4f),mat4x2f:this.getTypeInfo(pr.mat4x2f),mat4x3f:this.getTypeInfo(pr.mat4x3f),mat4x4f:this.getTypeInfo(pr.mat4x4f)}}getVariableValue(e){var r,n;const i=(n=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof lr)return i.value;if(i instanceof Pt||i instanceof Ai)return Array.from(i.data);if(i instanceof Ds&&i.typeInfo instanceof Xp){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,n,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const s=a.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}const o=r[0],u=r[1],h=r[2],f=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new Pt(r,f));const d=this.reflection.getFunctionInfo(e);d===null&&console.error(`Function ${e} not found in reflection data`);for(const b in n)for(const v in n[b]){const S=n[b][v];a.variables.forEach(E=>{var P;const k=E.node;if(k?.attributes){let L=null,N=null;for(const M of k.attributes)M.name==="binding"?L=M.value:M.name==="group"&&(N=M.value);if(v==L&&b==N){let M=!1;for(const z of d.resources)if(z.name===E.name&&z.group===parseInt(b)&&z.binding===parseInt(v)){M=!0;break}if(M)if(S.texture!==void 0&&S.descriptor!==void 0){const z=new Od(S.texture,this.getTypeInfo(k.type),S.descriptor,(P=S.texture.view)!==null&&P!==void 0?P:null);E.value=z}else S.uniform!==void 0?E.value=new Ds(S.uniform,this.getTypeInfo(k.type)):E.value=new Ds(S,this.getTypeInfo(k.type))}}})}for(let b=0;b<h;++b)for(let v=0;v<u;++v)for(let S=0;S<o;++S)a.setVariable("@workgroup_id",new Pt([S,v,b],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[S,v,b],a)}execStatement(e,r){if(e instanceof Wee)return this.evalExpression(e.value,r);if(e instanceof Xee){if(e.condition){const n=this.evalExpression(e.condition,r);if(!(n instanceof lr))throw new Error("Invalid break-if condition");if(!n.value)return null}return qu._breakObj}if(e instanceof Yee)return qu._continueObj;if(e instanceof B1)this._let(e,r);else if(e instanceof Dd)this._var(e,r);else if(e instanceof Mw)this._const(e,r);else if(e instanceof Cb)this._function(e,r);else{if(e instanceof Hee)return this._if(e,r);if(e instanceof qee)return this._switch(e,r);if(e instanceof jee)return this._for(e,r);if(e instanceof zee)return this._while(e,r);if(e instanceof $ee)return this._loop(e,r);if(e instanceof KM){const n=r.clone();return n.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof Vee)this._assign(e,r);else if(e instanceof Uee)this._increment(e,r);else{if(e instanceof Rd)return null;if(e instanceof $L){const n=e.name;r.getVariable(n)===null&&r.setVariable(n,new lr(0,this.getTypeInfo("u32")))}else if(e instanceof qL)this._call(e,r);else{if(e instanceof Gee||e instanceof HL)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof Zh?this._evalBinaryOp(e,r):e instanceof Rl?this._evalLiteral(e,r):e instanceof Yc?this._evalVariable(e,r):e instanceof WL?this._evalCall(e,r):e instanceof zf?this._evalCreate(e,r):e instanceof Zee?this._evalConst(e,r):e instanceof Kee?this._evalBitcast(e,r):e instanceof gl?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof tn){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,r){for(const n in e){const i=e[n],a=this.reflection.getOverrideInfo(n);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?r.setVariable(n,new lr(i,a.type)):a.type.name==="bool"?r.setVariable(n,new lr(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?r.setVariable(n,new Pt(i,a.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,n){const i=[1,1,1];for(const f of e.node.attributes)if(f.name==="workgroup_size"){if(f.value.length>0){const d=n.getVariableValue(f.value[0]);i[0]=d instanceof lr?d.value:parseInt(f.value[0])}if(f.value.length>1){const d=n.getVariableValue(f.value[1]);i[1]=d instanceof lr?d.value:parseInt(f.value[1])}if(f.value.length>2){const d=n.getVariableValue(f.value[2]);i[2]=d instanceof lr?d.value:parseInt(f.value[2])}}const a=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new Pt(i,a));const o=i[0],u=i[1],h=i[2];for(let f=0,d=0;f<h;++f)for(let b=0;b<u;++b)for(let v=0;v<o;++v,++d){const S=[v,b,f],E=[v+r[0]*i[0],b+r[1]*i[1],f+r[2]*i[2]];n.setVariable("@local_invocation_id",new Pt(S,a)),n.setVariable("@global_invocation_id",new Pt(E,a)),n.setVariable("@local_invocation_index",new lr(d,s)),this._dispatchExec(e,n)}}_dispatchExec(e,r){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const a=`@${i.value}`,s=r.getVariable(a);s!==void 0&&r.variables.set(n.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof gl;)e=e.right;return e instanceof Yc?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(const n of e){if(n instanceof Array){const a=r.clone(),s=this._execStatements(n,a);if(s)return s;continue}const i=this.execStatement(n,r);if(i)return i}return null}_call(e,r){const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.setVariable(s.name,o,s)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){const n=this.getVariableName(e.variable,r),i=r.getVariable(n);i?e.operator==="++"?i.value instanceof lr?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof lr?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof Yc){const n=this.getVariableName(e,r),i=r.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,r)}if(e instanceof gl){if(e.operator==="*"){const n=this._getVariableData(e.right,r);return n instanceof $y?n.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,r);return new $y(n)}}return null}_assign(e,r){let n=null,i="<var>",a=null;if(e.variable instanceof gl){const u=this._getVariableData(e.variable,r),h=this.evalExpression(e.value,r),f=e.operator;if(f==="="){if(u instanceof lr||u instanceof Pt||u instanceof Ai){if(h instanceof lr||h instanceof Pt||h instanceof Ai&&u.data.length===h.data.length)return void u.data.set(h.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof Ds&&h instanceof Ds&&u.buffer.byteLength-u.offset>=h.buffer.byteLength-h.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(h.buffer,h.offset,h.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(h.buffer,h.offset,h.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(f==="+=")return u instanceof lr||u instanceof Pt||u instanceof Ai?h instanceof lr||h instanceof Pt||h instanceof Ai?void u.data.set(h.data.map((d,b)=>u.data[b]+d)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(f==="-=")return(u instanceof lr||u instanceof Pt||u instanceof Ai)&&(h instanceof lr||h instanceof Pt||h instanceof Ai)?void u.data.set(h.data.map((d,b)=>u.data[b]-d)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof gl){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,r);const u=r.getVariable(i);if(!(u&&u.value instanceof $y))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=u.value.reference;let h=e.variable.postfix;if(!h){let f=e.variable.right;for(;f instanceof gl;){if(f.postfix){h=f.postfix;break}f=f.right}}h&&(n=n.getSubData(this,h,r))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,r);const u=r.getVariable(i);if(u===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=u.value}if(n instanceof $y&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const s=this.evalExpression(e.value,r),o=e.operator;if(o!=="="){const u=n.getSubData(this,a,r);if(u instanceof Pt&&s instanceof lr){const h=u.data,f=s.value;if(o==="+=")for(let d=0;d<h.length;++d)h[d]+=f;else if(o==="-=")for(let d=0;d<h.length;++d)h[d]-=f;else if(o==="*=")for(let d=0;d<h.length;++d)h[d]*=f;else if(o==="/=")for(let d=0;d<h.length;++d)h[d]/=f;else if(o==="%=")for(let d=0;d<h.length;++d)h[d]%=f;else if(o==="&=")for(let d=0;d<h.length;++d)h[d]&=f;else if(o==="|=")for(let d=0;d<h.length;++d)h[d]|=f;else if(o==="^=")for(let d=0;d<h.length;++d)h[d]^=f;else if(o==="<<=")for(let d=0;d<h.length;++d)h[d]<<=f;else if(o===">>=")for(let d=0;d<h.length;++d)h[d]>>=f;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(u instanceof Pt&&s instanceof Pt){const h=u.data,f=s.data;if(h.length!==f.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let d=0;d<h.length;++d)h[d]+=f[d];else if(o==="-=")for(let d=0;d<h.length;++d)h[d]-=f[d];else if(o==="*=")for(let d=0;d<h.length;++d)h[d]*=f[d];else if(o==="/=")for(let d=0;d<h.length;++d)h[d]/=f[d];else if(o==="%=")for(let d=0;d<h.length;++d)h[d]%=f[d];else if(o==="&=")for(let d=0;d<h.length;++d)h[d]&=f[d];else if(o==="|=")for(let d=0;d<h.length;++d)h[d]|=f[d];else if(o==="^=")for(let d=0;d<h.length;++d)h[d]^=f[d];else if(o==="<<=")for(let d=0;d<h.length;++d)h[d]<<=f[d];else if(o===">>=")for(let d=0;d<h.length;++d)h[d]>>=f[d];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(u instanceof lr&&s instanceof lr))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?u.value+=s.value:o==="-="?u.value-=s.value:o==="*="?u.value*=s.value:o==="/="?u.value/=s.value:o==="%="?u.value%=s.value:o==="&="?u.value&=s.value:o==="|="?u.value|=s.value:o==="^="?u.value^=s.value:o==="<<="?u.value<<=s.value:o===">>="?u.value>>=s.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof Ds&&n.setDataValue(this,u,a,r))}if(n instanceof Ds)n.setDataValue(this,s,a,r);else if(a){if(!(n instanceof Pt||n instanceof Ai))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof y0){const u=this.evalExpression(a.index,r).value;if(n instanceof Pt){if(!(s instanceof lr))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[u]=s.value}else{if(!(n instanceof Ai))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const h=this.evalExpression(a.index,r).value;if(h<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof Pt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=n.typeInfo.getTypeName();if(f==="mat2x2"||f==="mat2x2f"||f==="mat2x2h"){if(!(h<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat2x3"||f==="mat2x3f"||f==="mat2x3h"){if(!(h<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(f==="mat2x4"||f==="mat2x4f"||f==="mat2x4h"){if(!(h<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(f==="mat3x2"||f==="mat3x2f"||f==="mat3x2h"){if(!(h<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat3x3"||f==="mat3x3f"||f==="mat3x3h"){if(!(h<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(f==="mat3x4"||f==="mat3x4f"||f==="mat3x4h"){if(!(h<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(f==="mat4x2"||f==="mat4x2f"||f==="mat4x2h"){if(!(h<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat4x3"||f==="mat4x3f"||f==="mat4x3h"){if(!(h<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else{if(f!=="mat4x4"&&f!=="mat4x4f"&&f!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(h<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}}}}}else if(a instanceof Rm){const u=a.value;if(!(n instanceof Pt))return void console.error(`Invalid assignment to ${u}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof lr){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);if(u==="x")n.data[0]=s.value;else if(u==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[1]=s.value}else if(u==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[2]=s.value}else if(u==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[3]=s.value}}else{if(!(s instanceof Pt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(u.length!==s.data.length)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);for(let h=0;h<u.length;++h){const f=u[h];if(f==="x"||f==="r")n.data[0]=s.data[h];else if(f==="y"||f==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[1]=s.data[h]}else if(f==="z"||f==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[2]=s.data[h]}else{if(f!=="w"&&f!=="a")return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[3]=s.data[h]}}}}}else n instanceof lr&&s instanceof lr?n.value=s.value:n instanceof Pt&&s instanceof Pt||n instanceof Ai&&s instanceof Ai?n.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,r){const n=new YL(e);r.functions.set(e.name,n)}_const(e,r){let n=null;e.value!==null&&(n=this.evalExpression(e.value,r)),r.createVariable(e.name,n,e)}_let(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof gl||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new zf(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_var(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof gl||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof z1||e.type instanceof Rd||e.type instanceof pr){const a=new zf(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_switch(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof lr))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof ete)for(const s of a.selectors){if(s instanceof Ow){i=a;continue}const o=this.evalExpression(s,r);if(!(o instanceof lr))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(a.body,r)}else a instanceof tte&&(i=a);return i?this._execStatements(i.body,r):null}_if(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof lr))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,r);for(const i of e.elseif){const a=this.evalExpression(i.condition,r);if(!(a instanceof lr))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof lr?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===qu._breakObj)break;if(n!==null&&n!==qu._continueObj)return n;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){const n=this._execStatements(e.body,r);if(n===qu._breakObj)break;if(n===qu._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===qu._breakObj)break}else if(n!==null)return n}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===qu._breakObj)break;if(n!==qu._continueObj&&n!==null)return n}return null}_evalBitcast(e,r){const n=this.evalExpression(e.value,r),i=e.type;if(n instanceof lr){const a=Vq(n.value,n.typeInfo.name,i.name);return new lr(a,this.getTypeInfo(i))}if(n instanceof Pt){const a=n.typeInfo.getTypeName();let s="";if(a.endsWith("f"))s="f32";else if(a.endsWith("i"))s="i32";else if(a.endsWith("u"))s="u32";else if(a.endsWith("b"))s="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;s="f16"}const o=i.getTypeName();let u="";if(o.endsWith("f"))u="f32";else if(o.endsWith("i"))u="i32";else if(o.endsWith("u"))u="u32";else if(o.endsWith("b"))u="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}const h=(function(f,d,b){if(d===b)return f;const v=new Array(f.length);for(let S=0;S<f.length;S++)v[S]=Vq(f[S],d,b);return v})(Array.from(n.data),s,u);return new Pt(h,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var n;if(e instanceof zf){if(e.type===null)return JM.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}const i=e instanceof zf?e.type.name:e.name,a=e instanceof zf?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const s=new Ds(new ArrayBuffer(a.size),a,0);if(a instanceof jp){if(e.args)for(let o=0;o<e.args.length;++o){const u=a.members[o],h=e.args[o],f=this.evalExpression(h,r);s.setData(this,f,u.type,u.offset,r)}}else if(a instanceof Xp){let o=0;if(e.args)for(let u=0;u<e.args.length;++u){const h=e.args[u],f=this.evalExpression(h,r);a.format===null&&(((n=f.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=f.typeInfo),s.setData(this,f,a.format,o,r),o+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof zf?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new lr(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,r):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){const n=r.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=qu._priority.get(r.name);qu._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){const n=this.evalExpression(e.right,r);if(e.operator==="&")return new $y(n);if(e.operator==="*")return n instanceof $y?n.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof lr?n.value:n instanceof Pt?Array.from(n.data):null;switch(e.operator){case"+":{if(Dn(i)){const o=i.map((u,h)=>+u);return new Pt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new lr(+a,s)}case"-":{if(Dn(i)){const o=i.map((u,h)=>-u);return new Pt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new lr(-a,s)}case"!":{if(Dn(i)){const o=i.map((u,h)=>u?0:1);return new Pt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new lr(a?0:1,s)}case"~":{if(Dn(i)){const o=i.map((u,h)=>~u);return new Pt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new lr(~a,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){const n=this.evalExpression(e.left,r),i=this.evalExpression(e.right,r),a=n instanceof lr?n.value:n instanceof Pt||n instanceof Ai?Array.from(n.data):null,s=i instanceof lr?i.value:i instanceof Pt||i instanceof Ai?Array.from(i.data):null;switch(e.operator){case"+":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v+d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b+f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f+b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o+u,h)}case"-":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v-d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b-f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f-b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o-u,h)}case"*":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(n instanceof Ai&&i instanceof Ai){const b=(function(P,k,L,N){if(ic[k.name]===void 0||ic[N.name]===void 0)return null;const M=ic[k.name][0],z=ic[k.name][1],B=ic[N.name][0];if(M!==ic[N.name][1])return null;const q=new Array(B*z);for(let W=0;W<z;W++)for(let G=0;G<B;G++){let ie=0;for(let J=0;J<M;J++)ie+=P[J*z+W]*L[G*M+J];q[W*B+G]=ie}return q})(f,n.typeInfo,d,i.typeInfo);if(b===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const v=ic[i.typeInfo.name][0],S=ic[n.typeInfo.name][1],E=this.getTypeInfo(`mat${v}x${S}f`);return new Ai(b,E)}if(n instanceof Ai&&i instanceof Pt){const b=(function(v,S,E,P){if(ic[S.name]===void 0||qI[P.name]===void 0)return null;const k=ic[S.name][0],L=ic[S.name][1];if(k!==E.length)return null;const N=new Array(L);for(let M=0;M<L;M++){let z=0;for(let B=0;B<k;B++)z+=v[B*L+M]*E[B];N[M]=z}return N})(f,n.typeInfo,d,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Pt(b,i.typeInfo)}if(n instanceof Pt&&i instanceof Ai){const b=(function(v,S,E,P){if(qI[S.name]===void 0||ic[P.name]===void 0)return null;const k=ic[P.name][0],L=ic[P.name][1];if(L!==v.length)return null;const N=[];for(let M=0;M<k;M++){let z=0;for(let B=0;B<L;B++)z+=v[B]*E[B*k+M];N[M]=z}return N})(f,n.typeInfo,d,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Pt(b,n.typeInfo)}{if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v*d[S]);return new Pt(b,n.typeInfo)}}if(Dn(a)){const f=s,d=a.map((b,v)=>b*f);return n instanceof Ai?new Ai(d,n.typeInfo):new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f*b);return i instanceof Ai?new Ai(d,i.typeInfo):new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o*u,h)}case"%":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v%d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b%f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f%b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o%u,h)}case"/":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v/d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b/f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f/b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o/u,h)}case"&":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v&d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b&f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f&b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o&u,h)}case"|":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v|d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b|f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f|b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o|u,h)}case"^":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v^d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b^f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f^b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o^u,h)}case"<<":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v<<d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b<<f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f<<b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o<<u,h)}case">>":{if(Dn(a)&&Dn(s)){const f=a,d=s;if(f.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v>>d[S]);return new Pt(b,n.typeInfo)}if(Dn(a)){const f=s,d=a.map((b,v)=>b>>f);return new Pt(d,n.typeInfo)}if(Dn(s)){const f=a,d=s.map((b,v)=>f>>b);return new Pt(d,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new lr(o>>u,h)}case">":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f>u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h>o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o>h?1:0);return new Pt(u,i.typeInfo)}return new lr(a>s?1:0,this.getTypeInfo("bool"));case"<":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f<u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h<o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o<h?1:0);return new Pt(u,i.typeInfo)}return new lr(a<s?1:0,this.getTypeInfo("bool"));case"==":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f===u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h==o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o==h?1:0);return new Pt(u,i.typeInfo)}return new lr(a===s?1:0,this.getTypeInfo("bool"));case"!=":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f!==u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h!==o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o!==h?1:0);return new Pt(u,i.typeInfo)}return new lr(a!==s?1:0,this.getTypeInfo("bool"));case">=":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f>=u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h>=o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o>=h?1:0);return new Pt(u,i.typeInfo)}return new lr(a>=s?1:0,this.getTypeInfo("bool"));case"<=":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f<=u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h<=o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o<=h?1:0);return new Pt(u,i.typeInfo)}return new lr(a<=s?1:0,this.getTypeInfo("bool"));case"&&":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f&&u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h&&o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o&&h?1:0);return new Pt(u,i.typeInfo)}return new lr(a&&s?1:0,this.getTypeInfo("bool"));case"||":if(Dn(a)&&Dn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,d)=>f||u[d]?1:0);return new Pt(h,n.typeInfo)}if(Dn(a)){const o=s,u=a.map((h,f)=>h||o?1:0);return new Pt(u,n.typeInfo)}if(Dn(s)){const o=a,u=s.map((h,f)=>o||h?1:0);return new Pt(u,i.typeInfo)}return new lr(a||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.createVariable(s.name,o,s)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}const n=r.getFunction(e.name);if(n){const i=r.clone();for(let a=0;a<n.node.args.length;++a){const s=n.node.args[a],o=this.evalExpression(e.args[a],i);i.setVariable(s.name,o,s)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new lr(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],r);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=qI[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Rl)if(e.isVector){const o=e.vectorValue;for(const u of o)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,r);if(u instanceof Pt){const h=u.data;for(let f=0;f<h.length;++f){let d=h[f];s.push(d)}}else if(u instanceof lr){let h=u.value;s.push(h)}}if(e.type instanceof pr&&e.type.format===null&&(e.type.format=pr.f32),s.length===0){const o=new Array(a).fill(0);return new Pt(o,n).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<a;)s.push(s[0]);return s.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Pt(s.length>a?s.slice(0,a):s,n).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=ic[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Rl)if(e.isVector){const o=e.vectorValue;for(const u of o)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,r);u instanceof Pt?s.push(...u.data):u instanceof lr?s.push(u.value):u instanceof Ai&&s.push(...u.data)}if(n instanceof Mm&&n.format===null&&(n.format=this.getTypeInfo("f32")),s.length===0){const o=new Array(a[2]).fill(0);return new Ai(o,n).getSubData(this,e.postfix,r)}return s.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ai(s,n).getSubData(this,e.postfix,r)}}qu._breakObj=new Oh(new xh("BREAK",null),null),qu._continueObj=new Oh(new xh("CONTINUE",null),null),qu._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class sze{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class lze{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new sze,this._exec=new qu,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,a=n.countNode;if(a instanceof Yc){const s=a.name,o=this._context.constants.get(s);if(o)try{const u=o.constEvaluate(this._exec);i.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of r)n.search(i=>{i instanceof jq||i instanceof Rw?i.type=this._forwardType(i.type):i instanceof z1?i.format=this._forwardType(i.format):i instanceof Dd||i instanceof B1||i instanceof Mw?i.type=this._forwardType(i.type):i instanceof Cb?i.returnType=this._forwardType(i.returnType):i instanceof zq&&(i.type=this._forwardType(i.type))});return r}_forwardType(e){if(e instanceof Bq){const r=this._getType(e.name);if(r)return r}else e instanceof Rw?e.type=this._forwardType(e.type):e instanceof z1&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const r=new KBe(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==gt.eof}_match(e){if(e instanceof hr)return!!this._check(e)&&(this._advance(),!0);for(let r=0,n=e.length;r<n;++r){const i=e[r];if(this._check(i))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const r=this._peek();if(e instanceof Array){const n=r.type;let i=!1;for(const a of e){if(n===a)return!0;a===gt.tokens.name&&(i=!0)}if(i){const a=gt.tokens.name.rule.exec(r.lexeme);if(a&&a.index==0&&a[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===gt.tokens.name){const n=gt.tokens.name.rule.exec(r.lexeme);return n&&n.index==0&&n[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(gt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(gt.keywords.alias)){const r=this._type_alias();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.diagnostic)){const r=this._diagnostic();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.requires)){const r=this._requires_directive();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.enable)){const r=this._enable_directive();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}const e=this._attribute();if(this._check(gt.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(gt.keywords.fn))return null;const e=this._currentLine,r=this._consume(gt.tokens.ident,"Expected function name.").toString();this._consume(gt.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(gt.tokens.paren_right))do{if(this._check(gt.tokens.paren_right))break;const o=this._attribute(),u=this._consume(gt.tokens.name,"Expected argument name.").toString();this._consume(gt.tokens.colon,"Expected ':' for argument type.");const h=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=h,n.push(this._updateNode(new zq(u,f,o))))}while(this._match(gt.tokens.comma));this._consume(gt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(gt.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const a=this._compound_statement(),s=this._currentLine;return this._updateNode(new Cb(r,n,i,a,e,s),e)}_compound_statement(){const e=[];for(this._consume(gt.tokens.brace_left,"Expected '{' for block.");!this._check(gt.tokens.brace_right);){const r=this._statement();r!==null&&e.push(r)}return this._consume(gt.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(gt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(gt.tokens.attr)&&this._attribute(),this._check(gt.keywords.if))return this._if_statement();if(this._check(gt.keywords.switch))return this._switch_statement();if(this._check(gt.keywords.loop))return this._loop_statement();if(this._check(gt.keywords.for))return this._for_statement();if(this._check(gt.keywords.while))return this._while_statement();if(this._check(gt.keywords.continuing))return this._continuing_statement();if(this._check(gt.keywords.static_assert))return this._static_assert_statement();if(this._check(gt.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(gt.keywords.return))e=this._return_statement();else if(this._check([gt.keywords.var,gt.keywords.let,gt.keywords.const]))e=this._variable_statement();else if(this._match(gt.keywords.discard))e=this._updateNode(new XBe);else if(this._match(gt.keywords.break)){const r=this._updateNode(new Xee);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r,this._check(gt.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(gt.keywords.continue)){const r=this._updateNode(new Yee);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(gt.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(gt.keywords.static_assert))return null;const e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new HBe(r),e)}_while_statement(){if(!this._match(gt.keywords.while))return null;const e=this._updateNode(new zee(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(gt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(gt.keywords.continuing))return null;const r=this._currentLine,n=this._compound_statement();return this._updateNode(new KM(n,e),r)}_for_statement(){if(!this._match(gt.keywords.for))return null;this._consume(gt.tokens.paren_left,"Expected '('.");const e=this._updateNode(new jee(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(gt.tokens.semicolon)?null:this._for_init(),this._consume(gt.tokens.semicolon,"Expected ';'."),e.condition=this._check(gt.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(gt.tokens.semicolon,"Expected ';'."),e.increment=this._check(gt.tokens.paren_right)?null:this._for_increment(),this._consume(gt.tokens.paren_right,"Expected ')'."),this._check(gt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(gt.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(gt.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new Dd(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(gt.keywords.let)){const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(gt.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new B1(r,n,null,null,i),e)}if(this._match(gt.keywords.const)){const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(gt.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Rl&&(n=i.type),this._updateNode(new Mw(r,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(gt.increment_operators))return this._current=e,null;const n=this._consume(gt.increment_operators,"Expected increment operator");return this._updateNode(new Uee(n.type===gt.tokens.plus_plus?Iv.increment:Iv.decrement,r))}_assignment_statement(){let e=null;const r=this._currentLine;if(this._check(gt.tokens.brace_right))return null;let n=this._match(gt.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(gt.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new Vee(d1.parse(i.lexeme),e,a),r)}_func_call_statement(){if(!this._check(gt.tokens.ident))return null;const e=this._currentLine,r=this._current,n=this._consume(gt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=r,null):this._updateNode(new qL(n.lexeme,i),e)}_loop_statement(){if(!this._match(gt.keywords.loop))return null;this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new $ee([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let n of r)e.body.push(n);else e.body.push(r);if(r instanceof KM){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(gt.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(gt.keywords.switch))return null;const e=this._updateNode(new qee(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(gt.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let r=!1;for(;this._check([gt.keywords.default,gt.keywords.case]);){if(this._match(gt.keywords.case)){const n=this._case_selectors();for(const a of n)if(a instanceof Ow){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(gt.tokens.colon),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(gt.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new ete(n,i)))}if(this._match(gt.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(gt.tokens.colon),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(gt.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new tte(n)))}}return e}_case_selectors(){const e=[];for(this._match(gt.keywords.default)?e.push(this._updateNode(new Ow)):e.push(this._shift_expression());this._match(gt.tokens.comma);)this._match(gt.keywords.default)?e.push(this._updateNode(new Ow)):e.push(this._shift_expression());return e}_case_body(){if(this._match(gt.keywords.fallthrough))return this._consume(gt.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(gt.keywords.if))return null;const e=this._currentLine,r=this._optional_paren_expression();this._check(gt.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(gt.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(gt.keywords.else)&&(this._check(gt.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new Hee(r,n,i,a),e)}_match_elseif(){return this._tokens[this._current].type===gt.keywords.else&&this._tokens[this._current+1].type===gt.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const r=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new YBe(r,n))),this._match_elseif()&&(this._check(gt.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(gt.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Wee(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(gt.tokens.or_or);)e=this._updateNode(new Zh(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(gt.tokens.and_and);)e=this._updateNode(new Zh(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(gt.tokens.or);)e=this._updateNode(new Zh(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(gt.tokens.xor);)e=this._updateNode(new Zh(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(gt.tokens.and);)e=this._updateNode(new Zh(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([gt.tokens.equal_equal,gt.tokens.not_equal])?this._updateNode(new Zh(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([gt.tokens.less_than,gt.tokens.greater_than,gt.tokens.less_than_equal,gt.tokens.greater_than_equal]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([gt.tokens.shift_left,gt.tokens.shift_right]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([gt.tokens.plus,gt.tokens.minus]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([gt.tokens.star,gt.tokens.forward_slash,gt.tokens.modulo]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([gt.tokens.minus,gt.tokens.bang,gt.tokens.tilde,gt.tokens.star,gt.tokens.and])?this._updateNode(new gl(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(gt.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(gt.tokens.bracket_right,"Expected ']'.");const r=this._updateNode(new y0(e)),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(gt.tokens.period)){const e=this._consume(gt.tokens.name,"Expected member name."),r=this._postfix_expression(),n=this._updateNode(new Rm(e.lexeme));return r&&(n.postfix=r),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return tn.void;case"bool":return tn.bool;case"i32":return tn.i32;case"u32":return tn.u32;case"f32":return tn.f32;case"f16":return tn.f16;case"vec2f":return pr.vec2f;case"vec3f":return pr.vec3f;case"vec4f":return pr.vec4f;case"vec2i":return pr.vec2i;case"vec3i":return pr.vec3i;case"vec4i":return pr.vec4i;case"vec2u":return pr.vec2u;case"vec3u":return pr.vec3u;case"vec4u":return pr.vec4u;case"vec2h":return pr.vec2h;case"vec3h":return pr.vec3h;case"vec4h":return pr.vec4h;case"mat2x2f":return pr.mat2x2f;case"mat2x3f":return pr.mat2x3f;case"mat2x4f":return pr.mat2x4f;case"mat3x2f":return pr.mat3x2f;case"mat3x3f":return pr.mat3x3f;case"mat3x4f":return pr.mat3x4f;case"mat4x2f":return pr.mat4x2f;case"mat4x3f":return pr.mat4x3f;case"mat4x4f":return pr.mat4x4f;case"mat2x2h":return pr.mat2x2h;case"mat2x3h":return pr.mat2x3h;case"mat2x4h":return pr.mat2x4h;case"mat3x2h":return pr.mat3x2h;case"mat3x3h":return pr.mat3x3h;case"mat3x4h":return pr.mat3x4h;case"mat4x2h":return pr.mat4x2h;case"mat4x3h":return pr.mat4x3h;case"mat4x4h":return pr.mat4x4h;case"mat2x2i":return pr.mat2x2i;case"mat2x3i":return pr.mat2x3i;case"mat2x4i":return pr.mat2x4i;case"mat3x2i":return pr.mat3x2i;case"mat3x3i":return pr.mat3x3i;case"mat3x4i":return pr.mat3x4i;case"mat4x2i":return pr.mat4x2i;case"mat4x3i":return pr.mat4x3i;case"mat4x4i":return pr.mat4x4i;case"mat2x2u":return pr.mat2x2u;case"mat2x3u":return pr.mat2x3u;case"mat2x4u":return pr.mat2x4u;case"mat3x2u":return pr.mat3x2u;case"mat3x3u":return pr.mat3x3u;case"mat3x4u":return pr.mat3x4u;case"mat4x2u":return pr.mat4x2u;case"mat4x3u":return pr.mat4x3u;case"mat4x4u":return pr.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(gt.tokens.ident)){const n=this._previous().toString();if(this._check(gt.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(n);return a!==null?this._updateNode(new zf(a,i)):this._updateNode(new WL(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new Zee(n,i.value))}return this._updateNode(new Yc(n))}if(this._match(gt.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?tn.i32:n.endsWith("u")||n.endsWith("U")?tn.u32:tn.x32;const a=parseInt(n);return this._validateTypeRange(a,i),this._updateNode(new Rl(new lr(a,this._exec.getTypeInfo(i)),i))}if(this._match(gt.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,tn.u32),this._updateNode(new Rl(new lr(n,this._exec.getTypeInfo(tn.u32)),tn.u32))}if(this._match([gt.tokens.decimal_float_literal,gt.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const a=parseFloat(n);this._validateTypeRange(a,i?tn.f16:tn.f32);const s=i?tn.f16:tn.f32;return this._updateNode(new Rl(new lr(a,this._exec.getTypeInfo(s)),s))}if(this._match([gt.keywords.true,gt.keywords.false])){let n=this._previous().toString()===gt.keywords.true.rule;return this._updateNode(new Rl(new lr(n?1:0,this._exec.getTypeInfo(tn.bool)),tn.bool))}if(this._check(gt.tokens.paren_left))return this._paren_expression();if(this._match(gt.keywords.bitcast)){this._consume(gt.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(gt.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new Kee(n,i))}const e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new zf(e,r))}_argument_expression_list(){if(!this._match(gt.tokens.paren_left))return null;const e=[];do{if(this._check(gt.tokens.paren_right))break;const r=this._short_circuit_or_expression();e.push(r)}while(this._match(gt.tokens.comma));return this._consume(gt.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(gt.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(gt.tokens.paren_right),e}_paren_expression(){this._consume(gt.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(gt.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(gt.keywords.struct))return null;const e=this._currentLine,r=this._consume(gt.tokens.ident,"Expected name for struct.").toString();this._consume(gt.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(gt.tokens.brace_right);){const s=this._attribute(),o=this._consume(gt.tokens.name,"Expected variable name.").toString();this._consume(gt.tokens.colon,"Expected ':' for struct member type.");const u=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=u),this._check(gt.tokens.brace_right)?this._match(gt.tokens.comma):this._consume(gt.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new jq(o,h,s)))}this._consume(gt.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new Rd(r,n,e,i),e);return this._context.structs.set(r,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(gt.tokens.equal)){const r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof Rl){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Rl&&(e.type=e.value.type.name==="x32"?tn.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(gt.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(gt.keywords.const))return null;const r=this._consume(gt.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(gt.tokens.colon)){const u=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=u)}let a=null;this._consume(gt.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let u=[tn.f32],h=s.constEvaluate(this._exec,u);h instanceof lr&&this._validateTypeRange(h.value,u[0]),u[0]instanceof pr&&u[0].format===null&&h.typeInfo instanceof Mm&&h.typeInfo.format!==null&&(h.typeInfo.format.name==="f16"?u[0].format=tn.f16:h.typeInfo.format.name==="f32"?u[0].format=tn.f32:h.typeInfo.format.name==="i32"?u[0].format=tn.i32:h.typeInfo.format.name==="u32"?u[0].format=tn.u32:h.typeInfo.format.name==="bool"?u[0].format=tn.bool:console.error(`TODO: impelement template format type ${h.typeInfo.format.name}`)),a=this._updateNode(new Rl(h,u[0])),this._exec.context.setVariable(r.toString(),h)}catch{a=s}if(i!==null&&a instanceof Rl){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof Rl&&(i=(e=a?.type)!==null&&e!==void 0?e:tn.f32,i===tn.x32&&(i=tn.i32));const o=this._updateNode(new Mw(r.toString(),i,"","",a),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(gt.keywords.let))return null;const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected variable name");let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let i=null;if(this._match(gt.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Rl){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Rl&&(n=i.type.name==="x32"?tn.i32:i.type);return i instanceof Rl&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new B1(r.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(gt.keywords.var))return null;const e=this._currentLine;let r="",n="";this._match(gt.tokens.less_than)&&(r=this._consume(gt.storage_class,"Expected storage_class.").toString(),this._match(gt.tokens.comma)&&(n=this._consume(gt.access_mode,"Expected access_mode.").toString()),this._consume(gt.tokens.greater_than,"Expected '>'."));const i=this._consume(gt.tokens.name,"Expected variable name");let a=null;if(this._match(gt.tokens.colon)){const s=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=s)}return this._updateNode(new Dd(i.toString(),a,r,n,null),e)}_override_decl(){if(!this._match(gt.keywords.override))return null;const e=this._consume(gt.tokens.name,"Expected variable name");let r=null;if(this._match(gt.tokens.colon)){const n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return this._updateNode(new $L(e.toString(),r,null))}_diagnostic(){this._consume(gt.tokens.paren_left,"Expected '('");const e=this._consume(gt.tokens.ident,"Expected severity control name.");this._consume(gt.tokens.comma,"Expected ','");let r=this._consume(gt.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(gt.tokens.period)&&(r+=`.${this._consume(gt.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(gt.tokens.paren_right,"Expected ')'"),this._updateNode(new Gee(e.toString(),r))}_enable_directive(){const e=this._consume(gt.tokens.ident,"identity expected.");return this._updateNode(new WBe(e.toString()))}_requires_directive(){const e=[this._consume(gt.tokens.ident,"identity expected.").toString()];for(;this._match(gt.tokens.comma);){const r=this._consume(gt.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new GBe(e))}_type_alias(){const e=this._consume(gt.tokens.ident,"identity expected.");this._consume(gt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const n=this._updateNode(new HL(e.toString(),r));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([gt.tokens.ident,...gt.texel_format,gt.keywords.bool,gt.keywords.f32,gt.keywords.i32,gt.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new Bq(n));return this._forwardTypeCount++,i}return this._updateNode(new tn(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(gt.template_types)){let n=this._advance().toString(),i=null,a=null;return this._match(gt.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(gt.tokens.comma)&&(a=this._consume(gt.access_mode,"Expected access_mode for pointer").toString()),this._consume(gt.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new pr(n,i,a))}if(this._match(gt.keywords.ptr)){let n=this._previous().toString();this._consume(gt.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(gt.storage_class,"Expected storage_class for pointer");this._consume(gt.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let s=null;return this._match(gt.tokens.comma)&&(s=this._consume(gt.access_mode,"Expected access_mode for pointer").toString()),this._consume(gt.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Rw(n,i.toString(),a,s))}const r=this._attribute();if(this._match(gt.keywords.array)){let n=null,i=-1;const a=this._previous();let s=null;if(this._match(gt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let u="";if(this._match(gt.tokens.comma)){s=this._shift_expression();try{u=s.constEvaluate(this._exec).toString(),s=null}catch{u="1"}}this._consume(gt.tokens.greater_than,"Expected '>' for array."),i=u?parseInt(u):0}const o=this._updateNode(new z1(a.toString(),r,n,i));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(gt.sampler_type))return this._updateNode(new p1(this._previous().toString(),null,null));if(this._match(gt.depth_texture_type))return this._updateNode(new p1(this._previous().toString(),null,null));if(this._match(gt.sampled_texture_type)||this._match(gt.multisampled_texture_type)){const e=this._previous();this._consume(gt.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(gt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new p1(e.toString(),r,null))}if(this._match(gt.storage_texture_type)){const e=this._previous();this._consume(gt.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(gt.texel_format,"Invalid texel format.").toString();this._consume(gt.tokens.comma,"Expected ',' after texel format.");const n=this._consume(gt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(gt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new p1(e.toString(),r,n))}return null}_attribute(){let e=[];for(;this._match(gt.tokens.attr);){const r=this._consume(gt.attribute_name,"Expected attribute name"),n=this._updateNode(new rte(r.toString(),null));if(this._match(gt.tokens.paren_left)){if(n.value=this._consume(gt.literal_or_ident,"Expected attribute value").toString(),this._check(gt.tokens.comma)){this._advance();do{const i=this._consume(gt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(gt.tokens.comma))}this._consume(gt.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}}class uze extends Wf{constructor(e){super(),e&&this.update(e)}update(e){const r=new lze().parse(e);this.updateAST(r)}}function cze(t){const e={attributes:[],bindings:[]};let r;try{r=hze(t)}catch(a){return yn.error(a.message)(),e}for(const a of r.uniforms){const s=[];for(const o of a.type?.members||[])s.push({name:o.name,type:$q(o.type)});e.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:s})}for(const a of r.textures)e.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of r.samplers)e.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let a=0;a<i;a++){const s=n.inputs[a];if(s.locationType==="location"){const o=$q(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:o})}}return e}function $q(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function hze(t){try{return new uze(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}const fze={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...fze}};const wh=globalThis.mathgl.config;function dze(t,{precision:e=wh.precision}={}){return t=pze(t),`${parseFloat(t.toPrecision(e))}`}function v0(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gf(t,e,r){return mze(t,n=>Math.max(e,Math.min(r,n)))}function _E(t,e,r){return v0(t)?t.map((n,i)=>_E(n,e[i],r)):r*e+(1-r)*t}function Ab(t,e,r){const n=wh.EPSILON;try{if(t===e)return!0;if(v0(t)&&v0(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ab(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=wh.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{wh.EPSILON=n}}function pze(t){return Math.round(t/wh.EPSILON)*wh.EPSILON}function gze(t){return t.clone?t.clone():new Array(t.length)}function mze(t,e,r){if(v0(t)){const n=t;r=r||gze(n);for(let i=0;i<r.length&&i<n.length;++i){const a=typeof t=="number"?t:t[i];r[i]=e(a,i,r)}return r}return e(t)}class nte extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+r];return this.check()}toArray(e=[],r=0){for(let n=0;n<this.ELEMENTS;++n)e[r+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:v0(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(wh)}formatString(e){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+dze(this[n],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!Ab(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,n){if(n===void 0)return this.lerp(this,e,r);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],s=typeof r=="number"?r:r[i];this[i]=a+n*(s-a)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),r[n]);return this.check()}add(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(wh.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),r);return this.check()}get elements(){return this}}function yze(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function Xc(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function HI(t,e,r=""){if(wh.debug&&!yze(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function qq(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class vze extends nte{get x(){return this[0]}set x(e){this[0]=Xc(e)}get y(){return this[1]}set y(e){this[1]=Xc(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];r+=i*i}return Xc(r)}dot(e){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*e[n];return Xc(r)}normalize(){const e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return qq(e>=0&&e<this.ELEMENTS,"index is out of range"),Xc(this[e])}setComponent(e,r){return qq(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}}const Nw=1e-6;let _0=typeof Float32Array<"u"?Float32Array:Array;function _ze(){const t=new _0(2);return _0!=Float32Array&&(t[0]=0,t[1]=0),t}function Hq(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function bze(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ite(t,e,r,n){const i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function xze(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(function(){const t=_ze();return function(e,r,n,i,a,s){let o,u;for(r||(r=2),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}})();function wze(t,e,r){const n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}function ate(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function Sze(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function Eze(){const t=new _0(3);return _0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Tze(t){const e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function Cze(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Aze(t){const e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function Ize(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Pze(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function kze(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],u=r[2];return t[0]=i*u-a*o,t[1]=a*s-n*u,t[2]=n*o-i*s,t}function Mze(t,e,r,n){const i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function ote(t,e,r){const n=e[0],i=e[1],a=e[2];let s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function Rze(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function Oze(t,e,r){const n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],h=e[2];let f=i*h-a*u,d=a*o-n*h,b=n*u-i*o,v=i*b-a*d,S=a*f-n*b,E=n*d-i*f;const P=s*2;return f*=P,d*=P,b*=P,v*=2,S*=2,E*=2,t[0]=o+f+v,t[1]=u+d+S,t[2]=h+b+E,t}function Nze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Lze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Dze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Fze(t,e){const r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+o*o)),h=u&&Pze(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}const ste=Cze,Bze=Tze,WI=Aze;(function(){const t=Eze();return function(e,r,n,i,a,s){let o,u;for(r||(r=3),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const GI=[0,0,0];let Z2;class id extends vze{static get ZERO(){return Z2||(Z2=new id(0,0,0),Object.freeze(Z2)),Z2}constructor(e=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&v0(e)?this.copy(e):(wh.debug&&(Xc(e),Xc(r),Xc(n)),this[0]=e,this[1]=r,this[2]=n)}set(e,r,n){return this[0]=e,this[1]=r,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return wh.debug&&(Xc(e.x),Xc(e.y),Xc(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Xc(e)}angle(e){return Fze(this,e)}cross(e){return kze(this,this,e),this.check()}rotateX({radians:e,origin:r=GI}){return Nze(this,this,r,e),this.check()}rotateY({radians:e,origin:r=GI}){return Lze(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=GI}){return Dze(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ote(this,this,e),this.check()}transformAsVector(e){return ate(this,this,e),this.check()}transformByMatrix3(e){return Rze(this,this,e),this.check()}transformByMatrix2(e){return Sze(this,this,e),this.check()}transformByQuaternion(e){return Oze(this,this,e),this.check()}}class zze extends nte{toString(){let e="[";if(wh.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,n){return this[r*this.RANK+e]=Xc(n),this}getColumn(e,r=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(e,r){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}}function jze(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Uze(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function QM(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],f=e[8],d=e[9],b=e[10],v=e[11],S=e[12],E=e[13],P=e[14],k=e[15],L=r*o-n*s,N=r*u-i*s,M=r*h-a*s,z=n*u-i*o,B=n*h-a*o,q=i*h-a*u,W=f*E-d*S,G=f*P-b*S,ie=f*k-v*S,J=d*P-b*E,H=d*k-v*E,ne=b*k-v*P;let ae=L*ne-N*H+M*J+z*ie-B*G+q*W;return ae?(ae=1/ae,t[0]=(o*ne-u*H+h*J)*ae,t[1]=(i*H-n*ne-a*J)*ae,t[2]=(E*q-P*B+k*z)*ae,t[3]=(b*B-d*q-v*z)*ae,t[4]=(u*ie-s*ne-h*G)*ae,t[5]=(r*ne-i*ie+a*G)*ae,t[6]=(P*M-S*q-k*N)*ae,t[7]=(f*q-b*M+v*N)*ae,t[8]=(s*H-o*ie+h*W)*ae,t[9]=(n*ie-r*H-a*W)*ae,t[10]=(S*B-E*M+k*L)*ae,t[11]=(d*M-f*B-v*L)*ae,t[12]=(o*G-s*J-u*W)*ae,t[13]=(r*J-n*G+i*W)*ae,t[14]=(E*N-S*z-P*L)*ae,t[15]=(f*z-d*N+b*L)*ae,t):null}function Vze(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8],f=t[9],d=t[10],b=t[11],v=t[12],S=t[13],E=t[14],P=t[15],k=e*s-r*a,L=e*o-n*a,N=r*o-n*s,M=h*S-f*v,z=h*E-d*v,B=f*E-d*S,q=e*B-r*z+n*M,W=a*B-s*z+o*M,G=h*N-f*L+d*k,ie=v*N-S*L+E*k;return u*q-i*W+P*G-b*ie}function hm(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],f=e[7],d=e[8],b=e[9],v=e[10],S=e[11],E=e[12],P=e[13],k=e[14],L=e[15];let N=r[0],M=r[1],z=r[2],B=r[3];return t[0]=N*n+M*o+z*d+B*E,t[1]=N*i+M*u+z*b+B*P,t[2]=N*a+M*h+z*v+B*k,t[3]=N*s+M*f+z*S+B*L,N=r[4],M=r[5],z=r[6],B=r[7],t[4]=N*n+M*o+z*d+B*E,t[5]=N*i+M*u+z*b+B*P,t[6]=N*a+M*h+z*v+B*k,t[7]=N*s+M*f+z*S+B*L,N=r[8],M=r[9],z=r[10],B=r[11],t[8]=N*n+M*o+z*d+B*E,t[9]=N*i+M*u+z*b+B*P,t[10]=N*a+M*h+z*v+B*k,t[11]=N*s+M*f+z*S+B*L,N=r[12],M=r[13],z=r[14],B=r[15],t[12]=N*n+M*o+z*d+B*E,t[13]=N*i+M*u+z*b+B*P,t[14]=N*a+M*h+z*v+B*k,t[15]=N*s+M*f+z*S+B*L,t}function bE(t,e,r){const n=r[0],i=r[1],a=r[2];let s,o,u,h,f,d,b,v,S,E,P,k;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],u=e[2],h=e[3],f=e[4],d=e[5],b=e[6],v=e[7],S=e[8],E=e[9],P=e[10],k=e[11],t[0]=s,t[1]=o,t[2]=u,t[3]=h,t[4]=f,t[5]=d,t[6]=b,t[7]=v,t[8]=S,t[9]=E,t[10]=P,t[11]=k,t[12]=s*n+f*i+S*a+e[12],t[13]=o*n+d*i+E*a+e[13],t[14]=u*n+b*i+P*a+e[14],t[15]=h*n+v*i+k*a+e[15]),t}function KL(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $ze(t,e,r,n){let i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),u,h,f,d,b,v,S,E,P,k,L,N,M,z,B,q,W,G,ie,J,H,ne,ae,ue;return o<Nw?null:(o=1/o,i*=o,a*=o,s*=o,h=Math.sin(r),u=Math.cos(r),f=1-u,d=e[0],b=e[1],v=e[2],S=e[3],E=e[4],P=e[5],k=e[6],L=e[7],N=e[8],M=e[9],z=e[10],B=e[11],q=i*i*f+u,W=a*i*f+s*h,G=s*i*f-a*h,ie=i*a*f-s*h,J=a*a*f+u,H=s*a*f+i*h,ne=i*s*f+a*h,ae=a*s*f-i*h,ue=s*s*f+u,t[0]=d*q+E*W+N*G,t[1]=b*q+P*W+M*G,t[2]=v*q+k*W+z*G,t[3]=S*q+L*W+B*G,t[4]=d*ie+E*J+N*H,t[5]=b*ie+P*J+M*H,t[6]=v*ie+k*J+z*H,t[7]=S*ie+L*J+B*H,t[8]=d*ne+E*ae+N*ue,t[9]=b*ne+P*ae+M*ue,t[10]=v*ne+k*ae+z*ue,t[11]=S*ne+L*ae+B*ue,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function lte(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],u=e[7],h=e[8],f=e[9],d=e[10],b=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+h*n,t[5]=s*i+f*n,t[6]=o*i+d*n,t[7]=u*i+b*n,t[8]=h*i-a*n,t[9]=f*i-s*n,t[10]=d*i-o*n,t[11]=b*i-u*n,t}function qze(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[8],f=e[9],d=e[10],b=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-h*n,t[1]=s*i-f*n,t[2]=o*i-d*n,t[3]=u*i-b*n,t[8]=a*n+h*i,t[9]=s*n+f*i,t[10]=o*n+d*i,t[11]=u*n+b*i,t}function ute(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[4],f=e[5],d=e[6],b=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+h*n,t[1]=s*i+f*n,t[2]=o*i+d*n,t[3]=u*i+b*n,t[4]=h*i-a*n,t[5]=f*i-s*n,t[6]=d*i-o*n,t[7]=b*i-u*n,t}function Hze(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,u=i+i,h=r*s,f=n*s,d=n*o,b=i*s,v=i*o,S=i*u,E=a*s,P=a*o,k=a*u;return t[0]=1-d-S,t[1]=f+k,t[2]=b-P,t[3]=0,t[4]=f-k,t[5]=1-h-S,t[6]=v+E,t[7]=0,t[8]=b+P,t[9]=v-E,t[10]=1-h-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Wze(t,e,r,n,i,a,s){const o=1/(r-e),u=1/(i-n),h=1/(a-s);return t[0]=a*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*u,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*h,t[15]=0,t}function Gze(t,e,r,n,i){const a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const s=1/(n-i);t[10]=(i+n)*s,t[14]=2*i*n*s}else t[10]=-1,t[14]=-2*n;return t}const Xze=Gze;function Yze(t,e,r,n,i,a,s){const o=1/(e-r),u=1/(n-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*u,t[14]=(s+a)*h,t[15]=1,t}const Zze=Yze;function Kze(t,e,r,n){let i,a,s,o,u,h,f,d,b,v;const S=e[0],E=e[1],P=e[2],k=n[0],L=n[1],N=n[2],M=r[0],z=r[1],B=r[2];return Math.abs(S-M)<Nw&&Math.abs(E-z)<Nw&&Math.abs(P-B)<Nw?jze(t):(d=S-M,b=E-z,v=P-B,i=1/Math.sqrt(d*d+b*b+v*v),d*=i,b*=i,v*=i,a=L*v-N*b,s=N*d-k*v,o=k*b-L*d,i=Math.sqrt(a*a+s*s+o*o),i?(i=1/i,a*=i,s*=i,o*=i):(a=0,s=0,o=0),u=b*o-v*s,h=v*a-d*o,f=d*s-b*a,i=Math.sqrt(u*u+h*h+f*f),i?(i=1/i,u*=i,h*=i,f*=i):(u=0,h=0,f=0),t[0]=a,t[1]=u,t[2]=d,t[3]=0,t[4]=s,t[5]=h,t[6]=b,t[7]=0,t[8]=o,t[9]=f,t[10]=v,t[11]=0,t[12]=-(a*S+s*E+o*P),t[13]=-(u*S+h*E+f*P),t[14]=-(d*S+b*E+v*P),t[15]=1,t)}function Jze(){const t=new _0(4);return _0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function cte(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function q0(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}(function(){const t=Jze();return function(e,r,n,i,a,s){let o,u;for(r||(r=4),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var eR;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(eR||(eR={}));const Qze=45*Math.PI/180,e9e=1,XI=.1,YI=500,t9e=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class hf extends zze{static get IDENTITY(){return n9e()}static get ZERO(){return r9e()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return eR}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,n,i,a,s,o,u,h,f,d,b,v,S,E,P){return this[0]=e,this[1]=r,this[2]=n,this[3]=i,this[4]=a,this[5]=s,this[6]=o,this[7]=u,this[8]=h,this[9]=f,this[10]=d,this[11]=b,this[12]=v,this[13]=S,this[14]=E,this[15]=P,this.check()}setRowMajor(e,r,n,i,a,s,o,u,h,f,d,b,v,S,E,P){return this[0]=e,this[1]=a,this[2]=h,this[3]=v,this[4]=r,this[5]=s,this[6]=f,this[7]=S,this[8]=n,this[9]=o,this[10]=d,this[11]=E,this[12]=i,this[13]=u,this[14]=b,this[15]=P,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(t9e)}fromObject(e){return this.check()}fromQuaternion(e){return Hze(this,e),this.check()}frustum(e){const{left:r,right:n,bottom:i,top:a,near:s=XI,far:o=YI}=e;return o===1/0?i9e(this,r,n,i,a,s):Wze(this,r,n,i,a,s,o),this.check()}lookAt(e){const{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=e;return Kze(this,r,n,i),this.check()}ortho(e){const{left:r,right:n,bottom:i,top:a,near:s=XI,far:o=YI}=e;return Zze(this,r,n,i,a,s,o),this.check()}orthographic(e){const{fovy:r=Qze,aspect:n=e9e,focalDistance:i=1,near:a=XI,far:s=YI}=e;Wq(r);const o=r/2,u=i*Math.tan(o),h=u*n;return this.ortho({left:-h,right:h,bottom:-u,top:u,near:a,far:s})}perspective(e){const{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:a=500}=e;return Wq(r),Xze(this,r,n,i,a),this.check()}determinant(){return Vze(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*s,e}transpose(){return Uze(this,this),this.check()}invert(){return QM(this,this),this.check()}multiplyLeft(e){return hm(this,e,this),this.check()}multiplyRight(e){return hm(this,this,e),this.check()}rotateX(e){return lte(this,this,e),this.check()}rotateY(e){return qze(this,this,e),this.check()}rotateZ(e){return ute(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return $ze(this,this,e,r),this.check()}scale(e){return KL(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return bE(this,this,e),this.check()}transform(e,r){return e.length===4?(r=q0(r||[-0,-0,-0,-0],e,this),HI(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){const{length:n}=e;let i;switch(n){case 2:i=xze(r||[-0,-0],e,this);break;case 3:i=ote(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return HI(i,e.length),i}transformAsVector(e,r){let n;switch(e.length){case 2:n=wze(r||[-0,-0],e,this);break;case 3:n=ate(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return HI(n,e.length),n}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,n){return this.identity().translate([e,r,n])}}let K2,J2;function r9e(){return K2||(K2=new hf([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(K2)),K2}function n9e(){return J2||(J2=new hf,Object.freeze(J2)),J2}function Wq(t){if(t>Math.PI*2)throw Error("expected radians")}function i9e(t,e,r,n,i,a){const s=2*a/(r-e),o=2*a/(i-n),u=(r+e)/(r-e),h=(i+n)/(i-n),f=-1,d=-1,b=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=d,t[12]=0,t[13]=0,t[14]=b,t[15]=0,t}function hte(t,e=[],r=0){const n=Math.fround(t),i=t-n;return e[r]=n,e[r+1]=i,e}function a9e(t){return t-Math.fround(t)}function o9e(t){const e=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){const i=r*4+n;hte(t[n*4+r],e,i*2)}return e}const s9e=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,l9e={name:"fp32",vs:s9e},u9e=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,c9e={ONE:1},h9e={name:"fp64arithmetic",vs:u9e,defaultUniforms:c9e,uniformTypes:{ONE:"f32"},fp64ify:hte,fp64LowPart:a9e,fp64ifyMatrix4:o9e},f9e=[0,1,1,1],d9e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,p9e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,Gq={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:f9e},vs:d9e,fs:p9e,getUniforms:g9e};function g9e(t={},e){const r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;const n=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(t.highlightColor){const n=Array.from(t.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}const Xq=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,m9e=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,fte=3,y9e=255;var Ib;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(Ib||(Ib={}));const j1={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:fte},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:Ib.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:m9e,vs:Xq,fs:Xq,getUniforms:v9e};function v9e(t,e={}){if(t=t&&{...t},!t)return{...j1.defaultUniforms};t.lights&&(t={...t,...b9e(t.lights),lights:void 0});const{ambientLight:r,pointLights:n,directionalLights:i}=t||{};if(!(r||n&&n.length>0||i&&i.length>0))return{...j1.defaultUniforms,enabled:0};const s={...j1.defaultUniforms,...e,..._9e({ambientLight:r,pointLights:n,directionalLights:i})};return t.enabled!==void 0&&(s.enabled=t.enabled?1:0),s}function _9e({ambientLight:t,pointLights:e=[],directionalLights:r=[]}){const n={};n.ambientLightColor=ZI(t);let i=0;for(const a of e){n.lightType=Ib.POINT;const s=i;n[`lightColor${s}`]=ZI(a),n[`lightPosition${s}`]=a.position,n[`lightAttenuation${s}`]=a.attenuation||[1,0,0],i++}for(const a of r){n.lightType=Ib.DIRECTIONAL;const s=i;n[`lightColor${s}`]=ZI(a),n[`lightDirection${s}`]=a.direction,i++}return i>fte&&yn.warn("MAX_LIGHTS exceeded")(),n.directionalLightCount=r.length,n.pointLightCount=e.length,n}function b9e(t){const e={pointLights:[],directionalLights:[]};for(const r of t||[])switch(r.type){case"ambient":e.ambientLight=r;break;case"directional":e.directionalLights?.push(r);break;case"point":e.pointLights?.push(r);break}return e}function ZI(t={}){const{color:e=[0,0,0],intensity:r=1}=t;return e.map(n=>n*r/y9e)}const dte=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,pte=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,gte=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,mte={props:{},name:"gouraudMaterial",vs:pte.replace("phongMaterial","gouraudMaterial"),fs:dte.replace("phongMaterial","gouraudMaterial"),source:gte.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[j1],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...mte.defaultUniforms,...e}}},yte={name:"phongMaterial",dependencies:[j1],source:gte,vs:dte,fs:pte,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...yte.defaultUniforms,...e}}},Yq=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,x9e={name:"layer",vs:Yq,fs:Yq,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},w9e=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,vte="#define SMOOTH_EDGE_RADIUS 0.5",S9e=`${vte}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,E9e=`${vte}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,_te={name:"geometry",source:w9e,vs:S9e,fs:E9e},T9e=25;var vl;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(vl||(vl={}));var Ol;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(Ol||(Ol={}));var qi;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(qi||(qi={}));const C9e="compute",A9e="auto",tR="manipulation",Lw="none",rR="pan-x",nR="pan-y";function I9e(t){if(t.includes(Lw))return Lw;const e=t.includes(rR),r=t.includes(nR);return e&&r?Lw:e||r?e?rR:nR:t.includes(tR)?tR:A9e}class P9e{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===C9e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return I9e(e.join(" "))}}function xE(t){return t.trim().split(/\s+/g)}function KI(t,e,r){if(t)for(const n of xE(e))t.addEventListener(n,r,!1)}function JI(t,e,r){if(t)for(const n of xE(e))t.removeEventListener(n,r,!1)}function Zq(t){return(t.ownerDocument||t).defaultView}function k9e(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function bte(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,n=0,i=0;for(;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:Math.round(r/e),y:Math.round(n/e)}}function Kq(t){const e=[];let r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:bte(e),deltaX:t.deltaX,deltaY:t.deltaY}}function xte(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function Jq(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)}function M9e(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)*180/Math.PI}function Qq(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.atan2(n,r)*180/Math.PI}function wte(t,e){return t===e?Ol.None:Math.abs(t)>=Math.abs(e)?t<0?Ol.Left:Ol.Right:e<0?Ol.Up:Ol.Down}function R9e(t,e){const r=e.center;let n=t.offsetDelta,i=t.prevDelta;const a=t.prevInput;return(e.eventType===vl.Start||a?.eventType===vl.End)&&(i=t.prevDelta={x:a?.deltaX||0,y:a?.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function Ste(t,e,r){return{x:e/t||0,y:r/t||0}}function O9e(t,e){return Jq(e[0],e[1])/Jq(t[0],t[1])}function N9e(t,e){return Qq(e[1],e[0])-Qq(t[1],t[0])}function L9e(t,e){const r=t.lastInterval||e,n=e.timeStamp-r.timeStamp;let i,a,s,o;if(e.eventType!==vl.Cancel&&(n>T9e||r.velocity===void 0)){const u=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,f=Ste(n,u,h);a=f.x,s=f.y,i=Math.abs(f.x)>Math.abs(f.y)?f.x:f.y,o=wte(u,h),t.lastInterval=e}else i=r.velocity,a=r.velocityX,s=r.velocityY,o=r.direction;e.velocity=i,e.velocityX=a,e.velocityY=s,e.direction=o}function D9e(t,e){const{session:r}=t,{pointers:n}=e,{length:i}=n;r.firstInput||(r.firstInput=Kq(e)),i>1&&!r.firstMultiple?r.firstMultiple=Kq(e):i===1&&(r.firstMultiple=!1);const{firstInput:a,firstMultiple:s}=r,o=s?s.center:a.center,u=e.center=bte(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=M9e(o,u),e.distance=xte(o,u);const{deltaX:h,deltaY:f}=R9e(r,e);e.deltaX=h,e.deltaY=f,e.offsetDirection=wte(e.deltaX,e.deltaY);const d=Ste(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,e.scale=s?O9e(s.pointers,n):1,e.rotation=s?N9e(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let b=t.element;return k9e(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b,L9e(r,e),e}function F9e(t,e,r){const n=r.pointers.length,i=r.changedPointers.length,a=e&vl.Start&&n-i===0,s=e&(vl.End|vl.Cancel)&&n-i===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e;const o=D9e(t,r);t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}let B9e=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){F9e(this.manager,e,r)}init(){KI(this.element,this.evEl,this.domHandler),KI(this.target,this.evTarget,this.domHandler),KI(Zq(this.element),this.evWin,this.domHandler)}destroy(){JI(this.element,this.evEl,this.domHandler),JI(this.target,this.evTarget,this.domHandler),JI(Zq(this.element),this.evWin,this.domHandler)}};const z9e={pointerdown:vl.Start,pointermove:vl.Move,pointerup:vl.End,pointercancel:vl.Cancel,pointerout:vl.Cancel},j9e="pointerdown",U9e="pointermove pointerup pointercancel";class V9e extends B9e{constructor(e){super(e),this.evEl=j9e,this.evWin=U9e,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:r}=this;let n=!1;const i=z9e[e.type],a=e.pointerType,s=a==="touch";let o=r.findIndex(u=>u.pointerId===e.pointerId);i&vl.Start&&(e.buttons||s)?o<0&&(r.push(e),o=r.length-1):i&(vl.End|vl.Cancel)&&(n=!0),!(o<0)&&(r[o]=e,this.callback(i,{pointers:r,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),n&&r.splice(o,1))}}const $9e=["","webkit","Moz","MS","ms","o"];function q9e(t,e){const r=e[0].toUpperCase()+e.slice(1);for(const n of $9e){const i=n?n+r:e;if(i in t)return i}}const H9e=1,eH=2,tH={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class W9e{constructor(e,r){this.options={...tH,...r,cssProps:{...tH.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new V9e(this),this.touchAction=new P9e(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?eH:H9e}recognize(e){const{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:a}=r;(!a||a&&a.state&qi.Recognized)&&(a=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==eH&&(!a||n===a||n.canRecognizeWith(a))?n.recognize(e):n.reset(),!a&&n.state&(qi.Began|qi.Changed|qi.Ended)&&(a=r.curRecognizer=n),s++}get(e){const{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===e)return r[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const r=typeof e=="string"?this.get(e):e;if(r){const{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;const{handlers:n}=this;for(const i of xE(e))n[i]=n[i]||[],n[i].push(r)}off(e,r){if(!e)return;const{handlers:n}=this;for(const i of xE(e))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(e,r){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=r;i.type=e,i.preventDefault=function(){r.srcEvent.preventDefault()};let a=0;for(;a<n.length;)n[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:r}=this;if(r){for(const[n,i]of Object.entries(this.options.cssProps)){const a=q9e(r.style,n);e?(this.oldCssProps[a]=r.style[a],r.style[a]=i):r.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let G9e=1;function X9e(){return G9e++}function rH(t){return t&qi.Cancelled?"cancel":t&qi.Ended?"end":t&qi.Changed?"move":t&qi.Began?"start":""}class Ete{constructor(e){this.options=e,this.id=X9e(),this.state=qi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){const n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:r}=this;r<qi.Ended&&this.manager.emit(this.options.event+rH(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=qi.Ended&&this.manager.emit(this.options.event+rH(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=qi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(qi.Failed|qi.Possible)))return!1;e++}return!0}recognize(e){const r={...e};if(!this.options.enable){this.reset(),this.state=qi.Failed;return}this.state&(qi.Recognized|qi.Cancelled|qi.Failed)&&(this.state=qi.Possible),this.state=this.process(r),this.state&(qi.Began|qi.Changed|qi.Ended|qi.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}}class Tte extends Ete{attrTest(e){const r=this.options.pointers;return r===0||e.pointers.length===r}process(e){const{state:r}=this,{eventType:n}=e,i=r&(qi.Began|qi.Changed),a=this.attrTest(e);return i&&(n&vl.Cancel||!a)?r|qi.Cancelled:i||a?n&vl.End?r|qi.Ended:r&qi.Began?r|qi.Changed:qi.Began:qi.Failed}}class nH extends Ete{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[tR]}process(e){const{options:r}=this,n=e.pointers.length===r.pointers,i=e.distance<r.threshold,a=e.deltaTime<r.time;if(this.reset(),e.eventType&vl.Start&&this.count===0)return this.failTimeout();if(i&&a&&n){if(e.eventType!==vl.End)return this.failTimeout();const s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,o=!this.pCenter||xte(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=qi.Recognized,this.tryEmit(this._input)},r.interval),qi.Began):qi.Recognized}return qi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=qi.Failed},this.options.interval),qi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===qi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const Y9e=["","start","move","end","cancel","up","down","left","right"];class iH extends Tte{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Ol.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,r=[];return e&Ol.Horizontal&&r.push(nR),e&Ol.Vertical&&r.push(rR),r}getEventNames(){return Y9e.map(e=>this.options.event+e)}directionTest(e){const{options:r}=this;let n=!0,{distance:i}=e,{direction:a}=e;const s=e.deltaX,o=e.deltaY;return a&r.direction||(r.direction&Ol.Horizontal?(a=s===0?Ol.None:s<0?Ol.Left:Ol.Right,n=s!==this.pX,i=Math.abs(e.deltaX)):(a=o===0?Ol.None:o<0?Ol.Up:Ol.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,n&&i>r.threshold&&!!(a&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&qi.Began)||!(this.state&qi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const r=Ol[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}}const Z9e=["","start","move","end","cancel","in","out"];class K9e extends Tte{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Lw]}getEventNames(){return Z9e.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&qi.Began))}emit(e){if(e.scale!==1){const r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}}class nC{constructor(e,r,n){this.element=e,this.callback=r,this.options=n}}const J9e=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Q9e=J9e.indexOf("firefox")!==-1,aH=4.000244140625,eje=40,tje=.25;class rje extends nC{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(Q9e&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=eje)),a!==0&&a%aH===0&&(a=Math.floor(a/aH)),i.shiftKey&&a&&(a=a*tje),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}}const oH=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class nje extends nC{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,oH.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){oH.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const sH=["keydown","keyup"];class ije extends nC{constructor(e,r,n){super(e,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",sH.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){sH.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}}class aje extends nC{constructor(e,r,n){super(e,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}}const lH=1,iR=2,uH=4,oje={pointerdown:lH,pointermove:iR,pointerup:uH,mousedown:lH,mousemove:iR,mouseup:uH},sje=0,lje=1,uje=2,cje=1,hje=2,fje=4;function dje(t){const e=oje[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n}=t.srcEvent;let i=!1,a=!1,s=!1;return e===iR?(i=!!(r&cje),a=!!(r&fje),s=!!(r&hje)):(i=n===sje,a=n===lje,s=n===uje),{leftButton:i,middleButton:a,rightButton:s}}function pje(t,e){const r=t.center;if(!r)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,a=n.height/e.offsetHeight||1,s={x:(r.x-n.left-e.clientLeft)/i,y:(r.y-n.top-e.clientTop)/a};return{center:r,offsetCenter:s}}const gje={srcElement:"root",priority:0};class mje{constructor(e,r){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let a=n.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,n,i=!1,a=!1){const{handlers:s,handlersByElement:o}=this,u={...gje,...n};let h=o.get(u.srcElement);h||(h=[],o.set(u.srcElement,h));const f={type:e,handler:r,srcElement:u.srcElement,priority:u.priority};i&&(f.once=!0),a&&(f.passive=!0),s.push(f),this._active=this._active||!f.passive;let d=h.length-1;for(;d>=0&&!(h[d].priority>=f.priority);)d--;h.splice(d+1,0,f)}remove(e,r){const{handlers:n,handlersByElement:i}=this;for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.type===e&&s.handler===r){n.splice(a,1);const o=i.get(s.srcElement);o.splice(o.indexOf(s),1),o.length===0&&i.delete(s.srcElement)}}this._active=n.some(a=>!a.passive)}_emit(e,r){const n=this.handlersByElement.get(r);if(n){let i=!1;const a=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},o=[];for(let u=0;u<n.length;u++){const{type:h,handler:f,once:d}=n[u];if(f({...e,type:h,stopPropagation:a,stopImmediatePropagation:s}),d&&o.push(n[u]),i)break}for(let u=0;u<o.length;u++){const{type:h,handler:f}=o[u];this.remove(h,f)}}}_normalizeEvent(e){const r=this.eventManager.getElement();return{...e,...dje(e),...pje(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}function yje(t){if("recognizer"in t)return t;let e;const r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){const n=r.shift(),i=r.shift()||{};e=new n(i)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}class vje{constructor(e=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new W9e(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:s}=yje(n);this.manager.add(i),a&&i.recognizeWith(a),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new rje(e,this._onOtherEvent,{enable:!1}),this.moveInput=new nje(e,this._onOtherEvent,{enable:!1}),this.keyInput=new ije(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new aje(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,n){this._addEventHandler(e,r,n,!1)}once(e,r,n){this._addEventHandler(e,r,n,!0)}watch(e,r,n){this._addEventHandler(e,r,n,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,n,i,a){if(typeof e!="string"){n=r;for(const[h,f]of Object.entries(e))this._addEventHandler(h,f,n,i,a);return}const{manager:s,events:o}=this;if(!s)return;let u=o.get(e);if(!u){const h=this._getRecognizerName(e)||e;u=new mje(this,h),o.set(e,u),s&&s.on(e,u.handleEvent)}u.add(e,r,n,i,a),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(const[a,s]of Object.entries(e))this._removeEventHandler(a,s);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,r),i.isEmpty())){const{recognizerName:a}=i;let s=!1;for(const o of n.values())if(o.recognizerName===a&&!o.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}}const Ua={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ua,"IDENTITY",{get:()=>(Xa.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Qc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},b0={common:0,meters:1,pixels:2},aR={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},cH={multipan:[iH,{threshold:10,direction:Ol.Vertical,pointers:2}],pinch:[K9e,{},null,["multipan"]],pan:[iH,{threshold:1},["pinch"],["multipan"]],dblclick:[nH,{event:"dblclick",taps:2}],click:[nH,{event:"click"},null,["dblclick"]]};function _je(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function _x(t){let e={},r;return n=>{for(const i in n)if(!_je(n[i],e[i])){r=t(n),e=n;break}return r}}const hH=[0,0,0,0],bje=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Cte=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],xje=[0,0,0],Ate=[0,0,0],wje=_x(Tje);function Ite(t,e,r=Ate){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,a=!0;switch(e===Ua.LNGLAT_OFFSETS||e===Ua.METER_OFFSETS?i=r:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Qc.WEB_MERCATOR:(e===Ua.LNGLAT||e===Ua.CARTESIAN)&&(i=[0,0,0],a=!1);break;case Qc.WEB_MERCATOR_AUTO_OFFSET:e===Ua.LNGLAT?n=i:e===Ua.CARTESIAN&&(n=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case Qc.IDENTITY:n=t.position.map(Math.fround),n[2]=n[2]||0;break;case Qc.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function Sje(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:s}=t,o=hH,u=hH,h=t.cameraPosition;const{geospatialOrigin:f,shaderCoordinateOrigin:d,offsetMode:b}=Ite(t,e,r);return b&&(u=t.projectPosition(f||d),h=[h[0]-u[0],h[1]-u[1],h[2]-u[2]],u[3]=1,o=q0([],u,s),a=n||a,s=hm([],i,a),s=hm([],s,bje)),{viewMatrix:a,viewProjectionMatrix:s,projectionCenter:o,originCommon:u,cameraPosCommon:h,shaderCoordinateOrigin:d,geospatialOrigin:f}}function Eje({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=Ua.DEFAULT,coordinateOrigin:i=Ate,autoWrapLongitude:a=!1}){n===Ua.DEFAULT&&(n=t.isGeospatial?Ua.LNGLAT:Ua.CARTESIAN);const s=wje({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=a,s.modelMatrix=r||Cte,s}function Tje({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:o,shaderCoordinateOrigin:u,geospatialOrigin:h}=Sje(t,r,n),f=t.getDistanceScales(),d=[t.width*e,t.height*e],b=q0([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,v={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:u,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:d,devicePixelRatio:e,focalDistance:b,commonUnitsPerMeter:f.unitsPerMeter,commonUnitsPerWorldUnit:f.unitsPerMeter,commonUnitsPerWorldUnit2:xje,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:Cte,cameraPosition:o};if(h){const S=t.getDistanceScales(h);switch(r){case Ua.METER_OFFSETS:v.commonUnitsPerWorldUnit=S.unitsPerMeter,v.commonUnitsPerWorldUnit2=S.unitsPerMeter2;break;case Ua.LNGLAT:case Ua.LNGLAT_OFFSETS:t._pseudoMeters||(v.commonUnitsPerMeter=S.unitsPerMeter),v.commonUnitsPerWorldUnit=S.unitsPerDegree,v.commonUnitsPerWorldUnit2=S.unitsPerDegree2;break;case Ua.CARTESIAN:v.commonUnitsPerWorldUnit=[1,1,S.unitsPerMeter[2]],v.commonUnitsPerWorldUnit2=[0,0,S.unitsPerMeter2[2]];break}}return v}const Cje=Object.keys(Ua).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Ua[t]};`).join(""),Aje=Object.keys(Qc).map(t=>`const PROJECTION_MODE_${t}: i32 = ${Qc[t]};`).join(""),Ije=Object.keys(b0).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${b0[t]};`).join(""),Pje=`${Cje}
${Aje}
${Ije}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,kje=`${Pje}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the z‑axis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,Mje=Object.keys(Ua).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Ua[t]};`).join(""),Rje=Object.keys(Qc).map(t=>`const int PROJECTION_MODE_${t} = ${Qc[t]};`).join(""),Oje=Object.keys(b0).map(t=>`const int UNIT_${t.toUpperCase()} = ${b0[t]};`).join(""),Nje=`${Mje}
${Rje}
${Oje}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,Lje={};function Dje(t=Lje){return"viewport"in t?Eje(t):{}}const JL={name:"project",dependencies:[l9e,_te],source:kje,vs:Nje,getUniforms:Dje,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},Fje=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,Bje=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Pte={name:"project32",dependencies:[JL],source:Fje,vs:Bje};function zje(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Wv(t,e){const r=q0([],e,t);return cte(r,r,1/r[3]),r}function fH(t,e){const r=t%e;return r<0?e+r:r}function oR(t,e,r){return t<e?e:t>r?r:t}function jje(t){return Math.log(t)*Math.LOG2E}const QL=Math.log2||jje;function tp(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const rf=Math.PI,kte=rf/4,Sh=rf/180,sR=180/rf,x0=512,wE=4003e4,Up=85.051129,Uje=1.5;function Vje(t){return QL(t)}function Pb(t){const[e,r]=t;tp(Number.isFinite(e)),tp(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=e*Sh,i=r*Sh,a=x0*(n+rf)/(2*rf),s=x0*(rf+Math.log(Math.tan(kte+i*.5)))/(2*rf);return[a,s]}function w0(t){const[e,r]=t,n=e/x0*(2*rf)-rf,i=2*(Math.atan(Math.exp(r/x0*(2*rf)-rf))-kte);return[n*sR,i*sR]}function $je(t){const{latitude:e}=t;tp(Number.isFinite(e));const r=Math.cos(e*Sh);return Vje(wE*r)-9}function Dw(t){const e=Math.cos(t*Sh);return x0/wE/e}function lR(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;tp(Number.isFinite(e)&&Number.isFinite(r));const i=x0,a=Math.cos(e*Sh),s=i/360,o=s/a,u=i/wE/a,h={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[s,o,u],degreesPerUnit:[1/s,1/o,1/u]};if(n){const f=Sh*Math.tan(e*Sh)/a,d=s*f/2,b=i/wE*f,v=b/o*u;h.unitsPerDegree2=[0,d,b],h.unitsPerMeter2=[v,0,v]}return h}function Mte(t,e){const[r,n,i]=t,[a,s,o]=e,{unitsPerMeter:u,unitsPerMeter2:h}=lR({longitude:r,latitude:n,highPrecision:!0}),f=Pb(t);f[0]+=a*(u[0]+h[0]*s),f[1]+=s*(u[1]+h[1]*s);const d=w0(f),b=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[d[0],d[1],b]:d}function qje(t){const{height:e,pitch:r,bearing:n,altitude:i,scale:a,center:s}=t,o=zje();bE(o,o,[0,0,-i]),lte(o,o,-r*Sh),ute(o,o,n*Sh);const u=a/e;return KL(o,o,[u,u,u]),s&&bE(o,o,Ize([],s)),o}function Hje(t){const{width:e,height:r,altitude:n,pitch:i=0,offset:a,center:s,scale:o,nearZMultiplier:u=1,farZMultiplier:h=1}=t;let{fovy:f=kb(Uje)}=t;n!==void 0&&(f=kb(n));const d=f*Sh,b=i*Sh,v=eD(f);let S=v;s&&(S+=s[2]*o/Math.cos(b)/r);const E=d*(.5+(a?a[1]:0)/r),P=Math.sin(E)*S/Math.sin(oR(Math.PI/2-b-E,.01,Math.PI-.01)),k=Math.sin(b)*P+S,L=S*10,N=Math.min(k*h,L);return{fov:d,aspect:e/r,focalDistance:v,near:u,far:N}}function kb(t){return 2*Math.atan(.5/t)*sR}function eD(t){return .5/Math.tan(.5*t*Sh)}function Rte(t,e){const[r,n,i=0]=t;return tp(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),Wv(e,[r,n,i,1])}function tD(t,e,r=0){const[n,i,a]=t;if(tp(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return Wv(e,[n,i,a,1]);const s=Wv(e,[n,i,0,1]),o=Wv(e,[n,i,1,1]),u=s[2],h=o[2],f=u===h?0:((r||0)-u)/(h-u);return ite([],s,o,f)}function Wje(t){const{width:e,height:r,bounds:n,minExtent:i=0,maxZoom:a=24,offset:s=[0,0]}=t,[[o,u],[h,f]]=n,d=Gje(t.padding),b=Pb([o,oR(f,-Up,Up)]),v=Pb([h,oR(u,-Up,Up)]),S=[Math.max(Math.abs(v[0]-b[0]),i),Math.max(Math.abs(v[1]-b[1]),i)],E=[e-d.left-d.right-Math.abs(s[0])*2,r-d.top-d.bottom-Math.abs(s[1])*2];tp(E[0]>0&&E[1]>0);const P=E[0]/S[0],k=E[1]/S[1],L=(d.right-d.left)/2/P,N=(d.top-d.bottom)/2/k,M=[(v[0]+b[0])/2+L,(v[1]+b[1])/2+N],z=w0(M),B=Math.min(a,QL(Math.abs(Math.min(P,k))));return tp(Number.isFinite(B)),{longitude:z[0],latitude:z[1],zoom:B}}function Gje(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(tp(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const dH=Math.PI/180;function Xje(t,e=0){const{width:r,height:n,unproject:i}=t,a={targetZ:e},s=i([0,n],a),o=i([r,n],a);let u,h;const f=t.fovy?.5*t.fovy*dH:Math.atan(.5/t.altitude),d=(90-t.pitch)*dH;return f>d-.01?(u=pH(t,0,e),h=pH(t,r,e)):(u=i([0,0],a),h=i([r,0],a)),[s,o,h,u]}function pH(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=Wv(n,[e,0,1,1]),a=Wv(n,[e,t.height,1,1]),o=(r*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),u=ite([],i,a,o),h=w0(u);return h.push(r),h}const gH=512;function Yje(t){const{width:e,height:r,pitch:n=0}=t;let{longitude:i,latitude:a,zoom:s,bearing:o=0}=t;(i<-180||i>180)&&(i=fH(i+180,360)-180),(o<-180||o>180)&&(o=fH(o+180,360)-180);const u=QL(r/gH);if(s<=u)s=u,a=0;else{const h=r/2/Math.pow(2,s),f=w0([0,h])[1];if(a<f)a=f;else{const d=w0([0,gH-h])[1];a>d&&(a=d)}}return{width:e,height:r,longitude:i,latitude:a,zoom:s,pitch:n,bearing:o}}const Ote=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,Zje=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Kje=`
${Ote}
${Zje}
`,Jje=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Qje=`
${Ote}
${Jje}
`,e7e=_x(a7e),t7e=_x(o7e),r7e=[0,0,0,1],n7e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function i7e(t,e){const[r,n,i]=t,a=tD([r,n,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function a7e({viewport:t,center:e}){return new hf(t.viewProjectionMatrix).invert().transform(e)}function o7e({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>i7e(s,n));for(const s of e){const o=s.clone().translate(new id(t.center).negate()),u=a.map(f=>o.transform(f)),h=new hf().ortho({left:Math.min(...u.map(f=>f[0])),right:Math.max(...u.map(f=>f[0])),bottom:Math.min(...u.map(f=>f[1])),top:Math.max(...u.map(f=>f[1])),near:Math.min(...u.map(f=>-f[2])),far:Math.max(...u.map(f=>-f[2]))});r.push(h.multiplyRight(s))}return r}function s7e(t){const{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const n=JL.getUniforms(r),i=e7e({viewport:r.viewport,center:n.center}),a=[],s=t7e({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let u=0;u<t.shadowMatrices.length;u++){const h=s[u],f=h.clone().translate(new id(r.viewport.center).negate());n.coordinateSystem===Ua.LNGLAT&&n.projectionMode===Qc.WEB_MERCATOR?(s[u]=f,a[u]=i):(s[u]=h.clone().multiplyRight(n7e),a[u]=f.transform(i))}const o={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||r7e,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let u=0;u<s.length;u++)o[`viewProjectionMatrix${u}`]=s[u],o[`projectCenter${u}`]=a[u];for(let u=0;u<2;u++)o[`shadow_uShadowMap${u}`]=t.shadowMaps&&t.shadowMaps[u]||t.dummyShadowMap;return o}const mH={name:"shadow",dependencies:[JL],vs:Kje,fs:Qje,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:s7e,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},l7e={...Gq,defaultUniforms:{...Gq.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},u7e=[_te],c7e=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],h7e=[];function f7e(t){const e=Qg.getDefaultShaderAssembler();for(const n of u7e)e.addDefaultModule(n);const r=t==="glsl"?c7e:h7e;for(const n of r)e.addShaderHook(n);return e}const d7e=[255,255,255],p7e=1;let g7e=0;class m7e{constructor(e={}){this.type="ambient";const{color:r=d7e}=e,{intensity:n=p7e}=e;this.id=e.id||`ambient-${g7e++}`,this.color=r,this.intensity=n}}const y7e=[255,255,255],v7e=1,_7e=[0,0,-1];let b7e=0;class yH{constructor(e={}){this.type="directional";const{color:r=y7e}=e,{intensity:n=v7e}=e,{direction:i=_7e}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${b7e++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new id(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class x7e{constructor(e,r={id:"pass"}){const{id:n}=r;this.id=n,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class rD extends x7e{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,o=i?0:!1,u=e.colorMask??15,h={viewport:[0,0,r,n]};e.colorMask&&(h.colorMask=u),e.scissorRect&&(h.scissorRect=e.scissorRect);const f=this.device.beginRenderPass({framebuffer:e.target,parameters:h,clearColor:a,clearDepth:s,clearStencil:o});try{return this._drawLayers(f,e)}finally{f.end(),this.device.submit()}}_drawLayers(e,r){const{target:n,shaderModuleProps:i,viewports:a,views:s,onViewportActive:o,clearStack:u=!0}=r;r.pass=r.pass||"unknown",u&&(this._lastRenderIndex=-1);const h=[];for(const f of a){const d=s&&s[f.id];o?.(f);const b=this._getDrawLayerParams(f,r),v=f.subViewports||[f];for(const S of v){const E=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:S,view:d,pass:r.pass,layers:r.layers},b);h.push(E)}}return h}_getDrawLayerParams(e,{layers:r,pass:n,isPicking:i=!1,layerFilter:a,cullRect:s,effects:o,shaderModuleProps:u},h=!1){const f=[],d=Nte(this._lastRenderIndex+1),b={layer:r[0],viewport:e,isPicking:i,renderPass:n,cullRect:s},v={};for(let S=0;S<r.length;S++){const E=r[S],P=this._shouldDrawLayer(E,b,a,v),k={shouldDrawLayer:P};P&&!h&&(k.shouldDrawLayer=!0,k.layerRenderIndex=d(E,P),k.shaderModuleProps=this._getShaderModuleProps(E,o,n,u),k.layerParameters={...E.context.deck?.props.parameters,...this.getLayerParameters(E,S,e)}),f[S]=k}return f}_drawLayersInViewport(e,{layers:r,shaderModuleProps:n,pass:i,target:a,viewport:s,view:o},u){const h=w7e(this.device,{shaderModuleProps:n,target:a,viewport:s});if(o&&o.props.clear){const d=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;this.device.beginRenderPass({framebuffer:a,parameters:{viewport:h,scissorRect:h},clearColor:d.color?[0,0,0,0]:!1,clearDepth:d.depth?1:!1}).end()}const f={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:h});for(let d=0;d<r.length;d++){const b=r[d],v=u[d],{shouldDrawLayer:S}=v;if(S&&b.props.pickable&&f.pickableCount++,b.isComposite&&f.compositeCount++,b.isDrawable&&v.shouldDrawLayer){const{layerRenderIndex:E,shaderModuleProps:P,layerParameters:k}=v;f.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),P.project&&(P.project.viewport=s),b.context.renderPass=e;try{b._drawLayer({renderPass:e,shaderModuleProps:P,uniforms:{layerIndex:E},parameters:k})}catch(L){b.raiseError(L,`drawing ${b} to ${i}`)}}}return f}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,n){return null}getLayerParameters(e,r,n){return e.props.parameters}_shouldDrawLayer(e,r,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){const o=r.layer.id;if(o in i||(i[o]=n(r)),!i[o])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,n,i){const a=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(const u of r)vH(o,u.getShaderModuleProps?.(e,o));return vH(o,this.getShaderModuleProps(e,r,o),i)}}function Nte(t=0,e={}){const r={},n=(i,a)=>{const s=i.props._offset,o=i.id,u=i.parent&&i.parent.id;let h;if(u&&!(u in e)&&n(i.parent,!1),u in r){const f=r[u]=r[u]||Nte(e[u],e);h=f(i,a),r[o]=f}else Number.isFinite(s)?(h=s+(e[u]||0),r[o]=null):h=t;return a&&h>=t&&(t=h+1),e[o]=h,h};return n}function w7e(t,{shaderModuleProps:e,target:r,viewport:n}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,a]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:a,o=n;return[o.x*i,s-(o.y+o.height)*i,o.width*i,o.height*i]}function vH(t,...e){for(const r of e)if(r)for(const n in r)t[n]?Object.assign(t[n],r[n]):t[n]=r[n];return t}class S7e extends rD{constructor(e,r){super(e,r);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*n,s=i.height*n,o=[1,1,1,1];(a!==r.width||s!==r.height)&&r.resize({width:a,height:s}),super.render({...e,clearColor:o,target:r,pass:"shadow"})}getLayerParameters(e,r,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const E7e={color:[255,255,255],intensity:1},_H=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],T7e=[0,0,0,200/255];class Lte{constructor(e={}){this.id="lighting-effect",this.shadowColor=T7e,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:r,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(mH),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const r in e){const n=e[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){const n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:n,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(mH))}_calculateMatrices(){const e=[];for(const r of this.directionalLights){const n=new hf().lookAt({eye:new id(r.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){const n=new S7e(e);this.shadowPasses[r]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:r,directionalLights:n}=this;!e&&r.length===0&&n.length===0&&(this.ambientLight=new m7e(E7e),this.directionalLights.push(new yH(_H[0]),new yH(_H[1])))}}class C7e{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:n=1,type:i,padding:a=0,copy:s=!1,initialize:o=!1,maxCount:u}){const h=i||e&&e.constructor||Float32Array,f=r*n+a;if(ArrayBuffer.isView(e)){if(f<=e.length)return e;if(f*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new h(e.buffer,0,f)}let d=1/0;u&&(d=u*n+a);const b=this._allocate(h,f,o,d);return e&&s?b.set(e):o||b.fill(0,0,4),this._release(e),b}release(e){this._release(e)}_allocate(e,r,n,i){let a=Math.max(Math.ceil(r*this.opts.overAlloc),1);a>i&&(a=i);const s=this._pool,o=e.BYTES_PER_ELEMENT*a,u=s.findIndex(h=>h.byteLength>=o);if(u>=0){const h=new e(s.splice(u,1)[0],0,a);return n&&h.fill(0),h}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const r=this._pool,{buffer:n}=e,{byteLength:i}=n,a=r.findIndex(s=>s.byteLength>=i);a<0?r.push(n):(a>0||r.length<this.opts.poolSize)&&r.splice(a,0,n),r.length>this.opts.poolSize&&r.shift()}}const Mb=new C7e;function g1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function A7e(t,e){const r=t%e;return r<0?e+r:r}function I7e(t){return[t[12],t[13],t[14]]}function P7e(t){return{left:qy(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:qy(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:qy(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:qy(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:qy(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:qy(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const bH=new id;function qy(t,e,r,n){bH.set(t,e,r);const i=bH.len();return{distance:n/i,normal:new id(-t/i,-e/i,-r/i)}}function k7e(t){return t-Math.fround(t)}let U_;function QI(t,e){const{size:r=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-n)/r;U_=Mb.allocate(U_,a,{type:Float32Array,size:r*2});let s=n,o=0;for(;s<i;){for(let u=0;u<r;u++){const h=t[s++];U_[o+u]=h,U_[o+u+r]=k7e(h)}o+=r*2}return U_.subarray(0,a*r*2)}function M7e(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const R7e=Math.PI/180,O7e=g1(),xH=[0,0,0],N7e={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function L7e({width:t,height:e,orthographic:r,fovyRadians:n,focalDistance:i,padding:a,near:s,far:o}){const u=t/e,h=r?new hf().orthographic({fovy:n,aspect:u,focalDistance:i,near:s,far:o}):new hf().perspective({fovy:n,aspect:u,near:s,far:o});if(a){const{left:f=0,right:d=0,top:b=0,bottom:v=0}=a,S=Gf((f+t-d)/2,0,t)-t/2,E=Gf((b+e-v)/2,0,e)-e/2;h[8]-=S*2/t,h[9]+=E*2/e}return h}class Qm{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||N7e,this.focalDistance=e.focalDistance||1,this.position=e.position||xH,this.modelMatrix=e.modelMatrix||null;const{longitude:r,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Qc.WEB_MERCATOR:Qc.WEB_MERCATOR_AUTO_OFFSET:Qc.IDENTITY}equals(e){return e instanceof Qm?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ab(e.projectionMatrix,this.projectionMatrix)&&Ab(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){const n=this.projectPosition(e),i=Rte(n,this.pixelProjectionMatrix),[a,s]=i,o=r?s:this.height-s;return e.length===2?[a,o]:[a,o,i[2]]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,u=n&&n*this.distanceScales.unitsPerMeter[2],h=tD([i,o,s],this.pixelUnprojectionMatrix,u),[f,d,b]=this.unprojectPosition(h);return Number.isFinite(s)?[f,d,b]:Number.isFinite(n)?[f,d,n]:[f,d]}projectPosition(e){const[r,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(e){const[r,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(e){if(this.isGeospatial){const r=Pb(e);return r[1]=Gf(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?w0(e):e}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),a=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],a[0],s[0]),Math.min(n[1],i[1],a[1],s[1]),Math.max(n[0],i[0],a[0],s[0]),Math.max(n[1],i[1],a[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?lR({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,P7e(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r){return null}_initProps(e){const r=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=$je({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||lR({latitude:n,longitude:r}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:s}=e;let o=xH;if(a&&(o=s?new hf(s).transformAsVector(a,[]):a),this.isGeospatial){const u=this.projectPosition([r,n,0]);this.center=new id(o).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:r=O7e,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:a,fovy:s=75,near:o=.1,far:u=1e3,padding:h=null,focalDistance:f=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new hf().multiplyRight(r).translate(new id(this.center).negate()),this.projectionMatrix=n||L7e({width:this.width,height:this.height,orthographic:i,fovyRadians:a||s*R7e,focalDistance:f,padding:h,near:o,far:u});const d=g1();hm(d,d,this.projectionMatrix),hm(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=QM([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=I7e(this.viewMatrixInverse);const b=g1(),v=g1();KL(b,b,[this.width/2,-this.height/2,1]),bE(b,b,[1,-1,0]),hm(v,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=v,this.pixelUnprojectionMatrix=QM(g1(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Xa.warn("Pixel project matrix not invertible")()}}Qm.displayName="Viewport";class Om extends Qm{constructor(e={}){const{latitude:r=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:u=1.01,nearZ:h,farZ:f,orthographic:d=!1,projectionMatrix:b,repeat:v=!1,worldOffset:S=0,position:E,padding:P,legacyMeterSizes:k=!1}=e;let{width:L,height:N,altitude:M=1.5}=e;const z=Math.pow(2,i);L=L||1,N=N||1;let B,q=null;if(b)M=b[5]/2,B=kb(M);else{e.fovy?(B=e.fovy,M=eD(B)):B=kb(M);let G;if(P){const{top:ie=0,bottom:J=0}=P;G=[0,Gf((ie+N-J)/2,0,N)-N/2]}q=Hje({width:L,height:N,scale:z,center:E&&[0,0,E[2]*Dw(r)],offset:G,pitch:a,fovy:B,nearZMultiplier:o,farZMultiplier:u}),Number.isFinite(h)&&(q.near=h),Number.isFinite(f)&&(q.far=f)}let W=qje({height:N,pitch:a,bearing:s,scale:z,altitude:M});S&&(W=new hf().translate([512*S,0,0]).multiplyLeft(W)),super({...e,width:L,height:N,viewMatrix:W,longitude:n,latitude:r,zoom:i,...q,fovy:B,focalDistance:M}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=s,this.altitude=M,this.fovy=B,this.orthographic=d,this._subViewports=v?[]:null,this._pseudoMeters=k,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),r=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=r;i<=n;i++){const a=i?new Om({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[r,n]=this.projectFlat(e),i=(e[2]||0)*Dw(e[1]);return[r,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[r,n]=this.unprojectFlat(e),i=(e[2]||0)/Dw(n);return[r,n,i]}addMetersToLngLat(e,r){return Mte(e,r)}panByPosition(e,r){const n=tD(r,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=Hq([],i,bze([],n)),s=Hq([],this.center,a),[o,u]=this.unprojectFlat(s);return{longitude:o,latitude:u}}getBounds(e={}){const r=Xje(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){const{width:n,height:i}=this,{longitude:a,latitude:s,zoom:o}=Wje({width:n,height:i,bounds:e,...r});return new Om({width:n,height:i,longitude:a,latitude:s,zoom:o})}}Om.displayName="WebMercatorViewport";const wH=[0,0,0];function eP(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof Om){const[i,a,s=0]=t,o=e.getDistanceScales([i,a]);n[2]=s*o.unitsPerMeter[2]}return n}function D7e(t){const{viewport:e,modelMatrix:r,coordinateOrigin:n}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return i===Ua.DEFAULT&&(i=e.isGeospatial?Ua.LNGLAT:Ua.CARTESIAN),a===void 0&&(a=i),s===void 0&&(s=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function Dte(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:a}){let[s,o,u=0]=t;switch(r&&([s,o,u]=q0([],[s,o,u,1],r)),n){case Ua.LNGLAT:return eP([s,o,u],e,a);case Ua.LNGLAT_OFFSETS:return eP([s+i[0],o+i[1],u+(i[2]||0)],e,a);case Ua.METER_OFFSETS:return eP(Mte(i,[s,o,u]),e,a);case Ua.CARTESIAN:default:return e.isGeospatial?[s+i[0],o+i[1],u+i[2]]:e.projectPosition([s,o,u])}}function F7e(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:s,fromCoordinateOrigin:o}=D7e(e),{autoOffset:u=!0}=e,{geospatialOrigin:h=wH,shaderCoordinateOrigin:f=wH,offsetMode:d=!1}=u?Ite(r,n,i):{},b=Dte(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:o,offsetMode:d});if(d){const v=r.projectPosition(h||f);ste(b,b,v)}return b}let B7e=1,z7e=1;class Fte{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,s=B7e++,o={time:0,delay:r,duration:n,rate:i,repeat:a};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[r,n]of this.animations)n.channel===e&&this.detachAnimation(r)}isFinished(e){const r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;const r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);const r=this.channels.values();for(const i of r)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:a,channel:s}=i;a.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){const n=z7e++;return this.animations.set(n,{animation:e,channel:r}),e.setTime(this.getTime(r)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){const n=r-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function j7e(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function U7e(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let V7e=0;const $7e={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:YM.stats.get(`animation-loop-${V7e++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class q7e{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...$7e,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:r=!0}=this.props;this.stats=e.stats||new KT({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){if(this.props.onError(e),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){const n=document.createElement("h1");n.innerHTML=e.message,n.style.position="absolute",n.style.top="20%",n.style.left="10px",n.style.color="black",n.style.backgroundColor="red",document.body.appendChild(n)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=j7e(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(U7e(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:r,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);const n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,r]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&r>0&&(n=e/r),{width:e,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const tP={};function iC(t="id"){tP[t]=tP[t]||1;const e=tP[t]++;return`${t}-${e}`}class SH{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||iC("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Fo.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function H7e(t,e){if(e instanceof SH)return e;const r=W7e(t,e),{attributes:n,bufferLayout:i}=G7e(t,e);return new SH({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:r,attributes:n})}function W7e(t,e){if(!e.indices)return;const r=e.indices.value;return t.createBuffer({usage:Fo.INDEX,data:r})}function G7e(t,e){const r=[],n={};for(const[a,s]of Object.entries(e.attributes)){let o=a;switch(a){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(s){n[o]=t.createBuffer({data:s.value,id:`${a}-buffer`});const{value:u,size:h,normalized:f}=s;r.push({name:o,format:OBe(u,h,f)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}class nD{static defaultProps={...m0.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new nD(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const r={...m0.defaultProps,...e},n=this._hashRenderPipeline(r);if(!this._renderPipelineCache[n]){const i=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._renderPipelineCache[n]={pipeline:i,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const r={...fE.defaultProps,...e},n=this._hashComputePipeline(r);if(!this._computePipelineCache[n]){const i=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._computePipelineCache[n]={pipeline:i,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const r=e.hash,n=e instanceof fE?this._computePipelineCache:this._renderPipelineCache;n[r].useCount--,n[r].useCount===0&&this.destroyPolicy==="unused"&&(n[r].pipeline.destroy(),delete n[r])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const r=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${n}V${i}BL${a}`;default:const s=this._getHash(JSON.stringify(e.parameters));return`${r}/${n}V${i}T${e.topology}P${s}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class iD{static defaultProps={...tC.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new iD(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const r=this._hashShader(e);let n=this._cache[r];if(!n){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:0}}return n.useCount++,n.shader}release(e){const r=this._hashShader(e),n=this._cache[r];n&&(n.useCount--,n.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}function X7e(t,e){const r={},n="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of t.attributes)if(i){const a=`${i.location} ${i.name}: ${i.type}`;r[`in ${a}`]={[n]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const a=`${i.location} ${i.name}`;r[`out ${a}`]={[n]:JSON.stringify(i)}}return r}let Kl=null,rP=null;function Y7e(t,{id:e,minimap:r,opaque:n,top:i="0",left:a="0",rgbaScale:s=1}){Kl||(Kl=document.createElement("canvas"),Kl.id=e,Kl.title=e,Kl.style.zIndex="100",Kl.style.position="absolute",Kl.style.top=i,Kl.style.left=a,Kl.style.border="blue 5px solid",Kl.style.transform="scaleY(-1)",document.body.appendChild(Kl),rP=Kl.getContext("2d")),(Kl.width!==t.width||Kl.height!==t.height)&&(Kl.width=t.width/2,Kl.height=t.height/2,Kl.style.width="400px",Kl.style.height="400px");const o=t.device.readPixelsToArrayWebGL(t),u=rP?.createImageData(t.width,t.height);if(u){for(let f=0;f<o.length;f+=4)u.data[0+f+0]=o[f+0]*s,u.data[0+f+1]=o[f+1]*s,u.data[0+f+2]=o[f+2]*s,u.data[0+f+3]=n?255:o[f+3]*s;rP?.putImageData(u,0,0)}}function uR(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!uR(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!uR(t[a],e[a],r-1))return!1;return!0}return!1}function Z7e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function K7e(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function Bte(t){return Z7e(t)||K7e(t)}function J7e(t){return Bte(t)||typeof t=="number"||typeof t=="boolean"}function zte(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];J7e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}class Q7e{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);const n=NL(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;yn.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&yn.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){for(const r of Object.keys(e)){const n=r,i=e[n]||{},a=this.modules[n];if(!a){this.options.disableWarnings||yn.warn(`Module ${r} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],u=a.getUniforms?.(i,s)||i,{uniforms:h,bindings:f}=zte(u);this.moduleUniforms[n]={...s,...h},this.moduleBindings[n]={...o,...f}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){const e={};for(const[r,n]of Object.entries(this.moduleUniforms))for(const[i,a]of Object.entries(n))e[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(a)};return e}_addModule(e){const r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}}let eUe="";async function tUe(t,e){const r=new Image;return r.crossOrigin="anonymous",r.src=t.startsWith("http")?t:eUe+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}class nP{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e,this.id=r.id||iC("async-texture"),typeof r?.data=="string"&&r.dimension==="2d"&&(r={...r,data:tUe(r.data)}),this.ready=new Promise((n,i)=>{this.resolveReady=()=>{this.isReady=!0,n()},this.rejectReady=i}),this.initAsync(r)}async initAsync(e){const r=e.data;let n;try{n=await jte(r)}catch(a){this.rejectReady(a)}if(this.destroyed)return;const i={...e,data:n};this.texture=this.device.createTexture(i),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}}async function jte(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(jte));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,r=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let a=0;a<n.length;a++)i[n[a]]=r[a];return i}return t}const Dg=2,rUe=1e4;class Nm{static defaultProps={...m0.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Qg.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...Nm.defaultProps,...r},r=this.props,this.id=r.id||iC("model"),this.device=e,Object.assign(this.userData,r.userData);const n=Object.fromEntries(this.props.modules?.map(u=>[u.name,u])||[]),i=r.shaderInputs||new Q7e(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=iUe(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:u,getUniforms:h}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:s});this.source=u,this._getModuleUniforms=h,this.props.shaderLayout||=cze(this.source)}else{const{vs:u,fs:h,getUniforms:f}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:s});this.vs=u,this.fs=h,this._getModuleUniforms=f}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||nD.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||iD.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniformsWebGL(r.uniforms),r.moduleSettings&&this.updateModuleSettingsWebGL(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const r=this._areBindingsLoading();if(r)return yn.info(Dg,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),cR(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:a}=this.vertexArray,s=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const r=e&&H7e(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");const n=new VI(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const r=new VI(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){uR(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new RBe(this.shaderInputs.modules);for(const[r,n]of Object.entries(this.shaderInputs.modules))if(nUe(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){const n=r?.disableWarnings??this.props.disableWarnings;e.indices&&yn.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=NBe(this.pipeline.shaderLayout,this.bufferLayout);const i=new VI(this.bufferLayout);for(const[a,s]of Object.entries(e)){const o=i.getBufferLayout(a);if(!o){n||yn.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const u=i.getAttributeNamesForBuffer(o);let h=!1;for(const f of u){const d=this._attributeInfos[f];if(d){const b=this.device.type==="webgpu"?i.getBufferIndex(d.bufferName):d.location;this.vertexArray.setBuffer(b,s),h=!0}}!h&&!n&&yn.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(const[n,i]of Object.entries(e)){const a=this._attributeInfos[n];a?this.vertexArray.setConstantWebGL(a.location,i):(r?.disableWarnings??this.props.disableWarnings)||yn.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){cR(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:r,uniforms:n}=zte(this._getModuleUniforms(e));Object.assign(this.bindings,r),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof nP&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[r,n]of Object.entries(this.bindings))n instanceof nP?n.isReady&&(e[r]=n.texture):e[r]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const r of Object.values(this.bindings))r instanceof eC?e=Math.max(e,r.texture.updateTimestamp):r instanceof Fo||r instanceof _o?e=Math.max(e,r.updateTimestamp):r instanceof nP?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof Tb||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const r={...e.attributes};for(const[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(yn.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=Ree(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=yn.level>3?0:rUe;yn.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,yn.group(Dg,`>>> DRAWING MODEL ${this.id}`,{collapsed:yn.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=X7e(this.pipeline.shaderLayout,this.id);yn.table(Dg,e)();const r=this.shaderInputs.getDebugTable();for(const[i,a]of Object.entries(this.uniforms))r[i]={value:a};yn.table(Dg,r)();const n=this._getAttributeDebugTable();yn.table(Dg,this._attributeInfos)(),yn.table(Dg,n)(),yn.groupEnd(Dg)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;const n=e.props.framebuffer;n&&Y7e(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[r,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,r){const n=Lee(r);return(e instanceof Fo?new n(e.debugData):e).toString()}}function nUe(t){return!!(t.uniformTypes&&!cR(t.uniformTypes))}function iUe(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function cR(t){for(const e in t)return!1;return!0}class Lm{device;model;transformFeedback;static defaultProps={...Nm.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=Lm.defaultProps){if(!Lm.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Nm(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||L8e(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof Fo)return r.readAsync();const{buffer:n,byteOffset:i=0,byteLength:a=n.byteLength}=r;return n.readAsync(i,a)}}class aUe{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:r={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||iC("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[a,s]of Object.entries(r)){const o=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!o.size&&(o.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[a]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let n=1/0;for(const i of Object.values(e)){const{value:a,size:s,constant:o}=i;!o&&a&&s!==void 0&&s>=1&&(n=Math.min(n,a.length/s))}return n}}const oUe={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class Ute extends rD{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,pickingFBO:s,deviceRect:{x:o,y:u,width:h,height:f},cullRect:d,effects:b,pass:v="picking",pickZ:S,shaderModuleProps:E}){this.pickZ=S;const P=this._resetColorEncoder(S),k=[o,u,h,f],L=super.render({target:s,layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,cullRect:d,effects:b?.filter(M=>M.useInPicking),pass:v,isPicking:!0,shaderModuleProps:E,clearColor:[0,0,0,0],colorMask:15,scissorRect:k});return this._colorEncoderState=null,{decodePickingColor:P&&lUe.bind(null,P),stats:L}}shouldDrawLayer(e){const{pickable:r,operation:n}=e.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,n){const i={...e.props.parameters},{pickable:a,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:a&&s.includes("draw")&&(Object.assign(i,oUe),i.blend=!0,i.blendColor=sUe(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function sUe(t,e,r){const{byLayer:n,byAlpha:i}=t;let a,s=n.get(e);return s?(s.viewports.push(r),a=s.a):(a=n.size+1,a<=255?(s={a,layer:e,viewports:[r]},n.set(e,s),i[a]=s):(Xa.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function lUe(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}const mv={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},SE=Symbol.for("component"),Yp=Symbol.for("propTypes"),iP=Symbol.for("deprecatedProps"),Gv=Symbol.for("asyncPropDefaults"),Dm=Symbol.for("asyncPropOriginal"),Vp=Symbol.for("asyncPropResolved");function S0(t,e=()=>!0){return Array.isArray(t)?Vte(t,e,[]):e(t)?[t]:[]}function Vte(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?Vte(i,e,r):e(i)&&r.push(i)}return r}function uUe({target:t,source:e,start:r=0,count:n=1}){const i=e.length,a=n*i;let s=0;for(let o=r;s<i;s++)t[o++]=e[s];for(;s<a;)s<a-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+a-s),s=a);return t}class cUe{constructor(e,r,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=$M(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class hUe{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:n=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(r,n):(a=new cUe(e,r,this._context),this._resources[e]=a),a.persistent=i}remove(e){const r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const r=this._consumers[e];if(r){for(const n in r){const i=r[n],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:n,requestId:i="default"}){const{_resources:a,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=a[e];if(this._track(n,i,o,r),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,r,n,i){const a=this._consumers,s=a[e]=a[e]||{};let o=s[r];const u=o&&o.resourceId&&this._resources[o.resourceId];u&&(u.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},s[r]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}}const fUe="layerManager.setLayers",dUe="layerManager.activateViewport";class pUe{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{Hu(dUe,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:a,timeline:s}=r||{};this.layers=[],this.resourceManager=new hUe({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:f7e(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[x9e],renderPass:void 0,stats:i||new KT({id:"deck.gl"}),viewport:a||new Qm({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Fte,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){Hu(fUe,this,r,e),this._lastRenderedLayers=e;const n=S0(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:r}=this.context;r.find(n=>n.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===e.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,n){n.raiseError(r,`${e} of ${n}`)}_updateLayers(e,r){const n={};for(const s of e)n[s.id]?Xa.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let a=!1;for(const s of i)if(s.hasUniformTransition()){a=`Uniform transition in ${s}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,r,n){for(const i of e){i.context=this.context;const a=r[i.id];a===null&&Xa.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(e){for(const r in e){const n=e[r];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=mv.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=mv.MATCHED,r!==e&&(e.lifecycle=mv.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=mv.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=mv.FINALIZED}catch(r){this._handleError("finalization",r,e)}}}function Sc(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Sc(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!Sc(t[a],e[a],r-1))return!1;return!0}return!1}class gUe{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){const r=typeof e=="string"?this.getView(e):e,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,r){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let a=n.length-1;a>=0;--a){const s=n[a];if(s.containsPixel(i)){const o=e.slice();return o[0]-=s.x,o[1]-=s.y,s.unproject(o,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=S0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Sc(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Xa.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){const n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>this.getView(e.id)?.makeViewport({viewState:a,width:this.width,height:this.height})})}_updateController(e,r,n,i){const a=e.controller;if(a&&n){const s={...r,...a,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){const{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const a=e[i],s=this.getViewState(a),o=a.makeViewport({viewState:s,width:this.width,height:this.height});let u=r[a.id];const h=!!a.controller;h&&!u&&(n=!0),(n||!h)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,s,o,u),o&&this._viewports.unshift(o)}for(const i in r){const a=r[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((n,i)=>!e[i].equals(r[i]))}}const mUe=/([0-9]+\.?[0-9]*)(%|px)/;function Tp(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=mUe.exec(t);if(e&&e.length>=3){const r=e[2]==="%",n=parseFloat(e[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function Cp(t,e){return t.relative?Math.round(t.position*e):t.position}class $te{constructor(e){const{id:r,x:n=0,y:i=0,width:a="100%",height:s="100%",padding:o=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Tp(n),this._y=Tp(i),this._width=Tp(a),this._height=Tp(s),this._padding=o&&{left:Tp(o.left||0),right:Tp(o.right||0),top:Tp(o.top||0),bottom:Tp(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Sc(this.props,e.props,2)}makeViewport({width:e,height:r,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:r});if(!i.height||!i.width)return null;const a=this.getViewportType(n);return new a({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const r={...e};for(const n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return e}getDimensions({width:e,height:r}){const n={x:Cp(this._x,e),y:Cp(this._y,r),width:Cp(this._width,e),height:Cp(this._height,r)};return this._padding&&(n.padding={left:Cp(this._padding.left,e),top:Cp(this._padding.top,r),right:Cp(this._padding.right,e),bottom:Cp(this._padding.bottom,r)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class aC{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const EH=()=>{},hR={BREAK:1,SNAP_TO_END:2,IGNORE:3},yUe=t=>t,vUe=hR.BREAK;class _Ue{constructor(e){this._onTransitionUpdate=r=>{const{time:n,settings:{interpolator:i,startProps:a,endProps:s,duration:o,easing:u}}=r,h=u(n/o),f=i.interpolateProps(a,s,h);this.propsInTransition=this.getControllerState({...this.props,...f}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new aC(e.timeline),this.onViewStateChange=e.onViewStateChange||EH,this.onStateChange=e.onStateChange||EH}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:a,endProps:s}=this.transition.settings;i={...n,...a===hR.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:r,transitionInterpolator:n}=e;return(r>0||r==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===hR.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){const n=this.getControllerState(e),i=this.getControllerState(r).shortestPathFrom(n),a=r.transitionInterpolator,s=a.getDuration?a.getDuration(e,r):r.transitionDuration;if(s===0)return;const o=a.initializeProps(e,i);this.propsInTransition={};const u={duration:s,easing:r.transitionEasing||yUe,interpolator:a,interruption:r.transitionInterruption||vUe,startProps:o.start,endProps:o.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}}function Ll(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class bUe{constructor(e){const{compare:r,extract:n,required:i}=e;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(e,r){for(const n of this._propsToCompare)if(!(n in e)||!(n in r)||!Ab(e[n],r[n]))return!1;return!0}initializeProps(e,r){const n={},i={};for(const a of this._propsToExtract)(a in e||a in r)&&(n[a]=e[a],i[a]=r[a]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{const n=e[r];Ll(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}}const xUe=["longitude","latitude","zoom","bearing","pitch"],wUe=["longitude","latitude","zoom"];class aD extends bUe{constructor(e={}){const r=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:xUe,required:wUe},super(n.transitionProps),this.opts=n}initializeProps(e,r){const n=super.initializeProps(e,r),{makeViewport:i,around:a}=this.opts;if(i&&a){const s=i(e),o=i(r),u=s.unproject(a);n.start.around=a,Object.assign(n.end,{around:o.project(u),aroundPosition:u,width:r.width,height:r.height})}return n}interpolateProps(e,r,n){const i={};for(const a of this._propsToExtract)i[a]=_E(e[a]||0,r[a]||0,n);if(r.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...r,...i});Object.assign(i,a.panByPosition(r.aroundPosition,_E(e.around,r.around,n)))}return i}}const Ap={transitionDuration:0},SUe=300,Q2=t=>1-(1-t)*(1-t),Hy={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Fg={};class qte{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new _Ue({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:r,y:n}=this.props,{offsetCenter:i}=e;return[i.x-r,i.y-n]}isPointInBounds(e,r){const{width:n,height:i}=this.props;if(r&&r.handled)return!1;const a=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return a&&r&&r.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?SUe:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:u=!1,keyboard:h=!0}=e,f=!!this.onViewStateChange;this.toggleEvents(Hy.WHEEL,f&&n),this.toggleEvents(Hy.PAN,f),this.toggleEvents(Hy.PINCH,f&&(o||u)),this.toggleEvents(Hy.MULTI_PAN,f&&u),this.toggleEvents(Hy.DOUBLE_CLICK,f&&s),this.toggleEvents(Hy.KEYBOARD,f&&h),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=u,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,r=null,n={}){const i={...e.getViewportProps(),...r},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),a){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,Ap,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const r=this.getCenter(e),n=this.controllerState.pan({pos:r});return this.updateViewport(n,Ap,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:r}=this;if(this.dragPan&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const r=this.getCenter(e),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,Ap,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let s=2/(1+Math.exp(-Math.abs(a*n)));a<0&&s!==0&&(s=1/s);const o=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:r}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,Ap,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const r=this.getCenter(e);r[0]-=e.deltaX;const n=this.controllerState.rotate({pos:r});return this.updateViewport(n,Ap,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return Fg._startPinchRotation=e.rotation,Fg._lastPinchEvent=e,this.updateViewport(n,Ap,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;r=r.rotate({deltaAngleX:Fg._startPinchRotation-n})}return this.updateViewport(r,Ap,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fg._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this,{_lastPinchEvent:n}=Fg;if(this.touchZoom&&r&&n&&e.scale!==n.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),u=Math.pow(2,s+o*r/2);a=a.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fg._startPinchRotation=null,Fg._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const r=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let u;const h={};switch(e.srcEvent.code){case"Minus":u=r?o.zoomOut(n).zoomOut(n):o.zoomOut(n),h.isZooming=!0;break;case"Equal":u=r?o.zoomIn(n).zoomIn(n):o.zoomIn(n),h.isZooming=!0;break;case"ArrowLeft":r?(u=o.rotateLeft(a),h.isRotating=!0):(u=o.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":r?(u=o.rotateRight(a),h.isRotating=!0):(u=o.moveRight(i),h.isPanning=!0);break;case"ArrowUp":r?(u=o.rotateUp(s),h.isRotating=!0):(u=o.moveUp(i),h.isPanning=!0);break;case"ArrowDown":r?(u=o.rotateDown(s),h.isRotating=!0):(u=o.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),h),!0}_getTransitionProps(e){const{transition:r}=this;return!r||!r.transitionInterpolator?Ap:e?{...r,transitionInterpolator:new aD({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}}class EUe{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}const TH=5,TUe=1.2;class Hte extends EUe{constructor(e){const{width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o=0,pitch:u=0,altitude:h=1.5,position:f=[0,0,0],maxZoom:d=20,minZoom:b=0,maxPitch:v=60,minPitch:S=0,startPanLngLat:E,startZoomLngLat:P,startRotatePos:k,startBearing:L,startPitch:N,startZoom:M,normalize:z=!0}=e;Ll(Number.isFinite(a)),Ll(Number.isFinite(i)),Ll(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o,pitch:u,altitude:h,maxZoom:d,minZoom:b,maxPitch:v,minPitch:S,normalize:z,position:f},{startPanLngLat:E,startZoomLngLat:P,startRotatePos:k,startBearing:L,startPitch:N,startZoom:M}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){const n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:a,startPitch:s}=this.getState();if(!i||a===void 0||s===void 0)return this;let o;return e?o=this._getNewRotation(e,i,s,a):o={bearing:a+r,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(e)),!a)return this;const{maxZoom:s,minZoom:o}=this.getViewportProps();let u=i+Math.log2(n);u=Gf(u,o,s);const h=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...h.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const r=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:a}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(a-r.longitude)>180&&(n.longitude=a<0?a+360:a-360),n}applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=Gf(i,n,r);const{maxPitch:a,minPitch:s,pitch:o}=e;e.pitch=Gf(o,s,a);const{normalize:u=!0}=e;return u&&Object.assign(e,Yje(e)),e}_zoomFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:e})}_panFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,n,i){const a=e[0]-r[0],s=e[1]-r[1],o=e[1],u=r[1],{width:h,height:f}=this.getViewportProps(),d=a/h;let b=0;s>0?Math.abs(f-u)>TH&&(b=s/(u-f)*TUe):s<0&&u>TH&&(b=1-o/u),b=Gf(b,-1,1);const{minPitch:v,maxPitch:S}=this.getViewportProps(),E=i+180*d;let P=n;return b>0?P=n+b*(S-n):b<0&&(P=n-b*(v-n)),{pitch:P,bearing:E}}}class CUe extends qte{constructor(){super(...arguments),this.ControllerState=Hte,this.transition={transitionDuration:300,transitionInterpolator:new aD({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class oD extends $te{constructor(e={}){super(e)}getViewportType(){return Om}get ControllerType(){return CUe}}oD.displayName="MapView";const AUe=new Lte;function IUe(t,e){const r=t.order??1/0,n=e.order??1/0;return r-n}class PUe{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const r=this._defaultEffects;if(!r.find(n=>n.id===e.id)){const n=r.findIndex(i=>IUe(i,e)>0);n<0?r.push(e):r.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Sc(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){const r={};for(const i of this.effects)r[i.id]=i;const n=[];for(const i of e){const a=r[i.id];let s=i;a&&a!==i?a.setProps?(a.setProps(i.props),s=a):a.cleanup(this._context):a||i.setup(this._context),n.push(s),delete r[i.id]}for(const i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof Lte)||this._resolvedEffects.push(AUe),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class kUe extends rD{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}const MUe="deckRenderer.renderLayers";class RUe{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new kUe(e),this.pickLayersPass=new Ute(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const a=r.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Hu(MUe,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){const{renderBuffers:e}=this;for(const r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(const n of e)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(n=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${n}`,colorAttachments:[i]}))});for(const n of e)n.resize(r)}_postRender(e,r){const{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?r.target:void 0;const s=a.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}}const OUe={pickedColor:null,pickedObjectIndex:-1};function NUe({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:a}){const{x:s,y:o,width:u,height:h}=a;let f=i*i,d=-1,b=0;for(let v=0;v<h;v++){const S=v+o-n,E=S*S;if(E>f)b+=4*u;else for(let P=0;P<u;P++){if(t[b+3]-1>=0){const L=P+s-r,N=L*L+E;N<=f&&(f=N,d=b)}b+=4}}if(d>=0){const v=t.slice(d,d+4),S=e(v);if(S){const E=Math.floor(d/4/u),P=d/4-E*u;return{...S,pickedColor:v,pickedX:s+P,pickedY:o+E}}Xa.error("Picked non-existent layer. Is picking buffer corrupt?")()}return OUe}function LUe({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t){for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const a=t.slice(n,n+4),s=a.join(",");if(!r.has(s)){const o=e(a);o?r.set(s,{...o,color:a}):Xa.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function Wte({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:a}){let s=e[0];e.length>1&&(s=FUe(t?.pickedViewports||e,{x:n,y:i}));let o;if(s){const u=[n-s.x,i-s.y];a!==void 0&&(u[2]=a),o=s.unproject(u)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function DUe(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:a,pickedLayer:s,pickedObjectIndex:o}=e,u=s?[s]:[];if(n==="hover"){const d=r.index,b=r.layerId,v=s?s.props.id:null;if(v!==b||o!==d){if(v!==b){const S=i.find(E=>E.props.id===b);S&&u.unshift(S)}r.layerId=v,r.index=o,r.info=null}}const h=Wte(t),f=new Map;return f.set(null,h),u.forEach(d=>{let b={...h};d===s&&(b.color=a,b.index=o,b.picked=!0),b=Gte({layer:d,info:b,mode:n});const v=b.layer;d===s&&n==="hover"&&(r.info=b),f.set(v.id,b),n==="hover"&&v.updateAutoHighlight(b)}),f}function Gte({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}function FUe(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}class BUe{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new Ute(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:n,viewports:i},a=this.lastPickedInfo.info){const s=a&&a.layer&&a.layer.id,o=a&&a.viewport&&a.viewport.id,u=s?n.find(b=>b.id===s):null,h=o&&i.find(b=>b.id===o)||i[0],f=h&&h.unproject([e-h.x,r-h.y]);return{...a,...{x:e,y:r,viewport:h,coordinate:f,layer:u}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const r=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}_pickClosestObject({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:u="query",unproject3D:h,onViewportActive:f,effects:d}){const b=this.device.canvasContext.cssToDeviceRatio(),v=this._getPickable(e);if(!v||n.length===0)return{result:[],emptyInfo:Wte({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const S=this.device.canvasContext.cssToDevicePixels([i,a],!0),E=[S.x+Math.floor(S.width/2),S.y+Math.floor(S.height/2)],P=Math.round(s*b),{width:k,height:L}=this.pickingFBO,N=this._getPickingRect({deviceX:E[0],deviceY:E[1],deviceRadius:P,deviceWidth:k,deviceHeight:L}),M={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let z;const B=[],q=new Set;for(let W=0;W<o;W++){let G;if(N){const J=this._drawAndSample({layers:v,views:r,viewports:n,onViewportActive:f,deviceRect:N,cullRect:M,effects:d,pass:`picking:${u}`});G=NUe({...J,deviceX:E[0],deviceY:E[1],deviceRadius:P,deviceRect:N})}else G={pickedColor:null,pickedObjectIndex:-1};let ie;if(G.pickedLayer&&h&&this.depthFBO){const{pickedColors:J}=this._drawAndSample({layers:[G.pickedLayer],views:r,viewports:n,onViewportActive:f,deviceRect:{x:G.pickedX,y:G.pickedY,width:1,height:1},cullRect:M,effects:d,pass:`picking:${u}:z`},!0);J[3]&&(ie=J[0])}G.pickedLayer&&W+1<o&&(q.add(G.pickedLayer),G.pickedLayer.disablePickingIndex(G.pickedObjectIndex)),z=DUe({pickInfo:G,lastPickedInfo:this.lastPickedInfo,mode:u,layers:v,viewports:n,x:i,y:a,z:ie,pixelRatio:b});for(const J of z.values())J.layer&&B.push(J);if(!G.pickedColor)break}for(const W of q)W.restorePickingColors();return{result:B,emptyInfo:z.get(null)}}_pickVisibleObjects({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:u="query",maxObjects:h=null,onViewportActive:f,effects:d}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const v=this.device.canvasContext.cssToDeviceRatio(),S=this.device.canvasContext.cssToDevicePixels([i,a],!0),E=S.x,P=S.y+S.height,k=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),L=k.x+k.width,N=k.y,M={x:E,y:N,width:L-E,height:P-N},z=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:f,deviceRect:M,cullRect:{x:i,y:a,width:s,height:o},effects:d,pass:`picking:${u}`}),B=LUe(z),q=new Map,W=[],G=Number.isFinite(h);for(let ie=0;ie<B.length&&!(G&&W.length>=h);ie++){const J=B[ie];let H={color:J.pickedColor,layer:null,index:J.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:v};H=Gte({layer:J.pickedLayer,info:H,mode:u});const ne=H.layer.id;q.has(ne)||q.set(ne,new Set);const ae=q.get(ne),ue=H.object??H.index;ae.has(ue)||(ae.add(ue),W.push(H))}return W}_drawAndSample({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:u},h=!1){const f=h?this.depthFBO:this.pickingFBO,d={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:f,deviceRect:a,cullRect:s,effects:o,pass:u,pickZ:h,preRenderStats:{},isPicking:!0};for(const L of o)L.useInPicking&&(d.preRenderStats[L.id]=L.preRender(d));const{decodePickingColor:b}=this.pickLayersPass.render(d),{x:v,y:S,width:E,height:P}=a,k=new(h?Float32Array:Uint8Array)(E*P*4);return this.device.readPixelsToArrayWebGL(f,{sourceX:v,sourceY:S,sourceWidth:E,sourceHeight:P,target:k}),{pickedColors:k,decodePickingColor:b}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:a}){const s=Math.max(0,e-n),o=Math.max(0,r-n),u=Math.min(i,e+n+1)-s,h=Math.min(a,r+n+1)-o;return u<=0||h<=0?null:{x:s,y:o,width:u,height:h}}}const zUe={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},jUe="top-left",CH="__root";class UUe{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Sc(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const r={};for(const n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._remove(i),this._add(n)):n!==i&&(i.setProps(n.props),n=i):this._add(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(const n in r){const i=r[n];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:r=null,placement:n=jUe}=e,i=e.onAdd({deck:this.deck,viewId:r});i&&this._getContainer(r,n).append(i),e._element=i}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,r){const n=e||CH;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let a=i.querySelector(`.${r}`);return a||(a=document.createElement("div"),a.className=r,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,zUe[r]),i.append(a)),a}_updateContainers(){const e=this.deck.width,r=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,a=n===CH||i,s=this.containers[n];a?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}onRedraw({viewports:e,layers:r}){const n=e.reduce((i,a)=>(i[a.id]=a,i),{});for(const i of this.getWidgets()){const{viewId:a}=i;if(a){const s=n[a];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(const s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(e,r){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,r)}}onEvent(e,r){const n=aR[r.type];if(n)for(const i of this.getWidgets()){const{viewId:a}=i;(!a||a===e.viewport?.id)&&i[n]?.(e,r)}}}const VUe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class $Ue{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,VUe),this.deck=e,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;const i=n(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,r,n){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var Pv;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Pv||(Pv={}));const sD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},dl=(t,e,r)=>e?t.enable(r):t.disable(r),AH=(t,e,r)=>t.hint(r,e),Hc=(t,e,r)=>t.pixelStorei(r,e),IH=(t,e,r)=>{const n=r===36006?36009:36008;return t.bindFramebuffer(n,e)},V_=(t,e,r)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(i,e)};function aP(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const qUe={3042:dl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:dl,2885:(t,e)=>t.cullFace(e),2929:dl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:dl,35723:AH,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:IH,36010:IH,34964:V_,36662:V_,36663:V_,35053:V_,35055:V_,2886:(t,e)=>t.frontFace(e),33170:AH,2849:(t,e)=>t.lineWidth(e),32823:dl,32824:"polygonOffset",10752:"polygonOffset",35977:dl,32926:dl,32928:dl,32938:"sampleCoverage",32939:"sampleCoverage",3089:dl,3088:(t,e)=>t.scissor(...e),2960:dl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:dl,10754:dl,12288:dl,12289:dl,12290:dl,12291:dl,12292:dl,12293:dl,12294:dl,12295:dl,3333:Hc,3317:Hc,37440:Hc,37441:Hc,37443:Hc,3330:Hc,3332:Hc,3331:Hc,3314:Hc,32878:Hc,3316:Hc,3315:Hc,32877:Hc,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{const r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=aP(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=aP(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,a,s,o)},stencilOp:(t,e)=>{e=aP(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,a,s,o)},viewport:(t,e)=>t.viewport(...e)};function Ms(t,e,r){return e[t]!==void 0?e[t]:r[t]}const HUe={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ms(32777,e,r),Ms(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ms(32969,e,r),Ms(32968,e,r),Ms(32971,e,r),Ms(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ms(32824,e,r),Ms(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ms(32938,e,r),Ms(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ms(2962,e,r),Ms(2967,e,r),Ms(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ms(34816,e,r),Ms(36003,e,r),Ms(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ms(2964,e,r),Ms(2965,e,r),Ms(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ms(34817,e,r),Ms(34818,e,r),Ms(34819,e,r))},PH={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?t({[n]:r}):{valueChanged:!0}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},Df=(t,e)=>t.isEnabled(e),kH={3042:Df,2884:Df,2929:Df,3024:Df,32823:Df,32926:Df,32928:Df,3089:Df,2960:Df,35977:Df},WUe=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function H0(t,e){if(XUe(e))return;const r={};for(const i in e){const a=Number(i),s=qUe[i];s&&(typeof s=="string"?r[s]=!0:s(t,e[i],a))}const n=t.state&&t.state.cache;if(n)for(const i in r){const a=HUe[i];a(t,e,n)}}function Xte(t,e=sD){if(typeof e=="number"){const i=e,a=kH[i];return a?a(t,i):t.getParameter(i)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const a=kH[i];n[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return n}function GUe(t){H0(t,sD)}function XUe(t){for(const e in t)return!1;return!0}function YUe(t,e){if(t===e)return!0;const r=Array.isArray(t)||ArrayBuffer.isView(t),n=Array.isArray(e)||ArrayBuffer.isView(e);if(r&&n&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class fm{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];H0(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r.copyState?Xte(e):Object.assign({},sD),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,KUe(e);for(const n in PH){const i=PH[n];ZUe(e,n,i)}MH(e,"getParameter"),MH(e,"isEnabled")}_updateCache(e){let r=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const s=e[a],o=this.cache[a];YUe(s,o)||(r=!0,n=o,i&&!(a in i)&&(i[a]=o),this.cache[a]=s)}return{valueChanged:r,oldValue:n}}}function MH(t,e){const r=t[e].bind(t);t[e]=function(i){if(i===void 0||WUe.has(i))return r(i);const a=fm.get(t);return i in a.cache||(a.cache[i]=r(i)),a.enable?a.cache[i]:r(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function ZUe(t,e,r){if(!t[e])return;const n=t[e].bind(t);t[e]=function(...a){const s=fm.get(t),{valueChanged:o,oldValue:u}=r(s._updateCache,...a);return o&&n(...a),u},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function KUe(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=fm.get(t);i.program!==n&&(e(n),i.program=n)}}function JUe(t,e,r){let n="";const i={preserveDrawingBuffer:!0,...r};let a=null;if(a||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!a&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=t.getContext("webgl2",i),a.luma||={},a.luma.softwareRenderer=!0),a||(a=t.getContext("webgl",{}),a&&(a=null,n||="Your browser only supports WebGL1")),!a)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:s,onContextRestored:o}=e;return t.addEventListener("webglcontextlost",u=>s(u),!1),t.addEventListener("webglcontextrestored",u=>o(u),!1),a.luma||={},a}function E0(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}function QUe(t,e){const r=t.getParameter(7936),n=t.getParameter(7937);E0(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=a||r,u=s||n,h=t.getParameter(7938),f=Yte(o,u),d=eVe(o,u),b=tVe(o,u);return{type:"webgl",gpu:f,gpuType:b,gpuBackend:d,vendor:o,renderer:u,version:h,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Yte(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function eVe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function tVe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(Yte(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Zte(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const m1="WEBGL_compressed_texture_s3tc",y1="WEBGL_compressed_texture_s3tc_srgb",kv="EXT_texture_compression_rgtc",Mv="EXT_texture_compression_bptc",rVe="WEBGL_compressed_texture_etc",nVe="WEBGL_compressed_texture_astc",iVe="WEBGL_compressed_texture_etc1",aVe="WEBGL_compressed_texture_pvrtc",oVe="WEBGL_compressed_texture_atc",RH="EXT_texture_norm16",OH="EXT_render_snorm",sVe="EXT_color_buffer_float",lD={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[OH],"norm16-renderable-webgl":[RH],"snorm16-renderable-webgl":[RH,OH],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[m1,y1,kv,Mv],"texture-compression-bc5-webgl":[kv],"texture-compression-bc7-webgl":[Mv],"texture-compression-etc2":[rVe],"texture-compression-astc":[nVe],"texture-compression-etc1-webgl":[iVe],"texture-compression-pvrtc-webgl":[aVe],"texture-compression-atc-webgl":[oVe]};function lVe(t){return t in lD}function uVe(t,e,r){return(lD[e]||[]).every(i=>E0(t,i,r))}const uD={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:sVe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:m1},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:y1},"bc1-rgba-unorm":{gl:33777,x:m1},"bc1-rgba-unorm-srgb":{gl:35916,x:y1},"bc2-rgba-unorm":{gl:33778,x:m1},"bc2-rgba-unorm-srgb":{gl:35918,x:y1},"bc3-rgba-unorm":{gl:33779,x:m1},"bc3-rgba-unorm-srgb":{gl:35919,x:y1},"bc4-r-unorm":{gl:36283,x:kv},"bc4-r-snorm":{gl:36284,x:kv},"bc5-rg-unorm":{gl:36285,x:kv},"bc5-rg-snorm":{gl:36286,x:kv},"bc6h-rgb-ufloat":{gl:36495,x:Mv},"bc6h-rgb-float":{gl:36494,x:Mv},"bc7-rgba-unorm":{gl:36492,x:Mv},"bc7-rgba-unorm-srgb":{gl:36493,x:Mv},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function cVe(t,e,r){let n=e.create;const i=uD[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!E0(t,i.x,r)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function Kte(t){const e=uD[t],r=dVe(t),n=LL(t);return{internalFormat:r,format:e?.dataFormat||fVe(n.channels,n.integer,n.normalized,r),type:n.dataType?Zte(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function hVe(t){switch(LL(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function fVe(t,e,r,n){if(n===6408||n===6407)return n;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function dVe(t){const r=uD[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}const NH={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class pVe extends K8e{gl;extensions;testedFeatures=new Set;constructor(e,r,n){super([],n),this.gl=e,this.extensions=r,E0(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const e=this.getFeatures();for(const r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),lVe(e)&&uVe(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of e)this.has(r)}getFeatures(){return[...Object.keys(NH),...Object.keys(lD)]}getWebGLFeature(e){const r=NH[e];return typeof r=="string"?!!E0(this.gl,r,this.extensions):!!r}}class gVe extends Z8e{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class U1 extends rC{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);const n=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const n=this.colorAttachments[r];if(n){const i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){const r=hVe(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${yVe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){const{gl:n}=this.device,{texture:i}=r,a=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,i.handle,a,s);break;case 34067:const o=mVe(s);n.framebufferTexture2D(36160,e,o,i.handle,a);break;case 3553:n.framebufferTexture2D(36160,e,3553,i.handle,a);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}}function mVe(t){return t<34069?t+34069:t}function yVe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class vVe extends DL{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new U1(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(r,e);return}}commit(){}}async function Jte(t,e){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),new Promise((i,a)=>{n.onload=i,n.onerror=s=>a(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(n)})}const _Ve=1;let Wc=null,LH=!1;const cD={debugSpectorJS:yn.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function bVe(t){if(!globalThis.SPECTOR)try{await Jte(t.debugSpectorJSUrl||cD.debugSpectorJSUrl)}catch(e){yn.warn(String(e))}}function xVe(t){if(t={...cD,...t},!t.debugSpectorJS)return null;if(!Wc&&globalThis.SPECTOR&&!globalThis.luma?.spector){yn.probe(_Ve,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Wc=new e,globalThis.luma&&(globalThis.luma.spector=Wc)}if(!Wc)return null;if(LH||(LH=!0,Wc.spyCanvases(),Wc?.onCaptureStarted.add(e=>yn.info("Spector capture started:",e)()),Wc?.onCapture.add(e=>{yn.info("Spector capture complete:",e)(),Wc?.getResultUI(),Wc?.resultView.display(),Wc?.resultView.addCapture(e)})),t.gl){const e=t.gl,r=e.device;Wc?.startCapture(t.gl,500),e.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{yn.info("Spector capture stopped after 2 seconds")(),Wc?.stopCapture()})}return Wc}const wVe="https://unpkg.com/webgl-debug@2.0.1/index.js";function Qte(t){return t.luma=t.luma||{},t.luma}async function SVe(){Zm()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Jte(wVe))}function EVe(t,e={}){return e.debugWebGL||e.traceWebGL?CVe(t,e):TVe(t)}function TVe(t){const e=Qte(t);return e.realContext?e.realContext:t}function CVe(t,e){if(!globalThis.WebGLDebugUtils)return yn.warn("webgl-debug not loaded")(),t;const r=Qte(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...Pv,...t});const n=globalThis.WebGLDebugUtils.makeDebugContext(t,AVe.bind(null,e),IVe.bind(null,e));for(const s in Pv)!(s in n)&&typeof Pv[s]=="number"&&(n[s]=Pv[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,n);const a=Object.create(i);return r.realContext=t,r.debugContext=a,a.debug=!0,a}function DH(t,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function AVe(t,e,r,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${a})`;yn.error(s)();debugger}function IVe(t,e,r){let n="";yn.level>=1&&(n=DH(e,r),t.traceWebGL&&yn.log(1,n)());for(const i of r)if(i===void 0){n=n||DH(e,r);debugger}}const oP={};function PVe(t="id"){oP[t]=oP[t]||1;const e=oP[t]++;return`${t}-${e}`}class V1 extends Fo{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;const n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=kVe(this.props.usage),this.glUsage=MVe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(e,r=0,n=e.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,e),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,e),this.gl.bindBuffer(36663,null),this._setDebugData(e,r,e.byteLength)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}readSyncWebGL(e=0,r){r=r??this.byteLength-e;const n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,r),n}}function kVe(t){return t&Fo.INDEX?34963:t&Fo.VERTEX?34962:t&Fo.UNIFORM?35345:34962}function MVe(t){return t&Fo.INDEX||t&Fo.VERTEX?35044:t&Fo.UNIFORM?35048:35044}function RVe(t){const e=t.split(/\r?\n/),r=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[d,b]=i;r.push({message:b.trim(),type:FH(d),lineNum:0,linePos:0});continue}const[a,s,o,...u]=i;let h=parseInt(o,10);isNaN(h)&&(h=0);let f=parseInt(s,10);isNaN(f)&&(f=0),r.push({message:u.join(":").trim(),type:FH(a),lineNum:h,linePos:f})}return r}function FH(t){const e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}class OVe extends tC{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?RVe(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}yn.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),yn.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function NVe(t,e,r,n){if(BVe(e))return n(t);const i=t;i.pushState();try{return LVe(t,e),H0(i.gl,r),n(t)}finally{i.popState()}}function LVe(t,e){const r=t,{gl:n}=r;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(dm("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const a=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=dm("provokingVertex",e.provokingVertex,{first:36429,last:36430});a?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=dm("polygonMode",e.polygonMode,{fill:6914,line:6913});a?.polygonModeWEBGL(1028,s),a?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&n.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(FVe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(fR("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&yn.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=fR("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,a,0,i),n.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=sP("stencilPassOperation",e.stencilPassOperation),a=sP("stencilFailOperation",e.stencilFailOperation),s=sP("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,a,s,i),n.stencilOpSeparate(1029,a,s,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=BH("blendColorOperation",e.blendColorOperation||"add"),a=BH("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,a);const s=ew("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=ew("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=ew("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),h=ew("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,o,u,h)}}function fR(t,e){return dm(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function sP(t,e){return dm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function BH(t,e){return dm(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function ew(t,e){return dm(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function DVe(t,e){return`Illegal parameter ${e} for ${t}`}function dm(t,e,r){if(!(e in r))throw new Error(DVe(t,e));return r[e]}function FVe(t,e){return e}function BVe(t){let e=!0;for(const r in t){e=!1;break}return e}function ere(t){const e={};return t.addressModeU&&(e[10242]=lP(t.addressModeU)),t.addressModeV&&(e[10243]=lP(t.addressModeV)),t.addressModeW&&(e[32882]=lP(t.addressModeW)),t.magFilter&&(e[10240]=dR(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=zVe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=fR("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function lP(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function dR(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function zVe(t,e="none"){if(!e)return dR(t);switch(e){case"none":return dR(t);case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class pR extends Tb{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=ere(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[r,n]of Object.entries(e)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}}class Rv extends eC{device;gl;handle;texture;constructor(e,r){super(e,{..._o.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const jVe="Failed to deduce GL constant from typed array";function UVe(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(jVe)}}function VVe(t,e){const{clamped:r=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function tre(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function $Ve(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function EE(t,e,r){if(qVe(e))return r(t);const{nocatch:n=!0}=e,i=fm.get(t);i.push(),H0(t,e);let a;if(n)a=r(t),i.pop();else try{a=r(t)}finally{i.pop()}return a}function qVe(t){for(const e in t)return!1;return!0}function HVe(t,e,r){const{dimension:n,width:i,height:a,depth:s=0}=r,{glInternalFormat:o}=r,u=r.glTarget;switch(n){case"2d-array":case"3d":t.texStorage3D(u,e,o,i,a,s);break;default:t.texStorage2D(u,e,o,i,a)}}function zH(t,e,r,n){const{width:i,height:a}=n,{dimension:s,depth:o=0,mipLevel:u=0}=n,{x:h=0,y:f=0,z:d=0}=n,{glFormat:b,glType:v}=n,S=rre(n.glTarget,s,o),E=n.flipY?{37440:!0}:{};EE(t,E,()=>{switch(s){case"2d-array":case"3d":t.bindTexture(S,e),t.texSubImage3D(S,u,h,f,d,i,a,o,b,v,r),t.bindTexture(S,null);break;case"2d":case"cube":t.bindTexture(S,e),t.texSubImage2D(S,u,h,f,i,a,b,v,r),t.bindTexture(S,null);break;default:throw new Error(s)}})}function jH(t,e,r){const{dimension:n,width:i,height:a,depth:s=0,mipLevel:o=0,byteOffset:u=0}=r,{x:h=0,y:f=0,z:d=0}=r,{glFormat:b,glType:v,compressed:S}=r,E=rre(r.glTarget,n,s);switch(n){case"2d-array":case"3d":S?t.compressedTexSubImage3D(E,o,h,f,d,i,a,s,b,e,u):t.texSubImage3D(E,o,h,f,d,i,a,s,b,v,e,u);break;case"2d":case"cube":S?t.compressedTexSubImage2D(E,o,h,f,i,a,b,e,u):t.texSubImage2D(E,o,h,f,i,a,b,v,e,u);break;default:throw new Error(n)}}function WVe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function rre(t,e,r){return e==="cube"?34069+r:t}function GVe(t,e){const{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:s,sourceHeight:o,sourceDepth:u,sourceFormat:h,sourceType:f}=e||{};const{framebuffer:d,deleteFramebuffer:b}=nre(t),{gl:v,handle:S}=d;s||=d.width,o||=d.height;const E=d.colorAttachments[i]?.texture;if(!E)throw new Error(`Invalid framebuffer attachment ${i}`);u=E?.depth||1,h||=E?.glFormat||6408,f||=E?.glType||5121,a=ZVe(a,f,h,s,o),f=f||UVe(a);const P=v.bindFramebuffer(36160,S);return v.readBuffer(36064+i),v.readPixels(r,n,s,o,h,f,a),v.readBuffer(36064),v.bindFramebuffer(36160,P||null),b&&d.destroy(),a}function XVe(t,e){const{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:o,sourceHeight:u,sourceType:h}=e||{};const{framebuffer:f,deleteFramebuffer:d}=nre(t);o=o||f.width,u=u||f.height;const b=f;h=h||5121;let v=r;if(!v){const E=tre(a),P=$Ve(h),k=s+o*u*E*P;v=b.device.createBuffer({byteLength:k})}const S=t.device.createCommandEncoder();return S.copyTextureToBuffer({sourceTexture:t,width:o,height:u,origin:[n,i],destinationBuffer:v,byteOffset:s}),S.destroy(),d&&f.destroy(),v}function nre(t){return t instanceof rC?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:YVe(t),deleteFramebuffer:!0}}function YVe(t,e){const{device:r,width:n,height:i,id:a}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:n,height:i,colorAttachments:[t]})}function ZVe(t,e,r,n,i,a){if(t)return t;e||=5121;const s=VVe(e,{clamped:!1}),o=tre(r);return new s(n*i*o)}class $1 extends _o{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,r){super(e,r);const n={...this.props};n.data=r.data,this.device=e,this.gl=this.device.gl,this.glTarget=WVe(this.props.dimension);const i=Kte(this.props.format);this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:r,height:n}=e;if(!r||!n){const i=_o.getTextureDataSize(e.data);r=i?.width||1,n=i?.height||1}if(this.width=r,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new Rv(this.device,{...this.props,texture:this}),this.bind(),HVe(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Rv(this.device,{...e,texture:this})}setSampler(e={}){let r;e instanceof pR?(this.sampler=e,r=e.props):(this.sampler=new pR(this.device,e),r=e);const n=ere(r);this._setSamplerParameters(n)}generateMipmap(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(yn.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){yn.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const r=_o.getExternalImageSize(e.image),n={..._o.defaultCopyExternalImageOptions,...r,...e},{image:i,depth:a,mipLevel:s,x:o,y:u,z:h,flipY:f}=n;let{width:d,height:b}=n;const{dimension:v,glTarget:S,glFormat:E,glInternalFormat:P,glType:k}=this;if(d=Math.min(d,this.width-o),b=Math.min(b,this.height-u),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return zH(this.device.gl,this.handle,i,{dimension:v,mipLevel:s,x:o,y:u,z:h,width:d,height:b,depth:a,glFormat:E,glType:k,glTarget:S,flipY:f}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,r=0){this.bind();const n=_o.normalizeTextureData(e,this);n.length>1&&this.props.mipmaps!==!1&&yn.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const a=n[i];this._setMipLevel(r,i,a)}this.unbind()}setTexture3DData(e){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),jH(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const n of _o.CubeFaces)this.setTextureCubeFaceData(e[n],n)}setTextureArrayData(e){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,r,n=0){Array.isArray(e)&&e.length>1&&this.props.mipmaps!==!1&&yn.warn(`${this.id} has mipmap and multiple LODs.`)();const i=_o.CubeFaces.indexOf(r);this.setTexture2DData(e,i)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:r,width:n,height:i,pixels:a,data:s,format:o=6408,type:u=5121}=e,{gl:h}=this,f=a||s;this.bind(),f instanceof Promise?f.then(d=>this.setImageDataForFace(Object.assign({},e,{face:r,data:d,pixels:d}))):this.width||this.height?h.texImage2D(r,0,o,n,i,0,o,u,f):h.texImage2D(r,0,o,o,u,f)}_getImageDataMap(e){for(let r=0;r<_o.CubeFaces.length;++r){const n=_o.CubeFaces[r];e[n]&&(e[34069+r]=e[n],delete e[n])}return e}_setSamplerParameters(e){yn.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,n]of Object.entries(e)){const i=Number(r),a=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,a);break;case 10241:this.gl.texParameteri(this.glTarget,i,a);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,i,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,a);break;default:this.gl.texParameteri(this.glTarget,i,a);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,r,n,i=this.glTarget){if(_o.isExternalImage(n)){zH(this.device.gl,this.handle,n,{...this,depth:e,mipLevel:r,glTarget:i,flipY:this.props.flipY});return}if(_o.isTextureLevelData(n)){jH(this.device.gl,n.data,{...this,depth:e,mipLevel:r,glTarget:i});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}const KVe=[1,2,4,8];class JVe extends Xg{device;glParameters;constructor(e,r){super(e,r),this.device=e;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){const{width:a,height:s}=r.framebuffer;n=[0,0,a,s]}else{const[a,s]=e.getCanvasContext().getDrawingBufferSize();n=[0,0,a,s]}if(this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters}),this.props.framebuffer?.handle)if(this.props.framebuffer){const a=this.props.framebuffer.colorAttachments.map((s,o)=>36064+o);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(r.colorMask=KVe.map(n=>!!(n&e.colorMask))),this.glParameters=r,H0(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&EE(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){EE(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function QVe(t){return e$e.includes(t)}const e$e=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],ire={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function are(t){const e=ire[t];if(!e)throw new Error("uniform");const[r,n,,i]=e;return{format:i,components:n,glType:r}}function t$e(t){const e=ire[t];if(!e)throw new Error("attribute");const[,r,,n,i]=e;return{attributeType:n,vertexFormat:i,components:r}}function r$e(t,e){const r={attributes:[],bindings:[]};r.attributes=n$e(t,e);const n=o$e(t,e);for(const o of n){const u=o.uniforms.map(h=>({name:h.name,format:h.format,byteOffset:h.byteOffset,byteStride:h.byteStride,arrayLength:h.arrayLength}));r.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:u})}const i=a$e(t,e);let a=0;for(const o of i)if(QVe(o.type)){const{viewDimension:u,sampleType:h}=l$e(o.type);r.bindings.push({type:"texture",name:o.name,group:0,location:a,viewDimension:u,sampleType:h}),o.textureUnit=a,a+=1}i.length&&(r.uniforms=i);const s=i$e(t,e);return s?.length&&(r.varyings=s),r}function n$e(t,e){const r=[],n=t.getProgramParameter(e,35721);for(let i=0;i<n;i++){const a=t.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o}=a,u=t.getAttribLocation(e,s);if(u>=0){const{attributeType:h}=t$e(o),f=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:u,stepMode:f,type:h})}}return r.sort((i,a)=>i.location-a.location),r}function i$e(t,e){const r=[],n=t.getProgramParameter(e,35971);for(let i=0;i<n;i++){const a=t.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o,size:u}=a,{glType:h,components:f}=are(o),d={location:i,name:s,type:h,size:u*f};r.push(d)}return r.sort((i,a)=>i.location-a.location),r}function a$e(t,e){const r=[],n=t.getProgramParameter(e,35718);for(let i=0;i<n;i++){const a=t.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:s,size:o,type:u}=a,{name:h,isArray:f}=u$e(s);let d=t.getUniformLocation(e,h);const b={location:d,name:h,size:o,type:u,isArray:f};if(r.push(b),b.size>1)for(let v=0;v<b.size;v++){const S=`${h}[${v}]`;d=t.getUniformLocation(e,S);const E={...b,name:S,location:d};r.push(E)}}return r}function o$e(t,e){const r=(a,s)=>t.getActiveUniformBlockParameter(e,a,s),n=[],i=t.getProgramParameter(e,35382);for(let a=0;a<i;a++){const s={name:t.getActiveUniformBlockName(e,a)||"",location:r(a,35391),byteLength:r(a,35392),vertex:r(a,35396),fragment:r(a,35398),uniformCount:r(a,35394),uniforms:[]},o=r(a,35395)||[],u=t.getActiveUniforms(e,o,35383),h=t.getActiveUniforms(e,o,35384),f=t.getActiveUniforms(e,o,35387),d=t.getActiveUniforms(e,o,35388);for(let b=0;b<s.uniformCount;++b){const v=t.getActiveUniform(e,o[b]);if(!v)throw new Error("activeInfo");s.uniforms.push({name:v.name,format:are(u[b]).format,type:u[b],arrayLength:h[b],byteOffset:f[b],byteStride:d[b]})}n.push(s)}return n.sort((a,s)=>a.location-s.location),n}const s$e={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function l$e(t){const e=s$e[t];if(!e)throw new Error("sampler");const[r,n]=e;return{viewDimension:r,sampleType:n}}function u$e(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function c$e(t,e,r,n){const i=t;let a=n;a===!0&&(a=1),a===!1&&(a=0);const s=typeof a=="number"?[a]:a;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,n);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}function h$e(t){return Bte(t)!==null||typeof t=="number"||typeof t=="boolean"}function f$e(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];h$e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}function d$e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function p$e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const UH=4;class g$e extends m0{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),yn.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=r$e(this.device.gl,this.handle),yn.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=m$e(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,r){for(const[n,i]of Object.entries(e)){const a=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!a){const s=this.shaderLayout.bindings.map(o=>`"${o.name}"`).join(", ");r?.disableWarnings||yn.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||yn.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(i instanceof V1)&&!(i.buffer instanceof V1))throw new Error("buffer value");break;case"texture":if(!(i instanceof Rv||i instanceof $1||i instanceof U1))throw new Error("texture value");break;case"sampler":yn.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(a.type)}this.bindings[n]=i}}draw(e){const{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:a,vertexCount:s,instanceCount:o,isInstanced:u=!1,firstVertex:h=0,transformFeedback:f}=e,d=d$e(i),b=!!a.indexBuffer,v=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return yn.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return yn.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(r),f&&f.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const S=r;return NVe(this.device,n,S.glParameters,()=>{b&&u?this.device.gl.drawElementsInstanced(d,s||0,v,h,o||0):b?this.device.gl.drawElements(d,s||0,v,h):u?this.device.gl.drawArraysInstanced(d,h,s||0,o||0):this.device.gl.drawArrays(d,h,s||0),f&&f.end()}),a.unbindAfterRender(r),!0}setUniformsWebGL(e){const{bindings:r}=f$e(e);Object.keys(r).forEach(n=>{yn.warn(`Unsupported value "${JSON.stringify(r[n])}" used in setUniforms() for key ${n}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),yn.time(UH,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),yn.timeEnd(UH,`linkProgram for ${this.id}`)(),yn.level,!this.device.features.has("compilation-status-async-webgl")){const n=this._getLinkStatus();this._reportLinkStatus(n);return}yn.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),yn.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const r=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${r}`)}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(yn.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let r=0,n=0;for(const i of this.shaderLayout.bindings){const a=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:s}=i,o=e.getUniformBlockIndex(this.handle,s);if(o===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),a instanceof V1?e.bindBufferBase(35345,n,a.handle):e.bindBufferRange(35345,n,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),n+=1;break;case"texture":if(!(a instanceof Rv||a instanceof $1||a instanceof U1))throw new Error("texture");let u;if(a instanceof Rv)u=a.texture;else if(a instanceof $1)u=a;else if(a instanceof U1&&a.colorAttachments[0]instanceof Rv)yn.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),u=a.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(u.glTarget,u.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:r,location:n,type:i,textureUnit:a}=e,s=this.uniforms[r]??a;s!==void 0&&c$e(this.device.gl,n,i,s)}}}function m$e(t,e){const r={...t,attributes:t.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=r.attributes.find(a=>a.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):yn.warn(`shader layout attribute ${n.name} not present in shader`)}return r}class y$e extends BL{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const r of e)switch(r.name){case"copy-buffer-to-buffer":v$e(this.device,r.options);break;case"copy-buffer-to-texture":_$e(this.device,r.options);break;case"copy-texture-to-buffer":b$e(this.device,r.options);break;case"copy-texture-to-texture":x$e(this.device,r.options);break;default:throw new Error(r.name)}}}function v$e(t,e){const r=e.sourceBuffer,n=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,n.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function _$e(t,e){throw new Error("Not implemented")}function b$e(t,e){const{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:a=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:u=[0,0],destinationBuffer:h,byteOffset:f=0,bytesPerRow:d,rowsPerImage:b}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||d||b)throw new Error("not implemented");const{framebuffer:v,destroyFramebuffer:S}=ore(r);let E;try{const P=h,k=a||v.width,L=s||v.height,N=Kte(v.colorAttachments[0].texture.props.format),M=N.format,z=N.type;t.gl.bindBuffer(35051,P.handle),E=t.gl.bindFramebuffer(36160,v.handle),t.gl.readPixels(u[0],u[1],k,L,M,z,f)}finally{t.gl.bindBuffer(35051,null),E!==void 0&&t.gl.bindFramebuffer(36160,E),S&&v.destroy()}}function x$e(t,e){const{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:s}=e;let{width:o=e.destinationTexture.width,height:u=e.destinationTexture.height}=e;const{framebuffer:h,destroyFramebuffer:f}=ore(r),[d,b]=i,[v,S,E]=a,P=t.gl.bindFramebuffer(36160,h.handle);let k=null,L;if(s instanceof $1)k=s,o=Number.isFinite(o)?o:k.width,u=Number.isFinite(u)?u:k.height,k.bind(0),L=k.glTarget;else throw new Error("invalid destination");switch(L){case 3553:case 34067:t.gl.copyTexSubImage2D(L,n,v,S,d,b,o,u);break;case 35866:case 32879:t.gl.copyTexSubImage3D(L,n,v,S,E,d,b,o,u);break}k&&k.unbind(),t.gl.bindFramebuffer(36160,P),f&&h.destroy()}function ore(t){if(t instanceof _o){const{width:e,height:r,id:n}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class w$e extends FL{device;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new y$e(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,n){}}function S$e(t){const{target:e,source:r,start:n=0,count:i=1}=t,a=r.length,s=i*a;let o=0;for(let u=n;o<a;o++)e[u++]=r[o];for(;o<s;)o<s-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+s-o),o=s);return t.target}class hD extends zL{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return jDe()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){const n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:a,stride:s,offset:o,normalized:u,integer:h,divisor:f}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),h?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,u,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,f||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){const r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);const n=Zte(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){const i=hD.isConstantAttributeZeroSupported(this.device)||e!==0;(r||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){const n=E$e(r),i=n.byteLength*e,a=n.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s=s||!T$e(n,this.bufferValue),s){const o=CBe(r.constructor,a);S$e({target:o,source:n,start:0,count:a}),this.buffer.write(o),this.bufferValue=r}return this.buffer}}function E$e(t){return Array.isArray(t)?new Float32Array(t):t}function T$e(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}class C$e extends jL{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(p$e(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){const n=this._getVaryingIndex(e),{buffer:i,byteLength:a,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[e]=i,yn.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[n]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,a)}getBuffer(e){if(VH(e))return this.buffers[e]||null;const r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof V1)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:r,byteOffset:n=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(e){if(VH(e))return Number(e);for(const r of this.layout.varyings)if(e===r.name)return r.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,i,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,n=0,i){const a=r&&r.handle;!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,n,i)}}function VH(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class A$e extends UL{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{const a=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}class Ov extends Gp{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||PVe("webgl-device")});const r=Gp._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new vVe(this,r),this.lost=new Promise(f=>{this._resolveContextLost=f});const i={...e.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const s=this.props._handle||JUe(this.canvasContext.canvas,{onContextLost:f=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:f=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n){if(e._reuseDevices)return yn.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=s,this.gl=s,this.spectorJS=xVe({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=QUe(this.gl,this._extensions),this.limits=new gVe(this.gl),this.features=new pVe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new fm(this.gl,{log:(...f)=>yn.log(1,...f)()}).trackState(this.gl,{copyState:!1});const u=e.debugWebGL||e.debug,h=e.debugWebGL;u&&(this.gl=EVe(this.gl,{debugWebGL:u,traceWebGL:h}),yn.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(yn.level=Math.max(yn.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const r=this._normalizeBufferProps(e);return new V1(this,r)}createTexture(e){return new $1(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new pR(this,e)}createShader(e){return new OVe(this,e)}createFramebuffer(e){return new U1(this,e)}createVertexArray(e){return new hD(this,e)}createTransformFeedback(e){return new C$e(this,e)}createQuerySet(e){return new A$e(this,e)}createRenderPipeline(e){return new g$e(this,e)}beginRenderPass(e){return new JVe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new w$e(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,r){return GVe(e,r)}readPixelsToBufferWebGL(e,r){return XVe(e,r)}setParametersWebGL(e){H0(this.gl,e)}getParametersWebGL(e){return Xte(this.gl,e)}withParametersWebGL(e,r){return EE(this.gl,e,r)}resetWebGL(){yn.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),GUe(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return cVe(this.gl,e,this._extensions)}loseDevice(){let e=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(e=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){fm.get(this.gl).push()}popState(){fm.get(this.gl).pop()}setSpectorMetadata(e,r){e.__SPECTOR_Metadata=r}getGLKey(e,r){const n=Number(e);for(const i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){const r={emptyIfUnknown:!0};return Object.entries(e).reduce((n,[i,a])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${a}:${this.getGLKey(a,r)}`,n),{})}_constants;setConstantAttributeWebGL(e,r){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[e];switch(i&&M$e(i,r)&&yn.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:I$e(this,e,r);break;case Int32Array:P$e(this,e,r);break;case Uint32Array:k$e(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return E0(this.gl,e,this._extensions),this._extensions}}function I$e(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break}}function P$e(t,e,r){t.gl.vertexAttribI4iv(e,r)}function k$e(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function M$e(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}const R$e={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},O$e=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),N$e=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),L$e=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function D$e(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&F$e(i),i}return this.originalGetContext(r,n)}}function F$e(t){t.getExtension("EXT_color_buffer_float");const e={...R$e,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:O$e(t),OES_vertex_array_object:N$e(t),ANGLE_instanced_arrays:L$e(t)},r=t.getExtension;t.getExtension=function(i){const a=r.call(t,i);return a||(i in e?e[i]:null)};const n=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(n.apply(t)||[])?.concat(Object.keys(e))}}const tw=1;class B$e extends rBe{type="webgl";constructor(){super(),Gp.defaultProps={...Gp.defaultProps,...cD},Ov.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(e){D$e(e)}async attach(e){if(e instanceof Ov)return e;if(e?.device instanceof Gp)return e.device;if(!z$e(e))throw new Error("Invalid WebGL2RenderingContext");return new Ov({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){yn.groupCollapsed(tw,"WebGLDevice created")();const r=[];(e.debugWebGL||e.debug)&&r.push(SVe()),e.debugSpectorJS&&r.push(bVe(e));const n=await Promise.allSettled(r);for(const s of n)s.status==="rejected"&&yn.error(`Failed to initialize debug libraries ${s.reason}`)();const i=new Ov(e),a=`${i._reused?"Reusing":"Created"} device with WebGL2 ${i.debug?"debug ":""}context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return yn.probe(tw,a)(),yn.table(tw,i.info)(),yn.groupEnd(tw)(),i}}function z$e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const $H=new B$e;function Ip(){}const j$e=({isDragging:t})=>t?"grabbing":"grab",sre={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Ip,onWebGLInitialized:Ip,onResize:Ip,onViewStateChange:Ip,onInteractionStateChange:Ip,onBeforeRender:Ip,onAfterRender:Ip,onLoad:Ip,onError:t=>Xa.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:j$e,getTooltip:null,debug:!1,drawPickingColors:!1};class Rb{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new KT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const a=n.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=aR[n.type],a=n.offsetCenter;if(!i||!a||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:s,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:u}=o,h=u&&(u[i]||u.props[i]),f=this.props[i];let d=!1;h&&(d=h.call(u,o,n)),d||(f?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...sre,...e},e=this.props,e.viewState&&e.initialViewState&&Xa.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;!r&&e.gl&&(e.gl instanceof WebGLRenderingContext&&Xa.error("WebGL1 context not supported.")(),r=$H.attach(e.gl)),r||(r=YM.createDevice({type:"best-available",_reuseDevices:!0,adapters:[$H],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&Mb.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Xa.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Xa.removed("onLayerClick","onClick")(),e.initialViewState&&!Sc(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||n||i||a||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Ll(this.viewManager),this.viewManager.views}getViewports(e){return Ll(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:r})}_removeResources(e){for(const r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,n){Ll(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),a}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),Ll(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;const{width:r,height:n}=e;if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const r=e.clientWidth??e.width,n=e.clientHeight??e.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(e,r){const{gl:n,onError:i,useDevicePixels:a}=r;return new q7e({device:e,useDevicePixels:a,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new oD({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=n,a=!1;for(const s of r)i=s,a=s.layer?.onHover(s,e.event)||a;a||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const r=new Fte;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new vje(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(cH).map(i=>{const[a,s,o,u]=cH[i],h=this.props.eventRecognizerOptions?.[i],f={...s,...h,event:i};return{recognizer:new a(f),recognizeWith:o,requestFailure:u}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in aR)this.eventManager.on(i,this._onEvent);this.viewManager=new gUe({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new pUe(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new PUe({deck:this,device:this.device}),this.deckRenderer=new RUe(this.device),this.deckPicker=new BUe(this.device),this.widgetManager=new UUe({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new $Ue),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Xa.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();const n=YM.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}Rb.defaultProps=sre;Rb.VERSION=s8e;function U$e(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Lee(t)}}const V$e=Nee;function rw(t,e,r){const n=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function em(t){return t.stride||t.size*t.bytesPerElement}function $$e(t,e){return t.type===e.type&&t.size===e.size&&em(t)===em(e)&&(t.offset||0)===(e.offset||0)}function gR(t,e){e.offset&&Xa.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=em(t),n=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=n*r+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:r}}function q$e(t,e){const r=gR(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}class H$e{constructor(e,r,n){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;const i=r.logicalType||r.type,a=i==="float64";let{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let o;a?o="float32":!i&&r.isIndexed?o="uint32":o=i||"float32";let u=U$e(i||o);this.doublePrecision=a,a&&r.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...r,defaultType:u,defaultValue:s,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*em(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Mb.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){const n={};if(this.state.constant){const i=this.value;if(r){const a=gR(this.getAccessor(),r),s=a.offset/i.BYTES_PER_ELEMENT,o=a.size||this.size;n[e]=i.subarray(s,s+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,r=null){const n=this.getAccessor(),i=[],a={name:this.id,byteStride:em(n),attributes:i};if(this.doublePrecision){const s=q$e(n,r||{});i.push(rw(e,{...n,...s.high},this.device.type),rw(`${e}64Low`,{...n,...s.low},this.device.type))}else if(r){const s=gR(n,r);i.push(rw(e,{...n,...s},this.device.type))}else i.push(rw(e,n,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const r=Array.from(this.value);e=[r,r]}else{const{value:r,numInstances:n,size:i}=this,a=n*i;if(r&&a&&r.length>=a){const s=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let u=0;u<a;)for(let h=0;h<i;h++){const f=r[u++];f<s[h]&&(s[h]=f),f>o[h]&&(o[h]=f)}e=[s,o]}}return this.state.bounds=e,e}setData(e){const{state:r}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof Fo?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const s=V$e(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=em(i)}if(r.bounds=null,n.constant){let a=n.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!r.constant||!this._areValuesEqual(a,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(n.buffer){const a=n.buffer;r.externalBuffer=a,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let a=n.value;r.externalBuffer=null,r.constant=!1,this.value=a;let{buffer:s}=this;const o=em(i),u=(i.vertexOffset||0)*o;if(this.doublePrecision&&a instanceof Float64Array&&(a=QI(a,i)),this.settings.isIndexed){const f=this.settings.defaultType;a.constructor!==f&&(a=new f(a))}const h=a.byteLength+u+o*2;(!s||s.byteLength<h)&&(s=this._createBuffer(h)),s.write(a,u)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const r=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?QI(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){const{state:n}=this,i=n.allocatedValue,a=Mb.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=a;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<a.byteLength+s)&&(o=this._createBuffer(a.byteLength+s),r&&i&&o.write(i instanceof Float64Array?QI(i,this):i,s)),n.allocatedValue=a,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in e)&&Xa.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,n){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return r[n]=e,r;if(!e){let s=a;for(;--s>=0;)r[n+s]=i[s];return r}switch(a){case 4:r[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:r[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:r[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:r[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=a;for(;--s>=0;)r[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?Fo.INDEX:Fo.VERTEX)|Fo.COPY_DST,indexType:r?n:void 0,byteLength:e}),this._buffer}}const qH=[],HH=[];function lre(t,e=0,r=1/0){let n=qH;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?n=t:t.length>0&&(HH.length=t.length,n=HH):n=qH,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}function ure(t){return t&&t[Symbol.asyncIterator]}function W$e(t,e){const{size:r,stride:n,offset:i,startIndices:a,nested:s}=e,o=t.BYTES_PER_ELEMENT,u=n?n/o:r,h=i?i/o:0,f=Math.floor((t.length-h)/u);return(d,{index:b,target:v})=>{if(!a){const k=b*u+h;for(let L=0;L<r;L++)v[L]=t[k+L];return v}const S=a[b],E=a[b+1]||f;let P;if(s){P=new Array(E-S);for(let k=S;k<E;k++){const L=k*u+h;v=new Array(r);for(let N=0;N<r;N++)v[N]=t[L+N];P[k-S]=v}}else if(u===r)P=t.subarray(S*r+h,E*r+h);else{P=new t.constructor((E-S)*r);let k=0;for(let L=S;L<E;L++){const N=L*u+h;for(let M=0;M<r;M++)P[k++]=t[N+M]}}return P}}const G$e=[],Fw=[[0,1/0]];function X$e(t,e){if(t===Fw||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const r=[],n=t.length;let i=0;for(let a=0;a<n;a++){const s=t[a];s[1]<e[0]?(r.push(s),i=a+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(i,0,e),r}const Y$e={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function cre(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const r=t.type||"interpolation";return{...Y$e[r],...e,...t,type:r}}class hre extends H$e{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Fw}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!$$e(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?e[r.find(a=>e[a])]:e[r];return cre(i,n)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){const{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=X$e(this.state.updateRanges,[n,i])}else this.state.updateRanges=Fw}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=G$e}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,r.updateRanges!==Fw),!0):!1}updateBuffer({numInstances:e,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:s,noAlloc:o}}=this;let u=!0;if(s){for(const[h,f]of a)s.call(i,this,{data:r,startRow:h,endRow:f,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[h,f]of a){const d=Number.isFinite(h)?this.getVertexOffset(h):0,b=Number.isFinite(f)?this.getVertexOffset(f):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:b})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e){return this.device.type==="webgpu"||e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;Ll(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);const o=!!s.size&&s.size!==this.size;return n.binaryAccessor=W$e(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(const n in e)Object.assign(r,super.getValue(n,e[n]));return r}getBufferLayout(e){this.state.layoutChanged=!1;const r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(const a in r){const s=super._getBufferLayout(a,r[a]);n.attributes.push(...s.attributes)}return n}_autoUpdater(e,{data:r,startRow:n,endRow:i,props:a,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:u,value:h,size:f,startIndices:d}=e,{accessor:b,transform:v}=o;let S=u.binaryAccessor||(typeof b=="function"?b:a[b]);typeof S!="function"&&(S=()=>S),Ll(typeof S=="function",`accessor "${b}" is not a function`);let E=e.getVertexOffset(n);const{iterable:P,objectInfo:k}=lre(r,n,i);for(const L of P){k.index++;let N=S(L,k);if(v&&(N=v.call(this,N)),d){const M=(k.index<d.length-1?d[k.index+1]:s)-d[k.index];if(N&&Array.isArray(N[0])){let z=E;for(const B of N)e._normalizeValue(B,h,z),z+=f}else N&&N.length>f?h.set(N,E):(e._normalizeValue(N,k.target,0),uUe({target:h,source:k.target,start:E,count:M}));E+=M*f}else e._normalizeValue(N,h,E),E+=f}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function uP(t){const{source:e,target:r,start:n=0,size:i,getData:a}=t,s=t.end||r.length,o=e.length,u=s-n;if(o>u){r.set(e.subarray(0,u),n);return}if(r.set(e,n),!a)return;let h=o;for(;h<u;){const f=a(h,e);for(let d=0;d<i;d++)r[n+h]=f[d]||0,h++}}function Z$e({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return uP({source:t,target:e,size:r,getData:n}),e;let s=0,o=0;const u=n&&((f,d)=>n(f+o,d)),h=Math.min(i.length,a.length);for(let f=1;f<h;f++){const d=i[f]*r,b=a[f]*r;uP({source:t.subarray(s,d),target:e,start:o,end:b,size:r,getData:u}),s=d,o=b}return o<e.length&&uP({source:[],target:e,start:o,size:r,getData:u}),e}function K$e(t){const{device:e,settings:r,value:n}=t,i=new hre(e,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function fre(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function dre(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function pre(t){t.push(t.shift())}function J$e(t,e){const{doublePrecision:r,settings:n,value:i,size:a}=t,s=r&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:u}=t.settings;if(u)for(const h of Object.values(u))o=Math.max(o,h.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*a)*s}function gre({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function mre({device:t,buffer:e,attribute:r,fromLength:n,toLength:i,fromStartIndices:a,getData:s=o=>o}){const o=r.doublePrecision&&r.value instanceof Float64Array?2:1,u=r.size*o,h=r.byteOffset,f=r.settings.bytesPerElement<4?h/r.settings.bytesPerElement*4:h,d=r.startIndices,b=a&&d,v=r.isConstant;if(!b&&e&&n>=i)return e;const S=r.value instanceof Float64Array?Float32Array:r.value.constructor,E=v?r.value:new S(r.getBuffer().readSyncWebGL(h,i*S.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!v){const N=s;s=(M,z)=>r.normalizeConstant(N(M,z))}const P=v?(N,M)=>s(E,M):(N,M)=>s(E.subarray(N+h,N+h+u),M),k=e?new Float32Array(e.readSyncWebGL(f,n*4).buffer):new Float32Array(0),L=new Float32Array(i);return Z$e({source:k,target:L,sourceStartIndices:a,targetStartIndices:d,size:u,getData:P}),(!e||e.byteLength<L.byteLength+f)&&(e?.destroy(),e=t.createBuffer({byteLength:L.byteLength+f,usage:35050})),e.write(L,f),e}class yre{constructor({device:e,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new aC(n),this.attribute=r,this.attributeInTransition=K$e(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=J$e(this.attribute,r),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class Q$e extends yre{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="interpolation",this.transform=nqe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:s}=this;pre(a),a[0]=mre({device:this.device,buffer:a[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=gre({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:o}=this,u=o.model;let h=Math.floor(this.currentLength/s.size);vre(s)&&(h/=2),u.setVertexCount(h),s.isConstant?(u.setAttributes({aFrom:a[0]}),u.setConstantAttributes({aTo:s.value})):u.setAttributes({aFrom:a[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:r}=this.settings,{time:n}=this.transition;let i=n/e;r&&(i=r(i));const{model:a}=this.transform,s={time:i};a.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const eqe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,WH={name:"interpolation",vs:eqe,uniformTypes:{time:"f32"}},tqe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,rqe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function vre(t){return t.doublePrecision&&t.value instanceof Float64Array}function nqe(t,e){const r=e.size,n=fre(r),i=dre(r),a=e.getBufferLayout();return vre(e)?new Lm(t,{vs:rqe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[h9e,WH],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Lm(t,{vs:tqe,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[WH],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class iqe extends yre{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="spring",this.texture=cqe(e),this.framebuffer=hqe(e,this.texture),this.transform=uqe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;super.start(e,r);const{buffers:a,attribute:s}=this;for(let u=0;u<2;u++)a[u]=mre({device:this.device,buffer:a[u],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=gre({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:r,framebuffer:n,transition:i}=this,a=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:a.stiffness,damping:a.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),pre(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const aqe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,oqe={name:"spring",vs:aqe,uniformTypes:{damping:"f32",stiffness:"f32"}},sqe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,lqe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function uqe(t,e){const r=fre(e.size),n=dre(e.size);return new Lm(t,{vs:sqe,fs:lqe,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[oqe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function cqe(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function hqe(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const fqe={interpolation:Q$e,spring:iqe};class dqe{constructor(e,{id:r,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:n}){this.numInstances=n||1;for(const i in e){const a=e[i],s=a.getTransitionSetting(r);s&&this._updateAttribute(i,a,s)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(e){const r=this.transitions[e];return r&&r.inProgress}getAttributes(){const e={};for(const r in this.transitions){const n=this.transitions[r];n.inProgress&&(e[r]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,n){const i=this.transitions[e];let a=!i||i.type!==n.type;if(a){i&&this._removeTransition(e);const s=fqe[n.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(Xa.error(`unsupported transition type '${n.type}'`)(),a=!1)}(a||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const GH="attributeManager.invalidate",pqe="attributeManager.updateStart",gqe="attributeManager.updateEnd",mqe="attribute.updateStart",yqe="attribute.allocate",vqe="attribute.updateEnd";class _re{constructor(e,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=_x(M7e),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new dqe(e,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){const n=this._invalidateTrigger(e,r);Hu(GH,this,e,n)}invalidateAll(e){for(const r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);Hu(GH,this,"all")}update({data:e,numInstances:r,startIndices:n=null,transitions:i,props:a={},buffers:s={},context:o={}}){let u=!1;Hu(pqe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const h in this.attributes){const f=this.attributes[h],d=f.settings.accessor;f.startIndices=n,f.numInstances=r,a[h]&&Xa.removed(`props.${h}`,`data.attributes.${h}`)(),f.setExternalBuffer(s[h])||f.setBinaryValue(typeof d=="string"?s[d]:void 0,e.startIndices)||typeof d=="string"&&!s[d]&&f.setConstantValue(a[d])||f.needsUpdate()&&(u=!0,this._updateAttribute({attribute:f,numInstances:r,data:e,props:a,context:o})),this.needsRedraw=this.needsRedraw||f.needsRedraw()}u&&Hu(gqe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const r=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const a in r){const s=r[a];s.needsRedraw(e)&&!n.hasAttribute(a)&&(i[a]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(const n in e){const i=e[n],a={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new hre(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){const{attributes:n,updateTriggers:i}=this,a=i[e];return a&&a.forEach(s=>{const o=n[s];o&&o.setNeedsUpdate(o.id,r)}),a}_updateAttribute(e){const{attribute:r,numInstances:n}=e;if(Hu(mqe,r),r.constant){r.setConstantValue(r.value);return}r.allocate(n)&&Hu(yqe,r,n),r.updateBuffer(e)&&(this.needsRedraw=!0,Hu(vqe,r,n))}}class _qe extends aC{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:r,toValue:n,duration:i,easing:a}}=this,s=a(e/i);this._value=_E(r,n,s)}}const XH=1e-5;function YH(t,e,r,n,i){const a=e-t,o=(r-e)*i,u=-a*n;return o+u+a+e}function bqe(t,e,r,n,i){if(Array.isArray(r)){const a=[];for(let s=0;s<r.length;s++)a[s]=YH(t[s],e[s],r[s],n,i);return a}return YH(t,e,r,n,i)}function ZH(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}class xqe extends aC{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:s=e}=this;let o=bqe(a,s,r,n,i);const u=ZH(o,r),h=ZH(o,s);u<XH&&h<XH&&(o=r,this.end()),this._prevValue=s,this._currValue=o}}const wqe={interpolation:_qe,spring:xqe};class Sqe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,n,i){const{transitions:a}=this;if(a.has(e)){const u=a.get(e),{value:h=u.settings.fromValue}=u;r=h,this.remove(e)}if(i=cre(i),!i)return;const s=wqe[i.type];if(!s){Xa.error(`unsupported transition type '${i.type}'`)();return}const o=new s(this.timeline);o.start({...i,fromValue:r,toValue:n}),a.set(e,o)}remove(e){const{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){const e={};for(const[r,n]of this.transitions)n.update(),e[r]=n.value,n.inProgress||this.remove(r);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Eqe(t){const e=t[Yp];for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function Tqe(t,e){const r=bre({newProps:t,oldProps:e,propTypes:t[Yp],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=Aqe(t,e);let i=!1;return n||(i=Iqe(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:Pqe(t,e),transitionsChanged:Cqe(t,e)}}function Cqe(t,e){if(!t.transitions)return!1;const r={},n=t[Yp];let i=!1;for(const a in t.transitions){const s=n[a],o=s&&s.type;(o==="number"||o==="color"||o==="array")&&mR(t[a],e[a],s)&&(r[a]=!0,i=!0)}return i?r:!1}function bre({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(t))if(!(a in r)){if(!(a in e))return`${i}.${a} added`;const s=mR(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}for(const a of Object.keys(e))if(!(a in r)){if(!(a in t))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(t,a)){const s=mR(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}}return!1}function mR(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)||!n&&(n=t&&e&&t.equals,n&&!n.call(t,e))?"changed deeply":!n&&e!==t?"changed shallowly":null}function Aqe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1;const{dataComparator:n,_dataDiff:i}=t;return n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&i&&(r=i(t.data,e.data)||r),r}function Iqe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&KH(t,e,"all"))return{all:!0};const r={};let n=!1;for(const i in t.updateTriggers)i!=="all"&&KH(t,e,i)&&(r[i]=!0,n=!0);return n?r:!1}function Pqe(t,e){if(e===null)return!0;const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function KH(t,e,r){let n=t.updateTriggers[r];n=n??{};let i=e.updateTriggers[r];return i=i??{},bre({oldProps:i,newProps:n,triggerName:r})}const kqe="count(): argument not an object",Mqe="count(): argument not a container";function Rqe(t){if(!Nqe(t))throw new Error(kqe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Oqe(t))return Object.keys(t).length;throw new Error(Mqe)}function Oqe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Nqe(t){return t!==null&&typeof t=="object"}function JH(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{const n={...t.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];r.inject=n}return r}const Lqe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},yR={};function Dqe(t,e,r,n){if(r instanceof _o)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});const a=e.createTexture({...r,sampler:{...Lqe,...i,...n},mipmaps:!0});return yR[a.id]=t,a}function Fqe(t,e){!e||!(e instanceof _o)||yR[e.id]===t&&(e.delete(),delete yR[e.id])}const Bqe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||vR(t)&&(t.length===3||t.length===4)},equal(t,e,r){return Sc(t,e,1)}},accessor:{validate(t,e){const r=TE(t);return r==="function"||r===TE(e.value)},equal(t,e,r){return typeof e=="function"?!0:Sc(t,e,1)}},array:{validate(t,e){return e.optional&&!t||vR(t)},equal(t,e,r){const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Sc(t,e,i):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Sc(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;const{dataTransform:n}=r.props;return n?n(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{const n=r.context;return!n||!n.device?null:Dqe(r.id,n.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{Fqe(r.id,t)}}};function zqe(t){const e={},r={},n={};for(const[i,a]of Object.entries(t)){const s=a?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{const o=jqe(i,a);e[i]=o,r[i]=o.value}}return{propTypes:e,defaultProps:r,deprecatedProps:n}}function jqe(t,e){switch(TE(e)){case"object":return $_(t,e);case"array":return $_(t,{type:"array",value:e,compare:!1});case"boolean":return $_(t,{type:"boolean",value:e});case"number":return $_(t,{type:"number",value:e});case"function":return $_(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function $_(t,e){return"type"in e?{name:t,...Bqe[e.type],...e}:"value"in e?{name:t,type:TE(e.value),...e}:{name:t,type:"object",value:e}}function vR(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function TE(t){return vR(t)?"array":t===null?"null":typeof t}function Uqe(t,e){let r;for(let a=e.length-1;a>=0;a--){const s=e[a];"extensions"in s&&(r=s.extensions)}const n=_R(t.constructor,r),i=Object.create(n);i[SE]=t,i[Dm]={},i[Vp]={};for(let a=0;a<e.length;++a){const s=e[a];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}const Vqe="_mergedDefaultProps";function _R(t,e){if(!(t instanceof oC.constructor))return{};let r=Vqe;if(e)for(const i of e){const a=i.constructor;a&&(r+=`:${a.extensionName||a.name}`)}const n=xre(t,r);return n||(t[r]=$qe(t,e||[]))}function $qe(t,e){if(!t.prototype)return null;const n=Object.getPrototypeOf(t),i=_R(n),a=xre(t,"defaultProps")||{},s=zqe(a),o=Object.assign(Object.create(null),i,s.defaultProps),u=Object.assign(Object.create(null),i?.[Yp],s.propTypes),h=Object.assign(Object.create(null),i?.[iP],s.deprecatedProps);for(const f of e){const d=_R(f.constructor);d&&(Object.assign(o,d),Object.assign(u,d[Yp]),Object.assign(h,d[iP]))}return qqe(o,t),Wqe(o,u),Hqe(o,h),o[Yp]=u,o[iP]=h,e.length===0&&!fD(t,"_propTypes")&&(t._propTypes=u),o}function qqe(t,e){const r=Xqe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function Hqe(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(n){const i=`${this.id}: ${r}`;for(const a of e[r])fD(this,a)||(this[a]=n);Xa.deprecated(i,e[r].join("/"))()}})}function Wqe(t,e){const r={},n={};for(const i in e){const a=e[i],{name:s,value:o}=a;a.async&&(r[s]=o,n[s]=Gqe(s))}t[Gv]=r,t[Dm]={},Object.defineProperties(t,n)}function Gqe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||ure(e)?this[Dm][t]=e:this[Vp][t]=e},get(){if(this[Vp]){if(t in this[Vp])return this[Vp][t]||this[Gv][t];if(t in this[Dm]){const e=this[SE]&&this[SE].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Gv][t]}}return this[Gv][t]}}}function fD(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xre(t,e){return fD(t,e)&&t[e]}function Xqe(t){const e=t.componentName;return e||Xa.warn(`${t.name}.componentName not specified`)(),e||t.name}let Yqe=0;class oC{constructor(...e){this.props=Uqe(this,e),this.id=this.props.id,this.count=Yqe++}clone(e){const{props:r}=this,n={};for(const i in r[Gv])i in r[Vp]?n[i]=r[Vp][i]:i in r[Dm]&&(n[i]=r[Dm][i]);return new this.constructor({...r,...n,...e})}}oC.componentName="Component";oC.defaultProps={};const Zqe=Object.freeze({});class Kqe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Zqe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){const r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(const r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[SE]||this.component;const r=e[Vp]||{},n=e[Dm]||e,i=e[Gv]||{};for(const a in r){const s=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s),r[a]=this.getAsyncProp(a)}for(const a in n){const s=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(ure(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){const n=this.asyncProps[e];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,r,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;r.then(a=>{this.component&&(a=this._postProcessValue(n,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let a=[],s=0;for await(const o of r){if(!this.component)return;const{dataTransform:u}=this.component.props;u?a=u(o,a):a=a.concat(o),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:s,endRow:a.length}]}),s=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,r){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Yp];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}}class Jqe extends Kqe{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){const n=this.layer,i=n?.props.fetch;return i?i(r,{propName:e,layer:n}):super._fetch(e,r)}_onResolve(e,r){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(r,{propName:e,layer:n})}}_onError(e,r){const n=this.layer;n&&n.raiseError(r,`loading ${e} of ${this.layer}`)}}const Qqe="layer.changeFlag",eHe="layer.initialize",tHe="layer.update",rHe="layer.finalize",nHe="layer.matched",QH=2**24-1,iHe=Object.freeze([]),aHe=_x(({oldViewport:t,viewport:e})=>t.equals(e));let Xh=new Uint8ClampedArray(0);const oHe={data:{type:"data",value:iHe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:a})=>{const{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,a&&(i={...i,fetch:{...i?.fetch,signal:a}});let o=s.contains(t);return!o&&!i&&(s.add({resourceId:t,data:$M(t,n),persistent:!1}),o=!0),o?s.subscribe({resourceId:t,onChange:u=>r.internalState?.reloadAsyncProp(e,u),consumerId:r.id,requestId:e}):$M(t,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ua.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class sC extends oC{constructor(){super(...arguments),this.internalState=null,this.lifecycle=mv.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Ll(this.internalState);const r=this.internalState.viewport||this.context.viewport,n=Dte(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,s]=Rte(n,r.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,s]}unproject(e){return Ll(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){Ll(this.internalState);const n=this.internalState.viewport||this.context.viewport;return F7e(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ua.DEFAULT||e===Ua.LNGLAT||e===Ua.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){Ll(e instanceof Uint8Array);const[r,n,i]=e;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Rqe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=JH(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const r of this.props.extensions)e=JH(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const r=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&r)if(Array.isArray(n))for(const i of n)r.invalidateAll(i);else r.invalidateAll();if(r){const{props:i}=e,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:o,instancePickingColors:u}=r.attributes,h=o||u;h&&(s&&h.constant&&(h.constant=!1,r.invalidate(h.id)),!h.value&&!s&&(h.constant=!0,h.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const r=this.internalState.viewport;this.internalState.viewport=e,(!r||!aHe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(const n in e)e[n].layoutChanged()&&(r=!0);for(const n of this.getModels())this._setModelAttributes(n,e,r)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const r=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const r=e.update(),n=Object.create(this.props);for(const i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;const n=Math.floor(Xh.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>QH&&Xa.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xh=Mb.allocate(Xh,r,{size:4,copy:!0,maxCount:Math.max(r,QH)});const i=Math.floor(Xh.length/4),a=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,a),Xh[s*4+0]=a[0],Xh[s*4+1]=a[1],Xh[s*4+2]=a[2],Xh[s*4+3]=0}e.value=Xh.subarray(0,r*4)}_setModelAttributes(e,r,n=!1){if(!Object.keys(r).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),r=o.getAttributes()}const i=e.userData?.excludeAttributes||{},a={},s={};for(const o in r){if(i[o])continue;const u=r[o].getValue();for(const h in u){const f=u[h];f instanceof Fo?r[o].settings.isIndexed?e.setIndexBuffer(f):a[h]=f:f&&(s[h]=f)}}e.setAttributes(a),e.setConstantAttributes(s)}disablePickingIndex(e){const r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,a=n||i,s=a&&r.attributes&&r.attributes[a.id];if(s&&s.value){const o=s.value,u=this.encodePickingColor(e);for(let h=0;h<r.length;h++){const f=a.getVertexOffset(h);o[f]===u[0]&&o[f+1]===u[1]&&o[f+2]===u[2]&&this._disablePickingIndex(h)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;const a=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Xh.buffer&&(n.value=Xh.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ll(!this.internalState),Ll(Number.isFinite(this.props.coordinateSystem)),Hu(eHe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Jqe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Xa.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Sqe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Hu(nHe,this,this===e);const{state:r,internalState:n}=e;this!==e&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Hu(tHe,this,e),!e)return;const r=this.props,n=this.context,i=this.internalState,a=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||a,this.props=s;try{const o=this._getUpdateParams(),u=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const f of this.props.extensions)f.updateState.call(this,o,f);this.setNeedsRedraw(),this._updateAttributes();const h=this.getModels()[0]!==u[0];this._postUpdate(o,h)}finally{n.viewport=a,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Hu(rHe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;try{r&&this.setShaderModuleProps(r);const{getPolygonOffset:o}=this.props,u=o&&o(n)||[0,0];s.device instanceof Ov&&s.device.setParametersWebGL({polygonOffset:u});for(const h of this.getModels())h.device.type==="webgpu"?h.setParameters({...h.parameters,...i}):h.setParameters(i);if(s.device instanceof Ov)s.device.withParametersWebGL(i,()=>{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const f of this.props.extensions)f.draw.call(this,h,f);this.draw(h)});else{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const f of this.props.extensions)f.draw.call(this,h,f);this.draw(h)}}finally{this.props=a}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:r}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const s=e[i],o=r[i];s&&Array.isArray(o)&&(r.dataChanged=Array.isArray(s)?o.concat(s):s,a=!0);default:r[i]||(r[i]=e[i],a=!0)}a&&Hu(Qqe,this,i,e)}const n=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){const n=Tqe(e,r);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){Eqe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(r.highlightColor=n(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new _re(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){const{props:n,oldProps:i}=e,a=this.state.model;a?.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:u}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==u){const h={};Array.isArray(u)&&(h.highlightColor=u),(r||i.autoHighlight!==s||o!==i.highlightedObjectIndex)&&(h.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:h})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(r=r||i,r)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}sC.defaultProps=oHe;sC.layerName="Layer";const sHe="compositeLayer.renderLayers";class wre extends sC{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:r}=e;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(e.object=r.__source.object,e.index=r.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,r){return r&&r.length}getSubLayerClass(e,r){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||r}getSubLayerRow(e,r,n){return e.__source={parent:this,object:r,index:n},e}getSubLayerAccessor(e){if(typeof e=="function"){const r={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(r.index=n.__source.index,e(n.__source.object,r)):e(n,i)}return e}getSubLayerProps(e={}){const{opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:u,highlightColor:h,coordinateSystem:f,coordinateOrigin:d,wrapLongitude:b,positionFormat:v,modelMatrix:S,extensions:E,fetch:P,operation:k,_subLayerProps:L}=this.props,N={id:"",updateTriggers:{},opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:u,highlightColor:h,coordinateSystem:f,coordinateOrigin:d,wrapLongitude:b,positionFormat:v,modelMatrix:S,extensions:E,fetch:P,operation:k},M=L&&e.id&&L[e.id],z=M&&M.updateTriggers,B=e.id||"sublayer";if(M){const q=this.props[Yp],W=e.type?e.type._propTypes:{};for(const G in M){const ie=W[G]||q[G];ie&&ie.type==="accessor"&&(M[G]=this.getSubLayerAccessor(M[G]))}}Object.assign(N,e,M),N.id=`${this.props.id}-${B}`,N.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...z};for(const q of E){const W=q.getSubLayerProps.call(this,q);W&&Object.assign(N,W,{updateTriggers:Object.assign(N.updateTriggers,W.updateTriggers)})}return N}_updateAutoHighlight(e){for(const r of this.getSubLayers())r.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,r){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const a=this.renderLayers();n=S0(a,Boolean),this.internalState.subLayers=n}Hu(sHe,this,i,n);for(const a of n)a.parent=this}}wre.layerName="CompositeLayer";const nw=Math.PI/180,eW=180/Math.PI,Bw=6370972,Nv=256;function lHe(){const t=Nv/Bw,e=Math.PI/180*Nv;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class uHe extends Qm{constructor(e={}){const{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:a=1,resolution:s=10}=e;let{latitude:o=0,height:u,altitude:h=1.5,fovy:f}=e;o=Math.max(Math.min(o,Up),-Up),u=u||1,f?h=eD(f):f=kb(h);const d=1/Math.PI/Math.cos(o*Math.PI/180),b=Math.pow(2,n)*d,v=e.nearZ??i,S=e.farZ??(h+Nv*2*b/u)*a,E=new hf().lookAt({eye:[0,-h,0],up:[0,0,1]});E.rotateX(o*nw),E.rotateZ(-r*nw),E.scale(b/u),super({...e,height:u,viewMatrix:E,longitude:r,latitude:o,zoom:n,distanceScales:lHe(),fovy:f,focalDistance:h,near:v,far:S}),this.scale=b,this.latitude=o,this.longitude=r,this.resolution=s}get projectionMode(){return Qc.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),a=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return a[0]<this.longitude&&(a[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],a[0],i[0],s[0]),Math.min(n[1],a[1],i[1],s[1]),Math.max(n[0],a[0],i[0],s[0]),Math.max(n[1],a[1],i[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,{pixelUnprojectionMatrix:u}=this;let h;if(Number.isFinite(s))h=cP(u,[i,o,s,1]);else{const v=cP(u,[i,o,-1,1]),S=cP(u,[i,o,1,1]),E=((n||0)/Bw+1)*Nv,P=WI(ste([],v,S)),k=WI(v),L=WI(S),M=4*((4*k*L-(P-k-L)**2)/16)/P,z=Math.sqrt(k-M),B=Math.sqrt(Math.max(0,E*E-M)),q=(z-B)/Math.sqrt(P);h=Mze([],v,S,q)}const[f,d,b]=this.unprojectPosition(h);return Number.isFinite(s)?[f,d,b]:Number.isFinite(n)?[f,d,n]:[f,d]}projectPosition(e){const[r,n,i=0]=e,a=r*nw,s=n*nw,o=Math.cos(s),u=(i/Bw+1)*Nv;return[Math.sin(a)*o*u,-Math.cos(a)*o*u,Math.sin(s)*u]}unprojectPosition(e){const[r,n,i]=e,a=Bze(e),s=Math.asin(i/a),u=Math.atan2(r,-n)*eW,h=s*eW,f=(a/Nv-1)*Bw;return[u,h,f]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,r){const n=this.unproject(r);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function cP(t,e){const r=q0([],e,t);return cte(r,r,1/r[3]),r}class cHe extends Hte{applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=Gf(i,n,r);const{longitude:a,latitude:s}=e;return(a<-180||a>180)&&(e.longitude=A7e(a+180,360)-180),e.latitude=Gf(s,-Up,Up),e}}class hHe extends qte{constructor(){super(...arguments),this.ControllerState=cHe,this.transition={transitionDuration:300,transitionInterpolator:new aD(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class Sre extends $te{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?Om:uHe}get ControllerType(){return hHe}}Sre.displayName="GlobeView";const hP=512,fHe=Math.PI/180;function Ere({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;const n=r?.props._customRender,i=r?.props.onLoad,a={...r?.props,_customRender:()=>{t.triggerRepaint(),n?.("")}};a.parameters={...bR(t,!0),...a.parameters},a.views||(a.views=CE(t));let s;return(!r||r.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:Ob(t)}),r?.isInitialized?tW(r,t):a.onLoad=()=>{i?.(),tW(s,t)}),r?(s=r,r.setProps(a),r.userData.isExternal=!0):(s=new Rb(a),t.on("remove",()=>{Tre(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&vHe(s,t)}),s}function tW(t,e){const r=()=>{t.isInitialized?_He(t,e):e.off("move",r)};e.on("move",r)}function Tre(t){t.__deck?.finalize(),t.__deck=null}function bR(t,e){const r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return Cre(t)==="globe"&&(r.cullMode="back"),r}function dHe(t,e){t.userData.mapboxLayers.add(e),dD(t)}function pHe(t,e){t.userData.mapboxLayers.delete(e),dD(t)}function gHe(t,e){dD(t)}function mHe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=Are(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:a,clearCanvas:!1})}function Cre(t){const e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function CE(t){return Cre(t)==="globe"?new Sre({id:"mapbox"}):new oD({id:"mapbox"})}function Ob(t){const{lng:e,lat:r}=t.getCenter(),n={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&yHe(t,n),n}function yHe(t,e){if(t.getFreeCameraOptions){const{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;const n=t.transform.height,{longitude:i,latitude:a,pitch:s}=e,o=r.x*hP,u=(1-r.y)*hP,h=r.z*hP,f=Pb([i,a]),d=o-f[0],b=u-f[1],v=Math.sqrt(d*d+b*b),S=s*fHe,E=1.5*n,P=S<.001?E*Math.cos(S)/h:E*Math.sin(S)/v;e.zoom=Math.log2(P);const k=E*Math.cos(S)/P,L=h-k;e.position=[0,0,L/Dw(a)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function Are(t,e,r){const n=Ob(e),i=CE(e);r&&(i.props.nearZMultiplier=.2);const a=r?.nearZ??e.transform._nearZ,s=r?.farZ??e.transform._farZ;return Number.isFinite(a)&&(n.nearZ=a/e.transform.height,n.farZ=s/e.transform.height),i.makeViewport({width:t.width,height:t.height,viewState:n})}function vHe(t,e){const{mapboxLayers:r,isExternal:n}=t.userData;if(n){const i=Array.from(r,f=>f.id),s=S0(t.props.layers,Boolean).some(f=>f&&!i.includes(f.id));let o=t.getViewports();const u=o.findIndex(f=>f.id==="mapbox"),h=o.length>1||u<0;(s||h)&&(u>=0&&(o=o.slice(),o[u]=Are(t,e)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:f=>(!t.props.layerFilter||t.props.layerFilter(f))&&(f.viewport.id!=="mapbox"||!i.includes(f.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function _He(t,e){t.setProps({viewState:Ob(e)}),t.needsRedraw({clearRedrawFlags:!0})}function dD(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(r=>{const n=r.props.type,i=new n(r.props);e.push(i)}),t.setProps({layers:e})}class bHe{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=Ere({map:e,gl:r,deck:this.props.deck}),dHe(this.deck,this)}onRemove(){this.deck&&pHe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&gHe(this.deck)}render(e,r){mHe(this.deck,this.map,this,r)}}const fP="__UNDEFINED__";function iw(t,e,r,n){if(!t||!e||!t.style||!t.style._loaded)return;const i=S0(n,Boolean);if(r!==n){const o=S0(r,Boolean),u=new Set(o.map(h=>h.id));for(const h of i)u.delete(h.id);for(const h of u)t.getLayer(h)&&t.removeLayer(h)}for(const o of i){const u=t.getLayer(o.id);u?(u.implementation||u).setProps(o.props):t.addLayer(new bHe({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const a=t.style._order,s={};for(const o of i){let{beforeId:u}=o.props;(!u||!a.includes(u))&&(u=fP),s[u]=s[u]||[],s[u].push(o.id)}for(const o in s){const u=s[o];let h=o===fP?a.length:a.indexOf(o),f=o===fP?void 0:o;for(let d=u.length-1;d>=0;d--){const b=u[d],v=a.indexOf(b);v!==h-1&&(t.moveLayer(b,f),v>h&&h++),h--,f=b}}}class xHe{constructor(e){this._handleStyleChange=()=>{iw(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:a}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${a}px`})}},this._updateViewState=()=>{const i=this._deck,a=this._map;i&&a&&(i.setProps({views:this._props.views||CE(a),viewState:Ob(a)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const a=this._deck;if(!a||!a.isInitialized)return;const s={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(s.deltaX=i.originalEvent.clientX-o.clientX,s.deltaY=i.originalEvent.clientY-o.clientY,s.offsetCenter={x:o.x+s.deltaX,y:o.y+s.deltaY}),s.type){case"mousedown":a._onPointerDown(s),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":s.type="panstart",a._onEvent(s);break;case"drag":s.type="panmove",a._onEvent(s);break;case"dragend":s.type="panend",a._onEvent(s);break;case"click":s.tapCount=1,a._onEvent(s);break;case"dblclick":s.type="click",s.tapCount=2,a._onEvent(s);break;case"mousemove":s.type="pointermove",a._onPointerMove(s);break;case"mouseout":s.type="pointerleave",a._onPointerMove(s);break;default:return}};const{interleaved:r=!1,...n}=e;this._interleaved=r,this._props=n}setProps(e){this._interleaved&&e.layers&&iw(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...bR(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new Rb({...this._props,parent:r,parameters:{...bR(e,!1),...this._props.parameters},views:this._props.views||CE(e),viewState:Ob(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){const r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&Xa.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=Ere({map:e,gl:r,deck:new Rb({...this._props,gl:r})}),e.on("styledata",this._handleStyleChange),iw(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),iw(e,this._deck,this._props.layers,[]),Tre(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Ll(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Ll(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Ll(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const wHe="deckgl-layer",Ire=ht.createContext({}),xR=({mapId:t,children:e})=>{const r=pa({mapId:t}),n=ee.useRef(void 0),[i,a]=ee.useState([]);ee.useEffect(()=>{if(r.map)return n.current=new xHe({id:wHe}),r.map.addControl(n.current),()=>{n.current&&r.map?.removeControl(n.current),n.current=void 0}},[r.map]),ee.useEffect(()=>{n.current&&n.current.setProps({layers:[...i]})},[i]);const s={deckGlLayerArray:i,setDeckGlLayerArray:a};return Z.jsx(Ire.Provider,{value:s,children:e})};try{xR.displayName="DeckGlContextProvider",xR.__docgenInfo={description:"",displayName:"DeckGlContextProvider",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string"}}}}}catch{}function SHe(){const t=ee.useContext(Ire),e=t.deckGlLayerArray;function r(i){const a=[...e];a.push(i),t.setDeckGlLayerArray(a)}function n(i){const a=e.filter(s=>s!==i);t.setDeckGlLayerArray(a)}return{addLayer:r,removeLayer:n,layerArray:e}}function EHe({pointCount:t,getBinId:e}){const r=new Map;for(let n=0;n<t;n++){const i=e(n);if(i===null)continue;let a=r.get(String(i));a?a.points.push(n):(a={id:i,index:r.size,points:[n]},r.set(String(i),a))}return Array.from(r.values())}function THe({bins:t,dimensions:e,target:r}){const n=t.length*e;(!r||r.length<n)&&(r=new Float32Array(n));for(let i=0;i<t.length;i++){const{id:a}=t[i];Array.isArray(a)?r.set(a,i*e):r[i]=a}return r}const CHe=t=>t.length,Pre=(t,e)=>{let r=0;for(const n of t)r+=e(n);return r},AHe=(t,e)=>t.length===0?NaN:Pre(t,e)/t.length,IHe=(t,e)=>{let r=1/0;for(const n of t){const i=e(n);i<r&&(r=i)}return r},PHe=(t,e)=>{let r=-1/0;for(const n of t){const i=e(n);i>r&&(r=i)}return r},kHe={COUNT:CHe,SUM:Pre,MEAN:AHe,MIN:IHe,MAX:PHe};function MHe({bins:t,getValue:e,operation:r,target:n}){(!n||n.length<t.length)&&(n=new Float32Array(t.length));let i=1/0,a=-1/0;for(let s=0;s<t.length;s++){const{points:o}=t[s];n[s]=r(o,e),n[s]<i&&(i=n[s]),n[s]>a&&(a=n[s])}return{value:n,domain:[i,a]}}function rW(t,e,r){const n={};for(const a of t.sources||[]){const s=e[a];if(s)n[a]=RHe(s);else throw new Error(`Cannot find attribute ${a}`)}const i={};return a=>{for(const s in n)i[s]=n[s](a);return t.getValue(i,a,r)}}function RHe(t){const e=t.value,{offset:r=0,stride:n,size:i}=t.getAccessor(),a=e.BYTES_PER_ELEMENT,s=r/a,o=n?n/a:i;if(i===1)return t.isConstant?()=>e[0]:h=>{const f=s+o*h;return e[f]};let u;return t.isConstant?(u=Array.from(e),()=>u):(u=new Array(i),h=>{const f=s+o*h;for(let d=0;d<i;d++)u[d]=e[f+d];return u})}class OHe{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){const r=this.props;if(e.binOptions&&(Sc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.customOperations)for(let n=0;n<this.channelCount;n++)!!e.customOperations[n]!=!!r.customOperations[n]&&this.setNeedsUpdate(n);e.pointCount!==void 0&&e.pointCount!==r.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...r.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=EHe({pointCount:this.props.pointCount,getBinId:rW(this.props.getBin,this.props.attributes,this.props.binOptions)});const e=THe({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:"float32",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){const r=this.props.customOperations[e]||kHe[this.props.operations[e]],{value:n,domain:i}=MHe({bins:this.bins,getValue:rW(this.props.getValue[e],this.props.attributes,void 0),operation:r,target:this.results[e]?.value});this.results[e]={value:n,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){const r=this.bins[e];if(!r)return null;const n=new Array(this.channelCount);for(let i=0;i<n.length;i++){const a=this.results[i];n[i]=a?.value[e]}return{id:r.id,value:n,count:r.points.length,pointIndices:r.points}}}function kre(t,e,r){return t.createFramebuffer({width:e,height:r,colorAttachments:[t.createTexture({width:e,height:r,format:"rgba32float",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}const NHe=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,LHe={name:"binSorter",vs:NHe,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}},Mre=[1,2,4,8],nW=3e38,DHe={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},zw=1024;class FHe{constructor(e,r){this.binsFBO=null,this.device=e,this.model=zHe(e,r)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;const r=e%zw,n=Math.floor(e/zw),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:r,sourceY:n,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,r){const n=zw,i=Math.ceil(e/n);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:n,height:i}):this.binsFBO=kre(this.device,n,i);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:a})}setModelProps(e){const r=this.model;e.attributes&&r.setAttributes(e.attributes),e.constantAttributes&&r.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&r.setVertexCount(e.vertexCount),e.shaderModuleProps&&r.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;const r=BHe(e);this._updateBins("SUM",r.SUM+r.MEAN),this._updateBins("MIN",r.MIN),this._updateBins("MAX",r.MAX)}_updateBins(e,r){if(r===0)return;r|=Mre[3];const n=this.model,i=this.binsFBO,a=e==="MAX"?-nW:e==="MIN"?nW:0,s=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:r},clearColor:[a,a,a,0],clearDepth:!1,clearStencil:!1});n.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:e==="MAX"?"max":e==="MIN"?"min":"add",blendAlphaOperation:"add"}),n.draw(s),s.end()}}function BHe(t){const e={...DHe};for(let r=0;r<t.length;r++){const n=t[r];n&&(e[n]+=Mre[r])}return e}function zHe(t,e){let r=e.vs;e.dimensions===2&&(r+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);const n=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${r}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new Nm(t,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],LHe],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:n,fs:i,topology:"point-list",disableWarnings:!0})}const jHe=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,UHe={name:"aggregatorTransform",vs:jHe,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};class VHe{constructor(e,r){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=r.channelCount,this.transform=$He(e,r),this.domainFBO=kre(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){const e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,r=new Float32Array(e);this._domains=[[-r[4],r[0]],[-r[5],r[1]],[-r[6],r[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,r){const{model:n,transformFeedback:i}=this.transform;n.setVertexCount(e);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0]};n.shaderInputs.setProps({aggregatorTransform:a});const s=e*r.length*4;(!this.binBuffer||this.binBuffer.byteLength<s)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:s}),i.setBuffer("binIds",this.binBuffer));const o=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<o)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:o}),i.setBuffer("values",this.valueBuffer))}update(e,r){if(!e)return;const n=this.transform,i=this.domainFBO,a=[0,1,2].map(u=>r[u]==="COUNT"?1:0),s=[0,1,2].map(u=>r[u]==="MEAN"?1:0),o={isCount:a,isMean:s,bins:e};n.model.shaderInputs.setProps({aggregatorTransform:o}),n.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-3e38,-3e38,-3e38,0],clearDepth:!1,clearStencil:!1}),this._domains=null}}function $He(t,e){const r=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new Lm(t,{vs:r,fs:n,topology:"point-list",modules:[UHe],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:zw},varyings:["binIds","values"],disableWarnings:!0})}class iW{static isSupported(e){return e.features.has("float32-renderable-webgl")&&e.features.has("texture-blend-float-webgl")}constructor(e,r){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=r.dimensions,this.channelCount=r.channelCount,this.props={...r,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new FHe(e,r),this.aggregationTransform=new VHe(e,r),this.setProps(r)}getBins(){const e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:"float32",size:this.dimensions}),this.binIds):null}getResult(e){const r=this.aggregationTransform.valueBuffer;return!r||e>=this.channelCount?null:(this.results[e]?.buffer!==r&&(this.results[e]={buffer:r,type:"float32",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;const{binIdRange:r}=this.props;let n;if(this.dimensions===1)n=[e+r[0][0]];else{const[[o,u],[h]]=r,f=u-o;n=[e%f+o,Math.floor(e/f)+h]}const i=this.binSorter.getBinValues(e);if(!i)return null;const a=i[3],s=[];for(let o=0;o<this.channelCount;o++){const u=this.props.operations[o];u==="COUNT"?s[o]=a:a===0?s[o]=NaN:s[o]=u==="MEAN"?i[o]/a:i[o]}return{id:n,value:s,count:a}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){const r=this.props;if("binIdRange"in e&&!Sc(e.binIdRange,r.binIdRange,2)){const n=e.binIdRange;if(Xa.assert(n.length===this.dimensions),this.dimensions===1){const[[i,a]]=n;this.binCount=a-i}else{const[[i,a],[s,o]]=n;this.binCount=(a-i)*(o-s)}this.binSorter.setDimensions(this.binCount,n),this.aggregationTransform.setDimensions(this.binCount,n),this.setNeedsUpdate()}if(e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.pointCount!==void 0&&e.pointCount!==r.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(Sc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){const n={},i={};for(const a of Object.values(e.attributes))for(const[s,o]of Object.entries(a.getValue()))ArrayBuffer.isView(o)?i[s]=o:o&&(n[s]=o);this.binSorter.setModelProps({attributes:n,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;const{operations:e}=this.props,r=this.needsUpdate.map((n,i)=>n?e[i]:null);this.binSorter.update(r),this.aggregationTransform.update(this.binSorter.texture,e);for(let n=0;n<this.channelCount;n++)this.needsUpdate[n]&&(this.needsUpdate[n]=!1,this.props.onUpdate?.({channel:n}))}}class Rre extends wre{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(e){super.updateState(e);const r=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==r){this.state.aggregator?.destroy();const n=this.createAggregator(r);return n.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:n,aggregatorType:r}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){const{aggregator:r}=this.state;r.setProps({attributes:e});for(const n in e)this.onAttributeChange(n);r.update()}draw({shaderModuleProps:e}){const{aggregator:r}=this.state;r.setProps({shaderModuleProps:e}),r.preDraw()}_getAttributeManager(){return new _re(this.context.device,{id:this.props.id,stats:this.context.stats})}}Rre.layerName="AggregationLayer";const qHe=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function HHe(t,e=!1,r=Float32Array){let n;if(Number.isFinite(t[0]))n=new r(t);else{n=new r(t.length*4);let i=0;for(let a=0;a<t.length;a++){const s=t[a];n[i++]=s[0],n[i++]=s[1],n[i++]=s[2],n[i++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let i=0;i<n.length;i++)n[i]/=255;return n}const AE={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function WHe(t,e){t.setSampler({minFilter:AE[e],magFilter:AE[e]})}function GHe(t,e,r="linear"){const n=HHe(e,!1,Uint8Array);return t.createTexture({format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:AE[r],magFilter:AE[r],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:n,width:n.length/4,height:1})}class aW{constructor(e,r){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=r,this.attribute=e}getScalePercentile(){if(!this._percentile){const e=oW(this.input,this.inputLength);this._percentile=YHe(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){const e=oW(this.input,this.inputLength);this._ordinal=XHe(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:r,upperPercentile:n}){if(e==="quantile")return[r,n-1];if(r>0||n<100){const{domain:i}=this.getScalePercentile();let a=i[Math.floor(r)-1]??-1/0,s=i[Math.floor(n)-1]??1/0;if(e==="ordinal"){const{domain:o}=this.getScaleOrdinal();a=o.findIndex(u=>u>=a),s=o.findIndex(u=>u>s)-1,s===-2&&(s=o.length-1)}return[a,s]}return null}update(e){const r=this.props;if(e.scaleType!==r.scaleType)switch(e.scaleType){case"quantile":{const{attribute:n}=this.getScalePercentile();this.attribute=n,this.domain=[0,99];break}case"ordinal":{const{attribute:n,domain:i}=this.getScaleOrdinal();this.attribute=n,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==r.scaleType||e.lowerPercentile!==r.lowerPercentile||e.upperPercentile!==r.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}}function XHe(t){const e=new Set;for(const i of t)Number.isFinite(i)&&e.add(i);const r=Array.from(e).sort(),n=new Map;for(let i=0;i<r.length;i++)n.set(r[i],i);return{attribute:{value:t.map(i=>Number.isFinite(i)?n.get(i):NaN),type:"float32",size:1},domain:r}}function YHe(t,e=100){const r=Array.from(t).filter(Number.isFinite).sort(ZHe);let n=0;const i=Math.max(1,e),a=new Array(i-1);for(;++n<i;)a[n-1]=KHe(r,n/i);return{attribute:{value:t.map(s=>Number.isFinite(s)?JHe(a,s):NaN),type:"float32",size:1},domain:a}}function oW(t,e){const r=(t.stride??4)/4,n=(t.offset??0)/4;let i=t.value;if(!i){const s=t.buffer?.readSyncWebGL(0,r*4*e);s&&(i=new Float32Array(s.buffer),t.value=i)}if(r===1)return i.subarray(0,e);const a=new Float32Array(e);for(let s=0;s<e;s++)a[s]=i[s*r+n];return a}function ZHe(t,e){return t-e}function KHe(t,e){const r=t.length;if(e<=0||r<2)return t[0];if(e>=1)return t[r-1];const n=(r-1)*e,i=Math.floor(n),a=t[i],s=t[i+1];return a+(s-a)*(n-i)}function JHe(t,e){let r=0,n=t.length;for(;r<n;){const i=r+n>>>1;t[i]>e?n=i:r=i+1}return r}function QHe({dataBounds:t,getBinId:e,padding:r=0}){const n=[t[0],t[1],[t[0][0],t[1][1]],[t[1][0],t[0][1]]].map(u=>e(u)),i=Math.min(...n.map(u=>u[0]))-r,a=Math.min(...n.map(u=>u[1]))-r,s=Math.max(...n.map(u=>u[0]))+r+1,o=Math.max(...n.map(u=>u[1]))+r+1;return[[i,s],[a,o]]}const eWe={COUNTER_CLOCKWISE:-1};function tWe(t,e,r={}){return rWe(t,r)!==e?(iWe(t,r),!0):!1}function rWe(t,e={}){return Math.sign(nWe(t,e))}const sW={x:0,y:1,z:2};function nWe(t,e={}){const{start:r=0,end:n=t.length,plane:i="xy"}=e,a=e.size||2;let s=0;const o=sW[i[0]],u=sW[i[1]];for(let h=r,f=n-a;h<n;h+=a)s+=(t[h+o]-t[f+o])*(t[h+u]+t[f+u]),f=h;return s/2}function iWe(t,e){const{start:r=0,end:n=t.length,size:i=2}=e,a=(n-r)/i,s=Math.floor(a/2);for(let o=0;o<s;++o){const u=r+o*i,h=r+(a-1-o)*i;for(let f=0;f<i;++f){const d=t[u+f];t[u+f]=t[h+f],t[h+f]=d}}}class aWe extends aUe{constructor(e){const{indices:r,attributes:n}=oWe(e);super({...e,indices:r,attributes:n})}}function oWe(t){const{radius:e,height:r=1,nradial:n=10}=t;let{vertices:i}=t;i&&(Xa.assert(i.length>=n),i=i.flatMap(v=>[v[0],v[1]]),tWe(i,eWe.COUNTER_CLOCKWISE));const a=r>0,s=n+1,o=a?s*3+1:n,u=Math.PI*2/n,h=new Uint16Array(a?n*3*2:0),f=new Float32Array(o*3),d=new Float32Array(o*3);let b=0;if(a){for(let v=0;v<s;v++){const S=v*u,E=v%n,P=Math.sin(S),k=Math.cos(S);for(let L=0;L<2;L++)f[b+0]=i?i[E*2]:k*e,f[b+1]=i?i[E*2+1]:P*e,f[b+2]=(1/2-L)*r,d[b+0]=i?i[E*2]:k,d[b+1]=i?i[E*2+1]:P,b+=3}f[b+0]=f[b-3],f[b+1]=f[b-2],f[b+2]=f[b-1],b+=3}for(let v=a?0:1;v<s;v++){const S=Math.floor(v/2)*Math.sign(.5-v%2),E=S*u,P=(S+n)%n,k=Math.sin(E),L=Math.cos(E);f[b+0]=i?i[P*2]:L*e,f[b+1]=i?i[P*2+1]:k*e,f[b+2]=r/2,d[b+2]=1,b+=3}if(a){let v=0;for(let S=0;S<n;S++)h[v++]=S*2+0,h[v++]=S*2+2,h[v++]=S*2+0,h[v++]=S*2+1,h[v++]=S*2+1,h[v++]=S*2+3}return{indices:h,attributes:{POSITION:{size:3,value:f},NORMAL:{size:3,value:d}}}}const lW=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,sWe={name:"column",vs:lW,fs:lW,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},lWe=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,uWe=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,IE=[0,0,0,255],cWe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:IE},getLineColor:{type:"accessor",value:IE},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class pD extends sC{getShaders(){const e={},{flatShading:r}=this.props;return r&&(e.FLAT_SHADING=1),super.getShaders({vs:lWe,fs:uWe,defines:e,modules:[Pte,r?yte:mte,l7e,sWe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:IE},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:IE},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:r,oldProps:n,changeFlags:i}=e,a=i.extensionsChanged||r.flatShading!==n.flatShading;a&&(this.state.models?.forEach(o=>o.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(a||r.diskResolution!==n.diskResolution||r.vertices!==n.vertices||(r.extruded||r.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(r)}getGeometry(e,r,n){const i=new aWe({radius:1,height:n?2:0,vertices:r,nradial:e});let a=0;if(r)for(let s=0;s<e;s++){const o=r[s],u=Math.sqrt(o[0]*o[0]+o[1]*o[1]);a+=u/e}else a=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*a}),i}_getModels(){const e=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),n=new Nm(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),i=new Nm(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:e,vertices:r,extruded:n,stroked:i}){const a=this.getGeometry(e,r,n||i);this.setState({fillVertexCount:a.attributes.POSITION.value.length/3});const s=this.state.fillModel,o=this.state.wireframeModel;s.setGeometry(a),s.setTopology("triangle-strip"),s.setIndexBuffer(null),o.setGeometry(a),o.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:r,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:a,radiusUnits:s,elevationScale:o,extruded:u,filled:h,stroked:f,wireframe:d,offset:b,coverage:v,radius:S,angle:E}=this.props,P=this.state.fillModel,k=this.state.wireframeModel,{fillVertexCount:L,edgeDistance:N}=this.state,M={radius:S,angle:E/180*Math.PI,offset:b,extruded:u,stroked:f,coverage:v,elevationScale:o,edgeDistance:N,radiusUnits:b0[s],widthUnits:b0[r],widthScale:n,widthMinPixels:i,widthMaxPixels:a};u&&d&&(k.shaderInputs.setProps({column:{...M,isStroke:!0}}),k.draw(this.context.renderPass)),h&&(P.setVertexCount(L),P.shaderInputs.setProps({column:{...M,isStroke:!1}}),P.draw(this.context.renderPass)),!u&&f&&(P.setVertexCount(L*2/3),P.shaderInputs.setProps({column:{...M,isStroke:!0}}),P.draw(this.context.renderPass))}}pD.layerName="ColumnLayer";pD.defaultProps=cWe;const Ore=Math.PI/3,lC=2*Math.sin(Ore),uC=1.5,hWe=Array.from({length:6},(t,e)=>{const r=e*Ore;return[Math.sin(r),-Math.cos(r)]});function dP([t,e],r){let n=Math.round(e=e/r/uC),i=Math.round(t=t/r/lC-(n&1)/2);const a=e-n;if(Math.abs(a)*3>1){const s=t-i,o=i+(t<i?-1:1)/2,u=n+(e<n?-1:1),h=t-o,f=e-u;s*s+a*a>h*h+f*f&&(i=o+(n&1?1:-1)/2,n=u)}return[i,n]}const fWe=`
const vec2 DIST = vec2(${lC}, ${uC});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function uW([t,e],r){return[(t+(e&1)/2)*r*lC,e*r*uC]}const dWe=`
const vec2 DIST = vec2(${lC}, ${uC});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`,pWe=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${dWe}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,gWe=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,mWe={name:"hexagon",vs:gWe,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};class Nre extends pD{getShaders(){const e=super.getShaders();return e.modules.push(mWe),{...e,vs:pWe}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:r,oldProps:n}=e,i=this.state.fillModel;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=GHe(this.context.device,r.colorRange,r.colorScaleType);const a={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:a})}else n.colorScaleType!==r.colorScaleType&&WHe(this.state.colorTexture,r.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const{radius:r,hexOriginCommon:n,elevationRange:i,elevationScale:a,extruded:s,coverage:o,colorDomain:u,elevationDomain:h}=this.props,f=this.props.colorCutoff||[-1/0,1/0],d=this.props.elevationCutoff||[-1/0,1/0],b=this.state.fillModel;b.vertexArray.indexBuffer&&b.setIndexBuffer(null),b.setVertexCount(this.state.fillVertexCount);const v={colorDomain:[Math.max(u[0],f[0]),Math.min(u[1],f[1]),Math.max(u[0]-1,f[0]),Math.min(u[1]+1,f[1])],elevationDomain:[Math.max(h[0],d[0]),Math.min(h[1],d[1]),Math.max(h[0]-1,d[0]),Math.min(h[1]+1,d[1])],elevationRange:[i[0]*a,i[1]*a],originCommon:n};b.shaderInputs.setProps({column:{extruded:s,coverage:o,radius:r},hexagon:v}),b.draw(this.context.renderPass)}}Nre.layerName="HexagonCellLayer";const yWe=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,vWe={name:"binOptions",vs:yWe,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function cW(){}const _We={gpuAggregation:!0,colorDomain:null,colorRange:qHe,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:cW,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:cW,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class PE extends Rre{getAggregatorType(){const{gpuAggregation:e,hexagonAggregator:r,getColorValue:n,getElevationValue:i}=this.props;return e&&(r||n||i)?(Xa.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&iW.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{hexagonAggregator:r,radius:n}=this.props;return new OHe({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},a,s)=>{if(r)return r(i,n);const u=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:h,hexOriginCommon:f}=s;return dP([u[0]-f[0],u[1]-f[1]],h)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new iW(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Pte,vWe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${fWe}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const r=super.updateState(e),{props:n,oldProps:i,changeFlags:a}=e,{aggregator:s}=this.state;if((a.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(lre(n.data).iterable)),r||a.dataChanged||n.radius!==i.radius||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{radiusCommon:o,hexOriginCommon:u,binIdRange:h,dataAsArray:f}=this.state;if(s.setProps({binIdRange:h,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{radiusCommon:o,hexOriginCommon:u},onUpdate:this._onAggregationUpdate.bind(this)}),f){const{getColorValue:d,getElevationValue:b}=this.props;s.setProps({customOperations:[d&&(v=>d(v.map(S=>f[S]),{indices:v,data:n.data})),b&&(v=>b(v.map(S=>f[S]),{indices:v,data:n.data}))]})}}return a.updateTriggersChanged&&a.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),a.updateTriggersChanged&&a.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),r}_updateBinOptions(){const e=this.getBounds();let r=1,n=[0,0],i=[[0,1],[0,1]],a=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{radius:o}=this.props,{unitsPerMeter:u}=a.getDistanceScales(s);r=u[0]*o;const h=dP(a.projectFlat(s),r);s=a.unprojectFlat(uW(h,r));const f=a.constructor;a=a.isGeospatial?new f({longitude:s[0],latitude:s[1],zoom:12}):new Qm({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(a.center[0]),Math.fround(a.center[1])],i=QHe({dataBounds:e,getBinId:d=>{const b=a.projectFlat(d);return b[0]-=n[0],b[1]-=n[1],dP(b,r)},padding:1})}this.setState({radiusCommon:r,hexOriginCommon:n,binIdRange:i,aggregatorViewport:a})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const r=this.getCurrentLayer().props,{aggregator:n}=this.state;if(e===0){const i=n.getResult(0);this.setState({colors:new aW(i,n.binCount)}),r.onSetColorDomain(n.getResultDomain(0))}else if(e===1){const i=n.getResult(1);this.setState({elevations:new aW(i,n.binCount)}),r.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(e){const{aggregator:r}=this.state;switch(e){case"positions":r.setNeedsUpdate(),this._updateBinOptions();const{radiusCommon:n,hexOriginCommon:i,binIdRange:a}=this.state;r.setProps({binIdRange:a,binOptions:{radiusCommon:n,hexOriginCommon:i}});break;case"colorWeights":r.setNeedsUpdate(0);break;case"elevationWeights":r.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,radiusCommon:r,hexOriginCommon:n}=this.state,{elevationScale:i,colorRange:a,elevationRange:s,extruded:o,coverage:u,material:h,transitions:f,colorScaleType:d,lowerPercentile:b,upperPercentile:v,colorDomain:S,elevationScaleType:E,elevationLowerPercentile:P,elevationUpperPercentile:k,elevationDomain:L}=this.props,N=this.getSubLayerClass("cells",Nre),M=e.getBins(),z=this.state.colors?.update({scaleType:d,lowerPercentile:b,upperPercentile:v}),B=this.state.elevations?.update({scaleType:E,lowerPercentile:P,upperPercentile:k});return!z||!B?null:new N(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:M,getColorValue:z.attribute,getElevationValue:B.attribute}},dataComparator:(q,W)=>q.length===W.length,updateTriggers:{getBin:[M],getColorValue:[z.attribute],getElevationValue:[B.attribute]},diskResolution:6,vertices:hWe,radius:r,hexOriginCommon:n,elevationScale:i,colorRange:a,colorScaleType:d,elevationRange:s,extruded:o,coverage:u,material:h,colorDomain:z.domain||S||e.getResultDomain(0),elevationDomain:B.domain||L||e.getResultDomain(1),colorCutoff:z.cutoff,elevationCutoff:B.cutoff,transitions:f&&{getFillColor:f.getColorValue||f.getColorWeight,getElevation:f.getElevationValue||f.getElevationWeight},extensions:[]})}getPickingInfo(e){const r=e.info,{index:n}=r;if(n>=0){const i=this.state.aggregator.getBin(n);let a;if(i){const s=uW(i.id,this.state.radiusCommon),o=this.context.viewport.unprojectFlat(s);a={col:i.id[0],row:i.id[1],position:o,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(a.pointIndices=i.pointIndices,a.points=Array.isArray(this.props.data)?i.pointIndices.map(u=>this.props.data[u]):[])}r.object=a}return r}}PE.layerName="HexagonLayer";PE.defaultProps=_We;const kE=t=>{const e="assets/3D/laerm_points.json",r=SHe(),[n,i]=ee.useState({type:"",features:[]}),a=()=>{fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(v){return v.json()}).then(function(v){i(v)})};ee.useEffect(()=>{a()},[]);const s=.8,o=[51,51,51],u=v=>[[1,152,189,Math.round(80*v)],[73,227,206,Math.round(90*v)],[216,254,181,Math.round(100*v)],[254,237,177,Math.round(110*v)],[254,173,84,Math.round(120*v)],[209,55,78,Math.round(150*v)]],h=[30,75],f=ee.useMemo(()=>({id:"deckgl-layer",data:n?n.features:[],type:PE,colorRange:u(s),coverage:.9,elevationRange:h,elevationScale:10,extruded:!0,autoHighlight:!0,getPosition:v=>v.geometry.coordinates,pickable:!0,radius:16,upperPercentile:100,material:{ambient:.8,diffuse:.5,shininess:20,specularColor:o},transitions:{elevationScale:1500},getColorValue:v=>{const S=v.reduce((E,P)=>!P?.properties&&P.source.properties?E<P.source.properties.dba?P.source.properties.dba:E:E<P.properties.dba?P.properties.dba:E,-1/0);return Math.round(S)},getElevationValue:v=>{const S=v.reduce((E,P)=>!P.properties&&P.source.properties?E<P.source.properties.dba?P.source.properties.dba:E:E<P.properties.dba?P.properties.dba:E,-1/0);return Math.round(S)},_filterData:null}),[n.features]),d=pa({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),b=ee.useRef(!1);return ee.useEffect(()=>{if(!d.map||n.features.length<=0||b.current&&n.features.length>=0)return;b.current=!0;const v=new PE({...f});return r.addLayer(v),()=>{v&&r.removeLayer(v),b.current=!1}},[d.map,t.mapId,f]),Z.jsx(Z.Fragment,{})};try{kE.displayName="MlHexagonMap",kE.__docgenInfo={description:"",displayName:"MlHexagonMap",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const bWe={title:"MapComponents/MlHexagonMap",component:kE,argTypes:{},decorators:BDe},xWe=t=>Z.jsx(xR,{...t,children:Z.jsx(kE,{...t})}),tm=xWe.bind({});tm.parameters={};tm.args={mapId:"map_1"};tm.parameters={...tm.parameters,docs:{...tm.parameters?.docs,source:{originalSource:`(props: TemplateProps) => <DeckGlContextProvider {...props}>
        <MlHexagonMap {...props} />
    </DeckGlContextProvider>`,...tm.parameters?.docs?.source}}};const wWe=["NoiseMap"],MWe=Object.freeze(Object.defineProperty({__proto__:null,NoiseMap:tm,__namedExportsOrder:wWe,default:bWe},Symbol.toStringTag,{value:"Module"}));export{MWe as M,ao as _};
